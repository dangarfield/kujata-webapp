(self.webpackChunkkujata_webapp=self.webpackChunkkujata_webapp||[]).push([[179],{370:function(s,e,a){"use strict";function d(o){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(l){return l.__proto__||Object.getPrototypeOf(l)})(o)}function v(o,u){for(;!Object.prototype.hasOwnProperty.call(o,u)&&null!==(o=d(o)););return o}function g(){return g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(u,l,p){var m=v(u,l);if(m){var S=Object.getOwnPropertyDescriptor(m,l);return S.get?S.get.call(arguments.length<3?u:p):S.value}},g.apply(this,arguments)}function C(o,u){for(var l=0;l<u.length;l++){var p=u[l];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(o,p.key,p)}}function w(o,u,l){return u&&C(o.prototype,u),l&&C(o,l),o}function _(o,u){if(!(o instanceof u))throw new TypeError("Cannot call a class as a function")}function x(o,u){return(x=Object.setPrototypeOf||function(p,m){return p.__proto__=m,p})(o,u)}function b(o,u){if("function"!=typeof u&&null!==u)throw new TypeError("Super expression must either be null or a function");o.prototype=Object.create(u&&u.prototype,{constructor:{value:o,writable:!0,configurable:!0}}),u&&x(o,u)}function A(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(o){return!1}}function E(o){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(l){return typeof l}:function(l){return l&&"function"==typeof Symbol&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l})(o)}function R(o){if(void 0===o)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return o}function O(o,u){if(u&&("object"===E(u)||"function"==typeof u))return u;if(void 0!==u)throw new TypeError("Derived constructors may only return object or undefined");return R(o)}function D(o){var u=A();return function(){var m,p=d(o);if(u){var S=d(this).constructor;m=Reflect.construct(p,arguments,S)}else m=p.apply(this,arguments);return O(this,m)}}function F(o,u){(null==u||u>o.length)&&(u=o.length);for(var l=0,p=new Array(u);l<u;l++)p[l]=o[l];return p}function L(o,u){if(o){if("string"==typeof o)return F(o,u);var l=Object.prototype.toString.call(o).slice(8,-1);if("Object"===l&&o.constructor&&(l=o.constructor.name),"Map"===l||"Set"===l)return Array.from(o);if("Arguments"===l||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l))return F(o,u)}}function I(o,u){var l="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!l){if(Array.isArray(o)||(l=L(o))||u&&o&&"number"==typeof o.length){l&&(o=l);var p=0,m=function(){};return{s:m,n:function(){return p>=o.length?{done:!0}:{done:!1,value:o[p++]}},e:function(G){throw G},f:m}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var P,S=!0,M=!1;return{s:function(){l=l.call(o)},n:function(){var G=l.next();return S=G.done,G},e:function(G){M=!0,P=G},f:function(){try{!S&&null!=l.return&&l.return()}finally{if(M)throw P}}}}function X(o,u){return function(o){if(Array.isArray(o))return o}(o)||function(o,u){var l=null==o?null:"undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(null!=l){var M,P,p=[],m=!0,S=!1;try{for(l=l.call(o);!(m=(M=l.next()).done)&&(p.push(M.value),!u||p.length!==u);m=!0);}catch(N){S=!0,P=N}finally{try{!m&&null!=l.return&&l.return()}finally{if(S)throw P}}return p}}(o,u)||L(o,u)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function re(o,u,l){return u in o?Object.defineProperty(o,u,{value:l,enumerable:!0,configurable:!0,writable:!0}):o[u]=l,o}function U(o){return function(o){if(Array.isArray(o))return F(o)}(o)||function(o){if("undefined"!=typeof Symbol&&null!=o[Symbol.iterator]||null!=o["@@iterator"])return Array.from(o)}(o)||L(o)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(o,u,l){return(K=A()?Reflect.construct:function(m,S,M){var P=[null];P.push.apply(P,S);var G=new(Function.bind.apply(m,P));return M&&x(G,M.prototype),G}).apply(null,arguments)}function Q(o){var u="function"==typeof Map?new Map:void 0;return Q=function(p){if(null===p||!function(o){return-1!==Function.toString.call(o).indexOf("[native code]")}(p))return p;if("function"!=typeof p)throw new TypeError("Super expression must either be null or a function");if(void 0!==u){if(u.has(p))return u.get(p);u.set(p,m)}function m(){return K(p,arguments,d(this).constructor)}return m.prototype=Object.create(p.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),x(m,p)},Q(o)}function oe(o){return"function"==typeof o}function me(o){var l=o(function(m){Error.call(m),m.stack=(new Error).stack});return l.prototype=Object.create(Error.prototype),l.prototype.constructor=l,l}var fe=me(function(o){return function(l){o(this),this.message=l?"".concat(l.length," errors occurred during unsubscription:\n").concat(l.map(function(p,m){return"".concat(m+1,") ").concat(p.toString())}).join("\n  ")):"",this.name="UnsubscriptionError",this.errors=l}});function ge(o,u){if(o){var l=o.indexOf(u);0<=l&&o.splice(l,1)}}var o,$=function(){function o(u){_(this,o),this.initialTeardown=u,this.closed=!1,this._parentage=null,this._teardowns=null}return w(o,[{key:"unsubscribe",value:function(){var l;if(!this.closed){this.closed=!0;var p=this._parentage;if(p)if(this._parentage=null,Array.isArray(p)){var S,m=I(p);try{for(m.s();!(S=m.n()).done;)S.value.remove(this)}catch(Ce){m.e(Ce)}finally{m.f()}}else p.remove(this);var P=this.initialTeardown;if(oe(P))try{P()}catch(Ce){l=Ce instanceof fe?Ce.errors:[Ce]}var N=this._teardowns;if(N){this._teardowns=null;var ie,G=I(N);try{for(G.s();!(ie=G.n()).done;){var ye=ie.value;try{Z(ye)}catch(Ce){l=null!=l?l:[],Ce instanceof fe?l=[].concat(U(l),U(Ce.errors)):l.push(Ce)}}}catch(Ce){G.e(Ce)}finally{G.f()}}if(l)throw new fe(l)}}},{key:"add",value:function(l){var p;if(l&&l!==this)if(this.closed)Z(l);else{if(l instanceof o){if(l.closed||l._hasParent(this))return;l._addParent(this)}(this._teardowns=null!==(p=this._teardowns)&&void 0!==p?p:[]).push(l)}}},{key:"_hasParent",value:function(l){var p=this._parentage;return p===l||Array.isArray(p)&&p.includes(l)}},{key:"_addParent",value:function(l){var p=this._parentage;this._parentage=Array.isArray(p)?(p.push(l),p):p?[p,l]:l}},{key:"_removeParent",value:function(l){var p=this._parentage;p===l?this._parentage=null:Array.isArray(p)&&ge(p,l)}},{key:"remove",value:function(l){var p=this._teardowns;p&&ge(p,l),l instanceof o&&l._removeParent(this)}}]),o}();$.EMPTY=((o=new $).closed=!0,o);var ue=$.EMPTY;function Y(o){return o instanceof $||o&&"closed"in o&&oe(o.remove)&&oe(o.add)&&oe(o.unsubscribe)}function Z(o){oe(o)?o():o.unsubscribe()}var ve={setTimeout:function(o){function u(){return o.apply(this,arguments)}return u.toString=function(){return o.toString()},u}(function(){var o=ve.delegate;return((null==o?void 0:o.setTimeout)||setTimeout).apply(void 0,arguments)}),clearTimeout:function(o){function u(l){return o.apply(this,arguments)}return u.toString=function(){return o.toString()},u}(function(o){var u=ve.delegate;return((null==u?void 0:u.clearTimeout)||clearTimeout)(o)}),delegate:void 0};function le(o){ve.setTimeout(function(){throw o})}function _e(){}var ae=ce("C",void 0,void 0);function ce(o,u,l){return{kind:o,value:u,error:l}}function be(o){o()}var we=function(o){b(l,o);var u=D(l);function l(p){var m;return _(this,l),(m=u.call(this)).isStopped=!1,p?(m.destination=p,Y(p)&&p.add(R(m))):m.destination=$e,m}return w(l,[{key:"next",value:function(m){this.isStopped?Je(function(o){return ce("N",o,void 0)}(m),this):this._next(m)}},{key:"error",value:function(m){this.isStopped?Je(function(o){return ce("E",void 0,o)}(m),this):(this.isStopped=!0,this._error(m))}},{key:"complete",value:function(){this.isStopped?Je(ae,this):(this.isStopped=!0,this._complete())}},{key:"unsubscribe",value:function(){this.closed||(this.isStopped=!0,g(d(l.prototype),"unsubscribe",this).call(this),this.destination=null)}},{key:"_next",value:function(m){this.destination.next(m)}},{key:"_error",value:function(m){try{this.destination.error(m)}finally{this.unsubscribe()}}},{key:"_complete",value:function(){try{this.destination.complete()}finally{this.unsubscribe()}}}],[{key:"create",value:function(m,S,M){return new Ne(m,S,M)}}]),l}($),Ne=function(o){b(l,o);var u=D(l);function l(p,m,S){var M,P;if(_(this,l),M=u.call(this),oe(p))P=p;else if(p){var N;P=p.next,m=p.error,S=p.complete,R(M),N=p,P=null==P?void 0:P.bind(N),m=null==m?void 0:m.bind(N),S=null==S?void 0:S.bind(N)}return M.destination={next:P?Re(P,R(M)):_e,error:Re(null!=m?m:De,R(M)),complete:S?Re(S,R(M)):_e},M}return l}(we);function Re(o,u){return function(){try{o.apply(void 0,arguments)}catch(l){le(l)}}}function De(o){throw o}function Je(o,u){var l=null;l&&ve.setTimeout(function(){return l(o,u)})}var $e={closed:!0,next:_e,error:De,complete:_e},pt="function"==typeof Symbol&&Symbol.observable||"@@observable";function ut(o){return o}function Xe(o){return 0===o.length?ut:1===o.length?o[0]:function(l){return o.reduce(function(p,m){return m(p)},l)}}var Ke=function(){var o=function(){function u(l){_(this,u),l&&(this._subscribe=l)}return w(u,[{key:"lift",value:function(p){var m=new u;return m.source=this,m.operator=p,m}},{key:"subscribe",value:function(p,m,S){var M=this,P=function(o){return o&&o instanceof we||function(o){return o&&oe(o.next)&&oe(o.error)&&oe(o.complete)}(o)&&Y(o)}(p)?p:new Ne(p,m,S);return be(function(){var N=M.operator,G=M.source;P.add(N?N.call(P,G):G?M._subscribe(P):M._trySubscribe(P))}),P}},{key:"_trySubscribe",value:function(p){try{return this._subscribe(p)}catch(m){p.error(m)}}},{key:"forEach",value:function(p,m){var S=this;return new(m=lt(m))(function(M,P){var N;N=S.subscribe(function(G){try{p(G)}catch(ie){P(ie),null==N||N.unsubscribe()}},P,M)})}},{key:"_subscribe",value:function(p){var m;return null===(m=this.source)||void 0===m?void 0:m.subscribe(p)}},{key:pt,value:function(){return this}},{key:"pipe",value:function(){for(var p=arguments.length,m=new Array(p),S=0;S<p;S++)m[S]=arguments[S];return Xe(m)(this)}},{key:"toPromise",value:function(p){var m=this;return new(p=lt(p))(function(S,M){var P;m.subscribe(function(N){return P=N},function(N){return M(N)},function(){return S(P)})})}}]),u}();return o.create=function(u){return new o(u)},o}();function lt(o){var u;return null!==(u=null!=o?o:undefined)&&void 0!==u?u:Promise}var ft=me(function(o){return function(){o(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),He=function(){var o=function(u){b(p,u);var l=D(p);function p(){var m;return _(this,p),(m=l.call(this)).closed=!1,m.observers=[],m.isStopped=!1,m.hasError=!1,m.thrownError=null,m}return w(p,[{key:"lift",value:function(S){var M=new gt(this,this);return M.operator=S,M}},{key:"_throwIfClosed",value:function(){if(this.closed)throw new ft}},{key:"next",value:function(S){var M=this;be(function(){if(M._throwIfClosed(),!M.isStopped){var G,N=I(M.observers.slice());try{for(N.s();!(G=N.n()).done;)G.value.next(S)}catch(ye){N.e(ye)}finally{N.f()}}})}},{key:"error",value:function(S){var M=this;be(function(){if(M._throwIfClosed(),!M.isStopped){M.hasError=M.isStopped=!0,M.thrownError=S;for(var P=M.observers;P.length;)P.shift().error(S)}})}},{key:"complete",value:function(){var S=this;be(function(){if(S._throwIfClosed(),!S.isStopped){S.isStopped=!0;for(var M=S.observers;M.length;)M.shift().complete()}})}},{key:"unsubscribe",value:function(){this.isStopped=this.closed=!0,this.observers=null}},{key:"observed",get:function(){var S;return(null===(S=this.observers)||void 0===S?void 0:S.length)>0}},{key:"_trySubscribe",value:function(S){return this._throwIfClosed(),g(d(p.prototype),"_trySubscribe",this).call(this,S)}},{key:"_subscribe",value:function(S){return this._throwIfClosed(),this._checkFinalizedStatuses(S),this._innerSubscribe(S)}},{key:"_innerSubscribe",value:function(S){var N=this.observers;return this.hasError||this.isStopped?ue:(N.push(S),new $(function(){return ge(N,S)}))}},{key:"_checkFinalizedStatuses",value:function(S){var N=this.isStopped;this.hasError?S.error(this.thrownError):N&&S.complete()}},{key:"asObservable",value:function(){var S=new Ke;return S.source=this,S}}]),p}(Ke);return o.create=function(u,l){return new gt(u,l)},o}(),gt=function(o){b(l,o);var u=D(l);function l(p,m){var S;return _(this,l),(S=u.call(this)).destination=p,S.source=m,S}return w(l,[{key:"next",value:function(m){var S,M;null===(M=null===(S=this.destination)||void 0===S?void 0:S.next)||void 0===M||M.call(S,m)}},{key:"error",value:function(m){var S,M;null===(M=null===(S=this.destination)||void 0===S?void 0:S.error)||void 0===M||M.call(S,m)}},{key:"complete",value:function(){var m,S;null===(S=null===(m=this.destination)||void 0===m?void 0:m.complete)||void 0===S||S.call(m)}},{key:"_subscribe",value:function(m){var S,M;return null!==(M=null===(S=this.source)||void 0===S?void 0:S.subscribe(m))&&void 0!==M?M:ue}}]),l}(He);function vt(o){return oe(null==o?void 0:o.lift)}function Gt(o){return function(u){if(vt(u))return u.lift(function(l){try{return o(l,this)}catch(p){this.error(p)}});throw new TypeError("Unable to lift unknown Observable type")}}var Lt=function(o){b(l,o);var u=D(l);function l(p,m,S,M,P){var N,G,ie,ye;return _(this,l),(ye=u.call(this,p)).onFinalize=P,ye._next=m?function(Ce){try{m(Ce)}catch(Le){p.error(Le)}}:g((N=R(ye),d(l.prototype)),"_next",N),ye._error=M?function(Ce){try{M(Ce)}catch(Le){p.error(Le)}finally{this.unsubscribe()}}:g((G=R(ye),d(l.prototype)),"_error",G),ye._complete=S?function(){try{S()}catch(Ce){p.error(Ce)}finally{this.unsubscribe()}}:g((ie=R(ye),d(l.prototype)),"_complete",ie),ye}return w(l,[{key:"unsubscribe",value:function(){var m,S=this.closed;g(d(l.prototype),"unsubscribe",this).call(this),!S&&(null===(m=this.onFinalize)||void 0===m||m.call(this))}}]),l}(we);function yt(o,u){return Gt(function(l,p){var m=0;l.subscribe(new Lt(p,function(S){p.next(o.call(u,S,m++))}))})}var xr=a(757),Dr=a.n(xr);function Ee(o){return this instanceof Ee?(this.v=o,this):new Ee(o)}function Nr(o,u,l){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var m,p=l.apply(o,u||[]),S=[];return m={},M("next"),M("throw"),M("return"),m[Symbol.asyncIterator]=function(){return this},m;function M(Ce){p[Ce]&&(m[Ce]=function(Le){return new Promise(function(qe,nt){S.push([Ce,Le,qe,nt])>1||P(Ce,Le)})})}function P(Ce,Le){try{!function(Ce){Ce.value instanceof Ee?Promise.resolve(Ce.value.v).then(G,ie):ye(S[0][2],Ce)}(p[Ce](Le))}catch(qe){ye(S[0][3],qe)}}function G(Ce){P("next",Ce)}function ie(Ce){P("throw",Ce)}function ye(Ce,Le){Ce(Le),S.shift(),S.length&&P(S[0][0],S[0][1])}}function Dn(o){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l,u=o[Symbol.asyncIterator];return u?u.call(o):(o=function(o){var u="function"==typeof Symbol&&Symbol.iterator,l=u&&o[u],p=0;if(l)return l.call(o);if(o&&"number"==typeof o.length)return{next:function(){return o&&p>=o.length&&(o=void 0),{value:o&&o[p++],done:!o}}};throw new TypeError(u?"Object is not iterable.":"Symbol.iterator is not defined.")}(o),l={},p("next"),p("throw"),p("return"),l[Symbol.asyncIterator]=function(){return this},l);function p(S){l[S]=o[S]&&function(M){return new Promise(function(P,N){!function(S,M,P,N){Promise.resolve(N).then(function(G){S({value:G,done:P})},M)}(P,N,(M=o[S](M)).done,M.value)})}}}var Ie=function(u){return u&&"number"==typeof u.length&&"function"!=typeof u};function ze(o){return oe(null==o?void 0:o.then)}function it(o){return oe(o[pt])}function Dt(o){return Symbol.asyncIterator&&oe(null==o?void 0:o[Symbol.asyncIterator])}function xt(o){return new TypeError("You provided ".concat(null!==o&&"object"==typeof o?"an invalid object":"'".concat(o,"'")," where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable."))}var ir="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function Cr(o){return oe(null==o?void 0:o[ir])}function Hr(o){return Nr(this,arguments,Dr().mark(function u(){var l,p,m;return Dr().wrap(function(P){for(;;)switch(P.prev=P.next){case 0:l=o.getReader(),P.prev=1;case 2:return P.next=5,Ee(l.read());case 5:if(m=(p=P.sent).value,!p.done){P.next=12;break}return P.next=11,Ee(void 0);case 11:return P.abrupt("return",P.sent);case 12:return P.next=14,Ee(m);case 14:return P.next=16,P.sent;case 16:P.next=2;break;case 18:return P.prev=18,l.releaseLock(),P.finish(18);case 21:case"end":return P.stop()}},u,null,[[1,,18,21]])}))}function Xr(o){return oe(null==o?void 0:o.getReader)}function kr(o){if(o instanceof Ke)return o;if(null!=o){if(it(o))return function(o){return new Ke(function(u){var l=o[pt]();if(oe(l.subscribe))return l.subscribe(u);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(o);if(Ie(o))return function(o){return new Ke(function(u){for(var l=0;l<o.length&&!u.closed;l++)u.next(o[l]);u.complete()})}(o);if(ze(o))return function(o){return new Ke(function(u){o.then(function(l){u.closed||(u.next(l),u.complete())},function(l){return u.error(l)}).then(null,le)})}(o);if(Dt(o))return Ye(o);if(Cr(o))return function(o){return new Ke(function(u){var p,l=I(o);try{for(l.s();!(p=l.n()).done;)if(u.next(p.value),u.closed)return}catch(S){l.e(S)}finally{l.f()}u.complete()})}(o);if(Xr(o))return function(o){return Ye(Hr(o))}(o)}throw xt(o)}function Ye(o){return new Ke(function(u){(function(o,u){var l,p,m,S;return function(o,u,l,p){return new(l||(l=Promise))(function(S,M){function P(ie){try{G(p.next(ie))}catch(ye){M(ye)}}function N(ie){try{G(p.throw(ie))}catch(ye){M(ye)}}function G(ie){ie.done?S(ie.value):function(S){return S instanceof l?S:new l(function(M){M(S)})}(ie.value).then(P,N)}G((p=p.apply(o,u||[])).next())})}(this,void 0,void 0,Dr().mark(function M(){return Dr().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:G.prev=0,l=Dn(o);case 2:return G.next=4,l.next();case 4:if((p=G.sent).done){G.next=12;break}if(u.next(p.value),!u.closed){G.next=10;break}return G.abrupt("return");case 10:G.next=2;break;case 12:G.next=17;break;case 14:G.prev=14,G.t0=G.catch(0),m={error:G.t0};case 17:if(G.prev=17,G.prev=18,!p||p.done||!(S=l.return)){G.next=22;break}return G.next=22,S.call(l);case 22:if(G.prev=22,!m){G.next=25;break}throw m.error;case 25:return G.finish(22);case 26:return G.finish(17);case 27:u.complete();case 28:case"end":return G.stop()}},M,null,[[0,14,17,27],[18,,22,26]])}))})(o,u).catch(function(l){return u.error(l)})})}function Et(o,u,l){var p=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,m=arguments.length>4&&void 0!==arguments[4]&&arguments[4],S=u.schedule(function(){l(),m?o.add(this.schedule(null,p)):this.unsubscribe()},p);if(o.add(S),!m)return S}function ar(o,u,l,p,m,S,M,P){var N=[],G=0,ie=0,ye=!1,Ce=function(){ye&&!N.length&&!G&&u.complete()},Le=function(tt){return G<p?qe(tt):N.push(tt)},qe=function nt(tt){S&&u.next(tt),G++;var et=!1;kr(l(tt,ie++)).subscribe(new Lt(u,function(Ze){null==m||m(Ze),S?Le(Ze):u.next(Ze)},function(){et=!0},void 0,function(){if(et)try{G--;for(var Ze=function(){var At=N.shift();M?Et(u,M,function(){return nt(At)}):nt(At)};N.length&&G<p;)Ze();Ce()}catch(ht){u.error(ht)}}))};return o.subscribe(new Lt(u,Le,function(){ye=!0,Ce()})),function(){null==P||P()}}function Xt(o,u){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;return oe(u)?Xt(function(p,m){return yt(function(S,M){return u(p,S,m,M)})(kr(o(p,m)))},l):("number"==typeof u&&(l=u),Gt(function(p,m){return ar(p,m,o,l)}))}function Zt(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0;return Xt(ut,o)}var jt=new Ke(function(o){return o.complete()});function Un(o){return o[o.length-1]}function br(o){return oe(Un(o))?o.pop():void 0}function Ge(o){return function(o){return o&&oe(o.schedule)}(Un(o))?o.pop():void 0}function Wr(o,u){return"number"==typeof Un(o)?o.pop():u}function fn(o){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Gt(function(l,p){l.subscribe(new Lt(p,function(m){return Et(p,o,function(){return p.next(m)},u)},function(){return Et(p,o,function(){return p.complete()},u)},function(m){return Et(p,o,function(){return p.error(m)},u)}))})}function zn(o){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Gt(function(l,p){p.add(o.schedule(function(){return l.subscribe(p)},u))})}function $n(o,u){if(!o)throw new Error("Iterable cannot be null");return new Ke(function(l){Et(l,u,function(){var p=o[Symbol.asyncIterator]();Et(l,u,function(){p.next().then(function(m){m.done?l.complete():l.next(m.value)})},0,!0)})})}function Ve(o,u){return u?function(o,u){if(null!=o){if(it(o))return function(o,u){return kr(o).pipe(zn(u),fn(u))}(o,u);if(Ie(o))return function(o,u){return new Ke(function(l){var p=0;return u.schedule(function(){p===o.length?l.complete():(l.next(o[p++]),l.closed||this.schedule())})})}(o,u);if(ze(o))return function(o,u){return kr(o).pipe(zn(u),fn(u))}(o,u);if(Dt(o))return $n(o,u);if(Cr(o))return function(o,u){return new Ke(function(l){var p;return Et(l,u,function(){p=o[ir](),Et(l,u,function(){var m,S;try{var M=p.next();m=M.value,S=M.done}catch(P){return void l.error(P)}S?l.complete():l.next(m)},0,!0)}),function(){return oe(null==p?void 0:p.return)&&p.return()}})}(o,u);if(Xr(o))return function(o,u){return $n(Hr(o),u)}(o,u)}throw xt(o)}(o,u):kr(o)}function Ue(o){return o<=0?function(){return jt}:Gt(function(u,l){var p=0;u.subscribe(new Lt(l,function(m){++p<=o&&(l.next(m),o<=p&&l.complete())}))})}function Ft(o,u){if(!0===u)return o(),null;if(!1===u)return null;for(var l=arguments.length,p=new Array(l>2?l-2:0),m=2;m<l;m++)p[m-2]=arguments[m];return u.apply(void 0,p).pipe(Ue(1)).subscribe(function(){return o()})}function Nt(o){for(var u in o)if(o[u]===Nt)return u;throw Error("Could not find renamed property on target object.")}function Qt(o){if("string"==typeof o)return o;if(Array.isArray(o))return"["+o.map(Qt).join(", ")+"]";if(null==o)return""+o;if(o.overriddenName)return"".concat(o.overriddenName);if(o.name)return"".concat(o.name);var u=o.toString();if(null==u)return""+u;var l=u.indexOf("\n");return-1===l?u:u.substring(0,l)}function Ht(o,u){return null==o||""===o?null===u?"":u:null==u||""===u?o:o+" "+u}var Tr=Nt({__forward_ref__:Nt});function mn(o){return o.__forward_ref__=mn,o.toString=function(){return Qt(this())},o}function tr(o){return Zr(o)?o():o}function Zr(o){return"function"==typeof o&&o.hasOwnProperty(Tr)&&o.__forward_ref__===mn}var Or=function(o){b(l,o);var u=D(l);function l(p,m){var S;return _(this,l),(S=u.call(this,function(o,u){var l=o?"NG0".concat(o,": "):"";return"".concat(l).concat(u)}(p,m))).code=p,S}return l}(Q(Error));function cr(o){return"string"==typeof o?o:null==o?"":String(o)}function $r(o){return"function"==typeof o?o.name||o.toString():"object"==typeof o&&null!=o&&"function"==typeof o.type?o.type.name||o.type.toString():cr(o)}function Ti(o,u){var l=u?" in ".concat(u):"";throw new Or("201","No provider for ".concat($r(o)," found").concat(l))}function Po(o,u){null==o&&function(o,u,l,p){throw new Error("ASSERTION ERROR: ".concat(o)+(null==p?"":" [Expected=> ".concat(l," ").concat(p," ").concat(u," <=Actual]")))}(u,o,null,"!=")}function ln(o){return{token:o.token,providedIn:o.providedIn||null,factory:o.factory,value:void 0}}function zo(o){return{providers:o.providers||[],imports:o.imports||[]}}function Ru(o){return V0(o,uo)||V0(o,Du)}function V0(o,u){return o.hasOwnProperty(u)?o[u]:null}function U0(o){return o&&(o.hasOwnProperty(El)||o.hasOwnProperty(Ou))?o[El]:null}var bs,uo=Nt({"\u0275prov":Nt}),El=Nt({"\u0275inj":Nt}),Du=Nt({ngInjectableDef:Nt}),Ou=Nt({ngInjectorDef:Nt}),tn=function(){return(tn=tn||{})[tn.Default=0]="Default",tn[tn.Host=1]="Host",tn[tn.Self=2]="Self",tn[tn.SkipSelf=4]="SkipSelf",tn[tn.Optional=8]="Optional",tn}();function H0(){return bs}function Xa(o){var u=bs;return bs=o,u}function If(o,u,l){var p=Ru(o);return p&&"root"==p.providedIn?void 0===p.value?p.value=p.factory():p.value:l&tn.Optional?null:void 0!==u?u:void Ti(Qt(o),"Injector")}function Ya(o){return{toString:o}.toString()}var la=function(){return(la=la||{})[la.OnPush=0]="OnPush",la[la.Default=1]="Default",la}(),Aa=function(){return function(o){o[o.Emulated=0]="Emulated",o[o.None=2]="None",o[o.ShadowDom=3]="ShadowDom"}(Aa||(Aa={})),Aa}(),W0="undefined"!=typeof globalThis&&globalThis,Er="undefined"!=typeof window&&window,zi="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Fr="undefined"!=typeof global&&global,jn=W0||Fr||Er||zi,Nn={},Xn=[],Ka=Nt({"\u0275cmp":Nt}),Rl=Nt({"\u0275dir":Nt}),$s=Nt({"\u0275pipe":Nt}),Dl=Nt({"\u0275mod":Nt}),jo=Nt({"\u0275fac":Nt}),el=Nt({__NG_ELEMENT_ID__:Nt}),z0=0;function Ei(o){return Ya(function(){var l={},p={type:o.type,providersResolver:null,decls:o.decls,vars:o.vars,factory:null,template:o.template||null,consts:o.consts||null,ngContentSelectors:o.ngContentSelectors,hostBindings:o.hostBindings||null,hostVars:o.hostVars||0,hostAttrs:o.hostAttrs||null,contentQueries:o.contentQueries||null,declaredInputs:l,inputs:null,outputs:null,exportAs:o.exportAs||null,onPush:o.changeDetection===la.OnPush,directiveDefs:null,pipeDefs:null,selectors:o.selectors||Xn,viewQuery:o.viewQuery||null,features:o.features||null,data:o.data||{},encapsulation:o.encapsulation||Aa.Emulated,id:"c",styles:o.styles||Xn,_:null,setInput:null,schemas:o.schemas||null,tView:null},m=o.directives,S=o.features,M=o.pipes;return p.id+=z0++,p.inputs=ua(o.inputs,l),p.outputs=ua(o.outputs),S&&S.forEach(function(P){return P(p)}),p.directiveDefs=m?function(){return("function"==typeof m?m():m).map(Fu)}:null,p.pipeDefs=M?function(){return("function"==typeof M?M():M).map(So)}:null,p})}function Fu(o){return ki(o)||function(o){return o[Rl]||null}(o)}function So(o){return function(o){return o[$s]||null}(o)}var _p={};function ji(o){return Ya(function(){var u={type:o.type,bootstrap:o.bootstrap||Xn,declarations:o.declarations||Xn,imports:o.imports||Xn,exports:o.exports||Xn,transitiveCompileScopes:null,schemas:o.schemas||null,id:o.id||null};return null!=o.id&&(_p[o.id]=o.type),u})}function ua(o,u){if(null==o)return Nn;var l={};for(var p in o)if(o.hasOwnProperty(p)){var m=o[p],S=m;Array.isArray(m)&&(S=m[1],m=m[0]),l[m]=p,u&&(u[m]=S)}return l}var no=Ei;function xo(o){return{type:o.type,name:o.name,factory:null,pure:!1!==o.pure,onDestroy:o.type.prototype.ngOnDestroy||null}}function ki(o){return o[Ka]||null}function bo(o,u){var l=o[Dl]||null;if(!l&&!0===u)throw new Error("Type ".concat(Qt(o)," does not have '\u0275mod' property."));return l}function Ra(o){return Array.isArray(o)&&"object"==typeof o[1]}function Yo(o){return Array.isArray(o)&&!0===o[1]}function Gf(o){return 0!=(8&o.flags)}function Da(o){return 2==(2&o.flags)}function Nl(o){return 1==(1&o.flags)}function To(o){return null!==o.template}function W1(o){return 0!=(512&o[2])}function Es(o,u){return o.hasOwnProperty(jo)?o[jo]:null}var Mp=function(){function o(u,l,p){_(this,o),this.previousValue=u,this.currentValue=l,this.firstChange=p}return w(o,[{key:"isFirstChange",value:function(){return this.firstChange}}]),o}();function Oa(){return Uf}function Uf(o){return o.type.prototype.ngOnChanges&&(o.setInput=Bi),qo}function qo(){var o=Ep(this),u=null==o?void 0:o.current;if(u){var l=o.previous;if(l===Nn)o.previous=u;else for(var p in u)l[p]=u[p];o.current=null,this.ngOnChanges(u)}}function Bi(o,u,l,p){var m=Ep(o)||function(o,u){return o[Tp]=u}(o,{previous:Nn,current:null}),S=m.current||(m.current={}),M=m.previous,P=this.declaredInputs[l],N=M[P];S[P]=new Mp(N&&N.currentValue,u,M===Nn),o[p]=u}Oa.ngInherit=!0;var Tp="__ngSimpleChanges__";function Ep(o){return o[Tp]||null}var Hf="http://www.w3.org/2000/svg",Wf=void 0;function li(o){return!!o.listen}var Pp={createRenderer:function(u,l){return void 0!==Wf?Wf:"undefined"!=typeof document?document:void 0}};function Si(o){for(;Array.isArray(o);)o=o[0];return o}function ri(o,u){return Si(u[o])}function Ko(o,u){return Si(u[o.index])}function $a(o,u){return o.data[u]}function Fo(o,u){var l=u[o];return Ra(l)?l:l[0]}function Fp(o){return 4==(4&o[2])}function Bu(o){return 128==(128&o[2])}function Oi(o,u){return null==u?null:o[u]}function q0(o){o[18]=0}function Xf(o,u){o[5]+=u;for(var l=o,p=o[3];null!==p&&(1===u&&1===l[5]||-1===u&&0===l[5]);)p[5]+=u,l=p,p=p[3]}var Yr={lFrame:ec(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Yf(){return Yr.bindingsEnabled}function Wt(){return Yr.lFrame.lView}function Mn(){return Yr.lFrame.tView}function es(o){return Yr.lFrame.contextLView=o,o[8]}function xi(){for(var o=K0();null!==o&&64===o.type;)o=o.parent;return o}function K0(){return Yr.lFrame.currentTNode}function Pa(o,u){var l=Yr.lFrame;l.currentTNode=o,l.isParent=u}function Yt(){return Yr.lFrame.isParent}function qf(){Yr.lFrame.isParent=!1}function Qo(){return Yr.isInCheckNoChangesMode}function Q0(o){Yr.isInCheckNoChangesMode=o}function oo(){var o=Yr.lFrame,u=o.bindingRootIndex;return-1===u&&(u=o.bindingRootIndex=o.tView.bindingStartIndex),u}function Lo(){return Yr.lFrame.bindingIndex}function kl(){return Yr.lFrame.bindingIndex++}function ca(o){var u=Yr.lFrame,l=u.bindingIndex;return u.bindingIndex=u.bindingIndex+o,l}function uy(o,u){var l=Yr.lFrame;l.bindingIndex=l.bindingRootIndex=o,Z0(u)}function Z0(o){Yr.lFrame.currentDirectiveIndex=o}function kp(){return Yr.lFrame.currentQueryIndex}function $0(o){Yr.lFrame.currentQueryIndex=o}function cy(o){var u=o[1];return 2===u.type?u.declTNode:1===u.type?o[6]:null}function Qf(o,u,l){if(l&tn.SkipSelf){for(var p=u,m=o;!(null!==(p=p.parent)||l&tn.Host||null===(p=cy(m))||(m=m[15],10&p.type)););if(null===p)return!1;u=p,o=m}var S=Yr.lFrame=Bp();return S.currentTNode=u,S.lView=o,!0}function Bl(o){var u=Bp(),l=o[1];Yr.lFrame=u,u.currentTNode=l.firstChild,u.lView=o,u.tView=l,u.contextLView=o,u.bindingIndex=l.bindingStartIndex,u.inI18n=!1}function Bp(){var o=Yr.lFrame,u=null===o?null:o.child;return null===u?ec(o):u}function ec(o){var u={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:o,child:null,inI18n:!1};return null!==o&&(o.child=u),u}function Fa(){var o=Yr.lFrame;return Yr.lFrame=o.parent,o.currentTNode=null,o.lView=null,o}var Gp=Fa;function La(){var o=Fa();o.isParent=!0,o.tView=null,o.selectedIndex=-1,o.contextLView=null,o.elementDepthCount=0,o.currentDirectiveIndex=-1,o.currentNamespace=null,o.bindingRootIndex=-1,o.bindingIndex=-1,o.currentQueryIndex=0}function Xi(o){var u=Yr.lFrame.contextLView=function(o,u){for(;o>0;)u=u[15],o--;return u}(o,Yr.lFrame.contextLView);return u[8]}function po(){return Yr.lFrame.selectedIndex}function ui(o){Yr.lFrame.selectedIndex=o}function ci(){var o=Yr.lFrame;return $a(o.tView,o.selectedIndex)}function Uu(o,u){for(var l=u.directiveStart,p=u.directiveEnd;l<p;l++){var S=o.data[l].type.prototype,M=S.ngAfterContentInit,P=S.ngAfterContentChecked,N=S.ngAfterViewInit,G=S.ngAfterViewChecked,ie=S.ngOnDestroy;M&&(o.contentHooks||(o.contentHooks=[])).push(-l,M),P&&((o.contentHooks||(o.contentHooks=[])).push(l,P),(o.contentCheckHooks||(o.contentCheckHooks=[])).push(l,P)),N&&(o.viewHooks||(o.viewHooks=[])).push(-l,N),G&&((o.viewHooks||(o.viewHooks=[])).push(l,G),(o.viewCheckHooks||(o.viewCheckHooks=[])).push(l,G)),null!=ie&&(o.destroyHooks||(o.destroyHooks=[])).push(l,ie)}}function rc(o,u,l){Hp(o,u,3,l)}function Gl(o,u,l,p){(3&o[2])===l&&Hp(o,u,l,p)}function Zf(o,u){var l=o[2];(3&l)===u&&(l&=2047,o[2]=l+=1)}function Hp(o,u,l,p){for(var S=null!=p?p:-1,M=u.length-1,P=0,N=void 0!==p?65535&o[18]:0;N<M;N++)if("number"==typeof u[N+1]){if(P=u[N],null!=p&&P>=p)break}else u[N]<0&&(o[18]+=65536),(P<S||-1==S)&&(dy(o,l,u,N),o[18]=(4294901760&o[18])+N+2),N++}function dy(o,u,l,p){var m=l[p]<0,S=l[p+1],P=o[m?-l[p]:l[p]];if(m){if(o[2]>>11<o[18]>>16&&(3&o[2])===u){o[2]+=2048;try{S.call(P)}finally{}}}else try{S.call(P)}finally{}}var Hu=function o(u,l,p){_(this,o),this.factory=u,this.resolving=!1,this.canSeeViewProviders=l,this.injectImpl=p};function oc(o,u,l){for(var p=li(o),m=0;m<l.length;){var S=l[m];if("number"==typeof S){if(0!==S)break;m++;var M=l[m++],P=l[m++],N=l[m++];p?o.setAttribute(u,P,N,M):u.setAttributeNS(M,P,N)}else{var G=S,ie=l[++m];ed(G)?p&&o.setProperty(u,G,ie):p?o.setAttribute(u,G,ie):u.setAttribute(G,ie),m++}}return m}function zp(o){return 3===o||4===o||6===o}function ed(o){return 64===o.charCodeAt(0)}function zu(o,u){if(null!==u&&0!==u.length)if(null===o||0===o.length)o=u.slice();else for(var l=-1,p=0;p<u.length;p++){var m=u[p];"number"==typeof m?l=m:0===l||No(o,l,m,null,-1===l||2===l?u[++p]:null)}return o}function No(o,u,l,p,m){var S=0,M=o.length;if(-1===u)M=-1;else for(;S<o.length;){var P=o[S++];if("number"==typeof P){if(P===u){M=-1;break}if(P>u){M=S-1;break}}}for(;S<o.length;){var N=o[S];if("number"==typeof N)break;if(N===l){if(null===p)return void(null!==m&&(o[S+1]=m));if(p===o[S+1])return void(o[S+2]=m)}S++,null!==p&&S++,null!==m&&S++}-1!==M&&(o.splice(M,0,u),S=M+1),o.splice(S++,0,l),null!==p&&o.splice(S++,0,p),null!==m&&o.splice(S++,0,m)}function jp(o){return-1!==o}function vo(o){return 32767&o}function Ul(o,u){for(var l=function(o){return o>>16}(o),p=u;l>0;)p=p[15],l--;return p}var ju=!0;function ac(o){var u=ju;return ju=o,u}var yy=0;function Xu(o,u){var l=Yu(o,u);if(-1!==l)return l;var p=u[1];p.firstCreatePass&&(o.injectorIndex=u.length,sc(p.data,o),sc(u,null),sc(p.blueprint,null));var m=lc(o,u),S=o.injectorIndex;if(jp(m))for(var M=vo(m),P=Ul(m,u),N=P[1].data,G=0;G<8;G++)u[S+G]=P[M+G]|N[M+G];return u[S+8]=m,S}function sc(o,u){o.push(0,0,0,0,0,0,0,0,u)}function Yu(o,u){return-1===o.injectorIndex||o.parent&&o.parent.injectorIndex===o.injectorIndex||null===u[o.injectorIndex+8]?-1:o.injectorIndex}function lc(o,u){if(o.parent&&-1!==o.parent.injectorIndex)return o.parent.injectorIndex;for(var l=0,p=null,m=u;null!==m;){var S=m[1],M=S.type;if(null===(p=2===M?S.declTNode:1===M?m[6]:null))return-1;if(l++,m=m[15],-1!==p.injectorIndex)return p.injectorIndex|l<<16}return-1}function qu(o,u,l){!function(o,u,l){var p;"string"==typeof l?p=l.charCodeAt(0)||0:l.hasOwnProperty(el)&&(p=l[el]),null==p&&(p=l[el]=yy++);var m=255&p;u.data[o+(m>>5)]|=1<<m}(o,u,l)}function qp(o,u,l){if(l&tn.Optional)return o;Ti(u,"NodeInjector")}function Ku(o,u,l,p){if(l&tn.Optional&&void 0===p&&(p=null),0==(l&(tn.Self|tn.Host))){var m=o[9],S=Xa(void 0);try{return m?m.get(u,p,l&tn.Optional):If(u,p,l&tn.Optional)}finally{Xa(S)}}return qp(p,u,l)}function Kp(o,u,l){var p=arguments.length>3&&void 0!==arguments[3]?arguments[3]:tn.Default,m=arguments.length>4?arguments[4]:void 0;if(null!==o){var S=Qp(l);if("function"==typeof S){if(!Qf(u,o,p))return p&tn.Host?qp(m,l,p):Ku(u,l,p,m);try{var M=S(p);if(null!=M||p&tn.Optional)return M;Ti(l)}finally{Gp()}}else if("number"==typeof S){var P=null,N=Yu(o,u),G=-1,ie=p&tn.Host?u[16][6]:null;for((-1===N||p&tn.SkipSelf)&&(-1!==(G=-1===N?lc(o,u):u[N+8])&&Zp(p,!1)?(P=u[1],N=vo(G),u=Ul(G,u)):N=-1);-1!==N;){var ye=u[1];if(Jp(S,N,ye.data)){var Ce=Sy(N,u,l,P,p,ie);if(Ce!==td)return Ce}-1!==(G=u[N+8])&&Zp(p,u[1].data[N+8]===ie)&&Jp(S,N,u)?(P=ye,N=vo(G),u=Ul(G,u)):N=-1}}}return Ku(u,l,p,m)}var td={};function wy(){return new il(xi(),Wt())}function Sy(o,u,l,p,m,S){var M=u[1],P=M.data[o+8],ie=uc(P,M,l,null==p?Da(P)&&ju:p!=M&&0!=(3&P.type),m&tn.Host&&S===P);return null!==ie?Qu(u,M,ie,P):td}function uc(o,u,l,p,m){for(var S=o.providerIndexes,M=u.data,P=1048575&S,N=o.directiveStart,ie=S>>20,Ce=m?P+ie:o.directiveEnd,Le=p?P:P+ie;Le<Ce;Le++){var qe=M[Le];if(Le<N&&l===qe||Le>=N&&qe.type===l)return Le}if(m){var nt=M[N];if(nt&&To(nt)&&nt.type===l)return N}return null}function Qu(o,u,l,p){var m=o[l],S=u.data;if(function(o){return o instanceof Hu}(m)){var M=m;M.resolving&&function(o,u){throw new Or("200","Circular dependency in DI detected for ".concat(o).concat(""))}($r(S[l]));var P=ac(M.canSeeViewProviders);M.resolving=!0;var N=M.injectImpl?Xa(M.injectImpl):null;Qf(o,p,tn.Default);try{m=o[l]=M.factory(void 0,S,o,p),u.firstCreatePass&&l>=p.directiveStart&&function(o,u,l){var p=u.type.prototype,S=p.ngOnInit,M=p.ngDoCheck;if(p.ngOnChanges){var P=Uf(u);(l.preOrderHooks||(l.preOrderHooks=[])).push(o,P),(l.preOrderCheckHooks||(l.preOrderCheckHooks=[])).push(o,P)}S&&(l.preOrderHooks||(l.preOrderHooks=[])).push(0-o,S),M&&((l.preOrderHooks||(l.preOrderHooks=[])).push(o,M),(l.preOrderCheckHooks||(l.preOrderCheckHooks=[])).push(o,M))}(l,S[l],u)}finally{null!==N&&Xa(N),ac(P),M.resolving=!1,Gp()}}return m}function Qp(o){if("string"==typeof o)return o.charCodeAt(0)||0;var u=o.hasOwnProperty(el)?o[el]:void 0;return"number"==typeof u?u>=0?255&u:wy:u}function Jp(o,u,l){return!!(l[u+(o>>5)]&1<<o)}function Zp(o,u){return!(o&tn.Self||o&tn.Host&&u)}var il=function(){function o(u,l){_(this,o),this._tNode=u,this._lView=l}return w(o,[{key:"get",value:function(l,p,m){return Kp(this._tNode,this._lView,l,m,p)}}]),o}();function rd(o){return Zr(o)?function(){var u=rd(tr(o));return u&&u()}:Es(o)}function Hl(o){return function(o,u){if("class"===u)return o.classes;if("style"===u)return o.styles;var l=o.attrs;if(l)for(var p=l.length,m=0;m<p;){var S=l[m];if(zp(S))break;if(0===S)m+=2;else if("number"==typeof S)for(m++;m<p&&"string"==typeof l[m];)m++;else{if(S===u)return l[m+1];m+=2}}return null}(xi(),o)}var Wl="__parameters__",Jo="__prop__metadata__";function zl(o){return function(){if(o){var l=o.apply(void 0,arguments);for(var p in l)this[p]=l[p]}}}function Na(o,u,l){return Ya(function(){var p=zl(u);function m(){for(var S=arguments.length,M=new Array(S),P=0;P<S;P++)M[P]=arguments[P];if(this instanceof m)return p.apply(this,M),this;var N=K(m,M);return G.annotation=N,G;function G(ie,ye,Ce){for(var Le=ie.hasOwnProperty(Wl)?ie[Wl]:Object.defineProperty(ie,Wl,{value:[]})[Wl];Le.length<=Ce;)Le.push(null);return(Le[Ce]=Le[Ce]||[]).push(N),ie}}return l&&(m.prototype=Object.create(l.prototype)),m.prototype.ngMetadataName=o,m.annotationCls=m,m})}function jl(o,u,l,p){return Ya(function(){var m=zl(u);function S(){for(var M=arguments.length,P=new Array(M),N=0;N<M;N++)P[N]=arguments[N];if(this instanceof S)return m.apply(this,P),this;var G=K(S,P);function ie(ye,Ce){var Le=ye.constructor,qe=Le.hasOwnProperty(Jo)?Le[Jo]:Object.defineProperty(Le,Jo,{value:{}})[Jo];qe[Ce]=qe.hasOwnProperty(Ce)&&qe[Ce]||[],qe[Ce].unshift(G),p&&p.apply(void 0,[ye,Ce].concat(P))}return ie}return l&&(S.prototype=Object.create(l.prototype)),S.prototype.ngMetadataName=o,S.annotationCls=S,S})}var xn=function(){function o(u,l){_(this,o),this._desc=u,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof l?this.__NG_ELEMENT_ID__=l:void 0!==l&&(this.\u0275prov=ln({token:this,providedIn:l.providedIn||"root",factory:l.factory}))}return w(o,[{key:"toString",value:function(){return"InjectionToken ".concat(this._desc)}}]),o}(),nd=new xn("AnalyzeForEntryComponents"),cc=function o(){_(this,o)},Xl=jl("ContentChildren",function(o){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.assign({selector:o,first:!1,isViewQuery:!1,descendants:!1,emitDistinctChangesOnly:!0},u)},cc);function Zo(o,u){void 0===u&&(u=o);for(var l=0;l<o.length;l++){var p=o[l];Array.isArray(p)?(u===o&&(u=o.slice(0,l)),Zo(p,u)):u!==o&&u.push(p)}return u}function Ia(o,u){o.forEach(function(l){return Array.isArray(l)?Ia(l,u):u(l)})}function ev(o,u,l){u>=o.length?o.push(l):o.splice(u,0,l)}function fc(o,u){return u>=o.length-1?o.pop():o.splice(u,1)[0]}function Eo(o,u,l){var p=Yl(o,u);return p>=0?o[1|p]=l:function(o,u,l,p){var m=o.length;if(m==u)o.push(l,p);else if(1===m)o.push(p,o[0]),o[0]=l;else{for(m--,o.push(o[m-1],o[m]);m>u;)o[m]=o[m-2],m--;o[u]=l,o[u+1]=p}}(o,p=~p,u,l),p}function ad(o,u){var l=Yl(o,u);if(l>=0)return o[1|l]}function Yl(o,u){return function(o,u,l){for(var p=0,m=o.length>>l;m!==p;){var S=p+(m-p>>1),M=o[S<<l];if(u===M)return S<<l;M>u?m=S:p=S+1}return~(m<<l)}(o,u,1)}var sl={},ld="__NG_DI_FLAG__",hc="ngTempTokenPath",Ly=/\n/gm,Ot="__source",iv=Nt({provide:String,useValue:Nt}),$u=void 0;function ud(o){var u=$u;return $u=o,u}function vr(o){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tn.Default;if(void 0===$u)throw new Error("inject() must be called from an injection context");return null===$u?If(o,void 0,u):$u.get(o,u&tn.Optional?null:void 0,u)}function Rr(o){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tn.Default;return(H0()||vr)(tr(o),u)}function cd(o){for(var u=[],l=0;l<o.length;l++){var p=tr(o[l]);if(Array.isArray(p)){if(0===p.length)throw new Error("Arguments array must have arguments.");for(var m=void 0,S=tn.Default,M=0;M<p.length;M++){var P=p[M],N=fd(P);"number"==typeof N?-1===N?m=P.token:S|=N:m=P}u.push(Rr(m,S))}else u.push(Rr(p))}return u}function Kl(o,u){return o[ld]=u,o.prototype[ld]=u,o}function fd(o){return o[ld]}function av(o,u,l,p){var m=o[hc];throw u[Ot]&&m.unshift(u[Ot]),o.message=function(o,u,l){var p=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;o=o&&"\n"===o.charAt(0)&&"\u0275"==o.charAt(1)?o.substr(2):o;var m=Qt(u);if(Array.isArray(u))m=u.map(Qt).join(" -> ");else if("object"==typeof u){var S=[];for(var M in u)if(u.hasOwnProperty(M)){var P=u[M];S.push(M+":"+("string"==typeof P?JSON.stringify(P):Qt(P)))}m="{".concat(S.join(", "),"}")}return"".concat(l).concat(p?"("+p+")":"","[").concat(m,"]: ").concat(o.replace(Ly,"\n  "))}("\n"+o.message,m,l,p),o.ngTokenPath=m,o[hc]=null,o}var r0=Kl(Na("Inject",function(o){return{token:o}}),-1),Ba=Kl(Na("Optional"),8),Ql=Kl(Na("SkipSelf"),4),gd=function(){function o(u){_(this,o),this.changingThisBreaksApplicationSecurity=u}return w(o,[{key:"toString",value:function(){return"SafeValue must use [property]=binding: ".concat(this.changingThisBreaksApplicationSecurity)+" (see https://g.co/ng/security#xss)"}}]),o}();function go(o){return o instanceof gd?o.changingThisBreaksApplicationSecurity:o}var vv=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Zy=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var vi=function(){return(vi=vi||{})[vi.NONE=0]="NONE",vi[vi.HTML=1]="HTML",vi[vi.STYLE=2]="STYLE",vi[vi.SCRIPT=3]="SCRIPT",vi[vi.URL=4]="URL",vi[vi.RESOURCE_URL=5]="RESOURCE_URL",vi}();function qi(o){var u=function(){var o=Wt();return o&&o[12]}();return u?u.sanitize(vi.URL,o)||"":function(o,u){var l=function(o){return o instanceof gd&&o.getTypeName()||null}(o);if(null!=l&&l!==u){if("ResourceURL"===l&&"URL"===u)return!0;throw new Error("Required a safe ".concat(u,", got a ").concat(l," (see https://g.co/ng/security#xss)"))}return l===u}(o,"URL")?go(o):function(o){return(o=String(o)).match(vv)||o.match(Zy)?o:"unsafe:"+o}(cr(o))}var Av="__ngContext__";function fi(o,u){o[Av]=u}function s0(o){var u=function(o){return o[Av]||null}(o);return u?Array.isArray(u)?u:u.lView:null}function Sd(o){return o.ngOriginalError}function p2(o){for(var u=arguments.length,l=new Array(u>1?u-1:0),p=1;p<u;p++)l[p-1]=arguments[p];o.error.apply(o,l)}var eu=function(){function o(){_(this,o),this._console=console}return w(o,[{key:"handleError",value:function(l){var p=this._findOriginalError(l),m=function(o){return o&&o.ngErrorLogger||p2}(l);m(this._console,"ERROR",l),p&&m(this._console,"ORIGINAL ERROR",p)}},{key:"_findOriginalError",value:function(l){for(var p=l&&Sd(l);p&&Sd(p);)p=Sd(p);return p||null}}]),o}(),Dv=function(){return("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(jn)}();function da(o){return o instanceof Function?o():o}var ko=function(){return(ko=ko||{})[ko.Important=1]="Important",ko[ko.DashCase=2]="DashCase",ko}();function Rc(o,u){return undefined(o,u)}function pl(o){var u=o[3];return Yo(u)?u[3]:u}function Md(o){return Pv(o[13])}function Dc(o){return Pv(o[4])}function Pv(o){for(;null!==o&&!Yo(o);)o=o[4];return o}function Ki(o,u,l,p,m){if(null!=p){var S,M=!1;Yo(p)?S=p:Ra(p)&&(M=!0,p=p[0]);var P=Si(p);0===o&&null!==l?null==m?Wv(u,l,P):Fs(u,l,P,m||null,!0):1===o&&null!==l?Fs(u,l,P,m||null,!0):2===o?function(o,u,l){var p=Pc(o,u);p&&function(o,u,l,p){li(o)?o.removeChild(u,l,p):u.removeChild(l)}(o,p,u,l)}(u,P,M):3===o&&u.destroyNode(P),null!=S&&function(o,u,l,p,m){var S=l[7];S!==Si(l)&&Ki(u,o,p,S,m);for(var P=10;P<l.length;P++){var N=l[P];f0(N[1],N,o,u,p,S)}}(u,o,S,l,m)}}function Oc(o,u){return li(o)?o.createText(u):o.createTextNode(u)}function mo(o,u,l){return li(o)?o.createElement(u,l):null===l?o.createElement(u):o.createElementNS(l,u)}function Gv(o,u){var l=o[9],p=l.indexOf(u),m=u[3];1024&u[2]&&(u[2]&=-1025,Xf(m,-1)),l.splice(p,1)}function Td(o,u){if(!(o.length<=10)){var l=10+u,p=o[l];if(p){var m=p[17];null!==m&&m!==o&&Gv(m,p),u>0&&(o[l-1][4]=p[4]);var S=fc(o,10+u);!function(o,u){f0(o,u,u[11],2,null,null),u[0]=null,u[6]=null}(p[1],p);var M=S[19];null!==M&&M.detachView(S[1]),p[3]=null,p[4]=null,p[2]&=-129}return p}}function vl(o,u){if(!(256&u[2])){var l=u[11];li(l)&&l.destroyNode&&f0(o,u,l,3,null,null),function(o){var u=o[13];if(!u)return Ed(o[1],o);for(;u;){var l=null;if(Ra(u))l=u[13];else{var p=u[10];p&&(l=p)}if(!l){for(;u&&!u[4]&&u!==o;)Ra(u)&&Ed(u[1],u),u=u[3];null===u&&(u=o),Ra(u)&&Ed(u[1],u),l=u&&u[4]}u=l}}(u)}}function Ed(o,u){if(!(256&u[2])){u[2]&=-129,u[2]|=256,function(o,u){var l;if(null!=o&&null!=(l=o.destroyHooks))for(var p=0;p<l.length;p+=2){var m=u[l[p]];if(!(m instanceof Hu)){var S=l[p+1];if(Array.isArray(S))for(var M=0;M<S.length;M+=2){var P=m[S[M]],N=S[M+1];try{N.call(P)}finally{}}else try{S.call(m)}finally{}}}}(o,u),function(o,u){var l=o.cleanup,p=u[7],m=-1;if(null!==l)for(var S=0;S<l.length-1;S+=2)if("string"==typeof l[S]){var M=l[S+1],P="function"==typeof M?M(u):Si(u[M]),N=p[m=l[S+2]],G=l[S+3];"boolean"==typeof G?P.removeEventListener(l[S],N,G):G>=0?p[m=G]():p[m=-G].unsubscribe(),S+=2}else{var ie=p[m=l[S+1]];l[S].call(ie)}if(null!==p){for(var ye=m+1;ye<p.length;ye++)(0,p[ye])();u[7]=null}}(o,u),1===u[1].type&&li(u[11])&&u[11].destroy();var l=u[17];if(null!==l&&Yo(u[3])){l!==u[3]&&Gv(l,u);var p=u[19];null!==p&&p.detachView(o)}}}function Uv(o,u,l){return function(o,u,l){for(var p=u;null!==p&&40&p.type;)p=(u=p).parent;if(null===p)return l[0];if(2&p.flags){var m=o.data[p.directiveStart].encapsulation;if(m===Aa.None||m===Aa.Emulated)return null}return Ko(p,l)}(o,u.parent,l)}function Fs(o,u,l,p,m){li(o)?o.insertBefore(u,l,p,m):u.insertBefore(l,p,m)}function Wv(o,u,l){li(o)?o.appendChild(u,l):u.appendChild(l)}function zv(o,u,l,p,m){null!==p?Fs(o,u,l,p,m):Wv(o,u,l)}function Pc(o,u){return li(o)?o.parentNode(u):u.parentNode}var Yv=function(o,u,l){return 40&o.type?Ko(o,l):null};function Lc(o,u,l,p){var m=Uv(o,p,u),S=u[11],P=function(o,u,l){return Yv(o,u,l)}(p.parent||u[6],p,u);if(null!=m)if(Array.isArray(l))for(var N=0;N<l.length;N++)zv(S,m,l[N],P,!1);else zv(S,m,l,P,!1)}function Nc(o,u){if(null!==u){var l=u.type;if(3&l)return Ko(u,o);if(4&l)return nu(-1,o[u.index]);if(8&l){var p=u.child;if(null!==p)return Nc(o,p);var m=o[u.index];return Yo(m)?nu(-1,m):Si(m)}if(32&l)return Rc(u,o)()||Si(o[u.index]);var P=Kv(o,u);return null!==P?Array.isArray(P)?P[0]:Nc(pl(o[16]),P):Nc(o,u.next)}return null}function Kv(o,u){return null!==u?o[16][6].projection[u.projection]:null}function nu(o,u){var l=10+o+1;if(l<u.length){var p=u[l],m=p[1].firstChild;if(null!==m)return Nc(p,m)}return u[7]}function rs(o,u,l,p,m,S,M){for(;null!=l;){var P=p[l.index],N=l.type;if(M&&0===u&&(P&&fi(Si(P),p),l.flags|=4),64!=(64&l.flags))if(8&N)rs(o,u,l.child,p,m,S,!1),Ki(u,o,m,P,S);else if(32&N){for(var G=Rc(l,p),ie=void 0;ie=G();)Ki(u,o,m,ie,S);Ki(u,o,m,P,S)}else 16&N?_n(o,u,p,l,m,S):Ki(u,o,m,P,S);l=M?l.projectionNext:l.next}}function f0(o,u,l,p,m,S){rs(l,p,o.firstChild,u,m,S,!1)}function _n(o,u,l,p,m,S){var M=l[16],N=M[6].projection[p.projection];if(Array.isArray(N))for(var G=0;G<N.length;G++)Ki(u,o,m,N[G],S);else rs(o,u,N,M[3],m,S,!0)}function Rd(o,u,l){li(o)?o.setAttribute(u,"style",l):u.style.cssText=l}function Dd(o,u,l){li(o)?""===l?o.removeAttribute(u,"class"):o.setAttribute(u,"class",l):u.className=l}function Od(o,u,l){for(var p=o.length;;){var m=o.indexOf(u,l);if(-1===m)return m;if(0===m||o.charCodeAt(m-1)<=32){var S=u.length;if(m+S===p||o.charCodeAt(m+S)<=32)return m}l=m+1}}var Pd="ng-template";function $v(o,u,l){for(var p=0;p<o.length;){var m=o[p++];if(l&&"class"===m){if(-1!==Od((m=o[p]).toLowerCase(),u,0))return!0}else if(1===m){for(;p<o.length&&"string"==typeof(m=o[p++]);)if(m.toLowerCase()===u)return!0;return!1}}return!1}function eg(o){return 4===o.type&&o.value!==Pd}function pa(o,u,l){return u===(4!==o.type||l?o.value:Pd)}function T2(o,u,l){for(var p=4,m=o.attrs||[],S=function(o){for(var u=0;u<o.length;u++)if(zp(o[u]))return u;return o.length}(m),M=!1,P=0;P<u.length;P++){var N=u[P];if("number"!=typeof N){if(!M)if(4&p){if(p=2|1&p,""!==N&&!pa(o,N,l)||""===N&&1===u.length){if(so(p))return!1;M=!0}}else{var G=8&p?N:u[++P];if(8&p&&null!==o.attrs){if(!$v(o.attrs,G,l)){if(so(p))return!1;M=!0}continue}var ye=E2(8&p?"class":N,m,eg(o),l);if(-1===ye){if(so(p))return!1;M=!0;continue}if(""!==G){var Ce;Ce=ye>S?"":m[ye+1].toLowerCase();var Le=8&p?Ce:null;if(Le&&-1!==Od(Le,G,0)||2&p&&G!==Ce){if(so(p))return!1;M=!0}}}}else{if(!M&&!so(p)&&!so(N))return!1;if(M&&so(N))continue;M=!1,p=N|1&p}}return so(p)||M}function so(o){return 0==(1&o)}function E2(o,u,l,p){if(null===u)return-1;var m=0;if(p||!l){for(var S=!1;m<u.length;){var M=u[m];if(M===o)return m;if(3===M||6===M)S=!0;else{if(1===M||2===M){for(var P=u[++m];"string"==typeof P;)P=u[++m];continue}if(4===M)break;if(0===M){m+=4;continue}}m+=S?1:2}return-1}return function(o,u){var l=o.indexOf(4);if(l>-1)for(l++;l<o.length;){var p=o[l];if("number"==typeof p)return-1;if(p===u)return l;l++}return-1}(u,o)}function iu(o,u){for(var l=arguments.length>2&&void 0!==arguments[2]&&arguments[2],p=0;p<u.length;p++)if(T2(o,u[p],l))return!0;return!1}function Fd(o,u){return o?":not("+u.trim()+")":u}function O2(o){for(var u=o[0],l=1,p=2,m="",S=!1;l<o.length;){var M=o[l];if("string"==typeof M)if(2&p){var P=o[++l];m+="["+M+(P.length>0?'="'+P+'"':"")+"]"}else 8&p?m+="."+M:4&p&&(m+=" "+M);else""!==m&&!so(M)&&(u+=Fd(S,m),m=""),p=M,S=S||!so(p);l++}return""!==m&&(u+=Fd(S,m)),u}var nn={};function wt(o){Ld(Mn(),Wt(),po()+o,Qo())}function Ld(o,u,l,p){if(!p)if(3==(3&u[2])){var S=o.preOrderCheckHooks;null!==S&&rc(u,S,l)}else{var M=o.preOrderHooks;null!==M&&Gl(u,M,0,l)}ui(l)}function ou(o,u){return o<<17|u<<2}function ta(o){return o>>17&32767}function kc(o){return 2|o}function is(o){return(131068&o)>>2}function Bc(o,u){return-131069&o|u<<2}function Id(o){return 1|o}function pg(o,u){var l=o.contentQueries;if(null!==l)for(var p=0;p<l.length;p+=2){var S=l[p+1];if(-1!==S){var M=o.data[S];$0(l[p]),M.contentQueries(2,u[S],S)}}}function p0(o,u,l,p,m,S,M,P,N,G){var ie=u.blueprint.slice();return ie[0]=m,ie[2]=140|p,q0(ie),ie[3]=ie[15]=o,ie[8]=l,ie[10]=M||o&&o[10],ie[11]=P||o&&o[11],ie[12]=N||o&&o[12]||null,ie[9]=G||o&&o[9]||null,ie[6]=S,ie[16]=2==u.type?o[16]:ie,ie}function os(o,u,l,p,m){var S=o.data[u];if(null===S)S=function(o,u,l,p,m){var S=K0(),M=Yt(),N=o.data[u]=function(o,u,l,p,m,S){return{type:l,index:p,insertBeforeIndex:null,injectorIndex:u?u.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:m,attrs:S,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:u,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,M?S:S&&S.parent,l,u,p,m);return null===o.firstChild&&(o.firstChild=N),null!==S&&(M?null==S.child&&null!==N.parent&&(S.child=N):null===S.next&&(S.next=N)),N}(o,u,l,p,m),Yr.lFrame.inI18n&&(S.flags|=64);else if(64&S.type){S.type=l,S.value=p,S.attrs=m;var M=function(){var o=Yr.lFrame,u=o.currentTNode;return o.isParent?u:u.parent}();S.injectorIndex=null===M?-1:M.injectorIndex}return Pa(S,!0),S}function au(o,u,l,p){if(0===l)return-1;for(var m=u.length,S=0;S<l;S++)u.push(p),o.blueprint.push(p),o.data.push(null);return m}function as(o,u,l){Bl(u);try{var p=o.viewQuery;null!==p&&oh(1,p,l);var m=o.template;null!==m&&yg(o,u,m,1,l),o.firstCreatePass&&(o.firstCreatePass=!1),o.staticContentQueries&&pg(o,u),o.staticViewQueries&&oh(2,o.viewQuery,l);var S=o.components;null!==S&&function(o,u){for(var l=0;l<u.length;l++)Og(o,u[l])}(u,S)}catch(M){throw o.firstCreatePass&&(o.incompleteFirstPass=!0,o.firstCreatePass=!1),M}finally{u[2]&=-5,La()}}function su(o,u,l,p){var m=u[2];if(256!=(256&m)){Bl(u);var S=Qo();try{q0(u),function(o){Yr.lFrame.bindingIndex=o}(o.bindingStartIndex),null!==l&&yg(o,u,l,2,p);var M=3==(3&m);if(!S)if(M){var P=o.preOrderCheckHooks;null!==P&&rc(u,P,null)}else{var N=o.preOrderHooks;null!==N&&Gl(u,N,0,null),Zf(u,0)}if(function(o){for(var u=Md(o);null!==u;u=Dc(u))if(u[2])for(var l=u[9],p=0;p<l.length;p++){var m=l[p];0==(1024&m[2])&&Xf(m[3],1),m[2]|=1024}}(u),function(o){for(var u=Md(o);null!==u;u=Dc(u))for(var l=10;l<u.length;l++){var p=u[l],m=p[1];Bu(p)&&su(m,p,m.template,p[8])}}(u),null!==o.contentQueries&&pg(o,u),!S)if(M){var G=o.contentCheckHooks;null!==G&&rc(u,G)}else{var ie=o.contentHooks;null!==ie&&Gl(u,ie,1),Zf(u,1)}!function(o,u){var l=o.hostBindingOpCodes;if(null!==l)try{for(var p=0;p<l.length;p++){var m=l[p];if(m<0)ui(~m);else{var S=m,M=l[++p],P=l[++p];uy(M,S),P(2,u[S])}}}finally{ui(-1)}}(o,u);var ye=o.components;null!==ye&&function(o,u){for(var l=0;l<u.length;l++)q2(o,u[l])}(u,ye);var Ce=o.viewQuery;if(null!==Ce&&oh(2,Ce,p),!S)if(M){var Le=o.viewCheckHooks;null!==Le&&rc(u,Le)}else{var qe=o.viewHooks;null!==qe&&Gl(u,qe,2),Zf(u,2)}!0===o.firstUpdatePass&&(o.firstUpdatePass=!1),S||(u[2]&=-73),1024&u[2]&&(u[2]&=-1025,Xf(u[3],-1))}finally{La()}}}function mg(o,u,l,p){var m=u[10],S=!Qo(),M=Fp(u);try{S&&!M&&m.begin&&m.begin(),M&&as(o,u,p),su(o,u,l,p)}finally{S&&!M&&m.end&&m.end()}}function yg(o,u,l,p,m){var S=po(),M=2&p;try{ui(-1),M&&u.length>20&&Ld(o,u,20,Qo()),l(p,m)}finally{ui(S)}}function Yd(o,u,l){if(Gf(u))for(var m=u.directiveEnd,S=u.directiveStart;S<m;S++){var M=o.data[S];M.contentQueries&&M.contentQueries(1,l[S],S)}}function qd(o,u,l){!Yf()||(function(o,u,l,p){var m=l.directiveStart,S=l.directiveEnd;o.firstCreatePass||Xu(l,u),fi(p,u);for(var M=l.initialInputs,P=m;P<S;P++){var N=o.data[P],G=To(N);G&&Eg(u,l,N);var ie=Qu(u,o,P,l);fi(ie,u),null!==M&&lu(0,P-m,ie,N,0,M),G&&(Fo(l.index,u)[8]=ie)}}(o,u,l,Ko(l,u)),128==(128&l.flags)&&function(o,u,l){var p=l.directiveStart,m=l.directiveEnd,M=l.index,P=Yr.lFrame.currentDirectiveIndex;try{ui(M);for(var N=p;N<m;N++){var G=o.data[N],ie=u[N];Z0(N),(null!==G.hostBindings||0!==G.hostVars||null!==G.hostAttrs)&&eh(G,ie)}}finally{ui(-1),Z0(P)}}(o,u,l))}function Kd(o,u){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ko,p=u.localNames;if(null!==p)for(var m=u.index+1,S=0;S<p.length;S+=2){var M=p[S+1],P=-1===M?l(u,o):o[M];o[m++]=P}}function Xc(o){var u=o.tView;return null===u||u.incompleteFirstPass?o.tView=Yc(1,null,o.template,o.decls,o.vars,o.directiveDefs,o.pipeDefs,o.viewQuery,o.schemas,o.consts):u}function Yc(o,u,l,p,m,S,M,P,N,G){var ie=20+p,ye=ie+m,Ce=function(o,u){for(var l=[],p=0;p<u;p++)l.push(p<o?null:nn);return l}(ie,ye),Le="function"==typeof G?G():G;return Ce[1]={type:o,blueprint:Ce,template:l,queries:null,viewQuery:P,declTNode:u,data:Ce.slice().fill(null,ie),bindingStartIndex:ie,expandoStartIndex:ye,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof S?S():S,pipeRegistry:"function"==typeof M?M():M,firstChild:null,schemas:N,consts:Le,incompleteFirstPass:!1}}function qc(o,u,l,p){var m=ah(u);null===l?m.push(p):(m.push(l),o.firstCreatePass&&Fg(o).push(p,m.length-1))}function _g(o,u,l){for(var p in o)if(o.hasOwnProperty(p)){var m=o[p];(l=null===l?{}:l).hasOwnProperty(p)?l[p].push(u,m):l[p]=[u,m]}return l}function Ro(o,u,l,p,m,S,M,P){var ie,N=Ko(u,l),G=u.inputs;!P&&null!=G&&(ie=G[p])?(Lg(o,l,ie,p,m),Da(u)&&function(o,u){var l=Fo(u,o);16&l[2]||(l[2]|=64)}(l,u.index)):3&u.type&&(p=function(o){return"class"===o?"className":"for"===o?"htmlFor":"formaction"===o?"formAction":"innerHtml"===o?"innerHTML":"readonly"===o?"readOnly":"tabindex"===o?"tabIndex":o}(p),m=null!=M?M(m,u.value||"",p):m,li(S)?S.setProperty(N,p,m):ed(p)||(N.setProperty?N.setProperty(p,m):N[p]=m))}function $d(o,u,l,p){var m=!1;if(Yf()){var S=function(o,u,l){var p=o.directiveRegistry,m=null;if(p)for(var S=0;S<p.length;S++){var M=p[S];iu(l,M.selectors,!1)&&(m||(m=[]),qu(Xu(l,u),o,M.type),To(M)?(Ag(o,l),m.unshift(M)):m.push(M))}return m}(o,u,l),M=null===p?null:{"":-1};if(null!==S){m=!0,Mg(l,o.data.length,S.length);for(var P=0;P<S.length;P++){var N=S[P];N.providersResolver&&N.providersResolver(N)}for(var G=!1,ie=!1,ye=au(o,u,S.length,null),Ce=0;Ce<S.length;Ce++){var Le=S[Ce];l.mergedAttrs=zu(l.mergedAttrs,Le.hostAttrs),Tg(o,l,u,ye,Le),Y2(ye,Le,M),null!==Le.contentQueries&&(l.flags|=8),(null!==Le.hostBindings||null!==Le.hostAttrs||0!==Le.hostVars)&&(l.flags|=128);var qe=Le.type.prototype;!G&&(qe.ngOnChanges||qe.ngOnInit||qe.ngDoCheck)&&((o.preOrderHooks||(o.preOrderHooks=[])).push(l.index),G=!0),!ie&&(qe.ngOnChanges||qe.ngDoCheck)&&((o.preOrderCheckHooks||(o.preOrderCheckHooks=[])).push(l.index),ie=!0),ye++}!function(o,u){for(var p=u.directiveEnd,m=o.data,S=u.attrs,M=[],P=null,N=null,G=u.directiveStart;G<p;G++){var ie=m[G],ye=ie.inputs,Ce=null===S||eg(u)?null:gl(ye,S);M.push(Ce),P=_g(ye,G,P),N=_g(ie.outputs,G,N)}null!==P&&(P.hasOwnProperty("class")&&(u.flags|=16),P.hasOwnProperty("style")&&(u.flags|=32)),u.initialInputs=M,u.inputs=P,u.outputs=N}(o,l)}M&&function(o,u,l){if(u)for(var p=o.localNames=[],m=0;m<u.length;m+=2){var S=l[u[m+1]];if(null==S)throw new Or("301","Export of name '".concat(u[m+1],"' not found!"));p.push(u[m],S)}}(l,p,M)}return l.mergedAttrs=zu(l.mergedAttrs,l.attrs),m}function m0(o,u,l,p,m,S){var M=S.hostBindings;if(M){var P=o.hostBindingOpCodes;null===P&&(P=o.hostBindingOpCodes=[]);var N=~u.index;(function(o){for(var u=o.length;u>0;){var l=o[--u];if("number"==typeof l&&l<0)return l}return 0})(P)!=N&&P.push(N),P.push(p,m,M)}}function eh(o,u){null!==o.hostBindings&&o.hostBindings(1,u)}function Ag(o,u){u.flags|=2,(o.components||(o.components=[])).push(u.index)}function Y2(o,u,l){if(l){if(u.exportAs)for(var p=0;p<u.exportAs.length;p++)l[u.exportAs[p]]=o;To(u)&&(l[""]=o)}}function Mg(o,u,l){o.flags|=1,o.directiveStart=u,o.directiveEnd=u+l,o.providerIndexes=u}function Tg(o,u,l,p,m){o.data[p]=m;var S=m.factory||(m.factory=Es(m.type)),M=new Hu(S,To(m),null);o.blueprint[p]=M,l[p]=M,m0(o,u,0,p,au(o,l,m.hostVars,nn),m)}function Eg(o,u,l){var p=Ko(u,o),m=Xc(l),S=o[10],M=y0(o,p0(o,m,null,l.onPush?64:16,p,u,S,S.createRenderer(p,l),null,null));o[u.index]=M}function va(o,u,l,p,m,S){var M=Ko(o,u);!function(o,u,l,p,m,S,M){if(null==S)li(o)?o.removeAttribute(u,m,l):u.removeAttribute(m);else{var P=null==M?cr(S):M(S,p||"",m);li(o)?o.setAttribute(u,m,P,l):l?u.setAttributeNS(l,m,P):u.setAttribute(m,P)}}(u[11],M,S,o.value,l,p,m)}function lu(o,u,l,p,m,S){var M=S[u];if(null!==M)for(var P=p.setInput,N=0;N<M.length;){var G=M[N++],ie=M[N++],ye=M[N++];null!==P?p.setInput(l,ye,G,ie):l[ie]=ye}}function gl(o,u){for(var l=null,p=0;p<u.length;){var m=u[p];if(0!==m)if(5!==m){if("number"==typeof m)break;o.hasOwnProperty(m)&&(null===l&&(l=[]),l.push(m,o[m],u[p+1])),p+=2}else p+=2;else p+=4}return l}function Rg(o,u,l,p){return new Array(o,!0,!1,u,null,0,p,l,null,null)}function q2(o,u){var l=Fo(u,o);if(Bu(l)){var p=l[1];80&l[2]?su(p,l,p.template,l[8]):l[5]>0&&Kc(l)}}function Kc(o){for(var u=Md(o);null!==u;u=Dc(u))for(var l=10;l<u.length;l++){var p=u[l];if(1024&p[2]){var m=p[1];su(m,p,m.template,p[8])}else p[5]>0&&Kc(p)}var M=o[1].components;if(null!==M)for(var P=0;P<M.length;P++){var N=Fo(M[P],o);Bu(N)&&N[5]>0&&Kc(N)}}function Og(o,u){var l=Fo(u,o),p=l[1];(function(o,u){for(var l=u.length;l<o.blueprint.length;l++)u.push(o.blueprint[l])})(p,l),as(p,l,l[8])}function y0(o,u){return o[13]?o[14][4]=u:o[13]=u,o[14]=u,u}function rh(o){for(;o;){o[2]|=64;var u=pl(o);if(W1(o)&&!u)return o;o=u}return null}function nh(o,u,l){var p=u[10];p.begin&&p.begin();try{su(o,u,o.template,l)}catch(m){throw sh(u,m),m}finally{p.end&&p.end()}}function _0(o){!function(o){for(var u=0;u<o.components.length;u++){var l=o.components[u],p=s0(l),m=p[1];mg(m,p,m.template,l)}}(o[8])}function oh(o,u,l){$0(0),u(o,l)}var J2=function(){return Promise.resolve(null)}();function ah(o){return o[7]||(o[7]=[])}function Fg(o){return o.cleanup||(o.cleanup=[])}function sh(o,u){var l=o[9],p=l?l.get(eu,null):null;p&&p.handleError(u)}function Lg(o,u,l,p,m){for(var S=0;S<l.length;){var M=l[S++],P=l[S++],N=u[M],G=o.data[M];null!==G.setInput?G.setInput(N,m,p,P):N[P]=m}}function Qi(o,u,l){var p=ri(u,o);!function(o,u,l){li(o)?o.setValue(u,l):u.textContent=l}(o[11],p,l)}function Qc(o,u,l){var p=l?o.styles:null,m=l?o.classes:null,S=0;if(null!==u)for(var M=0;M<u.length;M++){var P=u[M];"number"==typeof P?S=P:1==S?m=Ht(m,P):2==S&&(p=Ht(p,P+": "+u[++M]+";"))}l?o.styles=p:o.stylesWithoutHost=p,l?o.classes=m:o.classesWithoutHost=m}var Jc=new xn("INJECTOR",-1),Ig=function(){function o(){_(this,o)}return w(o,[{key:"get",value:function(l){var p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:sl;if(p===sl){var m=new Error("NullInjectorError: No provider for ".concat(Qt(l),"!"));throw m.name="NullInjectorError",m}return p}}]),o}(),Zc=new xn("Set Injector scope."),x0={},b0={},$c=void 0;function kg(){return void 0===$c&&($c=new Ig),$c}function lh(o){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,p=arguments.length>3?arguments[3]:void 0,m=Bg(o,u,l,p);return m._resolveInjectorDefTypes(),m}function Bg(o){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,p=arguments.length>3?arguments[3]:void 0;return new ef(o,l,u||kg(),p)}var ef=function(){function o(u,l,p){var m=this,S=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;_(this,o),this.parent=p,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;var M=[];l&&Ia(l,function(N){return m.processProvider(N,u,l)}),Ia([u],function(N){return m.processInjectorType(N,[],M)}),this.records.set(Jc,uu(void 0,this));var P=this.records.get(Zc);this.scope=null!=P?P.value:null,this.source=S||("object"==typeof u?null:Qt(u))}return w(o,[{key:"destroyed",get:function(){return this._destroyed}},{key:"destroy",value:function(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(function(l){return l.ngOnDestroy()})}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}},{key:"get",value:function(l){var p=arguments.length>1&&void 0!==arguments[1]?arguments[1]:sl,m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:tn.Default;this.assertNotDestroyed();var S=ud(this),M=Xa(void 0);try{if(!(m&tn.SkipSelf)){var P=this.records.get(l);if(void 0===P){var N=Bs(l)&&Ru(l);P=N&&this.injectableDefInScope(N)?uu(tf(l),x0):null,this.records.set(l,P)}if(null!=P)return this.hydrate(l,P)}var G=m&tn.Self?kg():this.parent;return G.get(l,p=m&tn.Optional&&p===sl?null:p)}catch(ye){if("NullInjectorError"===ye.name){var ie=ye[hc]=ye[hc]||[];if(ie.unshift(Qt(l)),S)throw ye;return av(ye,l,"R3InjectorError",this.source)}throw ye}finally{Xa(M),ud(S)}}},{key:"_resolveInjectorDefTypes",value:function(){var l=this;this.injectorDefTypes.forEach(function(p){return l.get(p)})}},{key:"toString",value:function(){var l=[];return this.records.forEach(function(m,S){return l.push(Qt(S))}),"R3Injector[".concat(l.join(", "),"]")}},{key:"assertNotDestroyed",value:function(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}},{key:"processInjectorType",value:function(l,p,m){var S=this;if(!(l=tr(l)))return!1;var M=U0(l),P=null==M&&l.ngModule||void 0,N=void 0===P?l:P,ye=-1!==m.indexOf(N);if(void 0!==P&&(M=U0(P)),null==M)return!1;if(null!=M.imports&&!ye){var Ce;m.push(N);try{Ia(M.imports,function(Ze){S.processInjectorType(Ze,p,m)&&(void 0===Ce&&(Ce=[]),Ce.push(Ze))})}finally{}if(void 0!==Ce)for(var Le=function(ht){var At=Ce[ht],Tt=At.ngModule,nr=At.providers;Ia(nr,function(yr){return S.processProvider(yr,Tt,nr||Xn)})},qe=0;qe<Ce.length;qe++)Le(qe)}this.injectorDefTypes.add(N);var nt=Es(N)||function(){return new N};this.records.set(N,uu(nt,x0));var tt=M.providers;if(null!=tt&&!ye){var et=l;Ia(tt,function(Ze){return S.processProvider(Ze,et,tt)})}return void 0!==P&&void 0!==l.providers}},{key:"processProvider",value:function(l,p,m){var S=ss(l=tr(l))?l:tr(l&&l.provide),M=function(o,u,l){return cu(o)?uu(void 0,o.useValue):uu(uh(o),x0)}(l);if(ss(l)||!0!==l.multi)this.records.get(S);else{var P=this.records.get(S);P||((P=uu(void 0,x0,!0)).factory=function(){return cd(P.multi)},this.records.set(S,P)),S=l,P.multi.push(l)}this.records.set(S,M)}},{key:"hydrate",value:function(l,p){return p.value===x0&&(p.value=b0,p.value=p.factory()),"object"==typeof p.value&&p.value&&function(o){return null!==o&&"object"==typeof o&&"function"==typeof o.ngOnDestroy}(p.value)&&this.onDestroy.add(p.value),p.value}},{key:"injectableDefInScope",value:function(l){if(!l.providedIn)return!1;var p=tr(l.providedIn);return"string"==typeof p?"any"===p||p===this.scope:this.injectorDefTypes.has(p)}}]),o}();function tf(o){var u=Ru(o),l=null!==u?u.factory:Es(o);if(null!==l)return l;if(o instanceof xn)throw new Error("Token ".concat(Qt(o)," is missing a \u0275prov definition."));if(o instanceof Function)return function(o){var u=o.length;if(u>0){var l=function(o,u){for(var l=[],p=0;p<o;p++)l.push(u);return l}(u,"?");throw new Error("Can't resolve all parameters for ".concat(Qt(o),": (").concat(l.join(", "),")."))}var p=function(o){var u=o&&(o[uo]||o[Du]);if(u){var l=function(o){if(o.hasOwnProperty("name"))return o.name;var u=(""+o).match(/^function\s*([^\s(]+)/);return null===u?"":u[1]}(o);return console.warn('DEPRECATED: DI is instantiating a token "'.concat(l,'" that inherits its @Injectable decorator but does not provide one itself.\n')+'This will become an error in a future version of Angular. Please add @Injectable() to the "'.concat(l,'" class.')),u}return null}(o);return null!==p?function(){return p.factory(o)}:function(){return new o}}(o);throw new Error("unreachable")}function uh(o,u,l){var p=void 0;if(ss(o)){var m=tr(o);return Es(m)||tf(m)}if(cu(o))p=function(){return tr(o.useValue)};else if(function(o){return!(!o||!o.useFactory)}(o))p=function(){return o.useFactory.apply(o,U(cd(o.deps||[])))};else if(function(o){return!(!o||!o.useExisting)}(o))p=function(){return Rr(tr(o.useExisting))};else{var S=tr(o&&(o.useClass||o.provide));if(!function(o){return!!o.deps}(o))return Es(S)||tf(S);p=function(){return K(S,U(cd(o.deps)))}}return p}function uu(o,u){var l=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{factory:o,value:u,multi:l?[]:void 0}}function cu(o){return null!==o&&"object"==typeof o&&iv in o}function ss(o){return"function"==typeof o}function Bs(o){return"function"==typeof o||"object"==typeof o&&o instanceof xn}var lo=function(){var o=function(){function u(){_(this,u)}return w(u,null,[{key:"create",value:function(p,m){var S;if(Array.isArray(p))return lh({name:""},m,p,"");var M=null!==(S=p.name)&&void 0!==S?S:"";return lh({name:M},p.parent,p.providers,M)}}]),u}();return o.THROW_IF_NOT_FOUND=sl,o.NULL=new Ig,o.\u0275prov=ln({token:o,providedIn:"any",factory:function(){return Rr(Jc)}}),o.__NG_ELEMENT_ID__=-1,o}();function u3(o,u){Uu(s0(o)[1],xi())}var du=null;function ma(){if(!du){var o=jn.Symbol;if(o&&o.iterator)du=o.iterator;else for(var u=Object.getOwnPropertyNames(Map.prototype),l=0;l<u.length;++l){var p=u[l];"entries"!==p&&"size"!==p&&Map.prototype[p]===Map.prototype.entries&&(du=p)}}return du}function hu(o){return!!gh(o)&&(Array.isArray(o)||!(o instanceof Map)&&ma()in o)}function gh(o){return null!==o&&("function"==typeof o||"object"==typeof o)}function Ua(o,u,l){return o[u]=l}function Ji(o,u,l){return!Object.is(o[u],l)&&(o[u]=l,!0)}function us(o,u,l,p){var m=Ji(o,u,l);return Ji(o,u+1,p)||m}function ia(o,u,l,p,m,S){var M=us(o,u,l,p);return us(o,u+2,m,S)||M}function mh(o,u,l,p){var m=Wt();return Ji(m,kl(),u)&&(Mn(),va(ci(),m,o,u,l,p)),mh}function pu(o,u,l,p){return Ji(o,kl(),l)?u+cr(l)+p:nn}function gu(o,u,l,p,m,S,M,P){var G=function(o,u,l,p,m){var S=us(o,u,l,p);return Ji(o,u+2,m)||S}(o,Lo(),l,m,M);return ca(3),G?u+cr(l)+p+cr(m)+S+cr(M)+P:nn}function gr(o,u,l,p,m,S,M,P){var N=Wt(),G=Mn(),ie=o+20,ye=G.firstCreatePass?function(o,u,l,p,m,S,M,P,N){var G=u.consts,ie=os(u,o,4,M||null,Oi(G,P));$d(u,l,ie,Oi(G,N)),Uu(u,ie);var ye=ie.tViews=Yc(2,ie,p,m,S,u.directiveRegistry,u.pipeRegistry,null,u.schemas,G);return null!==u.queries&&(u.queries.template(u,ie),ye.queries=u.queries.embeddedTView(ie)),ie}(ie,G,N,u,l,p,m,S,M):G.data[ie];Pa(ye,!1);var Ce=N[11].createComment("");Lc(G,N,Ce,ye),fi(Ce,N),y0(N,N[ie]=Rg(Ce,N,Ce,ye)),Nl(ye)&&qd(G,N,ye),null!=M&&Kd(N,ye,P)}function dr(o){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tn.Default,l=Wt();if(null===l)return Rr(o,u);var p=xi();return Kp(p,l,tr(o),u)}function Ah(){throw new Error("invalid")}function h(o,u,l){var p=Wt();return Ji(p,kl(),u)&&Ro(Mn(),ci(),p,o,u,p[11],l,!1),h}function r(o,u,l,p,m){var M=m?"class":"style";Lg(o,l,u.inputs[M],M,p)}function n(o,u,l,p){var m=Wt(),S=Mn(),M=20+o,P=m[11],N=m[M]=mo(P,u,Yr.lFrame.currentNamespace),G=S.firstCreatePass?function(o,u,l,p,m,S,M){var P=u.consts,G=os(u,o,2,m,Oi(P,S));return $d(u,l,G,Oi(P,M)),null!==G.attrs&&Qc(G,G.attrs,!1),null!==G.mergedAttrs&&Qc(G,G.mergedAttrs,!0),null!==u.queries&&u.queries.elementStart(u,G),G}(M,S,m,0,u,l,p):S.data[M];Pa(G,!0);var ie=G.mergedAttrs;null!==ie&&oc(P,N,ie);var ye=G.classes;null!==ye&&Dd(P,N,ye);var Ce=G.styles;null!==Ce&&Rd(P,N,Ce),64!=(64&G.flags)&&Lc(S,m,N,G),0===Yr.lFrame.elementDepthCount&&fi(N,m),Yr.lFrame.elementDepthCount++,Nl(G)&&(qd(S,m,G),Yd(S,G,m)),null!==p&&Kd(m,G)}function c(){var o=xi();Yt()?qf():Pa(o=o.parent,!1);var u=o;Yr.lFrame.elementDepthCount--;var l=Mn();l.firstCreatePass&&(Uu(l,o),Gf(o)&&l.queries.elementEnd(o)),null!=u.classesWithoutHost&&function(o){return 0!=(16&o.flags)}(u)&&r(l,u,Wt(),u.classesWithoutHost,!0),null!=u.stylesWithoutHost&&function(o){return 0!=(32&o.flags)}(u)&&r(l,u,Wt(),u.stylesWithoutHost,!1)}function f(o,u,l,p){n(o,u,l,p),c()}function B(o,u,l){var p=Wt(),m=Mn(),S=o+20,M=m.firstCreatePass?function(o,u,l,p,m){var S=u.consts,M=Oi(S,p),P=os(u,o,8,"ng-container",M);return null!==M&&Qc(P,M,!0),$d(u,l,P,Oi(S,m)),null!==u.queries&&u.queries.elementStart(u,P),P}(S,m,p,u,l):m.data[S];Pa(M,!0);var P=p[S]=p[11].createComment("");Lc(m,p,P,M),fi(P,p),Nl(M)&&(qd(m,p,M),Yd(m,M,p)),null!=l&&Kd(p,M)}function q(){var o=xi(),u=Mn();Yt()?qf():Pa(o=o.parent,!1),u.firstCreatePass&&(Uu(u,o),Gf(o)&&u.queries.elementEnd(o))}function Se(){return Wt()}function ke(o){return!!o&&"function"==typeof o.then}function je(o){return!!o&&"function"==typeof o.subscribe}var Qe=je;function rt(o,u,l,p){var m=Wt(),S=Mn(),M=xi();return function(o,u,l,p,m,S,M,P){var N=Nl(p),ie=o.firstCreatePass&&Fg(o),ye=u[8],Ce=ah(u),Le=!0;if(3&p.type||P){var qe=Ko(p,u),nt=P?P(qe):qe,tt=Ce.length,et=P?function(er){return P(Si(er[p.index]))}:p.index;if(li(l)){var Ze=null;if(!P&&N&&(Ze=function(o,u,l,p){var m=o.cleanup;if(null!=m)for(var S=0;S<m.length-1;S+=2){var M=m[S];if(M===l&&m[S+1]===p){var P=u[7],N=m[S+2];return P.length>N?P[N]:null}"string"==typeof M&&(S+=2)}return null}(o,u,m,p.index)),null!==Ze)(Ze.__ngLastListenerFn__||Ze).__ngNextListenerFn__=S,Ze.__ngLastListenerFn__=S,Le=!1;else{S=qt(p,u,ye,S,!1);var At=l.listen(nt,m,S);Ce.push(S,At),ie&&ie.push(m,et,tt,tt+1)}}else S=qt(p,u,ye,S,!0),nt.addEventListener(m,S,M),Ce.push(S),ie&&ie.push(m,et,tt,M)}else S=qt(p,u,ye,S,!1);var nr,Tt=p.outputs;if(Le&&null!==Tt&&(nr=Tt[m])){var yr=nr.length;if(yr)for(var Gr=0;Gr<yr;Gr+=2){var qn=u[nr[Gr]][nr[Gr+1]].subscribe(S),Ct=Ce.length;Ce.push(S,qn),ie&&ie.push(m,p.index,Ct,-(Ct+1))}}}(S,m,m[11],M,o,u,!!l,p),rt}function Rt(o,u,l,p){try{return!1!==l(p)}catch(m){return sh(o,m),!1}}function qt(o,u,l,p,m){return function S(M){if(M===Function)return p;var P=2&o.flags?Fo(o.index,u):u;0==(32&u[2])&&rh(P);for(var N=Rt(u,0,p,M),G=S.__ngNextListenerFn__;G;)N=Rt(u,0,G,M)&&N,G=G.__ngNextListenerFn__;return m&&!1===N&&(M.preventDefault(),M.returnValue=!1),N}}function It(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return Xi(o)}function kn(o,u,l,p,m){var S=Wt(),M=pu(S,u,l,p);return M!==nn&&Ro(Mn(),ci(),S,o,M,S[11],m,!1),kn}function w5(o,u,l,p,m){for(var S=o[l+1],M=null===u,P=p?ta(S):is(S),N=!1;0!==P&&(!1===N||M);){var ie=o[P+1];k6(o[P],u)&&(N=!0,o[P+1]=p?Id(ie):kc(ie)),P=p?ta(ie):is(ie)}N&&(o[l+1]=p?kc(S):Id(S))}function k6(o,u){return null===o||null==u||(Array.isArray(o)?o[1]:o)===u||!(!Array.isArray(o)||"string"!=typeof u)&&Yl(o,u)>=0}function Mh(o,u,l){return function(o,u,l,p){var m=Wt(),S=Mn(),M=ca(2);S.firstUpdatePass&&function(o,u,l,p){var m=o.data;if(null===m[l+1]){var S=m[po()],M=function(o,u){return u>=o.expandoStartIndex}(o,l);(function(o,u){return 0!=(o.flags&(u?16:32))})(S,p)&&null===u&&!M&&(u=!1),u=function(o,u,l,p){var m=function(o){var u=Yr.lFrame.currentDirectiveIndex;return-1===u?null:o[u]}(o),S=p?u.residualClasses:u.residualStyles;if(null===m)0===(p?u.classBindings:u.styleBindings)&&(l=Th(l=L3(null,o,u,l,p),u.attrs,p),S=null);else{var P=u.directiveStylingLast;if(-1===P||o[P]!==m)if(l=L3(m,o,u,l,p),null===S){var G=function(o,u,l){var p=l?u.classBindings:u.styleBindings;if(0!==is(p))return o[ta(p)]}(o,u,p);void 0!==G&&Array.isArray(G)&&function(o,u,l,p){o[ta(l?u.classBindings:u.styleBindings)]=p}(o,u,p,G=Th(G=L3(null,o,u,G[1],p),u.attrs,p))}else S=function(o,u,l){for(var p=void 0,m=u.directiveEnd,S=1+u.directiveStylingLast;S<m;S++)p=Th(p,o[S].hostAttrs,l);return Th(p,u.attrs,l)}(o,u,p)}return void 0!==S&&(p?u.residualClasses=S:u.residualStyles=S),l}(m,S,u,p),function(o,u,l,p,m,S){var M=S?u.classBindings:u.styleBindings,P=ta(M),N=is(M);o[p]=l;var ie,G=!1;if(Array.isArray(l)?(null===(ie=l[1])||Yl(l,ie)>0)&&(G=!0):ie=l,m)if(0!==N){var Le=ta(o[P+1]);o[p+1]=ou(Le,P),0!==Le&&(o[Le+1]=Bc(o[Le+1],p)),o[P+1]=function(o,u){return 131071&o|u<<17}(o[P+1],p)}else o[p+1]=ou(P,0),0!==P&&(o[P+1]=Bc(o[P+1],p)),P=p;else o[p+1]=ou(N,0),0===P?P=p:o[N+1]=Bc(o[N+1],p),N=p;G&&(o[p+1]=kc(o[p+1])),w5(o,ie,p,!0),w5(o,ie,p,!1),function(o,u,l,p,m){var S=m?o.residualClasses:o.residualStyles;null!=S&&"string"==typeof u&&Yl(S,u)>=0&&(l[p+1]=Id(l[p+1]))}(u,ie,o,p,S),M=ou(P,N),S?u.classBindings=M:u.styleBindings=M}(m,S,u,l,M,p)}}(S,o,M,p),u!==nn&&Ji(m,M,u)&&function(o,u,l,p,m,S,M,P){if(3&u.type){var N=o.data,G=N[P+1];mm(function(o){return 1==(1&o)}(G)?P5(N,u,l,m,is(G),M):void 0)||(mm(S)||function(o){return 2==(2&o)}(G)&&(S=P5(N,null,l,m,P,M)),function(o,u,l,p,m){var S=li(o);if(u)m?S?o.addClass(l,p):l.classList.add(p):S?o.removeClass(l,p):l.classList.remove(p);else{var M=-1===p.indexOf("-")?void 0:ko.DashCase;if(null==m)S?o.removeStyle(l,p,M):l.style.removeProperty(p);else{var P="string"==typeof m&&m.endsWith("!important");P&&(m=m.slice(0,-10),M|=ko.Important),S?o.setStyle(l,p,m,M):l.style.setProperty(p,m,P?"important":"")}}}(p,M,ri(po(),l),m,S))}}(S,S.data[po()],m,m[11],o,m[M+1]=function(o,u){return null==o||("string"==typeof u?o+=u:"object"==typeof o&&(o=Qt(go(o)))),o}(u,l),p,M)}(o,u,l,!1),Mh}function L3(o,u,l,p,m){var S=null,M=l.directiveEnd,P=l.directiveStylingLast;for(-1===P?P=l.directiveStart:P++;P<M&&(p=Th(p,(S=u[P]).hostAttrs,m),S!==o);)P++;return null!==o&&(l.directiveStylingLast=P),p}function Th(o,u,l){var p=l?1:2,m=-1;if(null!==u)for(var S=0;S<u.length;S++){var M=u[S];"number"==typeof M?m=M:m===p&&(Array.isArray(o)||(o=void 0===o?[]:["",o]),Eo(o,M,!!l||u[++S]))}return void 0===o?null:o}function P5(o,u,l,p,m,S){for(var M=null===u,P=void 0;m>0;){var N=o[m],G=Array.isArray(N),ie=G?N[1]:N,ye=null===ie,Ce=l[m+1];Ce===nn&&(Ce=ye?Xn:void 0);var Le=ye?ad(Ce,p):ie===p?Ce:void 0;if(G&&!mm(Le)&&(Le=ad(N,p)),mm(Le)&&(P=Le,M))return P;var qe=o[m+1];m=M?ta(qe):is(qe)}if(null!==u){var nt=S?u.residualClasses:u.residualStyles;null!=nt&&(P=ad(nt,p))}return P}function mm(o){return void 0!==o}function Pt(o){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",l=Wt(),p=Mn(),m=o+20,S=p.firstCreatePass?os(p,m,1,u,null):p.data[m],M=l[m]=Oc(l[11],u);Lc(p,l,M,S),Pa(S,!1)}function Gn(o){return Pi("",o,""),Gn}function Pi(o,u,l){var p=Wt(),m=pu(p,o,u,l);return m!==nn&&Qi(p,po(),m),Pi}function vs(o,u,l,p,m){var S=Wt(),M=function(o,u,l,p,m,S){var P=us(o,Lo(),l,m);return ca(2),P?u+cr(l)+p+cr(m)+S:nn}(S,o,u,l,p,m);return M!==nn&&Qi(S,po(),M),vs}function ym(o,u,l,p,m,S,M){var P=Wt(),N=gu(P,o,u,l,p,m,S,M);return N!==nn&&Qi(P,po(),N),ym}function N3(o,u,l,p,m,S,M,P,N,G,ie,ye,Ce){var Le=Wt(),qe=function(o,u,l,p,m,S,M,P,N,G,ie,ye,Ce,Le){var qe=Lo(),nt=ia(o,qe,l,m,M,N);return nt=us(o,qe+4,ie,Ce)||nt,ca(6),nt?u+cr(l)+p+cr(m)+S+cr(M)+P+cr(N)+G+cr(ie)+ye+cr(Ce)+Le:nn}(Le,o,u,l,p,m,S,M,P,N,G,ie,ye,Ce);return qe!==nn&&Qi(Le,po(),qe),N3}var E0=void 0,yS=["en",[["a","p"],["AM","PM"],E0],[["AM","PM"],E0,E0],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],E0,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],E0,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",E0,"{1} 'at' {0}",E0],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(o){var l=Math.floor(Math.abs(o)),p=o.toString().replace(/^[^.]*\.?/,"").length;return 1===l&&0===p?1:5}],ff={};function J5(o){return o in ff||(ff[o]=jn.ng&&jn.ng.common&&jn.ng.common.locales&&jn.ng.common.locales[o]),ff[o]}var mr=function(){return(mr=mr||{})[mr.LocaleId=0]="LocaleId",mr[mr.DayPeriodsFormat=1]="DayPeriodsFormat",mr[mr.DayPeriodsStandalone=2]="DayPeriodsStandalone",mr[mr.DaysFormat=3]="DaysFormat",mr[mr.DaysStandalone=4]="DaysStandalone",mr[mr.MonthsFormat=5]="MonthsFormat",mr[mr.MonthsStandalone=6]="MonthsStandalone",mr[mr.Eras=7]="Eras",mr[mr.FirstDayOfWeek=8]="FirstDayOfWeek",mr[mr.WeekendRange=9]="WeekendRange",mr[mr.DateFormat=10]="DateFormat",mr[mr.TimeFormat=11]="TimeFormat",mr[mr.DateTimeFormat=12]="DateTimeFormat",mr[mr.NumberSymbols=13]="NumberSymbols",mr[mr.NumberFormats=14]="NumberFormats",mr[mr.CurrencyCode=15]="CurrencyCode",mr[mr.CurrencySymbol=16]="CurrencySymbol",mr[mr.CurrencyName=17]="CurrencyName",mr[mr.Currencies=18]="Currencies",mr[mr.Directionality=19]="Directionality",mr[mr.PluralCase=20]="PluralCase",mr[mr.ExtraData=21]="ExtraData",mr}(),Cm="en-US";function vx(o,u,l){var p=Mn();if(p.firstCreatePass){var m=To(o);B3(l,p.data,p.blueprint,m,!0),B3(u,p.data,p.blueprint,m,!1)}}function B3(o,u,l,p,m){if(o=tr(o),Array.isArray(o))for(var S=0;S<o.length;S++)B3(o[S],u,l,p,m);else{var M=Mn(),P=Wt(),N=ss(o)?o:tr(o.provide),G=uh(o),ie=xi(),ye=1048575&ie.providerIndexes,Ce=ie.directiveStart,Le=ie.providerIndexes>>20;if(ss(o)||!o.multi){var qe=new Hu(G,m,dr),nt=V3(N,u,m?ye:ye+Le,Ce);-1===nt?(qu(Xu(ie,P),M,N),G3(M,o,u.length),u.push(N),ie.directiveStart++,ie.directiveEnd++,m&&(ie.providerIndexes+=1048576),l.push(qe),P.push(qe)):(l[nt]=qe,P[nt]=qe)}else{var tt=V3(N,u,ye+Le,Ce),et=V3(N,u,ye,ye+Le),ht=et>=0&&l[et];if(m&&!ht||!m&&!(tt>=0&&l[tt])){qu(Xu(ie,P),M,N);var At=function(o,u,l,p,m){var S=new Hu(o,l,dr);return S.multi=[],S.index=u,S.componentProviders=0,SC(S,m,p&&!l),S}(m?mx:gx,l.length,m,p,G);!m&&ht&&(l[et].providerFactory=At),G3(M,o,u.length,0),u.push(N),ie.directiveStart++,ie.directiveEnd++,m&&(ie.providerIndexes+=1048576),l.push(At),P.push(At)}else G3(M,o,tt>-1?tt:et,SC(l[m?et:tt],G,!m&&p));!m&&p&&ht&&l[et].componentProviders++}}}function G3(o,u,l,p){var m=ss(u),S=function(o){return!!o.useClass}(u);if(m||S){var N=(S?tr(u.useClass):u).prototype.ngOnDestroy;if(N){var G=o.destroyHooks||(o.destroyHooks=[]);if(!m&&u.multi){var ie=G.indexOf(l);-1===ie?G.push(l,[p,N]):G[ie+1].push(p,N)}else G.push(l,N)}}}function SC(o,u,l){return l&&o.componentProviders++,o.multi.push(u)-1}function V3(o,u,l,p){for(var m=l;m<p;m++)if(u[m]===o)return m;return-1}function gx(o,u,l,p){return U3(this.multi,[])}function mx(o,u,l,p){var S,m=this.multi;if(this.providerFactory){var M=this.providerFactory.componentProviders,P=Qu(l,l[1],this.providerFactory.index,p);U3(m,S=P.slice(0,M));for(var N=M;N<P.length;N++)S.push(P[N])}else U3(m,S=[]);return S}function U3(o,u){for(var l=0;l<o.length;l++)u.push((0,o[l])());return u}function xC(o){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(l){l.providersResolver=function(p,m){return vx(p,m?m(o):o,u)}}}var Cx=function o(){_(this,o)},bC=function o(){_(this,o)},Sx=function(){function o(){_(this,o)}return w(o,[{key:"resolveComponentFactory",value:function(l){throw function(o){var u=Error("No component factory found for ".concat(Qt(o),". Did you add it to @NgModule.entryComponents?"));return u.ngComponent=o,u}(l)}}]),o}(),_u=function(){var o=function u(){_(this,u)};return o.NULL=new Sx,o}();function xx(){return hf(xi(),Wt())}function hf(o,u){return new Hs(Ko(o,u))}var Hs=function(){var o=function u(l){_(this,u),this.nativeElement=l};return o.__NG_ELEMENT_ID__=xx,o}();function bx(o){return o instanceof Hs?o.nativeElement:o}var MC=function o(){_(this,o)},bm=function(){var o=function u(){_(this,u)};return o.__NG_ELEMENT_ID__=function(){return function(){var o=Wt(),l=Fo(xi().index,o);return function(o){return o[11]}(Ra(l)?l:o)}()},o}(),Tx=function(){var o=function u(){_(this,u)};return o.\u0275prov=ln({token:o,providedIn:"root",factory:function(){return null}}),o}(),Am=function o(u){_(this,o),this.full=u,this.major=u.split(".")[0],this.minor=u.split(".")[1],this.patch=u.split(".").slice(2).join(".")},Ex=new Am("13.1.0"),H3={};function Mm(o,u,l,p){for(var m=arguments.length>4&&void 0!==arguments[4]&&arguments[4];null!==l;){var S=u[l.index];if(null!==S&&p.push(Si(S)),Yo(S))for(var M=10;M<S.length;M++){var P=S[M],N=P[1].firstChild;null!==N&&Mm(P[1],P,N,p)}var G=l.type;if(8&G)Mm(o,u,l.child,p);else if(32&G)for(var ie=Rc(l,u),ye=void 0;ye=ie();)p.push(ye);else if(16&G){var Ce=Kv(u,l);if(Array.isArray(Ce))p.push.apply(p,U(Ce));else{var Le=pl(u[16]);Mm(Le[1],Le,Ce,p,!0)}}l=m?l.projectionNext:l.next}return p}var Ph=function(){function o(u,l){_(this,o),this._lView=u,this._cdRefInjectingView=l,this._appRef=null,this._attachedToViewContainer=!1}return w(o,[{key:"rootNodes",get:function(){var l=this._lView,p=l[1];return Mm(p,l,p.firstChild,[])}},{key:"context",get:function(){return this._lView[8]},set:function(l){this._lView[8]=l}},{key:"destroyed",get:function(){return 256==(256&this._lView[2])}},{key:"destroy",value:function(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){var l=this._lView[3];if(Yo(l)){var p=l[8],m=p?p.indexOf(this):-1;m>-1&&(Td(l,m),fc(p,m))}this._attachedToViewContainer=!1}vl(this._lView[1],this._lView)}},{key:"onDestroy",value:function(l){qc(this._lView[1],this._lView,null,l)}},{key:"markForCheck",value:function(){rh(this._cdRefInjectingView||this._lView)}},{key:"detach",value:function(){this._lView[2]&=-129}},{key:"reattach",value:function(){this._lView[2]|=128}},{key:"detectChanges",value:function(){nh(this._lView[1],this._lView,this.context)}},{key:"checkNoChanges",value:function(){!function(o,u,l){Q0(!0);try{nh(o,u,l)}finally{Q0(!1)}}(this._lView[1],this._lView,this.context)}},{key:"attachToViewContainerRef",value:function(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}},{key:"detachFromAppRef",value:function(){this._appRef=null,function(o,u){f0(o,u,u[11],2,null,null)}(this._lView[1],this._lView)}},{key:"attachToAppRef",value:function(l){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=l}}]),o}(),Rx=function(o){b(l,o);var u=D(l);function l(p){var m;return _(this,l),(m=u.call(this,p))._view=p,m}return w(l,[{key:"detectChanges",value:function(){_0(this._view)}},{key:"checkNoChanges",value:function(){!function(o){Q0(!0);try{_0(o)}finally{Q0(!1)}}(this._view)}},{key:"context",get:function(){return null}}]),l}(Ph),TC=function(o){b(l,o);var u=D(l);function l(p){var m;return _(this,l),(m=u.call(this)).ngModule=p,m}return w(l,[{key:"resolveComponentFactory",value:function(m){var S=ki(m);return new W3(S,this.ngModule)}}]),l}(_u);function EC(o){var u=[];for(var l in o)o.hasOwnProperty(l)&&u.push({propName:o[l],templateName:l});return u}var Ox=new xn("SCHEDULER_TOKEN",{providedIn:"root",factory:function(){return Dv}}),W3=function(o){b(l,o);var u=D(l);function l(p,m){var S;return _(this,l),(S=u.call(this)).componentDef=p,S.ngModule=m,S.componentType=p.type,S.selector=function(o){return o.map(O2).join(",")}(p.selectors),S.ngContentSelectors=p.ngContentSelectors?p.ngContentSelectors:[],S.isBoundToModule=!!m,S}return w(l,[{key:"inputs",get:function(){return EC(this.componentDef.inputs)}},{key:"outputs",get:function(){return EC(this.componentDef.outputs)}},{key:"create",value:function(m,S,M,P){var Ze,ht,N=(P=P||this.ngModule)?function(o,u){return{get:function(p,m,S){var M=o.get(p,H3,S);return M!==H3||m===H3?M:u.get(p,m,S)}}}(m,P.injector):m,G=N.get(MC,Pp),ie=N.get(Tx,null),ye=G.createRenderer(null,this.componentDef),Ce=this.componentDef.selectors[0][0]||"div",Le=M?function(o,u,l){if(li(o))return o.selectRootElement(u,l===Aa.ShadowDom);var m="string"==typeof u?o.querySelector(u):u;return m.textContent="",m}(ye,M,this.componentDef.encapsulation):mo(G.createRenderer(null,this.componentDef),Ce,function(o){var u=o.toLowerCase();return"svg"===u?Hf:"math"===u?"http://www.w3.org/1998/MathML/":null}(Ce)),qe=this.componentDef.onPush?576:528,nt=function(o,u){return{components:[],scheduler:o||Dv,clean:J2,playerHandler:u||null,flags:0}}(),tt=Yc(0,null,null,1,0,null,null,null,null,null),et=p0(null,tt,nt,qe,null,null,G,ye,ie,N);Bl(et);try{var At=function(o,u,l,p,m,S){var M=l[1];l[20]=o;var N=os(M,20,2,"#host",null),G=N.mergedAttrs=u.hostAttrs;null!==G&&(Qc(N,G,!0),null!==o&&(oc(m,o,G),null!==N.classes&&Dd(m,o,N.classes),null!==N.styles&&Rd(m,o,N.styles)));var ie=p.createRenderer(o,u),ye=p0(l,Xc(u),null,u.onPush?64:16,l[20],N,p,ie,S||null,null);return M.firstCreatePass&&(qu(Xu(N,l),M,u.type),Ag(M,N),Mg(N,l.length,1)),y0(l,ye),l[20]=ye}(Le,this.componentDef,et,G,ye);if(Le)if(M)oc(ye,Le,["ng-version",Ex.full]);else{var Tt=function(o){for(var u=[],l=[],p=1,m=2;p<o.length;){var S=o[p];if("string"==typeof S)2===m?""!==S&&u.push(S,o[++p]):8===m&&l.push(S);else{if(!so(m))break;m=S}p++}return{attrs:u,classes:l}}(this.componentDef.selectors[0]),nr=Tt.attrs,yr=Tt.classes;nr&&oc(ye,Le,nr),yr&&yr.length>0&&Dd(ye,Le,yr.join(" "))}if(ht=$a(tt,20),void 0!==S)for(var Gr=ht.projection=[],en=0;en<this.ngContentSelectors.length;en++){var wn=S[en];Gr.push(null!=wn?Array.from(wn):null)}Ze=function(o,u,l,p,m){var S=l[1],M=function(o,u,l){var p=xi();o.firstCreatePass&&(l.providersResolver&&l.providersResolver(l),Tg(o,p,u,au(o,u,1,null),l));var S=Qu(u,o,p.directiveStart,p);fi(S,u);var M=Ko(p,u);return M&&fi(M,u),S}(S,l,u);if(p.components.push(M),o[8]=M,m&&m.forEach(function(ie){return ie(M,u)}),u.contentQueries){var P=xi();u.contentQueries(1,M,P.directiveStart)}var N=xi();return!S.firstCreatePass||null===u.hostBindings&&null===u.hostAttrs||(ui(N.index),m0(l[1],N,0,N.directiveStart,N.directiveEnd,u),eh(u,M)),M}(At,this.componentDef,et,nt,[u3]),as(tt,et,null)}finally{La()}return new Lx(this.componentType,Ze,hf(ht,et),et,ht)}}]),l}(bC),Lx=function(o){b(l,o);var u=D(l);function l(p,m,S,M,P){var N;return _(this,l),(N=u.call(this)).location=S,N._rootLView=M,N._tNode=P,N.instance=m,N.hostView=N.changeDetectorRef=new Rx(M),N.componentType=p,N}return w(l,[{key:"injector",get:function(){return new il(this._tNode,this._rootLView)}},{key:"destroy",value:function(){this.hostView.destroy()}},{key:"onDestroy",value:function(m){this.hostView.onDestroy(m)}}]),l}(Cx),Cl=function o(){_(this,o)},RC=function o(){_(this,o)},pf=new Map;var PC=function(o){b(l,o);var u=D(l);function l(p,m){var S;_(this,l),(S=u.call(this))._parent=m,S._bootstrapComponents=[],S.injector=R(S),S.destroyCbs=[],S.componentFactoryResolver=new TC(R(S));var M=bo(p);return S._bootstrapComponents=da(M.bootstrap),S._r3Injector=Bg(p,m,[{provide:Cl,useValue:R(S)},{provide:_u,useValue:S.componentFactoryResolver}],Qt(p)),S._r3Injector._resolveInjectorDefTypes(),S.instance=S.get(p),S}return w(l,[{key:"get",value:function(m){var S=arguments.length>1&&void 0!==arguments[1]?arguments[1]:lo.THROW_IF_NOT_FOUND,M=arguments.length>2&&void 0!==arguments[2]?arguments[2]:tn.Default;return m===lo||m===Cl||m===Jc?this:this._r3Injector.get(m,S,M)}},{key:"destroy",value:function(){var m=this._r3Injector;!m.destroyed&&m.destroy(),this.destroyCbs.forEach(function(S){return S()}),this.destroyCbs=null}},{key:"onDestroy",value:function(m){this.destroyCbs.push(m)}}]),l}(Cl),z3=function(o){b(l,o);var u=D(l);function l(p){var m;return _(this,l),(m=u.call(this)).moduleType=p,null!==bo(p)&&function(o){var u=new Set;!function l(p){var m=bo(p,!0),S=m.id;null!==S&&(function(o,u,l){if(u&&u!==l)throw new Error("Duplicate module registered for ".concat(o," - ").concat(Qt(u)," vs ").concat(Qt(u.name)))}(S,pf.get(S),p),pf.set(S,p));var G,N=I(da(m.imports));try{for(N.s();!(G=N.n()).done;){var ie=G.value;u.has(ie)||(u.add(ie),l(ie))}}catch(ye){N.e(ye)}finally{N.f()}}(o)}(p),m}return w(l,[{key:"create",value:function(m){return new PC(this.moduleType,m)}}]),l}(RC);function vf(o,u,l,p){return LC(Wt(),oo(),o,u,l,p)}function FC(o,u,l,p,m,S,M){return function(o,u,l,p,m,S,M,P,N){var G=u+l;return ia(o,G,m,S,M,P)?Ua(o,G+4,N?p.call(N,m,S,M,P):p(m,S,M,P)):Fh(o,G+4)}(Wt(),oo(),o,u,l,p,m,S,M)}function Fh(o,u){var l=o[u];return l===nn?void 0:l}function LC(o,u,l,p,m,S){var M=u+l;return Ji(o,M,m)?Ua(o,M+1,S?p.call(S,m):p(m)):Fh(o,M+1)}function j3(o,u){var p,l=Mn(),m=o+20;l.firstCreatePass?(p=function(o,u){if(u)for(var l=u.length-1;l>=0;l--){var p=u[l];if(o===p.name)return p}}(u,l.pipeRegistry),l.data[m]=p,p.onDestroy&&(l.destroyHooks||(l.destroyHooks=[])).push(m,p.onDestroy)):p=l.data[m];var S=p.factory||(p.factory=Es(p.type)),M=Xa(dr);try{var P=ac(!1),N=S();return ac(P),function(o,u,l,p){l>=o.data.length&&(o.data[l]=null,o.blueprint[l]=null),u[l]=p}(l,Wt(),m,N),N}finally{Xa(M)}}function X3(o,u,l){var p=o+20,m=Wt(),S=function(o,u){return o[u]}(m,p);return function(o,u){return o[1].data[u].pure}(m,p)?LC(m,oo(),u,S.transform,l,S):S.transform(l)}var Qx=function(o){b(l,o);var u=D(l);function l(){var p,m=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return _(this,l),(p=u.call(this)).__isAsync=m,p}return w(l,[{key:"emit",value:function(m){g(d(l.prototype),"next",this).call(this,m)}},{key:"subscribe",value:function(m,S,M){var P,N,G,ie=m,ye=S||function(){return null},Ce=M;if(m&&"object"==typeof m){var Le=m;ie=null===(P=Le.next)||void 0===P?void 0:P.bind(Le),ye=null===(N=Le.error)||void 0===N?void 0:N.bind(Le),Ce=null===(G=Le.complete)||void 0===G?void 0:G.bind(Le)}this.__isAsync&&(ye=Y3(ye),ie&&(ie=Y3(ie)),Ce&&(Ce=Y3(Ce)));var qe=g(d(l.prototype),"subscribe",this).call(this,{next:ie,error:ye,complete:Ce});return m instanceof $&&m.add(qe),qe}}]),l}(He);function Y3(o){return function(u){setTimeout(o,void 0,u)}}var mt=Qx;function Jx(){return this._results[ma()]()}var q3=function(){function o(){var u=arguments.length>0&&void 0!==arguments[0]&&arguments[0];_(this,o),this._emitDistinctChangesOnly=u,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;var l=ma(),p=o.prototype;p[l]||(p[l]=Jx)}return w(o,[{key:"changes",get:function(){return this._changes||(this._changes=new mt)}},{key:"get",value:function(l){return this._results[l]}},{key:"map",value:function(l){return this._results.map(l)}},{key:"filter",value:function(l){return this._results.filter(l)}},{key:"find",value:function(l){return this._results.find(l)}},{key:"reduce",value:function(l,p){return this._results.reduce(l,p)}},{key:"forEach",value:function(l){this._results.forEach(l)}},{key:"some",value:function(l){return this._results.some(l)}},{key:"toArray",value:function(){return this._results.slice()}},{key:"toString",value:function(){return this._results.toString()}},{key:"reset",value:function(l,p){var m=this;m.dirty=!1;var S=Zo(l);(this._changesDetected=!function(o,u,l){if(o.length!==u.length)return!1;for(var p=0;p<o.length;p++){var m=o[p],S=u[p];if(l&&(m=l(m),S=l(S)),S!==m)return!1}return!0}(m._results,S,p))&&(m._results=S,m.length=S.length,m.last=S[this.length-1],m.first=S[0])}},{key:"notifyOnChanges",value:function(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}},{key:"setDirty",value:function(){this.dirty=!0}},{key:"destroy",value:function(){this.changes.complete(),this.changes.unsubscribe()}}]),o}();Symbol;var wl=function(){var o=function u(){_(this,u)};return o.__NG_ELEMENT_ID__=e7,o}(),$x=function(o){b(l,o);var u=D(l);function l(p,m,S){var M;return _(this,l),(M=u.call(this))._declarationLView=p,M._declarationTContainer=m,M.elementRef=S,M}return w(l,[{key:"createEmbeddedView",value:function(m){var S=this._declarationTContainer.tViews,M=p0(this._declarationLView,S,m,16,null,S.declTNode,null,null,null,null);M[17]=this._declarationLView[this._declarationTContainer.index];var N=this._declarationLView[19];return null!==N&&(M[19]=N.createEmbeddedView(S)),as(S,M,m),new Ph(M)}}]),l}(wl);function e7(){return Tm(xi(),Wt())}function Tm(o,u){return 4&o.type?new $x(u,o,hf(o,u)):null}var Ca=function(){var o=function u(){_(this,u)};return o.__NG_ELEMENT_ID__=t7,o}();function t7(){return UC(xi(),Wt())}var GC=function(o){b(l,o);var u=D(l);function l(p,m,S){var M;return _(this,l),(M=u.call(this))._lContainer=p,M._hostTNode=m,M._hostLView=S,M}return w(l,[{key:"element",get:function(){return hf(this._hostTNode,this._hostLView)}},{key:"injector",get:function(){return new il(this._hostTNode,this._hostLView)}},{key:"parentInjector",get:function(){var m=lc(this._hostTNode,this._hostLView);if(jp(m)){var S=Ul(m,this._hostLView),M=vo(m);return new il(S[1].data[M+8],S)}return new il(null,this._hostLView)}},{key:"clear",value:function(){for(;this.length>0;)this.remove(this.length-1)}},{key:"get",value:function(m){var S=VC(this._lContainer);return null!==S&&S[m]||null}},{key:"length",get:function(){return this._lContainer.length-10}},{key:"createEmbeddedView",value:function(m,S,M){var P=m.createEmbeddedView(S||{});return this.insert(P,M),P}},{key:"createComponent",value:function(m,S,M,P,N){var ie,G=m&&!function(o){return"function"==typeof o}(m);if(G)ie=S;else{var ye=S||{};ie=ye.index,M=ye.injector,P=ye.projectableNodes,N=ye.ngModuleRef}var Ce=G?m:new W3(ki(m)),Le=M||this.parentInjector;if(!N&&null==Ce.ngModule&&Le){var qe=Le.get(Cl,null);qe&&(N=qe)}var nt=Ce.create(Le,P,void 0,N);return this.insert(nt.hostView,ie),nt}},{key:"insert",value:function(m,S){var M=m._lView,P=M[1];if(function(o){return Yo(o[3])}(M)){var N=this.indexOf(m);if(-1!==N)this.detach(N);else{var G=M[3],ie=new GC(G,G[6],G[3]);ie.detach(ie.indexOf(m))}}var ye=this._adjustIndex(S),Ce=this._lContainer;!function(o,u,l,p){var m=10+p,S=l.length;p>0&&(l[m-1][4]=u),p<S-10?(u[4]=l[m],ev(l,10+p,u)):(l.push(u),u[4]=null),u[3]=l;var M=u[17];null!==M&&l!==M&&function(o,u){var l=o[9];u[16]!==u[3][3][16]&&(o[2]=!0),null===l?o[9]=[u]:l.push(u)}(M,u);var P=u[19];null!==P&&P.insertView(o),u[2]|=128}(P,M,Ce,ye);var Le=nu(ye,Ce),qe=M[11],nt=Pc(qe,Ce[7]);return null!==nt&&function(o,u,l,p,m,S){p[0]=m,p[6]=u,f0(o,p,l,1,m,S)}(P,Ce[6],qe,M,nt,Le),m.attachToViewContainerRef(),ev(K3(Ce),ye,m),m}},{key:"move",value:function(m,S){return this.insert(m,S)}},{key:"indexOf",value:function(m){var S=VC(this._lContainer);return null!==S?S.indexOf(m):-1}},{key:"remove",value:function(m){var S=this._adjustIndex(m,-1),M=Td(this._lContainer,S);M&&(fc(K3(this._lContainer),S),vl(M[1],M))}},{key:"detach",value:function(m){var S=this._adjustIndex(m,-1),M=Td(this._lContainer,S);return M&&null!=fc(K3(this._lContainer),S)?new Ph(M):null}},{key:"_adjustIndex",value:function(m){var S=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null==m?this.length+S:m}}]),l}(Ca);function VC(o){return o[8]}function K3(o){return o[8]||(o[8]=[])}function UC(o,u){var l,p=u[o.index];if(Yo(p))l=p;else{var m;if(8&o.type)m=Si(p);else{var S=u[11];m=S.createComment("");var M=Ko(o,u);Fs(S,Pc(S,M),m,function(o,u){return li(o)?o.nextSibling(u):u.nextSibling}(S,M),!1)}u[o.index]=l=Rg(p,u,m,o),y0(u,l)}return new GC(l,o,u)}var o7=function(){function o(u){_(this,o),this.queryList=u,this.matches=null}return w(o,[{key:"clone",value:function(){return new o(this.queryList)}},{key:"setDirty",value:function(){this.queryList.setDirty()}}]),o}(),a7=function(){function o(){var u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];_(this,o),this.queries=u}return w(o,[{key:"createEmbeddedView",value:function(l){var p=l.queries;if(null!==p){for(var m=null!==l.contentQueries?l.contentQueries[0]:p.length,S=[],M=0;M<m;M++){var P=p.getByIndex(M);S.push(this.queries[P.indexInDeclarationView].clone())}return new o(S)}return null}},{key:"insertView",value:function(l){this.dirtyQueriesWithMatches(l)}},{key:"detachView",value:function(l){this.dirtyQueriesWithMatches(l)}},{key:"dirtyQueriesWithMatches",value:function(l){for(var p=0;p<this.queries.length;p++)null!==XC(l,p).matches&&this.queries[p].setDirty()}}]),o}(),HC=function o(u,l){var p=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;_(this,o),this.predicate=u,this.flags=l,this.read=p},s7=function(){function o(){var u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];_(this,o),this.queries=u}return w(o,[{key:"elementStart",value:function(l,p){for(var m=0;m<this.queries.length;m++)this.queries[m].elementStart(l,p)}},{key:"elementEnd",value:function(l){for(var p=0;p<this.queries.length;p++)this.queries[p].elementEnd(l)}},{key:"embeddedTView",value:function(l){for(var p=null,m=0;m<this.length;m++){var S=null!==p?p.length:0,M=this.getByIndex(m).embeddedTView(l,S);M&&(M.indexInDeclarationView=m,null!==p?p.push(M):p=[M])}return null!==p?new o(p):null}},{key:"template",value:function(l,p){for(var m=0;m<this.queries.length;m++)this.queries[m].template(l,p)}},{key:"getByIndex",value:function(l){return this.queries[l]}},{key:"length",get:function(){return this.queries.length}},{key:"track",value:function(l){this.queries.push(l)}}]),o}(),l7=function(){function o(u){var l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;_(this,o),this.metadata=u,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=l}return w(o,[{key:"elementStart",value:function(l,p){this.isApplyingToNode(p)&&this.matchTNode(l,p)}},{key:"elementEnd",value:function(l){this._declarationNodeIndex===l.index&&(this._appliesToNextNode=!1)}},{key:"template",value:function(l,p){this.elementStart(l,p)}},{key:"embeddedTView",value:function(l,p){return this.isApplyingToNode(l)?(this.crossesNgTemplate=!0,this.addMatch(-l.index,p),new o(this.metadata)):null}},{key:"isApplyingToNode",value:function(l){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){for(var p=this._declarationNodeIndex,m=l.parent;null!==m&&8&m.type&&m.index!==p;)m=m.parent;return p===(null!==m?m.index:-1)}return this._appliesToNextNode}},{key:"matchTNode",value:function(l,p){var m=this.metadata.predicate;if(Array.isArray(m))for(var S=0;S<m.length;S++){var M=m[S];this.matchTNodeWithReadOption(l,p,u7(p,M)),this.matchTNodeWithReadOption(l,p,uc(p,l,M,!1,!1))}else m===wl?4&p.type&&this.matchTNodeWithReadOption(l,p,-1):this.matchTNodeWithReadOption(l,p,uc(p,l,m,!1,!1))}},{key:"matchTNodeWithReadOption",value:function(l,p,m){if(null!==m){var S=this.metadata.read;if(null!==S)if(S===Hs||S===Ca||S===wl&&4&p.type)this.addMatch(p.index,-2);else{var M=uc(p,l,S,!1,!1);null!==M&&this.addMatch(p.index,M)}else this.addMatch(p.index,m)}}},{key:"addMatch",value:function(l,p){null===this.matches?this.matches=[l,p]:this.matches.push(l,p)}}]),o}();function u7(o,u){var l=o.localNames;if(null!==l)for(var p=0;p<l.length;p+=2)if(l[p]===u)return l[p+1];return null}function f7(o,u,l,p){return-1===l?function(o,u){return 11&o.type?hf(o,u):4&o.type?Tm(o,u):null}(u,o):-2===l?function(o,u,l){return l===Hs?hf(u,o):l===wl?Tm(u,o):l===Ca?UC(u,o):void 0}(o,u,p):Qu(o,o[1],l,u)}function WC(o,u,l,p){var m=u[19].queries[p];if(null===m.matches){for(var S=o.data,M=l.matches,P=[],N=0;N<M.length;N+=2){var G=M[N];P.push(G<0?null:f7(u,S[G],M[N+1],l.metadata.read))}m.matches=P}return m.matches}function Q3(o,u,l,p){var m=o.queries.getByIndex(l),S=m.matches;if(null!==S)for(var M=WC(o,u,m,l),P=0;P<S.length;P+=2){var N=S[P];if(N>0)p.push(M[P/2]);else{for(var G=S[P+1],ie=u[-N],ye=10;ye<ie.length;ye++){var Ce=ie[ye];Ce[17]===Ce[3]&&Q3(Ce[1],Ce,G,p)}if(null!==ie[9])for(var Le=ie[9],qe=0;qe<Le.length;qe++){var nt=Le[qe];Q3(nt[1],nt,G,p)}}}return p}function Nh(o){var u=Wt(),l=Mn(),p=kp();$0(p+1);var m=XC(l,p);if(o.dirty&&Fp(u)===(2==(2&m.metadata.flags))){if(null===m.matches)o.reset([]);else{var S=m.crossesNgTemplate?Q3(l,u,p,[]):WC(l,u,m,p);o.reset(S,bx),o.notifyOnChanges()}return!0}return!1}function Ih(o,u,l,p){var m=Mn();if(m.firstCreatePass){var S=xi();(function(o,u,l){null===o.queries&&(o.queries=new s7),o.queries.track(new l7(u,l))})(m,new HC(u,l,p),S.index),function(o,u){var l=o.contentQueries||(o.contentQueries=[]);u!==(l.length?l[l.length-1]:-1)&&l.push(o.queries.length-1,u)}(m,o),2==(2&l)&&(m.staticContentQueries=!0)}!function(o,u,l){var p=new q3(4==(4&l));qc(o,u,p,p.destroy),null===u[19]&&(u[19]=new a7),u[19].queries.push(new o7(p))}(m,Wt(),l)}function kh(){return function(o,u){return o[19].queries[u].queryList}(Wt(),kp())}function XC(o,u){return o.queries.getByIndex(u)}var Fe=jl("Input",function(o){return{bindingPropertyName:o}}),_r=jl("Output",function(o){return{bindingPropertyName:o}});function Dm(){}var Om=new xn("Application Initializer"),mf=function(){var o=function(){function u(l){var p=this;_(this,u),this.appInits=l,this.resolve=Dm,this.reject=Dm,this.initialized=!1,this.done=!1,this.donePromise=new Promise(function(m,S){p.resolve=m,p.reject=S})}return w(u,[{key:"runInitializers",value:function(){var p=this;if(!this.initialized){var m=[],S=function(){p.done=!0,p.resolve()};if(this.appInits)for(var M=function(G){var ie=p.appInits[G]();if(ke(ie))m.push(ie);else if(Qe(ie)){var ye=new Promise(function(Ce,Le){ie.subscribe({complete:Ce,error:Le})});m.push(ye)}},P=0;P<this.appInits.length;P++)M(P);Promise.all(m).then(function(){S()}).catch(function(N){p.reject(N)}),0===m.length&&S(),this.initialized=!0}}}]),u}();return o.\u0275fac=function(l){return new(l||o)(Rr(Om,8))},o.\u0275prov=ln({token:o,factory:o.\u0275fac}),o}(),Gh=new xn("AppId"),L7={provide:Gh,useFactory:function(){return"".concat(r9()).concat(r9()).concat(r9())},deps:[]};function r9(){return String.fromCharCode(97+Math.floor(25*Math.random()))}var uw=new xn("Platform Initializer"),Pm=new xn("Platform ID"),cw=new xn("appBootstrapListener"),fw=function(){var o=function(){function u(){_(this,u)}return w(u,[{key:"log",value:function(p){console.log(p)}},{key:"warn",value:function(p){console.warn(p)}}]),u}();return o.\u0275fac=function(l){return new(l||o)},o.\u0275prov=ln({token:o,factory:o.\u0275fac}),o}(),Su=new xn("LocaleId"),dw=new xn("DefaultCurrencyCode"),N7=function o(u,l){_(this,o),this.ngModuleFactory=u,this.componentFactories=l},Fm=function(){var o=function(){function u(){_(this,u)}return w(u,[{key:"compileModuleSync",value:function(p){return new z3(p)}},{key:"compileModuleAsync",value:function(p){return Promise.resolve(this.compileModuleSync(p))}},{key:"compileModuleAndAllComponentsSync",value:function(p){var m=this.compileModuleSync(p),M=da(bo(p).declarations).reduce(function(P,N){var G=ki(N);return G&&P.push(new W3(G)),P},[]);return new N7(m,M)}},{key:"compileModuleAndAllComponentsAsync",value:function(p){return Promise.resolve(this.compileModuleAndAllComponentsSync(p))}},{key:"clearCache",value:function(){}},{key:"clearCacheFor",value:function(p){}},{key:"getModuleId",value:function(p){}}]),u}();return o.\u0275fac=function(l){return new(l||o)},o.\u0275prov=ln({token:o,factory:o.\u0275fac}),o}(),k7=function(){return Promise.resolve(0)}();function n9(o){"undefined"==typeof Zone?k7.then(function(){o&&o.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",o)}var eo=function(){function o(u){var l=u.enableLongStackTrace,p=void 0!==l&&l,m=u.shouldCoalesceEventChangeDetection,S=void 0!==m&&m,M=u.shouldCoalesceRunChangeDetection,P=void 0!==M&&M;if(_(this,o),this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new mt(!1),this.onMicrotaskEmpty=new mt(!1),this.onStable=new mt(!1),this.onError=new mt(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();var N=this;N._nesting=0,N._outer=N._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(N._inner=N._inner.fork(new Zone.TaskTrackingZoneSpec)),p&&Zone.longStackTraceZoneSpec&&(N._inner=N._inner.fork(Zone.longStackTraceZoneSpec)),N.shouldCoalesceEventChangeDetection=!P&&S,N.shouldCoalesceRunChangeDetection=P,N.lastRequestAnimationFrameId=-1,N.nativeRequestAnimationFrame=function(){var o=jn.requestAnimationFrame,u=jn.cancelAnimationFrame;if("undefined"!=typeof Zone&&o&&u){var l=o[Zone.__symbol__("OriginalDelegate")];l&&(o=l);var p=u[Zone.__symbol__("OriginalDelegate")];p&&(u=p)}return{nativeRequestAnimationFrame:o,nativeCancelAnimationFrame:u}}().nativeRequestAnimationFrame,function(o){var u=function(){!function(o){o.isCheckStableRunning||-1!==o.lastRequestAnimationFrameId||(o.lastRequestAnimationFrameId=o.nativeRequestAnimationFrame.call(jn,function(){o.fakeTopEventTask||(o.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",function(){o.lastRequestAnimationFrameId=-1,o9(o),o.isCheckStableRunning=!0,i9(o),o.isCheckStableRunning=!1},void 0,function(){},function(){})),o.fakeTopEventTask.invoke()}),o9(o))}(o)};o._inner=o._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:function(p,m,S,M,P,N){try{return hw(o),p.invokeTask(S,M,P,N)}finally{(o.shouldCoalesceEventChangeDetection&&"eventTask"===M.type||o.shouldCoalesceRunChangeDetection)&&u(),pw(o)}},onInvoke:function(p,m,S,M,P,N,G){try{return hw(o),p.invoke(S,M,P,N,G)}finally{o.shouldCoalesceRunChangeDetection&&u(),pw(o)}},onHasTask:function(p,m,S,M){p.hasTask(S,M),m===S&&("microTask"==M.change?(o._hasPendingMicrotasks=M.microTask,o9(o),i9(o)):"macroTask"==M.change&&(o.hasPendingMacrotasks=M.macroTask))},onHandleError:function(p,m,S,M){return p.handleError(S,M),o.runOutsideAngular(function(){return o.onError.emit(M)}),!1}})}(N)}return w(o,[{key:"run",value:function(l,p,m){return this._inner.run(l,p,m)}},{key:"runTask",value:function(l,p,m,S){var M=this._inner,P=M.scheduleEventTask("NgZoneEvent: "+S,l,G7,Dm,Dm);try{return M.runTask(P,p,m)}finally{M.cancelTask(P)}}},{key:"runGuarded",value:function(l,p,m){return this._inner.runGuarded(l,p,m)}},{key:"runOutsideAngular",value:function(l){return this._outer.run(l)}}],[{key:"isInAngularZone",value:function(){return!0===Zone.current.get("isAngularZone")}},{key:"assertInAngularZone",value:function(){if(!o.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}},{key:"assertNotInAngularZone",value:function(){if(o.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}}]),o}(),G7={};function i9(o){if(0==o._nesting&&!o.hasPendingMicrotasks&&!o.isStable)try{o._nesting++,o.onMicrotaskEmpty.emit(null)}finally{if(o._nesting--,!o.hasPendingMicrotasks)try{o.runOutsideAngular(function(){return o.onStable.emit(null)})}finally{o.isStable=!0}}}function o9(o){o.hasPendingMicrotasks=!!(o._hasPendingMicrotasks||(o.shouldCoalesceEventChangeDetection||o.shouldCoalesceRunChangeDetection)&&-1!==o.lastRequestAnimationFrameId)}function hw(o){o._nesting++,o.isStable&&(o.isStable=!1,o.onUnstable.emit(null))}function pw(o){o._nesting--,i9(o)}var gs,H7=function(){function o(){_(this,o),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new mt,this.onMicrotaskEmpty=new mt,this.onStable=new mt,this.onError=new mt}return w(o,[{key:"run",value:function(l,p,m){return l.apply(p,m)}},{key:"runGuarded",value:function(l,p,m){return l.apply(p,m)}},{key:"runOutsideAngular",value:function(l){return l()}},{key:"runTask",value:function(l,p,m,S){return l.apply(p,m)}}]),o}(),a9=function(){var o=function(){function u(l){var p=this;_(this,u),this._ngZone=l,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),l.run(function(){p.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}return w(u,[{key:"_watchAngularEvents",value:function(){var p=this;this._ngZone.onUnstable.subscribe({next:function(){p._didWork=!0,p._isZoneStable=!1}}),this._ngZone.runOutsideAngular(function(){p._ngZone.onStable.subscribe({next:function(){eo.assertNotInAngularZone(),n9(function(){p._isZoneStable=!0,p._runCallbacksIfReady()})}})})}},{key:"increasePendingRequestCount",value:function(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}},{key:"decreasePendingRequestCount",value:function(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}},{key:"isStable",value:function(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}},{key:"_runCallbacksIfReady",value:function(){var p=this;if(this.isStable())n9(function(){for(;0!==p._callbacks.length;){var S=p._callbacks.pop();clearTimeout(S.timeoutId),S.doneCb(p._didWork)}p._didWork=!1});else{var m=this.getPendingTasks();this._callbacks=this._callbacks.filter(function(S){return!S.updateCb||!S.updateCb(m)||(clearTimeout(S.timeoutId),!1)}),this._didWork=!0}}},{key:"getPendingTasks",value:function(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(function(p){return{source:p.source,creationLocation:p.creationLocation,data:p.data}}):[]}},{key:"addCallback",value:function(p,m,S){var M=this,P=-1;m&&m>0&&(P=setTimeout(function(){M._callbacks=M._callbacks.filter(function(N){return N.timeoutId!==P}),p(M._didWork,M.getPendingTasks())},m)),this._callbacks.push({doneCb:p,timeoutId:P,updateCb:S})}},{key:"whenStable",value:function(p,m,S){if(S&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(p,m,S),this._runCallbacksIfReady()}},{key:"getPendingRequestCount",value:function(){return this._pendingCount}},{key:"findProviders",value:function(p,m,S){return[]}}]),u}();return o.\u0275fac=function(l){return new(l||o)(Rr(eo))},o.\u0275prov=ln({token:o,factory:o.\u0275fac}),o}(),vw=function(){var o=function(){function u(){_(this,u),this._applications=new Map,s9.addToWindow(this)}return w(u,[{key:"registerApplication",value:function(p,m){this._applications.set(p,m)}},{key:"unregisterApplication",value:function(p){this._applications.delete(p)}},{key:"unregisterAllApplications",value:function(){this._applications.clear()}},{key:"getTestability",value:function(p){return this._applications.get(p)||null}},{key:"getAllTestabilities",value:function(){return Array.from(this._applications.values())}},{key:"getAllRootElements",value:function(){return Array.from(this._applications.keys())}},{key:"findTestabilityInTree",value:function(p){var m=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return s9.findTestabilityInTree(this,p,m)}}]),u}();return o.\u0275fac=function(l){return new(l||o)},o.\u0275prov=ln({token:o,factory:o.\u0275fac}),o}(),W7=function(){function o(){_(this,o)}return w(o,[{key:"addToWindow",value:function(l){}},{key:"findTestabilityInTree",value:function(l,p,m){return null}}]),o}(),s9=new W7;function j7(o,u,l){var p=new z3(l);return Promise.resolve(p)}var gw=new xn("AllowMultipleToken"),mw=function o(u,l){_(this,o),this.name=u,this.token=l};function q7(o){if(gs&&!gs.destroyed&&!gs.injector.get(gw,!1))throw new Or("400","");gs=o.get(ww);var l=o.get(uw,null);return l&&l.forEach(function(p){return p()}),gs}function yw(o,u){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],p="Platform: ".concat(u),m=new xn(p);return function(){var S=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],M=Cw();if(!M||M.injector.get(gw,!1))if(o)o(l.concat(S).concat({provide:m,useValue:!0}));else{var P=l.concat(S).concat({provide:m,useValue:!0},{provide:Zc,useValue:"platform"});q7(lo.create({providers:P,name:p}))}return K7()}}function K7(o){var u=Cw();if(!u)throw new Or("401","");return u}function Cw(){return gs&&!gs.destroyed?gs:null}var ww=function(){var o=function(){function u(l){_(this,u),this._injector=l,this._modules=[],this._destroyListeners=[],this._destroyed=!1}return w(u,[{key:"bootstrapModuleFactory",value:function(p,m){var S=this,G=function(o,u){return"noop"===o?new H7:("zone.js"===o?void 0:o)||new eo({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==u?void 0:u.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==u?void 0:u.ngZoneRunCoalescing)})}(m?m.ngZone:void 0,{ngZoneEventCoalescing:m&&m.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:m&&m.ngZoneRunCoalescing||!1}),ie=[{provide:eo,useValue:G}];return G.run(function(){var ye=lo.create({providers:ie,parent:S.injector,name:p.moduleType.name}),Ce=p.create(ye),Le=Ce.injector.get(eu,null);if(!Le)throw new Or("402","");return G.runOutsideAngular(function(){var nt=G.onError.subscribe({next:function(et){Le.handleError(et)}});Ce.onDestroy(function(){l9(S._modules,Ce),nt.unsubscribe()})}),function(o,u,l){try{var p=((nt=Ce.injector.get(mf)).runInitializers(),nt.donePromise.then(function(){return function(o){Po(o,"Expected localeId to be defined"),"string"==typeof o&&o.toLowerCase().replace(/_/g,"-")}(Ce.injector.get(Su,Cm)||Cm),S._moduleDoBootstrap(Ce),Ce}));return ke(p)?p.catch(function(m){throw u.runOutsideAngular(function(){return o.handleError(m)}),m}):p}catch(m){throw u.runOutsideAngular(function(){return o.handleError(m)}),m}var nt}(Le,G)})}},{key:"bootstrapModule",value:function(p){var m=this,S=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],M=_w({},S);return j7(0,0,p).then(function(P){return m.bootstrapModuleFactory(P,M)})}},{key:"_moduleDoBootstrap",value:function(p){var m=p.injector.get(Vh);if(p._bootstrapComponents.length>0)p._bootstrapComponents.forEach(function(M){return m.bootstrap(M)});else{if(!p.instance.ngDoBootstrap)throw new Or("403","");p.instance.ngDoBootstrap(m)}this._modules.push(p)}},{key:"onDestroy",value:function(p){this._destroyListeners.push(p)}},{key:"injector",get:function(){return this._injector}},{key:"destroy",value:function(){if(this._destroyed)throw new Or("404","");this._modules.slice().forEach(function(m){return m.destroy()}),this._destroyListeners.forEach(function(m){return m()}),this._destroyed=!0}},{key:"destroyed",get:function(){return this._destroyed}}]),u}();return o.\u0275fac=function(l){return new(l||o)(Rr(lo))},o.\u0275prov=ln({token:o,factory:o.\u0275fac}),o}();function _w(o,u){return Array.isArray(u)?u.reduce(_w,o):Object.assign(Object.assign({},o),u)}var Vh=function(){var o=function(){function u(l,p,m,S,M){var P=this;_(this,u),this._zone=l,this._injector=p,this._exceptionHandler=m,this._componentFactoryResolver=S,this._initStatus=M,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:function(){P._zone.run(function(){P.tick()})}});var N=new Ke(function(ie){P._stable=P._zone.isStable&&!P._zone.hasPendingMacrotasks&&!P._zone.hasPendingMicrotasks,P._zone.runOutsideAngular(function(){ie.next(P._stable),ie.complete()})}),G=new Ke(function(ie){var ye;P._zone.runOutsideAngular(function(){ye=P._zone.onStable.subscribe(function(){eo.assertNotInAngularZone(),n9(function(){!P._stable&&!P._zone.hasPendingMacrotasks&&!P._zone.hasPendingMicrotasks&&(P._stable=!0,ie.next(!0))})})});var Ce=P._zone.onUnstable.subscribe(function(){eo.assertInAngularZone(),P._stable&&(P._stable=!1,P._zone.runOutsideAngular(function(){ie.next(!1)}))});return function(){ye.unsubscribe(),Ce.unsubscribe()}});this.isStable=function(){for(var o=arguments.length,u=new Array(o),l=0;l<o;l++)u[l]=arguments[l];var p=Ge(u),m=Wr(u,1/0),S=u;return S.length?1===S.length?kr(S[0]):Zt(m)(Ve(S,p)):jt}(N,G.pipe(function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=o.connector,l=void 0===u?function(){return new He}:u,p=o.resetOnError,m=void 0===p||p,S=o.resetOnComplete,M=void 0===S||S,P=o.resetOnRefCountZero,N=void 0===P||P;return function(G){var ie=null,ye=null,Ce=null,Le=0,qe=!1,nt=!1,tt=function(){null==ye||ye.unsubscribe(),ye=null},et=function(){tt(),ie=Ce=null,qe=nt=!1},Ze=function(){var At=ie;et(),null==At||At.unsubscribe()};return Gt(function(ht,At){Le++,!nt&&!qe&&tt();var Tt=Ce=null!=Ce?Ce:l();At.add(function(){0==--Le&&!nt&&!qe&&(ye=Ft(Ze,N))}),Tt.subscribe(At),ie||(ie=new Ne({next:function(yr){return Tt.next(yr)},error:function(yr){nt=!0,tt(),ye=Ft(et,m,yr),Tt.error(yr)},complete:function(){qe=!0,tt(),ye=Ft(et,M),Tt.complete()}}),Ve(ht).subscribe(ie))})(G)}}()))}return w(u,[{key:"bootstrap",value:function(p,m){var P,S=this;if(!this._initStatus.done)throw new Or("405","");P=p instanceof bC?p:this._componentFactoryResolver.resolveComponentFactory(p),this.componentTypes.push(P.componentType);var N=function(o){return o.isBoundToModule}(P)?void 0:this._injector.get(Cl),ie=P.create(lo.NULL,[],m||P.selector,N),ye=ie.location.nativeElement,Ce=ie.injector.get(a9,null),Le=Ce&&ie.injector.get(vw);return Ce&&Le&&Le.registerApplication(ye,Ce),ie.onDestroy(function(){S.detachView(ie.hostView),l9(S.components,ie),Le&&Le.unregisterApplication(ye)}),this._loadComponent(ie),ie}},{key:"tick",value:function(){var p=this;if(this._runningTick)throw new Or("101","");try{this._runningTick=!0;var M,S=I(this._views);try{for(S.s();!(M=S.n()).done;)M.value.detectChanges()}catch(ye){S.e(ye)}finally{S.f()}}catch(ye){this._zone.runOutsideAngular(function(){return p._exceptionHandler.handleError(ye)})}finally{this._runningTick=!1}}},{key:"attachView",value:function(p){var m=p;this._views.push(m),m.attachToAppRef(this)}},{key:"detachView",value:function(p){var m=p;l9(this._views,m),m.detachFromAppRef()}},{key:"_loadComponent",value:function(p){this.attachView(p.hostView),this.tick(),this.components.push(p),this._injector.get(cw,[]).concat(this._bootstrapListeners).forEach(function(S){return S(p)})}},{key:"ngOnDestroy",value:function(){this._views.slice().forEach(function(p){return p.destroy()}),this._onMicrotaskEmptySubscription.unsubscribe()}},{key:"viewCount",get:function(){return this._views.length}}]),u}();return o.\u0275fac=function(l){return new(l||o)(Rr(eo),Rr(lo),Rr(eu),Rr(_u),Rr(mf))},o.\u0275prov=ln({token:o,factory:o.\u0275fac}),o}();function l9(o,u){var l=o.indexOf(u);l>-1&&o.splice(l,1)}var u9=function(){var o=function u(){_(this,u)};return o.__NG_ELEMENT_ID__=eb,o}();function eb(o){return function(o,u,l){if(Da(o)&&!l){var p=Fo(o.index,u);return new Ph(p,p)}return 47&o.type?new Ph(u[16],u):null}(xi(),Wt(),16==(16&o))}var Ew=function(){function o(){_(this,o)}return w(o,[{key:"supports",value:function(l){return hu(l)}},{key:"create",value:function(l){return new ob(l)}}]),o}(),ib=function(u,l){return l},ob=function(){function o(u){_(this,o),this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=u||ib}return w(o,[{key:"forEachItem",value:function(l){var p;for(p=this._itHead;null!==p;p=p._next)l(p)}},{key:"forEachOperation",value:function(l){for(var p=this._itHead,m=this._removalsHead,S=0,M=null;p||m;){var P=!m||p&&p.currentIndex<Dw(m,S,M)?p:m,N=Dw(P,S,M),G=P.currentIndex;if(P===m)S--,m=m._nextRemoved;else if(p=p._next,null==P.previousIndex)S++;else{M||(M=[]);var ie=N-S,ye=G-S;if(ie!=ye){for(var Ce=0;Ce<ie;Ce++){var Le=Ce<M.length?M[Ce]:M[Ce]=0,qe=Le+Ce;ye<=qe&&qe<ie&&(M[Ce]=Le+1)}M[P.previousIndex]=ye-ie}}N!==G&&l(P,N,G)}}},{key:"forEachPreviousItem",value:function(l){var p;for(p=this._previousItHead;null!==p;p=p._nextPrevious)l(p)}},{key:"forEachAddedItem",value:function(l){var p;for(p=this._additionsHead;null!==p;p=p._nextAdded)l(p)}},{key:"forEachMovedItem",value:function(l){var p;for(p=this._movesHead;null!==p;p=p._nextMoved)l(p)}},{key:"forEachRemovedItem",value:function(l){var p;for(p=this._removalsHead;null!==p;p=p._nextRemoved)l(p)}},{key:"forEachIdentityChange",value:function(l){var p;for(p=this._identityChangesHead;null!==p;p=p._nextIdentityChange)l(p)}},{key:"diff",value:function(l){if(null==l&&(l=[]),!hu(l))throw new Error("Error trying to diff '".concat(Qt(l),"'. Only arrays and iterables are allowed"));return this.check(l)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(l){var p=this;this._reset();var M,P,N,m=this._itHead,S=!1;if(Array.isArray(l)){this.length=l.length;for(var G=0;G<this.length;G++)N=this._trackByFn(G,P=l[G]),null!==m&&Object.is(m.trackById,N)?(S&&(m=this._verifyReinsertion(m,P,N,G)),Object.is(m.item,P)||this._addIdentityChange(m,P)):(m=this._mismatch(m,P,N,G),S=!0),m=m._next}else M=0,function(o,u){if(Array.isArray(o))for(var l=0;l<o.length;l++)u(o[l]);else for(var m,p=o[ma()]();!(m=p.next()).done;)u(m.value)}(l,function(ie){N=p._trackByFn(M,ie),null!==m&&Object.is(m.trackById,N)?(S&&(m=p._verifyReinsertion(m,ie,N,M)),Object.is(m.item,ie)||p._addIdentityChange(m,ie)):(m=p._mismatch(m,ie,N,M),S=!0),m=m._next,M++}),this.length=M;return this._truncate(m),this.collection=l,this.isDirty}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}},{key:"_reset",value:function(){if(this.isDirty){var l;for(l=this._previousItHead=this._itHead;null!==l;l=l._next)l._nextPrevious=l._next;for(l=this._additionsHead;null!==l;l=l._nextAdded)l.previousIndex=l.currentIndex;for(this._additionsHead=this._additionsTail=null,l=this._movesHead;null!==l;l=l._nextMoved)l.previousIndex=l.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}},{key:"_mismatch",value:function(l,p,m,S){var M;return null===l?M=this._itTail:(M=l._prev,this._remove(l)),null!==(l=null===this._unlinkedRecords?null:this._unlinkedRecords.get(m,null))?(Object.is(l.item,p)||this._addIdentityChange(l,p),this._reinsertAfter(l,M,S)):null!==(l=null===this._linkedRecords?null:this._linkedRecords.get(m,S))?(Object.is(l.item,p)||this._addIdentityChange(l,p),this._moveAfter(l,M,S)):l=this._addAfter(new ab(p,m),M,S),l}},{key:"_verifyReinsertion",value:function(l,p,m,S){var M=null===this._unlinkedRecords?null:this._unlinkedRecords.get(m,null);return null!==M?l=this._reinsertAfter(M,l._prev,S):l.currentIndex!=S&&(l.currentIndex=S,this._addToMoves(l,S)),l}},{key:"_truncate",value:function(l){for(;null!==l;){var p=l._next;this._addToRemovals(this._unlink(l)),l=p}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}},{key:"_reinsertAfter",value:function(l,p,m){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(l);var S=l._prevRemoved,M=l._nextRemoved;return null===S?this._removalsHead=M:S._nextRemoved=M,null===M?this._removalsTail=S:M._prevRemoved=S,this._insertAfter(l,p,m),this._addToMoves(l,m),l}},{key:"_moveAfter",value:function(l,p,m){return this._unlink(l),this._insertAfter(l,p,m),this._addToMoves(l,m),l}},{key:"_addAfter",value:function(l,p,m){return this._insertAfter(l,p,m),this._additionsTail=null===this._additionsTail?this._additionsHead=l:this._additionsTail._nextAdded=l,l}},{key:"_insertAfter",value:function(l,p,m){var S=null===p?this._itHead:p._next;return l._next=S,l._prev=p,null===S?this._itTail=l:S._prev=l,null===p?this._itHead=l:p._next=l,null===this._linkedRecords&&(this._linkedRecords=new Rw),this._linkedRecords.put(l),l.currentIndex=m,l}},{key:"_remove",value:function(l){return this._addToRemovals(this._unlink(l))}},{key:"_unlink",value:function(l){null!==this._linkedRecords&&this._linkedRecords.remove(l);var p=l._prev,m=l._next;return null===p?this._itHead=m:p._next=m,null===m?this._itTail=p:m._prev=p,l}},{key:"_addToMoves",value:function(l,p){return l.previousIndex===p||(this._movesTail=null===this._movesTail?this._movesHead=l:this._movesTail._nextMoved=l),l}},{key:"_addToRemovals",value:function(l){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Rw),this._unlinkedRecords.put(l),l.currentIndex=null,l._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=l,l._prevRemoved=null):(l._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=l),l}},{key:"_addIdentityChange",value:function(l,p){return l.item=p,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=l:this._identityChangesTail._nextIdentityChange=l,l}}]),o}(),ab=function o(u,l){_(this,o),this.item=u,this.trackById=l,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null},sb=function(){function o(){_(this,o),this._head=null,this._tail=null}return w(o,[{key:"add",value:function(l){null===this._head?(this._head=this._tail=l,l._nextDup=null,l._prevDup=null):(this._tail._nextDup=l,l._prevDup=this._tail,l._nextDup=null,this._tail=l)}},{key:"get",value:function(l,p){var m;for(m=this._head;null!==m;m=m._nextDup)if((null===p||p<=m.currentIndex)&&Object.is(m.trackById,l))return m;return null}},{key:"remove",value:function(l){var p=l._prevDup,m=l._nextDup;return null===p?this._head=m:p._nextDup=m,null===m?this._tail=p:m._prevDup=p,null===this._head}}]),o}(),Rw=function(){function o(){_(this,o),this.map=new Map}return w(o,[{key:"put",value:function(l){var p=l.trackById,m=this.map.get(p);m||(m=new sb,this.map.set(p,m)),m.add(l)}},{key:"get",value:function(l,p){var S=this.map.get(l);return S?S.get(l,p):null}},{key:"remove",value:function(l){var p=l.trackById;return this.map.get(p).remove(l)&&this.map.delete(p),l}},{key:"isEmpty",get:function(){return 0===this.map.size}},{key:"clear",value:function(){this.map.clear()}}]),o}();function Dw(o,u,l){var p=o.previousIndex;if(null===p)return p;var m=0;return l&&p<l.length&&(m=l[p]),p+u+m}var Ow=function(){function o(){_(this,o)}return w(o,[{key:"supports",value:function(l){return l instanceof Map||gh(l)}},{key:"create",value:function(){return new lb}}]),o}(),lb=function(){function o(){_(this,o),this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}return w(o,[{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}},{key:"forEachItem",value:function(l){var p;for(p=this._mapHead;null!==p;p=p._next)l(p)}},{key:"forEachPreviousItem",value:function(l){var p;for(p=this._previousMapHead;null!==p;p=p._nextPrevious)l(p)}},{key:"forEachChangedItem",value:function(l){var p;for(p=this._changesHead;null!==p;p=p._nextChanged)l(p)}},{key:"forEachAddedItem",value:function(l){var p;for(p=this._additionsHead;null!==p;p=p._nextAdded)l(p)}},{key:"forEachRemovedItem",value:function(l){var p;for(p=this._removalsHead;null!==p;p=p._nextRemoved)l(p)}},{key:"diff",value:function(l){if(l){if(!(l instanceof Map||gh(l)))throw new Error("Error trying to diff '".concat(Qt(l),"'. Only maps and objects are allowed"))}else l=new Map;return this.check(l)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(l){var p=this;this._reset();var m=this._mapHead;if(this._appendAfter=null,this._forEach(l,function(M,P){if(m&&m.key===P)p._maybeAddToChanges(m,M),p._appendAfter=m,m=m._next;else{var N=p._getOrCreateRecordForKey(P,M);m=p._insertBeforeOrAppend(m,N)}}),m){m._prev&&(m._prev._next=null),this._removalsHead=m;for(var S=m;null!==S;S=S._nextRemoved)S===this._mapHead&&(this._mapHead=null),this._records.delete(S.key),S._nextRemoved=S._next,S.previousValue=S.currentValue,S.currentValue=null,S._prev=null,S._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}},{key:"_insertBeforeOrAppend",value:function(l,p){if(l){var m=l._prev;return p._next=l,p._prev=m,l._prev=p,m&&(m._next=p),l===this._mapHead&&(this._mapHead=p),this._appendAfter=l,l}return this._appendAfter?(this._appendAfter._next=p,p._prev=this._appendAfter):this._mapHead=p,this._appendAfter=p,null}},{key:"_getOrCreateRecordForKey",value:function(l,p){if(this._records.has(l)){var m=this._records.get(l);this._maybeAddToChanges(m,p);var S=m._prev,M=m._next;return S&&(S._next=M),M&&(M._prev=S),m._next=null,m._prev=null,m}var P=new ub(l);return this._records.set(l,P),P.currentValue=p,this._addToAdditions(P),P}},{key:"_reset",value:function(){if(this.isDirty){var l;for(this._previousMapHead=this._mapHead,l=this._previousMapHead;null!==l;l=l._next)l._nextPrevious=l._next;for(l=this._changesHead;null!==l;l=l._nextChanged)l.previousValue=l.currentValue;for(l=this._additionsHead;null!=l;l=l._nextAdded)l.previousValue=l.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}},{key:"_maybeAddToChanges",value:function(l,p){Object.is(p,l.currentValue)||(l.previousValue=l.currentValue,l.currentValue=p,this._addToChanges(l))}},{key:"_addToAdditions",value:function(l){null===this._additionsHead?this._additionsHead=this._additionsTail=l:(this._additionsTail._nextAdded=l,this._additionsTail=l)}},{key:"_addToChanges",value:function(l){null===this._changesHead?this._changesHead=this._changesTail=l:(this._changesTail._nextChanged=l,this._changesTail=l)}},{key:"_forEach",value:function(l,p){l instanceof Map?l.forEach(p):Object.keys(l).forEach(function(m){return p(l[m],m)})}}]),o}(),ub=function o(u){_(this,o),this.key=u,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null};function Pw(){return new Uh([new Ew])}var Uh=function(){var o=function(){function u(l){_(this,u),this.factories=l}return w(u,[{key:"find",value:function(p){var m=this.factories.find(function(S){return S.supports(p)});if(null!=m)return m;throw new Error("Cannot find a differ supporting object '".concat(p,"' of type '").concat(function(o){return o.name||typeof o}(p),"'"))}}],[{key:"create",value:function(p,m){if(null!=m){var S=m.factories.slice();p=p.concat(S)}return new u(p)}},{key:"extend",value:function(p){return{provide:u,useFactory:function(S){return u.create(p,S||Pw())},deps:[[u,new Ql,new Ba]]}}}]),u}();return o.\u0275prov=ln({token:o,providedIn:"root",factory:Pw}),o}();function Fw(){return new yf([new Ow])}var yf=function(){var o=function(){function u(l){_(this,u),this.factories=l}return w(u,[{key:"find",value:function(p){var m=this.factories.find(function(S){return S.supports(p)});if(m)return m;throw new Error("Cannot find a differ supporting object '".concat(p,"'"))}}],[{key:"create",value:function(p,m){if(m){var S=m.factories.slice();p=p.concat(S)}return new u(p)}},{key:"extend",value:function(p){return{provide:u,useFactory:function(S){return u.create(p,S||Fw())},deps:[[u,new Ql,new Ba]]}}}]),u}();return o.\u0275prov=ln({token:o,providedIn:"root",factory:Fw}),o}(),fb=[new Ow],hb=new Uh([new Ew]),pb=new yf(fb),gb=yw(null,"core",[{provide:Pm,useValue:"unknown"},{provide:ww,deps:[lo]},{provide:vw,deps:[]},{provide:fw,deps:[]}]),_b=[{provide:Vh,useClass:Vh,deps:[eo,lo,eu,_u,mf]},{provide:Ox,deps:[eo],useFactory:function(o){var u=[];return o.onStable.subscribe(function(){for(;u.length;)u.pop()()}),function(l){u.push(l)}}},{provide:mf,useClass:mf,deps:[[new Ba,Om]]},{provide:Fm,useClass:Fm,deps:[]},L7,{provide:Uh,useFactory:function(){return hb},deps:[]},{provide:yf,useFactory:function(){return pb},deps:[]},{provide:Su,useFactory:function(o){return o||"undefined"!=typeof $localize&&$localize.locale||Cm},deps:[[new r0(Su),new Ba,new Ql]]},{provide:dw,useValue:"USD"}],xb=function(){var o=function u(l){_(this,u)};return o.\u0275fac=function(l){return new(l||o)(Rr(Vh))},o.\u0275mod=ji({type:o}),o.\u0275inj=zo({providers:_b}),o}(),Lm=null;function xu(){return Lm}var Mb=function o(){_(this,o)},wa=new xn("DocumentToken"),D0=function(){var o=function(){function u(){_(this,u)}return w(u,[{key:"historyGo",value:function(p){throw new Error("Not implemented")}}]),u}();return o.\u0275fac=function(l){return new(l||o)},o.\u0275prov=ln({token:o,factory:function(){return Rr(Lw)},providedIn:"platform"}),o}(),Eb=new xn("Location Initialized"),Lw=function(){var o=function(u){b(p,u);var l=D(p);function p(m){var S;return _(this,p),(S=l.call(this))._doc=m,S._init(),S}return w(p,[{key:"_init",value:function(){this.location=window.location,this._history=window.history}},{key:"getBaseHrefFromDOM",value:function(){return xu().getBaseHref(this._doc)}},{key:"onPopState",value:function(S){var M=xu().getGlobalEventTarget(this._doc,"window");return M.addEventListener("popstate",S,!1),function(){return M.removeEventListener("popstate",S)}}},{key:"onHashChange",value:function(S){var M=xu().getGlobalEventTarget(this._doc,"window");return M.addEventListener("hashchange",S,!1),function(){return M.removeEventListener("hashchange",S)}}},{key:"href",get:function(){return this.location.href}},{key:"protocol",get:function(){return this.location.protocol}},{key:"hostname",get:function(){return this.location.hostname}},{key:"port",get:function(){return this.location.port}},{key:"pathname",get:function(){return this.location.pathname},set:function(S){this.location.pathname=S}},{key:"search",get:function(){return this.location.search}},{key:"hash",get:function(){return this.location.hash}},{key:"pushState",value:function(S,M,P){Nw()?this._history.pushState(S,M,P):this.location.hash=P}},{key:"replaceState",value:function(S,M,P){Nw()?this._history.replaceState(S,M,P):this.location.hash=P}},{key:"forward",value:function(){this._history.forward()}},{key:"back",value:function(){this._history.back()}},{key:"historyGo",value:function(){var S=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._history.go(S)}},{key:"getState",value:function(){return this._history.state}}]),p}(D0);return o.\u0275fac=function(l){return new(l||o)(Rr(wa))},o.\u0275prov=ln({token:o,factory:function(){return new Lw(Rr(wa))},providedIn:"platform"}),o}();function Nw(){return!!window.history.pushState}function v9(o,u){if(0==o.length)return u;if(0==u.length)return o;var l=0;return o.endsWith("/")&&l++,u.startsWith("/")&&l++,2==l?o+u.substring(1):1==l?o+u:o+"/"+u}function Iw(o){var u=o.match(/#|\?|$/),l=u&&u.index||o.length;return o.slice(0,l-("/"===o[l-1]?1:0))+o.slice(l)}function _l(o){return o&&"?"!==o[0]?"?"+o:o}var Cf=function(){var o=function(){function u(){_(this,u)}return w(u,[{key:"historyGo",value:function(p){throw new Error("Not implemented")}}]),u}();return o.\u0275fac=function(l){return new(l||o)},o.\u0275prov=ln({token:o,factory:function(){return u=Rr(wa).location,new kw(Rr(D0),u&&u.origin||"");var u},providedIn:"root"}),o}(),g9=new xn("appBaseHref"),kw=function(){var o=function(u){b(p,u);var l=D(p);function p(m,S){var M;if(_(this,p),(M=l.call(this))._platformLocation=m,M._removeListenerFns=[],null==S&&(S=M._platformLocation.getBaseHrefFromDOM()),null==S)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");return M._baseHref=S,M}return w(p,[{key:"ngOnDestroy",value:function(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}},{key:"onPopState",value:function(S){this._removeListenerFns.push(this._platformLocation.onPopState(S),this._platformLocation.onHashChange(S))}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"prepareExternalUrl",value:function(S){return v9(this._baseHref,S)}},{key:"path",value:function(){var S=arguments.length>0&&void 0!==arguments[0]&&arguments[0],M=this._platformLocation.pathname+_l(this._platformLocation.search),P=this._platformLocation.hash;return P&&S?"".concat(M).concat(P):M}},{key:"pushState",value:function(S,M,P,N){var G=this.prepareExternalUrl(P+_l(N));this._platformLocation.pushState(S,M,G)}},{key:"replaceState",value:function(S,M,P,N){var G=this.prepareExternalUrl(P+_l(N));this._platformLocation.replaceState(S,M,G)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}},{key:"historyGo",value:function(){var M,P,S=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(P=(M=this._platformLocation).historyGo)||void 0===P||P.call(M,S)}}]),p}(Cf);return o.\u0275fac=function(l){return new(l||o)(Rr(D0),Rr(g9,8))},o.\u0275prov=ln({token:o,factory:o.\u0275fac}),o}(),Ob=function(){var o=function(u){b(p,u);var l=D(p);function p(m,S){var M;return _(this,p),(M=l.call(this))._platformLocation=m,M._baseHref="",M._removeListenerFns=[],null!=S&&(M._baseHref=S),M}return w(p,[{key:"ngOnDestroy",value:function(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}},{key:"onPopState",value:function(S){this._removeListenerFns.push(this._platformLocation.onPopState(S),this._platformLocation.onHashChange(S))}},{key:"getBaseHref",value:function(){return this._baseHref}},{key:"path",value:function(){var M=this._platformLocation.hash;return null==M&&(M="#"),M.length>0?M.substring(1):M}},{key:"prepareExternalUrl",value:function(S){var M=v9(this._baseHref,S);return M.length>0?"#"+M:M}},{key:"pushState",value:function(S,M,P,N){var G=this.prepareExternalUrl(P+_l(N));0==G.length&&(G=this._platformLocation.pathname),this._platformLocation.pushState(S,M,G)}},{key:"replaceState",value:function(S,M,P,N){var G=this.prepareExternalUrl(P+_l(N));0==G.length&&(G=this._platformLocation.pathname),this._platformLocation.replaceState(S,M,G)}},{key:"forward",value:function(){this._platformLocation.forward()}},{key:"back",value:function(){this._platformLocation.back()}},{key:"historyGo",value:function(){var M,P,S=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(P=(M=this._platformLocation).historyGo)||void 0===P||P.call(M,S)}}]),p}(Cf);return o.\u0275fac=function(l){return new(l||o)(Rr(D0),Rr(g9,8))},o.\u0275prov=ln({token:o,factory:o.\u0275fac}),o}(),m9=function(){var o=function(){function u(l,p){var m=this;_(this,u),this._subject=new mt,this._urlChangeListeners=[],this._platformStrategy=l;var S=this._platformStrategy.getBaseHref();this._platformLocation=p,this._baseHref=Iw(Bw(S)),this._platformStrategy.onPopState(function(M){m._subject.emit({url:m.path(!0),pop:!0,state:M.state,type:M.type})})}return w(u,[{key:"path",value:function(){var p=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.normalize(this._platformStrategy.path(p))}},{key:"getState",value:function(){return this._platformLocation.getState()}},{key:"isCurrentPathEqualTo",value:function(p){var m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return this.path()==this.normalize(p+_l(m))}},{key:"normalize",value:function(p){return u.stripTrailingSlash(function(o,u){return o&&u.startsWith(o)?u.substring(o.length):u}(this._baseHref,Bw(p)))}},{key:"prepareExternalUrl",value:function(p){return p&&"/"!==p[0]&&(p="/"+p),this._platformStrategy.prepareExternalUrl(p)}},{key:"go",value:function(p){var m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",S=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.pushState(S,"",p,m),this._notifyUrlChangeListeners(this.prepareExternalUrl(p+_l(m)),S)}},{key:"replaceState",value:function(p){var m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",S=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this._platformStrategy.replaceState(S,"",p,m),this._notifyUrlChangeListeners(this.prepareExternalUrl(p+_l(m)),S)}},{key:"forward",value:function(){this._platformStrategy.forward()}},{key:"back",value:function(){this._platformStrategy.back()}},{key:"historyGo",value:function(){var m,S,p=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;null===(S=(m=this._platformStrategy).historyGo)||void 0===S||S.call(m,p)}},{key:"onUrlChange",value:function(p){var m=this;this._urlChangeListeners.push(p),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(function(S){m._notifyUrlChangeListeners(S.url,S.state)}))}},{key:"_notifyUrlChangeListeners",value:function(){var p=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",m=arguments.length>1?arguments[1]:void 0;this._urlChangeListeners.forEach(function(S){return S(p,m)})}},{key:"subscribe",value:function(p,m,S){return this._subject.subscribe({next:p,error:m,complete:S})}}]),u}();return o.normalizeQueryParams=_l,o.joinWithSlash=v9,o.stripTrailingSlash=Iw,o.\u0275fac=function(l){return new(l||o)(Rr(Cf),Rr(D0))},o.\u0275prov=ln({token:o,factory:function(){return new m9(Rr(Cf),Rr(D0))},providedIn:"root"}),o}();function Bw(o){return o.replace(/\/index.html$/,"")}var Gi=function(){return(Gi=Gi||{})[Gi.Zero=0]="Zero",Gi[Gi.One=1]="One",Gi[Gi.Two=2]="Two",Gi[Gi.Few=3]="Few",Gi[Gi.Many=4]="Many",Gi[Gi.Other=5]="Other",Gi}(),Vb=function(o){return function(o){var u=function(o){return o.toLowerCase().replace(/_/g,"-")}(o),l=J5(u);if(l)return l;var p=u.split("-")[0];if(l=J5(p))return l;if("en"===p)return yS;throw new Error('Missing locale data for the locale "'.concat(o,'".'))}(o)[mr.PluralCase]},zm=function o(){_(this,o)},vA=function(){var o=function(u){b(p,u);var l=D(p);function p(m){var S;return _(this,p),(S=l.call(this)).locale=m,S}return w(p,[{key:"getPluralCategory",value:function(S,M){switch(Vb(M||this.locale)(S)){case Gi.Zero:return"zero";case Gi.One:return"one";case Gi.Two:return"two";case Gi.Few:return"few";case Gi.Many:return"many";default:return"other"}}}]),p}(zm);return o.\u0275fac=function(l){return new(l||o)(Rr(Su))},o.\u0275prov=ln({token:o,factory:o.\u0275fac}),o}();function Yw(o,u){u=encodeURIComponent(u);var p,l=I(o.split(";"));try{for(l.s();!(p=l.n()).done;){var m=p.value,S=m.indexOf("="),P=X(-1==S?[m,""]:[m.slice(0,S),m.slice(S+1)],2),G=P[1];if(P[0].trim()===u)return decodeURIComponent(G)}}catch(ie){l.e(ie)}finally{l.f()}return null}var yA=function(){function o(u,l,p,m){_(this,o),this.$implicit=u,this.ngForOf=l,this.index=p,this.count=m}return w(o,[{key:"first",get:function(){return 0===this.index}},{key:"last",get:function(){return this.index===this.count-1}},{key:"even",get:function(){return this.index%2==0}},{key:"odd",get:function(){return!this.even}}]),o}(),bu=function(){var o=function(){function u(l,p,m){_(this,u),this._viewContainer=l,this._template=p,this._differs=m,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}return w(u,[{key:"ngForOf",set:function(p){this._ngForOf=p,this._ngForOfDirty=!0}},{key:"ngForTrackBy",get:function(){return this._trackByFn},set:function(p){this._trackByFn=p}},{key:"ngForTemplate",set:function(p){p&&(this._template=p)}},{key:"ngDoCheck",value:function(){if(this._ngForOfDirty){this._ngForOfDirty=!1;var p=this._ngForOf;!this._differ&&p&&(this._differ=this._differs.find(p).create(this.ngForTrackBy))}if(this._differ){var m=this._differ.diff(this._ngForOf);m&&this._applyChanges(m)}}},{key:"_applyChanges",value:function(p){var m=this,S=this._viewContainer;p.forEachOperation(function(ie,ye,Ce){if(null==ie.previousIndex)S.createEmbeddedView(m._template,new yA(ie.item,m._ngForOf,-1,-1),null===Ce?void 0:Ce);else if(null==Ce)S.remove(null===ye?void 0:ye);else if(null!==ye){var Le=S.get(ye);S.move(Le,Ce),qw(Le,ie)}});for(var M=0,P=S.length;M<P;M++){var G=S.get(M).context;G.index=M,G.count=P,G.ngForOf=this._ngForOf}p.forEachIdentityChange(function(ie){qw(S.get(ie.currentIndex),ie)})}}],[{key:"ngTemplateContextGuard",value:function(p,m){return!0}}]),u}();return o.\u0275fac=function(l){return new(l||o)(dr(Ca),dr(wl),dr(Uh))},o.\u0275dir=no({type:o,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),o}();function qw(o,u){o.context.$implicit=u.item}var Ws=function(){var o=function(){function u(l,p){_(this,u),this._viewContainer=l,this._context=new CA,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=p}return w(u,[{key:"ngIf",set:function(p){this._context.$implicit=this._context.ngIf=p,this._updateView()}},{key:"ngIfThen",set:function(p){Kw("ngIfThen",p),this._thenTemplateRef=p,this._thenViewRef=null,this._updateView()}},{key:"ngIfElse",set:function(p){Kw("ngIfElse",p),this._elseTemplateRef=p,this._elseViewRef=null,this._updateView()}},{key:"_updateView",value:function(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}}],[{key:"ngTemplateContextGuard",value:function(p,m){return!0}}]),u}();return o.\u0275fac=function(l){return new(l||o)(dr(Ca),dr(wl))},o.\u0275dir=no({type:o,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),o}(),CA=function o(){_(this,o),this.$implicit=null,this.ngIf=null};function Kw(o,u){if(u&&!u.createEmbeddedView)throw new Error("".concat(o," must be a TemplateRef, but received '").concat(Qt(u),"'."))}var AA=function(){function o(){_(this,o)}return w(o,[{key:"createSubscription",value:function(l,p){return l.subscribe({next:p,error:function(S){throw S}})}},{key:"dispose",value:function(l){l.unsubscribe()}},{key:"onDestroy",value:function(l){l.unsubscribe()}}]),o}(),MA=function(){function o(){_(this,o)}return w(o,[{key:"createSubscription",value:function(l,p){return l.then(p,function(m){throw m})}},{key:"dispose",value:function(l){}},{key:"onDestroy",value:function(l){}}]),o}(),TA=new MA,EA=new AA,E9=function(){var o=function(){function u(l){_(this,u),this._ref=l,this._latestValue=null,this._subscription=null,this._obj=null,this._strategy=null}return w(u,[{key:"ngOnDestroy",value:function(){this._subscription&&this._dispose()}},{key:"transform",value:function(p){return this._obj?p!==this._obj?(this._dispose(),this.transform(p)):this._latestValue:(p&&this._subscribe(p),this._latestValue)}},{key:"_subscribe",value:function(p){var m=this;this._obj=p,this._strategy=this._selectStrategy(p),this._subscription=this._strategy.createSubscription(p,function(S){return m._updateLatestValue(p,S)})}},{key:"_selectStrategy",value:function(p){if(ke(p))return TA;if(je(p))return EA;throw function(o,u){return Error("InvalidPipeArgument: '".concat(u,"' for pipe '").concat(Qt(o),"'"))}(u,p)}},{key:"_dispose",value:function(){this._strategy.dispose(this._subscription),this._latestValue=null,this._subscription=null,this._obj=null}},{key:"_updateLatestValue",value:function(p,m){p===this._obj&&(this._latestValue=m,this._ref.markForCheck())}}]),u}();return o.\u0275fac=function(l){return new(l||o)(dr(u9,16))},o.\u0275pipe=xo({name:"async",type:o,pure:!1}),o}(),jA=function(){var o=function u(){_(this,u)};return o.\u0275fac=function(l){return new(l||o)},o.\u0275mod=ji({type:o}),o.\u0275inj=zo({providers:[{provide:zm,useClass:vA}]}),o}(),KA=function(){var o=function u(){_(this,u)};return o.\u0275prov=ln({token:o,providedIn:"root",factory:function(){return new QA(Rr(wa),window)}}),o}(),QA=function(){function o(u,l){_(this,o),this.document=u,this.window=l,this.offset=function(){return[0,0]}}return w(o,[{key:"setOffset",value:function(l){this.offset=Array.isArray(l)?function(){return l}:l}},{key:"getScrollPosition",value:function(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}},{key:"scrollToPosition",value:function(l){this.supportsScrolling()&&this.window.scrollTo(l[0],l[1])}},{key:"scrollToAnchor",value:function(l){if(this.supportsScrolling()){var p=function(o,u){var l=o.getElementById(u)||o.getElementsByName(u)[0];if(l)return l;if("function"==typeof o.createTreeWalker&&o.body&&(o.body.createShadowRoot||o.body.attachShadow))for(var p=o.createTreeWalker(o.body,NodeFilter.SHOW_ELEMENT),m=p.currentNode;m;){var S=m.shadowRoot;if(S){var M=S.getElementById(u)||S.querySelector('[name="'.concat(u,'"]'));if(M)return M}m=p.nextNode()}return null}(this.document,l);p&&(this.scrollToElement(p),this.attemptFocus(p))}}},{key:"setHistoryScrollRestoration",value:function(l){if(this.supportScrollRestoration()){var p=this.window.history;p&&p.scrollRestoration&&(p.scrollRestoration=l)}}},{key:"scrollToElement",value:function(l){var p=l.getBoundingClientRect(),m=p.left+this.window.pageXOffset,S=p.top+this.window.pageYOffset,M=this.offset();this.window.scrollTo(m-M[0],S-M[1])}},{key:"attemptFocus",value:function(l){return l.focus(),this.document.activeElement===l}},{key:"supportScrollRestoration",value:function(){try{if(!this.supportsScrolling())return!1;var l=$w(this.window.history)||$w(Object.getPrototypeOf(this.window.history));return!(!l||!l.writable&&!l.set)}catch(p){return!1}}},{key:"supportsScrolling",value:function(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(l){return!1}}}]),o}();function $w(o){return Object.getOwnPropertyDescriptor(o,"scrollRestoration")}var jm,O9=function o(){_(this,o)},ZA=function(o){b(l,o);var u=D(l);function l(){var p;return _(this,l),(p=u.apply(this,arguments)).supportsDOMEvents=!0,p}return l}(Mb),$A=function(o){b(l,o);var u=D(l);function l(){return _(this,l),u.apply(this,arguments)}return w(l,[{key:"onAndCancel",value:function(m,S,M){return m.addEventListener(S,M,!1),function(){m.removeEventListener(S,M,!1)}}},{key:"dispatchEvent",value:function(m,S){m.dispatchEvent(S)}},{key:"remove",value:function(m){m.parentNode&&m.parentNode.removeChild(m)}},{key:"createElement",value:function(m,S){return(S=S||this.getDefaultDocument()).createElement(m)}},{key:"createHtmlDocument",value:function(){return document.implementation.createHTMLDocument("fakeTitle")}},{key:"getDefaultDocument",value:function(){return document}},{key:"isElementNode",value:function(m){return m.nodeType===Node.ELEMENT_NODE}},{key:"isShadowRoot",value:function(m){return m instanceof DocumentFragment}},{key:"getGlobalEventTarget",value:function(m,S){return"window"===S?window:"document"===S?m:"body"===S?m.body:null}},{key:"getBaseHref",value:function(m){var S=(zh=zh||document.querySelector("base"))?zh.getAttribute("href"):null;return null==S?null:function(o){(jm=jm||document.createElement("a")).setAttribute("href",o);var u=jm.pathname;return"/"===u.charAt(0)?u:"/".concat(u)}(S)}},{key:"resetBaseElement",value:function(){zh=null}},{key:"getUserAgent",value:function(){return window.navigator.userAgent}},{key:"getCookie",value:function(m){return Yw(document.cookie,m)}}],[{key:"makeCurrent",value:function(){!function(o){Lm||(Lm=o)}(new l)}}]),l}(ZA),zh=null,e_=new xn("TRANSITION_ID"),nM=[{provide:Om,useFactory:function(o,u,l){return function(){l.get(mf).donePromise.then(function(){for(var p=xu(),m=u.querySelectorAll('style[ng-transition="'.concat(o,'"]')),S=0;S<m.length;S++)p.remove(m[S])})}},deps:[e_,wa,lo],multi:!0}],iM=function(){function o(){_(this,o)}return w(o,[{key:"addToWindow",value:function(l){jn.getAngularTestability=function(m){var S=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],M=l.findTestabilityInTree(m,S);if(null==M)throw new Error("Could not find testability for element.");return M},jn.getAllAngularTestabilities=function(){return l.getAllTestabilities()},jn.getAllAngularRootElements=function(){return l.getAllRootElements()},jn.frameworkStabilizers||(jn.frameworkStabilizers=[]),jn.frameworkStabilizers.push(function(S){var M=jn.getAllAngularTestabilities(),P=M.length,N=!1,G=function(ye){N=N||ye,0==--P&&S(N)};M.forEach(function(ie){ie.whenStable(G)})})}},{key:"findTestabilityInTree",value:function(l,p,m){if(null==p)return null;var S=l.getTestability(p);return null!=S?S:m?xu().isShadowRoot(p)?this.findTestabilityInTree(l,p.host,!0):this.findTestabilityInTree(l,p.parentElement,!0):null}}],[{key:"init",value:function(){!function(o){s9=o}(new o)}}]),o}(),oM=function(){var o=function(){function u(){_(this,u)}return w(u,[{key:"build",value:function(){return new XMLHttpRequest}}]),u}();return o.\u0275fac=function(l){return new(l||o)},o.\u0275prov=ln({token:o,factory:o.\u0275fac}),o}(),Xm=new xn("EventManagerPlugins"),Ym=function(){var o=function(){function u(l,p){var m=this;_(this,u),this._zone=p,this._eventNameToPlugin=new Map,l.forEach(function(S){return S.manager=m}),this._plugins=l.slice().reverse()}return w(u,[{key:"addEventListener",value:function(p,m,S){return this._findPluginFor(m).addEventListener(p,m,S)}},{key:"addGlobalEventListener",value:function(p,m,S){return this._findPluginFor(m).addGlobalEventListener(p,m,S)}},{key:"getZone",value:function(){return this._zone}},{key:"_findPluginFor",value:function(p){var m=this._eventNameToPlugin.get(p);if(m)return m;for(var S=this._plugins,M=0;M<S.length;M++){var P=S[M];if(P.supports(p))return this._eventNameToPlugin.set(p,P),P}throw new Error("No event manager plugin found for event ".concat(p))}}]),u}();return o.\u0275fac=function(l){return new(l||o)(Rr(Xm),Rr(eo))},o.\u0275prov=ln({token:o,factory:o.\u0275fac}),o}(),t_=function(){function o(u){_(this,o),this._doc=u}return w(o,[{key:"addGlobalEventListener",value:function(l,p,m){var S=xu().getGlobalEventTarget(this._doc,l);if(!S)throw new Error("Unsupported event target ".concat(S," for event ").concat(p));return this.addEventListener(S,p,m)}}]),o}(),r_=function(){var o=function(){function u(){_(this,u),this._stylesSet=new Set}return w(u,[{key:"addStyles",value:function(p){var m=this,S=new Set;p.forEach(function(M){m._stylesSet.has(M)||(m._stylesSet.add(M),S.add(M))}),this.onStylesAdded(S)}},{key:"onStylesAdded",value:function(p){}},{key:"getAllStyles",value:function(){return Array.from(this._stylesSet)}}]),u}();return o.\u0275fac=function(l){return new(l||o)},o.\u0275prov=ln({token:o,factory:o.\u0275fac}),o}(),jh=function(){var o=function(u){b(p,u);var l=D(p);function p(m){var S;return _(this,p),(S=l.call(this))._doc=m,S._hostNodes=new Map,S._hostNodes.set(m.head,[]),S}return w(p,[{key:"_addStylesToHost",value:function(S,M,P){var N=this;S.forEach(function(G){var ie=N._doc.createElement("style");ie.textContent=G,P.push(M.appendChild(ie))})}},{key:"addHost",value:function(S){var M=[];this._addStylesToHost(this._stylesSet,S,M),this._hostNodes.set(S,M)}},{key:"removeHost",value:function(S){var M=this._hostNodes.get(S);M&&M.forEach(n_),this._hostNodes.delete(S)}},{key:"onStylesAdded",value:function(S){var M=this;this._hostNodes.forEach(function(P,N){M._addStylesToHost(S,N,P)})}},{key:"ngOnDestroy",value:function(){this._hostNodes.forEach(function(S){return S.forEach(n_)})}}]),p}(r_);return o.\u0275fac=function(l){return new(l||o)(Rr(wa))},o.\u0275prov=ln({token:o,factory:o.\u0275fac}),o}();function n_(o){xu().remove(o)}var P9={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},F9=/%COMP%/g,aM="_nghost-".concat("%COMP%"),sM="_ngcontent-".concat("%COMP%");function qm(o,u,l){for(var p=0;p<u.length;p++){var m=u[p];Array.isArray(m)?qm(o,m,l):(m=m.replace(F9,o),l.push(m))}return l}function a_(o){return function(u){if("__ngUnwrap__"===u)return o;!1===o(u)&&(u.preventDefault(),u.returnValue=!1)}}var L9=function(){var o=function(){function u(l,p,m){_(this,u),this.eventManager=l,this.sharedStylesHost=p,this.appId=m,this.rendererByCompId=new Map,this.defaultRenderer=new N9(l)}return w(u,[{key:"createRenderer",value:function(p,m){if(!p||!m)return this.defaultRenderer;switch(m.encapsulation){case Aa.Emulated:var S=this.rendererByCompId.get(m.id);return S||(S=new fM(this.eventManager,this.sharedStylesHost,m,this.appId),this.rendererByCompId.set(m.id,S)),S.applyToHost(p),S;case 1:case Aa.ShadowDom:return new dM(this.eventManager,this.sharedStylesHost,p,m);default:if(!this.rendererByCompId.has(m.id)){var M=qm(m.id,m.styles,[]);this.sharedStylesHost.addStyles(M),this.rendererByCompId.set(m.id,this.defaultRenderer)}return this.defaultRenderer}}},{key:"begin",value:function(){}},{key:"end",value:function(){}}]),u}();return o.\u0275fac=function(l){return new(l||o)(Rr(Ym),Rr(jh),Rr(Gh))},o.\u0275prov=ln({token:o,factory:o.\u0275fac}),o}(),N9=function(){function o(u){_(this,o),this.eventManager=u,this.data=Object.create(null),this.destroyNode=null}return w(o,[{key:"destroy",value:function(){}},{key:"createElement",value:function(l,p){return p?document.createElementNS(P9[p]||p,l):document.createElement(l)}},{key:"createComment",value:function(l){return document.createComment(l)}},{key:"createText",value:function(l){return document.createTextNode(l)}},{key:"appendChild",value:function(l,p){l.appendChild(p)}},{key:"insertBefore",value:function(l,p,m){l&&l.insertBefore(p,m)}},{key:"removeChild",value:function(l,p){l&&l.removeChild(p)}},{key:"selectRootElement",value:function(l,p){var m="string"==typeof l?document.querySelector(l):l;if(!m)throw new Error('The selector "'.concat(l,'" did not match any elements'));return p||(m.textContent=""),m}},{key:"parentNode",value:function(l){return l.parentNode}},{key:"nextSibling",value:function(l){return l.nextSibling}},{key:"setAttribute",value:function(l,p,m,S){if(S){p=S+":"+p;var M=P9[S];M?l.setAttributeNS(M,p,m):l.setAttribute(p,m)}else l.setAttribute(p,m)}},{key:"removeAttribute",value:function(l,p,m){if(m){var S=P9[m];S?l.removeAttributeNS(S,p):l.removeAttribute("".concat(m,":").concat(p))}else l.removeAttribute(p)}},{key:"addClass",value:function(l,p){l.classList.add(p)}},{key:"removeClass",value:function(l,p){l.classList.remove(p)}},{key:"setStyle",value:function(l,p,m,S){S&(ko.DashCase|ko.Important)?l.style.setProperty(p,m,S&ko.Important?"important":""):l.style[p]=m}},{key:"removeStyle",value:function(l,p,m){m&ko.DashCase?l.style.removeProperty(p):l.style[p]=""}},{key:"setProperty",value:function(l,p,m){l[p]=m}},{key:"setValue",value:function(l,p){l.nodeValue=p}},{key:"listen",value:function(l,p,m){return"string"==typeof l?this.eventManager.addGlobalEventListener(l,p,a_(m)):this.eventManager.addEventListener(l,p,a_(m))}}]),o}(),fM=function(o){b(l,o);var u=D(l);function l(p,m,S,M){var P;_(this,l),(P=u.call(this,p)).component=S;var N=qm(M+"-"+S.id,S.styles,[]);return m.addStyles(N),P.contentAttr=function(o){return sM.replace(F9,o)}(M+"-"+S.id),P.hostAttr=function(o){return aM.replace(F9,o)}(M+"-"+S.id),P}return w(l,[{key:"applyToHost",value:function(m){g(d(l.prototype),"setAttribute",this).call(this,m,this.hostAttr,"")}},{key:"createElement",value:function(m,S){var M=g(d(l.prototype),"createElement",this).call(this,m,S);return g(d(l.prototype),"setAttribute",this).call(this,M,this.contentAttr,""),M}}]),l}(N9),dM=function(o){b(l,o);var u=D(l);function l(p,m,S,M){var P;_(this,l),(P=u.call(this,p)).sharedStylesHost=m,P.hostEl=S,P.shadowRoot=S.attachShadow({mode:"open"}),P.sharedStylesHost.addHost(P.shadowRoot);for(var N=qm(M.id,M.styles,[]),G=0;G<N.length;G++){var ie=document.createElement("style");ie.textContent=N[G],P.shadowRoot.appendChild(ie)}return P}return w(l,[{key:"nodeOrShadowRoot",value:function(m){return m===this.hostEl?this.shadowRoot:m}},{key:"destroy",value:function(){this.sharedStylesHost.removeHost(this.shadowRoot)}},{key:"appendChild",value:function(m,S){return g(d(l.prototype),"appendChild",this).call(this,this.nodeOrShadowRoot(m),S)}},{key:"insertBefore",value:function(m,S,M){return g(d(l.prototype),"insertBefore",this).call(this,this.nodeOrShadowRoot(m),S,M)}},{key:"removeChild",value:function(m,S){return g(d(l.prototype),"removeChild",this).call(this,this.nodeOrShadowRoot(m),S)}},{key:"parentNode",value:function(m){return this.nodeOrShadowRoot(g(d(l.prototype),"parentNode",this).call(this,this.nodeOrShadowRoot(m)))}}]),l}(N9),hM=function(){var o=function(u){b(p,u);var l=D(p);function p(m){return _(this,p),l.call(this,m)}return w(p,[{key:"supports",value:function(S){return!0}},{key:"addEventListener",value:function(S,M,P){var N=this;return S.addEventListener(M,P,!1),function(){return N.removeEventListener(S,M,P)}}},{key:"removeEventListener",value:function(S,M,P){return S.removeEventListener(M,P)}}]),p}(t_);return o.\u0275fac=function(l){return new(l||o)(Rr(wa))},o.\u0275prov=ln({token:o,factory:o.\u0275fac}),o}(),l_=["alt","control","meta","shift"],vM={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},u_={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},gM={alt:function(u){return u.altKey},control:function(u){return u.ctrlKey},meta:function(u){return u.metaKey},shift:function(u){return u.shiftKey}},mM=function(){var o=function(u){b(p,u);var l=D(p);function p(m){return _(this,p),l.call(this,m)}return w(p,[{key:"supports",value:function(S){return null!=p.parseEventName(S)}},{key:"addEventListener",value:function(S,M,P){var N=p.parseEventName(M),G=p.eventCallback(N.fullKey,P,this.manager.getZone());return this.manager.getZone().runOutsideAngular(function(){return xu().onAndCancel(S,N.domEventName,G)})}}],[{key:"parseEventName",value:function(S){var M=S.toLowerCase().split("."),P=M.shift();if(0===M.length||"keydown"!==P&&"keyup"!==P)return null;var N=p._normalizeKey(M.pop()),G="";if(l_.forEach(function(ye){var Ce=M.indexOf(ye);Ce>-1&&(M.splice(Ce,1),G+=ye+".")}),G+=N,0!=M.length||0===N.length)return null;var ie={};return ie.domEventName=P,ie.fullKey=G,ie}},{key:"getEventFullKey",value:function(S){var M="",P=function(o){var u=o.key;if(null==u){if(null==(u=o.keyIdentifier))return"Unidentified";u.startsWith("U+")&&(u=String.fromCharCode(parseInt(u.substring(2),16)),3===o.location&&u_.hasOwnProperty(u)&&(u=u_[u]))}return vM[u]||u}(S);return" "===(P=P.toLowerCase())?P="space":"."===P&&(P="dot"),l_.forEach(function(N){N!=P&&(0,gM[N])(S)&&(M+=N+".")}),M+=P}},{key:"eventCallback",value:function(S,M,P){return function(N){p.getEventFullKey(N)===S&&P.runGuarded(function(){return M(N)})}}},{key:"_normalizeKey",value:function(S){return"esc"===S?"escape":S}}]),p}(t_);return o.\u0275fac=function(l){return new(l||o)(Rr(wa))},o.\u0275prov=ln({token:o,factory:o.\u0275fac}),o}(),SM=[{provide:Pm,useValue:"browser"},{provide:uw,useValue:function(){$A.makeCurrent(),iM.init()},multi:!0},{provide:wa,useFactory:function(){return function(o){Wf=o}(document),document},deps:[]}],xM=yw(gb,"browser",SM),bM=[{provide:Zc,useValue:"root"},{provide:eu,useFactory:function(){return new eu},deps:[]},{provide:Xm,useClass:hM,multi:!0,deps:[wa,eo,Pm]},{provide:Xm,useClass:mM,multi:!0,deps:[wa]},{provide:L9,useClass:L9,deps:[Ym,jh,Gh]},{provide:MC,useExisting:L9},{provide:r_,useExisting:jh},{provide:jh,useClass:jh,deps:[wa]},{provide:a9,useClass:a9,deps:[eo]},{provide:Ym,useClass:Ym,deps:[Xm,eo]},{provide:O9,useClass:oM,deps:[]}],AM=function(){var o=function(){function u(l){if(_(this,u),l)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}return w(u,null,[{key:"withServerTransition",value:function(p){return{ngModule:u,providers:[{provide:Gh,useValue:p.appId},{provide:e_,useExisting:Gh},nM]}}}]),u}();return o.\u0275fac=function(l){return new(l||o)(Rr(o,12))},o.\u0275mod=ji({type:o}),o.\u0275inj=zo({providers:bM,imports:[jA,xb]}),o}();function an(){for(var o=arguments.length,u=new Array(o),l=0;l<o;l++)u[l]=arguments[l];var p=Ge(u);return Ve(u,p)}function wf(o,u){return oe(u)?Xt(o,u,1):Xt(o,1)}function O0(o,u){return Gt(function(l,p){var m=0;l.subscribe(new Lt(p,function(S){return o.call(u,S,m++)&&p.next(S)}))})}"undefined"!=typeof window&&window;var d_=function o(){_(this,o)},h_=function o(){_(this,o)},Xh=function(){function o(u){var l=this;_(this,o),this.normalizedNames=new Map,this.lazyUpdate=null,u?this.lazyInit="string"==typeof u?function(){l.headers=new Map,u.split("\n").forEach(function(p){var m=p.indexOf(":");if(m>0){var S=p.slice(0,m),M=S.toLowerCase(),P=p.slice(m+1).trim();l.maybeSetNormalizedName(S,M),l.headers.has(M)?l.headers.get(M).push(P):l.headers.set(M,[P])}})}:function(){l.headers=new Map,Object.keys(u).forEach(function(p){var m=u[p],S=p.toLowerCase();"string"==typeof m&&(m=[m]),m.length>0&&(l.headers.set(S,m),l.maybeSetNormalizedName(p,S))})}:this.headers=new Map}return w(o,[{key:"has",value:function(l){return this.init(),this.headers.has(l.toLowerCase())}},{key:"get",value:function(l){this.init();var p=this.headers.get(l.toLowerCase());return p&&p.length>0?p[0]:null}},{key:"keys",value:function(){return this.init(),Array.from(this.normalizedNames.values())}},{key:"getAll",value:function(l){return this.init(),this.headers.get(l.toLowerCase())||null}},{key:"append",value:function(l,p){return this.clone({name:l,value:p,op:"a"})}},{key:"set",value:function(l,p){return this.clone({name:l,value:p,op:"s"})}},{key:"delete",value:function(l,p){return this.clone({name:l,value:p,op:"d"})}},{key:"maybeSetNormalizedName",value:function(l,p){this.normalizedNames.has(p)||this.normalizedNames.set(p,l)}},{key:"init",value:function(){var l=this;this.lazyInit&&(this.lazyInit instanceof o?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(function(p){return l.applyUpdate(p)}),this.lazyUpdate=null))}},{key:"copyFrom",value:function(l){var p=this;l.init(),Array.from(l.headers.keys()).forEach(function(m){p.headers.set(m,l.headers.get(m)),p.normalizedNames.set(m,l.normalizedNames.get(m))})}},{key:"clone",value:function(l){var p=new o;return p.lazyInit=this.lazyInit&&this.lazyInit instanceof o?this.lazyInit:this,p.lazyUpdate=(this.lazyUpdate||[]).concat([l]),p}},{key:"applyUpdate",value:function(l){var p=l.name.toLowerCase();switch(l.op){case"a":case"s":var m=l.value;if("string"==typeof m&&(m=[m]),0===m.length)return;this.maybeSetNormalizedName(l.name,p);var S=("a"===l.op?this.headers.get(p):void 0)||[];S.push.apply(S,U(m)),this.headers.set(p,S);break;case"d":var M=l.value;if(M){var P=this.headers.get(p);if(!P)return;0===(P=P.filter(function(N){return-1===M.indexOf(N)})).length?(this.headers.delete(p),this.normalizedNames.delete(p)):this.headers.set(p,P)}else this.headers.delete(p),this.normalizedNames.delete(p)}}},{key:"forEach",value:function(l){var p=this;this.init(),Array.from(this.normalizedNames.keys()).forEach(function(m){return l(p.normalizedNames.get(m),p.headers.get(m))})}}]),o}(),LM=function(){function o(){_(this,o)}return w(o,[{key:"encodeKey",value:function(l){return p_(l)}},{key:"encodeValue",value:function(l){return p_(l)}},{key:"decodeKey",value:function(l){return decodeURIComponent(l)}},{key:"decodeValue",value:function(l){return decodeURIComponent(l)}}]),o}();function NM(o,u){var l=new Map;return o.length>0&&o.replace(/^\?/,"").split("&").forEach(function(m){var S=m.indexOf("="),P=X(-1==S?[u.decodeKey(m),""]:[u.decodeKey(m.slice(0,S)),u.decodeValue(m.slice(S+1))],2),N=P[0],G=P[1],ie=l.get(N)||[];ie.push(G),l.set(N,ie)}),l}var IM=/%(\d[a-f0-9])/gi,kM={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function p_(o){return encodeURIComponent(o).replace(IM,function(u,l){var p;return null!==(p=kM[l])&&void 0!==p?p:u})}function v_(o){return"".concat(o)}var _f=function(){function o(){var u=this,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(_(this,o),this.updates=null,this.cloneFrom=null,this.encoder=l.encoder||new LM,l.fromString){if(l.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=NM(l.fromString,this.encoder)}else l.fromObject?(this.map=new Map,Object.keys(l.fromObject).forEach(function(p){var m=l.fromObject[p];u.map.set(p,Array.isArray(m)?m:[m])})):this.map=null}return w(o,[{key:"has",value:function(l){return this.init(),this.map.has(l)}},{key:"get",value:function(l){this.init();var p=this.map.get(l);return p?p[0]:null}},{key:"getAll",value:function(l){return this.init(),this.map.get(l)||null}},{key:"keys",value:function(){return this.init(),Array.from(this.map.keys())}},{key:"append",value:function(l,p){return this.clone({param:l,value:p,op:"a"})}},{key:"appendAll",value:function(l){var p=[];return Object.keys(l).forEach(function(m){var S=l[m];Array.isArray(S)?S.forEach(function(M){p.push({param:m,value:M,op:"a"})}):p.push({param:m,value:S,op:"a"})}),this.clone(p)}},{key:"set",value:function(l,p){return this.clone({param:l,value:p,op:"s"})}},{key:"delete",value:function(l,p){return this.clone({param:l,value:p,op:"d"})}},{key:"toString",value:function(){var l=this;return this.init(),this.keys().map(function(p){var m=l.encoder.encodeKey(p);return l.map.get(p).map(function(S){return m+"="+l.encoder.encodeValue(S)}).join("&")}).filter(function(p){return""!==p}).join("&")}},{key:"clone",value:function(l){var p=new o({encoder:this.encoder});return p.cloneFrom=this.cloneFrom||this,p.updates=(this.updates||[]).concat(l),p}},{key:"init",value:function(){var l=this;null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(function(p){return l.map.set(p,l.cloneFrom.map.get(p))}),this.updates.forEach(function(p){switch(p.op){case"a":case"s":var m=("a"===p.op?l.map.get(p.param):void 0)||[];m.push(v_(p.value)),l.map.set(p.param,m);break;case"d":if(void 0===p.value){l.map.delete(p.param);break}var S=l.map.get(p.param)||[],M=S.indexOf(v_(p.value));-1!==M&&S.splice(M,1),S.length>0?l.map.set(p.param,S):l.map.delete(p.param)}}),this.cloneFrom=this.updates=null)}}]),o}(),BM=function(){function o(){_(this,o),this.map=new Map}return w(o,[{key:"set",value:function(l,p){return this.map.set(l,p),this}},{key:"get",value:function(l){return this.map.has(l)||this.map.set(l,l.defaultValue()),this.map.get(l)}},{key:"delete",value:function(l){return this.map.delete(l),this}},{key:"has",value:function(l){return this.map.has(l)}},{key:"keys",value:function(){return this.map.keys()}}]),o}();function g_(o){return"undefined"!=typeof ArrayBuffer&&o instanceof ArrayBuffer}function m_(o){return"undefined"!=typeof Blob&&o instanceof Blob}function y_(o){return"undefined"!=typeof FormData&&o instanceof FormData}var k9=function(){function o(u,l,p,m){var S;if(_(this,o),this.url=l,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=u.toUpperCase(),function(o){switch(o){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||m?(this.body=void 0!==p?p:null,S=m):S=p,S&&(this.reportProgress=!!S.reportProgress,this.withCredentials=!!S.withCredentials,S.responseType&&(this.responseType=S.responseType),S.headers&&(this.headers=S.headers),S.context&&(this.context=S.context),S.params&&(this.params=S.params)),this.headers||(this.headers=new Xh),this.context||(this.context=new BM),this.params){var M=this.params.toString();if(0===M.length)this.urlWithParams=l;else{var P=l.indexOf("?");this.urlWithParams=l+(-1===P?"?":P<l.length-1?"&":"")+M}}else this.params=new _f,this.urlWithParams=l}return w(o,[{key:"serializeBody",value:function(){return null===this.body?null:g_(this.body)||m_(this.body)||y_(this.body)||function(o){return"undefined"!=typeof URLSearchParams&&o instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof _f?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}},{key:"detectContentTypeHeader",value:function(){return null===this.body||y_(this.body)?null:m_(this.body)?this.body.type||null:g_(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof _f?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}},{key:"clone",value:function(){var p,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},m=l.method||this.method,S=l.url||this.url,M=l.responseType||this.responseType,P=void 0!==l.body?l.body:this.body,N=void 0!==l.withCredentials?l.withCredentials:this.withCredentials,G=void 0!==l.reportProgress?l.reportProgress:this.reportProgress,ie=l.headers||this.headers,ye=l.params||this.params,Ce=null!==(p=l.context)&&void 0!==p?p:this.context;return void 0!==l.setHeaders&&(ie=Object.keys(l.setHeaders).reduce(function(Le,qe){return Le.set(qe,l.setHeaders[qe])},ie)),l.setParams&&(ye=Object.keys(l.setParams).reduce(function(Le,qe){return Le.set(qe,l.setParams[qe])},ye)),new o(m,S,P,{params:ye,headers:ie,context:Ce,reportProgress:G,responseType:M,withCredentials:N})}}]),o}(),Ui=function(){return(Ui=Ui||{})[Ui.Sent=0]="Sent",Ui[Ui.UploadProgress=1]="UploadProgress",Ui[Ui.ResponseHeader=2]="ResponseHeader",Ui[Ui.DownloadProgress=3]="DownloadProgress",Ui[Ui.Response=4]="Response",Ui[Ui.User=5]="User",Ui}(),B9=function o(u){var l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,p=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"OK";_(this,o),this.headers=u.headers||new Xh,this.status=void 0!==u.status?u.status:l,this.statusText=u.statusText||p,this.url=u.url||null,this.ok=this.status>=200&&this.status<300},UM=function(o){b(l,o);var u=D(l);function l(){var p,m=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _(this,l),(p=u.call(this,m)).type=Ui.ResponseHeader,p}return w(l,[{key:"clone",value:function(){var m=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new l({headers:m.headers||this.headers,status:void 0!==m.status?m.status:this.status,statusText:m.statusText||this.statusText,url:m.url||this.url||void 0})}}]),l}(B9),C_=function(o){b(l,o);var u=D(l);function l(){var p,m=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _(this,l),(p=u.call(this,m)).type=Ui.Response,p.body=void 0!==m.body?m.body:null,p}return w(l,[{key:"clone",value:function(){var m=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new l({body:void 0!==m.body?m.body:this.body,headers:m.headers||this.headers,status:void 0!==m.status?m.status:this.status,statusText:m.statusText||this.statusText,url:m.url||this.url||void 0})}}]),l}(B9),w_=function(o){b(l,o);var u=D(l);function l(p){var m;return _(this,l),(m=u.call(this,p,0,"Unknown Error")).name="HttpErrorResponse",m.ok=!1,m.message=m.status>=200&&m.status<300?"Http failure during parsing for ".concat(p.url||"(unknown url)"):"Http failure response for ".concat(p.url||"(unknown url)",": ").concat(p.status," ").concat(p.statusText),m.error=p.error||null,m}return l}(B9);function G9(o,u){return{body:u,headers:o.headers,context:o.context,observe:o.observe,params:o.params,reportProgress:o.reportProgress,responseType:o.responseType,withCredentials:o.withCredentials}}var zs=function(){var o=function(){function u(l){_(this,u),this.handler=l}return w(u,[{key:"request",value:function(p,m){var P,S=this,M=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(p instanceof k9)P=p;else{var N=void 0;N=M.headers instanceof Xh?M.headers:new Xh(M.headers);var G=void 0;M.params&&(G=M.params instanceof _f?M.params:new _f({fromObject:M.params})),P=new k9(p,m,void 0!==M.body?M.body:null,{headers:N,context:M.context,params:G,reportProgress:M.reportProgress,responseType:M.responseType||"json",withCredentials:M.withCredentials})}var ie=an(P).pipe(wf(function(Ce){return S.handler.handle(Ce)}));if(p instanceof k9||"events"===M.observe)return ie;var ye=ie.pipe(O0(function(Ce){return Ce instanceof C_}));switch(M.observe||"body"){case"body":switch(P.responseType){case"arraybuffer":return ye.pipe(yt(function(Ce){if(null!==Ce.body&&!(Ce.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return Ce.body}));case"blob":return ye.pipe(yt(function(Ce){if(null!==Ce.body&&!(Ce.body instanceof Blob))throw new Error("Response is not a Blob.");return Ce.body}));case"text":return ye.pipe(yt(function(Ce){if(null!==Ce.body&&"string"!=typeof Ce.body)throw new Error("Response is not a string.");return Ce.body}));default:return ye.pipe(yt(function(Ce){return Ce.body}))}case"response":return ye;default:throw new Error("Unreachable: unhandled observe type ".concat(M.observe,"}"))}}},{key:"delete",value:function(p){var m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("DELETE",p,m)}},{key:"get",value:function(p){var m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("GET",p,m)}},{key:"head",value:function(p){var m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("HEAD",p,m)}},{key:"jsonp",value:function(p,m){return this.request("JSONP",p,{params:(new _f).append(m,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}},{key:"options",value:function(p){var m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("OPTIONS",p,m)}},{key:"patch",value:function(p,m){var S=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PATCH",p,G9(S,m))}},{key:"post",value:function(p,m){var S=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("POST",p,G9(S,m))}},{key:"put",value:function(p,m){var S=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PUT",p,G9(S,m))}}]),u}();return o.\u0275fac=function(l){return new(l||o)(Rr(d_))},o.\u0275prov=ln({token:o,factory:o.\u0275fac}),o}(),__=function(){function o(u,l){_(this,o),this.next=u,this.interceptor=l}return w(o,[{key:"handle",value:function(l){return this.interceptor.intercept(l,this.next)}}]),o}(),S_=new xn("HTTP_INTERCEPTORS"),HM=function(){var o=function(){function u(){_(this,u)}return w(u,[{key:"intercept",value:function(p,m){return m.handle(p)}}]),u}();return o.\u0275fac=function(l){return new(l||o)},o.\u0275prov=ln({token:o,factory:o.\u0275fac}),o}(),WM=/^\)\]\}',?\n/,x_=function(){var o=function(){function u(l){_(this,u),this.xhrFactory=l}return w(u,[{key:"handle",value:function(p){var m=this;if("JSONP"===p.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new Ke(function(S){var M=m.xhrFactory.build();if(M.open(p.method,p.urlWithParams),p.withCredentials&&(M.withCredentials=!0),p.headers.forEach(function(et,Ze){return M.setRequestHeader(et,Ze.join(","))}),p.headers.has("Accept")||M.setRequestHeader("Accept","application/json, text/plain, */*"),!p.headers.has("Content-Type")){var P=p.detectContentTypeHeader();null!==P&&M.setRequestHeader("Content-Type",P)}if(p.responseType){var N=p.responseType.toLowerCase();M.responseType="json"!==N?N:"text"}var G=p.serializeBody(),ie=null,ye=function(){if(null!==ie)return ie;var Ze=1223===M.status?204:M.status,ht=M.statusText||"OK",At=new Xh(M.getAllResponseHeaders()),Tt=function(o){return"responseURL"in o&&o.responseURL?o.responseURL:/^X-Request-URL:/m.test(o.getAllResponseHeaders())?o.getResponseHeader("X-Request-URL"):null}(M)||p.url;return ie=new UM({headers:At,status:Ze,statusText:ht,url:Tt})},Ce=function(){var Ze=ye(),ht=Ze.headers,At=Ze.status,Tt=Ze.statusText,nr=Ze.url,yr=null;204!==At&&(yr=void 0===M.response?M.responseText:M.response),0===At&&(At=yr?200:0);var Gr=At>=200&&At<300;if("json"===p.responseType&&"string"==typeof yr){var en=yr;yr=yr.replace(WM,"");try{yr=""!==yr?JSON.parse(yr):null}catch(wn){yr=en,Gr&&(Gr=!1,yr={error:wn,text:yr})}}Gr?(S.next(new C_({body:yr,headers:ht,status:At,statusText:Tt,url:nr||void 0})),S.complete()):S.error(new w_({error:yr,headers:ht,status:At,statusText:Tt,url:nr||void 0}))},Le=function(Ze){var ht=ye(),Tt=new w_({error:Ze,status:M.status||0,statusText:M.statusText||"Unknown Error",url:ht.url||void 0});S.error(Tt)},qe=!1,nt=function(Ze){qe||(S.next(ye()),qe=!0);var ht={type:Ui.DownloadProgress,loaded:Ze.loaded};Ze.lengthComputable&&(ht.total=Ze.total),"text"===p.responseType&&!!M.responseText&&(ht.partialText=M.responseText),S.next(ht)},tt=function(Ze){var ht={type:Ui.UploadProgress,loaded:Ze.loaded};Ze.lengthComputable&&(ht.total=Ze.total),S.next(ht)};return M.addEventListener("load",Ce),M.addEventListener("error",Le),M.addEventListener("timeout",Le),M.addEventListener("abort",Le),p.reportProgress&&(M.addEventListener("progress",nt),null!==G&&M.upload&&M.upload.addEventListener("progress",tt)),M.send(G),S.next({type:Ui.Sent}),function(){M.removeEventListener("error",Le),M.removeEventListener("abort",Le),M.removeEventListener("load",Ce),M.removeEventListener("timeout",Le),p.reportProgress&&(M.removeEventListener("progress",nt),null!==G&&M.upload&&M.upload.removeEventListener("progress",tt)),M.readyState!==M.DONE&&M.abort()}})}}]),u}();return o.\u0275fac=function(l){return new(l||o)(Rr(O9))},o.\u0275prov=ln({token:o,factory:o.\u0275fac}),o}(),V9=new xn("XSRF_COOKIE_NAME"),U9=new xn("XSRF_HEADER_NAME"),b_=function o(){_(this,o)},jM=function(){var o=function(){function u(l,p,m){_(this,u),this.doc=l,this.platform=p,this.cookieName=m,this.lastCookieString="",this.lastToken=null,this.parseCount=0}return w(u,[{key:"getToken",value:function(){if("server"===this.platform)return null;var p=this.doc.cookie||"";return p!==this.lastCookieString&&(this.parseCount++,this.lastToken=Yw(p,this.cookieName),this.lastCookieString=p),this.lastToken}}]),u}();return o.\u0275fac=function(l){return new(l||o)(Rr(wa),Rr(Pm),Rr(V9))},o.\u0275prov=ln({token:o,factory:o.\u0275fac}),o}(),H9=function(){var o=function(){function u(l,p){_(this,u),this.tokenService=l,this.headerName=p}return w(u,[{key:"intercept",value:function(p,m){var S=p.url.toLowerCase();if("GET"===p.method||"HEAD"===p.method||S.startsWith("http://")||S.startsWith("https://"))return m.handle(p);var M=this.tokenService.getToken();return null!==M&&!p.headers.has(this.headerName)&&(p=p.clone({headers:p.headers.set(this.headerName,M)})),m.handle(p)}}]),u}();return o.\u0275fac=function(l){return new(l||o)(Rr(b_),Rr(U9))},o.\u0275prov=ln({token:o,factory:o.\u0275fac}),o}(),XM=function(){var o=function(){function u(l,p){_(this,u),this.backend=l,this.injector=p,this.chain=null}return w(u,[{key:"handle",value:function(p){if(null===this.chain){var m=this.injector.get(S_,[]);this.chain=m.reduceRight(function(S,M){return new __(S,M)},this.backend)}return this.chain.handle(p)}}]),u}();return o.\u0275fac=function(l){return new(l||o)(Rr(h_),Rr(lo))},o.\u0275prov=ln({token:o,factory:o.\u0275fac}),o}(),YM=function(){var o=function(){function u(){_(this,u)}return w(u,null,[{key:"disable",value:function(){return{ngModule:u,providers:[{provide:H9,useClass:HM}]}}},{key:"withOptions",value:function(){var p=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{ngModule:u,providers:[p.cookieName?{provide:V9,useValue:p.cookieName}:[],p.headerName?{provide:U9,useValue:p.headerName}:[]]}}}]),u}();return o.\u0275fac=function(l){return new(l||o)},o.\u0275mod=ji({type:o}),o.\u0275inj=zo({providers:[H9,{provide:S_,useExisting:H9,multi:!0},{provide:b_,useClass:jM},{provide:V9,useValue:"XSRF-TOKEN"},{provide:U9,useValue:"X-XSRF-TOKEN"}]}),o}(),qM=function(){var o=function u(){_(this,u)};return o.\u0275fac=function(l){return new(l||o)},o.\u0275mod=ji({type:o}),o.\u0275inj=zo({providers:[zs,{provide:d_,useClass:XM},x_,{provide:h_,useExisting:x_}],imports:[[YM.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),o}(),Cs=function(o){b(l,o);var u=D(l);function l(p){var m;return _(this,l),(m=u.call(this))._value=p,m}return w(l,[{key:"value",get:function(){return this.getValue()}},{key:"_subscribe",value:function(m){var S=g(d(l.prototype),"_subscribe",this).call(this,m);return!S.closed&&m.next(this._value),S}},{key:"getValue",value:function(){var M=this._value;if(this.hasError)throw this.thrownError;return this._throwIfClosed(),M}},{key:"next",value:function(m){g(d(l.prototype),"next",this).call(this,this._value=m)}}]),l}(He),KM=Array.isArray,QM=Object.getPrototypeOf,JM=Object.prototype,ZM=Object.keys;function $M(o){if(1===o.length){var u=o[0];if(KM(u))return{args:u,keys:null};if(function(o){return o&&"object"==typeof o&&QM(o)===JM}(u)){var l=ZM(u);return{args:l.map(function(p){return u[p]}),keys:l}}}return{args:o,keys:null}}var tT=Array.isArray;function nT(o){return yt(function(u){return function(o,u){return tT(u)?o.apply(void 0,U(u)):o(u)}(o,u)})}function iT(o,u){return o.reduce(function(l,p,m){return l[p]=u[m],l},{})}function aT(o,u){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ut;return function(p){A_(u,function(){for(var m=o.length,S=new Array(m),M=m,P=m,N=function(ye){A_(u,function(){var Ce=Ve(o[ye],u),Le=!1;Ce.subscribe(new Lt(p,function(qe){S[ye]=qe,Le||(Le=!0,P--),P||p.next(l(S.slice()))},function(){--M||p.complete()}))},p)},G=0;G<m;G++)N(G)},p)}}function A_(o,u,l){o?Et(l,o,u):u()}var Km=me(function(o){return function(){o(this),this.name="EmptyError",this.message="no elements in sequence"}});function sT(){return Zt(1)}function W9(){for(var o=arguments.length,u=new Array(o),l=0;l<o;l++)u[l]=arguments[l];return sT()(Ve(u,Ge(u)))}function M_(o){return new Ke(function(u){kr(o()).subscribe(u)})}function T_(){return Gt(function(o,u){var l=null;o._refCount++;var p=new Lt(u,void 0,void 0,void 0,function(){if(!o||o._refCount<=0||0<--o._refCount)l=null;else{var m=o._connection,S=l;l=null,m&&(!S||m===S)&&m.unsubscribe(),u.unsubscribe()}});o.subscribe(p),p.closed||(l=o.connect())})}var lT=function(o){b(l,o);var u=D(l);function l(p,m){var S;return _(this,l),(S=u.call(this)).source=p,S.subjectFactory=m,S._subject=null,S._refCount=0,S._connection=null,vt(p)&&(S.lift=p.lift),S}return w(l,[{key:"_subscribe",value:function(m){return this.getSubject().subscribe(m)}},{key:"getSubject",value:function(){var m=this._subject;return(!m||m.isStopped)&&(this._subject=this.subjectFactory()),this._subject}},{key:"_teardown",value:function(){this._refCount=0;var m=this._connection;this._subject=this._connection=null,null==m||m.unsubscribe()}},{key:"connect",value:function(){var m=this,S=this._connection;if(!S){S=this._connection=new $;var M=this.getSubject();S.add(this.source.subscribe(new Lt(M,void 0,function(){m._teardown(),M.complete()},function(P){m._teardown(),M.error(P)},function(){return m._teardown()}))),S.closed&&(this._connection=null,S=$.EMPTY)}return S}},{key:"refCount",value:function(){return T_()(this)}}]),l}(Ke);function P0(o,u){return Gt(function(l,p){var m=null,S=0,M=!1,P=function(){return M&&!m&&p.complete()};l.subscribe(new Lt(p,function(N){null==m||m.unsubscribe();var G=0,ie=S++;kr(o(N,ie)).subscribe(m=new Lt(p,function(ye){return p.next(u?u(N,ye,ie,G++):ye)},function(){m=null,P()}))},function(){M=!0,P()}))})}function cT(o,u,l,p,m){return function(S,M){var P=l,N=u,G=0;S.subscribe(new Lt(M,function(ie){var ye=G++;N=P?o(N,ie,ye):(P=!0,ie),p&&M.next(N)},m&&function(){P&&M.next(N),M.complete()}))}}function E_(o,u){return Gt(cT(o,u,arguments.length>=2,!0))}function Au(o){return Gt(function(u,l){var S,p=null,m=!1;p=u.subscribe(new Lt(l,void 0,void 0,function(M){S=kr(o(M,Au(o)(u))),p?(p.unsubscribe(),p=null,S.subscribe(l)):m=!0})),m&&(p.unsubscribe(),p=null,S.subscribe(l))})}function z9(o){return o<=0?function(){return jt}:Gt(function(u,l){var p=[];u.subscribe(new Lt(l,function(m){p.push(m),o<p.length&&p.shift()},function(){var S,m=I(p);try{for(m.s();!(S=m.n()).done;)l.next(S.value)}catch(P){m.e(P)}finally{m.f()}l.complete()},void 0,function(){p=null}))})}function R_(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fT;return Gt(function(u,l){var p=!1;u.subscribe(new Lt(l,function(m){p=!0,l.next(m)},function(){return p?l.complete():l.error(o())}))})}function fT(){return new Km}function D_(o){return Gt(function(u,l){var p=!1;u.subscribe(new Lt(l,function(m){p=!0,l.next(m)},function(){p||l.next(o),l.complete()}))})}function Sf(o,u){var l=arguments.length>=2;return function(p){return p.pipe(o?O0(function(m,S){return o(m,S,p)}):ut,Ue(1),l?D_(u):R_(function(){return new Km}))}}function _a(o,u,l){var p=oe(o)||u||l?{next:o,error:u,complete:l}:o;return p?Gt(function(m,S){var M;null===(M=p.subscribe)||void 0===M||M.call(p);var P=!0;m.subscribe(new Lt(S,function(N){var G;null===(G=p.next)||void 0===G||G.call(p,N),S.next(N)},function(){var N;P=!1,null===(N=p.complete)||void 0===N||N.call(p),S.complete()},function(N){var G;P=!1,null===(G=p.error)||void 0===G||G.call(p,N),S.error(N)},function(){var N,G;P&&(null===(N=p.unsubscribe)||void 0===N||N.call(p)),null===(G=p.finalize)||void 0===G||G.call(p)}))}):ut}var xl=function o(u,l){_(this,o),this.id=u,this.url=l},j9=function(o){b(l,o);var u=D(l);function l(p,m){var S,M=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"imperative",P=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return _(this,l),(S=u.call(this,p,m)).navigationTrigger=M,S.restoredState=P,S}return w(l,[{key:"toString",value:function(){return"NavigationStart(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),l}(xl),Yh=function(o){b(l,o);var u=D(l);function l(p,m,S){var M;return _(this,l),(M=u.call(this,p,m)).urlAfterRedirects=S,M}return w(l,[{key:"toString",value:function(){return"NavigationEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"')")}}]),l}(xl),O_=function(o){b(l,o);var u=D(l);function l(p,m,S){var M;return _(this,l),(M=u.call(this,p,m)).reason=S,M}return w(l,[{key:"toString",value:function(){return"NavigationCancel(id: ".concat(this.id,", url: '").concat(this.url,"')")}}]),l}(xl),pT=function(o){b(l,o);var u=D(l);function l(p,m,S){var M;return _(this,l),(M=u.call(this,p,m)).error=S,M}return w(l,[{key:"toString",value:function(){return"NavigationError(id: ".concat(this.id,", url: '").concat(this.url,"', error: ").concat(this.error,")")}}]),l}(xl),vT=function(o){b(l,o);var u=D(l);function l(p,m,S,M){var P;return _(this,l),(P=u.call(this,p,m)).urlAfterRedirects=S,P.state=M,P}return w(l,[{key:"toString",value:function(){return"RoutesRecognized(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),l}(xl),gT=function(o){b(l,o);var u=D(l);function l(p,m,S,M){var P;return _(this,l),(P=u.call(this,p,m)).urlAfterRedirects=S,P.state=M,P}return w(l,[{key:"toString",value:function(){return"GuardsCheckStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),l}(xl),mT=function(o){b(l,o);var u=D(l);function l(p,m,S,M,P){var N;return _(this,l),(N=u.call(this,p,m)).urlAfterRedirects=S,N.state=M,N.shouldActivate=P,N}return w(l,[{key:"toString",value:function(){return"GuardsCheckEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,", shouldActivate: ").concat(this.shouldActivate,")")}}]),l}(xl),yT=function(o){b(l,o);var u=D(l);function l(p,m,S,M){var P;return _(this,l),(P=u.call(this,p,m)).urlAfterRedirects=S,P.state=M,P}return w(l,[{key:"toString",value:function(){return"ResolveStart(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),l}(xl),CT=function(o){b(l,o);var u=D(l);function l(p,m,S,M){var P;return _(this,l),(P=u.call(this,p,m)).urlAfterRedirects=S,P.state=M,P}return w(l,[{key:"toString",value:function(){return"ResolveEnd(id: ".concat(this.id,", url: '").concat(this.url,"', urlAfterRedirects: '").concat(this.urlAfterRedirects,"', state: ").concat(this.state,")")}}]),l}(xl),P_=function(){function o(u){_(this,o),this.route=u}return w(o,[{key:"toString",value:function(){return"RouteConfigLoadStart(path: ".concat(this.route.path,")")}}]),o}(),F_=function(){function o(u){_(this,o),this.route=u}return w(o,[{key:"toString",value:function(){return"RouteConfigLoadEnd(path: ".concat(this.route.path,")")}}]),o}(),wT=function(){function o(u){_(this,o),this.snapshot=u}return w(o,[{key:"toString",value:function(){return"ChildActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),o}(),_T=function(){function o(u){_(this,o),this.snapshot=u}return w(o,[{key:"toString",value:function(){return"ChildActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),o}(),ST=function(){function o(u){_(this,o),this.snapshot=u}return w(o,[{key:"toString",value:function(){return"ActivationStart(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),o}(),xT=function(){function o(u){_(this,o),this.snapshot=u}return w(o,[{key:"toString",value:function(){return"ActivationEnd(path: '".concat(this.snapshot.routeConfig&&this.snapshot.routeConfig.path||"","')")}}]),o}(),L_=function(){function o(u,l,p){_(this,o),this.routerEvent=u,this.position=l,this.anchor=p}return w(o,[{key:"toString",value:function(){var l=this.position?"".concat(this.position[0],", ").concat(this.position[1]):null;return"Scroll(anchor: '".concat(this.anchor,"', position: '").concat(l,"')")}}]),o}(),bn="primary",bT=function(){function o(u){_(this,o),this.params=u||{}}return w(o,[{key:"has",value:function(l){return Object.prototype.hasOwnProperty.call(this.params,l)}},{key:"get",value:function(l){if(this.has(l)){var p=this.params[l];return Array.isArray(p)?p[0]:p}return null}},{key:"getAll",value:function(l){if(this.has(l)){var p=this.params[l];return Array.isArray(p)?p:[p]}return[]}},{key:"keys",get:function(){return Object.keys(this.params)}}]),o}();function xf(o){return new bT(o)}var N_="ngNavigationCancelingError";function X9(o){var u=Error("NavigationCancelingError: "+o);return u[N_]=!0,u}function MT(o,u,l){var p=l.path.split("/");if(p.length>o.length||"full"===l.pathMatch&&(u.hasChildren()||p.length<o.length))return null;for(var m={},S=0;S<p.length;S++){var M=p[S],P=o[S];if(M.startsWith(":"))m[M.substring(1)]=P;else if(M!==P.path)return null}return{consumed:o.slice(0,p.length),posParams:m}}function js(o,u){var l=o?Object.keys(o):void 0,p=u?Object.keys(u):void 0;if(!l||!p||l.length!=p.length)return!1;for(var m,S=0;S<l.length;S++)if(!I_(o[m=l[S]],u[m]))return!1;return!0}function I_(o,u){if(Array.isArray(o)&&Array.isArray(u)){if(o.length!==u.length)return!1;var l=U(o).sort(),p=U(u).sort();return l.every(function(m,S){return p[S]===m})}return o===u}function k_(o){return Array.prototype.concat.apply([],o)}function B_(o){return o.length>0?o[o.length-1]:null}function Co(o,u){for(var l in o)o.hasOwnProperty(l)&&u(o[l],l)}function Xs(o){return Qe(o)?o:ke(o)?Ve(Promise.resolve(o)):an(o)}var RT={exact:function U_(o,u,l){if(!L0(o.segments,u.segments)||!Qm(o.segments,u.segments,l)||o.numberOfChildren!==u.numberOfChildren)return!1;for(var p in u.children)if(!o.children[p]||!U_(o.children[p],u.children[p],l))return!1;return!0},subset:H_},G_={exact:function(o,u){return js(o,u)},subset:function(o,u){return Object.keys(u).length<=Object.keys(o).length&&Object.keys(u).every(function(l){return I_(o[l],u[l])})},ignored:function(){return!0}};function V_(o,u,l){return RT[l.paths](o.root,u.root,l.matrixParams)&&G_[l.queryParams](o.queryParams,u.queryParams)&&!("exact"===l.fragment&&o.fragment!==u.fragment)}function H_(o,u,l){return W_(o,u,u.segments,l)}function W_(o,u,l,p){if(o.segments.length>l.length){var m=o.segments.slice(0,l.length);return!(!L0(m,l)||u.hasChildren()||!Qm(m,l,p))}if(o.segments.length===l.length){if(!L0(o.segments,l)||!Qm(o.segments,l,p))return!1;for(var S in u.children)if(!o.children[S]||!H_(o.children[S],u.children[S],p))return!1;return!0}var M=l.slice(0,o.segments.length),P=l.slice(o.segments.length);return!!(L0(o.segments,M)&&Qm(o.segments,M,p)&&o.children[bn])&&W_(o.children[bn],u,P,p)}function Qm(o,u,l){return u.every(function(p,m){return G_[l](o[m].parameters,p.parameters)})}var F0=function(){function o(u,l,p){_(this,o),this.root=u,this.queryParams=l,this.fragment=p}return w(o,[{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=xf(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){return LT.serialize(this)}}]),o}(),Rn=function(){function o(u,l){var p=this;_(this,o),this.segments=u,this.children=l,this.parent=null,Co(l,function(m,S){return m.parent=p})}return w(o,[{key:"hasChildren",value:function(){return this.numberOfChildren>0}},{key:"numberOfChildren",get:function(){return Object.keys(this.children).length}},{key:"toString",value:function(){return Jm(this)}}]),o}(),qh=function(){function o(u,l){_(this,o),this.path=u,this.parameters=l}return w(o,[{key:"parameterMap",get:function(){return this._parameterMap||(this._parameterMap=xf(this.parameters)),this._parameterMap}},{key:"toString",value:function(){return q_(this)}}]),o}();function L0(o,u){return o.length===u.length&&o.every(function(l,p){return l.path===u[p].path})}var z_=function o(){_(this,o)},j_=function(){function o(){_(this,o)}return w(o,[{key:"parse",value:function(l){var p=new WT(l);return new F0(p.parseRootSegment(),p.parseQueryParams(),p.parseFragment())}},{key:"serialize",value:function(l){var p="/".concat(Kh(l.root,!0)),m=function(o){var u=Object.keys(o).map(function(l){var p=o[l];return Array.isArray(p)?p.map(function(m){return"".concat(Zm(l),"=").concat(Zm(m))}).join("&"):"".concat(Zm(l),"=").concat(Zm(p))}).filter(function(l){return!!l});return u.length?"?".concat(u.join("&")):""}(l.queryParams),S="string"==typeof l.fragment?"#".concat(function(o){return encodeURI(o)}(l.fragment)):"";return"".concat(p).concat(m).concat(S)}}]),o}(),LT=new j_;function Jm(o){return o.segments.map(function(u){return q_(u)}).join("/")}function Kh(o,u){if(!o.hasChildren())return Jm(o);if(u){var l=o.children[bn]?Kh(o.children[bn],!1):"",p=[];return Co(o.children,function(S,M){M!==bn&&p.push("".concat(M,":").concat(Kh(S,!1)))}),p.length>0?"".concat(l,"(").concat(p.join("//"),")"):l}var m=function(o,u){var l=[];return Co(o.children,function(p,m){m===bn&&(l=l.concat(u(p,m)))}),Co(o.children,function(p,m){m!==bn&&(l=l.concat(u(p,m)))}),l}(o,function(S,M){return M===bn?[Kh(o.children[bn],!1)]:["".concat(M,":").concat(Kh(S,!1))]});return 1===Object.keys(o.children).length&&null!=o.children[bn]?"".concat(Jm(o),"/").concat(m[0]):"".concat(Jm(o),"/(").concat(m.join("//"),")")}function X_(o){return encodeURIComponent(o).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Zm(o){return X_(o).replace(/%3B/gi,";")}function Y9(o){return X_(o).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function $m(o){return decodeURIComponent(o)}function Y_(o){return $m(o.replace(/\+/g,"%20"))}function q_(o){return"".concat(Y9(o.path)).concat(function(o){return Object.keys(o).map(function(u){return";".concat(Y9(u),"=").concat(Y9(o[u]))}).join("")}(o.parameters))}var BT=/^[^\/()?;=#]+/;function e1(o){var u=o.match(BT);return u?u[0]:""}var GT=/^[^=?&#]+/,UT=/^[^&#]+/,WT=function(){function o(u){_(this,o),this.url=u,this.remaining=u}return w(o,[{key:"parseRootSegment",value:function(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Rn([],{}):new Rn([],this.parseChildren())}},{key:"parseQueryParams",value:function(){var l={};if(this.consumeOptional("?"))do{this.parseQueryParam(l)}while(this.consumeOptional("&"));return l}},{key:"parseFragment",value:function(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}},{key:"parseChildren",value:function(){if(""===this.remaining)return{};this.consumeOptional("/");var l=[];for(this.peekStartsWith("(")||l.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),l.push(this.parseSegment());var p={};this.peekStartsWith("/(")&&(this.capture("/"),p=this.parseParens(!0));var m={};return this.peekStartsWith("(")&&(m=this.parseParens(!1)),(l.length>0||Object.keys(p).length>0)&&(m[bn]=new Rn(l,p)),m}},{key:"parseSegment",value:function(){var l=e1(this.remaining);if(""===l&&this.peekStartsWith(";"))throw new Error("Empty path url segment cannot have parameters: '".concat(this.remaining,"'."));return this.capture(l),new qh($m(l),this.parseMatrixParams())}},{key:"parseMatrixParams",value:function(){for(var l={};this.consumeOptional(";");)this.parseParam(l);return l}},{key:"parseParam",value:function(l){var p=e1(this.remaining);if(p){this.capture(p);var m="";if(this.consumeOptional("=")){var S=e1(this.remaining);S&&this.capture(m=S)}l[$m(p)]=$m(m)}}},{key:"parseQueryParam",value:function(l){var p=function(o){var u=o.match(GT);return u?u[0]:""}(this.remaining);if(p){this.capture(p);var m="";if(this.consumeOptional("=")){var S=function(o){var u=o.match(UT);return u?u[0]:""}(this.remaining);S&&this.capture(m=S)}var M=Y_(p),P=Y_(m);if(l.hasOwnProperty(M)){var N=l[M];Array.isArray(N)||(l[M]=N=[N]),N.push(P)}else l[M]=P}}},{key:"parseParens",value:function(l){var p={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){var m=e1(this.remaining),S=this.remaining[m.length];if("/"!==S&&")"!==S&&";"!==S)throw new Error("Cannot parse url '".concat(this.url,"'"));var M=void 0;m.indexOf(":")>-1?(M=m.substr(0,m.indexOf(":")),this.capture(M),this.capture(":")):l&&(M=bn);var P=this.parseChildren();p[M]=1===Object.keys(P).length?P[bn]:new Rn([],P),this.consumeOptional("//")}return p}},{key:"peekStartsWith",value:function(l){return this.remaining.startsWith(l)}},{key:"consumeOptional",value:function(l){return!!this.peekStartsWith(l)&&(this.remaining=this.remaining.substring(l.length),!0)}},{key:"capture",value:function(l){if(!this.consumeOptional(l))throw new Error('Expected "'.concat(l,'".'))}}]),o}(),K_=function(){function o(u){_(this,o),this._root=u}return w(o,[{key:"root",get:function(){return this._root.value}},{key:"parent",value:function(l){var p=this.pathFromRoot(l);return p.length>1?p[p.length-2]:null}},{key:"children",value:function(l){var p=q9(l,this._root);return p?p.children.map(function(m){return m.value}):[]}},{key:"firstChild",value:function(l){var p=q9(l,this._root);return p&&p.children.length>0?p.children[0].value:null}},{key:"siblings",value:function(l){var p=K9(l,this._root);return p.length<2?[]:p[p.length-2].children.map(function(S){return S.value}).filter(function(S){return S!==l})}},{key:"pathFromRoot",value:function(l){return K9(l,this._root).map(function(p){return p.value})}}]),o}();function q9(o,u){if(o===u.value)return u;var p,l=I(u.children);try{for(l.s();!(p=l.n()).done;){var S=q9(o,p.value);if(S)return S}}catch(M){l.e(M)}finally{l.f()}return null}function K9(o,u){if(o===u.value)return[u];var p,l=I(u.children);try{for(l.s();!(p=l.n()).done;){var S=K9(o,p.value);if(S.length)return S.unshift(u),S}}catch(M){l.e(M)}finally{l.f()}return[]}var bl=function(){function o(u,l){_(this,o),this.value=u,this.children=l}return w(o,[{key:"toString",value:function(){return"TreeNode(".concat(this.value,")")}}]),o}();function bf(o){var u={};return o&&o.children.forEach(function(l){return u[l.value.outlet]=l}),u}var Q_=function(o){b(l,o);var u=D(l);function l(p,m){var S;return _(this,l),(S=u.call(this,p)).snapshot=m,Q9(R(S),p),S}return w(l,[{key:"toString",value:function(){return this.snapshot.toString()}}]),l}(K_);function J_(o,u){var l=function(o,u){var M=new t1([],{},{},"",{},bn,u,null,o.root,-1,{});return new $_("",new bl(M,[]))}(o,u),p=new Cs([new qh("",{})]),m=new Cs({}),S=new Cs({}),M=new Cs({}),P=new Cs(""),N=new Ys(p,m,M,P,S,bn,u,l.root);return N.snapshot=l.root,new Q_(new bl(N,[]),l)}var Ys=function(){function o(u,l,p,m,S,M,P,N){_(this,o),this.url=u,this.params=l,this.queryParams=p,this.fragment=m,this.data=S,this.outlet=M,this.component=P,this._futureSnapshot=N}return w(o,[{key:"routeConfig",get:function(){return this._futureSnapshot.routeConfig}},{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=this.params.pipe(yt(function(l){return xf(l)}))),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(yt(function(l){return xf(l)}))),this._queryParamMap}},{key:"toString",value:function(){return this.snapshot?this.snapshot.toString():"Future(".concat(this._futureSnapshot,")")}}]),o}();function Z_(o){var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"emptyOnly",l=o.pathFromRoot,p=0;if("always"!==u)for(p=l.length-1;p>=1;){var m=l[p],S=l[p-1];if(m.routeConfig&&""===m.routeConfig.path)p--;else{if(S.component)break;p--}}return jT(l.slice(p))}function jT(o){return o.reduce(function(u,l){return{params:Object.assign(Object.assign({},u.params),l.params),data:Object.assign(Object.assign({},u.data),l.data),resolve:Object.assign(Object.assign({},u.resolve),l._resolvedData)}},{params:{},data:{},resolve:{}})}var t1=function(){function o(u,l,p,m,S,M,P,N,G,ie,ye){_(this,o),this.url=u,this.params=l,this.queryParams=p,this.fragment=m,this.data=S,this.outlet=M,this.component=P,this.routeConfig=N,this._urlSegment=G,this._lastPathIndex=ie,this._resolve=ye}return w(o,[{key:"root",get:function(){return this._routerState.root}},{key:"parent",get:function(){return this._routerState.parent(this)}},{key:"firstChild",get:function(){return this._routerState.firstChild(this)}},{key:"children",get:function(){return this._routerState.children(this)}},{key:"pathFromRoot",get:function(){return this._routerState.pathFromRoot(this)}},{key:"paramMap",get:function(){return this._paramMap||(this._paramMap=xf(this.params)),this._paramMap}},{key:"queryParamMap",get:function(){return this._queryParamMap||(this._queryParamMap=xf(this.queryParams)),this._queryParamMap}},{key:"toString",value:function(){var l=this.url.map(function(m){return m.toString()}).join("/"),p=this.routeConfig?this.routeConfig.path:"";return"Route(url:'".concat(l,"', path:'").concat(p,"')")}}]),o}(),$_=function(o){b(l,o);var u=D(l);function l(p,m){var S;return _(this,l),(S=u.call(this,m)).url=p,Q9(R(S),m),S}return w(l,[{key:"toString",value:function(){return e8(this._root)}}]),l}(K_);function Q9(o,u){u.value._routerState=o,u.children.forEach(function(l){return Q9(o,l)})}function e8(o){var u=o.children.length>0?" { ".concat(o.children.map(e8).join(", ")," } "):"";return"".concat(o.value).concat(u)}function J9(o){if(o.snapshot){var u=o.snapshot,l=o._futureSnapshot;o.snapshot=l,js(u.queryParams,l.queryParams)||o.queryParams.next(l.queryParams),u.fragment!==l.fragment&&o.fragment.next(l.fragment),js(u.params,l.params)||o.params.next(l.params),function(o,u){if(o.length!==u.length)return!1;for(var l=0;l<o.length;++l)if(!js(o[l],u[l]))return!1;return!0}(u.url,l.url)||o.url.next(l.url),js(u.data,l.data)||o.data.next(l.data)}else o.snapshot=o._futureSnapshot,o.data.next(o._futureSnapshot.data)}function Z9(o,u){var l=js(o.params,u.params)&&function(o,u){return L0(o,u)&&o.every(function(l,p){return js(l.parameters,u[p].parameters)})}(o.url,u.url);return l&&!(!o.parent!=!u.parent)&&(!o.parent||Z9(o.parent,u.parent))}function Qh(o,u,l){if(l&&o.shouldReuseRoute(u.value,l.value.snapshot)){var p=l.value;p._futureSnapshot=u.value;var m=function(o,u,l){return u.children.map(function(p){var S,m=I(l.children);try{for(m.s();!(S=m.n()).done;){var M=S.value;if(o.shouldReuseRoute(p.value,M.value.snapshot))return Qh(o,p,M)}}catch(P){m.e(P)}finally{m.f()}return Qh(o,p)})}(o,u,l);return new bl(p,m)}if(o.shouldAttach(u.value)){var S=o.retrieve(u.value);if(null!==S){var M=S.route;return M.value._futureSnapshot=u.value,M.children=u.children.map(function(G){return Qh(o,G)}),M}}var P=function(o){return new Ys(new Cs(o.url),new Cs(o.params),new Cs(o.queryParams),new Cs(o.fragment),new Cs(o.data),o.outlet,o.component,o)}(u.value),N=u.children.map(function(G){return Qh(o,G)});return new bl(P,N)}function KT(o,u,l,p,m){if(0===l.length)return $9(u.root,u.root,u,p,m);var S=function(o){if("string"==typeof o[0]&&1===o.length&&"/"===o[0])return new r8(!0,0,o);var u=0,l=!1,p=o.reduce(function(m,S,M){if("object"==typeof S&&null!=S){if(S.outlets){var P={};return Co(S.outlets,function(N,G){P[G]="string"==typeof N?N.split("/"):N}),[].concat(U(m),[{outlets:P}])}if(S.segmentPath)return[].concat(U(m),[S.segmentPath])}return"string"!=typeof S?[].concat(U(m),[S]):0===M?(S.split("/").forEach(function(N,G){0==G&&"."===N||(0==G&&""===N?l=!0:".."===N?u++:""!=N&&m.push(N))}),m):[].concat(U(m),[S])},[]);return new r8(l,u,p)}(l);if(S.toRoot())return $9(u.root,new Rn([],{}),u,p,m);var M=function(o,u,l){if(o.isAbsolute)return new e4(u.root,!0,0);if(-1===l.snapshot._lastPathIndex){var p=l.snapshot._urlSegment;return new e4(p,p===u.root,0)}var S=r1(o.commands[0])?0:1;return function(o,u,l){for(var p=o,m=u,S=l;S>m;){if(S-=m,!(p=p.parent))throw new Error("Invalid number of '../'");m=p.segments.length}return new e4(p,!1,m-S)}(l.snapshot._urlSegment,l.snapshot._lastPathIndex+S,o.numberOfDoubleDots)}(S,u,o),P=M.processChildren?n1(M.segmentGroup,M.index,S.commands):n8(M.segmentGroup,M.index,S.commands);return $9(M.segmentGroup,P,u,p,m)}function r1(o){return"object"==typeof o&&null!=o&&!o.outlets&&!o.segmentPath}function Jh(o){return"object"==typeof o&&null!=o&&o.outlets}function $9(o,u,l,p,m){var S={};return p&&Co(p,function(M,P){S[P]=Array.isArray(M)?M.map(function(N){return"".concat(N)}):"".concat(M)}),new F0(l.root===o?u:t8(l.root,o,u),S,m)}function t8(o,u,l){var p={};return Co(o.children,function(m,S){p[S]=m===u?l:t8(m,u,l)}),new Rn(o.segments,p)}var r8=function(){function o(u,l,p){if(_(this,o),this.isAbsolute=u,this.numberOfDoubleDots=l,this.commands=p,u&&p.length>0&&r1(p[0]))throw new Error("Root segment cannot have matrix parameters");var m=p.find(Jh);if(m&&m!==B_(p))throw new Error("{outlets:{}} has to be the last command")}return w(o,[{key:"toRoot",value:function(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}]),o}(),e4=function o(u,l,p){_(this,o),this.segmentGroup=u,this.processChildren=l,this.index=p};function n8(o,u,l){if(o||(o=new Rn([],{})),0===o.segments.length&&o.hasChildren())return n1(o,u,l);var p=function(o,u,l){for(var p=0,m=u,S={match:!1,pathIndex:0,commandIndex:0};m<o.segments.length;){if(p>=l.length)return S;var M=o.segments[m],P=l[p];if(Jh(P))break;var N="".concat(P),G=p<l.length-1?l[p+1]:null;if(m>0&&void 0===N)break;if(N&&G&&"object"==typeof G&&void 0===G.outlets){if(!o8(N,G,M))return S;p+=2}else{if(!o8(N,{},M))return S;p++}m++}return{match:!0,pathIndex:m,commandIndex:p}}(o,u,l),m=l.slice(p.commandIndex);if(p.match&&p.pathIndex<o.segments.length){var S=new Rn(o.segments.slice(0,p.pathIndex),{});return S.children[bn]=new Rn(o.segments.slice(p.pathIndex),o.children),n1(S,0,m)}return p.match&&0===m.length?new Rn(o.segments,{}):p.match&&!o.hasChildren()?t4(o,u,l):p.match?n1(o,0,m):t4(o,u,l)}function n1(o,u,l){if(0===l.length)return new Rn(o.segments,{});var p=function(o){return Jh(o[0])?o[0].outlets:re({},bn,o)}(l),m={};return Co(p,function(S,M){"string"==typeof S&&(S=[S]),null!==S&&(m[M]=n8(o.children[M],u,S))}),Co(o.children,function(S,M){void 0===p[M]&&(m[M]=S)}),new Rn(o.segments,m)}function t4(o,u,l){for(var p=o.segments.slice(0,u),m=0;m<l.length;){var S=l[m];if(Jh(S)){var M=tE(S.outlets);return new Rn(p,M)}if(0===m&&r1(l[0]))p.push(new qh(o.segments[u].path,i8(l[0]))),m++;else{var N=Jh(S)?S.outlets[bn]:"".concat(S),G=m<l.length-1?l[m+1]:null;N&&G&&r1(G)?(p.push(new qh(N,i8(G))),m+=2):(p.push(new qh(N,{})),m++)}}return new Rn(p,{})}function tE(o){var u={};return Co(o,function(l,p){"string"==typeof l&&(l=[l]),null!==l&&(u[p]=t4(new Rn([],{}),0,l))}),u}function i8(o){var u={};return Co(o,function(l,p){return u[p]="".concat(l)}),u}function o8(o,u,l){return o==l.path&&js(u,l.parameters)}var nE=function(){function o(u,l,p,m){_(this,o),this.routeReuseStrategy=u,this.futureState=l,this.currState=p,this.forwardEvent=m}return w(o,[{key:"activate",value:function(l){var p=this.futureState._root,m=this.currState?this.currState._root:null;this.deactivateChildRoutes(p,m,l),J9(this.futureState.root),this.activateChildRoutes(p,m,l)}},{key:"deactivateChildRoutes",value:function(l,p,m){var S=this,M=bf(p);l.children.forEach(function(P){var N=P.value.outlet;S.deactivateRoutes(P,M[N],m),delete M[N]}),Co(M,function(P,N){S.deactivateRouteAndItsChildren(P,m)})}},{key:"deactivateRoutes",value:function(l,p,m){var S=l.value,M=p?p.value:null;if(S===M)if(S.component){var P=m.getContext(S.outlet);P&&this.deactivateChildRoutes(l,p,P.children)}else this.deactivateChildRoutes(l,p,m);else M&&this.deactivateRouteAndItsChildren(p,m)}},{key:"deactivateRouteAndItsChildren",value:function(l,p){l.value.component&&this.routeReuseStrategy.shouldDetach(l.value.snapshot)?this.detachAndStoreRouteSubtree(l,p):this.deactivateRouteAndOutlet(l,p)}},{key:"detachAndStoreRouteSubtree",value:function(l,p){for(var m=p.getContext(l.value.outlet),S=m&&l.value.component?m.children:p,M=bf(l),P=0,N=Object.keys(M);P<N.length;P++)this.deactivateRouteAndItsChildren(M[N[P]],S);if(m&&m.outlet){var ie=m.outlet.detach(),ye=m.children.onOutletDeactivated();this.routeReuseStrategy.store(l.value.snapshot,{componentRef:ie,route:l,contexts:ye})}}},{key:"deactivateRouteAndOutlet",value:function(l,p){for(var m=p.getContext(l.value.outlet),S=m&&l.value.component?m.children:p,M=bf(l),P=0,N=Object.keys(M);P<N.length;P++)this.deactivateRouteAndItsChildren(M[N[P]],S);m&&m.outlet&&(m.outlet.deactivate(),m.children.onOutletDeactivated(),m.attachRef=null,m.resolver=null,m.route=null)}},{key:"activateChildRoutes",value:function(l,p,m){var S=this,M=bf(p);l.children.forEach(function(P){S.activateRoutes(P,M[P.value.outlet],m),S.forwardEvent(new xT(P.value.snapshot))}),l.children.length&&this.forwardEvent(new _T(l.value.snapshot))}},{key:"activateRoutes",value:function(l,p,m){var S=l.value,M=p?p.value:null;if(J9(S),S===M)if(S.component){var P=m.getOrCreateContext(S.outlet);this.activateChildRoutes(l,p,P.children)}else this.activateChildRoutes(l,p,m);else if(S.component){var N=m.getOrCreateContext(S.outlet);if(this.routeReuseStrategy.shouldAttach(S.snapshot)){var G=this.routeReuseStrategy.retrieve(S.snapshot);this.routeReuseStrategy.store(S.snapshot,null),N.children.onOutletReAttached(G.contexts),N.attachRef=G.componentRef,N.route=G.route.value,N.outlet&&N.outlet.attach(G.componentRef,G.route.value),J9(G.route.value),this.activateChildRoutes(l,null,N.children)}else{var ie=function(o){for(var u=o.parent;u;u=u.parent){var l=u.routeConfig;if(l&&l._loadedConfig)return l._loadedConfig;if(l&&l.component)return null}return null}(S.snapshot),ye=ie?ie.module.componentFactoryResolver:null;N.attachRef=null,N.route=S,N.resolver=ye,N.outlet&&N.outlet.activateWith(S,ye),this.activateChildRoutes(l,null,N.children)}}else this.activateChildRoutes(l,null,m)}}]),o}(),r4=function o(u,l){_(this,o),this.routes=u,this.module=l};function Mu(o){return"function"==typeof o}function N0(o){return o instanceof F0}var Zh=Symbol("INITIAL_VALUE");function $h(){return P0(function(o){return function(){for(var o=arguments.length,u=new Array(o),l=0;l<o;l++)u[l]=arguments[l];var p=Ge(u),m=br(u),S=$M(u),M=S.args,P=S.keys;if(0===M.length)return Ve([],p);var N=new Ke(aT(M,p,P?function(G){return iT(P,G)}:ut));return m?N.pipe(nT(m)):N}(o.map(function(u){return u.pipe(Ue(1),function(){for(var o=arguments.length,u=new Array(o),l=0;l<o;l++)u[l]=arguments[l];var p=Ge(u);return Gt(function(m,S){(p?W9(u,m,p):W9(u,m)).subscribe(S)})}(Zh))})).pipe(E_(function(u,l){var p=!1;return l.reduce(function(m,S,M){return m!==Zh?m:(S===Zh&&(p=!0),p||!1!==S&&M!==l.length-1&&!N0(S)?m:S)},u)},Zh),O0(function(u){return u!==Zh}),yt(function(u){return N0(u)?u:!0===u}),Ue(1))})}var cE=function o(){_(this,o),this.outlet=null,this.route=null,this.resolver=null,this.children=new ep,this.attachRef=null},ep=function(){function o(){_(this,o),this.contexts=new Map}return w(o,[{key:"onChildOutletCreated",value:function(l,p){var m=this.getOrCreateContext(l);m.outlet=p,this.contexts.set(l,m)}},{key:"onChildOutletDestroyed",value:function(l){var p=this.getContext(l);p&&(p.outlet=null,p.attachRef=null)}},{key:"onOutletDeactivated",value:function(){var l=this.contexts;return this.contexts=new Map,l}},{key:"onOutletReAttached",value:function(l){this.contexts=l}},{key:"getOrCreateContext",value:function(l){var p=this.getContext(l);return p||(p=new cE,this.contexts.set(l,p)),p}},{key:"getContext",value:function(l){return this.contexts.get(l)||null}}]),o}(),n4=function(){var o=function(){function u(l,p,m,S,M){_(this,u),this.parentContexts=l,this.location=p,this.resolver=m,this.changeDetector=M,this.activated=null,this._activatedRoute=null,this.activateEvents=new mt,this.deactivateEvents=new mt,this.attachEvents=new mt,this.detachEvents=new mt,this.name=S||bn,l.onChildOutletCreated(this.name,this)}return w(u,[{key:"ngOnDestroy",value:function(){this.parentContexts.onChildOutletDestroyed(this.name)}},{key:"ngOnInit",value:function(){if(!this.activated){var p=this.parentContexts.getContext(this.name);p&&p.route&&(p.attachRef?this.attach(p.attachRef,p.route):this.activateWith(p.route,p.resolver||null))}}},{key:"isActivated",get:function(){return!!this.activated}},{key:"component",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}},{key:"activatedRoute",get:function(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}},{key:"activatedRouteData",get:function(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}},{key:"detach",value:function(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();var p=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(p.instance),p}},{key:"attach",value:function(p,m){this.activated=p,this._activatedRoute=m,this.location.insert(p.hostView),this.attachEvents.emit(p.instance)}},{key:"deactivate",value:function(){if(this.activated){var p=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(p)}}},{key:"activateWith",value:function(p,m){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=p;var P=(m=m||this.resolver).resolveComponentFactory(p._futureSnapshot.routeConfig.component),N=this.parentContexts.getOrCreateContext(this.name).children,G=new fE(p,N,this.location.injector);this.activated=this.location.createComponent(P,this.location.length,G),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}]),u}();return o.\u0275fac=function(l){return new(l||o)(dr(ep),dr(Ca),dr(_u),Hl("name"),dr(u9))},o.\u0275dir=no({type:o,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),o}(),fE=function(){function o(u,l,p){_(this,o),this.route=u,this.childContexts=l,this.parent=p}return w(o,[{key:"get",value:function(l,p){return l===Ys?this.route:l===ep?this.childContexts:this.parent.get(l,p)}}]),o}(),a8=function(){var o=function u(){_(this,u)};return o.\u0275fac=function(l){return new(l||o)},o.\u0275cmp=Ei({type:o,selectors:[["ng-component"]],decls:1,vars:0,template:function(l,p){1&l&&f(0,"router-outlet")},directives:[n4],encapsulation:2}),o}();function s8(o){for(var u=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",l=0;l<o.length;l++){var p=o[l],m=hE(u,p);dE(p,m)}}function dE(o,u){o.children&&s8(o.children,u)}function hE(o,u){return u?o||u.path?o&&!u.path?"".concat(o,"/"):!o&&u.path?u.path:"".concat(o,"/").concat(u.path):"":o}function i4(o){var u=o.children&&o.children.map(i4),l=u?Object.assign(Object.assign({},o),{children:u}):Object.assign({},o);return!l.component&&(u||l.loadChildren)&&l.outlet&&l.outlet!==bn&&(l.component=a8),l}function za(o){return o.outlet||bn}function l8(o,u){var l=o.filter(function(p){return za(p)===u});return l.push.apply(l,U(o.filter(function(p){return za(p)!==u}))),l}var u8={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function i1(o,u,l){var p;if(""===u.path)return"full"===u.pathMatch&&(o.hasChildren()||l.length>0)?Object.assign({},u8):{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};var S=(u.matcher||MT)(l,o,u);if(!S)return Object.assign({},u8);var M={};Co(S.posParams,function(N,G){M[G]=N.path});var P=S.consumed.length>0?Object.assign(Object.assign({},M),S.consumed[S.consumed.length-1].parameters):M;return{matched:!0,consumedSegments:S.consumed,lastChild:S.consumed.length,parameters:P,positionalParamSegments:null!==(p=S.posParams)&&void 0!==p?p:{}}}function o1(o,u,l,p){var m=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"corrected";if(l.length>0&&gE(o,l,p)){var S=new Rn(u,vE(o,u,p,new Rn(l,o.children)));return S._sourceSegment=o,S._segmentIndexShift=u.length,{segmentGroup:S,slicedSegments:[]}}if(0===l.length&&mE(o,l,p)){var M=new Rn(o.segments,pE(o,u,l,p,o.children,m));return M._sourceSegment=o,M._segmentIndexShift=u.length,{segmentGroup:M,slicedSegments:l}}var P=new Rn(o.segments,o.children);return P._sourceSegment=o,P._segmentIndexShift=u.length,{segmentGroup:P,slicedSegments:l}}function pE(o,u,l,p,m,S){var N,M={},P=I(p);try{for(P.s();!(N=P.n()).done;){var G=N.value;if(a1(o,l,G)&&!m[za(G)]){var ie=new Rn([],{});ie._sourceSegment=o,ie._segmentIndexShift="legacy"===S?o.segments.length:u.length,M[za(G)]=ie}}}catch(ye){P.e(ye)}finally{P.f()}return Object.assign(Object.assign({},m),M)}function vE(o,u,l,p){var m={};m[bn]=p,p._sourceSegment=o,p._segmentIndexShift=u.length;var M,S=I(l);try{for(S.s();!(M=S.n()).done;){var P=M.value;if(""===P.path&&za(P)!==bn){var N=new Rn([],{});N._sourceSegment=o,N._segmentIndexShift=u.length,m[za(P)]=N}}}catch(G){S.e(G)}finally{S.f()}return m}function gE(o,u,l){return l.some(function(p){return a1(o,u,p)&&za(p)!==bn})}function mE(o,u,l){return l.some(function(p){return a1(o,u,p)})}function a1(o,u,l){return(!(o.hasChildren()||u.length>0)||"full"!==l.pathMatch)&&""===l.path}function c8(o,u,l,p){return!!(za(o)===p||p!==bn&&a1(u,l,o))&&("**"===o.path||i1(u,o,l).matched)}function f8(o,u,l){return 0===u.length&&!o.children[l]}var tp=function o(u){_(this,o),this.segmentGroup=u||null},d8=function o(u){_(this,o),this.urlTree=u};function s1(o){return new Ke(function(u){return u.error(new tp(o))})}function h8(o){return new Ke(function(u){return u.error(new d8(o))})}function yE(o){return new Ke(function(u){return u.error(new Error("Only absolute redirects can have named outlets. redirectTo: '".concat(o,"'")))})}var _E=function(){function o(u,l,p,m,S){_(this,o),this.configLoader=l,this.urlSerializer=p,this.urlTree=m,this.config=S,this.allowRedirects=!0,this.ngModule=u.get(Cl)}return w(o,[{key:"apply",value:function(){var l=this,p=o1(this.urlTree.root,[],[],this.config).segmentGroup,m=new Rn(p.segments,p.children);return this.expandSegmentGroup(this.ngModule,this.config,m,bn).pipe(yt(function(P){return l.createUrlTree(o4(P),l.urlTree.queryParams,l.urlTree.fragment)})).pipe(Au(function(P){if(P instanceof d8)return l.allowRedirects=!1,l.match(P.urlTree);throw P instanceof tp?l.noMatchError(P):P}))}},{key:"match",value:function(l){var p=this;return this.expandSegmentGroup(this.ngModule,this.config,l.root,bn).pipe(yt(function(M){return p.createUrlTree(o4(M),l.queryParams,l.fragment)})).pipe(Au(function(M){throw M instanceof tp?p.noMatchError(M):M}))}},{key:"noMatchError",value:function(l){return new Error("Cannot match any routes. URL Segment: '".concat(l.segmentGroup,"'"))}},{key:"createUrlTree",value:function(l,p,m){var S=l.segments.length>0?new Rn([],re({},bn,l)):l;return new F0(S,p,m)}},{key:"expandSegmentGroup",value:function(l,p,m,S){return 0===m.segments.length&&m.hasChildren()?this.expandChildren(l,p,m).pipe(yt(function(M){return new Rn([],M)})):this.expandSegment(l,m,p,m.segments,S,!0)}},{key:"expandChildren",value:function(l,p,m){for(var S=this,M=[],P=0,N=Object.keys(m.children);P<N.length;P++){var G=N[P];"primary"===G?M.unshift(G):M.push(G)}return Ve(M).pipe(wf(function(ie){var ye=m.children[ie],Ce=l8(p,ie);return S.expandSegmentGroup(l,Ce,ye,ie).pipe(yt(function(Le){return{segment:Le,outlet:ie}}))}),E_(function(ie,ye){return ie[ye.outlet]=ye.segment,ie},{}),function(o,u){var l=arguments.length>=2;return function(p){return p.pipe(o?O0(function(m,S){return o(m,S,p)}):ut,z9(1),l?D_(u):R_(function(){return new Km}))}}())}},{key:"expandSegment",value:function(l,p,m,S,M,P){var N=this;return Ve(m).pipe(wf(function(G){return N.expandSegmentAgainstRoute(l,p,m,G,S,M,P).pipe(Au(function(ye){if(ye instanceof tp)return an(null);throw ye}))}),Sf(function(G){return!!G}),Au(function(G,ie){if(G instanceof Km||"EmptyError"===G.name){if(f8(p,S,M))return an(new Rn([],{}));throw new tp(p)}throw G}))}},{key:"expandSegmentAgainstRoute",value:function(l,p,m,S,M,P,N){return c8(S,p,M,P)?void 0===S.redirectTo?this.matchSegmentAgainstRoute(l,p,S,M,P):N&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(l,p,m,S,M,P):s1(p):s1(p)}},{key:"expandSegmentAgainstRouteUsingRedirect",value:function(l,p,m,S,M,P){return"**"===S.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(l,m,S,P):this.expandRegularSegmentAgainstRouteUsingRedirect(l,p,m,S,M,P)}},{key:"expandWildCardWithParamsAgainstRouteUsingRedirect",value:function(l,p,m,S){var M=this,P=this.applyRedirectCommands([],m.redirectTo,{});return m.redirectTo.startsWith("/")?h8(P):this.lineralizeSegments(m,P).pipe(Xt(function(N){var G=new Rn(N,{});return M.expandSegment(l,G,p,N,S,!1)}))}},{key:"expandRegularSegmentAgainstRouteUsingRedirect",value:function(l,p,m,S,M,P){var N=this,G=i1(p,S,M),ye=G.consumedSegments,Ce=G.lastChild,Le=G.positionalParamSegments;if(!G.matched)return s1(p);var qe=this.applyRedirectCommands(ye,S.redirectTo,Le);return S.redirectTo.startsWith("/")?h8(qe):this.lineralizeSegments(S,qe).pipe(Xt(function(nt){return N.expandSegment(l,p,m,nt.concat(M.slice(Ce)),P,!1)}))}},{key:"matchSegmentAgainstRoute",value:function(l,p,m,S,M){var P=this;if("**"===m.path)return m.loadChildren?(m._loadedConfig?an(m._loadedConfig):this.configLoader.load(l.injector,m)).pipe(yt(function(nt){return m._loadedConfig=nt,new Rn(S,{})})):an(new Rn(S,{}));var G=i1(p,m,S),ye=G.consumedSegments,Ce=G.lastChild;if(!G.matched)return s1(p);var Le=S.slice(Ce);return this.getChildConfig(l,m,S).pipe(Xt(function(nt){var tt=nt.module,et=nt.routes,Ze=o1(p,ye,Le,et),ht=Ze.segmentGroup,At=Ze.slicedSegments,Tt=new Rn(ht.segments,ht.children);if(0===At.length&&Tt.hasChildren())return P.expandChildren(tt,et,Tt).pipe(yt(function(en){return new Rn(ye,en)}));if(0===et.length&&0===At.length)return an(new Rn(ye,{}));var yr=za(m)===M;return P.expandSegment(tt,Tt,et,At,yr?bn:M,!0).pipe(yt(function(en){return new Rn(ye.concat(en.segments),en.children)}))}))}},{key:"getChildConfig",value:function(l,p,m){var S=this;return p.children?an(new r4(p.children,l)):p.loadChildren?void 0!==p._loadedConfig?an(p._loadedConfig):this.runCanLoadGuards(l.injector,p,m).pipe(Xt(function(M){return M?S.configLoader.load(l.injector,p).pipe(yt(function(P){return p._loadedConfig=P,P})):function(o){return new Ke(function(u){return u.error(X9("Cannot load children because the guard of the route \"path: '".concat(o.path,"'\" returned false")))})}(p)})):an(new r4([],l))}},{key:"runCanLoadGuards",value:function(l,p,m){var S=this,M=p.canLoad;if(!M||0===M.length)return an(!0);var P=M.map(function(N){var ie,G=l.get(N);if(function(o){return o&&Mu(o.canLoad)}(G))ie=G.canLoad(p,m);else{if(!Mu(G))throw new Error("Invalid CanLoad guard");ie=G(p,m)}return Xs(ie)});return an(P).pipe($h(),_a(function(N){if(N0(N)){var G=X9('Redirecting to "'.concat(S.urlSerializer.serialize(N),'"'));throw G.url=N,G}}),yt(function(N){return!0===N}))}},{key:"lineralizeSegments",value:function(l,p){for(var m=[],S=p.root;;){if(m=m.concat(S.segments),0===S.numberOfChildren)return an(m);if(S.numberOfChildren>1||!S.children[bn])return yE(l.redirectTo);S=S.children[bn]}}},{key:"applyRedirectCommands",value:function(l,p,m){return this.applyRedirectCreatreUrlTree(p,this.urlSerializer.parse(p),l,m)}},{key:"applyRedirectCreatreUrlTree",value:function(l,p,m,S){var M=this.createSegmentGroup(l,p.root,m,S);return new F0(M,this.createQueryParams(p.queryParams,this.urlTree.queryParams),p.fragment)}},{key:"createQueryParams",value:function(l,p){var m={};return Co(l,function(S,M){if("string"==typeof S&&S.startsWith(":")){var N=S.substring(1);m[M]=p[N]}else m[M]=S}),m}},{key:"createSegmentGroup",value:function(l,p,m,S){var M=this,P=this.createSegments(l,p.segments,m,S),N={};return Co(p.children,function(G,ie){N[ie]=M.createSegmentGroup(l,G,m,S)}),new Rn(P,N)}},{key:"createSegments",value:function(l,p,m,S){var M=this;return p.map(function(P){return P.path.startsWith(":")?M.findPosParam(l,P,S):M.findOrReturn(P,m)})}},{key:"findPosParam",value:function(l,p,m){var S=m[p.path.substring(1)];if(!S)throw new Error("Cannot redirect to '".concat(l,"'. Cannot find '").concat(p.path,"'."));return S}},{key:"findOrReturn",value:function(l,p){var M,m=0,S=I(p);try{for(S.s();!(M=S.n()).done;){var P=M.value;if(P.path===l.path)return p.splice(m),P;m++}}catch(N){S.e(N)}finally{S.f()}return l}}]),o}();function o4(o){for(var u={},l=0,p=Object.keys(o.children);l<p.length;l++){var m=p[l],M=o4(o.children[m]);(M.segments.length>0||M.hasChildren())&&(u[m]=M)}return function(o){if(1===o.numberOfChildren&&o.children[bn]){var u=o.children[bn];return new Rn(o.segments.concat(u.segments),u.children)}return o}(new Rn(o.segments,u))}var p8=function o(u){_(this,o),this.path=u,this.route=this.path[this.path.length-1]},l1=function o(u,l){_(this,o),this.component=u,this.route=l};function bE(o,u,l){var p=o._root;return rp(p,u?u._root:null,l,[p.value])}function u1(o,u,l){var p=function(o){if(!o)return null;for(var u=o.parent;u;u=u.parent){var l=u.routeConfig;if(l&&l._loadedConfig)return l._loadedConfig}return null}(u);return(p?p.module.injector:l).get(o)}function rp(o,u,l,p){var m=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},S=bf(u);return o.children.forEach(function(M){TE(M,S[M.value.outlet],l,p.concat([M.value]),m),delete S[M.value.outlet]}),Co(S,function(M,P){return np(M,l.getContext(P),m)}),m}function TE(o,u,l,p){var m=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{canDeactivateChecks:[],canActivateChecks:[]},S=o.value,M=u?u.value:null,P=l?l.getContext(o.value.outlet):null;if(M&&S.routeConfig===M.routeConfig){var N=EE(M,S,S.routeConfig.runGuardsAndResolvers);N?m.canActivateChecks.push(new p8(p)):(S.data=M.data,S._resolvedData=M._resolvedData),rp(o,u,S.component?P?P.children:null:l,p,m),N&&P&&P.outlet&&P.outlet.isActivated&&m.canDeactivateChecks.push(new l1(P.outlet.component,M))}else M&&np(u,P,m),m.canActivateChecks.push(new p8(p)),rp(o,null,S.component?P?P.children:null:l,p,m);return m}function EE(o,u,l){if("function"==typeof l)return l(o,u);switch(l){case"pathParamsChange":return!L0(o.url,u.url);case"pathParamsOrQueryParamsChange":return!L0(o.url,u.url)||!js(o.queryParams,u.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Z9(o,u)||!js(o.queryParams,u.queryParams);default:return!Z9(o,u)}}function np(o,u,l){var p=bf(o),m=o.value;Co(p,function(S,M){np(S,m.component?u?u.children.getContext(M):null:u,l)}),l.canDeactivateChecks.push(new l1(m.component&&u&&u.outlet&&u.outlet.isActivated?u.outlet.component:null,m))}var kE=function o(){_(this,o)};function v8(o){return new Ke(function(u){return u.error(o)})}var GE=function(){function o(u,l,p,m,S,M){_(this,o),this.rootComponentType=u,this.config=l,this.urlTree=p,this.url=m,this.paramsInheritanceStrategy=S,this.relativeLinkResolution=M}return w(o,[{key:"recognize",value:function(){var l=o1(this.urlTree.root,[],[],this.config.filter(function(P){return void 0===P.redirectTo}),this.relativeLinkResolution).segmentGroup,p=this.processSegmentGroup(this.config,l,bn);if(null===p)return null;var m=new t1([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},bn,this.rootComponentType,null,this.urlTree.root,-1,{}),S=new bl(m,p),M=new $_(this.url,S);return this.inheritParamsAndData(M._root),M}},{key:"inheritParamsAndData",value:function(l){var p=this,m=l.value,S=Z_(m,this.paramsInheritanceStrategy);m.params=Object.freeze(S.params),m.data=Object.freeze(S.data),l.children.forEach(function(M){return p.inheritParamsAndData(M)})}},{key:"processSegmentGroup",value:function(l,p,m){return 0===p.segments.length&&p.hasChildren()?this.processChildren(l,p):this.processSegment(l,p,p.segments,m)}},{key:"processChildren",value:function(l,p){for(var m=[],S=0,M=Object.keys(p.children);S<M.length;S++){var P=M[S],N=p.children[P],G=l8(l,P),ie=this.processSegmentGroup(G,N,P);if(null===ie)return null;m.push.apply(m,U(ie))}var ye=g8(m);return function(o){o.sort(function(u,l){return u.value.outlet===bn?-1:l.value.outlet===bn?1:u.value.outlet.localeCompare(l.value.outlet)})}(ye),ye}},{key:"processSegment",value:function(l,p,m,S){var P,M=I(l);try{for(M.s();!(P=M.n()).done;){var G=this.processSegmentAgainstRoute(P.value,p,m,S);if(null!==G)return G}}catch(ie){M.e(ie)}finally{M.f()}return f8(p,m,S)?[]:null}},{key:"processSegmentAgainstRoute",value:function(l,p,m,S){if(l.redirectTo||!c8(l,p,m,S))return null;var M,P=[],N=[];if("**"===l.path){var G=m.length>0?B_(m).parameters:{};M=new t1(m,G,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,C8(l),za(l),l.component,l,m8(p),y8(p)+m.length,w8(l))}else{var ie=i1(p,l,m);if(!ie.matched)return null;P=ie.consumedSegments,N=m.slice(ie.lastChild),M=new t1(P,ie.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,C8(l),za(l),l.component,l,m8(p),y8(p)+P.length,w8(l))}var ye=function(o){return o.children?o.children:o.loadChildren?o._loadedConfig.routes:[]}(l),Ce=o1(p,P,N,ye.filter(function(Ze){return void 0===Ze.redirectTo}),this.relativeLinkResolution),Le=Ce.segmentGroup,qe=Ce.slicedSegments;if(0===qe.length&&Le.hasChildren()){var nt=this.processChildren(ye,Le);return null===nt?null:[new bl(M,nt)]}if(0===ye.length&&0===qe.length)return[new bl(M,[])];var tt=za(l)===S,et=this.processSegment(ye,Le,qe,tt?bn:S);return null===et?null:[new bl(M,et)]}}]),o}();function g8(o){var m,u=[],l=new Set,p=I(o);try{var S=function(){var Ce=m.value;if(!function(o){var u=o.value.routeConfig;return u&&""===u.path&&void 0===u.redirectTo}(Ce))return u.push(Ce),"continue";var qe,Le=u.find(function(nt){return Ce.value.routeConfig===nt.value.routeConfig});void 0!==Le?((qe=Le.children).push.apply(qe,U(Ce.children)),l.add(Le)):u.push(Ce)};for(p.s();!(m=p.n()).done;)S()}catch(ye){p.e(ye)}finally{p.f()}var N,P=I(l);try{for(P.s();!(N=P.n()).done;){var G=N.value,ie=g8(G.children);u.push(new bl(G.value,ie))}}catch(ye){P.e(ye)}finally{P.f()}return u.filter(function(ye){return!l.has(ye)})}function m8(o){for(var u=o;u._sourceSegment;)u=u._sourceSegment;return u}function y8(o){for(var u=o,l=u._segmentIndexShift?u._segmentIndexShift:0;u._sourceSegment;)l+=(u=u._sourceSegment)._segmentIndexShift?u._segmentIndexShift:0;return l-1}function C8(o){return o.data||{}}function w8(o){return o.resolve||{}}function a4(o){return P0(function(u){var l=o(u);return l?Ve(l).pipe(yt(function(){return u})):an(u)})}var KE=function(){function o(){_(this,o)}return w(o,[{key:"shouldDetach",value:function(l){return!1}},{key:"store",value:function(l,p){}},{key:"shouldAttach",value:function(l){return!1}},{key:"retrieve",value:function(l){return null}},{key:"shouldReuseRoute",value:function(l,p){return l.routeConfig===p.routeConfig}}]),o}(),QE=function(o){b(l,o);var u=D(l);function l(){return _(this,l),u.apply(this,arguments)}return l}(KE),s4=new xn("ROUTES"),_8=function(){function o(u,l,p,m){_(this,o),this.injector=u,this.compiler=l,this.onLoadStartListener=p,this.onLoadEndListener=m}return w(o,[{key:"load",value:function(l,p){var m=this;if(p._loader$)return p._loader$;this.onLoadStartListener&&this.onLoadStartListener(p);var M=this.loadModuleFactory(p.loadChildren).pipe(yt(function(P){m.onLoadEndListener&&m.onLoadEndListener(p);var N=P.create(l);return new r4(k_(N.injector.get(s4,void 0,tn.Self|tn.Optional)).map(i4),N)}),Au(function(P){throw p._loader$=void 0,P}));return p._loader$=new lT(M,function(){return new He}).pipe(T_()),p._loader$}},{key:"loadModuleFactory",value:function(l){var p=this;return Xs(l()).pipe(Xt(function(m){return m instanceof RC?an(m):Ve(p.compiler.compileModuleAsync(m))}))}}]),o}(),ZE=function(){function o(){_(this,o)}return w(o,[{key:"shouldProcessUrl",value:function(l){return!0}},{key:"extract",value:function(l){return l}},{key:"merge",value:function(l,p){return l}}]),o}();function $E(o){throw o}function eR(o,u,l){return u.parse("/")}function S8(o,u){return an(null)}var tR={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},rR={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Ho=function(){var o=function(){function u(l,p,m,S,M,P,N){var G=this;_(this,u),this.rootComponentType=l,this.urlSerializer=p,this.rootContexts=m,this.location=S,this.config=N,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new He,this.errorHandler=$E,this.malformedUriErrorHandler=eR,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:S8,afterPreactivation:S8},this.urlHandlingStrategy=new ZE,this.routeReuseStrategy=new QE,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=M.get(Cl),this.console=M.get(fw);var Ce=M.get(eo);this.isNgZoneEnabled=Ce instanceof eo&&eo.isInAngularZone(),this.resetConfig(N),this.currentUrlTree=new F0(new Rn([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new _8(M,P,function(qe){return G.triggerEvent(new P_(qe))},function(qe){return G.triggerEvent(new F_(qe))}),this.routerState=J_(this.currentUrlTree,this.rootComponentType),this.transitions=new Cs({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}return w(u,[{key:"browserPageId",get:function(){var p;return null===(p=this.location.getState())||void 0===p?void 0:p.\u0275routerPageId}},{key:"setupNavigations",value:function(p){var m=this,S=this.events;return p.pipe(O0(function(M){return 0!==M.id}),yt(function(M){return Object.assign(Object.assign({},M),{extractedUrl:m.urlHandlingStrategy.extract(M.rawUrl)})}),P0(function(M){var P=!1,N=!1;return an(M).pipe(_a(function(G){m.currentNavigation={id:G.id,initialUrl:G.currentRawUrl,extractedUrl:G.extractedUrl,trigger:G.source,extras:G.extras,previousNavigation:m.lastSuccessfulNavigation?Object.assign(Object.assign({},m.lastSuccessfulNavigation),{previousNavigation:null}):null}}),P0(function(G){var ie=m.browserUrlTree.toString(),ye=!m.navigated||G.extractedUrl.toString()!==ie||ie!==m.currentUrlTree.toString();if(("reload"===m.onSameUrlNavigation||ye)&&m.urlHandlingStrategy.shouldProcessUrl(G.rawUrl))return c1(G.source)&&(m.browserUrlTree=G.extractedUrl),an(G).pipe(P0(function(Tt){var nr=m.transitions.getValue();return S.next(new j9(Tt.id,m.serializeUrl(Tt.extractedUrl),Tt.source,Tt.restoredState)),nr!==m.transitions.getValue()?jt:Promise.resolve(Tt)}),function(o,u,l,p){return P0(function(m){return function(o,u,l,p,m){return new _E(o,u,l,p,m).apply()}(o,u,l,m.extractedUrl,p).pipe(yt(function(S){return Object.assign(Object.assign({},m),{urlAfterRedirects:S})}))})}(m.ngModule.injector,m.configLoader,m.urlSerializer,m.config),_a(function(Tt){m.currentNavigation=Object.assign(Object.assign({},m.currentNavigation),{finalUrl:Tt.urlAfterRedirects})}),function(o,u,l,p,m){return Xt(function(S){return function(o,u,l,p){var m=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"emptyOnly",S=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"legacy";try{var M=new GE(o,u,l,p,m,S).recognize();return null===M?v8(new kE):an(M)}catch(P){return v8(P)}}(o,u,S.urlAfterRedirects,l(S.urlAfterRedirects),p,m).pipe(yt(function(M){return Object.assign(Object.assign({},S),{targetSnapshot:M})}))})}(m.rootComponentType,m.config,function(Tt){return m.serializeUrl(Tt)},m.paramsInheritanceStrategy,m.relativeLinkResolution),_a(function(Tt){if("eager"===m.urlUpdateStrategy){if(!Tt.extras.skipLocationChange){var nr=m.urlHandlingStrategy.merge(Tt.urlAfterRedirects,Tt.rawUrl);m.setBrowserUrl(nr,Tt)}m.browserUrlTree=Tt.urlAfterRedirects}var yr=new vT(Tt.id,m.serializeUrl(Tt.extractedUrl),m.serializeUrl(Tt.urlAfterRedirects),Tt.targetSnapshot);S.next(yr)}));if(ye&&m.rawUrlTree&&m.urlHandlingStrategy.shouldProcessUrl(m.rawUrlTree)){var nt=G.extractedUrl,tt=G.source,et=G.restoredState,Ze=G.extras,ht=new j9(G.id,m.serializeUrl(nt),tt,et);S.next(ht);var At=J_(nt,m.rootComponentType).snapshot;return an(Object.assign(Object.assign({},G),{targetSnapshot:At,urlAfterRedirects:nt,extras:Object.assign(Object.assign({},Ze),{skipLocationChange:!1,replaceUrl:!1})}))}return m.rawUrlTree=G.rawUrl,G.resolve(null),jt}),a4(function(G){var qe=G.extras;return m.hooks.beforePreactivation(G.targetSnapshot,{navigationId:G.id,appliedUrlTree:G.extractedUrl,rawUrlTree:G.rawUrl,skipLocationChange:!!qe.skipLocationChange,replaceUrl:!!qe.replaceUrl})}),_a(function(G){var ie=new gT(G.id,m.serializeUrl(G.extractedUrl),m.serializeUrl(G.urlAfterRedirects),G.targetSnapshot);m.triggerEvent(ie)}),yt(function(G){return Object.assign(Object.assign({},G),{guards:bE(G.targetSnapshot,G.currentSnapshot,m.rootContexts)})}),function(o,u){return Xt(function(l){var p=l.targetSnapshot,m=l.currentSnapshot,S=l.guards,M=S.canActivateChecks,P=S.canDeactivateChecks;return 0===P.length&&0===M.length?an(Object.assign(Object.assign({},l),{guardsResult:!0})):function(o,u,l,p){return Ve(o).pipe(Xt(function(m){return function(o,u,l,p,m){var S=u&&u.routeConfig?u.routeConfig.canDeactivate:null;if(!S||0===S.length)return an(!0);var M=S.map(function(P){var G,N=u1(P,u,m);if(function(o){return o&&Mu(o.canDeactivate)}(N))G=Xs(N.canDeactivate(o,u,l,p));else{if(!Mu(N))throw new Error("Invalid CanDeactivate guard");G=Xs(N(o,u,l,p))}return G.pipe(Sf())});return an(M).pipe($h())}(m.component,m.route,l,u,p)}),Sf(function(m){return!0!==m},!0))}(P,p,m,o).pipe(Xt(function(N){return N&&function(o){return"boolean"==typeof o}(N)?function(o,u,l,p){return Ve(u).pipe(wf(function(m){return W9(function(o,u){return null!==o&&u&&u(new wT(o)),an(!0)}(m.route.parent,p),function(o,u){return null!==o&&u&&u(new ST(o)),an(!0)}(m.route,p),function(o,u,l){var p=u[u.length-1],m=u.slice(0,u.length-1).reverse().map(function(M){return function(o){var u=o.routeConfig?o.routeConfig.canActivateChild:null;return u&&0!==u.length?{node:o,guards:u}:null}(M)}).filter(function(M){return null!==M}),S=m.map(function(M){return M_(function(){var P=M.guards.map(function(N){var ie,G=u1(N,M.node,l);if(function(o){return o&&Mu(o.canActivateChild)}(G))ie=Xs(G.canActivateChild(p,o));else{if(!Mu(G))throw new Error("Invalid CanActivateChild guard");ie=Xs(G(p,o))}return ie.pipe(Sf())});return an(P).pipe($h())})});return an(S).pipe($h())}(o,m.path,l),function(o,u,l){var p=u.routeConfig?u.routeConfig.canActivate:null;if(!p||0===p.length)return an(!0);var m=p.map(function(S){return M_(function(){var P,M=u1(S,u,l);if(function(o){return o&&Mu(o.canActivate)}(M))P=Xs(M.canActivate(u,o));else{if(!Mu(M))throw new Error("Invalid CanActivate guard");P=Xs(M(u,o))}return P.pipe(Sf())})});return an(m).pipe($h())}(o,m.route,l))}),Sf(function(m){return!0!==m},!0))}(p,M,o,u):an(N)}),yt(function(N){return Object.assign(Object.assign({},l),{guardsResult:N})}))})}(m.ngModule.injector,function(G){return m.triggerEvent(G)}),_a(function(G){if(N0(G.guardsResult)){var ie=X9('Redirecting to "'.concat(m.serializeUrl(G.guardsResult),'"'));throw ie.url=G.guardsResult,ie}var ye=new mT(G.id,m.serializeUrl(G.extractedUrl),m.serializeUrl(G.urlAfterRedirects),G.targetSnapshot,!!G.guardsResult);m.triggerEvent(ye)}),O0(function(G){return!!G.guardsResult||(m.restoreHistory(G),m.cancelNavigationTransition(G,""),!1)}),a4(function(G){if(G.guards.canActivateChecks.length)return an(G).pipe(_a(function(ie){var ye=new yT(ie.id,m.serializeUrl(ie.extractedUrl),m.serializeUrl(ie.urlAfterRedirects),ie.targetSnapshot);m.triggerEvent(ye)}),P0(function(ie){var ye=!1;return an(ie).pipe(function(o,u){return Xt(function(l){var p=l.targetSnapshot,m=l.guards.canActivateChecks;if(!m.length)return an(l);var S=0;return Ve(m).pipe(wf(function(M){return function(o,u,l,p){return function(o,u,l,p){var m=Object.keys(o);if(0===m.length)return an({});var S={};return Ve(m).pipe(Xt(function(M){return function(o,u,l,p){var m=u1(o,u,p);return Xs(m.resolve?m.resolve(u,l):m(u,l))}(o[M],u,l,p).pipe(_a(function(P){S[M]=P}))}),z9(1),Xt(function(){return Object.keys(S).length===m.length?an(S):jt}))}(o._resolve,o,u,p).pipe(yt(function(S){return o._resolvedData=S,o.data=Object.assign(Object.assign({},o.data),Z_(o,l).resolve),null}))}(M.route,p,o,u)}),_a(function(){return S++}),z9(1),Xt(function(M){return S===m.length?an(l):jt}))})}(m.paramsInheritanceStrategy,m.ngModule.injector),_a({next:function(){return ye=!0},complete:function(){ye||(m.restoreHistory(ie),m.cancelNavigationTransition(ie,"At least one route resolver didn't emit any value."))}}))}),_a(function(ie){var ye=new CT(ie.id,m.serializeUrl(ie.extractedUrl),m.serializeUrl(ie.urlAfterRedirects),ie.targetSnapshot);m.triggerEvent(ye)}))}),a4(function(G){var qe=G.extras;return m.hooks.afterPreactivation(G.targetSnapshot,{navigationId:G.id,appliedUrlTree:G.extractedUrl,rawUrlTree:G.rawUrl,skipLocationChange:!!qe.skipLocationChange,replaceUrl:!!qe.replaceUrl})}),yt(function(G){var ie=function(o,u,l){var p=Qh(o,u._root,l?l._root:void 0);return new Q_(p,u)}(m.routeReuseStrategy,G.targetSnapshot,G.currentRouterState);return Object.assign(Object.assign({},G),{targetRouterState:ie})}),_a(function(G){m.currentUrlTree=G.urlAfterRedirects,m.rawUrlTree=m.urlHandlingStrategy.merge(G.urlAfterRedirects,G.rawUrl),m.routerState=G.targetRouterState,"deferred"===m.urlUpdateStrategy&&(G.extras.skipLocationChange||m.setBrowserUrl(m.rawUrlTree,G),m.browserUrlTree=G.urlAfterRedirects)}),function(u,l,p){return yt(function(m){return new nE(l,m.targetRouterState,m.currentRouterState,p).activate(u),m})}(m.rootContexts,m.routeReuseStrategy,function(G){return m.triggerEvent(G)}),_a({next:function(){P=!0},complete:function(){P=!0}}),function(o){return Gt(function(u,l){try{u.subscribe(l)}finally{l.add(o)}})}(function(){var G;if(!P&&!N){var ie="Navigation ID ".concat(M.id," is not equal to the current navigation id ").concat(m.navigationId);m.cancelNavigationTransition(M,ie)}(null===(G=m.currentNavigation)||void 0===G?void 0:G.id)===M.id&&(m.currentNavigation=null)}),Au(function(G){if(N=!0,function(o){return o&&o[N_]}(G)){var ie=N0(G.url);ie||(m.navigated=!0,m.restoreHistory(M,!0));var ye=new O_(M.id,m.serializeUrl(M.extractedUrl),G.message);S.next(ye),ie?setTimeout(function(){var Le=m.urlHandlingStrategy.merge(G.url,m.rawUrlTree),qe={skipLocationChange:M.extras.skipLocationChange,replaceUrl:"eager"===m.urlUpdateStrategy||c1(M.source)};m.scheduleNavigation(Le,"imperative",null,qe,{resolve:M.resolve,reject:M.reject,promise:M.promise})},0):M.resolve(!1)}else{m.restoreHistory(M,!0);var Ce=new pT(M.id,m.serializeUrl(M.extractedUrl),G);S.next(Ce);try{M.resolve(m.errorHandler(G))}catch(Le){M.reject(Le)}}return jt}))}))}},{key:"resetRootComponentType",value:function(p){this.rootComponentType=p,this.routerState.root.component=this.rootComponentType}},{key:"setTransition",value:function(p){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),p))}},{key:"initialNavigation",value:function(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}},{key:"setUpLocationChangeListener",value:function(){var p=this;this.locationSubscription||(this.locationSubscription=this.location.subscribe(function(m){var S="popstate"===m.type?"popstate":"hashchange";"popstate"===S&&setTimeout(function(){var M,P={replaceUrl:!0},N=(null===(M=m.state)||void 0===M?void 0:M.navigationId)?m.state:null;if(N){var G=Object.assign({},N);delete G.navigationId,delete G.\u0275routerPageId,0!==Object.keys(G).length&&(P.state=G)}var ie=p.parseUrl(m.url);p.scheduleNavigation(ie,S,N,P)},0)}))}},{key:"url",get:function(){return this.serializeUrl(this.currentUrlTree)}},{key:"getCurrentNavigation",value:function(){return this.currentNavigation}},{key:"triggerEvent",value:function(p){this.events.next(p)}},{key:"resetConfig",value:function(p){s8(p),this.config=p.map(i4),this.navigated=!1,this.lastSuccessfulId=-1}},{key:"ngOnDestroy",value:function(){this.dispose()}},{key:"dispose",value:function(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}},{key:"createUrlTree",value:function(p){var m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},S=m.relativeTo,M=m.queryParams,P=m.fragment,N=m.queryParamsHandling,G=m.preserveFragment,ie=S||this.routerState.root,ye=G?this.currentUrlTree.fragment:P,Ce=null;switch(N){case"merge":Ce=Object.assign(Object.assign({},this.currentUrlTree.queryParams),M);break;case"preserve":Ce=this.currentUrlTree.queryParams;break;default:Ce=M||null}return null!==Ce&&(Ce=this.removeEmptyProps(Ce)),KT(ie,this.currentUrlTree,p,Ce,null!=ye?ye:null)}},{key:"navigateByUrl",value:function(p){var m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1},S=N0(p)?p:this.parseUrl(p),M=this.urlHandlingStrategy.merge(S,this.rawUrlTree);return this.scheduleNavigation(M,"imperative",null,m)}},{key:"navigate",value:function(p){var m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{skipLocationChange:!1};return nR(p),this.navigateByUrl(this.createUrlTree(p,m),m)}},{key:"serializeUrl",value:function(p){return this.urlSerializer.serialize(p)}},{key:"parseUrl",value:function(p){var m;try{m=this.urlSerializer.parse(p)}catch(S){m=this.malformedUriErrorHandler(S,this.urlSerializer,p)}return m}},{key:"isActive",value:function(p,m){var S;if(S=!0===m?Object.assign({},tR):!1===m?Object.assign({},rR):m,N0(p))return V_(this.currentUrlTree,p,S);var M=this.parseUrl(p);return V_(this.currentUrlTree,M,S)}},{key:"removeEmptyProps",value:function(p){return Object.keys(p).reduce(function(m,S){var M=p[S];return null!=M&&(m[S]=M),m},{})}},{key:"processNavigations",value:function(){var p=this;this.navigations.subscribe(function(m){p.navigated=!0,p.lastSuccessfulId=m.id,p.currentPageId=m.targetPageId,p.events.next(new Yh(m.id,p.serializeUrl(m.extractedUrl),p.serializeUrl(p.currentUrlTree))),p.lastSuccessfulNavigation=p.currentNavigation,m.resolve(!0)},function(m){p.console.warn("Unhandled Navigation Error: ".concat(m))})}},{key:"scheduleNavigation",value:function(p,m,S,M,P){var N,G,ie;if(this.disposed)return Promise.resolve(!1);var tt,et,Ze,ye=this.transitions.value,Ce=c1(m)&&ye&&!c1(ye.source),Le=ye.rawUrl.toString()===p.toString(),qe=ye.id===(null===(N=this.currentNavigation)||void 0===N?void 0:N.id);if(Ce&&Le&&qe)return Promise.resolve(!0);P?(tt=P.resolve,et=P.reject,Ze=P.promise):Ze=new Promise(function(nr,yr){tt=nr,et=yr});var At,ht=++this.navigationId;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(S=this.location.getState()),At=S&&S.\u0275routerPageId?S.\u0275routerPageId:M.replaceUrl||M.skipLocationChange?null!==(G=this.browserPageId)&&void 0!==G?G:0:(null!==(ie=this.browserPageId)&&void 0!==ie?ie:0)+1):At=0,this.setTransition({id:ht,targetPageId:At,source:m,restoredState:S,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:p,extras:M,resolve:tt,reject:et,promise:Ze,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),Ze.catch(function(nr){return Promise.reject(nr)})}},{key:"setBrowserUrl",value:function(p,m){var S=this.urlSerializer.serialize(p),M=Object.assign(Object.assign({},m.extras.state),this.generateNgRouterState(m.id,m.targetPageId));this.location.isCurrentPathEqualTo(S)||m.extras.replaceUrl?this.location.replaceState(S,"",M):this.location.go(S,"",M)}},{key:"restoreHistory",value:function(p){var S,M,m=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("computed"===this.canceledNavigationResolution){var P=this.currentPageId-p.targetPageId,N="popstate"===p.source||"eager"===this.urlUpdateStrategy||this.currentUrlTree===(null===(S=this.currentNavigation)||void 0===S?void 0:S.finalUrl);N&&0!==P?this.location.historyGo(P):this.currentUrlTree===(null===(M=this.currentNavigation)||void 0===M?void 0:M.finalUrl)&&0===P&&(this.resetState(p),this.browserUrlTree=p.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(m&&this.resetState(p),this.resetUrlToCurrentUrlTree())}},{key:"resetState",value:function(p){this.routerState=p.currentRouterState,this.currentUrlTree=p.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,p.rawUrl)}},{key:"resetUrlToCurrentUrlTree",value:function(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}},{key:"cancelNavigationTransition",value:function(p,m){var S=new O_(p.id,this.serializeUrl(p.extractedUrl),m);this.triggerEvent(S),p.resolve(!1)}},{key:"generateNgRouterState",value:function(p,m){return"computed"===this.canceledNavigationResolution?{navigationId:p,"\u0275routerPageId":m}:{navigationId:p}}}]),u}();return o.\u0275fac=function(l){Ah()},o.\u0275prov=ln({token:o,factory:o.\u0275fac}),o}();function nR(o){for(var u=0;u<o.length;u++){var l=o[u];if(null==l)throw new Error("The requested path contains ".concat(l," segment at index ").concat(u))}}function c1(o){return"imperative"!==o}var l4=function(){var o=function(){function u(l,p,m,S,M){_(this,u),this.router=l,this.route=p,this.tabIndexAttribute=m,this.renderer=S,this.el=M,this.commands=null,this.onChanges=new He,this.setTabIndexIfNotOnNativeEl("0")}return w(u,[{key:"setTabIndexIfNotOnNativeEl",value:function(p){if(null==this.tabIndexAttribute){var m=this.renderer,S=this.el.nativeElement;null!==p?m.setAttribute(S,"tabindex",p):m.removeAttribute(S,"tabindex")}}},{key:"ngOnChanges",value:function(p){this.onChanges.next(this)}},{key:"routerLink",set:function(p){null!=p?(this.commands=Array.isArray(p)?p:[p],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}},{key:"onClick",value:function(){if(null===this.urlTree)return!0;var p={skipLocationChange:Af(this.skipLocationChange),replaceUrl:Af(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,p),!0}},{key:"urlTree",get:function(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:Af(this.preserveFragment)})}}]),u}();return o.\u0275fac=function(l){return new(l||o)(dr(Ho),dr(Ys),Hl("tabindex"),dr(bm),dr(Hs))},o.\u0275dir=no({type:o,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(l,p){1&l&&rt("click",function(){return p.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[Oa]}),o}(),ws=function(){var o=function(){function u(l,p,m){var S=this;_(this,u),this.router=l,this.route=p,this.locationStrategy=m,this.commands=null,this.href=null,this.onChanges=new He,this.subscription=l.events.subscribe(function(M){M instanceof Yh&&S.updateTargetUrlAndHref()})}return w(u,[{key:"routerLink",set:function(p){this.commands=null!=p?Array.isArray(p)?p:[p]:null}},{key:"ngOnChanges",value:function(p){this.updateTargetUrlAndHref(),this.onChanges.next(this)}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"onClick",value:function(p,m,S,M,P){if(0!==p||m||S||M||P||"string"==typeof this.target&&"_self"!=this.target||null===this.urlTree)return!0;var N={skipLocationChange:Af(this.skipLocationChange),replaceUrl:Af(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,N),!1}},{key:"updateTargetUrlAndHref",value:function(){this.href=null!==this.urlTree?this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null}},{key:"urlTree",get:function(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:Af(this.preserveFragment)})}}]),u}();return o.\u0275fac=function(l){return new(l||o)(dr(Ho),dr(Ys),dr(Cf))},o.\u0275dir=no({type:o,selectors:[["a","routerLink",""],["area","routerLink",""]],hostVars:2,hostBindings:function(l,p){1&l&&rt("click",function(S){return p.onClick(S.button,S.ctrlKey,S.shiftKey,S.altKey,S.metaKey)}),2&l&&mh("target",p.target)("href",p.href,qi)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[Oa]}),o}();function Af(o){return""===o||!!o}var x8=function(){var o=function(){function u(l,p,m,S,M,P){var N=this;_(this,u),this.router=l,this.element=p,this.renderer=m,this.cdr=S,this.link=M,this.linkWithHref=P,this.classes=[],this.isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new mt,this.routerEventsSubscription=l.events.subscribe(function(G){G instanceof Yh&&N.update()})}return w(u,[{key:"ngAfterContentInit",value:function(){var p=this;an(this.links.changes,this.linksWithHrefs.changes,an(null)).pipe(Zt()).subscribe(function(m){p.update(),p.subscribeToEachLinkOnChanges()})}},{key:"subscribeToEachLinkOnChanges",value:function(){var m,p=this;null===(m=this.linkInputChangesSubscription)||void 0===m||m.unsubscribe();var S=[].concat(U(this.links.toArray()),U(this.linksWithHrefs.toArray()),[this.link,this.linkWithHref]).filter(function(M){return!!M}).map(function(M){return M.onChanges});this.linkInputChangesSubscription=Ve(S).pipe(Zt()).subscribe(function(M){p.isActive!==p.isLinkActive(p.router)(M)&&p.update()})}},{key:"routerLinkActive",set:function(p){var m=Array.isArray(p)?p:p.split(" ");this.classes=m.filter(function(S){return!!S})}},{key:"ngOnChanges",value:function(p){this.update()}},{key:"ngOnDestroy",value:function(){var p;this.routerEventsSubscription.unsubscribe(),null===(p=this.linkInputChangesSubscription)||void 0===p||p.unsubscribe()}},{key:"update",value:function(){var p=this;!this.links||!this.linksWithHrefs||!this.router.navigated||Promise.resolve().then(function(){var m=p.hasActiveLinks();p.isActive!==m&&(p.isActive=m,p.cdr.markForCheck(),p.classes.forEach(function(S){m?p.renderer.addClass(p.element.nativeElement,S):p.renderer.removeClass(p.element.nativeElement,S)}),p.isActiveChange.emit(m))})}},{key:"isLinkActive",value:function(p){var m=function(o){return!!o.paths}(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return function(S){return!!S.urlTree&&p.isActive(S.urlTree,m)}}},{key:"hasActiveLinks",value:function(){var p=this.isLinkActive(this.router);return this.link&&p(this.link)||this.linkWithHref&&p(this.linkWithHref)||this.links.some(p)||this.linksWithHrefs.some(p)}}]),u}();return o.\u0275fac=function(l){return new(l||o)(dr(Ho),dr(Hs),dr(bm),dr(u9),dr(l4,8),dr(ws,8))},o.\u0275dir=no({type:o,selectors:[["","routerLinkActive",""]],contentQueries:function(l,p,m){var S;1&l&&(Ih(m,l4,5),Ih(m,ws,5)),2&l&&(Nh(S=kh())&&(p.links=S),Nh(S=kh())&&(p.linksWithHrefs=S))},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],features:[Oa]}),o}(),b8=function o(){_(this,o)},oR=function(){function o(){_(this,o)}return w(o,[{key:"preload",value:function(l,p){return p().pipe(Au(function(){return an(null)}))}}]),o}(),A8=function(){function o(){_(this,o)}return w(o,[{key:"preload",value:function(l,p){return an(null)}}]),o}(),M8=function(){var o=function(){function u(l,p,m,S){_(this,u),this.router=l,this.injector=m,this.preloadingStrategy=S,this.loader=new _8(m,p,function(G){return l.triggerEvent(new P_(G))},function(G){return l.triggerEvent(new F_(G))})}return w(u,[{key:"setUpPreloading",value:function(){var p=this;this.subscription=this.router.events.pipe(O0(function(m){return m instanceof Yh}),wf(function(){return p.preload()})).subscribe(function(){})}},{key:"preload",value:function(){var p=this.injector.get(Cl);return this.processRoutes(p,this.router.config)}},{key:"ngOnDestroy",value:function(){this.subscription&&this.subscription.unsubscribe()}},{key:"processRoutes",value:function(p,m){var P,S=[],M=I(m);try{for(M.s();!(P=M.n()).done;){var N=P.value;if(N.loadChildren&&!N.canLoad&&N._loadedConfig){var G=N._loadedConfig;S.push(this.processRoutes(G.module,G.routes))}else N.loadChildren&&!N.canLoad?S.push(this.preloadConfig(p,N)):N.children&&S.push(this.processRoutes(p,N.children))}}catch(ie){M.e(ie)}finally{M.f()}return Ve(S).pipe(Zt(),yt(function(ie){}))}},{key:"preloadConfig",value:function(p,m){var S=this;return this.preloadingStrategy.preload(m,function(){return(m._loadedConfig?an(m._loadedConfig):S.loader.load(p.injector,m)).pipe(Xt(function(P){return m._loadedConfig=P,S.processRoutes(P.module,P.routes)}))})}}]),u}();return o.\u0275fac=function(l){return new(l||o)(Rr(Ho),Rr(Fm),Rr(lo),Rr(b8))},o.\u0275prov=ln({token:o,factory:o.\u0275fac}),o}(),u4=function(){var o=function(){function u(l,p){var m=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_(this,u),this.router=l,this.viewportScroller=p,this.options=m,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},m.scrollPositionRestoration=m.scrollPositionRestoration||"disabled",m.anchorScrolling=m.anchorScrolling||"disabled"}return w(u,[{key:"init",value:function(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}},{key:"createScrollEvents",value:function(){var p=this;return this.router.events.subscribe(function(m){m instanceof j9?(p.store[p.lastId]=p.viewportScroller.getScrollPosition(),p.lastSource=m.navigationTrigger,p.restoredId=m.restoredState?m.restoredState.navigationId:0):m instanceof Yh&&(p.lastId=m.id,p.scheduleScrollEvent(m,p.router.parseUrl(m.urlAfterRedirects).fragment))})}},{key:"consumeScrollEvents",value:function(){var p=this;return this.router.events.subscribe(function(m){m instanceof L_&&(m.position?"top"===p.options.scrollPositionRestoration?p.viewportScroller.scrollToPosition([0,0]):"enabled"===p.options.scrollPositionRestoration&&p.viewportScroller.scrollToPosition(m.position):m.anchor&&"enabled"===p.options.anchorScrolling?p.viewportScroller.scrollToAnchor(m.anchor):"disabled"!==p.options.scrollPositionRestoration&&p.viewportScroller.scrollToPosition([0,0]))})}},{key:"scheduleScrollEvent",value:function(p,m){this.router.triggerEvent(new L_(p,"popstate"===this.lastSource?this.store[this.restoredId]:null,m))}},{key:"ngOnDestroy",value:function(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}]),u}();return o.\u0275fac=function(l){Ah()},o.\u0275prov=ln({token:o,factory:o.\u0275fac}),o}(),I0=new xn("ROUTER_CONFIGURATION"),T8=new xn("ROUTER_FORROOT_GUARD"),aR=[m9,{provide:z_,useClass:j_},{provide:Ho,useFactory:function(o,u,l,p,m,S){var M=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},P=arguments.length>7?arguments[7]:void 0,N=arguments.length>8?arguments[8]:void 0,G=new Ho(null,o,u,l,p,m,k_(S));return P&&(G.urlHandlingStrategy=P),N&&(G.routeReuseStrategy=N),hR(M,G),M.enableTracing&&G.events.subscribe(function(ie){var ye,Ce;null===(ye=console.group)||void 0===ye||ye.call(console,"Router Event: ".concat(ie.constructor.name)),console.log(ie.toString()),console.log(ie),null===(Ce=console.groupEnd)||void 0===Ce||Ce.call(console)}),G},deps:[z_,ep,m9,lo,Fm,s4,I0,[function o(){_(this,o)},new Ba],[function o(){_(this,o)},new Ba]]},ep,{provide:Ys,useFactory:function(o){return o.routerState.root},deps:[Ho]},M8,A8,oR,{provide:I0,useValue:{enableTracing:!1}}];function sR(){return new mw("Router",Ho)}var lR=function(){var o=function(){function u(l,p){_(this,u)}return w(u,null,[{key:"forRoot",value:function(p,m){return{ngModule:u,providers:[aR,E8(p),{provide:T8,useFactory:fR,deps:[[Ho,new Ba,new Ql]]},{provide:I0,useValue:m||{}},{provide:Cf,useFactory:cR,deps:[D0,[new r0(g9),new Ba],I0]},{provide:u4,useFactory:uR,deps:[Ho,KA,I0]},{provide:b8,useExisting:m&&m.preloadingStrategy?m.preloadingStrategy:A8},{provide:mw,multi:!0,useFactory:sR},[c4,{provide:Om,multi:!0,useFactory:vR,deps:[c4]},{provide:R8,useFactory:gR,deps:[c4]},{provide:cw,multi:!0,useExisting:R8}]]}}},{key:"forChild",value:function(p){return{ngModule:u,providers:[E8(p)]}}}]),u}();return o.\u0275fac=function(l){return new(l||o)(Rr(T8,8),Rr(Ho,8))},o.\u0275mod=ji({type:o}),o.\u0275inj=zo({}),o}();function uR(o,u,l){return l.scrollOffset&&u.setOffset(l.scrollOffset),new u4(o,u,l)}function cR(o,u){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return l.useHash?new Ob(o,u):new kw(o,u)}function fR(o){return"guarded"}function E8(o){return[{provide:nd,multi:!0,useValue:o},{provide:s4,multi:!0,useValue:o}]}function hR(o,u){o.errorHandler&&(u.errorHandler=o.errorHandler),o.malformedUriErrorHandler&&(u.malformedUriErrorHandler=o.malformedUriErrorHandler),o.onSameUrlNavigation&&(u.onSameUrlNavigation=o.onSameUrlNavigation),o.paramsInheritanceStrategy&&(u.paramsInheritanceStrategy=o.paramsInheritanceStrategy),o.relativeLinkResolution&&(u.relativeLinkResolution=o.relativeLinkResolution),o.urlUpdateStrategy&&(u.urlUpdateStrategy=o.urlUpdateStrategy),o.canceledNavigationResolution&&(u.canceledNavigationResolution=o.canceledNavigationResolution)}var c4=function(){var o=function(){function u(l){_(this,u),this.injector=l,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new He}return w(u,[{key:"appInitializer",value:function(){var p=this;return this.injector.get(Eb,Promise.resolve(null)).then(function(){if(p.destroyed)return Promise.resolve(!0);var S=null,M=new Promise(function(G){return S=G}),P=p.injector.get(Ho),N=p.injector.get(I0);return"disabled"===N.initialNavigation?(P.setUpLocationChangeListener(),S(!0)):"enabled"===N.initialNavigation||"enabledBlocking"===N.initialNavigation?(P.hooks.afterPreactivation=function(){return p.initNavigation?an(null):(p.initNavigation=!0,S(!0),p.resultOfPreactivationDone)},P.initialNavigation()):S(!0),M})}},{key:"bootstrapListener",value:function(p){var m=this.injector.get(I0),S=this.injector.get(M8),M=this.injector.get(u4),P=this.injector.get(Ho),N=this.injector.get(Vh);p===N.components[0]&&(("enabledNonBlocking"===m.initialNavigation||void 0===m.initialNavigation)&&P.initialNavigation(),S.setUpPreloading(),M.init(),P.resetRootComponentType(N.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}},{key:"ngOnDestroy",value:function(){this.destroyed=!0}}]),u}();return o.\u0275fac=function(l){return new(l||o)(Rr(lo))},o.\u0275prov=ln({token:o,factory:o.\u0275fac}),o}();function vR(o){return o.appInitializer.bind(o)}function gR(o){return o.bootstrapListener.bind(o)}var R8=new xn("Router Initializer");function Ae(o,u,l,p){var M,m=arguments.length,S=m<3?u:null===p?p=Object.getOwnPropertyDescriptor(u,l):p;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)S=Reflect.decorate(o,u,l,p);else for(var P=o.length-1;P>=0;P--)(M=o[P])&&(S=(m<3?M(S):m>3?M(u,l,S):M(u,l))||S);return m>3&&S&&Object.defineProperty(u,l,S),S}function Me(o,u){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(o,u)}var d4,k0=a(564),Mt=d4=function(){function o(){_(this,o)}return w(o,[{key:"hasChildColumns",value:function(){return!(!(this.childColumns&&this.childColumns.length>0)||1===this.childColumns.length&&this.childColumns.first===this)}},{key:"toColDef",value:function(){var l=this.createColDefFromGridColumn(this);return this.hasChildColumns()&&(l.children=this.getChildColDefs(this.childColumns)),l}},{key:"getChildColDefs",value:function(l){return l.filter(function(p){return!p.hasChildColumns()}).map(function(p){return p.toColDef()})}},{key:"createColDefFromGridColumn",value:function(l){var m=function(o,u){var l={};for(var p in o)Object.prototype.hasOwnProperty.call(o,p)&&u.indexOf(p)<0&&(l[p]=o[p]);if(null!=o&&"function"==typeof Object.getOwnPropertySymbols){var m=0;for(p=Object.getOwnPropertySymbols(o);m<p.length;m++)u.indexOf(p[m])<0&&Object.prototype.propertyIsEnumerable.call(o,p[m])&&(l[p[m]]=o[p[m]])}return l}(l,["childColumns"]);return m}}]),o}();Mt.\u0275fac=function(u){return new(u||Mt)},Mt.\u0275cmp=Ei({type:Mt,selectors:[["ag-grid-column"]],contentQueries:function(u,l,p){var m;1&u&&Ih(p,d4,4),2&u&&Nh(m=kh())&&(l.childColumns=m)},inputs:{filterFramework:"filterFramework",filterParams:"filterParams",floatingFilterComponent:"floatingFilterComponent",floatingFilterComponentParams:"floatingFilterComponentParams",floatingFilterComponentFramework:"floatingFilterComponentFramework",filter:"filter",headerName:"headerName",headerValueGetter:"headerValueGetter",headerTooltip:"headerTooltip",headerClass:"headerClass",suppressHeaderKeyboardEvent:"suppressHeaderKeyboardEvent",columnGroupShow:"columnGroupShow",toolPanelClass:"toolPanelClass",suppressColumnsToolPanel:"suppressColumnsToolPanel",suppressFiltersToolPanel:"suppressFiltersToolPanel",tooltipComponent:"tooltipComponent",tooltipComponentFramework:"tooltipComponentFramework",tooltipComponentParams:"tooltipComponentParams",children:"children",groupId:"groupId",openByDefault:"openByDefault",marryChildren:"marryChildren",headerGroupComponent:"headerGroupComponent",headerGroupComponentFramework:"headerGroupComponentFramework",headerGroupComponentParams:"headerGroupComponentParams",colId:"colId",field:"field",type:"type",valueGetter:"valueGetter",valueFormatter:"valueFormatter",refData:"refData",keyCreator:"keyCreator",equals:"equals",tooltipField:"tooltipField",tooltipValueGetter:"tooltipValueGetter",checkboxSelection:"checkboxSelection",icons:"icons",suppressNavigable:"suppressNavigable",suppressKeyboardEvent:"suppressKeyboardEvent",suppressPaste:"suppressPaste",suppressFillHandle:"suppressFillHandle",hide:"hide",initialHide:"initialHide",lockVisible:"lockVisible",lockPosition:"lockPosition",suppressMovable:"suppressMovable",editable:"editable",valueSetter:"valueSetter",valueParser:"valueParser",cellEditor:"cellEditor",cellEditorFramework:"cellEditorFramework",cellEditorParams:"cellEditorParams",cellEditorSelector:"cellEditorSelector",singleClickEdit:"singleClickEdit",newValueHandler:"newValueHandler",cellEditorPopup:"cellEditorPopup",cellEditorPopupPosition:"cellEditorPopupPosition",onCellValueChanged:"onCellValueChanged",onCellClicked:"onCellClicked",onCellDoubleClicked:"onCellDoubleClicked",onCellContextMenu:"onCellContextMenu",getQuickFilterText:"getQuickFilterText",filterValueGetter:"filterValueGetter",floatingFilter:"floatingFilter",headerComponent:"headerComponent",headerComponentFramework:"headerComponentFramework",headerComponentParams:"headerComponentParams",menuTabs:"menuTabs",columnsMenuParams:"columnsMenuParams",suppressMenu:"suppressMenu",headerCheckboxSelection:"headerCheckboxSelection",headerCheckboxSelectionFilteredOnly:"headerCheckboxSelectionFilteredOnly",chartDataType:"chartDataType",pinned:"pinned",initialPinned:"initialPinned",lockPinned:"lockPinned",pinnedRowCellRenderer:"pinnedRowCellRenderer",pinnedRowCellRendererFramework:"pinnedRowCellRendererFramework",pinnedRowCellRendererParams:"pinnedRowCellRendererParams",pinnedRowValueFormatter:"pinnedRowValueFormatter",pivot:"pivot",initialPivot:"initialPivot",pivotIndex:"pivotIndex",initialPivotIndex:"initialPivotIndex",pivotComparator:"pivotComparator",enablePivot:"enablePivot",cellStyle:"cellStyle",cellClass:"cellClass",cellClassRules:"cellClassRules",cellRenderer:"cellRenderer",cellRendererFramework:"cellRendererFramework",cellRendererParams:"cellRendererParams",cellRendererSelector:"cellRendererSelector",autoHeight:"autoHeight",wrapText:"wrapText",enableCellChangeFlash:"enableCellChangeFlash",suppressCellFlash:"suppressCellFlash",rowDrag:"rowDrag",rowDragText:"rowDragText",dndSource:"dndSource",dndSourceOnRowDrag:"dndSourceOnRowDrag",rowGroup:"rowGroup",initialRowGroup:"initialRowGroup",rowGroupIndex:"rowGroupIndex",initialRowGroupIndex:"initialRowGroupIndex",enableRowGroup:"enableRowGroup",enableValue:"enableValue",aggFunc:"aggFunc",initialAggFunc:"initialAggFunc",allowedAggFuncs:"allowedAggFuncs",showRowGroup:"showRowGroup",sortable:"sortable",sort:"sort",initialSort:"initialSort",sortIndex:"sortIndex",initialSortIndex:"initialSortIndex",sortingOrder:"sortingOrder",comparator:"comparator",unSortIcon:"unSortIcon",sortedAt:"sortedAt",colSpan:"colSpan",rowSpan:"rowSpan",width:"width",initialWidth:"initialWidth",minWidth:"minWidth",maxWidth:"maxWidth",flex:"flex",initialFlex:"initialFlex",resizable:"resizable",suppressSizeToFit:"suppressSizeToFit",suppressAutoSize:"suppressAutoSize"},decls:0,vars:0,template:function(u,l){},encapsulation:2}),Ae([Xl(d4),Me("design:type",q3)],Mt.prototype,"childColumns",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"filterFramework",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"filterParams",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"floatingFilterComponent",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"floatingFilterComponentParams",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"floatingFilterComponentFramework",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"filter",void 0),Ae([Fe(),Me("design:type",String)],Mt.prototype,"headerName",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"headerValueGetter",void 0),Ae([Fe(),Me("design:type",String)],Mt.prototype,"headerTooltip",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"headerClass",void 0),Ae([Fe(),Me("design:type",Function)],Mt.prototype,"suppressHeaderKeyboardEvent",void 0),Ae([Fe(),Me("design:type",String)],Mt.prototype,"columnGroupShow",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"toolPanelClass",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"suppressColumnsToolPanel",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"suppressFiltersToolPanel",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"tooltipComponent",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"tooltipComponentFramework",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"tooltipComponentParams",void 0),Ae([Fe(),Me("design:type",Array)],Mt.prototype,"children",void 0),Ae([Fe(),Me("design:type",String)],Mt.prototype,"groupId",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"openByDefault",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"marryChildren",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"headerGroupComponent",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"headerGroupComponentFramework",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"headerGroupComponentParams",void 0),Ae([Fe(),Me("design:type",String)],Mt.prototype,"colId",void 0),Ae([Fe(),Me("design:type",String)],Mt.prototype,"field",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"type",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"valueGetter",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"valueFormatter",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"refData",void 0),Ae([Fe(),Me("design:type",Function)],Mt.prototype,"keyCreator",void 0),Ae([Fe(),Me("design:type",Function)],Mt.prototype,"equals",void 0),Ae([Fe(),Me("design:type",String)],Mt.prototype,"tooltipField",void 0),Ae([Fe(),Me("design:type",Function)],Mt.prototype,"tooltipValueGetter",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"checkboxSelection",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"icons",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"suppressNavigable",void 0),Ae([Fe(),Me("design:type",Function)],Mt.prototype,"suppressKeyboardEvent",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"suppressPaste",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"suppressFillHandle",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"hide",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"initialHide",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"lockVisible",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"lockPosition",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"suppressMovable",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"editable",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"valueSetter",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"valueParser",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"cellEditor",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"cellEditorFramework",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"cellEditorParams",void 0),Ae([Fe(),Me("design:type",Function)],Mt.prototype,"cellEditorSelector",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"singleClickEdit",void 0),Ae([Fe(),Me("design:type",Function)],Mt.prototype,"newValueHandler",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"cellEditorPopup",void 0),Ae([Fe(),Me("design:type",String)],Mt.prototype,"cellEditorPopupPosition",void 0),Ae([Fe(),Me("design:type",Function)],Mt.prototype,"onCellValueChanged",void 0),Ae([Fe(),Me("design:type",Function)],Mt.prototype,"onCellClicked",void 0),Ae([Fe(),Me("design:type",Function)],Mt.prototype,"onCellDoubleClicked",void 0),Ae([Fe(),Me("design:type",Function)],Mt.prototype,"onCellContextMenu",void 0),Ae([Fe(),Me("design:type",Function)],Mt.prototype,"getQuickFilterText",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"filterValueGetter",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"floatingFilter",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"headerComponent",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"headerComponentFramework",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"headerComponentParams",void 0),Ae([Fe(),Me("design:type",Array)],Mt.prototype,"menuTabs",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"columnsMenuParams",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"suppressMenu",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"headerCheckboxSelection",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"headerCheckboxSelectionFilteredOnly",void 0),Ae([Fe(),Me("design:type",String)],Mt.prototype,"chartDataType",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"pinned",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"initialPinned",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"lockPinned",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"pinnedRowCellRenderer",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"pinnedRowCellRendererFramework",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"pinnedRowCellRendererParams",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"pinnedRowValueFormatter",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"pivot",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"initialPivot",void 0),Ae([Fe(),Me("design:type",Number)],Mt.prototype,"pivotIndex",void 0),Ae([Fe(),Me("design:type",Number)],Mt.prototype,"initialPivotIndex",void 0),Ae([Fe(),Me("design:type",Function)],Mt.prototype,"pivotComparator",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"enablePivot",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"cellStyle",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"cellClass",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"cellClassRules",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"cellRenderer",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"cellRendererFramework",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"cellRendererParams",void 0),Ae([Fe(),Me("design:type",Function)],Mt.prototype,"cellRendererSelector",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"autoHeight",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"wrapText",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"enableCellChangeFlash",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"suppressCellFlash",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"rowDrag",void 0),Ae([Fe(),Me("design:type",Function)],Mt.prototype,"rowDragText",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"dndSource",void 0),Ae([Fe(),Me("design:type",Function)],Mt.prototype,"dndSourceOnRowDrag",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"rowGroup",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"initialRowGroup",void 0),Ae([Fe(),Me("design:type",Number)],Mt.prototype,"rowGroupIndex",void 0),Ae([Fe(),Me("design:type",Number)],Mt.prototype,"initialRowGroupIndex",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"enableRowGroup",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"enableValue",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"aggFunc",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"initialAggFunc",void 0),Ae([Fe(),Me("design:type",Array)],Mt.prototype,"allowedAggFuncs",void 0),Ae([Fe(),Me("design:type",Object)],Mt.prototype,"showRowGroup",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"sortable",void 0),Ae([Fe(),Me("design:type",String)],Mt.prototype,"sort",void 0),Ae([Fe(),Me("design:type",String)],Mt.prototype,"initialSort",void 0),Ae([Fe(),Me("design:type",Number)],Mt.prototype,"sortIndex",void 0),Ae([Fe(),Me("design:type",Number)],Mt.prototype,"initialSortIndex",void 0),Ae([Fe(),Me("design:type",Array)],Mt.prototype,"sortingOrder",void 0),Ae([Fe(),Me("design:type",Function)],Mt.prototype,"comparator",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"unSortIcon",void 0),Ae([Fe(),Me("design:type",Number)],Mt.prototype,"sortedAt",void 0),Ae([Fe(),Me("design:type",Function)],Mt.prototype,"colSpan",void 0),Ae([Fe(),Me("design:type",Function)],Mt.prototype,"rowSpan",void 0),Ae([Fe(),Me("design:type",Number)],Mt.prototype,"width",void 0),Ae([Fe(),Me("design:type",Number)],Mt.prototype,"initialWidth",void 0),Ae([Fe(),Me("design:type",Number)],Mt.prototype,"minWidth",void 0),Ae([Fe(),Me("design:type",Number)],Mt.prototype,"maxWidth",void 0),Ae([Fe(),Me("design:type",Number)],Mt.prototype,"flex",void 0),Ae([Fe(),Me("design:type",Number)],Mt.prototype,"initialFlex",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"resizable",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"suppressSizeToFit",void 0),Ae([Fe(),Me("design:type",Boolean)],Mt.prototype,"suppressAutoSize",void 0);var v4,h4=function(){var o=function(u){b(p,u);var l=D(p);function p(m){var S;return _(this,p),(S=l.call(this))._ngZone=m,S}return w(p,[{key:"setEmitterUsedCallback",value:function(S){this.isEmitterUsed=S}},{key:"setTimeout",value:function(S,M){this._ngZone?this._ngZone.runOutsideAngular(function(){window.setTimeout(function(){S()},M)}):window.setTimeout(function(){S()},M)}},{key:"setInterval",value:function(S,M){var P=this;return new k0.j_S(function(N){P._ngZone?P._ngZone.runOutsideAngular(function(){N(window.setInterval(function(){S()},M))}):N(window.setInterval(function(){S()},M))})}},{key:"addEventListener",value:function(S,M,P,N){this.isOutsideAngular(M)&&this._ngZone?this._ngZone.runOutsideAngular(function(){S.addEventListener(M,P,N)}):S.addEventListener(M,P,N)}},{key:"dispatchEvent",value:function(S,M){var P=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.isOutsideAngular(S)?this._ngZone?this._ngZone.runOutsideAngular(M):M():(this.isEmitterUsed(S)||P)&&(!eo.isInAngularZone()&&this._ngZone?this._ngZone.run(M):M())}}]),p}(k0.vA3);return o.\u0275fac=function(l){return new(l||o)(Rr(eo))},o.\u0275prov=ln({token:o,factory:function(l){return o.\u0275fac(l)}}),o=Ae([Me("design:paramtypes",[eo])],o)}(),p4=function(){var o=function(u){b(p,u);var l=D(p);function p(){return _(this,p),l.apply(this,arguments)}return w(p,[{key:"setViewContainerRef",value:function(S){this.viewContainerRef=S}},{key:"setComponentFactoryResolver",value:function(S){this.componentFactoryResolver=S}},{key:"createWrapper",value:function(S){var M=this,P=function(G){b(ye,G);var ie=D(ye);function ye(){return _(this,ye),ie.apply(this,arguments)}return w(ye,[{key:"init",value:function(Le){g(d(ye.prototype),"init",this).call(this,Le),this._componentRef.changeDetectorRef.detectChanges()}},{key:"createComponent",value:function(){return M.createComponent(S)}},{key:"hasMethod",value:function(Le){return null!=N.getFrameworkComponentInstance()[Le]}},{key:"callMethod",value:function(Le,qe){var nt=this.getFrameworkComponentInstance();return N.getFrameworkComponentInstance()[Le].apply(nt,qe)}},{key:"addMethod",value:function(Le,qe){N[Le]=qe}}]),ye}(wR),N=new P;return N}},{key:"createComponent",value:function(S){var M=this.componentFactoryResolver.resolveComponentFactory(S);return this.viewContainerRef.createComponent(M)}}]),p}(k0.Nk3);return o.\u0275fac=function(){var u;return function(p){return(u||(u=function(o){return Ya(function(){for(var u=o.prototype.constructor,l=u[jo]||rd(u),p=Object.prototype,m=Object.getPrototypeOf(o.prototype).constructor;m&&m!==p;){var S=m[jo]||rd(m);if(S&&S!==l)return S;m=Object.getPrototypeOf(m)}return function(M){return new M}})}(o)))(p||o)}}(),o.\u0275prov=ln({token:o,factory:function(l){return o.\u0275fac(l)}}),o}(),wR=function(){function o(){_(this,o)}return w(o,[{key:"init",value:function(l){this._params=l,this._componentRef=this.createComponent(),this._agAwareComponent=this._componentRef.instance,this._frameworkComponentInstance=this._componentRef.instance,this._eGui=this._componentRef.location.nativeElement,this._agAwareComponent.agInit(this._params)}},{key:"getGui",value:function(){return this._eGui}},{key:"destroy",value:function(){this._frameworkComponentInstance&&"function"==typeof this._frameworkComponentInstance.destroy&&this._frameworkComponentInstance.destroy(),this._componentRef&&this._componentRef.destroy()}},{key:"getFrameworkComponentInstance",value:function(){return this._frameworkComponentInstance}}]),o}(),P8=function(){var o=function(){function u(l,p,m,S,M){_(this,u),this.viewContainerRef=p,this.angularFrameworkOverrides=m,this.frameworkComponentWrapper=S,this.componentFactoryResolver=M,this._initialised=!1,this._destroyed=!1,this._fullyReady=k0.j_S.resolve(!0),this.statusBar=void 0,this.sideBar=void 0,this.suppressContextMenu=void 0,this.preventDefaultOnContextMenu=void 0,this.allowContextMenuWithControlKey=void 0,this.suppressMenuHide=void 0,this.enableBrowserTooltips=void 0,this.tooltipShowDelay=void 0,this.tooltipMouseTrack=void 0,this.popupParent=void 0,this.copyHeadersToClipboard=void 0,this.clipboardDeliminator=void 0,this.suppressCopyRowsToClipboard=void 0,this.suppressLastEmptyLineOnPaste=void 0,this.suppressClipboardPaste=void 0,this.suppressClipboardApi=void 0,this.columnDefs=void 0,this.defaultColDef=void 0,this.defaultColGroupDef=void 0,this.columnTypes=void 0,this.maintainColumnOrder=void 0,this.suppressFieldDotNotation=void 0,this.deltaColumnMode=void 0,this.applyColumnDefOrder=void 0,this.immutableColumns=void 0,this.suppressSetColumnStateEvents=void 0,this.suppressColumnStateEvents=void 0,this.colWidth=void 0,this.minColWidth=void 0,this.maxColWidth=void 0,this.headerHeight=void 0,this.groupHeaderHeight=void 0,this.floatingFiltersHeight=void 0,this.pivotHeaderHeight=void 0,this.pivotGroupHeaderHeight=void 0,this.allowDragFromColumnsToolPanel=void 0,this.suppressMovableColumns=void 0,this.suppressColumnMoveAnimation=void 0,this.suppressDragLeaveHidesColumns=void 0,this.colResizeDefault=void 0,this.suppressAutoSize=void 0,this.autoSizePadding=void 0,this.skipHeaderOnAutoSize=void 0,this.components=void 0,this.frameworkComponents=void 0,this.reactUi=void 0,this.editType=void 0,this.singleClickEdit=void 0,this.suppressClickEdit=void 0,this.stopEditingWhenCellsLoseFocus=void 0,this.enterMovesDown=void 0,this.enterMovesDownAfterEdit=void 0,this.undoRedoCellEditing=void 0,this.undoRedoCellEditingLimit=void 0,this.stopEditingWhenGridLosesFocus=void 0,this.defaultCsvExportParams=void 0,this.suppressCsvExport=void 0,this.defaultExcelExportParams=void 0,this.suppressExcelExport=void 0,this.excelStyles=void 0,this.defaultExportParams=void 0,this.quickFilterText=void 0,this.cacheQuickFilter=void 0,this.excludeChildrenWhenTreeDataFiltering=void 0,this.floatingFilter=void 0,this.enableOldSetFilterModel=void 0,this.enableCharts=void 0,this.chartThemes=void 0,this.customChartThemes=void 0,this.chartThemeOverrides=void 0,this.loadingCellRenderer=void 0,this.loadingCellRendererFramework=void 0,this.loadingCellRendererParams=void 0,this.loadingCellRendererSelector=void 0,this.localeText=void 0,this.masterDetail=void 0,this.keepDetailRows=void 0,this.keepDetailRowsCount=void 0,this.detailCellRenderer=void 0,this.detailCellRendererFramework=void 0,this.detailCellRendererParams=void 0,this.detailRowHeight=void 0,this.detailRowAutoHeight=void 0,this.context=void 0,this.alignedGrids=void 0,this.tabIndex=void 0,this.rowBuffer=void 0,this.valueCache=void 0,this.valueCacheNeverExpires=void 0,this.enableCellExpressions=void 0,this.suppressParentsInRowNodes=void 0,this.suppressTouch=void 0,this.suppressFocusAfterRefresh=void 0,this.suppressAsyncEvents=void 0,this.suppressBrowserResizeObserver=void 0,this.suppressPropertyNamesCheck=void 0,this.suppressChangeDetection=void 0,this.debug=void 0,this.overlayLoadingTemplate=void 0,this.loadingOverlayComponent=void 0,this.loadingOverlayComponentFramework=void 0,this.loadingOverlayComponentParams=void 0,this.suppressLoadingOverlay=void 0,this.overlayNoRowsTemplate=void 0,this.noRowsOverlayComponent=void 0,this.noRowsOverlayComponentFramework=void 0,this.noRowsOverlayComponentParams=void 0,this.suppressNoRowsOverlay=void 0,this.pagination=void 0,this.paginationPageSize=void 0,this.paginationAutoPageSize=void 0,this.paginateChildRows=void 0,this.suppressPaginationPanel=void 0,this.pivotMode=void 0,this.pivotPanelShow=void 0,this.pivotColumnGroupTotals=void 0,this.pivotRowTotals=void 0,this.pivotSuppressAutoColumn=void 0,this.suppressExpandablePivotGroups=void 0,this.functionsReadOnly=void 0,this.aggFuncs=void 0,this.suppressAggFuncInHeader=void 0,this.suppressAggAtRootLevel=void 0,this.aggregateOnlyChangedColumns=void 0,this.suppressAggFilteredOnly=void 0,this.animateRows=void 0,this.enableCellChangeFlash=void 0,this.cellFlashDelay=void 0,this.cellFadeDelay=void 0,this.domLayout=void 0,this.ensureDomOrder=void 0,this.enableRtl=void 0,this.suppressColumnVirtualisation=void 0,this.suppressMaxRenderedRowRestriction=void 0,this.rowDragManaged=void 0,this.suppressRowDrag=void 0,this.suppressMoveWhenRowDragging=void 0,this.rowDragEntireRow=void 0,this.rowDragMultiRow=void 0,this.fullWidthCellRenderer=void 0,this.fullWidthCellRendererFramework=void 0,this.fullWidthCellRendererParams=void 0,this.embedFullWidthRows=void 0,this.deprecatedEmbedFullWidthRows=void 0,this.groupDisplayType=void 0,this.groupDefaultExpanded=void 0,this.autoGroupColumnDef=void 0,this.groupMaintainOrder=void 0,this.groupSelectsChildren=void 0,this.groupIncludeFooter=void 0,this.groupIncludeTotalFooter=void 0,this.groupSuppressBlankHeader=void 0,this.groupSelectsFiltered=void 0,this.showOpenedGroup=void 0,this.groupRemoveSingleChildren=void 0,this.groupRemoveLowestSingleChildren=void 0,this.groupHideOpenParents=void 0,this.rowGroupPanelShow=void 0,this.groupRowRenderer=void 0,this.groupRowRendererFramework=void 0,this.groupRowRendererParams=void 0,this.suppressMakeColumnVisibleAfterUnGroup=void 0,this.treeData=void 0,this.groupRowInnerRenderer=void 0,this.groupRowInnerRendererFramework=void 0,this.groupMultiAutoColumn=void 0,this.groupUseEntireRow=void 0,this.groupSuppressAutoColumn=void 0,this.rememberGroupStateWhenNewData=void 0,this.pinnedTopRowData=void 0,this.pinnedBottomRowData=void 0,this.rowModelType=void 0,this.rowData=void 0,this.immutableData=void 0,this.asyncTransactionWaitMillis=void 0,this.suppressModelUpdateAfterUpdateTransaction=void 0,this.deltaRowDataMode=void 0,this.batchUpdateWaitMillis=void 0,this.datasource=void 0,this.cacheOverflowSize=void 0,this.infiniteInitialRowCount=void 0,this.serverSideStoreType=void 0,this.cacheBlockSize=void 0,this.maxBlocksInCache=void 0,this.maxConcurrentDatasourceRequests=void 0,this.blockLoadDebounceMillis=void 0,this.purgeClosedRowNodes=void 0,this.serverSideDatasource=void 0,this.serverSideSortingAlwaysResets=void 0,this.serverSideFilteringAlwaysResets=void 0,this.suppressEnterpriseResetOnNewColumns=void 0,this.viewportDatasource=void 0,this.viewportRowModelPageSize=void 0,this.viewportRowModelBufferSize=void 0,this.alwaysShowHorizontalScroll=void 0,this.alwaysShowVerticalScroll=void 0,this.debounceVerticalScrollbar=void 0,this.suppressHorizontalScroll=void 0,this.suppressScrollOnNewData=void 0,this.suppressScrollWhenPopupsAreOpen=void 0,this.suppressAnimationFrame=void 0,this.suppressMiddleClickScrolls=void 0,this.suppressPreventDefaultOnMouseWheel=void 0,this.scrollbarWidth=void 0,this.rowSelection=void 0,this.rowMultiSelectWithClick=void 0,this.suppressRowDeselection=void 0,this.suppressRowClickSelection=void 0,this.suppressCellSelection=void 0,this.suppressMultiRangeSelection=void 0,this.enableCellTextSelection=void 0,this.enableRangeSelection=void 0,this.enableRangeHandle=void 0,this.enableFillHandle=void 0,this.fillHandleDirection=void 0,this.suppressClearOnFillReduction=void 0,this.sortingOrder=void 0,this.accentedSort=void 0,this.unSortIcon=void 0,this.suppressMultiSort=void 0,this.multiSortKey=void 0,this.suppressMaintainUnsortedOrder=void 0,this.icons=void 0,this.rowHeight=void 0,this.rowStyle=void 0,this.rowClass=void 0,this.rowClassRules=void 0,this.suppressRowHoverHighlight=void 0,this.suppressRowTransform=void 0,this.columnHoverHighlight=void 0,this.deltaSort=void 0,this.treeDataDisplayType=void 0,this.angularCompileRows=void 0,this.angularCompileFilters=void 0,this.functionsPassive=void 0,this.enableGroupEdit=void 0,this.getContextMenuItems=void 0,this.getMainMenuItems=void 0,this.postProcessPopup=void 0,this.processCellForClipboard=void 0,this.processHeaderForClipboard=void 0,this.processCellFromClipboard=void 0,this.sendToClipboard=void 0,this.processDataFromClipboard=void 0,this.isExternalFilterPresent=void 0,this.doesExternalFilterPass=void 0,this.getChartToolbarItems=void 0,this.createChartContainer=void 0,this.navigateToNextHeader=void 0,this.tabToNextHeader=void 0,this.navigateToNextCell=void 0,this.tabToNextCell=void 0,this.suppressKeyboardEvent=void 0,this.localeTextFunc=void 0,this.getDocument=void 0,this.paginationNumberFormatter=void 0,this.groupRowAggNodes=void 0,this.isGroupOpenByDefault=void 0,this.defaultGroupOrderComparator=void 0,this.processSecondaryColDef=void 0,this.processSecondaryColGroupDef=void 0,this.getDataPath=void 0,this.defaultGroupSortComparator=void 0,this.getChildCount=void 0,this.getServerSideStoreParams=void 0,this.isServerSideGroupOpenByDefault=void 0,this.isApplyServerSideTransaction=void 0,this.isServerSideGroup=void 0,this.getServerSideGroupKey=void 0,this.getBusinessKeyForNode=void 0,this.getRowNodeId=void 0,this.processRowPostCreate=void 0,this.isRowSelectable=void 0,this.isRowMaster=void 0,this.fillOperation=void 0,this.postSort=void 0,this.getRowStyle=void 0,this.getRowClass=void 0,this.getRowHeight=void 0,this.isFullWidthCell=void 0,this.toolPanelVisibleChanged=new mt,this.pasteStart=new mt,this.pasteEnd=new mt,this.columnVisible=new mt,this.columnPinned=new mt,this.columnResized=new mt,this.columnMoved=new mt,this.columnValueChanged=new mt,this.columnPivotModeChanged=new mt,this.columnPivotChanged=new mt,this.columnGroupOpened=new mt,this.newColumnsLoaded=new mt,this.gridColumnsChanged=new mt,this.displayedColumnsChanged=new mt,this.virtualColumnsChanged=new mt,this.columnEverythingChanged=new mt,this.componentStateChanged=new mt,this.cellValueChanged=new mt,this.rowValueChanged=new mt,this.cellEditingStarted=new mt,this.cellEditingStopped=new mt,this.rowEditingStarted=new mt,this.rowEditingStopped=new mt,this.filterOpened=new mt,this.filterChanged=new mt,this.filterModified=new mt,this.chartCreated=new mt,this.chartRangeSelectionChanged=new mt,this.chartOptionsChanged=new mt,this.chartDestroyed=new mt,this.cellKeyDown=new mt,this.cellKeyPress=new mt,this.gridReady=new mt,this.firstDataRendered=new mt,this.gridSizeChanged=new mt,this.modelUpdated=new mt,this.virtualRowRemoved=new mt,this.viewportChanged=new mt,this.bodyScroll=new mt,this.bodyScrollEnd=new mt,this.dragStarted=new mt,this.dragStopped=new mt,this.paginationChanged=new mt,this.rowDragEnter=new mt,this.rowDragMove=new mt,this.rowDragLeave=new mt,this.rowDragEnd=new mt,this.columnRowGroupChanged=new mt,this.rowGroupOpened=new mt,this.expandOrCollapseAll=new mt,this.pinnedRowDataChanged=new mt,this.rowDataChanged=new mt,this.rowDataUpdated=new mt,this.asyncTransactionsFlushed=new mt,this.cellClicked=new mt,this.cellDoubleClicked=new mt,this.cellFocused=new mt,this.cellMouseOver=new mt,this.cellMouseOut=new mt,this.cellMouseDown=new mt,this.rowClicked=new mt,this.rowDoubleClicked=new mt,this.rowSelected=new mt,this.selectionChanged=new mt,this.cellContextMenu=new mt,this.rangeSelectionChanged=new mt,this.sortChanged=new mt,this.columnRowGroupChangeRequest=new mt,this.columnPivotChangeRequest=new mt,this.columnValueChangeRequest=new mt,this.columnAggFuncChangeRequest=new mt,this._nativeElement=l.nativeElement}return w(u,[{key:"ngAfterViewInit",value:function(){this.frameworkComponentWrapper.setViewContainerRef(this.viewContainerRef),this.frameworkComponentWrapper.setComponentFactoryResolver(this.componentFactoryResolver),this.angularFrameworkOverrides.setEmitterUsedCallback(this.isEmitterUsed.bind(this)),this.gridOptions=k0.plv.copyAttributesToGridOptions(this.gridOptions,this,!0),this.gridParams={globalEventListener:this.globalEventListener.bind(this),frameworkOverrides:this.angularFrameworkOverrides,providedBeanInstances:{frameworkComponentWrapper:this.frameworkComponentWrapper},modules:this.modules||[]},this.columns&&this.columns.length>0&&(this.gridOptions.columnDefs=this.columns.map(function(p){return p.toColDef()})),new k0.rjZ(this._nativeElement,this.gridOptions,this.gridParams),this.gridOptions.api&&(this.api=this.gridOptions.api),this.gridOptions.columnApi&&(this.columnApi=this.gridOptions.columnApi),this._initialised=!0,this._fullyReady.resolveNow(null,function(p){return p})}},{key:"ngOnChanges",value:function(p){this._initialised&&k0.plv.processOnChange(p,this.gridOptions,this.api,this.columnApi)}},{key:"ngOnDestroy",value:function(){this._initialised&&(this._destroyed=!0,this.api&&this.api.destroy())}},{key:"isEmitterUsed",value:function(p){var m=this[p],S=!!m&&m.observers&&m.observers.length>0,M="on".concat(p.charAt(0).toUpperCase()).concat(p.substring(1));return S||!!this.gridOptions&&!!this.gridOptions[M]}},{key:"globalEventListener",value:function(p,m){if(!this._destroyed){var S=this[p];S&&this.isEmitterUsed(p)&&("gridReady"===p?this._fullyReady.then(function(M){S.emit(m)}):S.emit(m))}}}]),u}();return o.\u0275fac=function(l){return new(l||o)(dr(Hs),dr(Ca),dr(h4),dr(p4),dr(_u))},o.\u0275cmp=Ei({type:o,selectors:[["ag-grid-angular"]],contentQueries:function(l,p,m){var S;1&l&&Ih(m,Mt,4),2&l&&Nh(S=kh())&&(p.columns=S)},inputs:{statusBar:"statusBar",sideBar:"sideBar",suppressContextMenu:"suppressContextMenu",preventDefaultOnContextMenu:"preventDefaultOnContextMenu",allowContextMenuWithControlKey:"allowContextMenuWithControlKey",suppressMenuHide:"suppressMenuHide",enableBrowserTooltips:"enableBrowserTooltips",tooltipShowDelay:"tooltipShowDelay",tooltipMouseTrack:"tooltipMouseTrack",popupParent:"popupParent",copyHeadersToClipboard:"copyHeadersToClipboard",clipboardDeliminator:"clipboardDeliminator",suppressCopyRowsToClipboard:"suppressCopyRowsToClipboard",suppressLastEmptyLineOnPaste:"suppressLastEmptyLineOnPaste",suppressClipboardPaste:"suppressClipboardPaste",suppressClipboardApi:"suppressClipboardApi",columnDefs:"columnDefs",defaultColDef:"defaultColDef",defaultColGroupDef:"defaultColGroupDef",columnTypes:"columnTypes",maintainColumnOrder:"maintainColumnOrder",suppressFieldDotNotation:"suppressFieldDotNotation",deltaColumnMode:"deltaColumnMode",applyColumnDefOrder:"applyColumnDefOrder",immutableColumns:"immutableColumns",suppressSetColumnStateEvents:"suppressSetColumnStateEvents",suppressColumnStateEvents:"suppressColumnStateEvents",colWidth:"colWidth",minColWidth:"minColWidth",maxColWidth:"maxColWidth",headerHeight:"headerHeight",groupHeaderHeight:"groupHeaderHeight",floatingFiltersHeight:"floatingFiltersHeight",pivotHeaderHeight:"pivotHeaderHeight",pivotGroupHeaderHeight:"pivotGroupHeaderHeight",allowDragFromColumnsToolPanel:"allowDragFromColumnsToolPanel",suppressMovableColumns:"suppressMovableColumns",suppressColumnMoveAnimation:"suppressColumnMoveAnimation",suppressDragLeaveHidesColumns:"suppressDragLeaveHidesColumns",colResizeDefault:"colResizeDefault",suppressAutoSize:"suppressAutoSize",autoSizePadding:"autoSizePadding",skipHeaderOnAutoSize:"skipHeaderOnAutoSize",components:"components",frameworkComponents:"frameworkComponents",reactUi:"reactUi",editType:"editType",singleClickEdit:"singleClickEdit",suppressClickEdit:"suppressClickEdit",stopEditingWhenCellsLoseFocus:"stopEditingWhenCellsLoseFocus",enterMovesDown:"enterMovesDown",enterMovesDownAfterEdit:"enterMovesDownAfterEdit",undoRedoCellEditing:"undoRedoCellEditing",undoRedoCellEditingLimit:"undoRedoCellEditingLimit",stopEditingWhenGridLosesFocus:"stopEditingWhenGridLosesFocus",defaultCsvExportParams:"defaultCsvExportParams",suppressCsvExport:"suppressCsvExport",defaultExcelExportParams:"defaultExcelExportParams",suppressExcelExport:"suppressExcelExport",excelStyles:"excelStyles",defaultExportParams:"defaultExportParams",quickFilterText:"quickFilterText",cacheQuickFilter:"cacheQuickFilter",excludeChildrenWhenTreeDataFiltering:"excludeChildrenWhenTreeDataFiltering",floatingFilter:"floatingFilter",enableOldSetFilterModel:"enableOldSetFilterModel",enableCharts:"enableCharts",chartThemes:"chartThemes",customChartThemes:"customChartThemes",chartThemeOverrides:"chartThemeOverrides",loadingCellRenderer:"loadingCellRenderer",loadingCellRendererFramework:"loadingCellRendererFramework",loadingCellRendererParams:"loadingCellRendererParams",loadingCellRendererSelector:"loadingCellRendererSelector",localeText:"localeText",masterDetail:"masterDetail",keepDetailRows:"keepDetailRows",keepDetailRowsCount:"keepDetailRowsCount",detailCellRenderer:"detailCellRenderer",detailCellRendererFramework:"detailCellRendererFramework",detailCellRendererParams:"detailCellRendererParams",detailRowHeight:"detailRowHeight",detailRowAutoHeight:"detailRowAutoHeight",context:"context",alignedGrids:"alignedGrids",tabIndex:"tabIndex",rowBuffer:"rowBuffer",valueCache:"valueCache",valueCacheNeverExpires:"valueCacheNeverExpires",enableCellExpressions:"enableCellExpressions",suppressParentsInRowNodes:"suppressParentsInRowNodes",suppressTouch:"suppressTouch",suppressFocusAfterRefresh:"suppressFocusAfterRefresh",suppressAsyncEvents:"suppressAsyncEvents",suppressBrowserResizeObserver:"suppressBrowserResizeObserver",suppressPropertyNamesCheck:"suppressPropertyNamesCheck",suppressChangeDetection:"suppressChangeDetection",debug:"debug",overlayLoadingTemplate:"overlayLoadingTemplate",loadingOverlayComponent:"loadingOverlayComponent",loadingOverlayComponentFramework:"loadingOverlayComponentFramework",loadingOverlayComponentParams:"loadingOverlayComponentParams",suppressLoadingOverlay:"suppressLoadingOverlay",overlayNoRowsTemplate:"overlayNoRowsTemplate",noRowsOverlayComponent:"noRowsOverlayComponent",noRowsOverlayComponentFramework:"noRowsOverlayComponentFramework",noRowsOverlayComponentParams:"noRowsOverlayComponentParams",suppressNoRowsOverlay:"suppressNoRowsOverlay",pagination:"pagination",paginationPageSize:"paginationPageSize",paginationAutoPageSize:"paginationAutoPageSize",paginateChildRows:"paginateChildRows",suppressPaginationPanel:"suppressPaginationPanel",pivotMode:"pivotMode",pivotPanelShow:"pivotPanelShow",pivotColumnGroupTotals:"pivotColumnGroupTotals",pivotRowTotals:"pivotRowTotals",pivotSuppressAutoColumn:"pivotSuppressAutoColumn",suppressExpandablePivotGroups:"suppressExpandablePivotGroups",functionsReadOnly:"functionsReadOnly",aggFuncs:"aggFuncs",suppressAggFuncInHeader:"suppressAggFuncInHeader",suppressAggAtRootLevel:"suppressAggAtRootLevel",aggregateOnlyChangedColumns:"aggregateOnlyChangedColumns",suppressAggFilteredOnly:"suppressAggFilteredOnly",animateRows:"animateRows",enableCellChangeFlash:"enableCellChangeFlash",cellFlashDelay:"cellFlashDelay",cellFadeDelay:"cellFadeDelay",domLayout:"domLayout",ensureDomOrder:"ensureDomOrder",enableRtl:"enableRtl",suppressColumnVirtualisation:"suppressColumnVirtualisation",suppressMaxRenderedRowRestriction:"suppressMaxRenderedRowRestriction",rowDragManaged:"rowDragManaged",suppressRowDrag:"suppressRowDrag",suppressMoveWhenRowDragging:"suppressMoveWhenRowDragging",rowDragEntireRow:"rowDragEntireRow",rowDragMultiRow:"rowDragMultiRow",fullWidthCellRenderer:"fullWidthCellRenderer",fullWidthCellRendererFramework:"fullWidthCellRendererFramework",fullWidthCellRendererParams:"fullWidthCellRendererParams",embedFullWidthRows:"embedFullWidthRows",deprecatedEmbedFullWidthRows:"deprecatedEmbedFullWidthRows",groupDisplayType:"groupDisplayType",groupDefaultExpanded:"groupDefaultExpanded",autoGroupColumnDef:"autoGroupColumnDef",groupMaintainOrder:"groupMaintainOrder",groupSelectsChildren:"groupSelectsChildren",groupIncludeFooter:"groupIncludeFooter",groupIncludeTotalFooter:"groupIncludeTotalFooter",groupSuppressBlankHeader:"groupSuppressBlankHeader",groupSelectsFiltered:"groupSelectsFiltered",showOpenedGroup:"showOpenedGroup",groupRemoveSingleChildren:"groupRemoveSingleChildren",groupRemoveLowestSingleChildren:"groupRemoveLowestSingleChildren",groupHideOpenParents:"groupHideOpenParents",rowGroupPanelShow:"rowGroupPanelShow",groupRowRenderer:"groupRowRenderer",groupRowRendererFramework:"groupRowRendererFramework",groupRowRendererParams:"groupRowRendererParams",suppressMakeColumnVisibleAfterUnGroup:"suppressMakeColumnVisibleAfterUnGroup",treeData:"treeData",groupRowInnerRenderer:"groupRowInnerRenderer",groupRowInnerRendererFramework:"groupRowInnerRendererFramework",groupMultiAutoColumn:"groupMultiAutoColumn",groupUseEntireRow:"groupUseEntireRow",groupSuppressAutoColumn:"groupSuppressAutoColumn",rememberGroupStateWhenNewData:"rememberGroupStateWhenNewData",pinnedTopRowData:"pinnedTopRowData",pinnedBottomRowData:"pinnedBottomRowData",rowModelType:"rowModelType",rowData:"rowData",immutableData:"immutableData",asyncTransactionWaitMillis:"asyncTransactionWaitMillis",suppressModelUpdateAfterUpdateTransaction:"suppressModelUpdateAfterUpdateTransaction",deltaRowDataMode:"deltaRowDataMode",batchUpdateWaitMillis:"batchUpdateWaitMillis",datasource:"datasource",cacheOverflowSize:"cacheOverflowSize",infiniteInitialRowCount:"infiniteInitialRowCount",serverSideStoreType:"serverSideStoreType",cacheBlockSize:"cacheBlockSize",maxBlocksInCache:"maxBlocksInCache",maxConcurrentDatasourceRequests:"maxConcurrentDatasourceRequests",blockLoadDebounceMillis:"blockLoadDebounceMillis",purgeClosedRowNodes:"purgeClosedRowNodes",serverSideDatasource:"serverSideDatasource",serverSideSortingAlwaysResets:"serverSideSortingAlwaysResets",serverSideFilteringAlwaysResets:"serverSideFilteringAlwaysResets",suppressEnterpriseResetOnNewColumns:"suppressEnterpriseResetOnNewColumns",viewportDatasource:"viewportDatasource",viewportRowModelPageSize:"viewportRowModelPageSize",viewportRowModelBufferSize:"viewportRowModelBufferSize",alwaysShowHorizontalScroll:"alwaysShowHorizontalScroll",alwaysShowVerticalScroll:"alwaysShowVerticalScroll",debounceVerticalScrollbar:"debounceVerticalScrollbar",suppressHorizontalScroll:"suppressHorizontalScroll",suppressScrollOnNewData:"suppressScrollOnNewData",suppressScrollWhenPopupsAreOpen:"suppressScrollWhenPopupsAreOpen",suppressAnimationFrame:"suppressAnimationFrame",suppressMiddleClickScrolls:"suppressMiddleClickScrolls",suppressPreventDefaultOnMouseWheel:"suppressPreventDefaultOnMouseWheel",scrollbarWidth:"scrollbarWidth",rowSelection:"rowSelection",rowMultiSelectWithClick:"rowMultiSelectWithClick",suppressRowDeselection:"suppressRowDeselection",suppressRowClickSelection:"suppressRowClickSelection",suppressCellSelection:"suppressCellSelection",suppressMultiRangeSelection:"suppressMultiRangeSelection",enableCellTextSelection:"enableCellTextSelection",enableRangeSelection:"enableRangeSelection",enableRangeHandle:"enableRangeHandle",enableFillHandle:"enableFillHandle",fillHandleDirection:"fillHandleDirection",suppressClearOnFillReduction:"suppressClearOnFillReduction",sortingOrder:"sortingOrder",accentedSort:"accentedSort",unSortIcon:"unSortIcon",suppressMultiSort:"suppressMultiSort",multiSortKey:"multiSortKey",suppressMaintainUnsortedOrder:"suppressMaintainUnsortedOrder",icons:"icons",rowHeight:"rowHeight",rowStyle:"rowStyle",rowClass:"rowClass",rowClassRules:"rowClassRules",suppressRowHoverHighlight:"suppressRowHoverHighlight",suppressRowTransform:"suppressRowTransform",columnHoverHighlight:"columnHoverHighlight",deltaSort:"deltaSort",treeDataDisplayType:"treeDataDisplayType",angularCompileRows:"angularCompileRows",angularCompileFilters:"angularCompileFilters",functionsPassive:"functionsPassive",enableGroupEdit:"enableGroupEdit",getContextMenuItems:"getContextMenuItems",getMainMenuItems:"getMainMenuItems",postProcessPopup:"postProcessPopup",processCellForClipboard:"processCellForClipboard",processHeaderForClipboard:"processHeaderForClipboard",processCellFromClipboard:"processCellFromClipboard",sendToClipboard:"sendToClipboard",processDataFromClipboard:"processDataFromClipboard",isExternalFilterPresent:"isExternalFilterPresent",doesExternalFilterPass:"doesExternalFilterPass",getChartToolbarItems:"getChartToolbarItems",createChartContainer:"createChartContainer",navigateToNextHeader:"navigateToNextHeader",tabToNextHeader:"tabToNextHeader",navigateToNextCell:"navigateToNextCell",tabToNextCell:"tabToNextCell",suppressKeyboardEvent:"suppressKeyboardEvent",localeTextFunc:"localeTextFunc",getDocument:"getDocument",paginationNumberFormatter:"paginationNumberFormatter",groupRowAggNodes:"groupRowAggNodes",isGroupOpenByDefault:"isGroupOpenByDefault",defaultGroupOrderComparator:"defaultGroupOrderComparator",processSecondaryColDef:"processSecondaryColDef",processSecondaryColGroupDef:"processSecondaryColGroupDef",getDataPath:"getDataPath",defaultGroupSortComparator:"defaultGroupSortComparator",getChildCount:"getChildCount",getServerSideStoreParams:"getServerSideStoreParams",isServerSideGroupOpenByDefault:"isServerSideGroupOpenByDefault",isApplyServerSideTransaction:"isApplyServerSideTransaction",isServerSideGroup:"isServerSideGroup",getServerSideGroupKey:"getServerSideGroupKey",getBusinessKeyForNode:"getBusinessKeyForNode",getRowNodeId:"getRowNodeId",processRowPostCreate:"processRowPostCreate",isRowSelectable:"isRowSelectable",isRowMaster:"isRowMaster",fillOperation:"fillOperation",postSort:"postSort",getRowStyle:"getRowStyle",getRowClass:"getRowClass",getRowHeight:"getRowHeight",isFullWidthCell:"isFullWidthCell",gridOptions:"gridOptions",modules:"modules"},outputs:{toolPanelVisibleChanged:"toolPanelVisibleChanged",pasteStart:"pasteStart",pasteEnd:"pasteEnd",columnVisible:"columnVisible",columnPinned:"columnPinned",columnResized:"columnResized",columnMoved:"columnMoved",columnValueChanged:"columnValueChanged",columnPivotModeChanged:"columnPivotModeChanged",columnPivotChanged:"columnPivotChanged",columnGroupOpened:"columnGroupOpened",newColumnsLoaded:"newColumnsLoaded",gridColumnsChanged:"gridColumnsChanged",displayedColumnsChanged:"displayedColumnsChanged",virtualColumnsChanged:"virtualColumnsChanged",columnEverythingChanged:"columnEverythingChanged",componentStateChanged:"componentStateChanged",cellValueChanged:"cellValueChanged",rowValueChanged:"rowValueChanged",cellEditingStarted:"cellEditingStarted",cellEditingStopped:"cellEditingStopped",rowEditingStarted:"rowEditingStarted",rowEditingStopped:"rowEditingStopped",filterOpened:"filterOpened",filterChanged:"filterChanged",filterModified:"filterModified",chartCreated:"chartCreated",chartRangeSelectionChanged:"chartRangeSelectionChanged",chartOptionsChanged:"chartOptionsChanged",chartDestroyed:"chartDestroyed",cellKeyDown:"cellKeyDown",cellKeyPress:"cellKeyPress",gridReady:"gridReady",firstDataRendered:"firstDataRendered",gridSizeChanged:"gridSizeChanged",modelUpdated:"modelUpdated",virtualRowRemoved:"virtualRowRemoved",viewportChanged:"viewportChanged",bodyScroll:"bodyScroll",bodyScrollEnd:"bodyScrollEnd",dragStarted:"dragStarted",dragStopped:"dragStopped",paginationChanged:"paginationChanged",rowDragEnter:"rowDragEnter",rowDragMove:"rowDragMove",rowDragLeave:"rowDragLeave",rowDragEnd:"rowDragEnd",columnRowGroupChanged:"columnRowGroupChanged",rowGroupOpened:"rowGroupOpened",expandOrCollapseAll:"expandOrCollapseAll",pinnedRowDataChanged:"pinnedRowDataChanged",rowDataChanged:"rowDataChanged",rowDataUpdated:"rowDataUpdated",asyncTransactionsFlushed:"asyncTransactionsFlushed",cellClicked:"cellClicked",cellDoubleClicked:"cellDoubleClicked",cellFocused:"cellFocused",cellMouseOver:"cellMouseOver",cellMouseOut:"cellMouseOut",cellMouseDown:"cellMouseDown",rowClicked:"rowClicked",rowDoubleClicked:"rowDoubleClicked",rowSelected:"rowSelected",selectionChanged:"selectionChanged",cellContextMenu:"cellContextMenu",rangeSelectionChanged:"rangeSelectionChanged",sortChanged:"sortChanged",columnRowGroupChangeRequest:"columnRowGroupChangeRequest",columnPivotChangeRequest:"columnPivotChangeRequest",columnValueChangeRequest:"columnValueChangeRequest",columnAggFuncChangeRequest:"columnAggFuncChangeRequest"},features:[xC([h4,p4]),Oa],decls:0,vars:0,template:function(l,p){},encapsulation:2}),Ae([Xl(Mt),Me("design:type",q3)],o.prototype,"columns",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"gridOptions",void 0),Ae([Fe(),Me("design:type",Array)],o.prototype,"modules",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"statusBar",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"sideBar",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressContextMenu",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"preventDefaultOnContextMenu",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"allowContextMenuWithControlKey",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressMenuHide",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"enableBrowserTooltips",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"tooltipShowDelay",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"tooltipMouseTrack",void 0),Ae([Fe(),Me("design:type",HTMLElement)],o.prototype,"popupParent",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"copyHeadersToClipboard",void 0),Ae([Fe(),Me("design:type",String)],o.prototype,"clipboardDeliminator",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressCopyRowsToClipboard",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressLastEmptyLineOnPaste",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressClipboardPaste",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressClipboardApi",void 0),Ae([Fe(),Me("design:type",Array)],o.prototype,"columnDefs",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"defaultColDef",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"defaultColGroupDef",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"columnTypes",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"maintainColumnOrder",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressFieldDotNotation",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"deltaColumnMode",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"applyColumnDefOrder",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"immutableColumns",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressSetColumnStateEvents",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressColumnStateEvents",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"colWidth",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"minColWidth",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"maxColWidth",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"headerHeight",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"groupHeaderHeight",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"floatingFiltersHeight",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"pivotHeaderHeight",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"pivotGroupHeaderHeight",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"allowDragFromColumnsToolPanel",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressMovableColumns",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressColumnMoveAnimation",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressDragLeaveHidesColumns",void 0),Ae([Fe(),Me("design:type",String)],o.prototype,"colResizeDefault",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressAutoSize",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"autoSizePadding",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"skipHeaderOnAutoSize",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"components",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"frameworkComponents",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"reactUi",void 0),Ae([Fe(),Me("design:type",String)],o.prototype,"editType",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"singleClickEdit",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressClickEdit",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"stopEditingWhenCellsLoseFocus",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"enterMovesDown",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"enterMovesDownAfterEdit",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"undoRedoCellEditing",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"undoRedoCellEditingLimit",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"stopEditingWhenGridLosesFocus",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"defaultCsvExportParams",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressCsvExport",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"defaultExcelExportParams",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressExcelExport",void 0),Ae([Fe(),Me("design:type",Array)],o.prototype,"excelStyles",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"defaultExportParams",void 0),Ae([Fe(),Me("design:type",String)],o.prototype,"quickFilterText",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"cacheQuickFilter",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"excludeChildrenWhenTreeDataFiltering",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"floatingFilter",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"enableOldSetFilterModel",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"enableCharts",void 0),Ae([Fe(),Me("design:type",Array)],o.prototype,"chartThemes",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"customChartThemes",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"chartThemeOverrides",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"loadingCellRenderer",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"loadingCellRendererFramework",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"loadingCellRendererParams",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"loadingCellRendererSelector",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"localeText",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"masterDetail",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"keepDetailRows",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"keepDetailRowsCount",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"detailCellRenderer",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"detailCellRendererFramework",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"detailCellRendererParams",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"detailRowHeight",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"detailRowAutoHeight",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"context",void 0),Ae([Fe(),Me("design:type",Array)],o.prototype,"alignedGrids",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"tabIndex",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"rowBuffer",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"valueCache",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"valueCacheNeverExpires",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"enableCellExpressions",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressParentsInRowNodes",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressTouch",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressFocusAfterRefresh",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressAsyncEvents",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressBrowserResizeObserver",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressPropertyNamesCheck",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressChangeDetection",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"debug",void 0),Ae([Fe(),Me("design:type",String)],o.prototype,"overlayLoadingTemplate",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"loadingOverlayComponent",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"loadingOverlayComponentFramework",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"loadingOverlayComponentParams",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressLoadingOverlay",void 0),Ae([Fe(),Me("design:type",String)],o.prototype,"overlayNoRowsTemplate",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"noRowsOverlayComponent",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"noRowsOverlayComponentFramework",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"noRowsOverlayComponentParams",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressNoRowsOverlay",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"pagination",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"paginationPageSize",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"paginationAutoPageSize",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"paginateChildRows",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressPaginationPanel",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"pivotMode",void 0),Ae([Fe(),Me("design:type",String)],o.prototype,"pivotPanelShow",void 0),Ae([Fe(),Me("design:type",String)],o.prototype,"pivotColumnGroupTotals",void 0),Ae([Fe(),Me("design:type",String)],o.prototype,"pivotRowTotals",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"pivotSuppressAutoColumn",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressExpandablePivotGroups",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"functionsReadOnly",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"aggFuncs",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressAggFuncInHeader",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressAggAtRootLevel",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"aggregateOnlyChangedColumns",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressAggFilteredOnly",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"animateRows",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"enableCellChangeFlash",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"cellFlashDelay",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"cellFadeDelay",void 0),Ae([Fe(),Me("design:type",String)],o.prototype,"domLayout",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"ensureDomOrder",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"enableRtl",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressColumnVirtualisation",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressMaxRenderedRowRestriction",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"rowDragManaged",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressRowDrag",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressMoveWhenRowDragging",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"rowDragEntireRow",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"rowDragMultiRow",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"fullWidthCellRenderer",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"fullWidthCellRendererFramework",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"fullWidthCellRendererParams",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"embedFullWidthRows",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"deprecatedEmbedFullWidthRows",void 0),Ae([Fe(),Me("design:type",String)],o.prototype,"groupDisplayType",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"groupDefaultExpanded",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"autoGroupColumnDef",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"groupMaintainOrder",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"groupSelectsChildren",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"groupIncludeFooter",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"groupIncludeTotalFooter",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"groupSuppressBlankHeader",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"groupSelectsFiltered",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"showOpenedGroup",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"groupRemoveSingleChildren",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"groupRemoveLowestSingleChildren",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"groupHideOpenParents",void 0),Ae([Fe(),Me("design:type",String)],o.prototype,"rowGroupPanelShow",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"groupRowRenderer",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"groupRowRendererFramework",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"groupRowRendererParams",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressMakeColumnVisibleAfterUnGroup",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"treeData",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"groupRowInnerRenderer",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"groupRowInnerRendererFramework",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"groupMultiAutoColumn",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"groupUseEntireRow",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"groupSuppressAutoColumn",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"rememberGroupStateWhenNewData",void 0),Ae([Fe(),Me("design:type",Array)],o.prototype,"pinnedTopRowData",void 0),Ae([Fe(),Me("design:type",Array)],o.prototype,"pinnedBottomRowData",void 0),Ae([Fe(),Me("design:type",String)],o.prototype,"rowModelType",void 0),Ae([Fe(),Me("design:type",Array)],o.prototype,"rowData",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"immutableData",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"asyncTransactionWaitMillis",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressModelUpdateAfterUpdateTransaction",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"deltaRowDataMode",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"batchUpdateWaitMillis",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"datasource",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"cacheOverflowSize",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"infiniteInitialRowCount",void 0),Ae([Fe(),Me("design:type",String)],o.prototype,"serverSideStoreType",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"cacheBlockSize",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"maxBlocksInCache",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"maxConcurrentDatasourceRequests",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"blockLoadDebounceMillis",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"purgeClosedRowNodes",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"serverSideDatasource",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"serverSideSortingAlwaysResets",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"serverSideFilteringAlwaysResets",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressEnterpriseResetOnNewColumns",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"viewportDatasource",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"viewportRowModelPageSize",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"viewportRowModelBufferSize",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"alwaysShowHorizontalScroll",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"alwaysShowVerticalScroll",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"debounceVerticalScrollbar",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressHorizontalScroll",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressScrollOnNewData",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressScrollWhenPopupsAreOpen",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressAnimationFrame",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressMiddleClickScrolls",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressPreventDefaultOnMouseWheel",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"scrollbarWidth",void 0),Ae([Fe(),Me("design:type",String)],o.prototype,"rowSelection",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"rowMultiSelectWithClick",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressRowDeselection",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressRowClickSelection",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressCellSelection",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressMultiRangeSelection",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"enableCellTextSelection",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"enableRangeSelection",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"enableRangeHandle",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"enableFillHandle",void 0),Ae([Fe(),Me("design:type",String)],o.prototype,"fillHandleDirection",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressClearOnFillReduction",void 0),Ae([Fe(),Me("design:type",Array)],o.prototype,"sortingOrder",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"accentedSort",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"unSortIcon",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressMultiSort",void 0),Ae([Fe(),Me("design:type",String)],o.prototype,"multiSortKey",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressMaintainUnsortedOrder",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"icons",void 0),Ae([Fe(),Me("design:type",Number)],o.prototype,"rowHeight",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"rowStyle",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"rowClass",void 0),Ae([Fe(),Me("design:type",Object)],o.prototype,"rowClassRules",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressRowHoverHighlight",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"suppressRowTransform",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"columnHoverHighlight",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"deltaSort",void 0),Ae([Fe(),Me("design:type",String)],o.prototype,"treeDataDisplayType",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"angularCompileRows",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"angularCompileFilters",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"functionsPassive",void 0),Ae([Fe(),Me("design:type",Boolean)],o.prototype,"enableGroupEdit",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"getContextMenuItems",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"getMainMenuItems",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"postProcessPopup",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"processCellForClipboard",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"processHeaderForClipboard",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"processCellFromClipboard",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"sendToClipboard",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"processDataFromClipboard",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"isExternalFilterPresent",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"doesExternalFilterPass",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"getChartToolbarItems",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"createChartContainer",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"navigateToNextHeader",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"tabToNextHeader",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"navigateToNextCell",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"tabToNextCell",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"suppressKeyboardEvent",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"localeTextFunc",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"getDocument",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"paginationNumberFormatter",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"groupRowAggNodes",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"isGroupOpenByDefault",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"defaultGroupOrderComparator",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"processSecondaryColDef",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"processSecondaryColGroupDef",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"getDataPath",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"defaultGroupSortComparator",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"getChildCount",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"getServerSideStoreParams",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"isServerSideGroupOpenByDefault",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"isApplyServerSideTransaction",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"isServerSideGroup",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"getServerSideGroupKey",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"getBusinessKeyForNode",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"getRowNodeId",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"processRowPostCreate",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"isRowSelectable",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"isRowMaster",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"fillOperation",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"postSort",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"getRowStyle",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"getRowClass",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"getRowHeight",void 0),Ae([Fe(),Me("design:type",Function)],o.prototype,"isFullWidthCell",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"toolPanelVisibleChanged",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"pasteStart",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"pasteEnd",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"columnVisible",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"columnPinned",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"columnResized",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"columnMoved",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"columnValueChanged",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"columnPivotModeChanged",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"columnPivotChanged",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"columnGroupOpened",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"newColumnsLoaded",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"gridColumnsChanged",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"displayedColumnsChanged",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"virtualColumnsChanged",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"columnEverythingChanged",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"componentStateChanged",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"cellValueChanged",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"rowValueChanged",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"cellEditingStarted",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"cellEditingStopped",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"rowEditingStarted",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"rowEditingStopped",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"filterOpened",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"filterChanged",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"filterModified",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"chartCreated",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"chartRangeSelectionChanged",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"chartOptionsChanged",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"chartDestroyed",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"cellKeyDown",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"cellKeyPress",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"gridReady",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"firstDataRendered",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"gridSizeChanged",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"modelUpdated",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"virtualRowRemoved",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"viewportChanged",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"bodyScroll",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"bodyScrollEnd",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"dragStarted",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"dragStopped",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"paginationChanged",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"rowDragEnter",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"rowDragMove",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"rowDragLeave",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"rowDragEnd",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"columnRowGroupChanged",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"rowGroupOpened",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"expandOrCollapseAll",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"pinnedRowDataChanged",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"rowDataChanged",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"rowDataUpdated",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"asyncTransactionsFlushed",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"cellClicked",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"cellDoubleClicked",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"cellFocused",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"cellMouseOver",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"cellMouseOut",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"cellMouseDown",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"rowClicked",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"rowDoubleClicked",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"rowSelected",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"selectionChanged",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"cellContextMenu",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"rangeSelectionChanged",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"sortChanged",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"columnRowGroupChangeRequest",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"columnPivotChangeRequest",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"columnValueChangeRequest",void 0),Ae([_r(),Me("design:type",mt)],o.prototype,"columnAggFuncChangeRequest",void 0),o=Ae([Me("design:paramtypes",[Hs,Ca,h4,p4,_u])],o)}(),Mf=v4=function(){function o(){_(this,o)}return w(o,null,[{key:"withComponents",value:function(l){return{ngModule:v4,providers:[{provide:nd,useValue:l,multi:!0}]}}},{key:"forRoot",value:function(l){return{ngModule:v4,providers:[{provide:nd,useValue:l,multi:!0}]}}}]),o}();Mf.\u0275fac=function(u){return new(u||Mf)},Mf.\u0275mod=ji({type:Mf}),Mf.\u0275inj=zo({imports:[[]]});var _R=function(){var o=function(){function u(){_(this,u)}return w(u,[{key:"ngOnInit",value:function(){}}]),u}();return o.\u0275fac=function(l){return new(l||o)},o.\u0275cmp=Ei({type:o,selectors:[["app-root"]],decls:17,vars:0,consts:[[1,"kujata-menu"],[1,"kujata-menu-item"],["routerLink","/field-scenes","routerLinkActive","active",1,"kujata-menu-item-text"],["routerLink","/field-op-codes","routerLinkActive","active",1,"kujata-menu-item-text"],["routerLink","/field-models","routerLinkActive","active",1,"kujata-menu-item-text"],["routerLink","/battle-models","routerLinkActive","active",1,"kujata-menu-item-text"],["routerLink","/sounds","routerLinkActive","active",1,"kujata-menu-item-text"]],template:function(l,p){1&l&&(n(0,"div",0),n(1,"div",1),n(2,"a",2),Pt(3,"Fields"),c(),c(),n(4,"div",1),n(5,"a",3),Pt(6,"Field Op Codes"),c(),c(),n(7,"div",1),n(8,"a",4),Pt(9,"Field Models"),c(),c(),n(10,"div",1),n(11,"a",5),Pt(12,"Battle Models"),c(),c(),n(13,"div",1),n(14,"a",6),Pt(15,"Sounds"),c(),c(),c(),f(16,"router-outlet"))},directives:[ws,x8,n4],styles:[".kujata-menu[_ngcontent-%COMP%]{background-color:silver;margin-bottom:4px;padding:4px;display:flex;flex-flow:row wrap;align-items:flex-start;align-content:flex-start;font-size:10pt}.kujata-menu-item[_ngcontent-%COMP%]{background-color:#fff;margin-right:4px;padding:4px}.kujata-menu-item-text[_ngcontent-%COMP%]{color:#404040;font-weight:700}"]}),o}(),Hn={production:!0,KUJATA_DATA_BASE_URL:"https://raw.githubusercontent.com/dangarfield/kujata-data/master"};function SR(o,u){1&o&&f(0,"img",12),2&o&&h("src",It(5).environment.KUJATA_DATA_BASE_URL+"/metadata/world-map/wm0.png",qi)}function xR(o,u){if(1&o&&f(0,"img",12),2&o){var l=It().$implicit;h("src",It(4).environment.KUJATA_DATA_BASE_URL+"/metadata/makou-reactor/backgrounds/"+l+".png",qi)}}function bR(o,u){if(1&o&&(n(0,"a",8),n(1,"div",9),Pt(2),c(),n(3,"div",10),Pt(4),c(),gr(5,SR,1,1,"img",11),gr(6,xR,1,1,"img",11),c()),2&o){var l=u.$implicit,p=It(4);h("routerLink","/scene-details/"+l),wt(2),Gn(l),wt(2),Gn(p.getMenuName(l)),wt(1),h("ngIf",l.startsWith("wm")),wt(1),h("ngIf",!l.startsWith("wm"))}}function AR(o,u){if(1&o&&(n(0,"div",6),gr(1,bR,7,5,"a",7),c()),2&o){var l=It().$implicit;wt(1),h("ngForOf",l.fieldNames)}}function MR(o,u){if(1&o&&(n(0,"div",3),n(1,"div",4),Pt(2),c(),gr(3,AR,2,1,"div",5),c()),2&o){var l=u.$implicit;wt(2),Gn(l.name),wt(1),h("ngIf","Missing"!=l.name)}}function TR(o,u){if(1&o&&(B(0),gr(1,MR,4,2,"div",2),q()),2&o){var l=It();wt(1),h("ngForOf",l.chapters)}}var F8=function(){var o=function(){function u(l){_(this,u),this.http=l,this.environment=Hn,this.fetchStatus="NONE",this.sceneGraph=null,this.fieldIdToFieldMetadataMap=null,this.fieldNameToFieldMetadataMap=null,this.GRID_X=150,this.GRID_Y=75}return w(u,[{key:"createFieldNameToIdMap",value:function(p){this.fieldNameToIdMap={};for(var m=0;m<p.length;m++){var S=p[m];S&&S.length>0&&(this.fieldNameToIdMap[S]=m)}}},{key:"fieldNameToId",value:function(p){return this.fieldNameToIdMap[p]||-1}},{key:"fieldNameToMetadata",value:function(p){return this.fieldNameToFieldMetadataMap[p]}},{key:"getFieldMenuName",value:function(p){var m=p.mapNames;return m.length>0?m[0]:p.fieldName}},{key:"getMenuName",value:function(p){var m=this.fieldNameToMetadata(p);return this.getFieldMenuName(m)}},{key:"ngOnInit",value:function(){var p=this,m=Hn.KUJATA_DATA_BASE_URL+"/data/field/flevel.lgp/maplist.json";this.http.get(m).subscribe(function(S){p.mapList=S,p.createFieldNameToIdMap(S),p.http.get(m=Hn.KUJATA_DATA_BASE_URL+"/metadata/scene-graph.json").subscribe(function(M){p.sceneGraph=M,p.fieldIdToFieldMetadataMap={},p.fieldNameToFieldMetadataMap={};var N,P=I(p.sceneGraph.nodes);try{for(P.s();!(N=P.n()).done;){var G=N.value;p.fieldIdToFieldMetadataMap[G.id]=G,p.fieldNameToFieldMetadataMap[G.fieldName]=G}}catch(ie){P.e(ie)}finally{P.f()}console.log("this.fieldNameToFieldMetadataMap:",p.fieldNameToFieldMetadataMap),p.http.get(m=Hn.KUJATA_DATA_BASE_URL+"/metadata/chapters.json").subscribe(function(ie){p.chapters=ie;for(var ye={},Ce=65;Ce<p.mapList.length;Ce++){var Le=p.mapList[Ce];Le&&Le.length>0&&(ye[Le]=!0)}var nt,qe=I(p.chapters);try{for(qe.s();!(nt=qe.n()).done;){var Ze,et=I(nt.value.fieldNames);try{for(et.s();!(Ze=et.n()).done;)ye[Ze.value]=void 0}catch(Gr){et.e(Gr)}finally{et.f()}}}catch(Gr){qe.e(Gr)}finally{qe.f()}for(var At=p.chapters[p.chapters.length-3],Tt=0,nr=Object.keys(ye);Tt<nr.length;Tt++){var yr=nr[Tt];null!=ye[yr]&&At.fieldNames.push(yr)}})})},function(S){p.fetchStatus="ERROR"})}}]),u}();return o.\u0275fac=function(l){return new(l||o)(dr(zs))},o.\u0275cmp=Ei({type:o,selectors:[["field-scenes"]],decls:2,vars:1,consts:[[2,"background-color","#c0c0c0","padding","4px"],[4,"ngIf"],["class","chapter-container",4,"ngFor","ngForOf"],[1,"chapter-container"],[1,"chapter-name"],["class","field-cards-container",4,"ngIf"],[1,"field-cards-container"],["class","field-card",3,"routerLink",4,"ngFor","ngForOf"],[1,"field-card",3,"routerLink"],[1,"field-name"],[1,"field-menu-name"],["class","field-image",3,"src",4,"ngIf"],[1,"field-image",3,"src"]],template:function(l,p){1&l&&(n(0,"div",0),gr(1,TR,2,1,"ng-container",1),c()),2&l&&(wt(1),h("ngIf",p.chapters))},directives:[Ws,bu,ws],styles:[".chapter-container[_ngcontent-%COMP%]{background-color:#e0e0e0;margin-bottom:4px;padding:4px}.field-cards-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;align-items:flex-start;align-content:flex-start;font-size:10pt}.field-card[_ngcontent-%COMP%]{width:150px;height:180px;background-color:#f0f0f0;margin:4px 4px 0 0;text-align:center}.field-card[_ngcontent-%COMP%]:hover{background-color:#fff;text-decoration:none}.field-name[_ngcontent-%COMP%]{color:#404040;font-weight:700}.field-menu-name[_ngcontent-%COMP%]{color:gray;font-weight:700}.field-image[_ngcontent-%COMP%]{max-width:120px;max-height:120px;width:auto;height:auto}"]}),o}(),lr=a(494),ip=function(u){u.scene.traverse(function(l){if("Mesh"===l.type&&l.material&&l.material.userData&&l.material.userData.BlendType)switch(l.material.userData.BlendType){case"AdditiveBlending":l.material.blending=2;break;case"SubtractiveBlending":l.material.blending=3;break;case"MultiplyBlending":l.material.blending=4}})};function ER(){}function g4(o){return null==o?ER:function(){return this.querySelector(o)}}function DR(o){return null==o?[]:Array.isArray(o)?o:Array.from(o)}function OR(){return[]}function L8(o){return null==o?OR:function(){return this.querySelectorAll(o)}}function N8(o){return function(){return this.matches(o)}}function I8(o){return function(u){return u.matches(o)}}var LR=Array.prototype.find;function IR(){return this.firstElementChild}var BR=Array.prototype.filter;function GR(){return Array.from(this.children)}function k8(o){return new Array(o.length)}function d1(o,u){this.ownerDocument=o.ownerDocument,this.namespaceURI=o.namespaceURI,this._next=null,this._parent=o,this.__data__=u}function zR(o){return function(){return o}}function jR(o,u,l,p,m,S){for(var P,M=0,N=u.length,G=S.length;M<G;++M)(P=u[M])?(P.__data__=S[M],p[M]=P):l[M]=new d1(o,S[M]);for(;M<N;++M)(P=u[M])&&(m[M]=P)}function XR(o,u,l,p,m,S,M){var P,N,Le,G=new Map,ie=u.length,ye=S.length,Ce=new Array(ie);for(P=0;P<ie;++P)(N=u[P])&&(Ce[P]=Le=M.call(N,N.__data__,P,u)+"",G.has(Le)?m[P]=N:G.set(Le,N));for(P=0;P<ye;++P)Le=M.call(o,S[P],P,S)+"",(N=G.get(Le))?(p[P]=N,N.__data__=S[P],G.delete(Le)):l[P]=new d1(o,S[P]);for(P=0;P<ie;++P)(N=u[P])&&G.get(Ce[P])===N&&(m[P]=N)}function YR(o){return o.__data__}function KR(o){return"object"==typeof o&&"length"in o?o:Array.from(o)}function tD(o,u){return o<u?-1:o>u?1:o>=u?0:NaN}d1.prototype={constructor:d1,appendChild:function(u){return this._parent.insertBefore(u,this._next)},insertBefore:function(u,l){return this._parent.insertBefore(u,l)},querySelector:function(u){return this._parent.querySelector(u)},querySelectorAll:function(u){return this._parent.querySelectorAll(u)}};var m4="http://www.w3.org/1999/xhtml",B8={svg:"http://www.w3.org/2000/svg",xhtml:m4,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function h1(o){var u=o+="",l=u.indexOf(":");return l>=0&&"xmlns"!==(u=o.slice(0,l))&&(o=o.slice(l+1)),B8.hasOwnProperty(u)?{space:B8[u],local:o}:o}function lD(o){return function(){this.removeAttribute(o)}}function uD(o){return function(){this.removeAttributeNS(o.space,o.local)}}function cD(o,u){return function(){this.setAttribute(o,u)}}function fD(o,u){return function(){this.setAttributeNS(o.space,o.local,u)}}function dD(o,u){return function(){var l=u.apply(this,arguments);null==l?this.removeAttribute(o):this.setAttribute(o,l)}}function hD(o,u){return function(){var l=u.apply(this,arguments);null==l?this.removeAttributeNS(o.space,o.local):this.setAttributeNS(o.space,o.local,l)}}function G8(o){return o.ownerDocument&&o.ownerDocument.defaultView||o.document&&o||o.defaultView}function vD(o){return function(){this.style.removeProperty(o)}}function gD(o,u,l){return function(){this.style.setProperty(o,u,l)}}function mD(o,u,l){return function(){var p=u.apply(this,arguments);null==p?this.style.removeProperty(o):this.style.setProperty(o,p,l)}}function Tf(o,u){return o.style.getPropertyValue(u)||G8(o).getComputedStyle(o,null).getPropertyValue(u)}function CD(o){return function(){delete this[o]}}function wD(o,u){return function(){this[o]=u}}function _D(o,u){return function(){var l=u.apply(this,arguments);null==l?delete this[o]:this[o]=l}}function V8(o){return o.trim().split(/^|\s+/)}function y4(o){return o.classList||new U8(o)}function U8(o){this._node=o,this._names=V8(o.getAttribute("class")||"")}function H8(o,u){for(var l=y4(o),p=-1,m=u.length;++p<m;)l.add(u[p])}function W8(o,u){for(var l=y4(o),p=-1,m=u.length;++p<m;)l.remove(u[p])}function xD(o){return function(){H8(this,o)}}function bD(o){return function(){W8(this,o)}}function AD(o,u){return function(){(u.apply(this,arguments)?H8:W8)(this,o)}}function TD(){this.textContent=""}function ED(o){return function(){this.textContent=o}}function RD(o){return function(){var u=o.apply(this,arguments);this.textContent=null==u?"":u}}function OD(){this.innerHTML=""}function PD(o){return function(){this.innerHTML=o}}function FD(o){return function(){var u=o.apply(this,arguments);this.innerHTML=null==u?"":u}}function ND(){this.nextSibling&&this.parentNode.appendChild(this)}function kD(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function GD(o){return function(){var u=this.ownerDocument,l=this.namespaceURI;return l===m4&&u.documentElement.namespaceURI===m4?u.createElement(o):u.createElementNS(l,o)}}function VD(o){return function(){return this.ownerDocument.createElementNS(o.space,o.local)}}function z8(o){var u=h1(o);return(u.local?VD:GD)(u)}function HD(){return null}function zD(){var o=this.parentNode;o&&o.removeChild(this)}function XD(){var o=this.cloneNode(!1),u=this.parentNode;return u?u.insertBefore(o,this.nextSibling):o}function YD(){var o=this.cloneNode(!0),u=this.parentNode;return u?u.insertBefore(o,this.nextSibling):o}function JD(o){return o.trim().split(/^|\s+/).map(function(u){var l="",p=u.indexOf(".");return p>=0&&(l=u.slice(p+1),u=u.slice(0,p)),{type:u,name:l}})}function ZD(o){return function(){var u=this.__on;if(u){for(var S,l=0,p=-1,m=u.length;l<m;++l)S=u[l],o.type&&S.type!==o.type||S.name!==o.name?u[++p]=S:this.removeEventListener(S.type,S.listener,S.options);++p?u.length=p:delete this.__on}}}function $D(o,u,l){return function(){var m,p=this.__on,S=function(o){return function(u){o.call(this,u,this.__data__)}}(u);if(p)for(var M=0,P=p.length;M<P;++M)if((m=p[M]).type===o.type&&m.name===o.name)return this.removeEventListener(m.type,m.listener,m.options),this.addEventListener(m.type,m.listener=S,m.options=l),void(m.value=u);this.addEventListener(o.type,S,l),m={type:o.type,name:o.name,value:u,listener:S,options:l},p?p.push(m):this.__on=[m]}}function j8(o,u,l){var p=G8(o),m=p.CustomEvent;"function"==typeof m?m=new m(u,l):(m=p.document.createEvent("Event"),l?(m.initEvent(u,l.bubbles,l.cancelable),m.detail=l.detail):m.initEvent(u,!1,!1)),o.dispatchEvent(m)}function tO(o,u){return function(){return j8(this,o,u)}}function rO(o,u){return function(){return j8(this,o,u.apply(this,arguments))}}U8.prototype={add:function(u){this._names.indexOf(u)<0&&(this._names.push(u),this._node.setAttribute("class",this._names.join(" ")))},remove:function(u){var l=this._names.indexOf(u);l>=0&&(this._names.splice(l,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(u){return this._names.indexOf(u)>=0}};var iO=xr.mark(X8);function X8(){var o,u,l,p,m,S,M;return xr.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:u=0,l=(o=this._groups).length;case 1:if(!(u<l)){N.next=13;break}m=0,S=(p=o[u]).length;case 3:if(!(m<S)){N.next=10;break}if(!(M=p[m])){N.next=7;break}return N.next=7,M;case 7:++m,N.next=3;break;case 10:++u,N.next=1;break;case 13:case"end":return N.stop()}},iO,this)}var Y8=[null];function Sa(o,u){this._groups=o,this._parents=u}function q8(){return new Sa([[document.documentElement]],Y8)}Sa.prototype=q8.prototype=re({constructor:Sa,select:function(o){"function"!=typeof o&&(o=g4(o));for(var u=this._groups,l=u.length,p=new Array(l),m=0;m<l;++m)for(var N,G,S=u[m],M=S.length,P=p[m]=new Array(M),ie=0;ie<M;++ie)(N=S[ie])&&(G=o.call(N,N.__data__,ie,S))&&("__data__"in N&&(G.__data__=N.__data__),P[ie]=G);return new Sa(p,this._parents)},selectAll:function(o){o="function"==typeof o?function(o){return function(){return DR(o.apply(this,arguments))}}(o):L8(o);for(var u=this._groups,l=u.length,p=[],m=[],S=0;S<l;++S)for(var N,M=u[S],P=M.length,G=0;G<P;++G)(N=M[G])&&(p.push(o.call(N,N.__data__,G,M)),m.push(N));return new Sa(p,m)},selectChild:function(o){return this.select(null==o?IR:function(o){return function(){return LR.call(this.children,o)}}("function"==typeof o?o:I8(o)))},selectChildren:function(o){return this.selectAll(null==o?GR:function(o){return function(){return BR.call(this.children,o)}}("function"==typeof o?o:I8(o)))},filter:function(o){"function"!=typeof o&&(o=N8(o));for(var u=this._groups,l=u.length,p=new Array(l),m=0;m<l;++m)for(var N,S=u[m],M=S.length,P=p[m]=[],G=0;G<M;++G)(N=S[G])&&o.call(N,N.__data__,G,S)&&P.push(N);return new Sa(p,this._parents)},data:function(o,u){if(!arguments.length)return Array.from(this,YR);var l=u?XR:jR,p=this._parents,m=this._groups;"function"!=typeof o&&(o=zR(o));for(var S=m.length,M=new Array(S),P=new Array(S),N=new Array(S),G=0;G<S;++G){var ie=p[G],ye=m[G],Ce=ye.length,Le=KR(o.call(ie,ie&&ie.__data__,G,p)),qe=Le.length,nt=P[G]=new Array(qe),tt=M[G]=new Array(qe),et=N[G]=new Array(Ce);l(ie,ye,nt,tt,et,Le,u);for(var At,Tt,Ze=0,ht=0;Ze<qe;++Ze)if(At=nt[Ze]){for(Ze>=ht&&(ht=Ze+1);!(Tt=tt[ht])&&++ht<qe;);At._next=Tt||null}}return(M=new Sa(M,p))._enter=P,M._exit=N,M},enter:function(){return new Sa(this._enter||this._groups.map(k8),this._parents)},exit:function(){return new Sa(this._exit||this._groups.map(k8),this._parents)},join:function(o,u,l){var p=this.enter(),m=this,S=this.exit();return"function"==typeof o?(p=o(p))&&(p=p.selection()):p=p.append(o+""),null!=u&&(m=u(m))&&(m=m.selection()),null==l?S.remove():l(S),p&&m?p.merge(m).order():m},merge:function(o){for(var u=o.selection?o.selection():o,l=this._groups,p=u._groups,m=l.length,M=Math.min(m,p.length),P=new Array(m),N=0;N<M;++N)for(var Le,G=l[N],ie=p[N],ye=G.length,Ce=P[N]=new Array(ye),qe=0;qe<ye;++qe)(Le=G[qe]||ie[qe])&&(Ce[qe]=Le);for(;N<m;++N)P[N]=l[N];return new Sa(P,this._parents)},selection:function(){return this},order:function(){for(var o=this._groups,u=-1,l=o.length;++u<l;)for(var M,p=o[u],m=p.length-1,S=p[m];--m>=0;)(M=p[m])&&(S&&4^M.compareDocumentPosition(S)&&S.parentNode.insertBefore(M,S),S=M);return this},sort:function(o){function u(ye,Ce){return ye&&Ce?o(ye.__data__,Ce.__data__):!ye-!Ce}o||(o=tD);for(var l=this._groups,p=l.length,m=new Array(p),S=0;S<p;++S){for(var G,M=l[S],P=M.length,N=m[S]=new Array(P),ie=0;ie<P;++ie)(G=M[ie])&&(N[ie]=G);N.sort(u)}return new Sa(m,this._parents).order()},call:function(){var o=arguments[0];return arguments[0]=this,o.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var o=this._groups,u=0,l=o.length;u<l;++u)for(var p=o[u],m=0,S=p.length;m<S;++m){var M=p[m];if(M)return M}return null},size:function(){var o=0,u=I(this);try{for(u.s();!u.n().done;)++o}catch(m){u.e(m)}finally{u.f()}return o},empty:function(){return!this.node()},each:function(o){for(var u=this._groups,l=0,p=u.length;l<p;++l)for(var P,m=u[l],S=0,M=m.length;S<M;++S)(P=m[S])&&o.call(P,P.__data__,S,m);return this},attr:function(o,u){var l=h1(o);if(arguments.length<2){var p=this.node();return l.local?p.getAttributeNS(l.space,l.local):p.getAttribute(l)}return this.each((null==u?l.local?uD:lD:"function"==typeof u?l.local?hD:dD:l.local?fD:cD)(l,u))},style:function(o,u,l){return arguments.length>1?this.each((null==u?vD:"function"==typeof u?mD:gD)(o,u,null==l?"":l)):Tf(this.node(),o)},property:function(o,u){return arguments.length>1?this.each((null==u?CD:"function"==typeof u?_D:wD)(o,u)):this.node()[o]},classed:function(o,u){var l=V8(o+"");if(arguments.length<2){for(var p=y4(this.node()),m=-1,S=l.length;++m<S;)if(!p.contains(l[m]))return!1;return!0}return this.each(("function"==typeof u?AD:u?xD:bD)(l,u))},text:function(o){return arguments.length?this.each(null==o?TD:("function"==typeof o?RD:ED)(o)):this.node().textContent},html:function(o){return arguments.length?this.each(null==o?OD:("function"==typeof o?FD:PD)(o)):this.node().innerHTML},raise:function(){return this.each(ND)},lower:function(){return this.each(kD)},append:function(o){var u="function"==typeof o?o:z8(o);return this.select(function(){return this.appendChild(u.apply(this,arguments))})},insert:function(o,u){var l="function"==typeof o?o:z8(o),p=null==u?HD:"function"==typeof u?u:g4(u);return this.select(function(){return this.insertBefore(l.apply(this,arguments),p.apply(this,arguments)||null)})},remove:function(){return this.each(zD)},clone:function(o){return this.select(o?YD:XD)},datum:function(o){return arguments.length?this.property("__data__",o):this.node().__data__},on:function(o,u,l){var m,M,p=JD(o+""),S=p.length;if(!(arguments.length<2)){for(P=u?$D:ZD,m=0;m<S;++m)this.each(P(p[m],u,l));return this}var P=this.node().__on;if(P)for(var ie,N=0,G=P.length;N<G;++N)for(m=0,ie=P[N];m<S;++m)if((M=p[m]).type===ie.type&&M.name===ie.name)return ie.value},dispatch:function(o,u){return this.each(("function"==typeof u?rO:tO)(o,u))}},Symbol.iterator,X8);var op=q8,aO={value:function(){}};function K8(){for(var p,o=0,u=arguments.length,l={};o<u;++o){if(!(p=arguments[o]+"")||p in l||/[\s.]/.test(p))throw new Error("illegal type: "+p);l[p]=[]}return new p1(l)}function p1(o){this._=o}function sO(o,u){return o.trim().split(/^|\s+/).map(function(l){var p="",m=l.indexOf(".");if(m>=0&&(p=l.slice(m+1),l=l.slice(0,m)),l&&!u.hasOwnProperty(l))throw new Error("unknown type: "+l);return{type:l,name:p}})}function lO(o,u){for(var m,l=0,p=o.length;l<p;++l)if((m=o[l]).name===u)return m.value}function Q8(o,u,l){for(var p=0,m=o.length;p<m;++p)if(o[p].name===u){o[p]=aO,o=o.slice(0,p).concat(o.slice(p+1));break}return null!=l&&o.push({name:u,value:l}),o}p1.prototype=K8.prototype={constructor:p1,on:function(u,l){var S,p=this._,m=sO(u+"",p),M=-1,P=m.length;if(!(arguments.length<2)){if(null!=l&&"function"!=typeof l)throw new Error("invalid callback: "+l);for(;++M<P;)if(S=(u=m[M]).type)p[S]=Q8(p[S],u.name,l);else if(null==l)for(S in p)p[S]=Q8(p[S],u.name,null);return this}for(;++M<P;)if((S=(u=m[M]).type)&&(S=lO(p[S],u.name)))return S},copy:function(){var u={},l=this._;for(var p in l)u[p]=l[p].slice();return new p1(u)},call:function(u,l){if((S=arguments.length-2)>0)for(var S,M,p=new Array(S),m=0;m<S;++m)p[m]=arguments[m+2];if(!this._.hasOwnProperty(u))throw new Error("unknown type: "+u);for(m=0,S=(M=this._[u]).length;m<S;++m)M[m].value.apply(l,p)},apply:function(u,l,p){if(!this._.hasOwnProperty(u))throw new Error("unknown type: "+u);for(var m=this._[u],S=0,M=m.length;S<M;++S)m[S].value.apply(l,p)}};var v1,lp,uO=K8,Ef=0,ap=0,sp=0,g1=0,B0=0,m1=0,up="object"==typeof performance&&performance.now?performance:Date,Z8="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(o){setTimeout(o,17)};function C4(){return B0||(Z8(cO),B0=up.now()+m1)}function cO(){B0=0}function y1(){this._call=this._time=this._next=null}function $8(o,u,l){var p=new y1;return p.restart(o,u,l),p}function e6(){B0=(g1=up.now())+m1,Ef=ap=0;try{!function(){C4(),++Ef;for(var u,o=v1;o;)(u=B0-o._time)>=0&&o._call.call(void 0,u),o=o._next;--Ef}()}finally{Ef=0,function(){for(var o,l,u=v1,p=1/0;u;)u._call?(p>u._time&&(p=u._time),o=u,u=u._next):(l=u._next,u._next=null,u=o?o._next=l:v1=l);lp=o,w4(p)}(),B0=0}}function dO(){var o=up.now(),u=o-g1;u>1e3&&(m1-=u,g1=o)}function w4(o){Ef||(ap&&(ap=clearTimeout(ap)),o-B0>24?(o<1/0&&(ap=setTimeout(e6,o-up.now()-m1)),sp&&(sp=clearInterval(sp))):(sp||(g1=up.now(),sp=setInterval(dO,1e3)),Ef=1,Z8(e6)))}function t6(o,u,l){var p=new y1;return p.restart(function(m){p.stop(),o(m+u)},u=null==u?0:+u,l),p}y1.prototype=$8.prototype={constructor:y1,restart:function(u,l,p){if("function"!=typeof u)throw new TypeError("callback is not a function");p=(null==p?C4():+p)+(null==l?0:+l),!this._next&&lp!==this&&(lp?lp._next=this:v1=this,lp=this),this._call=u,this._time=p,w4()},stop:function(){this._call&&(this._call=null,this._time=1/0,w4())}};var pO=uO("start","end","cancel","interrupt"),vO=[];function _1(o,u,l,p,m,S){var M=o.__transition;if(M){if(l in M)return}else o.__transition={};!function(o,u,l){var m,p=o.__transition;function M(G){var ie,ye,Ce,Le;if(1!==l.state)return N();for(ie in p)if((Le=p[ie]).name===l.name){if(3===Le.state)return t6(M);4===Le.state?(Le.state=6,Le.timer.stop(),Le.on.call("interrupt",o,o.__data__,Le.index,Le.group),delete p[ie]):+ie<u&&(Le.state=6,Le.timer.stop(),Le.on.call("cancel",o,o.__data__,Le.index,Le.group),delete p[ie])}if(t6(function(){3===l.state&&(l.state=4,l.timer.restart(P,l.delay,l.time),P(G))}),l.state=2,l.on.call("start",o,o.__data__,l.index,l.group),2===l.state){for(l.state=3,m=new Array(Ce=l.tween.length),ie=0,ye=-1;ie<Ce;++ie)(Le=l.tween[ie].value.call(o,o.__data__,l.index,l.group))&&(m[++ye]=Le);m.length=ye+1}}function P(G){for(var ie=G<l.duration?l.ease.call(null,G/l.duration):(l.timer.restart(N),l.state=5,1),ye=-1,Ce=m.length;++ye<Ce;)m[ye].call(o,ie);5===l.state&&(l.on.call("end",o,o.__data__,l.index,l.group),N())}function N(){for(var G in l.state=6,l.timer.stop(),delete p[u],p)return;delete o.__transition}p[u]=l,l.timer=$8(function(G){l.state=1,l.timer.restart(M,l.delay,l.time),l.delay<=G&&M(G-l.delay)},0,l.time)}(o,l,{name:u,index:p,group:m,on:pO,tween:vO,time:S.time,delay:S.delay,duration:S.duration,ease:S.ease,timer:null,state:0})}function x4(o,u){var l=_s(o,u);if(l.state>0)throw new Error("too late; already scheduled");return l}function qs(o,u){var l=_s(o,u);if(l.state>3)throw new Error("too late; already running");return l}function _s(o,u){var l=o.__transition;if(!l||!(l=l[u]))throw new Error("transition not found");return l}function Tu(o,u){return o=+o,u=+u,function(l){return o*(1-l)+u*l}}var S1,o6=180/Math.PI,b4={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function a6(o,u,l,p,m,S){var M,P,N;return(M=Math.sqrt(o*o+u*u))&&(o/=M,u/=M),(N=o*l+u*p)&&(l-=o*N,p-=u*N),(P=Math.sqrt(l*l+p*p))&&(l/=P,p/=P,N/=P),o*p<u*l&&(o=-o,u=-u,N=-N,M=-M),{translateX:m,translateY:S,rotate:Math.atan2(u,o)*o6,skewX:Math.atan(N)*o6,scaleX:M,scaleY:P}}function s6(o,u,l,p){function m(G){return G.length?G.pop()+" ":""}return function(G,ie){var ye=[],Ce=[];return G=o(G),ie=o(ie),function(G,ie,ye,Ce,Le,qe){if(G!==ye||ie!==Ce){var nt=Le.push("translate(",null,u,null,l);qe.push({i:nt-4,x:Tu(G,ye)},{i:nt-2,x:Tu(ie,Ce)})}else(ye||Ce)&&Le.push("translate("+ye+u+Ce+l)}(G.translateX,G.translateY,ie.translateX,ie.translateY,ye,Ce),function(G,ie,ye,Ce){G!==ie?(G-ie>180?ie+=360:ie-G>180&&(G+=360),Ce.push({i:ye.push(m(ye)+"rotate(",null,p)-2,x:Tu(G,ie)})):ie&&ye.push(m(ye)+"rotate("+ie+p)}(G.rotate,ie.rotate,ye,Ce),function(G,ie,ye,Ce){G!==ie?Ce.push({i:ye.push(m(ye)+"skewX(",null,p)-2,x:Tu(G,ie)}):ie&&ye.push(m(ye)+"skewX("+ie+p)}(G.skewX,ie.skewX,ye,Ce),function(G,ie,ye,Ce,Le,qe){if(G!==ye||ie!==Ce){var nt=Le.push(m(Le)+"scale(",null,",",null,")");qe.push({i:nt-4,x:Tu(G,ye)},{i:nt-2,x:Tu(ie,Ce)})}else(1!==ye||1!==Ce)&&Le.push(m(Le)+"scale("+ye+","+Ce+")")}(G.scaleX,G.scaleY,ie.scaleX,ie.scaleY,ye,Ce),G=ie=null,function(Le){for(var tt,qe=-1,nt=Ce.length;++qe<nt;)ye[(tt=Ce[qe]).i]=tt.x(Le);return ye.join("")}}}var _O=s6(function(o){var u=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(o+"");return u.isIdentity?b4:a6(u.a,u.b,u.c,u.d,u.e,u.f)},"px, ","px)","deg)"),SO=s6(function(o){return null!=o&&(S1||(S1=document.createElementNS("http://www.w3.org/2000/svg","g")),S1.setAttribute("transform",o),o=S1.transform.baseVal.consolidate())?a6((o=o.matrix).a,o.b,o.c,o.d,o.e,o.f):b4},", ",")",")");function xO(o,u){var l,p;return function(){var m=qs(this,o),S=m.tween;if(S!==l)for(var M=0,P=(p=l=S).length;M<P;++M)if(p[M].name===u){(p=p.slice()).splice(M,1);break}m.tween=p}}function bO(o,u,l){var p,m;if("function"!=typeof l)throw new Error;return function(){var S=qs(this,o),M=S.tween;if(M!==p){m=(p=M).slice();for(var P={name:u,value:l},N=0,G=m.length;N<G;++N)if(m[N].name===u){m[N]=P;break}N===G&&m.push(P)}S.tween=m}}function A4(o,u,l){var p=o._id;return o.each(function(){var m=qs(this,p);(m.value||(m.value={}))[u]=l.apply(this,arguments)}),function(m){return _s(m,p).value[u]}}function M4(o,u,l){o.prototype=u.prototype=l,l.constructor=o}function l6(o,u){var l=Object.create(o.prototype);for(var p in u)l[p]=u[p];return l}function cp(){}var x1=1/.7,Rf="\\s*([+-]?\\d+)\\s*",dp="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ks="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",MO=/^#([0-9a-f]{3,8})$/,TO=new RegExp("^rgb\\("+[Rf,Rf,Rf]+"\\)$"),EO=new RegExp("^rgb\\("+[Ks,Ks,Ks]+"\\)$"),RO=new RegExp("^rgba\\("+[Rf,Rf,Rf,dp]+"\\)$"),DO=new RegExp("^rgba\\("+[Ks,Ks,Ks,dp]+"\\)$"),OO=new RegExp("^hsl\\("+[dp,Ks,Ks]+"\\)$"),PO=new RegExp("^hsla\\("+[dp,Ks,Ks,dp]+"\\)$"),u6={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function c6(){return this.rgb().formatHex()}function f6(){return this.rgb().formatRgb()}function hp(o){var u,l;return o=(o+"").trim().toLowerCase(),(u=MO.exec(o))?(l=u[1].length,u=parseInt(u[1],16),6===l?d6(u):3===l?new xa(u>>8&15|u>>4&240,u>>4&15|240&u,(15&u)<<4|15&u,1):8===l?b1(u>>24&255,u>>16&255,u>>8&255,(255&u)/255):4===l?b1(u>>12&15|u>>8&240,u>>8&15|u>>4&240,u>>4&15|240&u,((15&u)<<4|15&u)/255):null):(u=TO.exec(o))?new xa(u[1],u[2],u[3],1):(u=EO.exec(o))?new xa(255*u[1]/100,255*u[2]/100,255*u[3]/100,1):(u=RO.exec(o))?b1(u[1],u[2],u[3],u[4]):(u=DO.exec(o))?b1(255*u[1]/100,255*u[2]/100,255*u[3]/100,u[4]):(u=OO.exec(o))?v6(u[1],u[2]/100,u[3]/100,1):(u=PO.exec(o))?v6(u[1],u[2]/100,u[3]/100,u[4]):u6.hasOwnProperty(o)?d6(u6[o]):"transparent"===o?new xa(NaN,NaN,NaN,0):null}function d6(o){return new xa(o>>16&255,o>>8&255,255&o,1)}function b1(o,u,l,p){return p<=0&&(o=u=l=NaN),new xa(o,u,l,p)}function LO(o){return o instanceof cp||(o=hp(o)),o?new xa((o=o.rgb()).r,o.g,o.b,o.opacity):new xa}function A1(o,u,l,p){return 1===arguments.length?LO(o):new xa(o,u,l,null==p?1:p)}function xa(o,u,l,p){this.r=+o,this.g=+u,this.b=+l,this.opacity=+p}function h6(){return"#"+T4(this.r)+T4(this.g)+T4(this.b)}function p6(){var o=this.opacity;return(1===(o=isNaN(o)?1:Math.max(0,Math.min(1,o)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===o?")":", "+o+")")}function T4(o){return((o=Math.max(0,Math.min(255,Math.round(o)||0)))<16?"0":"")+o.toString(16)}function v6(o,u,l,p){return p<=0?o=u=l=NaN:l<=0||l>=1?o=u=NaN:u<=0&&(o=NaN),new Qs(o,u,l,p)}function g6(o){if(o instanceof Qs)return new Qs(o.h,o.s,o.l,o.opacity);if(o instanceof cp||(o=hp(o)),!o)return new Qs;if(o instanceof Qs)return o;var u=(o=o.rgb()).r/255,l=o.g/255,p=o.b/255,m=Math.min(u,l,p),S=Math.max(u,l,p),M=NaN,P=S-m,N=(S+m)/2;return P?(M=u===S?(l-p)/P+6*(l<p):l===S?(p-u)/P+2:(u-l)/P+4,P/=N<.5?S+m:2-S-m,M*=60):P=N>0&&N<1?0:M,new Qs(M,P,N,o.opacity)}function Qs(o,u,l,p){this.h=+o,this.s=+u,this.l=+l,this.opacity=+p}function E4(o,u,l){return 255*(o<60?u+(l-u)*o/60:o<180?l:o<240?u+(l-u)*(240-o)/60:u)}function m6(o,u,l,p,m){var S=o*o,M=S*o;return((1-3*o+3*S-M)*u+(4-6*S+3*M)*l+(1+3*o+3*S-3*M)*p+M*m)/6}M4(cp,hp,{copy:function(u){return Object.assign(new this.constructor,this,u)},displayable:function(){return this.rgb().displayable()},hex:c6,formatHex:c6,formatHsl:function(){return g6(this).formatHsl()},formatRgb:f6,toString:f6}),M4(xa,A1,l6(cp,{brighter:function(u){return u=null==u?x1:Math.pow(x1,u),new xa(this.r*u,this.g*u,this.b*u,this.opacity)},darker:function(u){return u=null==u?.7:Math.pow(.7,u),new xa(this.r*u,this.g*u,this.b*u,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:h6,formatHex:h6,formatRgb:p6,toString:p6})),M4(Qs,function(o,u,l,p){return 1===arguments.length?g6(o):new Qs(o,u,l,null==p?1:p)},l6(cp,{brighter:function(u){return u=null==u?x1:Math.pow(x1,u),new Qs(this.h,this.s,this.l*u,this.opacity)},darker:function(u){return u=null==u?.7:Math.pow(.7,u),new Qs(this.h,this.s,this.l*u,this.opacity)},rgb:function(){var u=this.h%360+360*(this.h<0),l=isNaN(u)||isNaN(this.s)?0:this.s,p=this.l,m=p+(p<.5?p:1-p)*l,S=2*p-m;return new xa(E4(u>=240?u-240:u+120,S,m),E4(u,S,m),E4(u<120?u+240:u-120,S,m),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var u=this.opacity;return(1===(u=isNaN(u)?1:Math.max(0,Math.min(1,u)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===u?")":", "+u+")")}}));var y6=function(o){return function(){return o}};function w6(o,u){var l=u-o;return l?function(o,u){return function(l){return o+l*u}}(o,l):y6(isNaN(o)?u:o)}var _6=function o(u){var l=function(o){return 1==(o=+o)?w6:function(u,l){return l-u?function(o,u,l){return o=Math.pow(o,l),u=Math.pow(u,l)-o,l=1/l,function(p){return Math.pow(o+p*u,l)}}(u,l,o):y6(isNaN(u)?l:u)}}(u);function p(m,S){var M=l((m=A1(m)).r,(S=A1(S)).r),P=l(m.g,S.g),N=l(m.b,S.b),G=w6(m.opacity,S.opacity);return function(ie){return m.r=M(ie),m.g=P(ie),m.b=N(ie),m.opacity=G(ie),m+""}}return p.gamma=o,p}(1);function S6(o){return function(u){var M,P,l=u.length,p=new Array(l),m=new Array(l),S=new Array(l);for(M=0;M<l;++M)P=A1(u[M]),p[M]=P.r||0,m[M]=P.g||0,S[M]=P.b||0;return p=o(p),m=o(m),S=o(S),P.opacity=1,function(N){return P.r=p(N),P.g=m(N),P.b=S(N),P+""}}}S6(function(o){var u=o.length-1;return function(l){var p=l<=0?l=0:l>=1?(l=1,u-1):Math.floor(l*u),m=o[p],S=o[p+1];return m6((l-p/u)*u,p>0?o[p-1]:2*m-S,m,S,p<u-1?o[p+2]:2*S-m)}}),S6(function(o){var u=o.length;return function(l){var p=Math.floor(((l%=1)<0?++l:l)*u);return m6((l-p/u)*u,o[(p+u-1)%u],o[p%u],o[(p+1)%u],o[(p+2)%u])}});var R4=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,D4=new RegExp(R4.source,"g");function HO(o,u){var p,m,S,l=R4.lastIndex=D4.lastIndex=0,M=-1,P=[],N=[];for(o+="",u+="";(p=R4.exec(o))&&(m=D4.exec(u));)(S=m.index)>l&&(S=u.slice(l,S),P[M]?P[M]+=S:P[++M]=S),(p=p[0])===(m=m[0])?P[M]?P[M]+=m:P[++M]=m:(P[++M]=null,N.push({i:M,x:Tu(p,m)})),l=D4.lastIndex;return l<u.length&&(S=u.slice(l),P[M]?P[M]+=S:P[++M]=S),P.length<2?N[0]?function(o){return function(u){return o(u)+""}}(N[0].x):function(o){return function(){return o}}(u):(u=N.length,function(G){for(var ye,ie=0;ie<u;++ie)P[(ye=N[ie]).i]=ye.x(G);return P.join("")})}function x6(o,u){var l;return("number"==typeof u?Tu:u instanceof hp?_6:(l=hp(u))?(u=l,_6):HO)(o,u)}function WO(o){return function(){this.removeAttribute(o)}}function zO(o){return function(){this.removeAttributeNS(o.space,o.local)}}function jO(o,u,l){var p,S,m=l+"";return function(){var M=this.getAttribute(o);return M===m?null:M===p?S:S=u(p=M,l)}}function XO(o,u,l){var p,S,m=l+"";return function(){var M=this.getAttributeNS(o.space,o.local);return M===m?null:M===p?S:S=u(p=M,l)}}function YO(o,u,l){var p,m,S;return function(){var M,N,P=l(this);return null==P?void this.removeAttribute(o):(M=this.getAttribute(o))===(N=P+"")?null:M===p&&N===m?S:(m=N,S=u(p=M,P))}}function qO(o,u,l){var p,m,S;return function(){var M,N,P=l(this);return null==P?void this.removeAttributeNS(o.space,o.local):(M=this.getAttributeNS(o.space,o.local))===(N=P+"")?null:M===p&&N===m?S:(m=N,S=u(p=M,P))}}function QO(o,u){return function(l){this.setAttribute(o,u.call(this,l))}}function JO(o,u){return function(l){this.setAttributeNS(o.space,o.local,u.call(this,l))}}function ZO(o,u){var l,p;function m(){var S=u.apply(this,arguments);return S!==p&&(l=(p=S)&&JO(o,S)),l}return m._value=u,m}function $O(o,u){var l,p;function m(){var S=u.apply(this,arguments);return S!==p&&(l=(p=S)&&QO(o,S)),l}return m._value=u,m}function tP(o,u){return function(){x4(this,o).delay=+u.apply(this,arguments)}}function rP(o,u){return u=+u,function(){x4(this,o).delay=u}}function iP(o,u){return function(){qs(this,o).duration=+u.apply(this,arguments)}}function oP(o,u){return u=+u,function(){qs(this,o).duration=u}}function sP(o,u){if("function"!=typeof u)throw new Error;return function(){qs(this,o).ease=u}}function pP(o,u,l){var p,m,S=function(o){return(o+"").trim().split(/^|\s+/).every(function(u){var l=u.indexOf(".");return l>=0&&(u=u.slice(0,l)),!u||"start"===u})}(u)?x4:qs;return function(){var M=S(this,o),P=M.on;P!==p&&(m=(p=P).copy()).on(u,l),M.on=m}}var wP=op.prototype.constructor;function b6(o){return function(){this.style.removeProperty(o)}}function TP(o,u,l){return function(p){this.style.setProperty(o,u.call(this,p),l)}}function EP(o,u,l){var p,m;function S(){var M=u.apply(this,arguments);return M!==m&&(p=(m=M)&&TP(o,M,l)),p}return S._value=u,S}function FP(o){return function(u){this.textContent=o.call(this,u)}}function LP(o){var u,l;function p(){var m=o.apply(this,arguments);return m!==l&&(u=(l=m)&&FP(m)),u}return p._value=o,p}var BP=0;function Al(o,u,l,p){this._groups=o,this._parents=u,this._name=l,this._id=p}function A6(){return++BP}var Ml=op.prototype;Al.prototype=function(o){return op().transition(o)}.prototype=re({constructor:Al,select:function(o){var u=this._name,l=this._id;"function"!=typeof o&&(o=g4(o));for(var p=this._groups,m=p.length,S=new Array(m),M=0;M<m;++M)for(var ie,ye,P=p[M],N=P.length,G=S[M]=new Array(N),Ce=0;Ce<N;++Ce)(ie=P[Ce])&&(ye=o.call(ie,ie.__data__,Ce,P))&&("__data__"in ie&&(ye.__data__=ie.__data__),G[Ce]=ye,_1(G[Ce],u,l,Ce,G,_s(ie,l)));return new Al(S,this._parents,u,l)},selectAll:function(o){var u=this._name,l=this._id;"function"!=typeof o&&(o=L8(o));for(var p=this._groups,m=p.length,S=[],M=[],P=0;P<m;++P)for(var ie,N=p[P],G=N.length,ye=0;ye<G;++ye)if(ie=N[ye]){for(var Le,Ce=o.call(ie,ie.__data__,ye,N),qe=_s(ie,l),nt=0,tt=Ce.length;nt<tt;++nt)(Le=Ce[nt])&&_1(Le,u,l,nt,Ce,qe);S.push(Ce),M.push(ie)}return new Al(S,M,u,l)},selectChild:Ml.selectChild,selectChildren:Ml.selectChildren,filter:function(o){"function"!=typeof o&&(o=N8(o));for(var u=this._groups,l=u.length,p=new Array(l),m=0;m<l;++m)for(var N,S=u[m],M=S.length,P=p[m]=[],G=0;G<M;++G)(N=S[G])&&o.call(N,N.__data__,G,S)&&P.push(N);return new Al(p,this._parents,this._name,this._id)},merge:function(o){if(o._id!==this._id)throw new Error;for(var u=this._groups,l=o._groups,p=u.length,S=Math.min(p,l.length),M=new Array(p),P=0;P<S;++P)for(var Ce,N=u[P],G=l[P],ie=N.length,ye=M[P]=new Array(ie),Le=0;Le<ie;++Le)(Ce=N[Le]||G[Le])&&(ye[Le]=Ce);for(;P<p;++P)M[P]=u[P];return new Al(M,this._parents,this._name,this._id)},selection:function(){return new wP(this._groups,this._parents)},transition:function(){for(var o=this._name,u=this._id,l=A6(),p=this._groups,m=p.length,S=0;S<m;++S)for(var N,M=p[S],P=M.length,G=0;G<P;++G)if(N=M[G]){var ie=_s(N,u);_1(N,o,l,G,M,{time:ie.time+ie.delay+ie.duration,delay:0,duration:ie.duration,ease:ie.ease})}return new Al(p,this._parents,o,l)},call:Ml.call,nodes:Ml.nodes,node:Ml.node,size:Ml.size,empty:Ml.empty,each:Ml.each,on:function(o,u){var l=this._id;return arguments.length<2?_s(this.node(),l).on.on(o):this.each(pP(l,o,u))},attr:function(o,u){var l=h1(o),p="transform"===l?SO:x6;return this.attrTween(o,"function"==typeof u?(l.local?qO:YO)(l,p,A4(this,"attr."+o,u)):null==u?(l.local?zO:WO)(l):(l.local?XO:jO)(l,p,u))},attrTween:function(o,u){var l="attr."+o;if(arguments.length<2)return(l=this.tween(l))&&l._value;if(null==u)return this.tween(l,null);if("function"!=typeof u)throw new Error;var p=h1(o);return this.tween(l,(p.local?ZO:$O)(p,u))},style:function(o,u,l){var p="transform"==(o+="")?_O:x6;return null==u?this.styleTween(o,function(o,u){var l,p,m;return function(){var S=Tf(this,o),M=(this.style.removeProperty(o),Tf(this,o));return S===M?null:S===l&&M===p?m:m=u(l=S,p=M)}}(o,p)).on("end.style."+o,b6(o)):"function"==typeof u?this.styleTween(o,function(o,u,l){var p,m,S;return function(){var M=Tf(this,o),P=l(this),N=P+"";return null==P&&(this.style.removeProperty(o),N=P=Tf(this,o)),M===N?null:M===p&&N===m?S:(m=N,S=u(p=M,P))}}(o,p,A4(this,"style."+o,u))).each(function(o,u){var l,p,m,P,S="style."+u,M="end."+S;return function(){var N=qs(this,o),G=N.on,ie=null==N.value[S]?P||(P=b6(u)):void 0;(G!==l||m!==ie)&&(p=(l=G).copy()).on(M,m=ie),N.on=p}}(this._id,o)):this.styleTween(o,function(o,u,l){var p,S,m=l+"";return function(){var M=Tf(this,o);return M===m?null:M===p?S:S=u(p=M,l)}}(o,p,u),l).on("end.style."+o,null)},styleTween:function(o,u,l){var p="style."+(o+="");if(arguments.length<2)return(p=this.tween(p))&&p._value;if(null==u)return this.tween(p,null);if("function"!=typeof u)throw new Error;return this.tween(p,EP(o,u,null==l?"":l))},text:function(o){return this.tween("text","function"==typeof o?function(o){return function(){var u=o(this);this.textContent=null==u?"":u}}(A4(this,"text",o)):function(o){return function(){this.textContent=o}}(null==o?"":o+""))},textTween:function(o){var u="text";if(arguments.length<1)return(u=this.tween(u))&&u._value;if(null==o)return this.tween(u,null);if("function"!=typeof o)throw new Error;return this.tween(u,LP(o))},remove:function(){return this.on("end.remove",function(o){return function(){var u=this.parentNode;for(var l in this.__transition)if(+l!==o)return;u&&u.removeChild(this)}}(this._id))},tween:function(o,u){var l=this._id;if(o+="",arguments.length<2){for(var M,p=_s(this.node(),l).tween,m=0,S=p.length;m<S;++m)if((M=p[m]).name===o)return M.value;return null}return this.each((null==u?xO:bO)(l,o,u))},delay:function(o){var u=this._id;return arguments.length?this.each(("function"==typeof o?tP:rP)(u,o)):_s(this.node(),u).delay},duration:function(o){var u=this._id;return arguments.length?this.each(("function"==typeof o?iP:oP)(u,o)):_s(this.node(),u).duration},ease:function(o){var u=this._id;return arguments.length?this.each(sP(u,o)):_s(this.node(),u).ease},easeVarying:function(o){if("function"!=typeof o)throw new Error;return this.each(function(o,u){return function(){var l=u.apply(this,arguments);if("function"!=typeof l)throw new Error;qs(this,o).ease=l}}(this._id,o))},end:function(){var o,u,l=this,p=l._id,m=l.size();return new Promise(function(S,M){var P={value:M},N={value:function(){0==--m&&S()}};l.each(function(){var G=qs(this,p),ie=G.on;ie!==o&&((u=(o=ie).copy())._.cancel.push(P),u._.interrupt.push(P),u._.end.push(N)),G.on=u}),0===m&&S()})}},Symbol.iterator,Ml[Symbol.iterator]);var UP={time:null,delay:0,duration:250,ease:function(o){return((o*=2)<=1?o*o*o:(o-=2)*o*o+2)/2}};function HP(o,u){for(var l;!(l=o.__transition)||!(l=l[u]);)if(!(o=o.parentNode))throw new Error("transition ".concat(u," not found"));return l}function pp(o){return{type:o}}function Pf(o,u,l){this.k=o,this.x=u,this.y=l}function oF(o,u){1&o&&(n(0,"div"),n(1,"p"),Pt(2,"Fetching..."),c(),c())}function aF(o,u){1&o&&(n(0,"div"),n(1,"p"),Pt(2,"Sorry, this app had a problem getting that info."),c(),c())}function sF(o,u){if(1&o&&f(0,"div",34),2&o){var l=It(2).index,p=It(4);Mh("width",p.DISPLAY_WIDTH,"px")("height",p.DISPLAY_HEIGHT,"px"),h("id","model_display_"+l)}}function lF(o,u){if(1&o&&(n(0,"div",35),f(1,"img",36),c()),2&o){var l=It().$implicit,p=It(5);Mh("width",p.DISPLAY_WIDTH,"px")("height",p.DISPLAY_HEIGHT,"px"),wt(1),h("src",l.screenshotDataUrl,qi)}}function uF(o,u){if(1&o&&(n(0,"div",31),gr(1,sF,1,5,"div",32),gr(2,lF,2,5,"div",33),c()),2&o){var l=u.$implicit;wt(1),h("ngIf",!l.screenshotDataUrl),wt(1),h("ngIf",l.screenshotDataUrl)}}function cF(o,u){if(1&o&&(n(0,"span"),Pt(1),c()),2&o){var l=It().$implicit;wt(1),ym("\xa0@\xa0xyz(",l.x,", ",l.y,", ",l.z,")")}}function fF(o,u){if(1&o&&(n(0,"div"),n(1,"span",23),Pt(2),c(),n(3,"span"),Pt(4," ( "),f(5,"div",37),Pt(6," ) "),gr(7,cF,2,3,"span",12),c(),c()),2&o){var l=u.$implicit,p=u.index;wt(2),Pi("",3==p?"G":p+1,":"),wt(3),Mh("background-color","rgb("+l.r+","+l.g+","+l.b+")"),wt(2),h("ngIf",null!=l.x)}}function dF(o,u){if(1&o&&(n(0,"span"),n(1,"span",23),Pt(2),c(),Pt(3),c()),2&o){var l=u.$implicit,p=u.index;wt(2),Pi("",p,":"),wt(1),Pi("\xa0",l.substring(0,4)," ")}}op.prototype.interrupt=function(o){return this.each(function(){!function(o,u){var p,m,M,l=o.__transition,S=!0;if(l){for(M in u=null==u?null:u+"",l)(p=l[M]).name===u?(m=p.state>2&&p.state<5,p.state=6,p.timer.stop(),p.on.call(m?"interrupt":"cancel",o,o.__data__,p.index,p.group),delete l[M]):S=!1;S&&delete o.__transition}}(this,o)})},op.prototype.transition=function(o){var u,l;o instanceof Al?(u=o._id,o=o._name):(u=A6(),(l=UP).time=C4(),o=null==o?null:o+"");for(var p=this._groups,m=p.length,S=0;S<m;++S)for(var N,M=p[S],P=M.length,G=0;G<P;++G)(N=M[G])&&_1(N,o,u,G,M,l||HP(N,u));return new Al(p,this._parents,o,u)},Math,Math,Math,["w","e"].map(pp),["n","s"].map(pp),["n","w","e","s","nw","ne","sw","se"].map(pp),Pf.prototype={constructor:Pf,scale:function(u){return 1===u?this:new Pf(this.k*u,this.x,this.y)},translate:function(u,l){return 0===u&0===l?this:new Pf(this.k,this.x+this.k*u,this.y+this.k*l)},apply:function(u){return[u[0]*this.k+this.x,u[1]*this.k+this.y]},applyX:function(u){return u*this.k+this.x},applyY:function(u){return u*this.k+this.y},invert:function(u){return[(u[0]-this.x)/this.k,(u[1]-this.y)/this.k]},invertX:function(u){return(u-this.x)/this.k},invertY:function(u){return(u-this.y)/this.k},rescaleX:function(u){return u.copy().domain(u.range().map(this.invertX,this).map(u.invert,u))},rescaleY:function(u){return u.copy().domain(u.range().map(this.invertY,this).map(u.invert,u))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new Pf(1,0,0);var vp=function(u){return[u]},hF=function(u,l,p,m){return[u,l,p,m]};function pF(o,u){if(1&o&&(n(0,"div",26),gr(1,uF,3,2,"div",27),n(2,"div",28),n(3,"b"),Pt(4),c(),c(),f(5,"div",29),n(6,"b"),Pt(7,"Model:"),c(),Pt(8,"\xa0"),n(9,"a",30),Pt(10),c(),Pt(11," \xb7 "),n(12,"b"),Pt(13,"Scale:"),c(),Pt(14),f(15,"br"),n(16,"div",23),Pt(17,"Lights:"),c(),gr(18,fF,8,4,"div",15),n(19,"div",23),Pt(20,"Animations:"),c(),gr(21,dF,4,2,"span",15),f(22,"br"),c()),2&o){var l=u.$implicit,p=It(4);wt(1),h("ngForOf",vf(7,vp,p.getDisplay(l.hrcId))),wt(3),Gn(l.name),wt(5),kn("href","field-model-details/",l.hrcIdShort,"",qi),wt(1),Gn(l.hrcId),wt(4),Pi(" ",l.scaleString," "),wt(4),h("ngForOf",FC(9,hF,l.light1,l.light2,l.light3,l.globalLight)),wt(3),h("ngForOf",l.animations)}}function vF(o,u){if(1&o&&(n(0,"div",21),n(1,"div",3),Pt(2,"Model Loader Section"),c(),f(3,"div",13),n(4,"div"),Pt(5),c(),f(6,"div",22),n(7,"div",23),Pt(8,"Model Loaders"),c(),n(9,"div",24),gr(10,pF,23,14,"div",25),c(),c()),2&o){var l=u.$implicit;wt(5),Pi("Scale: ",l.header.modelScale,""),wt(5),h("ngForOf",l.modelLoaders)}}function gF(o,u){if(1&o){var l=Se();n(0,"div",39),n(1,"div",40),n(2,"b"),Pt(3,"From Line:"),c(),Pt(4),c(),n(5,"div",40),n(6,"b"),Pt(7,"To Map:"),c(),Pt(8,"\xa0"),n(9,"a",41),rt("click",function(){var M=es(l).$implicit;return It(4).onSelectFieldName(M.fieldName)}),Pt(10),c(),Pt(11," \xa0 "),n(12,"b"),Pt(13,"Position:"),c(),Pt(14),c(),c()}if(2&o){var p=u.$implicit;wt(4),N3(" (",p.exitLineVertex1.x,", ",p.exitLineVertex1.y,", ",p.exitLineVertex1.z,") - (",p.exitLineVertex2.x,", ",p.exitLineVertex2.y,", ",p.exitLineVertex2.z,") "),wt(6),vs("",p.fieldName," (",p.fieldId,")"),wt(4),ym("\xa0 (",p.destinationVertex.x,", ",p.destinationVertex.y,", ",p.destinationVertex.z,") ")}}function mF(o,u){if(1&o&&(n(0,"div",21),n(1,"div",3),Pt(2,"Triggers/Gateways Section"),c(),f(3,"div",13),n(4,"div",24),gr(5,gF,15,11,"div",38),c(),c()),2&o){var l=u.$implicit;wt(5),h("ngForOf",l.gateways)}}function yF(o,u){if(1&o&&(n(0,"div",50),n(1,"div",51),Pt(2),c(),n(3,"div",52),Pt(4),c(),c()),2&o){var l=u.$implicit;wt(2),Gn(l.raw),wt(2),Gn(l.js)}}function CF(o,u){if(1&o&&(n(0,"div",47),n(1,"div"),n(2,"b"),Pt(3),c(),c(),f(4,"div",48),gr(5,yF,5,2,"div",49),c()),2&o){var l=u.$implicit;wt(3),Pi("script ",l.index,":"),wt(2),h("ngForOf",l.ops)}}function wF(o,u){if(1&o&&(n(0,"div",43),n(1,"div",44),Pt(2),n(3,"span",45),Pt(4),c(),c(),f(5,"div",22),gr(6,CF,6,2,"div",46),c()),2&o){var l=u.$implicit,p=u.index;wt(2),Pi("#",p,": "),wt(2),Pi('"',l.entityName,'"'),wt(2),h("ngForOf",l.scripts)}}function _F(o,u){if(1&o&&(n(0,"div",21),n(1,"div",3),Pt(2,"Entities Section"),c(),f(3,"div",13),gr(4,wF,7,3,"div",42),c()),2&o){var l=u.$implicit;wt(4),h("ngForOf",l)}}function SF(o,u){if(1&o&&(n(0,"div"),f(1,"div",19),gr(2,vF,11,2,"div",20),f(3,"div",19),gr(4,mF,6,1,"div",20),f(5,"div",13),gr(6,_F,5,1,"div",20),f(7,"div",13),c()),2&o){var l=It(2);wt(2),h("ngForOf",vf(3,vp,l.scene.model)),wt(2),h("ngForOf",vf(5,vp,l.scene.triggers)),wt(2),h("ngForOf",vf(7,vp,l.scene.script.entities))}}function xF(o,u){if(1&o&&(n(0,"div",54),n(1,"a",55),Pt(2),c(),f(3,"br"),Pt(4),f(5,"br"),f(6,"img",18),c()),2&o){var l=It().$implicit,p=It(2);wt(1),h("routerLink","/scene-details/"+l.sourceName),wt(1),Gn(l.sourceName),wt(2),Pi(" ",l.sourceFieldMenuName,""),wt(2),h("src",p.environment.KUJATA_DATA_BASE_URL+"/metadata/makou-reactor/backgrounds/"+l.sourceName+".png",qi)}}function bF(o,u){if(1&o&&(B(0),gr(1,xF,7,4,"div",53),q()),2&o){var l=u.$implicit;wt(1),h("ngIf","inbound"==l.direction)}}function AF(o,u){if(1&o&&(n(0,"div",54),n(1,"a",55),Pt(2),c(),f(3,"br"),Pt(4),f(5,"br"),f(6,"img",18),c()),2&o){var l=It().$implicit,p=It(2);wt(1),h("routerLink","/scene-details/"+l.targetName),wt(1),Gn(l.targetName),wt(2),Pi(" ",l.targetFieldMenuName,""),wt(2),h("src",p.environment.KUJATA_DATA_BASE_URL+"/metadata/makou-reactor/backgrounds/"+l.targetName+".png",qi)}}function MF(o,u){if(1&o&&(B(0),gr(1,AF,7,4,"div",53),q()),2&o){var l=u.$implicit;wt(1),h("ngIf","outbound"==l.direction)}}function TF(o,u){1&o&&(n(0,"div",21),n(1,"div",3),Pt(2,"Entity Script Visualization (Experimental)"),c(),f(3,"div",13),n(4,"div",56),Yr.lFrame.currentNamespace=Hf,n(5,"svg",57),n(6,"style"),Pt(7," text { font-size: 8pt; } tspan { font-size: 8pt; } "),c(),c(),c(),c())}function EF(o,u){if(1&o&&(B(0),gr(1,TF,8,0,"div",20),q()),2&o){var l=It(2);wt(1),h("ngForOf",vf(1,vp,l.scene.model))}}function RF(o,u){if(1&o&&(n(0,"div",1),n(1,"div",2),n(2,"div",3),Pt(3),c(),n(4,"div",4),Pt(5),c(),c(),n(6,"div",2),n(7,"div",5),n(8,"div",6),n(9,"div",7),Pt(10,"Background"),c(),n(11,"div",8),f(12,"img",9),c(),c(),f(13,"div",10),n(14,"div"),n(15,"div",7),Pt(16,"Walkmesh"),c(),f(17,"div",11),c(),c(),c(),gr(18,oF,3,0,"div",12),gr(19,aF,3,0,"div",12),gr(20,SF,8,9,"div",12),f(21,"div",13),n(22,"div",14),n(23,"div",3),Pt(24,"Field Links (Experimental)"),c(),n(25,"div",4),Pt(26,"(Based on Gateway data and Mapjump Ops)"),c(),f(27,"div",13),n(28,"div",5),gr(29,bF,2,1,"ng-container",15),n(30,"div",16),Pt(31,"\u2192"),c(),B(32),n(33,"div",17),n(34,"b"),Pt(35),c(),f(36,"br"),n(37,"b"),Pt(38),c(),f(39,"br"),f(40,"img",18),c(),q(),n(41,"div",16),Pt(42,"\u2192"),c(),gr(43,MF,2,1,"ng-container",15),c(),c(),f(44,"div",13),gr(45,EF,2,3,"ng-container",12),c()),2&o){var l=It();wt(3),Gn(l.selectedFieldName),wt(2),Gn(l.selectedFieldMenuName),wt(7),h("src",l.environment.KUJATA_DATA_BASE_URL+"/metadata/makou-reactor/backgrounds/"+l.selectedFieldName+".png",qi),wt(6),h("ngIf","FETCHING"==l.fetchStatus),wt(1),h("ngIf","ERROR"==l.fetchStatus),wt(1),h("ngIf","SUCCESS"==l.fetchStatus),wt(9),h("ngForOf",l.fieldLinks),wt(6),Gn(l.selectedFieldName),wt(3),Gn(l.selectedFieldMenuName),wt(2),h("src",l.environment.KUJATA_DATA_BASE_URL+"/metadata/makou-reactor/backgrounds/"+l.selectedFieldName+".png",qi),wt(3),h("ngForOf",l.fieldLinks),wt(2),h("ngIf",l.scene)}}var DF=function(){var o=function(){function u(l,p){_(this,u),this.route=l,this.http=p,this.fetchStatus="NONE",this.fieldLinks=null,this.environment=Hn,this.mapList=null,this.sceneGraph=null,this.fieldIdToFieldMetadataMap=null,this.fieldNameToFieldMetadataMap=null,this.selectedFieldName=null,this.selectedFieldMenuName=null,this.GRID_X=150,this.GRID_Y=75,this.PSX_RES_X=320,this.PSX_RES_Y=224,this.NODE_SPACE_PROPORTION=.8,this.LABEL_LINE_LENGTH=18,this.DISPLAY_WIDTH=100,this.DISPLAY_HEIGHT=100,this.rendererGlobal=new lr.CP7({alpha:!0,antialias:!0}),this.displayMap=null,this.isDestroyed=!1,console.log("scene-details component constructor")}return w(u,[{key:"ngOnInit",value:function(){var p=this;console.log("scene-details component ngOnInit()"),this.clock=new lr.SUY;var m=Hn.KUJATA_DATA_BASE_URL+"/data/field/flevel.lgp/maplist.json";this.http.get(m).subscribe(function(S){p.mapList=S,console.log("this.mapList:",p.mapList),p.initialize()},function(S){p.fetchStatus="ERROR"}),this.http.get(m=Hn.KUJATA_DATA_BASE_URL+"/metadata/scene-graph.json").subscribe(function(S){p.sceneGraph=S,p.fieldIdToFieldMetadataMap={},p.fieldNameToFieldMetadataMap={};var P,M=I(p.sceneGraph.nodes);try{for(M.s();!(P=M.n()).done;){var N=P.value;p.fieldIdToFieldMetadataMap[N.id]=N,p.fieldNameToFieldMetadataMap[N.fieldName]=N}}catch(G){M.e(G)}finally{M.f()}p.initialize()},function(S){p.fetchStatus="ERROR"}),this.route.paramMap.subscribe(function(S){var M=S.get("name");p.selectedFieldName=M,p.initialize()})}},{key:"ngOnDestroy",value:function(){console.log("ngOnDestroy() called"),this.isDestroyed=!0}},{key:"idToMetadata",value:function(p){return this.fieldIdToFieldMetadataMap[p]}},{key:"fieldNameToMetadata",value:function(p){return this.fieldNameToFieldMetadataMap[p]}},{key:"idFor",value:function(p){return this.fieldNameToMetadata(p).id}},{key:"fieldNameFor",value:function(p){return this.idToMetadata(p).fieldName}},{key:"getFieldMenuName",value:function(p){var m=p.mapNames;return m.length>0?m[0]:p.fieldName}},{key:"initialize",value:function(){var p=this;if(null!=this.mapList&&null!=this.sceneGraph&&null!=this.selectedFieldName){console.log("ready to initialize!");var m=this.fieldNameToMetadata(this.selectedFieldName),S=m.id;this.selectedFieldMenuName=this.getFieldMenuName(m),this.fieldLinks=[];var G,M={},P={},N=I(this.sceneGraph.links);try{for(N.s();!(G=N.n()).done;){var ie=G.value;if(ie.source==S){var ye=this.idToMetadata(ie.target);P[ye.id]={direction:"outbound",sourceId:S,sourceName:this.selectedFieldName,targetId:ye.id,targetName:ye.fieldName,targetFieldMenuName:this.getFieldMenuName(ye)}}if(ie.target==S){var Ce=this.idToMetadata(ie.source);M[Ce.id]={direction:"inbound",sourceId:Ce.id,sourceName:Ce.fieldName,sourceFieldMenuName:this.getFieldMenuName(Ce),targetId:S,targetName:this.selectedFieldName}}}}catch(At){N.e(At)}finally{N.f()}for(var Le=0,qe=Object.keys(M);Le<qe.length;Le++)this.fieldLinks.push(M[qe[Le]]);for(var tt=0,et=Object.keys(P);tt<et.length;tt++)this.fieldLinks.push(P[et[tt]]);console.log("this.fieldLinks:",this.fieldLinks),this.fetchStatus="FETCHING",this.http.get(Hn.KUJATA_DATA_BASE_URL+"/data/field/flevel.lgp/"+this.selectedFieldName+".json").subscribe(function(At){p.fetchStatus="SUCCESS",p.scene=At,p.displays=[],p.displayMap={};for(var Tt=p.scene.model.modelLoaders,nr=0;nr<Tt.length;nr++){var yr=Tt[nr];yr.hrcIdShort=yr.hrcId.toLowerCase().replace(".hrc","");var wn=p.createEmptyDisplay({id:yr.hrcId,name:"TODO"},"model_display_"+nr,200,200);p.displays.push(wn),p.displayMap[yr.hrcId]=wn}setTimeout(function(){p.recursiveLoadSkeletonAndAddToDisplay(0)},250),setTimeout(function(){p.buildGraph()},250),p.createWalkmeshDisplay()},function(At){p.fetchStatus="ERROR"})}}},{key:"createWalkmeshDisplay",value:function(){console.log("Creating walkmesh display...");var p=document.getElementById("walkmesh-container");if(p){for(;p.firstChild;)p.removeChild(p.firstChild);var m=this.scene;console.log("flevel:",m);var S=m.cameraSection.cameras[0],M=2*Math.atan(240/(2*S.zoom))*57.29577951;this.walkmeshRenderer=new lr.CP7({alpha:!0,antialias:!0}),this.walkmeshRenderer.setSize(410,240),this.walkmeshScene=new lr.xsS,this.walkmeshScene.background=new lr.Ilk(2236962),this.walkmeshCamera=new lr.cPb(M,410/240,.001/4096,24.4140625);var ie=-S.yAxis.x/4096,ye=-S.yAxis.y/4096,Ce=-S.yAxis.z/4096,Le=S.zAxis.x/4096,qe=S.zAxis.y/4096,nt=S.zAxis.z/4096,tt=S.position.x/4096,et=-S.position.y/4096,Ze=S.position.z/4096,ht=-(tt*(S.xAxis.x/4096)+et*ie+Ze*Le),At=-(tt*(S.xAxis.y/4096)+et*ye+Ze*qe),Tt=-(tt*(S.xAxis.z/4096)+et*Ce+Ze*nt);this.walkmeshCamera.position.x=ht,this.walkmeshCamera.position.y=At,this.walkmeshCamera.position.z=Tt,this.walkmeshCamera.lookAt(ht+Le,At+qe,Tt+nt),this.walkmeshCamera.up.set(ie,ye,Ce),this.walkmeshCamera.updateProjectionMatrix(),this.walkmeshScene.add(this.walkmeshCamera);var nr=new lr.Ox3(16777215);nr.position.set(0,0,50).normalize(),this.walkmeshScene.add(nr);var yr=new lr.Mig(4210752);this.walkmeshScene.add(yr);for(var en=m.walkmeshSection.triangles.length,wn=0;wn<en;wn++){var Pn=m.walkmeshSection.triangles[wn],Hi=m.walkmeshSection.accessors[wn],qn=new lr.Pa4(Pn.vertices[0].x/4096,Pn.vertices[0].y/4096,Pn.vertices[0].z/4096),Ct=new lr.Pa4(Pn.vertices[1].x/4096,Pn.vertices[1].y/4096,Pn.vertices[1].z/4096),er=new lr.Pa4(Pn.vertices[2].x/4096,Pn.vertices[2].y/4096,Pn.vertices[2].z/4096),ur=function(Li,Wi,Js,G0){var R1=new lr.nls({color:-1==G0?4491468:8947848}),Ss=new lr.ZXM;Ss.vertices.push(Wi),Ss.vertices.push(Js);var D1=new lr.x12(Ss,R1);Li.add(D1)};ur(this.walkmeshScene,qn,Ct,Hi[0]),ur(this.walkmeshScene,Ct,er,Hi[1]),ur(this.walkmeshScene,er,qn,Hi[2])}var Jt,pr=I(m.triggers.gateways);try{for(pr.s();!(Jt=pr.n()).done;){var Mr=Jt.value,Jr=Mr.exitLineVertex1,Lr=Mr.exitLineVertex2,Ir=(qn=new lr.Pa4(Jr.x/4096,Jr.y/4096,Jr.z/4096),Ct=new lr.Pa4(Lr.x/4096,Lr.y/4096,Lr.z/4096),new lr.nls({color:16711680})),ni=new lr.ZXM;ni.vertices.push(qn),ni.vertices.push(Ct);var di=new lr.x12(ni,Ir);this.walkmeshScene.add(di)}}catch(Bn){pr.e(Bn)}finally{pr.f()}this.walkmeshControls=new lr.zxs(this.walkmeshCamera,this.walkmeshRenderer.domElement),this.walkmeshControls.target=new lr.Pa4(ht+Le,At+qe,Tt+nt),this.walkmeshControls.panSpeed=1/4,this.walkmeshControls.rotateSpeed=1/4,this.walkmeshControls.zoomSpeed=1/4,this.walkmeshControls.update(),p.appendChild(this.walkmeshRenderer.domElement),this.walkmeshRenderer.render(this.walkmeshScene,this.walkmeshCamera);var ii=this;!function Bn(){if(ii&&!ii.isDestroyed){requestAnimationFrame(Bn);var Li=ii.clock.getDelta();ii.walkmeshControls&&ii.walkmeshControls.update(Li),ii.walkmeshRenderer&&ii.walkmeshScene&&ii.walkmeshCamera&&ii.walkmeshRenderer.render(ii.walkmeshScene,ii.walkmeshCamera)}else console.log("stopping walkmeshTick()")}()}else console.log("WARN: Could not find walkmeshContainerElement")}},{key:"createEmptyDisplay",value:function(p,m,S,M){var P={containerId:m,skeleton:p,scene:new lr.xsS,camera:new lr.cPb(45,this.DISPLAY_WIDTH/this.DISPLAY_HEIGHT,.1,1e3),renderer:null};P.containerId=m,P.scene.background=new lr.Ilk(5263440),P.scene.add(P.camera);var N=new lr.Ox3(16777215);N.position.set(0,0,50).normalize(),P.scene.add(N);var G=new lr.Mig(4210752);return P.scene.add(G),P.camera.position.x=0,P.camera.position.y=33.53,P.camera.position.z=60,P.camera.lookAt(new lr.Pa4(0,13.53,0)),P}},{key:"getDisplay",value:function(p){return this.displayMap[p]}},{key:"showDisplay",value:function(p,m,S){var M=p.displays[m];M.renderer=p.rendererGlobal,M.renderer.setSize(this.DISPLAY_WIDTH,this.DISPLAY_HEIGHT);var P=document.getElementById(M.containerId);P?(P.appendChild(M.renderer.domElement),M.renderer.render(M.scene,M.camera),M.screenshotDataUrl=M.renderer.domElement.toDataURL(),M.renderer.dispose(),M.renderer=null):console.log("WARN: Could not find element by display.containerId, display: ",M)}},{key:"recursiveLoadSkeletonAndAddToDisplay",value:function(p){var m=this;if(!(p>=m.displays.length)){var S=m.displays[p],M=S.skeleton;(new lr.EPV).load(Hn.KUJATA_DATA_BASE_URL+"/data/field/char.lgp/"+M.id.toLowerCase()+".gltf",function(N){ip(N);var G=N.scene,ie=G.children[0];ie.position.x=0,ie.position.y=0,ie.position.z=0,S.scene.add(G),m.showDisplay(m,p,10),m.recursiveLoadSkeletonAndAddToDisplay(p+1)},void 0,function(N){console.error("oops!",N),m.recursiveLoadSkeletonAndAddToDisplay(p+1)})}}},{key:"addNodeToGraphAndMap",value:function(p){this.graph.nodes.push(p),this.nodeMap[p.id]=p}},{key:"buildGraph",value:function(){this.graph={rows:[],nodes:[],links:[]},this.nodeMap={};for(var m=0,S=0,M=[],P=0;P<this.scene.script.entities.length;P++)for(var N=this.scene.script.entities[P],G=0;G<N.scripts.length;G++){var ie=N.scripts[G];if(ie.ops.length<=1)console.log("Skipping script of length <= 1, ops = ",ie.ops);else{var ye=[];S=0;var Ce={type:"scriptStart",id:"scriptStart|"+P+"|"+G,row:m,col:S++,name:P+":"+N.entityName+", Script "+G,labelLines:[]};Ce.labelLines=this.stringToLines(Ce.name,this.LABEL_LINE_LENGTH),ye.push(Ce),this.addNodeToGraphAndMap(Ce);for(var Le=0;Le<ie.ops.length;Le++){var qe=ie.ops[Le],nt={type:"RET"==qe.op?"scriptEnd":"op",id:"op|"+P+"|"+G+"|"+Le,row:m,col:S++,name:qe.js,pres:qe.pres,labelLines:[]};nt.labelLines=this.stringToLines(nt.pres?nt.pres:nt.name,this.LABEL_LINE_LENGTH),ye.push(nt),this.addNodeToGraphAndMap(nt),this.graph.links.push({source:this.graph.nodes[this.graph.nodes.length-2],target:nt,type:"script"}),("REQ"==qe.op||"REQSW"==qe.op||"REQEW"==qe.op)&&M.push({source:nt,targetId:"scriptStart|"+qe.e+"|"+qe.f,type:"REQ"})}this.graph.rows.push(ye),m++}}for(var ht=0,At=M;ht<At.length;ht++){var Tt=At[ht];Tt.targetId&&!Tt.target&&(Tt.target=this.nodeMap[Tt.targetId],Tt.target?this.graph.links.push(Tt):console.log("WARNING: Did not show link for execution of empty script:",Tt))}this.drawGraph()}},{key:"getNodeCenterX",value:function(p){return(p.col+this.NODE_SPACE_PROPORTION)*this.GRID_X}},{key:"getNodeCenterY",value:function(p){return(p.row+this.NODE_SPACE_PROPORTION)*this.GRID_Y}},{key:"getNodeWidth",value:function(p){return this.GRID_X/2*this.NODE_SPACE_PROPORTION*2}},{key:"getNodeHeight",value:function(p){return this.GRID_Y/2*this.NODE_SPACE_PROPORTION*2}},{key:"getNodeRightEdgeX",value:function(p){return this.getNodeCenterX(p)+this.getNodeWidth(p)/2}},{key:"getNodeLeftEdgeX",value:function(p){return this.getNodeCenterX(p)-this.getNodeWidth(p)/2}},{key:"lastIndexOfMulti",value:function(p,m){var P,S=-1,M=I(m);try{for(M.s();!(P=M.n()).done;){var G=p.lastIndexOf(P.value);G>S&&(S=G)}}catch(ie){M.e(ie)}finally{M.f()}return S}},{key:"stringToLines",value:function(p,m){if(!m)throw new Error("maxLineLength required");for(var S=[],M=p;S.length<10;){if(M.length<=m)return S.push(M),S;var N=M.substring(0,m),G=this.lastIndexOfMulti(N,[" ","{","("]);-1==G&&(G=m);var ie=M.substring(0,G+1);S.push(ie),M=M.substring(G+1)}return console.log("WARNING: maxines reached!"),S}},{key:"drawGraph",value:function(){var p=this;console.log("graph:",this.graph);var m=function(o){return new Sa([[document.querySelector(o)]],[document.documentElement])}("svg");m.selectAll("g").remove();var S=m.append("g").attr("class","view"),M=S.append("g").attr("class","links").selectAll("line").data(this.graph.links).enter().append("line").attr("stroke-width",function(Ce){return 2}).attr("stroke",function(Ce){return"gray"}),P=S.append("g").attr("class","nodes").selectAll("g").data(this.graph.nodes).enter().append("g").attr("transform",function(Ce){return"translate("+p.getNodeCenterX(Ce)+" "+p.getNodeCenterY(Ce)+")"});M.attr("x1",function(Ce){return p.getNodeRightEdgeX(Ce.source)}).attr("y1",function(Ce){return p.getNodeCenterY(Ce.source)}).attr("x2",function(Ce){return p.getNodeLeftEdgeX(Ce.target)}).attr("y2",function(Ce){return p.getNodeCenterY(Ce.target)}),P.append("rect").attr("rx",function(Ce){return.05*p.GRID_X}).attr("ry",function(Ce){return.05*p.GRID_X}).attr("x",function(Ce){return-p.getNodeWidth(Ce)/2}).attr("y",function(Ce){return-p.getNodeHeight(Ce)/2}).attr("width",function(Ce){return p.getNodeWidth(Ce)}).attr("height",function(Ce){return p.getNodeHeight(Ce)}).attr("stroke",function(Ce){return"scriptStart"==Ce.type?"#339933":"scriptEnd"==Ce.type?"#993333":"gray"}).attr("stroke-width","2").attr("fill",function(Ce){return"white"});for(var G=P.append("text").attr("fill",function(Ce){return"#333"}).attr("x",0).attr("y",function(Ce){return Ce.labelLines||console.log("This does not have labelLines:",Ce),-Ce.labelLines.length/2-.5+"em"}).attr("text-anchor","middle").attr("alignment-baseline","central"),ie=function(Le){G.filter(function(qe){return qe.labelLines.length>Le}).append("tspan").attr("x",0).attr("dy","1em").attr("text-anchor","middle").attr("alignment-baseline","central").text(function(qe){return qe.labelLines[Le]})},ye=0;ye<10;ye++)ie(ye)}},{key:"onSelectHrcId",value:function(p){}}]),u}();return o.\u0275fac=function(l){return new(l||o)(dr(Ys),dr(zs))},o.\u0275cmp=Ei({type:o,selectors:[["scene-details"]],decls:1,vars:1,consts:[["style","background-color:#c0c0c0; padding:4px;",4,"ngIf"],[2,"background-color","#c0c0c0","padding","4px"],[2,"background-color","white","padding","4px","margin-bottom","4px"],[2,"font-size","20pt","color","#404040"],[2,"font-size","16pt","color","#808080"],[2,"display","flex","flex-flow","row wrap","align-items","flex-start","align-content","flex-start","font-size","10pt","background-color","#e0e0e0","padding","16px"],[2,"width","410px"],[2,"font-size","12pt","text-align","center"],[2,"width","410px","height","240px","background-color","#222222","text-align","center"],[2,"display","inline-block","max-width","410px","max-height","240px","width","auto","height","auto","padding","0px","margin","0",3,"src"],[2,"width","4px"],["id","walkmesh-container",2,"display","inline-block","width","410px","height","240px","background-color","#222222","padding","0px"],[4,"ngIf"],[2,"height","16px"],[2,"width","100%","height","100%","padding","16px","background-color","white"],[4,"ngFor","ngForOf"],[2,"padding","100px 8px 8px 8px"],[2,"width","200px","height","250px","text-align","center","background-color","white","border","solid #555 2px"],[2,"max-width","200px","max-height","200px","width","auto","height","auto",3,"src"],[2,"height","1em"],["style","background-color:white; padding:16px;",4,"ngFor","ngForOf"],[2,"background-color","white","padding","16px"],[2,"height","8px"],[2,"font-weight","bold"],[2,"display","flex","flex-flow","row wrap","align-items","flex-start","align-content","flex-start","background-color","#e0e0e0","padding","16px","margin-bottom","16px"],["style","font-size:8pt; background-color:white; width:260px; height:450px; padding:16px; margin:0px 16px 16px 0px;",4,"ngFor","ngForOf"],[2,"font-size","8pt","background-color","white","width","260px","height","450px","padding","16px","margin","0px 16px 16px 0px"],["style","background-color:white; margin:16px 16px 16px 16px;",4,"ngFor","ngForOf"],[2,"font-size","10pt","margin","auto","text-align","center"],[2,"height","1.0em"],[3,"href"],[2,"background-color","white","margin","16px 16px 16px 16px"],["style","margin:auto; background-color:#808080",3,"width","height","id",4,"ngIf"],["style","margin:auto; background-color:white",3,"width","height",4,"ngIf"],[2,"margin","auto","background-color","#808080",3,"id"],[2,"margin","auto","background-color","white"],[3,"src"],[2,"display","inline-block","width","0.75em","height","0.75em","border","solid #808080 1px"],["style","font-size:8pt; border:solid #e0e0e0 1px; width:100; height:64; margin-right:16px; margin-bottom:16px; padding:16px; background-color:white;",4,"ngFor","ngForOf"],[2,"font-size","8pt","border","solid #e0e0e0 1px","width","100","height","64","margin-right","16px","margin-bottom","16px","padding","16px","background-color","white"],[2,"font-size","10pt"],[3,"routerLink","click"],["style","font-size:8pt; background-color:#e0e0e0; padding:16px; margin-bottom:16px; ",4,"ngFor","ngForOf"],[2,"font-size","8pt","background-color","#e0e0e0","padding","16px","margin-bottom","16px"],[2,"font-size","14pt","color","#404040"],[2,"font-size","12pt","color","#808080"],["style","background-color:white; padding:8px; margin-bottom:8px;",4,"ngFor","ngForOf"],[2,"background-color","white","padding","8px","margin-bottom","8px"],[2,"height","0.5em"],["style","font-size:8pt","class","kujata-font-mono",4,"ngFor","ngForOf"],[1,"kujata-font-mono",2,"font-size","8pt"],[2,"display","inline-block","width","24em"],[2,"display","inline-block"],["style","width:200px; height:250px; text-align:center;",4,"ngIf"],[2,"width","200px","height","250px","text-align","center"],[3,"routerLink"],[2,"width","100%","height","100%","padding","0","margin","0","background-color","#e0e0e0"],["width","100%","height","800",2,"margin","0","padding","0","font-family","'Fira Mono', monospace"]],template:function(l,p){1&l&&gr(0,RF,46,12,"div",0),2&l&&h("ngIf",p.selectedFieldName)},directives:[Ws,bu,ws],styles:[""]}),o}();function OF(o,u){if(1&o&&(n(0,"a",12),n(1,"div",13),n(2,"div",14),Pt(3,"0x"),n(4,"b"),Pt(5),c(),c(),n(6,"div",15),Pt(7),c(),c(),n(8,"div",16),n(9,"div",17),Pt(10),c(),c(),c()),2&o){var l=u.$implicit,p=It(3);h("routerLink","/field-op-code-details/"+l),wt(5),Gn(l),wt(2),Gn(p.opMetadata[l].shortName),wt(3),Gn(p.opMetadata[l].description||l)}}function PF(o,u){if(1&o&&(n(0,"div"),n(1,"div",9),Pt(2),c(),n(3,"div",10),gr(4,OF,11,4,"a",11),c(),c()),2&o){var l=u.$implicit;wt(2),Gn(l.name),wt(2),h("ngForOf",l.opCodes)}}function FF(o,u){if(1&o&&(n(0,"a",18),n(1,"div",14),Pt(2,"0x"),n(3,"b"),Pt(4),c(),c(),c()),2&o){var l=u.$implicit;h("routerLink","/field-op-code-details/"+l),wt(4),Gn(l)}}function LF(o,u){if(1&o&&(n(0,"div",4),n(1,"div",5),Pt(2,"Arranged by Category"),c(),f(3,"div",2),gr(4,PF,5,2,"div",6),f(5,"div",2),n(6,"div",5),Pt(7,"All OpCodes in Numerical Order"),c(),f(8,"div",2),n(9,"div",7),gr(10,FF,5,2,"a",8),c(),c()),2&o){var l=It();wt(4),h("ngForOf",l.opCategories),wt(6),h("ngForOf",l.opCodes)}}var NF=function(){var o=function(){function u(l){_(this,u),this.http=l,this.opCategories=[],this.opCodes=[],this.Object=Object}return w(u,[{key:"ngOnInit",value:function(){var p=this;this.http.get(Hn.KUJATA_DATA_BASE_URL+"/metadata/op-categories.json").subscribe(function(S){p.opCategories=S,p.http.get(Hn.KUJATA_DATA_BASE_URL+"/metadata/op-metadata.json").subscribe(function(P){p.opMetadata=P;for(var N=0,G=Object.keys(P);N<G.length;N++)p.opCodes.push(G[N]);p.opCodes.sort()})})}}]),u}();return o.\u0275fac=function(l){return new(l||o)(dr(zs))},o.\u0275cmp=Ei({type:o,selectors:[["field-op-codes"]],decls:5,vars:1,consts:[[2,"background-color","white","padding","4px","margin-bottom","4px"],[2,"font-size","24pt","color","#404040"],[2,"height","16px"],["style","font-size:12pt;",4,"ngIf"],[2,"font-size","12pt"],[2,"font-size","20pt","color","#404040"],[4,"ngFor","ngForOf"],[2,"display","flex","flex-flow","row wrap","align-items","flex-start","align-content","flex-start","font-size","10pt"],["style","border:solid white 2px; color: #404040; margin:0px 4px 4px 0px; text-align:center; text-decoration:none; ",3,"routerLink",4,"ngFor","ngForOf"],[2,"font-size","16pt","color","#404040"],[1,"op-cards-container"],["class","op-card",3,"routerLink",4,"ngFor","ngForOf"],[1,"op-card",3,"routerLink"],[2,"height","2em"],[1,"op-code"],[1,"op-short-name"],[2,"height","4em"],[1,"op-description"],[2,"border","solid white 2px","color","#404040","margin","0px 4px 4px 0px","text-align","center","text-decoration","none",3,"routerLink"]],template:function(l,p){1&l&&(n(0,"div",0),n(1,"div",1),Pt(2,"Field Op Codes"),c(),f(3,"div",2),gr(4,LF,11,2,"div",3),c()),2&l&&(wt(4),h("ngIf",p.opMetadata))},directives:[Ws,bu,ws],styles:[".op-cards-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;align-items:flex-start;align-content:flex-start;font-size:10pt;background-color:silver;padding:4px}.op-card[_ngcontent-%COMP%]{width:150px;height:120px;border:solid white 2px;background-color:#fff;color:#404040;margin:0 4px 4px 0;text-align:center;text-decoration:none;padding:4px}.op-card[_ngcontent-%COMP%]:hover{background-color:#fff;border:solid black 2px}.op-code[_ngcontent-%COMP%]{display:inline-block;width:50px;padding:4px;background-color:#d22;color:#fff}.op-short-name[_ngcontent-%COMP%]{display:inline-block;width:80px;padding:4px;background-color:gray;color:#fff}.op-description[_ngcontent-%COMP%]{display:inline-block;padding:4px;color:#404040}"]}),o}();function IF(o,u){1&o&&(n(0,"div"),n(1,"p"),Pt(2,"Fetching..."),c(),c())}function kF(o,u){1&o&&(n(0,"div"),n(1,"p"),Pt(2,"Sorry, this app had a problem getting that info."),c(),c())}function BF(o,u){if(1&o){var l=Se();n(0,"div"),n(1,"p"),n(2,"a",4),rt("click",function(){return es(l),It(2).exportToCsv()}),Pt(3,"Export To CSV"),c(),c(),f(4,"ag-grid-angular",5),j3(5,"async"),c()}if(2&o){var p=It(2);wt(4),h("gridOptions",p.gridOptions)("rowData",X3(5,3,p.rowData))("columnDefs",p.columnDefs)}}function GF(o,u){if(1&o&&(n(0,"div",2),n(1,"h2"),Pt(2),c(),n(3,"h3"),Pt(4,"Usages"),c(),gr(5,IF,3,0,"div",3),gr(6,kF,3,0,"div",3),gr(7,BF,6,5,"div",3),c()),2&o){var l=It();wt(2),vs("Op Code ",l.selectedOpCode," - ",l.selectedOpDescription,""),wt(3),h("ngIf","FETCHING"==l.fetchStatus),wt(1),h("ngIf","ERROR"==l.fetchStatus),wt(1),h("ngIf","SUCCESS"==l.fetchStatus)}}var VF=function(){var o=function(){function u(l,p,m){_(this,u),this.route=l,this.router=p,this.http=m,this.selectedOpCode=null,this.selectedOpDescription="...loading...",this.selectedOpMetadata=null,this.usages=[],this.fetchStatus="NONE",this.Object=Object,this.columnDefs=[],this.rowData=an([]),this.friendlyColumnNames={routerLink:"Router Link",fieldName:"Field",entityName:"Entity",scriptIndex:"Script",opIndex:"Line",raw:"Raw",mr:"Makou Reactor translation",js:"Javascript translation (experimental)",pres:"Dramatization (experimental)"},this.columnWidths={fieldName:100,entityName:100,op:100,mr:400,js:400,pres:400}}return w(u,[{key:"ngOnInit",value:function(){var p=this;this.gridOptions={rowData:this.rowData,columnDefs:this.columnDefs,rowSelection:"single",onRowClicked:function(M){console.log("a row was clicked")},onColumnResized:function(M){console.log("a column was resized")},onGridReady:function(M){console.log("the grid is now ready")},suppressNoRowsOverlay:!0};var m=Hn.KUJATA_DATA_BASE_URL+"/metadata/op-metadata.json";this.http.get(m).subscribe(function(S){p.opMetadata=S,p.initialize()}),this.http.get(m=Hn.KUJATA_DATA_BASE_URL+"/metadata/op-metadata.json").subscribe(function(S){p.opMetadata=S,p.initialize()}),this.route.paramMap.subscribe(function(S){p.selectedOpCode=S.get("hex"),p.initialize()})}},{key:"addColumnDef",value:function(p,m){var S={headerName:this.friendlyColumnNames[p]||p,field:p,width:m,sortable:!0,filter:!0,resizable:!0,onCellClicked:void 0,cellStyle:void 0,cellRenderer:void 0};"fieldName"==p&&(S.cellRenderer=function(M){return'<a href="scene-details/'.concat(M.value,'">').concat(M.value,"</a>")}),this.columnDefs.push(S)}},{key:"initialize",value:function(){var p=this;this.opMetadata&&this.selectedOpCode&&(this.selectedOpMetadata=this.opMetadata[this.selectedOpCode],this.selectedOpDescription="".concat(this.selectedOpMetadata.shortName," - ").concat(this.selectedOpMetadata.description),this.fetchStatus="FETCHING",this.gridOptions.api&&this.gridOptions.api.showLoadingOverlay(),this.http.get(Hn.KUJATA_DATA_BASE_URL+"/metadata/op-code-usages/"+this.selectedOpCode+".json").subscribe(function(S){if(p.fetchStatus="SUCCESS",p.usages=S,p.rowData=an(p.usages),p.columnDefs=[],p.usages.length>0)for(var M=p.usages[0],P=0,N=Object.keys(M);P<N.length;P++){var G=N[P];"op"==G&&p.addColumnDef("raw",60+6*M.raw.length),"raw"!=G&&p.addColumnDef(G,p.columnWidths[G]||75)}p.gridOptions.api&&p.gridOptions.api.hideOverlay()},function(S){p.fetchStatus="ERROR"}))}},{key:"exportToCsv",value:function(){this.gridOptions.api.exportDataAsCsv({})}}]),u}();return o.\u0275fac=function(l){return new(l||o)(dr(Ys),dr(Ho),dr(zs))},o.\u0275cmp=Ei({type:o,selectors:[["field-op-code-details"]],decls:2,vars:1,consts:[[2,"background-color","#e0e0e0","padding","16px","margin-bottom","16px"],["style","background-color:white; padding:16px;",4,"ngIf"],[2,"background-color","white","padding","16px"],[4,"ngIf"],[3,"routerLink","click"],[1,"ag-theme-balham",2,"width","100%","height","500px",3,"gridOptions","rowData","columnDefs"]],template:function(l,p){1&l&&(n(0,"div",0),gr(1,GF,8,5,"div",1),c()),2&l&&(wt(1),h("ngIf",p.selectedOpCode))},directives:[Ws,ws,P8],pipes:[E9],styles:[""]}),o}();function UF(o,u){1&o&&f(0,"div",13),2&o&&h("id",It().$implicit.containerId)}function HF(o,u){if(1&o&&(n(0,"div",14),f(1,"img",15),c()),2&o){var l=It().$implicit;wt(1),h("src",l.screenshotDataUrl,qi)}}function WF(o,u){if(1&o&&(n(0,"a",7),gr(1,UF,1,1,"div",8),gr(2,HF,2,1,"div",9),n(3,"div",10),n(4,"div",11),n(5,"b"),Pt(6),c(),c(),n(7,"div",11),Pt(8),c(),n(9,"div",12),n(10,"b"),Pt(11),c(),c(),c(),c()),2&o){var l=u.$implicit;h("routerLink","/field-model-details/"+l.skeleton.id),wt(1),h("ngIf",!l.screenshotDataUrl),wt(1),h("ngIf",l.screenshotDataUrl),wt(4),Gn(l.skeleton.friendlyName),wt(2),vs("",l.skeleton.id," \xb7 ",l.skeleton.numBones," bones"),wt(3),Gn(l.skeleton.name)}}function zF(o,u){if(1&o&&(n(0,"tr"),n(1,"td"),Pt(2),c(),n(3,"td"),Pt(4),c(),c()),2&o){var l=It().$implicit;wt(2),Gn(l.id),wt(2),Gn(l.name)}}function jF(o,u){if(1&o&&(B(0),gr(1,zF,5,2,"tr",6),q()),2&o){var l=u.$implicit,p=It().$implicit;wt(1),h("ngIf",l.numBones==p)}}function XF(o,u){if(1&o&&(n(0,"tr"),n(1,"td"),Pt(2),c(),n(3,"td"),Pt(4),c(),c()),2&o){var l=It().$implicit;wt(2),Gn(l.id),wt(2),Gn(l.numFrames)}}function YF(o,u){if(1&o&&(B(0),gr(1,XF,5,2,"tr",6),q()),2&o){var l=u.$implicit,p=It().$implicit;wt(1),h("ngIf",l.numBones==p)}}function qF(o,u){if(1&o&&(n(0,"div",19),n(1,"h2",20),Pt(2),c(),n(3,"div",21),n(4,"div",22),n(5,"h3"),Pt(6,"Field Models"),c(),n(7,"table"),n(8,"thead"),n(9,"tr"),n(10,"th"),Pt(11,"id"),c(),n(12,"th"),Pt(13,"name"),c(),c(),c(),n(14,"tbody"),gr(15,jF,2,1,"ng-container",23),c(),c(),c(),n(16,"div",24),n(17,"h3"),Pt(18,"Field Animations"),c(),n(19,"table"),n(20,"thead"),n(21,"tr"),n(22,"th"),Pt(23,"id"),c(),n(24,"th"),Pt(25,"numFrames"),c(),c(),c(),n(26,"tbody"),gr(27,YF,2,1,"ng-container",23),c(),c(),c(),c(),f(28,"div",3),c()),2&o){var l=u.$implicit,p=It(3);wt(2),Pi("Models with ",l," bones"),wt(13),h("ngForOf",p.database.skeletons),wt(12),h("ngForOf",p.database.animations)}}function KF(o,u){if(1&o&&(n(0,"div",17),f(1,"div",3),gr(2,qF,29,3,"div",18),c()),2&o){var l=It(2);wt(2),h("ngForOf",l.uniqueBoneCounts)}}function QF(o,u){if(1&o&&(B(0),gr(1,KF,3,1,"div",16),q()),2&o){var l=It();wt(1),h("ngIf",l.database)}}var JF=function(){var o=function(){function u(l){_(this,u),this.http=l,this.environment=Hn,this.rendererGlobal=new lr.CP7({alpha:!0,antialias:!0}),this.isDestroyed=!1}return w(u,[{key:"ngOnInit",value:function(){var p=this;this.displays=[],this.status="Loading skeleton info from database...",this.http.get(Hn.KUJATA_DATA_BASE_URL+"/metadata/skeleton-friendly-names.json").subscribe(function(m){p.http.get(Hn.KUJATA_DATA_BASE_URL+"/metadata/ifalna.json").subscribe(function(S){p.http.get(Hn.KUJATA_DATA_BASE_URL+"/metadata/ff7-database.json").subscribe(function(M){p.database=M,p.sortDatabaseRows(),p.createUniqueBoneCounts(),p.clock=new lr.SUY;for(var P=p.database.skeletons,G=0;G<P.length;G++){var ie=P[G];ie.friendlyName=m[ie.id.toLowerCase()],ie.ifalna=S[ie.id.toUpperCase()];var ye=p.createEmptyDisplay(ie,"ff7_scene_container"+G,200,200);p.displays.push(ye)}p.recursiveLoadSkeletonAndAddToDisplay(0)})})})}},{key:"ngOnChanges",value:function(p){console.log("simpleChanges:",p)}},{key:"ngOnDestroy",value:function(){console.log("ngOnDestroy() called"),this.isDestroyed=!0}},{key:"showDisplay",value:function(p,m,S){var M=p.displays[m];M.renderer=p.rendererGlobal,M.renderer.setSize(150,150),document.getElementById(M.containerId).appendChild(M.renderer.domElement),M.renderer.render(M.scene,M.camera),M.screenshotDataUrl=M.renderer.domElement.toDataURL(),M.renderer.dispose(),M.renderer=null}},{key:"createEmptyDisplay",value:function(p,m,S,M){var P={containerId:m,skeleton:p,scene:new lr.xsS,camera:new lr.cPb(75,S/M,.1,1e3),renderer:null};P.containerId=m,P.scene.background=new lr.Ilk(5263440),P.scene.add(P.camera);var N=new lr.Ox3(16777215);N.position.set(0,0,50).normalize(),P.scene.add(N);var G=new lr.Mig(4210752);return P.scene.add(G),P.camera.position.x=0,P.camera.position.y=13.53,P.camera.position.z=50,P.camera.rotation.x=0*Math.PI/180,P}},{key:"recursiveLoadSkeletonAndAddToDisplay",value:function(p){var m=this;if(m&&!m.isDestroyed)if(p>=m.displays.length)this.status="Finished.";else{var S=m.displays[p],M=S.skeleton;this.status="Loading skeleton model "+M.id+" ("+M.name+")...",(new lr.EPV).load(Hn.KUJATA_DATA_BASE_URL+"/data/field/char.lgp/"+M.id+".hrc.gltf",function(N){if(m&&!m.isDestroyed){ip(N);var G=N.scene,ie=G.children[0];ie.position.x=0,ie.position.y=0,ie.position.z=0,S.scene.add(G),m.showDisplay(m,p,10),m.recursiveLoadSkeletonAndAddToDisplay(p+1)}else console.log("ignoring gltf load() callback")},void 0,function(N){console.error("oops!",N),m.recursiveLoadSkeletonAndAddToDisplay(p+1)})}else console.log("stopping recursive loading")}},{key:"sortDatabaseRows",value:function(){}},{key:"createUniqueBoneCounts",value:function(){var p=this;this.boneCountSet=new Set;var S,m=I(this.database.skeletons);try{for(m.s();!(S=m.n()).done;)this.boneCountSet.add(S.value.numBones)}catch(P){m.e(P)}finally{m.f()}console.log("this.boneCountSet:",this.boneCountSet),this.uniqueBoneCounts=[],this.boneCountSet.forEach(function(P){p.uniqueBoneCounts.push(P)}),this.uniqueBoneCounts.sort(function(P,N){return P<N?-1:P>N?1:0})}}]),u}();return o.\u0275fac=function(l){return new(l||o)(dr(zs))},o.\u0275cmp=Ei({type:o,selectors:[["field-models"]],features:[Oa],decls:8,vars:3,consts:[[2,"background-color","#c0c0c0"],[2,"padding","4px"],[2,"background-color","white","padding","4px","width","308px","font-size","10pt"],[2,"height","1em"],[2,"display","flex","flex-wrap","wrap"],["class","display-box",3,"routerLink",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"display-box",3,"routerLink"],["class","scene-container",3,"id",4,"ngIf"],["class","scene-container",4,"ngIf"],[2,"height","25px"],[2,"text-align","center"],[2,"text-align","center","font-size","10pt"],[1,"scene-container",3,"id"],[1,"scene-container"],[3,"src"],["style","background-color:#e0e0e0",4,"ngIf"],[2,"background-color","#e0e0e0"],["style","background-color:white; margin:8px; padding:8px; border-radius:8px;",4,"ngFor","ngForOf"],[2,"background-color","white","margin","8px","padding","8px","border-radius","8px"],[2,"margin","auto"],[2,"display","grid","grid-template-columns","50% 50%","grid-template-rows","auto auto"],[2,"grid-row","1","grid-column","1/2"],[4,"ngFor","ngForOf"],[2,"grid-row","1","grid-column","2/3"]],template:function(l,p){1&l&&(n(0,"div",0),n(1,"div",1),n(2,"div",2),Pt(3),c(),c(),f(4,"div",3),n(5,"div",4),gr(6,WF,12,7,"a",5),c(),c(),gr(7,QF,2,1,"ng-container",6)),2&l&&(wt(3),Pi(" ",p.status," "),wt(3),h("ngForOf",p.displays),wt(1),h("ngIf",!1))},directives:[bu,Ws,ws],styles:[".display-box[_ngcontent-%COMP%]{width:150px;height:250px;background-color:#fff;margin:4px;color:#404040;text-decoration:none}.scene-container[_ngcontent-%COMP%]{width:150px;height:150px;margin:0;padding:0;background-color:gray}"]}),o}();function ZF(o,u){1&o&&f(0,"div",12),2&o&&h("id",It().$implicit.containerId)}function $F(o,u){if(1&o&&(n(0,"div",13),f(1,"img",14),c()),2&o){var l=It().$implicit;wt(1),h("src",l.screenshotDataUrl,qi)}}function eL(o,u){if(1&o&&(n(0,"a",7),gr(1,ZF,1,1,"div",8),gr(2,$F,2,1,"div",9),n(3,"div",10),n(4,"div",11),n(5,"b"),Pt(6),c(),c(),n(7,"div",11),Pt(8),c(),c(),c()),2&o){var l=u.$implicit;h("routerLink","/battle-model-details/"+l.skeleton.id),wt(1),h("ngIf",!l.screenshotDataUrl),wt(1),h("ngIf",l.screenshotDataUrl),wt(4),Gn(l.skeleton.name),wt(2),Gn(l.skeleton.id)}}function tL(o,u){if(1&o&&(n(0,"tr"),n(1,"td"),Pt(2),c(),n(3,"td"),Pt(4),c(),c()),2&o){var l=It().$implicit;wt(2),Gn(l.id),wt(2),Gn(l.name)}}function rL(o,u){if(1&o&&(B(0),gr(1,tL,5,2,"tr",6),q()),2&o){var l=u.$implicit,p=It().$implicit;wt(1),h("ngIf",l.numBones==p)}}function nL(o,u){if(1&o&&(n(0,"tr"),n(1,"td"),Pt(2),c(),n(3,"td"),Pt(4),c(),c()),2&o){var l=It().$implicit;wt(2),Gn(l.id),wt(2),Gn(l.numFrames)}}function iL(o,u){if(1&o&&(B(0),gr(1,nL,5,2,"tr",6),q()),2&o){var l=u.$implicit,p=It().$implicit;wt(1),h("ngIf",l.numBones==p)}}function oL(o,u){if(1&o&&(n(0,"div",18),n(1,"h2",19),Pt(2),c(),n(3,"div",20),n(4,"div",21),n(5,"h3"),Pt(6,"Battle Models"),c(),n(7,"table"),n(8,"thead"),n(9,"tr"),n(10,"th"),Pt(11,"id"),c(),n(12,"th"),Pt(13,"name"),c(),c(),c(),n(14,"tbody"),gr(15,rL,2,1,"ng-container",22),c(),c(),c(),n(16,"div",23),n(17,"h3"),Pt(18,"Battle Animations"),c(),n(19,"table"),n(20,"thead"),n(21,"tr"),n(22,"th"),Pt(23,"id"),c(),n(24,"th"),Pt(25,"numFrames"),c(),c(),c(),n(26,"tbody"),gr(27,iL,2,1,"ng-container",22),c(),c(),c(),c(),f(28,"div",3),c()),2&o){var l=u.$implicit,p=It(3);wt(2),Pi("Models with ",l," bones"),wt(13),h("ngForOf",p.database.skeletons),wt(12),h("ngForOf",p.database.animations)}}function aL(o,u){if(1&o&&(n(0,"div",16),f(1,"div",3),gr(2,oL,29,3,"div",17),c()),2&o){var l=It(2);wt(2),h("ngForOf",l.uniqueBoneCounts)}}function sL(o,u){if(1&o&&(B(0),gr(1,aL,3,1,"div",15),q()),2&o){var l=It();wt(1),h("ngIf",l.database)}}var lL=function(){var o=function(){function u(l){_(this,u),this.http=l,this.environment=Hn,this.rendererGlobal=new lr.CP7({alpha:!0,antialias:!0}),this.isDestroyed=!1}return w(u,[{key:"ngOnInit",value:function(){var p=this;this.displays=[],this.status="Loading skeleton info from database...",this.http.get(Hn.KUJATA_DATA_BASE_URL+"/metadata/ff7-battle-database.json").subscribe(function(m){p.battleModelList=m,p.clock=new lr.SUY;for(var M=0;M<p.battleModelList.length;M++){var N=p.createEmptyDisplay(p.battleModelList[M],"ff7_scene_container"+M,200,200);p.displays.push(N)}p.recursiveLoadSkeletonAndAddToDisplay(0)})}},{key:"ngOnChanges",value:function(p){console.log("simpleChanges:",p)}},{key:"ngOnDestroy",value:function(){console.log("ngOnDestroy() called"),this.isDestroyed=!0}},{key:"showDisplay",value:function(p,m,S){var M=p.displays[m];M.renderer=p.rendererGlobal,M.renderer.setSize(150,150),document.getElementById(M.containerId).appendChild(M.renderer.domElement),M.renderer.render(M.scene,M.camera),M.screenshotDataUrl=M.renderer.domElement.toDataURL(),M.renderer.dispose(),M.renderer=null}},{key:"createEmptyDisplay",value:function(p,m,S,M){var P={containerId:m,skeleton:p,scene:new lr.xsS,camera:new lr.cPb(90,S/M,.1,1e3),renderer:null};P.containerId=m,P.scene.background=new lr.Ilk(5263440),P.scene.add(P.camera);var N=new lr.Ox3(16777215);N.position.set(0,0,50).normalize(),P.scene.add(N);var G=new lr.Mig(4210752);return P.scene.add(G),P.camera.position.x=0,P.camera.position.y=0,P.camera.position.z=0,P.camera.rotation.x=0*Math.PI/180,P}},{key:"fitCameraToCenteredObject",value:function(p,m,S,M){var P=new lr.ZzF;P.setFromObject(m),new lr.Pa4;var G=new lr.Pa4;P.getSize(G);var ie=p.fov*(Math.PI/180),ye=2*Math.atan(Math.tan(ie/2)*p.aspect),Ce=G.z/2+Math.abs(G.x/2/Math.tan(ye/2)),Le=G.z/2+Math.abs(G.y/2/Math.tan(ie/2)),qe=Math.max(Ce,Le);void 0!==S&&0!==S&&(qe*=S),p.position.set(0,G.y/2,qe);var nt=P.min.z,tt=nt<0?-nt+qe:qe-nt;p.far=3*tt,p.updateProjectionMatrix(),void 0!==M&&(M.target=new lr.Pa4(0,0,0),M.maxDistance=2*tt)}},{key:"recursiveLoadSkeletonAndAddToDisplay",value:function(p){var m=this;if(m&&!m.isDestroyed)if(p>=m.displays.length)this.status="Finished.";else{var S=m.displays[p],M=S.skeleton;this.status="Loading skeleton model "+M.id+" ("+M.name+")...",(new lr.EPV).load(Hn.KUJATA_DATA_BASE_URL+"/data/battle/battle.lgp/"+M.id+".hrc.gltf",function(N){if(m&&!m.isDestroyed){ip(N);var G=N.scene,ie=G.children[0];ie.position.x=0,ie.position.y=0,ie.position.z=0,S.scene.add(G),m.fitCameraToCenteredObject(S.camera,G,void 0,void 0),m.showDisplay(m,p,10),m.recursiveLoadSkeletonAndAddToDisplay(p+1)}else console.log("ignoring gltf load() callback")},void 0,function(N){console.error("oops!",N),m.recursiveLoadSkeletonAndAddToDisplay(p+1)})}else console.log("stopping recursive loading")}}]),u}();return o.\u0275fac=function(l){return new(l||o)(dr(zs))},o.\u0275cmp=Ei({type:o,selectors:[["battle-models"]],features:[Oa],decls:8,vars:3,consts:[[2,"background-color","#c0c0c0"],[2,"padding","4px"],[2,"background-color","white","padding","4px","width","308px","font-size","10pt"],[2,"height","1em"],[2,"display","flex","flex-wrap","wrap"],["class","display-box",3,"routerLink",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"display-box",3,"routerLink"],["class","scene-container",3,"id",4,"ngIf"],["class","scene-container",4,"ngIf"],[2,"height","25px"],[2,"text-align","center"],[1,"scene-container",3,"id"],[1,"scene-container"],[3,"src"],["style","background-color:#e0e0e0",4,"ngIf"],[2,"background-color","#e0e0e0"],["style","background-color:white; margin:8px; padding:8px; border-radius:8px;",4,"ngFor","ngForOf"],[2,"background-color","white","margin","8px","padding","8px","border-radius","8px"],[2,"margin","auto"],[2,"display","grid","grid-template-columns","50% 50%","grid-template-rows","auto auto"],[2,"grid-row","1","grid-column","1/2"],[4,"ngFor","ngForOf"],[2,"grid-row","1","grid-column","2/3"]],template:function(l,p){1&l&&(n(0,"div",0),n(1,"div",1),n(2,"div",2),Pt(3),c(),c(),f(4,"div",3),n(5,"div",4),gr(6,eL,9,5,"a",5),c(),c(),gr(7,sL,2,1,"ng-container",6)),2&l&&(wt(3),Pi(" ",p.status," "),wt(3),h("ngForOf",p.displays),wt(1),h("ngIf",!1))},directives:[bu,Ws,ws],styles:[".display-box[_ngcontent-%COMP%]{width:150px;height:250px;background-color:#fff;margin:4px;color:#404040;text-decoration:none}.scene-container[_ngcontent-%COMP%]{width:150px;height:150px;margin:0;padding:0;background-color:gray}"]}),o}();function uL(o,u){if(1&o){var l=Se();n(0,"div",11),rt("click",function(){var P=es(l).$implicit;return It(2).onSelectAnimation(P)}),Pt(1),c()}if(2&o){var p=u.$implicit,m=It(2);wt(1),vs(" ",p," (",m.metadata.animationStats.stand[p],") ")}}function cL(o,u){if(1&o){var l=Se();n(0,"div",11),rt("click",function(){var P=es(l).$implicit;return It(2).onSelectAnimation(P)}),Pt(1),c()}if(2&o){var p=u.$implicit,m=It(2);wt(1),vs(" ",p," (",m.metadata.animationStats.walk[p],") ")}}function fL(o,u){if(1&o){var l=Se();n(0,"div",11),rt("click",function(){var P=es(l).$implicit;return It(2).onSelectAnimation(P)}),Pt(1),c()}if(2&o){var p=u.$implicit,m=It(2);wt(1),vs(" ",p," (",m.metadata.animationStats.run[p],") ")}}function dL(o,u){if(1&o){var l=Se();n(0,"div",11),rt("click",function(){var P=es(l).$implicit;return It(2).onSelectAnimation(P)}),Pt(1),c()}if(2&o){var p=u.$implicit,m=It(2);wt(1),vs(" ",p," (",m.metadata.animationStats.other[p],") ")}}function hL(o,u){if(1&o&&(n(0,"div",12),Pt(1),c()),2&o){var l=u.$implicit,p=It(2);wt(1),vs(" ",l," (",p.metadata.fieldStats[l],") ")}}function pL(o,u){if(1&o&&(n(0,"div",2),n(1,"h2"),Pt(2),c(),n(3,"h3"),Pt(4),c(),n(5,"h4"),Pt(6),c(),n(7,"div",3),n(8,"div",4),n(9,"h4"),Pt(10,"Model"),c(),f(11,"div",5),c(),n(12,"div",6),n(13,"h4"),Pt(14,"Animations"),c(),n(15,"div",7),n(16,"h5"),Pt(17,"Stand"),c(),gr(18,uL,2,2,"div",8),c(),n(19,"div",7),n(20,"h5"),Pt(21,"Walk"),c(),gr(22,cL,2,2,"div",8),c(),n(23,"div",7),n(24,"h5"),Pt(25,"Run"),c(),gr(26,fL,2,2,"div",8),c(),n(27,"div",7),n(28,"h5"),Pt(29,"Other"),c(),gr(30,dL,2,2,"div",8),c(),c(),n(31,"div",9),n(32,"h4"),Pt(33,"Fields"),c(),gr(34,hL,2,2,"div",10),c(),c(),c()),2&o){var l=It();wt(2),Pi("HRC ID: ",l.selectedHrcId,""),wt(2),Pi("Name: ",l.friendlyName,""),wt(2),Pi("Used in ",l.metadata.numFieldModelLoaders," field model loaders"),wt(12),h("ngForOf",l.standAnimations),wt(4),h("ngForOf",l.walkAnimations),wt(4),h("ngForOf",l.runAnimations),wt(4),h("ngForOf",l.otherAnimations),wt(4),h("ngForOf",l.Object.keys(l.metadata.fieldStats))}}var vL=function(){var o=function(){function u(l,p){_(this,u),this.route=l,this.http=p,this.environment=Hn,this.CHAR_BASE_URL=Hn.KUJATA_DATA_BASE_URL+"/data/field/char.lgp/",this.SCENE_WIDTH=300,this.SCENE_HEIGHT=300,this.standAnimations=[],this.walkAnimations=[],this.runAnimations=[],this.otherAnimations=[],this.Object=Object,this.isAnimationEnabled=!1,this.isDestroyed=!1}return w(u,[{key:"ngOnInit",value:function(){var p=this,m=Hn.KUJATA_DATA_BASE_URL+"/metadata/field-model-metadata.json";this.http.get(m).subscribe(function(S){p.fieldModelMetadata=S,p.initialize()}),this.http.get(m=Hn.KUJATA_DATA_BASE_URL+"/metadata/skeleton-friendly-names.json").subscribe(function(S){p.skeletonFriendlyNames=S,p.initialize()}),this.route.paramMap.subscribe(function(S){p.selectedHrcId=S.get("hrcId"),p.initialize()})}},{key:"ngOnDestroy",value:function(){console.log("ngOnDestroy() called"),this.isDestroyed=!0,this.isAnimationEnabled=!1}},{key:"initialize",value:function(){var p=this;if(this.fieldModelMetadata&&this.skeletonFriendlyNames&&this.selectedHrcId){this.friendlyName=this.skeletonFriendlyNames[this.selectedHrcId],this.metadata=this.fieldModelMetadata[this.selectedHrcId],this.standAnimations=Object.keys(this.metadata.animationStats.stand),this.walkAnimations=Object.keys(this.metadata.animationStats.walk),this.runAnimations=Object.keys(this.metadata.animationStats.run),this.otherAnimations=Object.keys(this.metadata.animationStats.other);var m=function(N){return function(G,ie){return N[ie]-N[G]}};this.standAnimations.sort(m(this.metadata.animationStats.stand)),this.walkAnimations.sort(m(this.metadata.animationStats.walk)),this.runAnimations.sort(m(this.metadata.animationStats.run)),this.otherAnimations.sort(m(this.metadata.animationStats.other)),this.isAnimationEnabled=!1,this.selectedAnimId=this.standAnimations[0],this.clock=new lr.SUY,this.renderer=new lr.CP7({alpha:!0,antialias:!0}),this.renderer.setSize(this.SCENE_WIDTH,this.SCENE_HEIGHT),this.modelGLTF=null,this.gltf=null,this.scene=null,this.camera=new lr.cPb(90,this.SCENE_WIDTH/this.SCENE_HEIGHT,.1,1e3),this.camera.position.x=0,this.camera.position.y=0,this.camera.position.z=50,this.camera.rotation.x=0*Math.PI/180,this.controls=null,this.http.get(this.CHAR_BASE_URL+this.selectedHrcId+".hrc.gltf").subscribe(function(P){p.modelGLTF=P,p.fetchAnimationAndInitializeScene()},function(P){console.error("oops!",P)});var S=this;!function P(){if(S&&!S.isDestroyed){requestAnimationFrame(P);var N=S.clock.getDelta();S.controls&&S.controls.update(N),S.mixer&&S.isAnimationEnabled&&S.mixer.update(N),S.renderer&&S.scene&&S.camera&&S.renderer.render(S.scene,S.camera)}else console.log("stopping appTick()")}()}}},{key:"onSelectAnimation",value:function(p){this.selectedAnimId=p,this.fetchAnimationAndInitializeScene()}},{key:"fetchAnimationAndInitializeScene",value:function(){var p=this;this.http.get(this.CHAR_BASE_URL+this.selectedAnimId+".a.gltf").subscribe(function(m){var S=p.createCombinedGLTF(p.modelGLTF,m);p.initializeSceneWithCombinedGLTF(p,S)},function(m){console.error("oops!",m)})}},{key:"initializeSceneWithCombinedGLTF",value:function(p,m){var S=m.nodes[1].translation[1];0==S&&(S=15),0==p.camera.position.y&&(console.log("setting camera height to:"+2*S),p.camera.position.y=2*S,p.camera.position.z=Math.max(3*S,50)),console.log("modelRootHeight="+S),(new lr.EPV).parse(JSON.stringify(m),p.CHAR_BASE_URL,function(P){ip(P),console.log("combined gltf:",P),p.gltf=P;var N=P.scene;p.scene=new lr.xsS,p.scene.background=new lr.Ilk(12312063),p.scene.add(p.camera);var ie=new lr.Ox3(16777215);ie.position.set(0,0,50).normalize(),p.scene.add(ie);var ye=new lr.Mig(4210752);p.scene.add(ye);var Ce=new lr.vBJ({color:3390293,opacity:1,side:lr.ehD}),Le=new lr.zf8(50,32),qe=new lr.Kj0(Le,Ce);qe.rotateX(-Math.PI/2),p.scene.add(qe),p.scene.add(N),document.getElementById("scene-container").appendChild(p.renderer.domElement),p.controls=new lr.zxs(p.camera,p.renderer.domElement),p.controls.target=new lr.Pa4(0,S,0),p.controls.update(),p.startAnimation(),p.renderer.render(p.scene,p.camera)},void 0,function(P){console.error("oops!",P)})}},{key:"createCombinedGLTF",value:function(p,m){console.log("modelGLTF:",p),console.log("animGLTF:",m);var S=JSON.parse(JSON.stringify(p)),M=JSON.parse(JSON.stringify(m)),P=S.buffers.length,N=S.bufferViews.length,G=S.accessors.length;S.animations||(S.animations=[]);var ye,ie=I(M.buffers);try{for(ie.s();!(ye=ie.n()).done;)S.buffers.push(ye.value)}catch(en){ie.e(en)}finally{ie.f()}var qe,Le=I(M.bufferViews);try{for(Le.s();!(qe=Le.n()).done;){var nt=qe.value;nt.buffer+=P,S.bufferViews.push(nt)}}catch(en){Le.e(en)}finally{Le.f()}var et,tt=I(M.accessors);try{for(tt.s();!(et=tt.n()).done;){var Ze=et.value;Ze.bufferView+=N,S.accessors.push(Ze)}}catch(en){tt.e(en)}finally{tt.f()}var At,ht=I(M.animations);try{for(ht.s();!(At=ht.n()).done;){var yr,Tt=At.value,nr=I(Tt.samplers);try{for(nr.s();!(yr=nr.n()).done;){var Gr=yr.value;Gr.input+=G,Gr.output+=G}}catch(en){nr.e(en)}finally{nr.f()}S.animations.push(Tt)}}catch(en){ht.e(en)}finally{ht.f()}return console.log("combinedGLTF:",S),S}},{key:"startAnimation",value:function(){this.isAnimationEnabled=!0,this.mixer=new lr.Xcj(this.gltf.scene),this.mixer.clipAction(this.gltf.animations[0]).play()}},{key:"stopAnimation",value:function(){this.isAnimationEnabled=!1}}]),u}();return o.\u0275fac=function(l){return new(l||o)(dr(Ys),dr(zs))},o.\u0275cmp=Ei({type:o,selectors:[["field-model-details"]],decls:2,vars:1,consts:[[2,"background-color","#e0e0e0","padding","4px","margin-bottom","16px"],["style","background-color:white; padding:4px;",4,"ngIf"],[2,"background-color","white","padding","4px"],[2,"display","flex","flex-flow","row wrap","align-items","flex-start","align-content","flex-start","font-size","12pt"],[1,"model-panel"],["id","scene-container",1,"scene-container"],[1,"animations-panel"],[1,"animation-category"],["class","animation-box",3,"click",4,"ngFor","ngForOf"],[1,"fields-panel"],["class","field-box",4,"ngFor","ngForOf"],[1,"animation-box",3,"click"],[1,"field-box"]],template:function(l,p){1&l&&(n(0,"div",0),gr(1,pL,35,8,"div",1),c()),2&l&&(wt(1),h("ngIf",p.metadata))},directives:[Ws,bu],styles:[".model-panel[_ngcontent-%COMP%]{width:360px;height:400px;background-color:#f0f0f0;margin:4px 4px 0 0;text-align:center;padding:4px}.animations-panel[_ngcontent-%COMP%], .fields-panel[_ngcontent-%COMP%]{width:360px;height:400px;background-color:#f0f0f0;margin:4px 4px 0 0;overflow-y:auto;padding:4px}.animation-category[_ngcontent-%COMP%]{margin:2px;padding:4px;background-color:#f8f8f8}.animation-box[_ngcontent-%COMP%], .field-box[_ngcontent-%COMP%]{margin:2px;padding:4px;background-color:#fff}"]}),o}();function gL(o,u){if(1&o){var l=Se();n(0,"div",9),rt("click",function(){var P=es(l).$implicit;return It(2).onSelectAnimation(P)}),Pt(1),c()}if(2&o){var p=u.$implicit,m=It(2);wt(1),vs(" ",p," ",m.bodyAnimationIdToFriendlyNameMap[p]," ")}}function mL(o,u){if(1&o&&(n(0,"div",2),n(1,"h2"),Pt(2),c(),n(3,"div",3),n(4,"div",4),n(5,"h4"),Pt(6,"Model"),c(),f(7,"div",5),c(),n(8,"div",6),n(9,"h4"),Pt(10,"Animations"),c(),n(11,"div",7),n(12,"h5"),Pt(13,"Body Animations"),c(),gr(14,gL,2,2,"div",8),c(),c(),c(),c()),2&o){var l=It();wt(2),Pi("HRC ID: ",l.selectedHrcId,""),wt(12),h("ngForOf",l.bodyAnimationIds)}}var yL=function(){var o=function(){function u(l,p){_(this,u),this.route=l,this.http=p,this.environment=Hn,this.BATTLE_LGP_BASE_URL=Hn.KUJATA_DATA_BASE_URL+"/data/battle/battle.lgp/",this.SCENE_WIDTH=300,this.SCENE_HEIGHT=300,this.bodyAnimationIdToIndexMap={},this.bodyAnimationIdToFriendlyNameMap={"body-0":"battle stance","body-1":"critical status","body-2":"victory","body-3":"move to front row","body-4":"move to back row","body-5":"block","body-6":"knocked out","body-7":"running away","body-8":"frozen/defend","body-9":"use item","body-10":"throw item","body-12":"magic: pre-cast","body-13":"magic: cast","body-14":"magic: post-cast","body-15":"take damage (quick)","body-16":"take damage (sustained)","body-17":"return to battle stance","body-18":"knocked off feet","body-19":"dodge/twirl"},this.bodyAnimationNames=[],this.bodyAnimationIds=[],this.selectedAnimId=0,this.Object=Object,this.isAnimationEnabled=!1,this.isDestroyed=!1}return w(u,[{key:"ngOnInit",value:function(){var p=this;this.route.paramMap.subscribe(function(m){p.selectedHrcId=m.get("hrcId"),p.initialize()})}},{key:"ngOnDestroy",value:function(){console.log("ngOnDestroy() called"),this.isDestroyed=!0,this.isAnimationEnabled=!1}},{key:"initialize",value:function(){var p=this;if(this.selectedHrcId){this.isAnimationEnabled=!1,this.clock=new lr.SUY,this.renderer=new lr.CP7({alpha:!0,antialias:!0}),this.renderer.setSize(this.SCENE_WIDTH,this.SCENE_HEIGHT),this.modelGLTF=null,this.gltf=null,this.scene=null,this.camera=new lr.cPb(90,this.SCENE_WIDTH/this.SCENE_HEIGHT,.1,1e5),this.camera.position.x=0,this.camera.position.y=0,this.camera.position.z=50,this.controls=null,this.http.get(this.BATTLE_LGP_BASE_URL+this.selectedHrcId+".hrc.gltf").subscribe(function(M){p.modelGLTF=M,p.bodyAnimationNames=[];for(var P=0;P<M.animations.length;P++){var G=M.animations[P].name;p.bodyAnimationIds.push(G),p.bodyAnimationIdToIndexMap[G]=P}p.selectedAnimId=p.bodyAnimationIds[0],p.initializeSceneWithCombinedGLTF(p,p.modelGLTF)},function(M){console.error("oops!",M)});var m=this;!function M(){if(m&&!m.isDestroyed){requestAnimationFrame(M);var P=m.clock.getDelta();m.controls&&m.controls.update(P),m.mixer&&m.isAnimationEnabled&&m.mixer.update(P),m.renderer&&m.scene&&m.camera&&m.renderer.render(m.scene,m.camera)}else console.log("stopping appTick()")}()}}},{key:"onSelectAnimation",value:function(p){this.selectedAnimId=p,this.initializeSceneWithCombinedGLTF(this,this.modelGLTF)}},{key:"initializeSceneWithCombinedGLTF",value:function(p,m){var S=m.nodes[1].translation[1];0==S&&(S=15),0==p.camera.position.y&&(console.log("setting camera height to:"+2*S),p.camera.position.y=1.5*S,p.camera.position.z=Math.max(2.5*S,1e3)),(new lr.EPV).parse(JSON.stringify(m),p.BATTLE_LGP_BASE_URL,function(P){ip(P),console.log("parsed gltf:",P),p.gltf=P;var N=P.scene;N.children[0].rotation.y=-60*Math.PI/180,p.scene=new lr.xsS,p.scene.background=new lr.Ilk(12312063),p.scene.add(p.camera);var ie=function(et,Ze,ht){var At=new lr.Ox3(12632256);At.position.set(et,Ze,ht).normalize(),p.scene.add(At)};ie(4,2,3),ie(4,2,3),ie(0,-2,-3);var ye=new lr.Mig(4210752);p.scene.add(ye);var Ce=new lr.vBJ({color:3390293,opacity:1,side:lr.ehD}),Le=new lr.zf8(50,32),qe=new lr.Kj0(Le,Ce);qe.rotateX(-Math.PI/2),p.scene.add(qe),p.scene.add(N),document.getElementById("scene-container").appendChild(p.renderer.domElement),p.controls=new lr.zxs(p.camera,p.renderer.domElement),p.controls.target=new lr.Pa4(0,S,0),p.controls.update(),p.startAnimation(),p.renderer.render(p.scene,p.camera)},void 0,function(P){console.error("oops!",P)})}},{key:"startAnimation",value:function(){this.isAnimationEnabled=!0,this.mixer=new lr.Xcj(this.gltf.scene),this.mixer.clipAction(this.gltf.animations[this.bodyAnimationIdToIndexMap[this.selectedAnimId]]).play()}},{key:"stopAnimation",value:function(){this.isAnimationEnabled=!1}}]),u}();return o.\u0275fac=function(l){return new(l||o)(dr(Ys),dr(zs))},o.\u0275cmp=Ei({type:o,selectors:[["battle-model-details"]],decls:2,vars:1,consts:[[2,"background-color","#e0e0e0","padding","4px","margin-bottom","16px"],["style","background-color:white; padding:4px;",4,"ngIf"],[2,"background-color","white","padding","4px"],[2,"display","flex","flex-flow","row wrap","align-items","flex-start","align-content","flex-start","font-size","12pt"],[1,"model-panel"],["id","scene-container",1,"scene-container"],[1,"animations-panel"],[1,"animation-category"],["class","animation-box",3,"click",4,"ngFor","ngForOf"],[1,"animation-box",3,"click"]],template:function(l,p){1&l&&(n(0,"div",0),gr(1,mL,15,2,"div",1),c()),2&l&&(wt(1),h("ngIf",p.selectedHrcId))},directives:[Ws,bu],styles:[".model-panel[_ngcontent-%COMP%]{width:360px;height:400px;background-color:#f0f0f0;margin:4px 4px 0 0;text-align:center;padding:4px}.animations-panel[_ngcontent-%COMP%], .fields-panel[_ngcontent-%COMP%]{width:360px;height:400px;background-color:#f0f0f0;margin:4px 4px 0 0;overflow-y:auto;padding:4px}.animation-category[_ngcontent-%COMP%]{margin:2px;padding:4px;background-color:#f8f8f8}.animation-box[_ngcontent-%COMP%], .field-box[_ngcontent-%COMP%]{margin:2px;padding:4px;background-color:#fff}"]}),o}();function CL(o,u){1&o&&(n(0,"div"),n(1,"p"),Pt(2,"Fetching..."),c(),c())}function wL(o,u){1&o&&(n(0,"div"),n(1,"p"),Pt(2,"Sorry, this app had a problem getting that info."),c(),c())}function _L(o,u){if(1&o){var l=Se();n(0,"div"),n(1,"p"),n(2,"a",3),rt("click",function(){return es(l),It().exportToCsv()}),Pt(3,"Export To CSV"),c(),c(),f(4,"ag-grid-angular",4),j3(5,"async"),c()}if(2&o){var p=It();wt(4),h("gridOptions",p.gridOptions)("rowData",X3(5,3,p.rowData))("columnDefs",p.columnDefs)}}var SL=function(){var o=function(){function u(l,p){_(this,u),this.router=l,this.http=p,this.soundMetadata=[],this.fetchStatus="NONE",this.Object=Object,this.columnDefs=[],this.rowData=an([]),this.friendlyColumnNames={fieldName:"Field",entityName:"Entity",scriptType:"Script",lineNo:"Line",opType:"Op",direction:"Direction",soundId:"Sound ID",playSound:"Play Sound"},this.columnWidths={direction:100,soundId:150,playSound:150}}return w(u,[{key:"ngOnInit",value:function(){this.gridOptions={rowData:this.rowData,columnDefs:this.columnDefs,rowSelection:"single",onRowClicked:function(m){console.log("a row was clicked")},onColumnResized:function(m){console.log("a column was resized")},onGridReady:function(m){console.log("the grid is now ready")},suppressNoRowsOverlay:!0},this.init()}},{key:"addColumnDef",value:function(p,m){var S=this,M={headerName:this.friendlyColumnNames[p]||p,field:p,width:m,sortable:!0,filter:!0,resizable:!0,onCellClicked:void 0,cellStyle:void 0,sort:void 0,cellRenderer:void 0};"soundId"===p&&(M.sort="asc"),"fieldName"===p&&(M.cellRenderer=function(P){return'<a href="/scene-details/'.concat(P.value,'">').concat(P.value,"</a>")}),"playSound"===p&&(M.onCellClicked=function(P){S.playSound(P.data.soundId)},M.cellStyle={color:"#007bff",textDecoration:"underline",cursor:"pointer"},M.cellRenderer=function(P){return'<i class="fa fa-play-circle"></i> Play sound: '.concat(P.value)}),this.columnDefs.push(M)}},{key:"playSound",value:function(p){var m="".concat(Hn.KUJATA_DATA_BASE_URL,"/media/sounds/").concat(p,".ogg");console.log("Play sound - ".concat(p," - ").concat(m)),0!==p?(this.playingSound&&(this.playingSound.pause(),this.playingSound.currentTime=0),this.playingSound=new Audio(m),this.playingSound.play()):window.alert("Play sound 0 in game actually stops current sounds playing")}},{key:"init",value:function(){var p=this;this.fetchStatus="FETCHING",this.gridOptions.api&&this.gridOptions.api.showLoadingOverlay(),this.http.get(Hn.KUJATA_DATA_BASE_URL+"/metadata/sound-list.json").subscribe(function(S){if(p.soundMetadata=S,p.soundMetadata.map(function(G){delete G.entityId,delete G.scriptIndex,G.playSound=G.soundId}),console.log("soundMetadata",S),p.rowData=an(p.soundMetadata),p.fetchStatus="SUCCESS",p.soundMetadata.length>0)for(var M=0,P=Object.keys(p.friendlyColumnNames);M<P.length;M++){var N=P[M];p.addColumnDef(N,p.columnWidths[N]||75)}},function(S){p.fetchStatus="ERROR"})}}]),u}();return o.\u0275fac=function(l){return new(l||o)(dr(Ho),dr(zs))},o.\u0275cmp=Ei({type:o,selectors:[["sound-details"]],decls:9,vars:3,consts:[[2,"background-color","#e0e0e0","padding","16px","margin-bottom","16px"],[2,"background-color","white","padding","16px"],[4,"ngIf"],[3,"routerLink","click"],[1,"ag-theme-balham",2,"width","100%","height","500px",3,"gridOptions","rowData","columnDefs"]],template:function(l,p){1&l&&(n(0,"div",0),n(1,"div",1),n(2,"h2"),Pt(3,"Sound Details"),c(),n(4,"h3"),Pt(5,"Usages"),c(),gr(6,CL,3,0,"div",2),gr(7,wL,3,0,"div",2),gr(8,_L,6,5,"div",2),c(),c()),2&l&&(wt(6),h("ngIf","FETCHING"==p.fetchStatus),wt(1),h("ngIf","ERROR"==p.fetchStatus),wt(1),h("ngIf","SUCCESS"==p.fetchStatus))},directives:[Ws,ws,P8],pipes:[E9],styles:[""]}),o}(),xL=[{path:"field-scenes",component:F8},{path:"scene-details/:name",component:DF},{path:"field-models",component:JF},{path:"field-model-details/:hrcId",component:vL},{path:"battle-models",component:lL},{path:"battle-model-details/:hrcId",component:yL},{path:"field-op-codes",component:NF},{path:"field-op-code-details/:hex",component:VF},{path:"sounds",component:SL},{path:"**",component:F8}],bL=function(){var o=function u(){_(this,u)};return o.\u0275fac=function(l){return new(l||o)},o.\u0275mod=ji({type:o,bootstrap:[_R]}),o.\u0275inj=zo({providers:[],imports:[[AM,lR.forRoot(xL),qM,Mf.withComponents([])]]}),o}();xM().bootstrapModule(bL).catch(function(o){return console.error(o)})},564:function(s,e){"use strict";function d(h){return null==h||""===h?null:h}function v(h,r){return void 0===r&&(r=!1),null!=h&&(""!==h||r)}function g(h){return!v(h)}function C(h){return null==h||0===h.length}function w(h){return null!=h&&"function"==typeof h.toString?h.toString():null}function _(h){if(void 0!==h){if(null===h||""===h)return null;if("number"==typeof h)return isNaN(h)?void 0:h;var r=parseInt(h,10);return isNaN(r)?void 0:r}}function x(h){if(void 0!==h)return null!==h&&""!==h&&("boolean"==typeof h?h:/true/i.test(h))}function O(h,r,t){if(null==h)return null;if(!Array.isArray(h))return O(D(h),r,t);for(var c=h,f=null,y=0;y<c.length;y++){var T=c[y];if("string"==typeof r){if(T[r]===t){f=T;break}}else if(r(T)){f=T;break}}return f}function D(h){if(h instanceof Set||h instanceof Map){var r=[];return h.forEach(function(t){return r.push(t)}),r}return Object.keys(h).map(function(t){return h[t]})}var F=Object.freeze({__proto__:null,makeNull:d,exists:v,missing:g,missingOrEmpty:C,toStringOrNull:w,attrToNumber:_,attrToBoolean:x,attrToString:function(h){if(null!=h&&""!==h)return h},referenceCompare:function(h,r){return null==h&&null==r||!(null==h&&null!=r||null!=h&&null==r)&&h===r},jsonEquals:function(h,r){return(h?JSON.stringify(h):null)===(r?JSON.stringify(r):null)},defaultComparator:function(h,r,t){void 0===t&&(t=!1);var n=null==h,c=null==r;if(h&&h.toNumber&&(h=h.toNumber()),r&&r.toNumber&&(r=r.toNumber()),n&&c)return 0;if(n)return-1;if(c)return 1;function f(y,T){return y>T?1:y<T?-1:0}if("string"!=typeof h||!t)return f(h,r);try{return h.localeCompare(r)}catch(y){return f(h,r)}},find:O,values:D}),L=function(){function h(){this.existingKeys={}}return h.prototype.addExistingKeys=function(r){for(var t=0;t<r.length;t++)this.existingKeys[r[t]]=!0},h.prototype.getUniqueKey=function(r,t){r=w(r);for(var n=0;;){var c=void 0;if(r?(c=r,0!==n&&(c+="_"+n)):t?(c=t,0!==n&&(c+="_"+n)):c=""+n,!this.existingKeys[c])return this.existingKeys[c]=!0,c;n++}},h}();function I(){for(var h=[],r=0;r<arguments.length;r++)h[r]=arguments[r];for(var t=0;t<h.length;t++){var n=h[t];if(v(n))return n}return null}function H(h){if(h&&h.length)return h[h.length-1]}function X(h,r,t){return null==h&&null==r||null!=h&&null!=r&&h.length===r.length&&Y(h,function(n,c){return t?t(n,r[c]):r[c]===n})}function te(h){return h.sort(function(r,t){return r-t})}function k(h,r){var t=h.indexOf(r);t>=0&&h.splice(t,1)}function U(h,r){se(r,function(t){return k(h,t)})}function K(h,r,t){h.splice(t,0,r)}function Q(h,r,t){U(h,r),se(r.slice().reverse(),function(n){return K(h,n,t)})}function oe(h,r){return h.indexOf(r)>-1}function fe(h,r){null==r||null==h||se(r,function(t){return h.push(t)})}function $(h,r){for(var t=0;t<h.length;t++)if(r(h[t],t,h))return t;return-1}function Y(h,r){if(null==h)return!0;for(var t=0;t<h.length;t++)if(!r(h[t],t))return!1;return!0}function Z(h,r){if(null==h)return!1;for(var t=0;t<h.length;t++)if(r(h[t],t))return!0;return!1}function se(h,r){if(null!=h)for(var t=0;t<h.length;t++)r(h[t],t)}function le(h,r){if(null==h)return null;for(var t=[],n=0;n<h.length;n++)t.push(r(h[n],n));return t}function _e(h,r){if(null==h)return null;for(var t=[],n=0;n<h.length;n++)r(h[n],n)&&t.push(h[n]);return t}var he=Object.freeze({__proto__:null,firstExistingValue:I,anyExists:function(h){return h&&null!=I(h)},existsAndNotEmpty:function(h){return null!=h&&h.length>0},last:H,areEqual:X,compareArrays:function(h,r){return X(h,r)},shallowCompare:function(h,r){return X(h,r)},sortNumerically:te,removeRepeatsFromArray:function(h,r){if(h)for(var t=h.length-2;t>=0;t--)h[t]===r&&h[t+1]===r&&h.splice(t+1,1)},removeFromArray:k,removeAllFromArray:U,insertIntoArray:K,insertArrayIntoArray:function(h,r,t){if(null!=h&&null!=r)for(var n=r.length-1;n>=0;n--)K(h,r[n],t)},moveInArray:Q,includes:oe,flatten:function(h){return[].concat.apply([],h)},pushAll:fe,toStrings:function(h){return le(h,w)},findIndex:$,fill:function(h,r,t,n){void 0===r&&(r=null),void 0===t&&(t=0),void 0===n&&(n=h.length);for(var c=t;c<n;c++)h[c]=r;return h},every:Y,some:Z,forEach:se,forEachReverse:function(h,r){if(null!=h)for(var t=h.length-1;t>=0;t--)r(h[t],t)},map:le,filter:_e,reduce:function(h,r,t){if(null==h||null==t)return null;for(var n=t,c=0;c<h.length;c++)n=r(n,h[c],c);return n},forEachSnapshotFirst:function(h,r){h&&h.slice(0).forEach(r)}});function ce(h,r){null!=h&&(Array.isArray(h)?se(h,function(t,n){return r(""+n,t)}):se(Object.keys(h),function(t){return r(t,h[t])}))}function Te(h){for(var r={},t=Object.keys(h),n=0;n<t.length;n++){var c=t[n];r[c]=h[c]}return r}function xe(h,r){if(h){var t=h,n={};return Object.keys(t).forEach(function(c){if(!(r&&r.indexOf(c)>=0)){var f=t[c],y=ft(f)&&f.constructor===Object;n[c]=y?xe(f):f}}),n}}function we(h,r){return h[r]}function Ne(h,r,t){h[r]=t}function De(h,r,t,n){var c=we(h,t);void 0!==c&&Ne(r,t,n?n(c):c)}function Je(h){var r={};return h.filter(function(t){return null!=t}).forEach(function(t){se(Object.keys(t),function(n){return r[n]=null})}),Object.keys(r)}function $e(h){if(!h)return[];var r=Object;if("function"==typeof r.values)return r.values(h);var t=[];for(var n in h)h.hasOwnProperty(n)&&h.propertyIsEnumerable(n)&&t.push(h[n]);return t}function pt(h,r,t,n){void 0===t&&(t=!0),void 0===n&&(n=!1),v(r)&&ce(r,function(c,f){var y=h[c];y!==f&&(n&&null==y&&null!=f&&"object"==typeof f&&f.constructor===Object&&(h[c]=y={}),ft(f)&&ft(y)&&!Array.isArray(y)?pt(y,f,t,n):(t||void 0!==f)&&(h[c]=f))})}function ut(h){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];return se(r,function(n){return ce(n,function(c,f){return h[c]=f})}),h}function ot(h,r,t){if(r&&h){if(!t)return h[r];for(var n=r.split("."),c=h,f=0;f<n.length;f++){if(null==c)return;c=c[n[f]]}return c}}function St(h,r){Object.keys(h).forEach(function(c){"object"==typeof h[c]&&(h[c]=void 0)});var t=Object.getPrototypeOf(h),n={};Object.keys(t).forEach(function(c){"function"==typeof t[c]&&(n[c]={value:function(){console.warn("AG Grid: "+r+" function "+c+"() cannot be called as the grid has been destroyed.\n                     Please don't call grid API functions on destroyed grids - as a matter of fact you shouldn't\n                     be keeping the API reference, your application has a memory leak! Remove the API reference\n                     when the grid is destroyed.")},writable:!0})}),Object.defineProperties(h,n)}function ft(h){return"object"==typeof h&&null!==h}var He=Object.freeze({__proto__:null,iterateObject:ce,cloneObject:Te,deepCloneObject:function(h){return JSON.parse(JSON.stringify(h))},deepCloneDefinition:xe,getProperty:we,setProperty:Ne,copyPropertiesIfPresent:function(h,r){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];se(t,function(c){return De(h,r,c)})},copyPropertyIfPresent:De,getAllKeysInObjects:Je,getAllValuesInObject:$e,mergeDeep:pt,assign:ut,missingOrEmptyObject:function(h){return g(h)||0===Object.keys(h).length},get:function(h,r,t){if(null==h)return t;for(var n=r.split("."),c=h;n.length>1;)if(null==(c=c[n.shift()]))return t;var f=c[n[0]];return null!=f?f:t},set:function(h,r,t){if(null!=h){for(var n=r.split("."),c=h;n.length>1;)if(null==(c=c[n.shift()]))return;c[n[0]]=t}},deepFreeze:function lt(h){return Object.freeze(h),se(D(h),function(r){(ft(r)||"function"==typeof r)&&lt(r)}),h},getValueUsingField:ot,removeAllReferences:St,isNonNullObject:ft}),gt=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/gm,vt=/([^\s,]+)/g,Gt={};function Lt(h,r){Gt[r]||(h(),Gt[r]=!0)}function yt(h){if(h.name)return h.name;var r=/function\s+([^\(]+)/.exec(h.toString());return r&&2===r.length?r[1].trim():null}function Dr(h){return!!(h&&h.constructor&&h.call&&h.apply)}function Ur(h){Sn(h,400)}var qr=[],Ar=!1;function hn(h){qr.push(h),!Ar&&(Ar=!0,window.setTimeout(function(){var r=qr.slice();qr.length=0,Ar=!1,r.forEach(function(t){return t()})},0))}function Sn(h,r){void 0===r&&(r=0),h.length>0&&window.setTimeout(function(){return h.forEach(function(t){return t()})},r)}function Sr(h,r,t){var n;return void 0===t&&(t=!1),function(){for(var c=[],f=0;f<arguments.length;f++)c[f]=arguments[f];var y=this,T=t&&!n;window.clearTimeout(n),n=window.setTimeout(function(){n=null,t||h.apply(y,c)},r),T&&h.apply(y,c)}}function An(h,r,t,n){void 0===t&&(t=100);var c=(new Date).getTime(),f=null,y=!1,T=function(){var q=(new Date).getTime()-c>t;(h()||q)&&(r(),y=!0,null!=f&&(window.clearInterval(f),f=null),q&&n&&console.warn(n))};T(),y||(f=window.setInterval(T,10))}function cn(h){h&&h()}var Fn=Object.freeze({__proto__:null,doOnce:Lt,getFunctionName:yt,getFunctionParameters:function(h){var r=h.toString().replace(gt,"");return r.slice(r.indexOf("(")+1,r.indexOf(")")).match(vt)||[]},isFunction:Dr,executeInAWhile:Ur,executeNextVMTurn:hn,executeAfter:Sn,debounce:Sr,waitUntil:An,compose:function(){for(var h=[],r=0;r<arguments.length;r++)h[r]=arguments[r];return function(t){return h.reduce(function(n,c){return c(n)},t)}},callIfPresent:cn}),yi=function(){function h(r,t){if(this.beanWrappers={},this.destroyed=!1,r&&r.beanClasses){this.contextParams=r,this.logger=t,this.logger.log(">> creating ag-Application Context"),this.createBeans();var n=this.getBeanInstances();this.wireBeans(n),this.logger.log(">> ag-Application Context ready - component is alive")}}return h.prototype.getBeanInstances=function(){return D(this.beanWrappers).map(function(r){return r.beanInstance})},h.prototype.createBean=function(r,t){if(!r)throw Error("Can't wire to bean since it is null");return this.wireBeans([r],t),r},h.prototype.wireBeans=function(r,t){this.autoWireBeans(r),this.methodWireBeans(r),this.callLifeCycleMethods(r,"preConstructMethods"),v(t)&&r.forEach(t),this.callLifeCycleMethods(r,"postConstructMethods")},h.prototype.createBeans=function(){var r=this;this.contextParams.beanClasses.forEach(this.createBeanWrapper.bind(this)),ce(this.beanWrappers,function(n,c){var f;c.bean.__agBeanMetaData&&c.bean.__agBeanMetaData.autowireMethods&&c.bean.__agBeanMetaData.autowireMethods.agConstructor&&(f=c.bean.__agBeanMetaData.autowireMethods.agConstructor);var y=r.getBeansForParameters(f,c.bean.name),T=function(h,r){var t=[null].concat(r);return new(h.bind.apply(h,t))}(c.bean,y);c.beanInstance=T});var t=Object.keys(this.beanWrappers).join(", ");this.logger.log("created beans: "+t)},h.prototype.createBeanWrapper=function(r){var t=r.__agBeanMetaData;if(!t){var n;return n=r.prototype.constructor?yt(r.prototype.constructor):""+r,void console.error("Context item "+n+" is not a bean")}this.beanWrappers[t.beanName]={bean:r,beanInstance:null,beanName:t.beanName}},h.prototype.autoWireBeans=function(r){var t=this;r.forEach(function(n){t.forEachMetaDataInHierarchy(n,function(c,f){var y=c.agClassAttributes;!y||y.forEach(function(T){var B=t.lookupBeanInstance(f,T.beanName,T.optional);n[T.attributeName]=B})})})},h.prototype.methodWireBeans=function(r){var t=this;r.forEach(function(n){t.forEachMetaDataInHierarchy(n,function(c,f){ce(c.autowireMethods,function(y,T){if("agConstructor"!==y){var B=t.getBeansForParameters(T,f);n[y].apply(n,B)}})})})},h.prototype.forEachMetaDataInHierarchy=function(r,t){for(var n=Object.getPrototypeOf(r);null!=n;){var c=n.constructor;c.hasOwnProperty("__agBeanMetaData")&&t(c.__agBeanMetaData,this.getBeanName(c)),n=Object.getPrototypeOf(n)}},h.prototype.getBeanName=function(r){if(r.__agBeanMetaData&&r.__agBeanMetaData.beanName)return r.__agBeanMetaData.beanName;var t=r.toString();return t.substring(9,t.indexOf("("))},h.prototype.getBeansForParameters=function(r,t){var n=this,c=[];return r&&ce(r,function(f,y){var T=n.lookupBeanInstance(t,y);c[Number(f)]=T}),c},h.prototype.lookupBeanInstance=function(r,t,n){if(void 0===n&&(n=!1),"context"===t)return this;if(this.contextParams.providedBeanInstances&&this.contextParams.providedBeanInstances.hasOwnProperty(t))return this.contextParams.providedBeanInstances[t];var c=this.beanWrappers[t];return c?c.beanInstance:(n||console.error("AG Grid: unable to find bean reference "+t+" while initialising "+r),null)},h.prototype.callLifeCycleMethods=function(r,t){var n=this;r.forEach(function(c){return n.callLifeCycleMethodsOnBean(c,t)})},h.prototype.callLifeCycleMethodsOnBean=function(r,t,n){var c={};this.forEachMetaDataInHierarchy(r,function(y){var T=y[t];T&&T.forEach(function(B){B!=n&&(c[B]=!0)})}),Object.keys(c).forEach(function(y){return r[y]()})},h.prototype.getBean=function(r){return this.lookupBeanInstance("getBean",r,!0)},h.prototype.destroy=function(){if(!this.destroyed){this.logger.log(">> Shutting down ag-Application Context");var r=this.getBeanInstances();this.destroyBeans(r),this.contextParams.providedBeanInstances=null,this.destroyed=!0,this.logger.log(">> ag-Application Context shut down - component is dead")}},h.prototype.destroyBean=function(r){!r||this.destroyBeans([r])},h.prototype.destroyBeans=function(r){var t=this;return r?(r.forEach(function(n){t.callLifeCycleMethodsOnBean(n,"preDestroyMethods","destroy"),"function"==typeof n.destroy&&n.destroy()}),[]):[]},h}();function ro(h,r,t){var n=Ni(h.constructor);n.preConstructMethods||(n.preConstructMethods=[]),n.preConstructMethods.push(r)}function zt(h,r,t){var n=Ni(h.constructor);n.postConstructMethods||(n.postConstructMethods=[]),n.postConstructMethods.push(r)}function Ln(h,r,t){var n=Ni(h.constructor);n.preDestroyMethods||(n.preDestroyMethods=[]),n.preDestroyMethods.push(r)}function Kt(h){return function(r){Ni(r).beanName=h}}function Ee(h){return function(r,t,n){Kn(r,h,!1,0,t,null)}}function Nr(h){return function(r,t,n){Kn(r,h,!0,0,t,null)}}function Kn(h,r,t,n,c,f){if(null!==r)if("number"!=typeof f){var y=Ni(h.constructor);y.agClassAttributes||(y.agClassAttributes=[]),y.agClassAttributes.push({attributeName:c,beanName:r,optional:t})}else console.error("AG Grid: Autowired should be on an attribute");else console.error("AG Grid: Autowired name should not be null")}function Dn(h){return function(r,t,n){var f,c="function"==typeof r?r:r.constructor;if("number"==typeof n){var y=void 0;t?(f=Ni(c),y=t):(f=Ni(c),y="agConstructor"),f.autowireMethods||(f.autowireMethods={}),f.autowireMethods[y]||(f.autowireMethods[y]={}),f.autowireMethods[y][n]=h}}}function Ni(h){return h.hasOwnProperty("__agBeanMetaData")||(h.__agBeanMetaData={}),h.__agBeanMetaData}var h,Wn=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Ci=function(h,r){return function(t,n){r(t,n,h)}},Zn=function(){function h(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}return h.prototype.setBeans=function(r,t,n,c){if(void 0===c&&(c=null),this.frameworkOverrides=n,c){var f=t.useAsyncEvents();this.addGlobalListener(c,f)}},h.prototype.getListeners=function(r,t,n){var c=t?this.allAsyncListeners:this.allSyncListeners,f=c.get(r);return!f&&n&&c.set(r,f=new Set),f},h.prototype.noRegisteredListenersExist=function(){return 0===this.allSyncListeners.size&&0===this.allAsyncListeners.size&&0===this.globalSyncListeners.size&&0===this.globalAsyncListeners.size},h.prototype.addEventListener=function(r,t,n){void 0===n&&(n=!1),this.getListeners(r,n,!0).add(t)},h.prototype.removeEventListener=function(r,t,n){void 0===n&&(n=!1);var c=this.getListeners(r,n,!1);c&&(c.delete(t),0===c.size)&&(n?this.allAsyncListeners:this.allSyncListeners).delete(r)},h.prototype.addGlobalListener=function(r,t){void 0===t&&(t=!1),(t?this.globalAsyncListeners:this.globalSyncListeners).add(r)},h.prototype.removeGlobalListener=function(r,t){void 0===t&&(t=!1),(t?this.globalAsyncListeners:this.globalSyncListeners).delete(r)},h.prototype.dispatchEvent=function(r){this.dispatchToListeners(r,!0),this.dispatchToListeners(r,!1),this.firedEvents[r.type]=!0},h.prototype.dispatchEventOnce=function(r){this.firedEvents[r.type]||this.dispatchEvent(r)},h.prototype.dispatchToListeners=function(r,t){var n=this,c=r.type,y=this.getListeners(c,t,!1);y&&y.forEach(function(de){t?n.dispatchAsync(function(){return de(r)}):de(r)}),(t?this.globalAsyncListeners:this.globalSyncListeners).forEach(function(B){t?n.dispatchAsync(function(){return n.frameworkOverrides.dispatchEvent(c,function(){return B(c,r)},!0)}):n.frameworkOverrides.dispatchEvent(c,function(){return B(c,r)},!0)})},h.prototype.dispatchAsync=function(r){this.asyncFunctionsQueue.push(r),this.scheduled||(window.setTimeout(this.flushAsyncQueue.bind(this),0),this.scheduled=!0)},h.prototype.flushAsyncQueue=function(){this.scheduled=!1;var r=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[],r.forEach(function(t){return t()})},Wn([Ci(0,Dn("loggerFactory")),Ci(1,Dn("gridOptionsWrapper")),Ci(2,Dn("frameworkOverrides")),Ci(3,Dn("globalEventListener"))],h.prototype,"setBeans",null),Wn([Kt("eventService")],h)}(),W=function(){function h(){}return h.ROW_BUFFER_SIZE=10,h.LAYOUT_INTERVAL=500,h.BATCH_WAIT_MILLIS=50,h.EXPORT_TYPE_DRAG_COPY="dragCopy",h.EXPORT_TYPE_CLIPBOARD="clipboard",h.EXPORT_TYPE_EXCEL="excel",h.EXPORT_TYPE_CSV="csv",h.ROW_MODEL_TYPE_INFINITE="infinite",h.ROW_MODEL_TYPE_VIEWPORT="viewport",h.ROW_MODEL_TYPE_CLIENT_SIDE="clientSide",h.ROW_MODEL_TYPE_SERVER_SIDE="serverSide",h.ALWAYS="always",h.ONLY_WHEN_GROUPING="onlyWhenGrouping",h.PINNED_TOP="top",h.PINNED_BOTTOM="bottom",h.DOM_LAYOUT_NORMAL="normal",h.DOM_LAYOUT_PRINT="print",h.DOM_LAYOUT_AUTO_HEIGHT="autoHeight",h.GROUP_AUTO_COLUMN_ID="ag-Grid-AutoColumn",h.SOURCE_PASTE="paste",h.PINNED_RIGHT="right",h.PINNED_LEFT="left",h.SORT_ASC="asc",h.SORT_DESC="desc",h.INPUT_SELECTOR="input, select, button, textarea",h.FOCUSABLE_SELECTOR="[tabindex], input, select, button, textarea",h.FOCUSABLE_EXCLUDE=".ag-hidden, .ag-hidden *, [disabled], .ag-disabled, .ag-disabled *",h}();(h=e.GXE||(e.GXE={})).CommunityCoreModule="@ag-grid-community/core",h.CommunityAllModules="@ag-grid-community/all",h.InfiniteRowModelModule="@ag-grid-community/infinite-row-model",h.ClientSideRowModelModule="@ag-grid-community/client-side-row-model",h.CsvExportModule="@ag-grid-community/csv-export",h.EnterpriseCoreModule="@ag-grid-enterprise/core",h.EnterpriseAllModules="@ag-grid-enterprise/all",h.RowGroupingModule="@ag-grid-enterprise/row-grouping",h.ColumnToolPanelModule="@ag-grid-enterprise/column-tool-panel",h.FiltersToolPanelModule="@ag-grid-enterprise/filter-tool-panel",h.MenuModule="@ag-grid-enterprise/menu",h.SetFilterModule="@ag-grid-enterprise/set-filter",h.MultiFilterModule="@ag-grid-enterprise/multi-filter",h.StatusBarModule="@ag-grid-enterprise/status-bar",h.SideBarModule="@ag-grid-enterprise/side-bar",h.RangeSelectionModule="@ag-grid-enterprise/range-selection",h.MasterDetailModule="@ag-grid-enterprise/master-detail",h.RichSelectModule="@ag-grid-enterprise/rich-select",h.GridChartsModule="@ag-grid-enterprise/charts",h.ViewportRowModelModule="@ag-grid-enterprise/viewport-row-model",h.ServerSideRowModelModule="@ag-grid-enterprise/server-side-row-model",h.ExcelExportModule="@ag-grid-enterprise/excel-export",h.ClipboardModule="@ag-grid-enterprise/clipboard",h.SparklinesModule="@ag-grid-enterprise/sparklines",h.AngularModule="@ag-grid-community/angular",h.ReactModule="@ag-grid-community/react",h.VueModule="@ag-grid-community/vue",h.PolymerModule="@ag-grid-community/polymer";var ne=function(){function h(){}return h.register=function(r,t){void 0===t&&(t=!0),h.modulesMap[r.moduleName]=r,void 0===h.moduleBased?h.moduleBased=t:h.moduleBased!==t&&Lt(function(){console.warn("AG Grid: You are mixing modules (i.e. @ag-grid-community/core) and packages (ag-grid-community) - you can only use one or the other of these mechanisms."),console.warn("Please see https://www.ag-grid.com/javascript-grid/packages-modules/ for more information.")},"ModulePackageCheck")},h.registerModules=function(r,t){void 0===t&&(t=!0),r&&r.forEach(function(n){return h.register(n,t)})},h.assertRegistered=function(r,t){if(this.isRegistered(r))return!0;var c="AG Grid: unable to use "+t+" as module "+r+" is not present. Please see: https://www.ag-grid.com/javascript-grid/modules/";return Lt(function(){console.warn(c)},t+r),!1},h.isRegistered=function(r){return!!h.modulesMap[r]},h.getRegisteredModules=function(){return D(h.modulesMap)},h.isPackageBased=function(){return!h.moduleBased},h.modulesMap={},h}(),Ie=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},ze=0,it=function(){function h(r,t,n,c){this.instanceId=ze++,this.moving=!1,this.menuVisible=!1,this.filterActive=!1,this.eventService=new Zn,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.colDef=r,this.userProvidedColDef=t,this.colId=n,this.primary=c,this.setState(r)}return h.prototype.getInstanceId=function(){return this.instanceId},h.prototype.setState=function(r){void 0!==r.sort?(r.sort===W.SORT_ASC||r.sort===W.SORT_DESC)&&(this.sort=r.sort):(r.initialSort===W.SORT_ASC||r.initialSort===W.SORT_DESC)&&(this.sort=r.initialSort);var t=_(r.sortIndex),n=_(r.initialSortIndex);void 0!==t?null!==t&&(this.sortIndex=t):null!==n&&(this.sortIndex=n);var c=x(r.hide),f=x(r.initialHide);this.visible=void 0!==c?!c:!f,this.setPinned(void 0!==r.pinned?r.pinned:r.initialPinned);var y=_(r.flex),T=_(r.initialFlex);void 0!==y?this.flex=y:void 0!==T&&(this.flex=T)},h.prototype.setColDef=function(r,t){this.colDef=r,this.userProvidedColDef=t,this.initMinAndMaxWidths(),this.initDotNotation()},h.prototype.getUserProvidedColDef=function(){return this.userProvidedColDef},h.prototype.setParent=function(r){this.parent=r},h.prototype.getParent=function(){return this.parent},h.prototype.setOriginalParent=function(r){this.originalParent=r},h.prototype.getOriginalParent=function(){return this.originalParent},h.prototype.initialise=function(){this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.validate()},h.prototype.initDotNotation=function(){var r=this.gridOptionsWrapper.isSuppressFieldDotNotation();this.fieldContainsDots=v(this.colDef.field)&&this.colDef.field.indexOf(".")>=0&&!r,this.tooltipFieldContainsDots=v(this.colDef.tooltipField)&&this.colDef.tooltipField.indexOf(".")>=0&&!r},h.prototype.initMinAndMaxWidths=function(){var r=this.colDef;this.minWidth=this.columnUtils.calculateColMinWidth(r),this.maxWidth=this.columnUtils.calculateColMaxWidth(r)},h.prototype.resetActualWidth=function(r){void 0===r&&(r="api");var t=this.columnUtils.calculateColInitialWidth(this.colDef);this.setActualWidth(t,r,!0)},h.prototype.isEmptyGroup=function(){return!1},h.prototype.isRowGroupDisplayed=function(r){return!(g(this.colDef)||g(this.colDef.showRowGroup)||!0!==this.colDef.showRowGroup&&this.colDef.showRowGroup!==r)},h.prototype.isPrimary=function(){return this.primary},h.prototype.isFilterAllowed=function(){return this.primary&&(!!this.colDef.filter||!!this.colDef.filterFramework)},h.prototype.isFieldContainsDots=function(){return this.fieldContainsDots},h.prototype.isTooltipFieldContainsDots=function(){return this.tooltipFieldContainsDots},h.prototype.validate=function(){var r=this.colDef;function t(y,T,B){Lt(function(){B?console.warn(y,B):Lt(function(){return console.warn(y)},T)},T)}this.gridOptionsWrapper.isRowModelDefault()&&!ne.isRegistered(e.GXE.RowGroupingModule)&&["enableRowGroup","rowGroup","rowGroupIndex","enablePivot","enableValue","pivot","pivotIndex","aggFunc"].forEach(function(y){v(r[y])&&(ne.isPackageBased()?t("AG Grid: "+y+" is only valid in ag-grid-enterprise, your column definition should not have "+y,"ColumnRowGroupingMissing"+y):t("AG Grid: "+y+" is only valid with AG Grid Enterprise Module "+e.GXE.RowGroupingModule+" - your column definition should not have "+y,"ColumnRowGroupingMissing"+y))}),ne.isRegistered(e.GXE.RichSelectModule)||"agRichSelect"===this.colDef.cellEditor&&(ne.isPackageBased()?t("AG Grid: "+this.colDef.cellEditor+" can only be used with ag-grid-enterprise","ColumnRichSelectMissing"):t("AG Grid: "+this.colDef.cellEditor+" can only be used with AG Grid Enterprise Module "+e.GXE.RichSelectModule,"ColumnRichSelectMissing")),this.gridOptionsWrapper.isTreeData()&&["rowGroup","rowGroupIndex","pivot","pivotIndex"].forEach(function(y){v(r[y])&&t("AG Grid: "+y+" is not possible when doing tree data, your column definition should not have "+y,"TreeDataCannotRowGroup")}),v(this.colDef.width)&&"number"!=typeof this.colDef.width&&t("AG Grid: colDef.width should be a number, not "+typeof this.colDef.width,"ColumnCheck_asdfawef"),r.pinnedRowCellRenderer&&t("AG Grid: pinnedRowCellRenderer no longer exists, use cellRendererSelector if you want a different Cell Renderer for pinned rows. Check params.node.rowPinned. This was an unfortunate (but necessary) change we had to do to allow future plans we have of re-skinng the data grid in frameworks such as React, Angular and Vue. See https://www.ag-grid.com/javascript-grid/cell-rendering/#many-renderers-one-column","colDef.pinnedRowCellRenderer-deprecated"),r.pinnedRowCellRendererParams&&t("AG Grid: pinnedRowCellRenderer no longer exists, use cellRendererSelector if you want a different Cell Renderer for pinned rows. Check params.node.rowPinned. This was an unfortunate (but necessary) change we had to do to allow future plans we have of re-skinng the data grid in frameworks such as React, Angular and Vue. See https://www.ag-grid.com/javascript-grid/cell-rendering/#many-renderers-one-column","colDef.pinnedRowCellRenderer-deprecated"),r.pinnedRowCellRendererFramework&&t("AG Grid: pinnedRowCellRenderer no longer exists, use cellRendererSelector if you want a different Cell Renderer for pinned rows. Check params.node.rowPinned. This was an unfortunate (but necessary) change we had to do to allow future plans we have of re-skinng the data grid in frameworks such as React, Angular and Vue. See https://www.ag-grid.com/javascript-grid/cell-rendering/#many-renderers-one-column","colDef.pinnedRowCellRenderer-deprecated"),r.pinnedRowValueGetter&&t("AG Grid: pinnedRowCellRenderer is deprecated, use cellRendererSelector if you want a different Cell Renderer for pinned rows. Check params.node.rowPinned. This was an unfortunate (but necessary) change we had to do to allow future plans we have of re-skinng the data grid in frameworks such as React, Angular and Vue.","colDef.pinnedRowCellRenderer-deprecated")},h.prototype.addEventListener=function(r,t){this.eventService.addEventListener(r,t)},h.prototype.removeEventListener=function(r,t){this.eventService.removeEventListener(r,t)},h.prototype.createColumnFunctionCallbackParams=function(r){return{node:r,data:r.data,column:this,colDef:this.colDef,context:this.gridOptionsWrapper.getContext(),api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi()}},h.prototype.isSuppressNavigable=function(r){if("boolean"==typeof this.colDef.suppressNavigable)return this.colDef.suppressNavigable;if("function"==typeof this.colDef.suppressNavigable){var t=this.createColumnFunctionCallbackParams(r);return(0,this.colDef.suppressNavigable)(t)}return!1},h.prototype.isCellEditable=function(r){return!(r.group&&!this.gridOptionsWrapper.isEnableGroupEdit())&&this.isColumnFunc(r,this.colDef.editable)},h.prototype.isSuppressFillHandle=function(){return!!this.colDef.suppressFillHandle},h.prototype.isRowDrag=function(r){return this.isColumnFunc(r,this.colDef.rowDrag)},h.prototype.isDndSource=function(r){return this.isColumnFunc(r,this.colDef.dndSource)},h.prototype.isCellCheckboxSelection=function(r){return this.isColumnFunc(r,this.colDef.checkboxSelection)},h.prototype.isSuppressPaste=function(r){return this.isColumnFunc(r,this.colDef?this.colDef.suppressPaste:null)},h.prototype.isResizable=function(){return!0===this.colDef.resizable},h.prototype.isColumnFunc=function(r,t){return"boolean"==typeof t?t:"function"==typeof t&&t(this.createColumnFunctionCallbackParams(r))},h.prototype.setMoving=function(r,t){void 0===t&&(t="api"),this.moving=r,this.eventService.dispatchEvent(this.createColumnEvent(h.EVENT_MOVING_CHANGED,t))},h.prototype.createColumnEvent=function(r,t){return{api:this.gridApi,columnApi:this.columnApi,type:r,column:this,columns:[this],source:t}},h.prototype.isMoving=function(){return this.moving},h.prototype.getSort=function(){return this.sort},h.prototype.setSort=function(r,t){void 0===t&&(t="api"),this.sort!==r&&(this.sort=r,this.eventService.dispatchEvent(this.createColumnEvent(h.EVENT_SORT_CHANGED,t)))},h.prototype.setMenuVisible=function(r,t){void 0===t&&(t="api"),this.menuVisible!==r&&(this.menuVisible=r,this.eventService.dispatchEvent(this.createColumnEvent(h.EVENT_MENU_VISIBLE_CHANGED,t)))},h.prototype.isMenuVisible=function(){return this.menuVisible},h.prototype.isSortAscending=function(){return this.sort===W.SORT_ASC},h.prototype.isSortDescending=function(){return this.sort===W.SORT_DESC},h.prototype.isSortNone=function(){return g(this.sort)},h.prototype.isSorting=function(){return v(this.sort)},h.prototype.getSortIndex=function(){return this.sortIndex},h.prototype.setSortIndex=function(r){this.sortIndex=r},h.prototype.setAggFunc=function(r){this.aggFunc=r},h.prototype.getAggFunc=function(){return this.aggFunc},h.prototype.getLeft=function(){return this.left},h.prototype.getOldLeft=function(){return this.oldLeft},h.prototype.getRight=function(){return this.left+this.actualWidth},h.prototype.setLeft=function(r,t){void 0===t&&(t="api"),this.oldLeft=this.left,this.left!==r&&(this.left=r,this.eventService.dispatchEvent(this.createColumnEvent(h.EVENT_LEFT_CHANGED,t)))},h.prototype.isFilterActive=function(){return this.filterActive},h.prototype.setFilterActive=function(r,t,n){void 0===t&&(t="api"),this.filterActive!==r&&(this.filterActive=r,this.eventService.dispatchEvent(this.createColumnEvent(h.EVENT_FILTER_ACTIVE_CHANGED,t)));var c=this.createColumnEvent(h.EVENT_FILTER_CHANGED,t);n&&pt(c,n),this.eventService.dispatchEvent(c)},h.prototype.setPinned=function(r){this.pinned=!0===r||r===W.PINNED_LEFT?W.PINNED_LEFT:r===W.PINNED_RIGHT?W.PINNED_RIGHT:null},h.prototype.setFirstRightPinned=function(r,t){void 0===t&&(t="api"),this.firstRightPinned!==r&&(this.firstRightPinned=r,this.eventService.dispatchEvent(this.createColumnEvent(h.EVENT_FIRST_RIGHT_PINNED_CHANGED,t)))},h.prototype.setLastLeftPinned=function(r,t){void 0===t&&(t="api"),this.lastLeftPinned!==r&&(this.lastLeftPinned=r,this.eventService.dispatchEvent(this.createColumnEvent(h.EVENT_LAST_LEFT_PINNED_CHANGED,t)))},h.prototype.isFirstRightPinned=function(){return this.firstRightPinned},h.prototype.isLastLeftPinned=function(){return this.lastLeftPinned},h.prototype.isPinned=function(){return this.pinned===W.PINNED_LEFT||this.pinned===W.PINNED_RIGHT},h.prototype.isPinnedLeft=function(){return this.pinned===W.PINNED_LEFT},h.prototype.isPinnedRight=function(){return this.pinned===W.PINNED_RIGHT},h.prototype.getPinned=function(){return this.pinned},h.prototype.setVisible=function(r,t){void 0===t&&(t="api");var n=!0===r;this.visible!==n&&(this.visible=n,this.eventService.dispatchEvent(this.createColumnEvent(h.EVENT_VISIBLE_CHANGED,t)))},h.prototype.isVisible=function(){return this.visible},h.prototype.getColDef=function(){return this.colDef},h.prototype.getColumnGroupShow=function(){return this.colDef.columnGroupShow},h.prototype.getColId=function(){return this.colId},h.prototype.getId=function(){return this.getColId()},h.prototype.getUniqueId=function(){return this.getId()},h.prototype.getDefinition=function(){return this.colDef},h.prototype.getActualWidth=function(){return this.actualWidth},h.prototype.createBaseColDefParams=function(r){return{node:r,data:r.data,colDef:this.colDef,column:this,api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi(),context:this.gridOptionsWrapper.getContext()}},h.prototype.getColSpan=function(r){if(g(this.colDef.colSpan))return 1;var t=this.createBaseColDefParams(r),n=this.colDef.colSpan(t);return Math.max(n,1)},h.prototype.getRowSpan=function(r){if(g(this.colDef.rowSpan))return 1;var t=this.createBaseColDefParams(r),n=this.colDef.rowSpan(t);return Math.max(n,1)},h.prototype.setActualWidth=function(r,t,n){void 0===t&&(t="api"),void 0===n&&(n=!1),null!=this.minWidth&&(r=Math.max(r,this.minWidth)),null!=this.maxWidth&&(r=Math.min(r,this.maxWidth)),this.actualWidth!==r&&(this.actualWidth=r,this.flex&&"flex"!==t&&"gridInitializing"!==t&&(this.flex=null),n||this.fireColumnWidthChangedEvent(t))},h.prototype.fireColumnWidthChangedEvent=function(r){this.eventService.dispatchEvent(this.createColumnEvent(h.EVENT_WIDTH_CHANGED,r))},h.prototype.isGreaterThanMax=function(r){return null!=this.maxWidth&&r>this.maxWidth},h.prototype.getMinWidth=function(){return this.minWidth},h.prototype.getMaxWidth=function(){return this.maxWidth},h.prototype.getFlex=function(){return this.flex||0},h.prototype.setFlex=function(r){this.flex!==r&&(this.flex=r)},h.prototype.setMinimum=function(r){void 0===r&&(r="api"),v(this.minWidth)&&this.setActualWidth(this.minWidth,r)},h.prototype.setRowGroupActive=function(r,t){void 0===t&&(t="api"),this.rowGroupActive!==r&&(this.rowGroupActive=r,this.eventService.dispatchEvent(this.createColumnEvent(h.EVENT_ROW_GROUP_CHANGED,t)))},h.prototype.isRowGroupActive=function(){return this.rowGroupActive},h.prototype.setPivotActive=function(r,t){void 0===t&&(t="api"),this.pivotActive!==r&&(this.pivotActive=r,this.eventService.dispatchEvent(this.createColumnEvent(h.EVENT_PIVOT_CHANGED,t)))},h.prototype.isPivotActive=function(){return this.pivotActive},h.prototype.isAnyFunctionActive=function(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()},h.prototype.isAnyFunctionAllowed=function(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()},h.prototype.setValueActive=function(r,t){void 0===t&&(t="api"),this.aggregationActive!==r&&(this.aggregationActive=r,this.eventService.dispatchEvent(this.createColumnEvent(h.EVENT_VALUE_CHANGED,t)))},h.prototype.isValueActive=function(){return this.aggregationActive},h.prototype.isAllowPivot=function(){return!0===this.colDef.enablePivot},h.prototype.isAllowValue=function(){return!0===this.colDef.enableValue},h.prototype.isAllowRowGroup=function(){return!0===this.colDef.enableRowGroup},h.prototype.getMenuTabs=function(r){var t=this.getColDef().menuTabs;return null==t&&(t=r),t},h.prototype.isLockPosition=function(){return console.warn("AG Grid: since v21, col.isLockPosition() should not be used, please use col.getColDef().lockPosition instead."),!!this.colDef&&!!this.colDef.lockPosition},h.prototype.isLockVisible=function(){return console.warn("AG Grid: since v21, col.isLockVisible() should not be used, please use col.getColDef().lockVisible instead."),!!this.colDef&&!!this.colDef.lockVisible},h.prototype.isLockPinned=function(){return console.warn("AG Grid: since v21, col.isLockPinned() should not be used, please use col.getColDef().lockPinned instead."),!!this.colDef&&!!this.colDef.lockPinned},h.EVENT_MOVING_CHANGED="movingChanged",h.EVENT_LEFT_CHANGED="leftChanged",h.EVENT_WIDTH_CHANGED="widthChanged",h.EVENT_LAST_LEFT_PINNED_CHANGED="lastLeftPinnedChanged",h.EVENT_FIRST_RIGHT_PINNED_CHANGED="firstRightPinnedChanged",h.EVENT_VISIBLE_CHANGED="visibleChanged",h.EVENT_FILTER_CHANGED="filterChanged",h.EVENT_FILTER_ACTIVE_CHANGED="filterActiveChanged",h.EVENT_SORT_CHANGED="sortChanged",h.EVENT_MENU_VISIBLE_CHANGED="menuVisibleChanged",h.EVENT_ROW_GROUP_CHANGED="columnRowGroupChanged",h.EVENT_PIVOT_CHANGED="columnPivotChanged",h.EVENT_VALUE_CHANGED="columnValueChanged",Ie([Ee("gridOptionsWrapper")],h.prototype,"gridOptionsWrapper",void 0),Ie([Ee("columnUtils")],h.prototype,"columnUtils",void 0),Ie([Ee("columnApi")],h.prototype,"columnApi",void 0),Ie([Ee("gridApi")],h.prototype,"gridApi",void 0),Ie([Ee("context")],h.prototype,"context",void 0),Ie([zt],h.prototype,"initialise",null),h}(),xt=function(){function h(r,t,n,c){this.displayedChildren=[],this.localEventService=new Zn,this.groupId=t,this.instanceId=n,this.originalColumnGroup=r,this.pinned=c}return h.createUniqueId=function(r,t){return r+"_"+t},h.prototype.reset=function(){this.parent=null,this.children=null,this.displayedChildren=null},h.prototype.getParent=function(){return this.parent},h.prototype.setParent=function(r){this.parent=r},h.prototype.getUniqueId=function(){return h.createUniqueId(this.groupId,this.instanceId)},h.prototype.isEmptyGroup=function(){return 0===this.displayedChildren.length},h.prototype.isMoving=function(){var r=this.getOriginalColumnGroup().getLeafColumns();return!(!r||0===r.length)&&r.every(function(t){return t.isMoving()})},h.prototype.checkLeft=function(){if(this.displayedChildren.forEach(function(c){c instanceof h&&c.checkLeft()}),this.displayedChildren.length>0)if(this.gridOptionsWrapper.isEnableRtl()){var t=H(this.displayedChildren).getLeft();this.setLeft(t)}else{var n=this.displayedChildren[0].getLeft();this.setLeft(n)}else this.setLeft(null)},h.prototype.getLeft=function(){return this.left},h.prototype.getOldLeft=function(){return this.oldLeft},h.prototype.setLeft=function(r){this.oldLeft=r,this.left!==r&&(this.left=r,this.localEventService.dispatchEvent(this.createAgEvent(h.EVENT_LEFT_CHANGED)))},h.prototype.getPinned=function(){return this.pinned},h.prototype.createAgEvent=function(r){return{type:r}},h.prototype.addEventListener=function(r,t){this.localEventService.addEventListener(r,t)},h.prototype.removeEventListener=function(r,t){this.localEventService.removeEventListener(r,t)},h.prototype.getGroupId=function(){return this.groupId},h.prototype.getInstanceId=function(){return this.instanceId},h.prototype.isChildInThisGroupDeepSearch=function(r){var t=!1;return this.children.forEach(function(n){r===n&&(t=!0),n instanceof h&&n.isChildInThisGroupDeepSearch(r)&&(t=!0)}),t},h.prototype.getActualWidth=function(){var r=0;return this.displayedChildren&&this.displayedChildren.forEach(function(t){r+=t.getActualWidth()}),r},h.prototype.isResizable=function(){if(!this.displayedChildren)return!1;var r=!1;return this.displayedChildren.forEach(function(t){t.isResizable()&&(r=!0)}),r},h.prototype.getMinWidth=function(){var r=0;return this.displayedChildren.forEach(function(t){r+=t.getMinWidth()||0}),r},h.prototype.addChild=function(r){this.children||(this.children=[]),this.children.push(r)},h.prototype.getDisplayedChildren=function(){return this.displayedChildren},h.prototype.getLeafColumns=function(){var r=[];return this.addLeafColumns(r),r},h.prototype.getDisplayedLeafColumns=function(){var r=[];return this.addDisplayedLeafColumns(r),r},h.prototype.getDefinition=function(){return this.originalColumnGroup.getColGroupDef()},h.prototype.getColGroupDef=function(){return this.originalColumnGroup.getColGroupDef()},h.prototype.isPadding=function(){return this.originalColumnGroup.isPadding()},h.prototype.isExpandable=function(){return this.originalColumnGroup.isExpandable()},h.prototype.isExpanded=function(){return this.originalColumnGroup.isExpanded()},h.prototype.setExpanded=function(r){this.originalColumnGroup.setExpanded(r)},h.prototype.addDisplayedLeafColumns=function(r){this.displayedChildren.forEach(function(t){t instanceof it?r.push(t):t instanceof h&&t.addDisplayedLeafColumns(r)})},h.prototype.addLeafColumns=function(r){this.children.forEach(function(t){t instanceof it?r.push(t):t instanceof h&&t.addLeafColumns(r)})},h.prototype.getChildren=function(){return this.children},h.prototype.getColumnGroupShow=function(){return this.originalColumnGroup.getColumnGroupShow()},h.prototype.getOriginalColumnGroup=function(){return this.originalColumnGroup},h.prototype.getPaddingLevel=function(){var r=this.getParent();return this.isPadding()&&r&&r.isPadding()?1+r.getPaddingLevel():0},h.prototype.calculateDisplayedColumns=function(){var r=this;this.displayedChildren=[];for(var t=this;null!=t&&t.isPadding();)t=t.getParent();if(!t||!t.originalColumnGroup.isExpandable())return this.displayedChildren=this.children,void this.localEventService.dispatchEvent(this.createAgEvent(h.EVENT_DISPLAYED_CHILDREN_CHANGED));this.children.forEach(function(c){if(!(c instanceof h)||c.displayedChildren&&c.displayedChildren.length)switch(c.getColumnGroupShow()){case h.HEADER_GROUP_SHOW_OPEN:t.originalColumnGroup.isExpanded()&&r.displayedChildren.push(c);break;case h.HEADER_GROUP_SHOW_CLOSED:t.originalColumnGroup.isExpanded()||r.displayedChildren.push(c);break;default:r.displayedChildren.push(c)}}),this.localEventService.dispatchEvent(this.createAgEvent(h.EVENT_DISPLAYED_CHILDREN_CHANGED))},h.HEADER_GROUP_SHOW_OPEN="open",h.HEADER_GROUP_SHOW_CLOSED="closed",h.EVENT_LEFT_CHANGED="leftChanged",h.EVENT_DISPLAYED_CHILDREN_CHANGED="displayedChildrenChanged",function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);c>3&&f&&Object.defineProperty(r,t,f)}([Ee("gridOptionsWrapper")],h.prototype,"gridOptionsWrapper",void 0),h}(),kt=function(){function h(r,t,n,c){this.localEventService=new Zn,this.expandable=!1,this.colGroupDef=r,this.groupId=t,this.expanded=!!r&&!!r.openByDefault,this.padding=n,this.level=c}return h.prototype.setOriginalParent=function(r){this.originalParent=r},h.prototype.getOriginalParent=function(){return this.originalParent},h.prototype.getLevel=function(){return this.level},h.prototype.isVisible=function(){return!!this.children&&this.children.some(function(r){return r.isVisible()})},h.prototype.isPadding=function(){return this.padding},h.prototype.setExpanded=function(r){this.expanded=void 0!==r&&r,this.localEventService.dispatchEvent({type:h.EVENT_EXPANDED_CHANGED})},h.prototype.isExpandable=function(){return this.expandable},h.prototype.isExpanded=function(){return this.expanded},h.prototype.getGroupId=function(){return this.groupId},h.prototype.getId=function(){return this.getGroupId()},h.prototype.setChildren=function(r){this.children=r},h.prototype.getChildren=function(){return this.children},h.prototype.getColGroupDef=function(){return this.colGroupDef},h.prototype.getLeafColumns=function(){var r=[];return this.addLeafColumns(r),r},h.prototype.addLeafColumns=function(r){!this.children||this.children.forEach(function(t){t instanceof it?r.push(t):t instanceof h&&t.addLeafColumns(r)})},h.prototype.getColumnGroupShow=function(){var r=this.colGroupDef;if(r)return r.columnGroupShow},h.prototype.setupExpandable=function(){var r=this;this.setExpandable(),this.getLeafColumns().forEach(function(t){return t.addEventListener(it.EVENT_VISIBLE_CHANGED,r.onColumnVisibilityChanged.bind(r))})},h.prototype.setExpandable=function(){if(!this.isPadding()){for(var r=!1,t=!1,n=!1,c=this.findChildrenRemovingPadding(),f=0,y=c.length;f<y;f++){var T=c[f];if(T.isVisible()){var B=T.getColumnGroupShow();B===xt.HEADER_GROUP_SHOW_OPEN?(r=!0,n=!0):B===xt.HEADER_GROUP_SHOW_CLOSED?(t=!0,n=!0):(r=!0,t=!0)}}var q=r&&t&&n;this.expandable!==q&&(this.expandable=q,this.localEventService.dispatchEvent({type:h.EVENT_EXPANDABLE_CHANGED}))}},h.prototype.findChildrenRemovingPadding=function(){var r=[];return function n(c){c.forEach(function(f){f instanceof h&&f.isPadding()?n(f.children):r.push(f)})}(this.children),r},h.prototype.onColumnVisibilityChanged=function(){this.setExpandable()},h.prototype.addEventListener=function(r,t){this.localEventService.addEventListener(r,t)},h.prototype.removeEventListener=function(r,t){this.localEventService.removeEventListener(r,t)},h.EVENT_EXPANDED_CHANGED="expandedChanged",h.EVENT_EXPANDABLE_CHANGED="expandableChanged",h}(),ir={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}},Cr="__ag_Grid_Stop_Propagation",Hr=["touchstart","touchend","touchmove","touchcancel"],Xr={};function kr(h){h[Cr]=!0}function fr(h){return!0===h[Cr]}var Pr=function(){var h={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return function(n){if("boolean"==typeof Xr[n])return Xr[n];var c=document.createElement(h[n]||"div"),f=(n="on"+n)in c;return f||(c.setAttribute(n,"return;"),f="function"==typeof c[n]),Xr[n]=f}}();function wi(h,r,t){for(var n=Ye(r);n;){var c=h.getDomData(n,t);if(c)return c;n=n.parentElement}return null}function Ye(h){return h.target||h.srcElement}function st(h,r){return!(!r||!h)&&ar(r).indexOf(h)>=0}function bt(h){for(var r=[],t=Ye(h);t;)r.push(t),t=t.parentElement;return r}function ar(h){var r=h;return r.deepPath?r.deepPath():r.path?r.path:r.composedPath?r.composedPath():r.__agGridEventPath?r.__agGridEventPath:bt(h)}function Xt(h,r,t,n){var c=oe(Hr,t);h&&h.addEventListener&&h.addEventListener(r,t,n,c?{passive:!0}:void 0)}var Zt=Object.freeze({__proto__:null,stopPropagationForAgGrid:kr,isStopPropagationForAgGrid:fr,isEventSupported:Pr,getCtrlForEvent:wi,addChangeListener:function(h,r){h.addEventListener("changed",r),h.addEventListener("paste",r),h.addEventListener("input",r),h.addEventListener("keydown",r),h.addEventListener("keyup",r)},getTarget:Ye,isElementInEventPath:st,createEventPath:bt,addAgGridEventPath:function(h){h.__agGridEventPath=ar(h)},getEventPath:ar,addSafePassiveEventListener:Xt}),jt=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},ct=function(){function h(){var r=this;this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.isAlive=function(){return!r.destroyed}}return h.prototype.getFrameworkOverrides=function(){return this.frameworkOverrides},h.prototype.getContext=function(){return this.context},h.prototype.destroy=function(){this.destroyFunctions.forEach(function(r){return r()}),this.destroyFunctions.length=0,this.destroyed=!0,this.dispatchEvent({type:h.EVENT_DESTROYED})},h.prototype.addEventListener=function(r,t){this.localEventService||(this.localEventService=new Zn),this.localEventService.addEventListener(r,t)},h.prototype.removeEventListener=function(r,t){this.localEventService&&this.localEventService.removeEventListener(r,t)},h.prototype.dispatchEventAsync=function(r){var t=this;window.setTimeout(function(){return t.dispatchEvent(r)},0)},h.prototype.dispatchEvent=function(r){this.localEventService&&this.localEventService.dispatchEvent(r)},h.prototype.addManagedListener=function(r,t,n){var c=this;if(!this.destroyed){r instanceof HTMLElement?Xt(this.getFrameworkOverrides(),r,t,n):r.addEventListener(t,n);var f=function y(){return r.removeEventListener(t,n),c.destroyFunctions=c.destroyFunctions.filter(function(T){return T!==y}),null};return this.destroyFunctions.push(f),f}},h.prototype.addDestroyFunc=function(r){this.isAlive()?this.destroyFunctions.push(r):r()},h.prototype.createManagedBean=function(r,t){var n=this.createBean(r,t);return this.addDestroyFunc(this.destroyBean.bind(this,r,t)),n},h.prototype.createBean=function(r,t,n){return(t||this.getContext()).createBean(r,n)},h.prototype.destroyBean=function(r,t){return(t||this.getContext()).destroyBean(r)},h.prototype.destroyBeans=function(r,t){var n=this;return r&&se(r,function(c){return n.destroyBean(c,t)}),[]},h.EVENT_DESTROYED="destroyed",jt([Ee("frameworkOverrides")],h.prototype,"frameworkOverrides",void 0),jt([Ee("context")],h.prototype,"context",void 0),jt([Ee("eventService")],h.prototype,"eventService",void 0),jt([Ee("gridOptionsWrapper")],h.prototype,"gridOptionsWrapper",void 0),jt([Ln],h.prototype,"destroy",null),h}(),$t=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),or=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Un=function(h,r){return function(t,n){r(t,n,h)}},br=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return $t(r,h),r.prototype.setBeans=function(t){this.logger=t.create("ColumnFactory")},r.prototype.createColumnTree=function(t,n,c){var f=new L,y=this.extractExistingTreeData(c),T=y.existingCols,B=y.existingGroups;f.addExistingKeys(y.existingColKeys);var de=this.recursivelyCreateColumns(t,0,n,T,f,B),Se=this.findMaxDept(de,0);this.logger.log("Number of levels for grouped columns is "+Se);var ke=this.balanceColumnTree(de,0,Se,f);return this.columnUtils.depthFirstOriginalTreeSearch(null,ke,function(rt,_t){rt instanceof kt&&rt.setupExpandable(),rt.setOriginalParent(_t)}),{columnTree:ke,treeDept:Se}},r.prototype.extractExistingTreeData=function(t){var n=[],c=[],f=[];return t&&this.columnUtils.depthFirstOriginalTreeSearch(null,t,function(y){if(y instanceof kt)c.push(y);else{var B=y;f.push(B.getId()),n.push(B)}}),{existingCols:n,existingGroups:c,existingColKeys:f}},r.prototype.createForAutoGroups=function(t,n){var c=this,f=[];return t.forEach(function(y){var T=c.createAutoGroupTreeItem(n,y);f.push(T)}),f},r.prototype.createAutoGroupTreeItem=function(t,n){for(var f=n,y=this.findDepth(t)-1;y>=0;y--){var T=new kt(null,"FAKE_PATH_"+n.getId()+"}_"+y,!0,y);this.context.createBean(T),T.setChildren([f]),f.setOriginalParent(T),f=T}return f},r.prototype.findDepth=function(t){for(var n=0,c=t;c&&c[0]&&c[0]instanceof kt;)n++,c=c[0].getChildren();return n},r.prototype.balanceColumnTree=function(t,n,c,f){for(var y=[],T=0;T<t.length;T++){var B=t[T];if(B instanceof kt){var q=B,de=this.balanceColumnTree(q.getChildren(),n+1,c,f);q.setChildren(de),y.push(q)}else{for(var Se=void 0,ke=void 0,je=c-1;je>=n;je--){var Qe=f.getUniqueKey(null,null),rt=this.createMergedColGroupDef(null),_t=new kt(rt,Qe,!0,n);this.context.createBean(_t),ke&&ke.setChildren([_t]),ke=_t,Se||(Se=ke)}if(Se&&ke){if(y.push(Se),t.some(function(Ut){return Ut instanceof kt})){ke.setChildren([B]);continue}ke.setChildren(t);break}y.push(B)}}return y},r.prototype.findMaxDept=function(t,n){for(var c=n,f=0;f<t.length;f++){var y=t[f];if(y instanceof kt){var B=this.findMaxDept(y.getChildren(),n+1);c<B&&(c=B)}}return c},r.prototype.recursivelyCreateColumns=function(t,n,c,f,y,T){var B=this,q=[];return t&&t.forEach(function(de){var Se;Se=B.isColumnGroup(de)?B.createColumnGroup(c,de,n,f,y,T):B.createColumn(c,de,f,y),q.push(Se)}),q},r.prototype.createColumnGroup=function(t,n,c,f,y,T){var B=this.createMergedColGroupDef(n),q=y.getUniqueKey(B.groupId||null,null),de=new kt(B,q,!1,c);this.context.createBean(de);var Se=this.findExistingGroup(n,T);Se&&Se.isExpanded()&&de.setExpanded(!0);var ke=this.recursivelyCreateColumns(B.children,c+1,t,f,y,T);return de.setChildren(ke),de},r.prototype.createMergedColGroupDef=function(t){var n={};return ut(n,this.gridOptionsWrapper.getDefaultColGroupDef()),ut(n,t),this.checkForDeprecatedItems(n),n},r.prototype.createColumn=function(t,n,c,f){var y=this.mergeColDefs(n);this.checkForDeprecatedItems(y);var T=this.findExistingColumn(n,c);if(T)T.setColDef(y,n),this.applyColumnState(T,y);else{var B=f.getUniqueKey(y.colId,y.field);T=new it(y,n,B,t),this.context.createBean(T)}return T},r.prototype.applyColumnState=function(t,n){var c=_(n.flex);if(void 0!==c&&t.setFlex(c),t.getFlex()<=0){var y=_(n.width);if(null!=y)t.setActualWidth(y);else{var T=t.getActualWidth();t.setActualWidth(T)}}void 0!==n.sort&&t.setSort(n.sort==W.SORT_ASC||n.sort==W.SORT_DESC?n.sort:void 0);var B=_(n.sortIndex);void 0!==B&&t.setSortIndex(B);var q=x(n.hide);void 0!==q&&t.setVisible(!q),void 0!==n.pinned&&t.setPinned(n.pinned)},r.prototype.findExistingColumn=function(t,n){var c=O(n,function(f){var y=f.getUserProvidedColDef();if(!y)return!1;var B=null!=t.field;return null!=t.colId?f.getId()===t.colId:B?y.field===t.field:y===t});return n&&c&&k(n,c),c},r.prototype.findExistingGroup=function(t,n){var c=O(n,function(f){return!(!f.getColGroupDef()||null==t.groupId||f.getId()!==t.groupId)});return c&&k(n,c),c},r.prototype.mergeColDefs=function(t){var n={},c=this.gridOptionsWrapper.getDefaultColDef();pt(n,c,!1,!0);var f=t.type;return f||(f=c&&c.type),f&&this.assignColumnTypes(f,n),pt(n,t,!1,!0),n},r.prototype.assignColumnTypes=function(t,n){var c=[];if(t instanceof Array)t.some(function(B){return"string"!=typeof B})?console.warn("ag-grid: if colDef.type is supplied an array it should be of type 'string[]'"):c=t;else{if("string"!=typeof t)return void console.warn("ag-grid: colDef.type should be of type 'string' | 'string[]'");c=t.split(",")}var y=ut({},ir);ce(this.gridOptionsWrapper.getColumnTypes()||{},function(B,q){B in y?console.warn("AG Grid: the column type '"+B+"' is a default column type and cannot be overridden."):y[B]=q}),c.forEach(function(B){var q=y[B.trim()];q?pt(n,q,!1,!0):console.warn("ag-grid: colDef.type '"+B+"' does not correspond to defined gridOptions.columnTypes")})},r.prototype.checkForDeprecatedItems=function(t){if(t){var n=t;void 0!==n.group&&console.warn("ag-grid: colDef.group is invalid, please check documentation on how to do grouping as it changed in version 3"),void 0!==n.headerGroup&&console.warn("ag-grid: colDef.headerGroup is invalid, please check documentation on how to do grouping as it changed in version 3"),void 0!==n.headerGroupShow&&console.warn("ag-grid: colDef.headerGroupShow is invalid, should be columnGroupShow, please check documentation on how to do grouping as it changed in version 3"),void 0!==n.suppressRowGroup&&console.warn("ag-grid: colDef.suppressRowGroup is deprecated, please use colDef.type instead"),void 0!==n.suppressAggregation&&console.warn("ag-grid: colDef.suppressAggregation is deprecated, please use colDef.type instead"),(n.suppressRowGroup||n.suppressAggregation)&&console.warn("ag-grid: colDef.suppressAggregation and colDef.suppressRowGroup are deprecated, use allowRowGroup, allowPivot and allowValue instead"),n.displayName&&(console.warn("ag-grid: Found displayName "+n.displayName+", please use headerName instead, displayName is deprecated."),n.headerName=n.displayName)}},r.prototype.isColumnGroup=function(t){return void 0!==t.children},or([Ee("columnUtils")],r.prototype,"columnUtils",void 0),or([Un(0,Dn("loggerFactory"))],r.prototype,"setBeans",null),or([Kt("columnFactory")],r)}(ct),Ge=function(){function h(){}return h.EVENT_COLUMN_EVERYTHING_CHANGED="columnEverythingChanged",h.EVENT_NEW_COLUMNS_LOADED="newColumnsLoaded",h.EVENT_COLUMN_PIVOT_MODE_CHANGED="columnPivotModeChanged",h.EVENT_COLUMN_ROW_GROUP_CHANGED="columnRowGroupChanged",h.EVENT_EXPAND_COLLAPSE_ALL="expandOrCollapseAll",h.EVENT_COLUMN_PIVOT_CHANGED="columnPivotChanged",h.EVENT_GRID_COLUMNS_CHANGED="gridColumnsChanged",h.EVENT_COLUMN_VALUE_CHANGED="columnValueChanged",h.EVENT_COLUMN_MOVED="columnMoved",h.EVENT_COLUMN_VISIBLE="columnVisible",h.EVENT_COLUMN_PINNED="columnPinned",h.EVENT_COLUMN_GROUP_OPENED="columnGroupOpened",h.EVENT_COLUMN_RESIZED="columnResized",h.EVENT_DISPLAYED_COLUMNS_CHANGED="displayedColumnsChanged",h.EVENT_VIRTUAL_COLUMNS_CHANGED="virtualColumnsChanged",h.EVENT_ASYNC_TRANSACTIONS_FLUSHED="asyncTransactionsFlushed",h.EVENT_ROW_GROUP_OPENED="rowGroupOpened",h.EVENT_ROW_DATA_CHANGED="rowDataChanged",h.EVENT_ROW_DATA_UPDATED="rowDataUpdated",h.EVENT_PINNED_ROW_DATA_CHANGED="pinnedRowDataChanged",h.EVENT_RANGE_SELECTION_CHANGED="rangeSelectionChanged",h.EVENT_CHART_CREATED="chartCreated",h.EVENT_CHART_RANGE_SELECTION_CHANGED="chartRangeSelectionChanged",h.EVENT_CHART_OPTIONS_CHANGED="chartOptionsChanged",h.EVENT_CHART_DESTROYED="chartDestroyed",h.EVENT_TOOL_PANEL_VISIBLE_CHANGED="toolPanelVisibleChanged",h.EVENT_COLUMN_PANEL_ITEM_DRAG_START="columnPanelItemDragStart",h.EVENT_COLUMN_PANEL_ITEM_DRAG_END="columnPanelItemDragEnd",h.EVENT_MODEL_UPDATED="modelUpdated",h.EVENT_PASTE_START="pasteStart",h.EVENT_PASTE_END="pasteEnd",h.EVENT_FILL_START="fillStart",h.EVENT_FILL_END="fillEnd",h.EVENT_CELL_CLICKED="cellClicked",h.EVENT_CELL_DOUBLE_CLICKED="cellDoubleClicked",h.EVENT_CELL_MOUSE_DOWN="cellMouseDown",h.EVENT_CELL_CONTEXT_MENU="cellContextMenu",h.EVENT_CELL_VALUE_CHANGED="cellValueChanged",h.EVENT_ROW_VALUE_CHANGED="rowValueChanged",h.EVENT_CELL_FOCUSED="cellFocused",h.EVENT_ROW_SELECTED="rowSelected",h.EVENT_SELECTION_CHANGED="selectionChanged",h.EVENT_CELL_KEY_DOWN="cellKeyDown",h.EVENT_CELL_KEY_PRESS="cellKeyPress",h.EVENT_CELL_MOUSE_OVER="cellMouseOver",h.EVENT_CELL_MOUSE_OUT="cellMouseOut",h.EVENT_FILTER_CHANGED="filterChanged",h.EVENT_FILTER_MODIFIED="filterModified",h.EVENT_FILTER_OPENED="filterOpened",h.EVENT_SORT_CHANGED="sortChanged",h.EVENT_VIRTUAL_ROW_REMOVED="virtualRowRemoved",h.EVENT_ROW_CLICKED="rowClicked",h.EVENT_ROW_DOUBLE_CLICKED="rowDoubleClicked",h.EVENT_GRID_READY="gridReady",h.EVENT_GRID_SIZE_CHANGED="gridSizeChanged",h.EVENT_VIEWPORT_CHANGED="viewportChanged",h.EVENT_SCROLLBAR_WIDTH_CHANGED="scrollbarWidthChanged",h.EVENT_FIRST_DATA_RENDERED="firstDataRendered",h.EVENT_DRAG_STARTED="dragStarted",h.EVENT_DRAG_STOPPED="dragStopped",h.EVENT_CHECKBOX_CHANGED="checkboxChanged",h.EVENT_ROW_EDITING_STARTED="rowEditingStarted",h.EVENT_ROW_EDITING_STOPPED="rowEditingStopped",h.EVENT_CELL_EDITING_STARTED="cellEditingStarted",h.EVENT_CELL_EDITING_STOPPED="cellEditingStopped",h.EVENT_BODY_SCROLL="bodyScroll",h.EVENT_BODY_SCROLL_END="bodyScrollEnd",h.EVENT_HEIGHT_SCALE_CHANGED="heightScaleChanged",h.EVENT_PAGINATION_CHANGED="paginationChanged",h.EVENT_COMPONENT_STATE_CHANGED="componentStateChanged",h.EVENT_BODY_HEIGHT_CHANGED="bodyHeightChanged",h.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED="displayedColumnsWidthChanged",h.EVENT_SCROLL_VISIBILITY_CHANGED="scrollVisibilityChanged",h.EVENT_COLUMN_HOVER_CHANGED="columnHoverChanged",h.EVENT_FLASH_CELLS="flashCells",h.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED="paginationPixelOffsetChanged",h.EVENT_DISPLAYED_ROWS_CHANGED="displayedRowsChanged",h.EVENT_LEFT_PINNED_WIDTH_CHANGED="leftPinnedWidthChanged",h.EVENT_RIGHT_PINNED_WIDTH_CHANGED="rightPinnedWidthChanged",h.EVENT_ROW_CONTAINER_HEIGHT_CHANGED="rowContainerHeightChanged",h.EVENT_ROW_DRAG_ENTER="rowDragEnter",h.EVENT_ROW_DRAG_MOVE="rowDragMove",h.EVENT_ROW_DRAG_LEAVE="rowDragLeave",h.EVENT_ROW_DRAG_END="rowDragEnd",h.EVENT_POPUP_TO_FRONT="popupToFront",h.EVENT_COLUMN_ROW_GROUP_CHANGE_REQUEST="columnRowGroupChangeRequest",h.EVENT_COLUMN_PIVOT_CHANGE_REQUEST="columnPivotChangeRequest",h.EVENT_COLUMN_VALUE_CHANGE_REQUEST="columnValueChangeRequest",h.EVENT_COLUMN_AGG_FUNC_CHANGE_REQUEST="columnAggFuncChangeRequest",h.EVENT_KEYBOARD_FOCUS="keyboardFocus",h.EVENT_MOUSE_FOCUS="mouseFocus",h.EVENT_STORE_UPDATED="storeUpdated",h}(),Wr=function(){function h(){this.existingIds={}}return h.prototype.getInstanceIdForKey=function(r){var n,t=this.existingIds[r];return this.existingIds[r]=n="number"!=typeof t?0:t+1,n},h}(),fn=/[&<>"']/g,zn={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function sn(h,r){if(r=Math.floor(r),0===h.length||0===r)return"";var t=h.length*r;for(r=Math.floor(Math.log(r)/Math.log(2));r;)h+=h,r--;return h+h.substring(0,t-h.length)}function hi(h,r,t){return h.length>r?h:((r-=h.length)>t.length&&(t+=sn(t,r/t.length)),t.slice(0,r)+h)}function hr(h){return null==h?null:h.replace(/([A-Z])/g,function(r){return"-"+r[0].toLowerCase()})}function $n(h){return null==h?null:h.replace(/-([a-z])/g,function(r){return r[1].toUpperCase()})}function Pe(h){return h[0].toUpperCase()+h.substr(1).toLowerCase()}function Oe(h){return null==h?null:h.toString().toString().replace(fn,function(r){return zn[r]})}function Ve(h){return h&&null!=h?h.replace(/([A-Z])([A-Z])([a-z])|([a-z])([A-Z])/g,"$1$4 $2$3$5").replace("."," ").split(" ").map(function(n){return n.substring(0,1).toUpperCase()+(n.length>1?n.substring(1,n.length):"")}).join(" "):null}function We(h,r){return h===r||null!=h&&h.slice(0,r.length)===r}var Ue=Object.freeze({__proto__:null,utf8_encode:function(h){var r=String.fromCharCode;function c(Se,ke){return r(Se>>ke&63|128)}function f(Se){if(Se>=0&&Se<=31&&10!==Se)return"_x"+hi(Se.toString(16).toUpperCase(),4,"0")+"_";if(0==(4294967168&Se))return r(Se);var Qe="";return 0==(4294965248&Se)?Qe=r(Se>>6&31|192):0==(4294901760&Se)?(function(Se){if(Se>=55296&&Se<=57343)throw Error("Lone surrogate U+"+Se.toString(16).toUpperCase()+" is not a scalar value")}(Se),Qe=r(Se>>12&15|224),Qe+=c(Se,6)):0==(4292870144&Se)&&(Qe=r(Se>>18&7|240),Qe+=c(Se,12),Qe+=c(Se,6)),Qe+r(63&Se|128)}for(var y=function(Se){var ke=[];if(!Se)return[];for(var rt,_t,je=Se.length,Qe=0;Qe<je;)(rt=Se.charCodeAt(Qe++))>=55296&&rt<=56319&&Qe<je?56320==(64512&(_t=Se.charCodeAt(Qe++)))?ke.push(((1023&rt)<<10)+(1023&_t)+65536):(ke.push(rt),Qe--):ke.push(rt);return ke}(h),T=y.length,B=-1,de="";++B<T;)de+=f(y[B]);return de},stringRepeat:sn,padStart:hi,camelCaseToHyphen:hr,hyphenToCamelCase:$n,capitalise:Pe,escapeString:Oe,camelCaseToHumanText:Ve,startsWith:We});function dt(h){var r=new Map;return h.forEach(function(t){return r.set(t[0],t[1])}),r}var rr=Object.freeze({__proto__:null,convertToMap:dt,mapById:function(h,r){var t=new Map;return h.forEach(function(n){return t.set(r(n),n)}),t},keys:function(h){var r=[];return h.forEach(function(t,n){return r.push(n)}),r}}),Qt=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ht=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Tr=function(h,r){return function(t,n){r(t,n,h)}},tr=function(h){function r(){var t=null!==h&&h.apply(this,arguments)||this;return t.primaryHeaderRowCount=0,t.secondaryHeaderRowCount=0,t.secondaryColumnsPresent=!1,t.gridHeaderRowCount=0,t.displayedColumnsLeft=[],t.displayedColumnsRight=[],t.displayedColumnsCenter=[],t.displayedColumns=[],t.displayedColumnsAndGroupsMap={},t.viewportColumns=[],t.viewportColumnsCenter=[],t.autoHeightActiveAtLeastOnce=!1,t.rowGroupColumns=[],t.valueColumns=[],t.pivotColumns=[],t.ready=!1,t.autoGroupsNeedBuilding=!1,t.forceRecreateAutoGroups=!1,t.pivotMode=!1,t.bodyWidth=0,t.leftWidth=0,t.rightWidth=0,t.bodyWidthDirty=!0,t.colDefVersion=0,t.flexColsCalculatedAtLestOnce=!1,t}return Qt(r,h),r.prototype.init=function(){this.suppressColumnVirtualisation=this.gridOptionsWrapper.isSuppressColumnVirtualisation();var t=this.gridOptionsWrapper.isPivotMode();this.isPivotSettingAllowed(t)&&(this.pivotMode=t),this.usingTreeData=this.gridOptionsWrapper.isTreeData(),this.addManagedListener(this.gridOptionsWrapper,"autoGroupColumnDef",this.onAutoGroupColumnDefChanged.bind(this))},r.prototype.onAutoGroupColumnDefChanged=function(){this.autoGroupsNeedBuilding=!0,this.forceRecreateAutoGroups=!0,this.updateGridColumns(),this.updateDisplayedColumns("gridOptionsChanged")},r.prototype.getColDefVersion=function(){return this.colDefVersion},r.prototype.setColumnDefs=function(t,n){var c=this;void 0===n&&(n="api");var f=!!this.columnDefs;this.colDefVersion++;var y=this.compareColumnStatesAndRaiseEvents(n);this.columnDefs=t,this.valueCache.expire(),this.autoGroupsNeedBuilding=!0;var T=this.primaryColumns,q=this.columnFactory.createColumnTree(t,!0,this.primaryColumnTree);this.primaryColumnTree=q.columnTree,this.primaryHeaderRowCount=q.treeDept+1,this.primaryColumns=this.getColumnsFromTree(this.primaryColumnTree),this.primaryColumnsMap={},this.primaryColumns.forEach(function(de){return c.primaryColumnsMap[de.getId()]=de}),this.extractRowGroupColumns(n,T),this.extractPivotColumns(n,T),this.extractValueColumns(n,T),this.ready=!0,this.updateGridColumns(),f&&this.gridColsArePrimary&&!this.gridOptionsWrapper.isMaintainColumnOrder()&&this.orderGridColumnsLikePrimary(),this.updateDisplayedColumns(n),this.checkViewportColumns(),this.dispatchEverythingChanged(n),y(),this.dispatchNewColumnsLoaded()},r.prototype.dispatchNewColumnsLoaded=function(){this.eventService.dispatchEvent({type:Ge.EVENT_NEW_COLUMNS_LOADED,api:this.gridApi,columnApi:this.columnApi})},r.prototype.dispatchEverythingChanged=function(t){void 0===t&&(t="api"),this.eventService.dispatchEvent({type:Ge.EVENT_COLUMN_EVERYTHING_CHANGED,api:this.gridApi,columnApi:this.columnApi,source:t})},r.prototype.orderGridColumnsLikePrimary=function(){var t=this,n=this.primaryColumns;!n||this.gridColumns.sort(function(c,f){var y=n.indexOf(c),T=n.indexOf(f),B=y>=0,q=T>=0;return B&&q?y-T:B?1:q?-1:t.gridColumns.indexOf(c)-t.gridColumns.indexOf(f)})},r.prototype.getAllDisplayedAutoHeightCols=function(){return this.displayedAutoHeightCols},r.prototype.setViewport=function(){this.gridOptionsWrapper.isEnableRtl()?(this.viewportLeft=this.bodyWidth-this.scrollPosition-this.scrollWidth,this.viewportRight=this.bodyWidth-this.scrollPosition):(this.viewportLeft=this.scrollPosition,this.viewportRight=this.scrollWidth+this.scrollPosition)},r.prototype.getDisplayedColumnsStartingAt=function(t){for(var n=t,c=[];null!=n;)c.push(n),n=this.getDisplayedColAfter(n);return c},r.prototype.checkViewportColumns=function(){if(null!=this.displayedColumnsCenter){var t=this.viewportColumns.map(function(f){return f.getId()}).join("#");this.extractViewport(),t!==this.viewportColumns.map(function(f){return f.getId()}).join("#")&&this.eventService.dispatchEvent({type:Ge.EVENT_VIRTUAL_COLUMNS_CHANGED,api:this.gridApi,columnApi:this.columnApi})}},r.prototype.setViewportPosition=function(t,n){(t!==this.scrollWidth||n!==this.scrollPosition||this.bodyWidthDirty)&&(this.scrollWidth=t,this.scrollPosition=n,this.bodyWidthDirty=!0,this.setViewport(),this.ready&&this.checkViewportColumns())},r.prototype.isPivotMode=function(){return this.pivotMode},r.prototype.isPivotSettingAllowed=function(t){return!t||!this.gridOptionsWrapper.isTreeData()||(console.warn("AG Grid: Pivot mode not available in conjunction Tree Data i.e. 'gridOptions.treeData: true'"),!1)},r.prototype.setPivotMode=function(t,n){void 0===n&&(n="api"),t!==this.pivotMode&&this.isPivotSettingAllowed(this.pivotMode)&&(this.pivotMode=t,this.autoGroupsNeedBuilding=!0,this.updateGridColumns(),this.updateDisplayedColumns(n),this.eventService.dispatchEvent({type:Ge.EVENT_COLUMN_PIVOT_MODE_CHANGED,api:this.gridApi,columnApi:this.columnApi}))},r.prototype.getSecondaryPivotColumn=function(t,n){if(!this.secondaryColumnsPresent||!this.secondaryColumns)return null;var c=this.getPrimaryColumn(n),f=null;return this.secondaryColumns.forEach(function(y){var T=y.getColDef().pivotKeys,B=y.getColDef().pivotValueColumn;X(T,t)&&B===c&&(f=y)}),f},r.prototype.setBeans=function(t){this.logger=t.create("columnModel")},r.prototype.setFirstRightAndLastLeftPinned=function(t){var n,c;this.gridOptionsWrapper.isEnableRtl()?(n=this.displayedColumnsLeft?this.displayedColumnsLeft[0]:null,c=this.displayedColumnsRight?H(this.displayedColumnsRight):null):(n=this.displayedColumnsLeft?H(this.displayedColumnsLeft):null,c=this.displayedColumnsRight?this.displayedColumnsRight[0]:null),this.gridColumns.forEach(function(f){f.setLastLeftPinned(f===n,t),f.setFirstRightPinned(f===c,t)})},r.prototype.autoSizeColumns=function(t,n,c){var f=this;void 0===c&&(c="api"),this.animationFrameService.flushAllFrames();var y=[],T=-1;for(null==n&&(n=this.gridOptionsWrapper.isSkipHeaderOnAutoSize());0!==T;)T=0,this.actionOnGridColumns(t,function(B){if(y.indexOf(B)>=0)return!1;var q=f.autoWidthCalculator.getPreferredWidthForColumn(B,n);if(q>0){var de=f.normaliseColumnWidth(B,q);B.setActualWidth(de,c),y.push(B),T++}return!0},c);this.fireColumnResizedEvent(y,!0,"autosizeColumns")},r.prototype.fireColumnResizedEvent=function(t,n,c,f){void 0===f&&(f=null),t&&t.length&&this.eventService.dispatchEvent({type:Ge.EVENT_COLUMN_RESIZED,columns:t,column:1===t.length?t[0]:null,flexColumns:f,finished:n,api:this.gridApi,columnApi:this.columnApi,source:c})},r.prototype.autoSizeColumn=function(t,n,c){void 0===c&&(c="api"),t&&this.autoSizeColumns([t],n,c)},r.prototype.autoSizeAllColumns=function(t,n){void 0===n&&(n="api");var c=this.getAllDisplayedColumns();this.autoSizeColumns(c,t,n)},r.prototype.getColumnsFromTree=function(t){var n=[];return function f(y){for(var T=0;T<y.length;T++){var B=y[T];B instanceof it?n.push(B):B instanceof kt&&f(B.getChildren())}}(t),n},r.prototype.getAllDisplayedTrees=function(){return this.displayedTreeLeft&&this.displayedTreeRight&&this.displayedTreeCentre?this.displayedTreeLeft.concat(this.displayedTreeCentre).concat(this.displayedTreeRight):null},r.prototype.getPrimaryColumnTree=function(){return this.primaryColumnTree},r.prototype.getHeaderRowCount=function(){return this.gridHeaderRowCount},r.prototype.getDisplayedTreeLeft=function(){return this.displayedTreeLeft},r.prototype.getDisplayedTreeRight=function(){return this.displayedTreeRight},r.prototype.getDisplayedTreeCentre=function(){return this.displayedTreeCentre},r.prototype.isColumnDisplayed=function(t){return this.getAllDisplayedColumns().indexOf(t)>=0},r.prototype.getAllDisplayedColumns=function(){return this.displayedColumns},r.prototype.getViewportColumns=function(){return this.viewportColumns},r.prototype.getDisplayedLeftColumnsForRow=function(t){return this.colSpanActive?this.getDisplayedColumnsForRow(t,this.displayedColumnsLeft):this.displayedColumnsLeft},r.prototype.getDisplayedRightColumnsForRow=function(t){return this.colSpanActive?this.getDisplayedColumnsForRow(t,this.displayedColumnsRight):this.displayedColumnsRight},r.prototype.getDisplayedColumnsForRow=function(t,n,c,f){for(var q,y=[],T=null,B=function(ke){var Rt,je=n[ke],Qe=n.length-ke,rt=Math.min(je.getColSpan(t),Qe),_t=[je];if(rt>1){for(var Vt=rt-1,Ut=1;Ut<=Vt;Ut++)_t.push(n[ke+Ut]);ke+=Vt}c?(Rt=!1,_t.forEach(function(It){c(It)&&(Rt=!0)})):Rt=!0,Rt&&(0===y.length&&T&&f&&f(je)&&y.push(T),y.push(je)),T=je,q=ke},de=0;de<n.length;de++)B(de),de=q;return y},r.prototype.getViewportCenterColumnsForRow=function(t){var n=this;if(!this.colSpanActive)return this.viewportColumnsCenter;var f=this.suppressColumnVirtualisation?null:this.isColumnInViewport.bind(this);return this.getDisplayedColumnsForRow(t,this.displayedColumnsCenter,f,function(T){var B=T.getLeft();return v(B)&&B>n.viewportLeft})},r.prototype.getAriaColumnIndex=function(t){return this.getAllGridColumns().indexOf(t)+1},r.prototype.isColumnInViewport=function(t){if(t.getColDef().autoHeight)return!0;var n=t.getLeft()||0,c=n+t.getActualWidth(),f=this.viewportLeft-200,y=this.viewportRight+200;return!(n<f&&c<f||n>y&&c>y)},r.prototype.getDisplayedColumnsLeftWidth=function(){return this.getWidthOfColsInList(this.displayedColumnsLeft)},r.prototype.getDisplayedColumnsRightWidth=function(){return this.getWidthOfColsInList(this.displayedColumnsRight)},r.prototype.updatePrimaryColumnList=function(t,n,c,f,y,T){var B=this;if(void 0===T&&(T="api"),t&&!C(t)){var q=!1;t.forEach(function(Se){var ke=B.getPrimaryColumn(Se);if(ke){if(c){if(n.indexOf(ke)>=0)return;n.push(ke)}else{if(n.indexOf(ke)<0)return;k(n,ke)}f(ke),q=!0}}),q&&(this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(T),this.eventService.dispatchEvent({type:y,columns:n,column:1===n.length?n[0]:null,api:this.gridApi,columnApi:this.columnApi,source:T}))}},r.prototype.setRowGroupColumns=function(t,n){void 0===n&&(n="api"),this.autoGroupsNeedBuilding=!0,this.setPrimaryColumnList(t,this.rowGroupColumns,Ge.EVENT_COLUMN_ROW_GROUP_CHANGED,this.setRowGroupActive.bind(this),n)},r.prototype.setRowGroupActive=function(t,n,c){t!==n.isRowGroupActive()&&(n.setRowGroupActive(t,c),!t&&!this.gridOptionsWrapper.isSuppressMakeColumnVisibleAfterUnGroup()&&n.setVisible(!0,c))},r.prototype.addRowGroupColumn=function(t,n){void 0===n&&(n="api"),t&&this.addRowGroupColumns([t],n)},r.prototype.addRowGroupColumns=function(t,n){void 0===n&&(n="api"),this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(t,this.rowGroupColumns,!0,this.setRowGroupActive.bind(this,!0),Ge.EVENT_COLUMN_ROW_GROUP_CHANGED,n)},r.prototype.removeRowGroupColumns=function(t,n){void 0===n&&(n="api"),this.autoGroupsNeedBuilding=!0,this.updatePrimaryColumnList(t,this.rowGroupColumns,!1,this.setRowGroupActive.bind(this,!1),Ge.EVENT_COLUMN_ROW_GROUP_CHANGED,n)},r.prototype.removeRowGroupColumn=function(t,n){void 0===n&&(n="api"),t&&this.removeRowGroupColumns([t],n)},r.prototype.addPivotColumns=function(t,n){void 0===n&&(n="api"),this.updatePrimaryColumnList(t,this.pivotColumns,!0,function(c){return c.setPivotActive(!0,n)},Ge.EVENT_COLUMN_PIVOT_CHANGED,n)},r.prototype.setPivotColumns=function(t,n){void 0===n&&(n="api"),this.setPrimaryColumnList(t,this.pivotColumns,Ge.EVENT_COLUMN_PIVOT_CHANGED,function(c,f){f.setPivotActive(c,n)},n)},r.prototype.addPivotColumn=function(t,n){void 0===n&&(n="api"),this.addPivotColumns([t],n)},r.prototype.removePivotColumns=function(t,n){void 0===n&&(n="api"),this.updatePrimaryColumnList(t,this.pivotColumns,!1,function(c){return c.setPivotActive(!1,n)},Ge.EVENT_COLUMN_PIVOT_CHANGED,n)},r.prototype.removePivotColumn=function(t,n){void 0===n&&(n="api"),this.removePivotColumns([t],n)},r.prototype.setPrimaryColumnList=function(t,n,c,f,y){var T=this;n.length=0,v(t)&&t.forEach(function(B){var q=T.getPrimaryColumn(B);q&&n.push(q)}),(this.primaryColumns||[]).forEach(function(B){var q=n.indexOf(B)>=0;f(q,B)}),this.autoGroupsNeedBuilding&&this.updateGridColumns(),this.updateDisplayedColumns(y),this.fireColumnEvent(c,n,y)},r.prototype.setValueColumns=function(t,n){void 0===n&&(n="api"),this.setPrimaryColumnList(t,this.valueColumns,Ge.EVENT_COLUMN_VALUE_CHANGED,this.setValueActive.bind(this),n)},r.prototype.setValueActive=function(t,n,c){if(t!==n.isValueActive()&&(n.setValueActive(t,c),t&&!n.getAggFunc())){var f=this.aggFuncService.getDefaultAggFunc(n);n.setAggFunc(f)}},r.prototype.addValueColumns=function(t,n){void 0===n&&(n="api"),this.updatePrimaryColumnList(t,this.valueColumns,!0,this.setValueActive.bind(this,!0),Ge.EVENT_COLUMN_VALUE_CHANGED,n)},r.prototype.addValueColumn=function(t,n){void 0===n&&(n="api"),t&&this.addValueColumns([t],n)},r.prototype.removeValueColumn=function(t,n){void 0===n&&(n="api"),this.removeValueColumns([t],n)},r.prototype.removeValueColumns=function(t,n){void 0===n&&(n="api"),this.updatePrimaryColumnList(t,this.valueColumns,!1,this.setValueActive.bind(this,!1),Ge.EVENT_COLUMN_VALUE_CHANGED,n)},r.prototype.normaliseColumnWidth=function(t,n){var c=t.getMinWidth();v(c)&&n<c&&(n=c);var f=t.getMaxWidth();return v(f)&&t.isGreaterThanMax(n)&&(n=f),n},r.prototype.getPrimaryOrGridColumn=function(t){return this.getPrimaryColumn(t)||this.getGridColumn(t)},r.prototype.setColumnWidths=function(t,n,c,f){var y=this;void 0===f&&(f="api");var T=[];t.forEach(function(B){var q=y.getPrimaryOrGridColumn(B.key);if(q&&(T.push({width:B.newWidth,ratios:[1],columns:[q]}),"shift"===y.gridOptionsWrapper.getColResizeDefault()&&(n=!n),n)){var Se=y.getDisplayedColAfter(q);if(!Se)return;var ke=q.getActualWidth()-B.newWidth,je=Se.getActualWidth()+ke;T.push({width:je,ratios:[1],columns:[Se]})}}),0!==T.length&&this.resizeColumnSets(T,c,f)},r.prototype.checkMinAndMaxWidthsForSet=function(t){var c=t.width,f=0,y=0,T=!0;return t.columns.forEach(function(de){var Se=de.getMinWidth();f+=Se||0;var ke=de.getMaxWidth();v(ke)&&ke>0?y+=ke:T=!1}),c>=f&&(!T||c<=y)},r.prototype.resizeColumnSets=function(t,n,c){var f=this;if(!t||t.every(function(je){return f.checkMinAndMaxWidthsForSet(je)})){var B=[],q=[];t.forEach(function(je){var Qe=je.width,rt=je.columns,_t=je.ratios,Vt={},Ut={};rt.forEach(function(Br){return q.push(Br)});for(var Rt=!0,qt=0,It=function(){if(++qt>1e3)return console.error("AG Grid: infinite loop in resizeColumnSets"),"break";Rt=!1;var gn=[],In=0,kn=Qe;rt.forEach(function(ei,yo){Ut[ei.getId()]?kn-=Vt[ei.getId()]:(gn.push(ei),In+=_t[yo])});var Yn=1/In;gn.forEach(function(ei,yo){var Ai;yo===gn.length-1?Ai=kn:(Ai=Math.round(_t[yo]*Qe*Yn),kn-=Ai);var uf=ei.getMinWidth(),T0=ei.getMaxWidth();v(uf)&&Ai<uf?(Ai=uf,Ut[ei.getId()]=!0,Rt=!0):v(T0)&&T0>0&&Ai>T0&&(Ai=T0,Ut[ei.getId()]=!0,Rt=!0),Vt[ei.getId()]=Ai})};Rt&&"break"!==It(););rt.forEach(function(Br){var gn=Vt[Br.getId()];Br.getActualWidth()!==gn&&(Br.setActualWidth(gn,c),B.push(Br))})});var de=B.length>0,Se=this.refreshFlexedColumns({resizingCols:q,skipSetLeft:!0});de&&(this.setLeftValues(c),this.updateBodyWidths(),this.checkViewportColumns());var ke=q.concat(Se);(de||n)&&this.fireColumnResizedEvent(ke,n,c,Se)}else n&&this.fireColumnResizedEvent(t&&t.length>0?t[0].columns:null,n,c)},r.prototype.setColumnAggFunc=function(t,n,c){if(void 0===c&&(c="api"),t){var f=this.getPrimaryColumn(t);!f||(f.setAggFunc(n),this.fireColumnEvent(Ge.EVENT_COLUMN_VALUE_CHANGED,[f],c))}},r.prototype.fireColumnEvent=function(t,n,c){this.eventService.dispatchEvent({type:t,columns:n,column:n&&1==n.length?n[0]:null,api:this.gridApi,columnApi:this.columnApi,source:c})},r.prototype.moveRowGroupColumn=function(t,n,c){void 0===c&&(c="api");var f=this.rowGroupColumns[t];this.rowGroupColumns.splice(t,1),this.rowGroupColumns.splice(n,0,f),this.eventService.dispatchEvent({type:Ge.EVENT_COLUMN_ROW_GROUP_CHANGED,columns:this.rowGroupColumns,column:1===this.rowGroupColumns.length?this.rowGroupColumns[0]:null,api:this.gridApi,columnApi:this.columnApi,source:c})},r.prototype.moveColumns=function(t,n,c){if(void 0===c&&(c="api"),this.columnAnimationService.start(),n>this.gridColumns.length-t.length)return console.warn("AG Grid: tried to insert columns in invalid location, toIndex = "+n),void console.warn("AG Grid: remember that you should not count the moving columns when calculating the new index");var f=this.getGridColumns(t);!this.doesMovePassRules(f,n)||(Q(this.gridColumns,f,n),this.updateDisplayedColumns(c),this.eventService.dispatchEvent({type:Ge.EVENT_COLUMN_MOVED,columns:f,column:1===f.length?f[0]:null,toIndex:n,api:this.gridApi,columnApi:this.columnApi,source:c}),this.columnAnimationService.finish())},r.prototype.doesMovePassRules=function(t,n){var c=this.gridColumns.slice();return Q(c,t,n),!(!this.doesMovePassMarryChildren(c)||!this.doesMovePassLockedPositions(c))},r.prototype.sortColumnsLikeGridColumns=function(t){var n=this;!t||t.length<=1||t.filter(function(f){return n.gridColumns.indexOf(f)<0}).length>0||t.sort(function(f,y){return n.gridColumns.indexOf(f)-n.gridColumns.indexOf(y)})},r.prototype.doesMovePassLockedPositions=function(t){var n=!1,c=!0;return t.forEach(function(f){f.getColDef().lockPosition?n&&(c=!1):n=!0}),c},r.prototype.doesMovePassMarryChildren=function(t){var n=!0;return this.columnUtils.depthFirstOriginalTreeSearch(null,this.gridBalancedTree,function(c){if(c instanceof kt){var f=c,y=f.getColGroupDef();if(y&&y.marryChildren){var B=[];f.getLeafColumns().forEach(function(je){var Qe=t.indexOf(je);B.push(Qe)}),Math.max.apply(Math,B)-Math.min.apply(Math,B)>f.getLeafColumns().length-1&&(n=!1)}}}),n},r.prototype.moveColumn=function(t,n,c){void 0===c&&(c="api"),this.moveColumns([t],n,c)},r.prototype.moveColumnByIndex=function(t,n,c){void 0===c&&(c="api"),this.moveColumn(this.gridColumns[t],n,c)},r.prototype.getColumnDefs=function(){var t=this;if(this.primaryColumns){var n=this.primaryColumns.slice();return this.gridColsArePrimary?n.sort(function(c,f){return t.gridColumns.indexOf(c)-t.gridColumns.indexOf(f)}):this.lastPrimaryOrder&&n.sort(function(c,f){return t.lastPrimaryOrder.indexOf(c)-t.lastPrimaryOrder.indexOf(f)}),this.columnDefFactory.buildColumnDefs(n,this.rowGroupColumns,this.pivotColumns)}},r.prototype.getBodyContainerWidth=function(){return this.bodyWidth},r.prototype.getContainerWidth=function(t){switch(t){case W.PINNED_LEFT:return this.leftWidth;case W.PINNED_RIGHT:return this.rightWidth;default:return this.bodyWidth}},r.prototype.updateBodyWidths=function(){var t=this.getWidthOfColsInList(this.displayedColumnsCenter),n=this.getWidthOfColsInList(this.displayedColumnsLeft),c=this.getWidthOfColsInList(this.displayedColumnsRight);this.bodyWidthDirty=this.bodyWidth!==t,(this.bodyWidth!==t||this.leftWidth!==n||this.rightWidth!==c)&&(this.bodyWidth=t,this.leftWidth=n,this.rightWidth=c,this.eventService.dispatchEvent({type:Ge.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,api:this.gridApi,columnApi:this.columnApi}))},r.prototype.getValueColumns=function(){return this.valueColumns?this.valueColumns:[]},r.prototype.getPivotColumns=function(){return this.pivotColumns?this.pivotColumns:[]},r.prototype.isPivotActive=function(){return this.pivotColumns&&this.pivotColumns.length>0&&this.pivotMode},r.prototype.getRowGroupColumns=function(){return this.rowGroupColumns?this.rowGroupColumns:[]},r.prototype.getDisplayedCenterColumns=function(){return this.displayedColumnsCenter},r.prototype.getDisplayedLeftColumns=function(){return this.displayedColumnsLeft},r.prototype.getDisplayedRightColumns=function(){return this.displayedColumnsRight},r.prototype.getDisplayedColumns=function(t){switch(t){case W.PINNED_LEFT:return this.getDisplayedLeftColumns();case W.PINNED_RIGHT:return this.getDisplayedRightColumns();default:return this.getDisplayedCenterColumns()}},r.prototype.getAllPrimaryColumns=function(){return this.primaryColumns?this.primaryColumns.slice():null},r.prototype.getSecondaryColumns=function(){return this.secondaryColumns?this.secondaryColumns.slice():null},r.prototype.getAllColumnsForQuickFilter=function(){return this.columnsForQuickFilter},r.prototype.getAllGridColumns=function(){return this.gridColumns},r.prototype.isEmpty=function(){return C(this.gridColumns)},r.prototype.isRowGroupEmpty=function(){return C(this.rowGroupColumns)},r.prototype.setColumnVisible=function(t,n,c){void 0===c&&(c="api"),this.setColumnsVisible([t],n,c)},r.prototype.setColumnsVisible=function(t,n,c){var f=this;void 0===n&&(n=!1),void 0===c&&(c="api"),this.columnAnimationService.start(),this.actionOnGridColumns(t,function(y){return y.isVisible()!==n&&(y.setVisible(n,c),!0)},c,function(){return{type:Ge.EVENT_COLUMN_VISIBLE,visible:n,column:null,columns:null,api:f.gridApi,columnApi:f.columnApi,source:c}}),this.columnAnimationService.finish()},r.prototype.setColumnPinned=function(t,n,c){void 0===c&&(c="api"),t&&this.setColumnsPinned([t],n,c)},r.prototype.setColumnsPinned=function(t,n,c){var y,f=this;void 0===c&&(c="api"),"print"!==this.gridOptionsWrapper.getDomLayout()?(this.columnAnimationService.start(),y=!0===n||n===W.PINNED_LEFT?W.PINNED_LEFT:n===W.PINNED_RIGHT?W.PINNED_RIGHT:null,this.actionOnGridColumns(t,function(T){return T.getPinned()!==y&&(T.setPinned(y),!0)},c,function(){return{type:Ge.EVENT_COLUMN_PINNED,pinned:y,column:null,columns:null,api:f.gridApi,columnApi:f.columnApi,source:c}}),this.columnAnimationService.finish()):console.warn("Changing the column pinning status is not allowed with domLayout='print'")},r.prototype.actionOnGridColumns=function(t,n,c,f){var y=this;if(!C(t)){var T=[];if(t.forEach(function(q){var de=y.getGridColumn(q);de&&!1!==n(de)&&T.push(de)}),T.length&&(this.updateDisplayedColumns(c),v(f)&&f)){var B=f();B.columns=T,B.column=1===T.length?T[0]:null,this.eventService.dispatchEvent(B)}}},r.prototype.getDisplayedColBefore=function(t){var n=this.getAllDisplayedColumns(),c=n.indexOf(t);return c>0?n[c-1]:null},r.prototype.getDisplayedColAfter=function(t){var n=this.getAllDisplayedColumns(),c=n.indexOf(t);return c<n.length-1?n[c+1]:null},r.prototype.getDisplayedGroupAfter=function(t){return this.getDisplayedGroupAtDirection(t,"After")},r.prototype.getDisplayedGroupBefore=function(t){return this.getDisplayedGroupAtDirection(t,"Before")},r.prototype.getDisplayedGroupAtDirection=function(t,n){for(var c=t.getOriginalColumnGroup().getLevel()+t.getPaddingLevel(),f=t.getDisplayedLeafColumns(),y="After"===n?H(f):f[0],T="getDisplayedCol"+n;;){var B=this[T](y);if(!B)return null;var q=this.getColumnGroupAtLevel(B,c);if(q!==t)return q}},r.prototype.getColumnGroupAtLevel=function(t,n){for(var c=t.getParent();!(c.getOriginalColumnGroup().getLevel()+c.getPaddingLevel()<=n);)c=c.getParent();return c},r.prototype.isPinningLeft=function(){return this.displayedColumnsLeft.length>0},r.prototype.isPinningRight=function(){return this.displayedColumnsRight.length>0},r.prototype.getPrimaryAndSecondaryAndAutoColumns=function(){var t=this.primaryColumns?this.primaryColumns.slice(0):[];return this.groupAutoColumns&&v(this.groupAutoColumns)&&this.groupAutoColumns.forEach(function(n){return t.push(n)}),this.secondaryColumnsPresent&&this.secondaryColumns&&this.secondaryColumns.forEach(function(n){return t.push(n)}),t},r.prototype.createStateItemFromColumn=function(t){var n=t.isRowGroupActive()?this.rowGroupColumns.indexOf(t):null,c=t.isPivotActive()?this.pivotColumns.indexOf(t):null,f=t.isValueActive()?t.getAggFunc():null,y=null!=t.getSort()?t.getSort():null,T=null!=t.getSortIndex()?t.getSortIndex():null,B=null!=t.getFlex()&&t.getFlex()>0?t.getFlex():null;return{colId:t.getColId(),width:t.getActualWidth(),hide:!t.isVisible(),pinned:t.getPinned(),sort:y,sortIndex:T,aggFunc:f,rowGroup:t.isRowGroupActive(),rowGroupIndex:n,pivot:t.isPivotActive(),pivotIndex:c,flex:B}},r.prototype.getColumnState=function(){if(g(this.primaryColumns)||!this.isAlive())return[];var n=this.getPrimaryAndSecondaryAndAutoColumns().map(this.createStateItemFromColumn.bind(this));return this.pivotMode||this.orderColumnStateList(n),n},r.prototype.getPrimaryAndAutoGroupCols=function(){return this.groupAutoColumns?function(){for(var h=0,r=0,t=arguments.length;r<t;r++)h+=arguments[r].length;var n=Array(h),c=0;for(r=0;r<t;r++)for(var f=arguments[r],y=0,T=f.length;y<T;y++,c++)n[c]=f[y];return n}(this.primaryColumns||[],this.groupAutoColumns):this.primaryColumns},r.prototype.orderColumnStateList=function(t){var n=dt(this.gridColumns.map(function(c,f){return[c.getColId(),f]}));t.sort(function(c,f){return(n.has(c.colId)?n.get(c.colId):-1)-(n.has(f.colId)?n.get(f.colId):-1)})},r.prototype.resetColumnState=function(t){void 0===t&&(t="api");var n=this.getColumnsFromTree(this.primaryColumnTree),c=[],f=1e3,y=1e3,T=[];this.groupAutoColumns&&(T=T.concat(this.groupAutoColumns)),n&&(T=T.concat(n)),T.forEach(function(B){var q=function(gn,In){return null!=gn?gn:null!=In?In:null},de=B.getColDef(),Se=q(de.sort,de.initialSort),ke=q(de.sortIndex,de.initialSortIndex),je=q(de.hide,de.initialHide),Qe=q(de.pinned,de.initialPinned),rt=q(de.width,de.initialWidth),_t=q(de.flex,de.initialFlex),Vt=q(de.rowGroupIndex,de.initialRowGroupIndex),Ut=q(de.rowGroup,de.initialRowGroup);null==Vt&&(null==Ut||0==Ut)&&(Vt=null,Ut=null);var Rt=q(de.pivotIndex,de.initialPivotIndex),qt=q(de.pivot,de.initialPivot);null==Rt&&(null==qt||0==qt)&&(Rt=null,qt=null);var It=q(de.aggFunc,de.initialAggFunc),on={colId:B.getColId(),sort:Se,sortIndex:ke,hide:je,pinned:Qe,width:rt,flex:_t,rowGroup:Ut,rowGroupIndex:Vt,pivot:qt,pivotIndex:Rt,aggFunc:It};g(Vt)&&Ut&&(on.rowGroupIndex=f++),g(Rt)&&qt&&(on.pivotIndex=y++),c.push(on)}),this.applyColumnState({state:c,applyOrder:!0},t)},r.prototype.applyColumnState=function(t,n){var c=this;if(void 0===n&&(n="api"),C(this.primaryColumns))return!1;if(t&&t.state&&!t.state.forEach)return console.warn("AG Grid: applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state."),!1;this.columnAnimationService.start();var f=this.compareColumnStatesAndRaiseEvents(n);this.autoGroupsNeedBuilding=!0;var y=this.primaryColumns.slice(),T=!0,B={},q={},de=[],Se=this.rowGroupColumns.slice(),ke=this.pivotColumns.slice();t.state&&t.state.forEach(function(_t){var Ut=_t.colId||"";if(We(Ut,W.GROUP_AUTO_COLUMN_ID))de.push(_t);else{var qt=c.getPrimaryColumn(Ut);qt?(c.syncColumnWithStateItem(qt,_t,t.defaultState,B,q,!1,n),k(y,qt)):T=!1}});var je=function(Vt){return c.syncColumnWithStateItem(Vt,null,t.defaultState,B,q,!1,n)};y.forEach(je);var Qe=function(Vt,Ut,Rt,qt){var It=Vt[Rt.getId()],on=Vt[qt.getId()],Br=null!=It,gn=null!=on;if(Br&&gn)return It-on;if(Br)return-1;if(gn)return 1;var In=Ut.indexOf(Rt),kn=Ut.indexOf(qt),Yn=In>=0;return Yn&&kn>=0?In-kn:Yn?-1:1};this.rowGroupColumns.sort(Qe.bind(this,B,Se)),this.pivotColumns.sort(Qe.bind(this,q,ke)),this.updateGridColumns();var rt=this.groupAutoColumns?this.groupAutoColumns.slice():[];return de.forEach(function(_t){var Vt=c.getAutoColumn(_t.colId);k(rt,Vt),c.syncColumnWithStateItem(Vt,_t,t.defaultState,null,null,!0,n)}),rt.forEach(je),this.applyOrderAfterApplyState(t),this.updateDisplayedColumns(n),this.dispatchEverythingChanged(n),f(),this.columnAnimationService.finish(),T},r.prototype.applyOrderAfterApplyState=function(t){if(this.gridColsArePrimary&&t.applyOrder&&t.state){var n=[],c={},f={};if(this.gridColumns.forEach(function(y){return f[y.getId()]=y}),t.state.forEach(function(y){if(y.colId&&!c[y.colId]){var T=f[y.colId];T&&(n.push(T),c[y.colId]=!0)}}),this.gridColumns.forEach(function(y){c[y.getColId()]||n.push(y)}),n=this.putFixedColumnsFirst(n),!this.doesMovePassMarryChildren(n))return void console.warn("AG Grid: Applying column order broke a group where columns should be married together. Applying new order has been discarded.");this.gridColumns=n}},r.prototype.compareColumnStatesAndRaiseEvents=function(t){var n=this;if(!this.columnDefs)return function(){};var f={rowGroupColumns:this.rowGroupColumns.slice(),pivotColumns:this.pivotColumns.slice(),valueColumns:this.valueColumns.slice()},y=this.getColumnState(),T={};return y.forEach(function(B){T[B.colId]=B}),function(){if(!n.gridOptionsWrapper.isSuppressColumnStateEvents()){var B=n.getPrimaryAndAutoGroupCols(),q=function(Rt,qt,It,on){X(qt.map(on),It.map(on))||n.eventService.dispatchEvent({type:Rt,columns:It,column:1===It.length?It[0]:null,api:n.gridApi,columnApi:n.columnApi,source:t})},de=function(Rt){var qt=[];return(B||[]).forEach(function(It){var on=T[It.getColId()];on&&Rt(on,It)&&qt.push(It)}),qt},Se=function(Rt){return Rt.getColId()};q(Ge.EVENT_COLUMN_ROW_GROUP_CHANGED,f.rowGroupColumns,n.rowGroupColumns,Se),q(Ge.EVENT_COLUMN_PIVOT_CHANGED,f.pivotColumns,n.pivotColumns,Se),de(function(Rt,qt){var It=null!=Rt.aggFunc,on=It!=qt.isValueActive(),Br=It&&Rt.aggFunc!=qt.getAggFunc();return on||Br}).length>0&&n.fireColumnEvent(Ge.EVENT_COLUMN_VALUE_CHANGED,n.valueColumns,t),n.fireColumnResizedEvent(de(function(Rt,qt){return Rt.width!=qt.getActualWidth()}),!0,t),n.raiseColumnPinnedEvent(de(function(Rt,qt){return Rt.pinned!=qt.getPinned()}),t),n.raiseColumnVisibleEvent(de(function(Rt,qt){return Rt.hide==qt.isVisible()}),t),de(function(Rt,qt){return Rt.sort!=qt.getSort()||Rt.sortIndex!=qt.getSortIndex()}).length>0&&n.sortController.dispatchSortChangedEvents(),n.raiseColumnMovedEvent(y,t)}}},r.prototype.raiseColumnPinnedEvent=function(t,n){if(t.length){var c=1===t.length?t[0]:null,f=this.getCommonValue(t,function(T){return T.getPinned()});this.eventService.dispatchEvent({type:Ge.EVENT_COLUMN_PINNED,pinned:null!=f?f:null,columns:t,column:c,api:this.gridApi,columnApi:this.columnApi,source:n})}},r.prototype.getCommonValue=function(t,n){if(t&&0!=t.length){for(var c=n(t[0]),f=1;f<t.length;f++)if(c!==n(t[f]))return;return c}},r.prototype.raiseColumnVisibleEvent=function(t,n){if(t.length){var c=1===t.length?t[0]:null,f=this.getCommonValue(t,function(T){return T.isVisible()});this.eventService.dispatchEvent({type:Ge.EVENT_COLUMN_VISIBLE,visible:f,columns:t,column:c,api:this.gridApi,columnApi:this.columnApi,source:n})}},r.prototype.raiseColumnMovedEvent=function(t,n){var c=this,f=this.getColumnState(),y={};f.forEach(function(ke){return y[ke.colId]=ke});var T={};t.forEach(function(ke){y[ke.colId]&&(T[ke.colId]=!0)});var B=_e(t,function(ke){return T[ke.colId]}),q=_e(f,function(ke){return T[ke.colId]}),de=[];q.forEach(function(ke,je){var Qe=B&&B[je];if(Qe&&Qe.colId!==ke.colId){var rt=c.getGridColumn(Qe.colId);rt&&de.push(rt)}}),de.length&&this.eventService.dispatchEvent({type:Ge.EVENT_COLUMN_MOVED,columns:de,column:null,api:this.gridApi,columnApi:this.columnApi,source:n})},r.prototype.syncColumnWithStateItem=function(t,n,c,f,y,T,B){if(t){var q=function(kn,Yn){var ei=n,yo=c,aa={value1:void 0,value2:void 0},Ai=!1;return ei&&(void 0!==ei[kn]&&(aa.value1=ei[kn],Ai=!0),v(Yn)&&void 0!==ei[Yn]&&(aa.value2=ei[Yn],Ai=!0)),!Ai&&yo&&(void 0!==yo[kn]&&(aa.value1=yo[kn]),v(Yn)&&void 0!==yo[Yn]&&(aa.value2=yo[Yn])),aa},de=q("hide").value1;void 0!==de&&t.setVisible(!de,B);var Se=q("pinned").value1;void 0!==Se&&t.setPinned(Se);var ke=this.columnUtils.calculateColMinWidth(t.getColDef()),je=q("flex").value1;if(void 0!==je&&t.setFlex(je),t.getFlex()<=0){var rt=q("width").value1;null!=rt&&null!=ke&&rt>=ke&&t.setActualWidth(rt,B)}var _t=q("sort").value1;void 0!==_t&&t.setSort(_t===W.SORT_DESC||_t===W.SORT_ASC?_t:void 0);var Vt=q("sortIndex").value1;if(void 0!==Vt&&t.setSortIndex(Vt),!T){var Ut=q("aggFunc").value1;void 0!==Ut&&("string"==typeof Ut?(t.setAggFunc(Ut),t.isValueActive()||(t.setValueActive(!0,B),this.valueColumns.push(t))):(v(Ut)&&console.warn("AG Grid: stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON."),t.isValueActive()&&(t.setValueActive(!1,B),k(this.valueColumns,t))));var Rt=q("rowGroup","rowGroupIndex"),qt=Rt.value1,It=Rt.value2;(void 0!==qt||void 0!==It)&&("number"==typeof It||qt?(t.isRowGroupActive()||(t.setRowGroupActive(!0,B),this.rowGroupColumns.push(t)),f&&"number"==typeof It&&(f[t.getId()]=It)):t.isRowGroupActive()&&(t.setRowGroupActive(!1,B),k(this.rowGroupColumns,t)));var on=q("pivot","pivotIndex"),Br=on.value1,gn=on.value2;(void 0!==Br||void 0!==gn)&&("number"==typeof gn||Br?(t.isPivotActive()||(t.setPivotActive(!0,B),this.pivotColumns.push(t)),y&&"number"==typeof gn&&(y[t.getId()]=gn)):t.isPivotActive()&&(t.setPivotActive(!1,B),k(this.pivotColumns,t)))}}},r.prototype.getGridColumns=function(t){return this.getColumns(t,this.getGridColumn.bind(this))},r.prototype.getColumns=function(t,n){var c=[];return t&&t.forEach(function(f){var y=n(f);y&&c.push(y)}),c},r.prototype.getColumnWithValidation=function(t){if(null==t)return null;var n=this.getGridColumn(t);return n||console.warn("AG Grid: could not find column "+t),n},r.prototype.getPrimaryColumn=function(t){return this.primaryColumns?this.getColumn(t,this.primaryColumns,this.primaryColumnsMap):null},r.prototype.getGridColumn=function(t){return this.getColumn(t,this.gridColumns,this.gridColumnsMap)},r.prototype.getColumn=function(t,n,c){if(!t)return null;if("string"==typeof t&&c[t])return c[t];for(var f=0;f<n.length;f++)if(this.columnsMatch(n[f],t))return n[f];return this.getAutoColumn(t)},r.prototype.getAutoColumn=function(t){var n=this;return this.groupAutoColumns&&v(this.groupAutoColumns)&&!g(this.groupAutoColumns)?O(this.groupAutoColumns,function(c){return n.columnsMatch(c,t)}):null},r.prototype.columnsMatch=function(t,n){var c=t===n,f=t.getColDef()===n,y=t.getColId()==n;return c||f||y},r.prototype.getDisplayNameForColumn=function(t,n,c){if(void 0===c&&(c=!1),!t)return null;var f=this.getHeaderName(t.getColDef(),t,null,null,n);return c?this.wrapHeaderNameWithAggFunc(t,f):f},r.prototype.getDisplayNameForOriginalColumnGroup=function(t,n,c){var f=n?n.getColGroupDef():null;return f?this.getHeaderName(f,null,t,n,c):null},r.prototype.getDisplayNameForColumnGroup=function(t,n){return this.getDisplayNameForOriginalColumnGroup(t,t.getOriginalColumnGroup(),n)},r.prototype.getHeaderName=function(t,n,c,f,y){var T=t.headerValueGetter;if(T){var B={colDef:t,column:n,columnGroup:c,originalColumnGroup:f,location:y,api:this.gridOptionsWrapper.getApi(),context:this.gridOptionsWrapper.getContext()};return"function"==typeof T?T(B):"string"==typeof T?this.expressionService.evaluate(T,B):(console.warn("ag-grid: headerValueGetter must be a function or a string"),"")}return null!=t.headerName?t.headerName:t.field?Ve(t.field):""},r.prototype.wrapHeaderNameWithAggFunc=function(t,n){if(this.gridOptionsWrapper.isSuppressAggFuncInHeader())return n;var T,c=t.getColDef().pivotValueColumn,y=null;if(v(c))y=c?c.getAggFunc():null,T=!0;else{var B=t.isValueActive(),q=this.pivotMode||!this.isRowGroupEmpty();B&&q?(y=t.getAggFunc(),T=!0):T=!1}if(T){var de="string"==typeof y?y:"func";return this.gridOptionsWrapper.getLocaleTextFunc()(de,de)+"("+n+")"}return n},r.prototype.getColumnGroup=function(t,n){if(!t)return null;if(t instanceof xt)return t;var c=this.getAllDisplayedTrees(),f="number"==typeof n,y=null;return this.columnUtils.depthFirstAllColumnTreeSearch(c,function(T){if(T instanceof xt){var B=T;(f?t===B.getGroupId()&&n===B.getInstanceId():t===B.getGroupId())&&(y=B)}}),y},r.prototype.isReady=function(){return this.ready},r.prototype.extractValueColumns=function(t,n){this.valueColumns=this.extractColumns(n,this.valueColumns,function(c,f){return c.setValueActive(f,t)},function(){},function(){},function(c){var f=c.aggFunc;return null===f||""===f?null:void 0!==f?!!f:void 0},function(c){return null!=c.initialAggFunc&&""!=c.initialAggFunc}),this.valueColumns.forEach(function(c){var f=c.getColDef();null!=f.aggFunc&&""!=f.aggFunc?c.setAggFunc(f.aggFunc):c.getAggFunc()||c.setAggFunc(f.initialAggFunc)})},r.prototype.extractRowGroupColumns=function(t,n){this.rowGroupColumns=this.extractColumns(n,this.rowGroupColumns,function(c,f){return c.setRowGroupActive(f,t)},function(c){return c.rowGroupIndex},function(c){return c.initialRowGroupIndex},function(c){return c.rowGroup},function(c){return c.initialRowGroup})},r.prototype.extractColumns=function(t,n,c,f,y,T,B){void 0===t&&(t=[]),void 0===n&&(n=[]);var q=[],de=[];(this.primaryColumns||[]).forEach(function(je){var Qe=t.indexOf(je)<0,rt=je.getColDef(),_t=x(T(rt)),Vt=x(B(rt)),Ut=_(f(rt)),Rt=_(y(rt));(void 0!==_t?_t:void 0!==Ut?null!==Ut&&Ut>=0:Qe?void 0!==Vt?Vt:void 0!==Rt&&null!=Rt&&Rt>=0:n.indexOf(je)>=0)&&((Qe?null!=Ut||null!=Rt:null!=Ut)?q.push(je):de.push(je))});var Se=function(Qe){var rt=f(Qe.getColDef()),_t=y(Qe.getColDef());return null!=rt?rt:_t};q.sort(function(je,Qe){var rt=Se(je),_t=Se(Qe);return rt===_t?0:rt<_t?-1:1});var ke=[].concat(q);return n.forEach(function(je){de.indexOf(je)>=0&&ke.push(je)}),de.forEach(function(je){ke.indexOf(je)<0&&ke.push(je)}),n.forEach(function(je){ke.indexOf(je)<0&&c(je,!1)}),ke.forEach(function(je){n.indexOf(je)<0&&c(je,!0)}),ke},r.prototype.extractPivotColumns=function(t,n){this.pivotColumns=this.extractColumns(n,this.pivotColumns,function(c,f){return c.setPivotActive(f,t)},function(c){return c.pivotIndex},function(c){return c.initialPivotIndex},function(c){return c.pivot},function(c){return c.initialPivot})},r.prototype.resetColumnGroupState=function(t){void 0===t&&(t="api");var n=[];this.columnUtils.depthFirstOriginalTreeSearch(null,this.primaryColumnTree,function(c){if(c instanceof kt){var f=c.getColGroupDef(),y={groupId:c.getGroupId(),open:f?f.openByDefault:void 0};n.push(y)}}),this.setColumnGroupState(n,t)},r.prototype.getColumnGroupState=function(){var t=[];return this.columnUtils.depthFirstOriginalTreeSearch(null,this.gridBalancedTree,function(n){if(n instanceof kt){var c=n;t.push({groupId:c.getGroupId(),open:c.isExpanded()})}}),t},r.prototype.setColumnGroupState=function(t,n){var c=this;void 0===n&&(n="api"),this.columnAnimationService.start();var f=[];t.forEach(function(y){var B=y.open,q=c.getOriginalColumnGroup(y.groupId);!q||q.isExpanded()!==B&&(c.logger.log("columnGroupOpened("+q.getGroupId()+","+B+")"),q.setExpanded(B),f.push(q))}),this.updateGroupsAndDisplayedColumns(n),this.setFirstRightAndLastLeftPinned(n),f.forEach(function(y){c.eventService.dispatchEvent({type:Ge.EVENT_COLUMN_GROUP_OPENED,columnGroup:y,api:c.gridApi,columnApi:c.columnApi})}),this.columnAnimationService.finish()},r.prototype.setColumnGroupOpened=function(t,n,c){var f;void 0===c&&(c="api"),f=t instanceof kt?t.getId():t||"",this.setColumnGroupState([{groupId:f,open:n}],c)},r.prototype.getOriginalColumnGroup=function(t){if(t instanceof kt)return t;"string"!=typeof t&&console.error("AG Grid: group key must be a string");var n=null;return this.columnUtils.depthFirstOriginalTreeSearch(null,this.gridBalancedTree,function(c){if(c instanceof kt){var f=c;f.getId()===t&&(n=f)}}),n},r.prototype.calculateColumnsForDisplay=function(){var t=this;return this.gridColumns.filter(this.pivotMode&&!this.secondaryColumnsPresent?function(c){var f=t.groupAutoColumns&&oe(t.groupAutoColumns,c),y=t.valueColumns&&oe(t.valueColumns,c);return f||y}:function(c){return t.groupAutoColumns&&oe(t.groupAutoColumns,c)||c.isVisible()})},r.prototype.checkColSpanActiveInCols=function(t){var n=!1;return t.forEach(function(c){v(c.getColDef().colSpan)&&(n=!0)}),n},r.prototype.calculateColumnsForGroupDisplay=function(){var t=this;this.groupDisplayColumns=[];var n=function(f){var y=f.getColDef();y&&v(y.showRowGroup)&&t.groupDisplayColumns.push(f)};this.gridColumns.forEach(n),this.groupAutoColumns&&this.groupAutoColumns.forEach(n)},r.prototype.getGroupDisplayColumns=function(){return this.groupDisplayColumns},r.prototype.updateDisplayedColumns=function(t){var n=this.calculateColumnsForDisplay();this.buildDisplayedTrees(n),this.calculateColumnsForGroupDisplay(),this.updateGroupsAndDisplayedColumns(t),this.setFirstRightAndLastLeftPinned(t)},r.prototype.isSecondaryColumnsPresent=function(){return this.secondaryColumnsPresent},r.prototype.setSecondaryColumns=function(t,n){void 0===n&&(n="api");var c=t&&t.length>0;if(c||this.secondaryColumnsPresent){if(c){this.processSecondaryColumnDefinitions(t);var f=this.columnFactory.createColumnTree(t,!1);this.secondaryBalancedTree=f.columnTree,this.secondaryHeaderRowCount=f.treeDept+1,this.secondaryColumns=this.getColumnsFromTree(this.secondaryBalancedTree),this.secondaryColumnsPresent=!0}else this.secondaryBalancedTree=null,this.secondaryHeaderRowCount=-1,this.secondaryColumns=null,this.secondaryColumnsPresent=!1;this.updateGridColumns(),this.updateDisplayedColumns(n)}},r.prototype.processSecondaryColumnDefinitions=function(t){var n=this.gridOptionsWrapper.getProcessSecondaryColDefFunc(),c=this.gridOptionsWrapper.getProcessSecondaryColGroupDefFunc();(n||c)&&t&&function y(T){T.forEach(function(B){if(v(B.children)){var de=B;c&&c(de),y(de.children)}else n&&n(B)})}(t)},r.prototype.updateGridColumns=function(){var t=this;this.gridColsArePrimary&&(this.lastPrimaryOrder=this.gridColumns),this.secondaryColumns&&this.secondaryBalancedTree?(this.gridBalancedTree=this.secondaryBalancedTree.slice(),this.gridHeaderRowCount=this.secondaryHeaderRowCount,this.gridColumns=this.secondaryColumns.slice(),this.gridColsArePrimary=!1):this.primaryColumns&&(this.gridBalancedTree=this.primaryColumnTree.slice(),this.gridHeaderRowCount=this.primaryHeaderRowCount,this.gridColumns=this.primaryColumns.slice(),this.gridColsArePrimary=!0,this.orderGridColsLikeLastPrimary()),this.addAutoGroupToGridColumns(),this.gridColumns=this.putFixedColumnsFirst(this.gridColumns),this.setupQuickFilterColumns(),this.clearDisplayedAndViewportColumns(),this.colSpanActive=this.checkColSpanActiveInCols(this.gridColumns),this.gridColumnsMap={},this.gridColumns.forEach(function(c){return t.gridColumnsMap[c.getId()]=c}),this.setAutoHeightActive(),this.eventService.dispatchEvent({type:Ge.EVENT_GRID_COLUMNS_CHANGED,api:this.gridApi,columnApi:this.columnApi})},r.prototype.setAutoHeightActive=function(){if(this.autoHeightActive=this.gridColumns.filter(function(f){return f.getColDef().autoHeight}).length>0,this.autoHeightActive){this.autoHeightActiveAtLeastOnce=!0;var t=this.rowModel.getType();t!==W.ROW_MODEL_TYPE_CLIENT_SIDE&&t!==W.ROW_MODEL_TYPE_SERVER_SIDE&&Lt(function(){return console.warn("AG Grid - autoHeight columns only work with Client Side Row Model and Server Side Row Model.")},"autoHeightActive.wrongRowModel")}},r.prototype.orderGridColsLikeLastPrimary=function(){if(!g(this.lastPrimaryOrder)){var t=dt(this.lastPrimaryOrder.map(function(q,de){return[q,de]})),n=!0;if(this.gridColumns.forEach(function(q){t.has(q)&&(n=!1)}),!n){var c=dt(this.gridColumns.map(function(q){return[q,!0]})),f=this.lastPrimaryOrder.filter(function(q){return c.has(q)}),y=dt(f.map(function(q){return[q,!0]})),T=this.gridColumns.filter(function(q){return!y.has(q)}),B=f.slice();T.forEach(function(q){var de=q.getOriginalParent();if(de){for(var Se=[];!Se.length&&de;)de.getLeafColumns().forEach(function(rt){var _t=B.indexOf(rt)>=0,Vt=Se.indexOf(rt)<0;_t&&Vt&&Se.push(rt)}),de=de.getOriginalParent();if(Se.length){var je=Se.map(function(rt){return B.indexOf(rt)}),Qe=Math.max.apply(Math,je);K(B,q,Qe+1)}else B.push(q)}else B.push(q)}),this.gridColumns=B}}},r.prototype.isPrimaryColumnGroupsPresent=function(){return this.primaryHeaderRowCount>1},r.prototype.setupQuickFilterColumns=function(){this.groupAutoColumns?this.columnsForQuickFilter=(this.primaryColumns||[]).concat(this.groupAutoColumns):this.primaryColumns&&(this.columnsForQuickFilter=this.primaryColumns)},r.prototype.putFixedColumnsFirst=function(t){var n=t.filter(function(f){return f.getColDef().lockPosition}),c=t.filter(function(f){return!f.getColDef().lockPosition});return n.concat(c)},r.prototype.addAutoGroupToGridColumns=function(){if(this.createGroupAutoColumnsIfNeeded(),!g(this.groupAutoColumns)){this.gridColumns=this.groupAutoColumns?this.groupAutoColumns.concat(this.gridColumns):this.gridColumns;var t=this.columnFactory.createForAutoGroups(this.groupAutoColumns,this.gridBalancedTree);this.gridBalancedTree=t.concat(this.gridBalancedTree)}},r.prototype.clearDisplayedAndViewportColumns=function(){this.displayedTreeLeft=[],this.displayedTreeRight=[],this.displayedTreeCentre=[],this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={},this.displayedColumnsLeft=[],this.displayedColumnsRight=[],this.displayedColumnsCenter=[],this.displayedColumns=[],this.viewportColumns=[]},r.prototype.updateGroupsAndDisplayedColumns=function(t){this.updateOpenClosedVisibilityInColumnGroups(),this.deriveDisplayedColumns(t),this.refreshFlexedColumns(),this.extractViewport(),this.updateBodyWidths(),this.eventService.dispatchEvent({type:Ge.EVENT_DISPLAYED_COLUMNS_CHANGED,api:this.gridApi,columnApi:this.columnApi})},r.prototype.deriveDisplayedColumns=function(t){this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeLeft,this.displayedColumnsLeft),this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeCentre,this.displayedColumnsCenter),this.derivedDisplayedColumnsFromDisplayedTree(this.displayedTreeRight,this.displayedColumnsRight),this.joinDisplayedColumns(),this.setLeftValues(t),this.displayedAutoHeightCols=this.displayedColumns.filter(function(n){return n.getColDef().autoHeight})},r.prototype.isAutoRowHeightActive=function(){return this.autoHeightActive},r.prototype.wasAutoRowHeightEverActive=function(){return this.autoHeightActiveAtLeastOnce},r.prototype.joinDisplayedColumns=function(){this.displayedColumns=this.gridOptionsWrapper.isEnableRtl()?this.displayedColumnsRight.concat(this.displayedColumnsCenter).concat(this.displayedColumnsLeft):this.displayedColumnsLeft.concat(this.displayedColumnsCenter).concat(this.displayedColumnsRight)},r.prototype.setLeftValues=function(t){this.setLeftValuesOfColumns(t),this.setLeftValuesOfGroups()},r.prototype.setLeftValuesOfColumns=function(t){var n=this;if(this.primaryColumns){var c=this.primaryColumns.slice(0),f=this.gridOptionsWrapper.isEnableRtl();[this.displayedColumnsLeft,this.displayedColumnsRight,this.displayedColumnsCenter].forEach(function(y){if(f){var T=n.getWidthOfColsInList(y);y.forEach(function(q){T-=q.getActualWidth(),q.setLeft(T,t)})}else{var B=0;y.forEach(function(q){q.setLeft(B,t),B+=q.getActualWidth()})}U(c,y)}),c.forEach(function(y){y.setLeft(null,t)})}},r.prototype.setLeftValuesOfGroups=function(){[this.displayedTreeLeft,this.displayedTreeRight,this.displayedTreeCentre].forEach(function(t){t.forEach(function(n){n instanceof xt&&n.checkLeft()})})},r.prototype.derivedDisplayedColumnsFromDisplayedTree=function(t,n){n.length=0,this.columnUtils.depthFirstDisplayedColumnTreeSearch(t,function(c){c instanceof it&&n.push(c)})},r.prototype.extractViewportColumns=function(){this.viewportColumnsCenter=this.suppressColumnVirtualisation?this.displayedColumnsCenter:this.filterOutColumnsWithinViewport(),this.viewportColumns=this.viewportColumnsCenter.concat(this.displayedColumnsLeft).concat(this.displayedColumnsRight)},r.prototype.getVirtualHeaderGroupRow=function(t,n){var c;switch(t){case W.PINNED_LEFT:c=this.viewportRowLeft[n];break;case W.PINNED_RIGHT:c=this.viewportRowRight[n];break;default:c=this.viewportRowCenter[n]}return g(c)&&(c=[]),c},r.prototype.extractViewportRows=function(){this.viewportRowLeft={},this.viewportRowRight={},this.viewportRowCenter={};var t={};this.viewportColumns.forEach(function(c){return t[c.getId()]=!0});var n=function c(f,y,T){for(var B=!1,q=0;q<f.length;q++){var de=f[q],Se=!1;if(de instanceof it)Se=!0===t[de.getId()];else{var je=de.getDisplayedChildren();je&&(Se=c(je,y,T+1))}Se&&(B=!0,y[T]||(y[T]=[]),y[T].push(de))}return B};n(this.displayedTreeLeft,this.viewportRowLeft,0),n(this.displayedTreeRight,this.viewportRowRight,0),n(this.displayedTreeCentre,this.viewportRowCenter,0)},r.prototype.extractViewport=function(){this.extractViewportColumns(),this.extractViewportRows()},r.prototype.filterOutColumnsWithinViewport=function(){return this.displayedColumnsCenter.filter(this.isColumnInViewport.bind(this))},r.prototype.refreshFlexedColumns=function(t){var n=this;void 0===t&&(t={});var c=t.source?t.source:"flex";if(null!=t.viewportWidth&&(this.flexViewportWidth=t.viewportWidth),!this.flexViewportWidth)return[];var f=-1;t.resizingCols&&t.resizingCols.forEach(function(qt){var It=n.displayedColumnsCenter.indexOf(qt);f<It&&(f=It)});var y=function(It){var on=n.displayedColumnsCenter.indexOf(It)>f;return It.getFlex()&&on},T=this.displayedColumnsCenter.filter(function(qt){return!y(qt)}),B=this.displayedColumnsCenter.filter(function(qt){return y(qt)}),q=[];if(!B.length)return[];var Se,de=[];e:for(;;){var ke=B.reduce(function(qt,It){return qt+It.getFlex()},0);Se=this.flexViewportWidth-this.getWidthOfColsInList(T);for(var je=0;je<B.length;je++){var Qe=B[je],rt=Se*Qe.getFlex()/ke,_t=0,Vt=Qe.getMinWidth(),Ut=Qe.getMaxWidth();if(v(Vt)&&rt<Vt?_t=Vt:v(Ut)&&rt>Ut&&(_t=Ut),_t){Qe.setActualWidth(_t,c),k(B,Qe),q.push(Qe),T.push(Qe);continue e}de[je]=Math.round(rt)}break}var Rt=Se;return B.forEach(function(qt,It){qt.setActualWidth(Math.min(de[It],Rt),c),q.push(qt),Rt-=de[It]}),t.skipSetLeft||this.setLeftValues(c),t.updateBodyWidths&&this.updateBodyWidths(),t.fireResizedEvent&&this.fireColumnResizedEvent(q,!0,c,B),this.flexColsCalculatedAtLestOnce||(this.gridOptionsWrapper.isRowModelDefault()&&this.rowModel.resetRowHeights(),this.flexColsCalculatedAtLestOnce=!0),B},r.prototype.sizeColumnsToFit=function(t,n,c){void 0===n&&(n="sizeColumnsToFit");var f=this.getAllDisplayedColumns();if(!(t<=0)&&f.length){var y=[],T=[];f.forEach(function(Rt){!0===Rt.getColDef().suppressSizeToFit?T.push(Rt):y.push(Rt)});var B=y.slice(0),q=!1,de=function(qt){k(y,qt),T.push(qt)};for(y.forEach(function(Rt){return Rt.resetActualWidth(n)});!q;){q=!0;var Se=t-this.getWidthOfColsInList(T);if(Se<=0)y.forEach(function(Rt){Rt.setMinimum(n)});else for(var ke=Se/this.getWidthOfColsInList(y),je=Se,Qe=y.length-1;Qe>=0;Qe--){var rt=y[Qe],_t=rt.getMinWidth(),Vt=rt.getMaxWidth(),Ut=Math.round(rt.getActualWidth()*ke);v(_t)&&Ut<_t?(Ut=_t,de(rt),q=!1):v(Vt)&&rt.isGreaterThanMax(Ut)?(Ut=Vt,de(rt),q=!1):0===Qe&&(Ut=je),rt.setActualWidth(Ut,n,!0),je-=Ut}}B.forEach(function(Rt){Rt.fireColumnWidthChangedEvent(n)}),this.setLeftValues(n),this.updateBodyWidths(),!c&&this.fireColumnResizedEvent(B,!0,n)}},r.prototype.buildDisplayedTrees=function(t){var n=[],c=[],f=[];t.forEach(function(T){switch(T.getPinned()){case"left":n.push(T);break;case"right":c.push(T);break;default:f.push(T)}});var y=new Wr;this.displayedTreeLeft=this.displayedGroupCreator.createDisplayedGroups(n,this.gridBalancedTree,y,W.PINNED_LEFT,this.displayedTreeLeft),this.displayedTreeRight=this.displayedGroupCreator.createDisplayedGroups(c,this.gridBalancedTree,y,W.PINNED_RIGHT,this.displayedTreeRight),this.displayedTreeCentre=this.displayedGroupCreator.createDisplayedGroups(f,this.gridBalancedTree,y,null,this.displayedTreeCentre),this.updateDisplayedMap()},r.prototype.updateDisplayedMap=function(){var t=this;this.displayedColumnsAndGroupsMap={};var n=function(f){t.displayedColumnsAndGroupsMap[f.getUniqueId()]=f};this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeCentre,n),this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeLeft,n),this.columnUtils.depthFirstAllColumnTreeSearch(this.displayedTreeRight,n)},r.prototype.isDisplayed=function(t){return this.displayedColumnsAndGroupsMap[t.getUniqueId()]===t},r.prototype.updateOpenClosedVisibilityInColumnGroups=function(){var t=this.getAllDisplayedTrees();this.columnUtils.depthFirstAllColumnTreeSearch(t,function(n){n instanceof xt&&n.calculateDisplayedColumns()})},r.prototype.getGroupAutoColumns=function(){return this.groupAutoColumns},r.prototype.createGroupAutoColumnsIfNeeded=function(){if(this.autoGroupsNeedBuilding){this.autoGroupsNeedBuilding=!1;var t=this.gridOptionsWrapper.isGroupUseEntireRow(this.pivotMode),n=this.pivotMode?this.gridOptionsWrapper.isPivotSuppressAutoColumn():this.gridOptionsWrapper.isGroupSuppressAutoColumn();if(!(this.rowGroupColumns.length>0||this.usingTreeData)||n||t)this.groupAutoColumns=null;else{var y=this.autoGroupColService.createAutoGroupColumns(this.rowGroupColumns);(!this.autoColsEqual(y,this.groupAutoColumns)||this.forceRecreateAutoGroups)&&(this.groupAutoColumns=y)}}},r.prototype.autoColsEqual=function(t,n){return X(t,n,function(c,f){return c.getColId()===f.getColId()})},r.prototype.getWidthOfColsInList=function(t){return t.reduce(function(n,c){return n+c.getActualWidth()},0)},r.prototype.getGridBalancedTree=function(){return this.gridBalancedTree},r.prototype.hasFloatingFilters=function(){return!!this.gridColumns&&this.gridColumns.some(function(n){return n.getColDef().floatingFilter})},r.prototype.getFirstDisplayedColumn=function(){var t=this.gridOptionsWrapper.isEnableRtl(),n=["getDisplayedLeftColumns","getDisplayedCenterColumns","getDisplayedRightColumns"];t&&n.reverse();for(var c=0;c<n.length;c++){var f=this[n[c]]();if(f.length)return t?H(f):f[0]}return null},Ht([Ee("expressionService")],r.prototype,"expressionService",void 0),Ht([Ee("columnFactory")],r.prototype,"columnFactory",void 0),Ht([Ee("displayedGroupCreator")],r.prototype,"displayedGroupCreator",void 0),Ht([Ee("autoWidthCalculator")],r.prototype,"autoWidthCalculator",void 0),Ht([Ee("columnUtils")],r.prototype,"columnUtils",void 0),Ht([Ee("columnAnimationService")],r.prototype,"columnAnimationService",void 0),Ht([Ee("autoGroupColService")],r.prototype,"autoGroupColService",void 0),Ht([Nr("aggFuncService")],r.prototype,"aggFuncService",void 0),Ht([Nr("valueCache")],r.prototype,"valueCache",void 0),Ht([Nr("animationFrameService")],r.prototype,"animationFrameService",void 0),Ht([Ee("rowModel")],r.prototype,"rowModel",void 0),Ht([Ee("columnApi")],r.prototype,"columnApi",void 0),Ht([Ee("gridApi")],r.prototype,"gridApi",void 0),Ht([Ee("sortController")],r.prototype,"sortController",void 0),Ht([Ee("columnDefFactory")],r.prototype,"columnDefFactory",void 0),Ht([zt],r.prototype,"init",null),Ht([Tr(0,Dn("loggerFactory"))],r.prototype,"setBeans",null),Ht([Kt("columnModel")],r)}(ct);function Zr(h,r){return hi(h.toString(),r,"0")}function Vr(h,r){for(var t=[],n=h;n<=r;n++)t.push(n);return t}function Or(h){return""!==h&&!isNaN(parseFloat(h))&&isFinite(h)}function Kr(){return Number.MAX_SAFE_INTEGER||9007199254740991}function pn(h){return"number"!=typeof h?"":h.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}var En=Object.freeze({__proto__:null,padStartWidthZeros:Zr,createArrayOfNumbers:Vr,isNumeric:Or,getMaxSafeInteger:Kr,cleanNumber:function(h){return"string"==typeof h&&(h=parseInt(h,10)),"number"==typeof h?Math.floor(h):null},decToHex:function(h,r){for(var t="",n=0;n<r;n++)t+=String.fromCharCode(255&h),h>>>=8;return t},formatNumberTwoDecimalPlacesAndCommas:function(h){return"number"!=typeof h?"":pn(Math.round(100*h)/100)},formatNumberCommas:pn,sum:function(h){return null==h?null:h.reduce(function(r,t){return r+t},0)}}),Ti=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ff=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return Ti(r,h),r.prototype.calculateColMinWidth=function(t){return null!=t.minWidth?t.minWidth:this.gridOptionsWrapper.getMinColWidth()},r.prototype.calculateColMaxWidth=function(t){return null!=t.maxWidth?t.maxWidth:this.gridOptionsWrapper.getMaxColWidth()||Kr()},r.prototype.calculateColInitialWidth=function(t){var f,n=this.calculateColMinWidth(t),c=this.calculateColMaxWidth(t),y=_(t.width),T=_(t.initialWidth);return f=null!=y?y:null!=T?T:this.gridOptionsWrapper.getColWidth(),Math.max(Math.min(f,c),n)},r.prototype.getOriginalPathForColumn=function(t,n){var c=[],f=!1;return function T(B,q){for(var de=0;de<B.length;de++){if(f)return;var Se=B[de];Se instanceof kt?(T(Se.getChildren(),q+1),c[q]=Se):Se===t&&(f=!0)}}(n,0),f?c:null},r.prototype.depthFirstOriginalTreeSearch=function(t,n,c){var f=this;!n||n.forEach(function(y){y instanceof kt&&f.depthFirstOriginalTreeSearch(y,y.getChildren(),c),c(y,t)})},r.prototype.depthFirstAllColumnTreeSearch=function(t,n){var c=this;!t||t.forEach(function(f){f instanceof xt&&c.depthFirstAllColumnTreeSearch(f.getChildren(),n),n(f)})},r.prototype.depthFirstDisplayedColumnTreeSearch=function(t,n){var c=this;!t||t.forEach(function(f){f instanceof xt&&c.depthFirstDisplayedColumnTreeSearch(f.getDisplayedChildren(),n),n(f)})},r=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f}([Kt("columnUtils")],r),r}(ct),L1=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),ba=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return L1(r,h),r.prototype.createDisplayedGroups=function(t,n,c,f,y){var q,de,T=this,B=[],Se=this.mapOldGroupsById(y);return t.forEach(function(ke){for(var je=T.getOriginalPathForColumn(n,ke),Qe=[],rt=!de,_t=0;_t<je.length;_t++)if(rt||je[_t]!==de[_t]){var Vt=T.createColumnGroup(je[_t],c,Se,f);Qe[_t]=Vt,0==_t?B.push(Vt):Qe[_t-1].addChild(Vt)}else Qe[_t]=q[_t];0===Qe.length?B.push(ke):H(Qe).addChild(ke),q=Qe,de=je}),this.setupParentsIntoColumns(B,null),B},r.prototype.createColumnGroup=function(t,n,c,f){var y=t.getGroupId(),T=n.getInstanceIdForKey(y),q=c[xt.createUniqueId(y,T)];return q&&q.getOriginalColumnGroup()!==t&&(q=null),v(q)?q.reset():(q=new xt(t,y,T,f),this.context.createBean(q)),q},r.prototype.mapOldGroupsById=function(t){var n={};return t&&function f(y){y.forEach(function(T){if(T instanceof xt){var B=T;n[T.getUniqueId()]=B,f(B.getChildren())}})}(t),n},r.prototype.setupParentsIntoColumns=function(t,n){var c=this;t.forEach(function(f){if(f.setParent(n),f instanceof xt){var y=f;c.setupParentsIntoColumns(y.getChildren(),y)}})},r.prototype.getOriginalPathForColumn=function(t,n){var c=[],f=!1;return function T(B,q){for(var de=0;de<B.length;de++){if(f)return;var Se=B[de];Se instanceof kt?(T(Se.getChildren(),q+1),c[q]=Se):Se===n&&(f=!0)}}(t,0),f?c:(console.warn("could not get path"),null)},r=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f}([Kt("displayedGroupCreator")],r),r}(ct),ja=function(){function h(){}return h.STRING_PROPERTIES=["sortingOrder","rowClass","rowSelection","overlayLoadingTemplate","overlayNoRowsTemplate","quickFilterText","rowModelType","editType","domLayout","clipboardDeliminator","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","serverSideStoreType","groupDisplayType","treeDataDisplayType"],h.OBJECT_PROPERTIES=["components","frameworkComponents","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultExportParams","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","popupParent","colResizeDefault","statusBar","sideBar","chartThemeOverrides","customChartThemes"],h.ARRAY_PROPERTIES=["alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes"],h.NUMBER_PROPERTIES=["rowHeight","detailRowHeight","rowBuffer","colWidth","headerHeight","groupHeaderHeight","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","minColWidth","maxColWidth","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","scrollbarWidth","batchUpdateWaitMillis","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDelay","cellFadeDelay","tabIndex"],h.BOOLEAN_PROPERTIES=["suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellSelection","suppressHorizontalScroll","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","angularCompileRows","angularCompileFilters","groupSuppressAutoColumn","groupSelectsChildren","groupIncludeFooter","groupIncludeTotalFooter","groupUseEntireRow","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressParentsInRowNodes","suppressColumnMoveAnimation","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","suppressAsyncEvents","allowContextMenuWithControlKey","suppressContextMenu","rememberGroupStateWhenNewData","enableCellChangeFlash","suppressDragLeaveHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","suppressAggAtRootLevel","suppressFocusAfterRefresh","functionsPassive","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","suppressClickEdit","rowDragEntireRow","rowDragManaged","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","deprecatedEmbedFullWidthRows","suppressPaginationPanel","floatingFilter","groupHideOpenParents","groupMultiAutoColumn","pagination","stopEditingWhenGridLosesFocus","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","deltaRowDataMode","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","treeData","masterDetail","suppressMultiRangeSelection","enterMovesDownAfterEdit","enterMovesDown","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressEnterpriseResetOnNewColumns","enableOldSetFilterModel","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","serverSideSortingAlwaysResets","suppressSetColumnStateEvents","suppressColumnStateEvents","enableCharts","deltaColumnMode","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","immutableData","immutableColumns","pivotSuppressAutoColumn","suppressExpandablePivotGroups","applyColumnDefOrder","debounceVerticalScrollbar","detailRowAutoHeight","serverSideFilteringAlwaysResets","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","maintainColumnOrder","groupMaintainOrder","columnHoverHighlight","reactUi"],h.ALL_PROPERTIES=function(){for(var h=0,r=0,t=arguments.length;r<t;r++)h+=arguments[r].length;var n=Array(h),c=0;for(r=0;r<t;r++)for(var f=arguments[r],y=0,T=f.length;y<T;y++,c++)n[c]=f[y];return n}(h.ARRAY_PROPERTIES,h.OBJECT_PROPERTIES,h.STRING_PROPERTIES,h.NUMBER_PROPERTIES,h.FUNCTION_PROPERTIES=["localeTextFunc","groupRowInnerRenderer","groupRowInnerRendererFramework","groupRowRenderer","groupRowRendererFramework","isExternalFilterPresent","getRowHeight","doesExternalFilterPass","getRowClass","getRowStyle","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","groupRowAggNodes","getRowNodeId","isFullWidthCell","fullWidthCellRenderer","fullWidthCellRendererFramework","processSecondaryColDef","processSecondaryColGroupDef","getBusinessKeyForNode","sendToClipboard","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","loadingCellRenderer","loadingCellRendererFramework","loadingOverlayComponent","loadingOverlayComponentFramework","noRowsOverlayComponent","noRowsOverlayComponentFramework","detailCellRenderer","detailCellRendererFramework","isRowMaster","isRowSelectable","postSort","processHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","suppressKeyboardEvent","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideStoreParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","defaultGroupSortComparator","defaultGroupOrderComparator","loadingCellRendererSelector"],h.BOOLEAN_PROPERTIES),h.FRAMEWORK_PROPERTIES=["__ob__","__v_skip","__metadata__","mappedColumnProperties","hasChildColumns","toColDef","createColDefFromGridColumn"],h}(),Cp=function(){return Cp=Object.assign||function(h){for(var r,t=1,n=arguments.length;t<n;t++)for(var c in r=arguments[t])Object.prototype.hasOwnProperty.call(r,c)&&(h[c]=r[c]);return h},Cp.apply(this,arguments)},N1=function(){for(var h=0,r=0,t=arguments.length;r<t;r++)h+=arguments[r].length;var n=Array(h),c=0;for(r=0;r<t;r++)for(var f=arguments[r],y=0,T=f.length;y<T;y++,c++)n[c]=f[y];return n},Wo=function(){function h(){}return h.getEventCallbacks=function(){return h.EVENT_CALLBACKS||(h.EVENT_CALLBACKS=h.EVENTS.map(function(r){return h.getCallbackForEvent(r)})),h.EVENT_CALLBACKS},h.copyAttributesToGridOptions=function(r,t,n){"object"!=typeof r&&(r={});var c=r,f=function(T){return void 0!==t[T]};return N1(h.ARRAY_PROPERTIES,h.STRING_PROPERTIES,h.OBJECT_PROPERTIES,h.FUNCTION_PROPERTIES,h.getEventCallbacks()).filter(f).forEach(function(y){return c[y]=t[y]}),h.BOOLEAN_PROPERTIES.filter(f).forEach(function(y){return c[y]=h.toBoolean(t[y])}),h.NUMBER_PROPERTIES.filter(f).forEach(function(y){return c[y]=h.toNumber(t[y])}),r},h.getCallbackForEvent=function(r){return!r||r.length<2?r:"on"+r[0].toUpperCase()+r.substr(1)},h.processOnChange=function(r,t,n,c){if(r){var f=Cp({},r),y=t,T=function(Se){return f[Se]};N1(h.ARRAY_PROPERTIES,h.OBJECT_PROPERTIES,h.STRING_PROPERTIES,h.getEventCallbacks()).filter(T).forEach(function(de){return y[de]=f[de].currentValue}),h.BOOLEAN_PROPERTIES.filter(T).forEach(function(de){return y[de]=h.toBoolean(f[de].currentValue)}),h.NUMBER_PROPERTIES.filter(T).forEach(function(de){return y[de]=h.toNumber(f[de].currentValue)}),f.enableCellTextSelection&&(n.setEnableCellTextSelection(h.toBoolean(f.enableCellTextSelection.currentValue)),delete f.enableCellTextSelection),f.quickFilterText&&(n.setQuickFilter(f.quickFilterText.currentValue),delete f.quickFilterText),f.autoGroupColumnDef&&(n.setAutoGroupColumnDef(f.autoGroupColumnDef.currentValue,"gridOptionsChanged"),delete f.autoGroupColumnDef),f.columnDefs&&(n.setColumnDefs(f.columnDefs.currentValue,"gridOptionsChanged"),delete f.columnDefs),f.paginationPageSize&&(n.paginationSetPageSize(h.toNumber(f.paginationPageSize.currentValue)),delete f.paginationPageSize),f.pivotMode&&(c.setPivotMode(h.toBoolean(f.pivotMode.currentValue)),delete f.pivotMode),f.groupRemoveSingleChildren&&(n.setGroupRemoveSingleChildren(h.toBoolean(f.groupRemoveSingleChildren.currentValue)),delete f.groupRemoveSingleChildren),f.suppressRowDrag&&(n.setSuppressRowDrag(h.toBoolean(f.suppressRowDrag.currentValue)),delete f.suppressRowDrag),f.suppressMoveWhenRowDragging&&(n.setSuppressMoveWhenRowDragging(h.toBoolean(f.suppressMoveWhenRowDragging.currentValue)),delete f.suppressMoveWhenRowDragging),f.suppressRowClickSelection&&(n.setSuppressRowClickSelection(h.toBoolean(f.suppressRowClickSelection.currentValue)),delete f.suppressRowClickSelection),f.suppressClipboardPaste&&(n.setSuppressClipboardPaste(h.toBoolean(f.suppressClipboardPaste.currentValue)),delete f.suppressClipboardPaste),f.headerHeight&&(n.setHeaderHeight(h.toNumber(f.headerHeight.currentValue)),delete f.headerHeight);var B=n;Object.keys(f).forEach(function(de){var Se="set"+de.charAt(0).toUpperCase()+de.substring(1);B[Se]&&B[Se](r[de].currentValue)});var q={type:Ge.EVENT_COMPONENT_STATE_CHANGED,api:t.api,columnApi:t.columnApi};ce(r,function(de,Se){q[de]=Se}),n.dispatchEvent(q)}},h.toBoolean=function(r){return"boolean"==typeof r?r:"string"==typeof r&&("TRUE"===r.toUpperCase()||""==r)},h.toNumber=function(r){return"number"==typeof r?r:"string"==typeof r?Number(r):void 0},h.EVENTS=[],h.PUBLIC_EVENTS=[],h.EXCLUDED_INTERNAL_EVENTS=[],h.STRING_PROPERTIES=ja.STRING_PROPERTIES,h.OBJECT_PROPERTIES=ja.OBJECT_PROPERTIES,h.ARRAY_PROPERTIES=ja.ARRAY_PROPERTIES,h.NUMBER_PROPERTIES=ja.NUMBER_PROPERTIES,h.BOOLEAN_PROPERTIES=ja.BOOLEAN_PROPERTIES,h.FUNCTION_PROPERTIES=ja.FUNCTION_PROPERTIES,h.ALL_PROPERTIES=ja.ALL_PROPERTIES,h}();Wo.EVENTS=D(Ge),Wo.EXCLUDED_INTERNAL_EVENTS=[Ge.EVENT_SCROLLBAR_WIDTH_CHANGED,Ge.EVENT_CHECKBOX_CHANGED,Ge.EVENT_HEIGHT_SCALE_CHANGED,Ge.EVENT_BODY_HEIGHT_CHANGED,Ge.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,Ge.EVENT_SCROLL_VISIBILITY_CHANGED,Ge.EVENT_COLUMN_HOVER_CHANGED,Ge.EVENT_FLASH_CELLS,Ge.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED,Ge.EVENT_DISPLAYED_ROWS_CHANGED,Ge.EVENT_LEFT_PINNED_WIDTH_CHANGED,Ge.EVENT_RIGHT_PINNED_WIDTH_CHANGED,Ge.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,Ge.EVENT_POPUP_TO_FRONT,Ge.EVENT_KEYBOARD_FOCUS,Ge.EVENT_MOUSE_FOCUS,Ge.EVENT_STORE_UPDATED,Ge.EVENT_COLUMN_PANEL_ITEM_DRAG_START,Ge.EVENT_COLUMN_PANEL_ITEM_DRAG_END,Ge.EVENT_FILL_START,Ge.EVENT_FILL_END],Wo.PUBLIC_EVENTS=Wo.EVENTS.filter(function(h){return!oe(Wo.EXCLUDED_INTERNAL_EVENTS,h)});var k4=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),k1=function(h){function r(){var t=null!==h&&h.apply(this,arguments)||this;return t.componentsMappedByName={},t}return k4(r,h),r.prototype.setupComponents=function(t){var n=this;t&&t.forEach(function(c){return n.addComponent(c)})},r.prototype.addComponent=function(t){var c=t.componentName.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase().toUpperCase();this.componentsMappedByName[c]=t.componentClass},r.prototype.getComponentClass=function(t){return this.componentsMappedByName[t]},r=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f}([Kt("agStackComponentsRegistry")],r),r}(ct),Qn=function(){function h(){}return h.STRING_PROPERTIES=["headerName","columnGroupShow","headerClass","toolPanelClass","headerValueGetter","pivotKeys","groupId","colId","sort","initialSort","field","type","tooltipComponent","tooltipField","headerTooltip","cellClass","showRowGroup","template","templateUrl","filter","initialAggFunc","aggFunc","cellRenderer","cellEditor","pinned","initialPinned","chartDataType","cellEditorPopupPosition"],h.OBJECT_PROPERTIES=["headerGroupComponent","headerGroupComponentFramework","headerGroupComponentParams","cellStyle","cellRendererParams","cellEditorFramework","cellEditorParams","pinnedRowCellRendererFramework","pinnedRowCellRendererParams","filterFramework","filterParams","pivotValueColumn","headerComponent","headerComponentFramework","headerComponentParams","floatingFilterComponent","floatingFilterComponentParams","floatingFilterComponentFramework","tooltipComponent","tooltipComponentParams","tooltipComponentFramework","refData","columnsMenuParams"],h.ARRAY_PROPERTIES=["children","sortingOrder","allowedAggFuncs","menuTabs","pivotTotalColumnIds","cellClassRules","icons"],h.NUMBER_PROPERTIES=["sortedAt","sortIndex","initialSortIndex","flex","initialFlex","width","initialWidth","minWidth","maxWidth","rowGroupIndex","initialRowGroupIndex","pivotIndex","initialPivotIndex"],h.BOOLEAN_PROPERTIES=["suppressCellFlash","suppressColumnsToolPanel","suppressFiltersToolPanel","openByDefault","marryChildren","hide","initialHide","rowGroup","initialRowGroup","pivot","initialPivot","checkboxSelection","headerCheckboxSelection","headerCheckboxSelectionFilteredOnly","suppressMenu","suppressMovable","lockPosition","lockVisible","lockPinned","unSortIcon","suppressSizeToFit","suppressAutoSize","enableRowGroup","enablePivot","enableValue","editable","suppressPaste","suppressNavigable","enableCellChangeFlash","rowDrag","dndSource","autoHeight","wrapText","sortable","resizable","singleClickEdit","floatingFilter","cellEditorPopup","suppressFillHandle"],h.ALL_PROPERTIES=function(){for(var h=0,r=0,t=arguments.length;r<t;r++)h+=arguments[r].length;var n=Array(h),c=0;for(r=0;r<t;r++)for(var f=arguments[r],y=0,T=f.length;y<T;y++,c++)n[c]=f[y];return n}(h.ARRAY_PROPERTIES,h.OBJECT_PROPERTIES,h.STRING_PROPERTIES,h.NUMBER_PROPERTIES,h.FUNCTION_PROPERTIES=["dndSourceOnRowDrag","valueGetter","valueSetter","filterValueGetter","keyCreator","cellRenderer","cellRendererFramework","pinnedRowCellRenderer","valueFormatter","pinnedRowValueFormatter","valueParser","comparator","equals","pivotComparator","suppressKeyboardEvent","suppressHeaderKeyboardEvent","colSpan","rowSpan","getQuickFilterText","newValueHandler","onCellValueChanged","onCellClicked","onCellDoubleClicked","onCellContextMenu","rowDragText","tooltipValueGetter","tooltipComponent","tooltipComponentFramework","cellRendererSelector","cellEditorSelector"],h.BOOLEAN_PROPERTIES),h.FRAMEWORK_PROPERTIES=["__ob__","__v_skip","__metadata__","mappedColumnProperties","hasChildColumns","toColDef","createColDefFromGridColumn"],h}(),Eu=function(){function h(r,t,n,c){void 0===c&&(c=1),this.r=Math.min(1,Math.max(0,r||0)),this.g=Math.min(1,Math.max(0,t||0)),this.b=Math.min(1,Math.max(0,n||0)),this.a=Math.min(1,Math.max(0,c||0))}return h.fromString=function(r){if(r.indexOf("#")>=0)return h.fromHexString(r);var t=h.nameToHex[r];if(t)return h.fromHexString(t);if(r.indexOf("rgb")>=0)return h.fromRgbaString(r);throw new Error("Invalid color string: '"+r+"'")},h.parseHex=function(r){var t;switch((r=r.replace(/ /g,"").slice(1)).length){case 6:case 8:t=[];for(var n=0;n<r.length;n+=2)t.push(parseInt(""+r[n]+r[n+1],16));break;case 3:case 4:t=r.split("").map(function(c){return parseInt(c,16)}).map(function(c){return c+16*c})}if(t.length>=3&&t.every(function(c){return c>=0}))return 3===t.length&&t.push(255),t},h.fromHexString=function(r){var t=h.parseHex(r);if(t)return new h(t[0]/255,t[1]/255,t[2]/255,t[3]/255);throw new Error("Malformed hexadecimal color string: '"+r+"'")},h.stringToRgba=function(r){for(var t=[NaN,NaN],n=t[0],c=t[1],f=0;f<r.length;f++){var y=r[f];if(n||"("!==y){if(")"===y){c=f;break}}else n=f}var T=n&&c&&r.substring(n+1,c);if(T){var B=T.split(","),q=[];for(f=0;f<B.length;f++){var de=B[f],Se=parseFloat(de);if(isNaN(Se))return;de.indexOf("%")>=0?(Se=Math.max(0,Math.min(100,Se)),Se/=100):3===f?Se=Math.max(0,Math.min(1,Se)):(Se=Math.max(0,Math.min(255,Se)),Se/=255),q.push(Se)}return q}},h.fromRgbaString=function(r){var t=h.stringToRgba(r);if(t){if(3===t.length)return new h(t[0],t[1],t[2]);if(4===t.length)return new h(t[0],t[1],t[2],t[3])}throw new Error("Malformed rgb/rgba color string: '"+r+"'")},h.fromArray=function(r){if(4===r.length)return new h(r[0],r[1],r[2],r[3]);if(3===r.length)return new h(r[0],r[1],r[2]);throw new Error("The given array should contain 3 or 4 color components (numbers).")},h.fromHSB=function(r,t,n,c){void 0===c&&(c=1);var f=h.HSBtoRGB(r,t,n);return new h(f[0],f[1],f[2],c)},h.padHex=function(r){return 1===r.length?"0"+r:r},h.prototype.toHexString=function(){var r="#"+h.padHex(Math.round(255*this.r).toString(16))+h.padHex(Math.round(255*this.g).toString(16))+h.padHex(Math.round(255*this.b).toString(16));return this.a<1&&(r+=h.padHex(Math.round(255*this.a).toString(16))),r},h.prototype.toRgbaString=function(r){void 0===r&&(r=3);var t=[Math.round(255*this.r),Math.round(255*this.g),Math.round(255*this.b)],n=Math.pow(10,r);return 1!==this.a?(t.push(Math.round(this.a*n)/n),"rgba("+t.join(", ")+")"):"rgb("+t.join(", ")+")"},h.prototype.toString=function(){return 1===this.a?this.toHexString():this.toRgbaString()},h.prototype.toHSB=function(){return h.RGBtoHSB(this.r,this.g,this.b)},h.RGBtoHSB=function(r,t,n){var c=Math.min(r,t,n),f=Math.max(r,t,n),T=NaN;if(c!==f){var B=f-c,q=(f-r)/B,de=(f-t)/B,Se=(f-n)/B;T=r===f?Se-de:t===f?2+q-Se:4+de-q,(T/=6)<0&&(T+=1)}return[360*T,0!==f?(f-c)/f:0,f]},h.HSBtoRGB=function(r,t,n){isNaN(r)&&(r=0),r=(r%360+360)%360/360;var c=0,f=0,y=0;if(0===t)c=f=y=n;else{var T=6*(r-Math.floor(r)),B=T-Math.floor(T),q=n*(1-t),de=n*(1-t*B),Se=n*(1-t*(1-B));switch(T>>0){case 0:c=n,f=Se,y=q;break;case 1:c=de,f=n,y=q;break;case 2:c=q,f=n,y=Se;break;case 3:c=q,f=de,y=n;break;case 4:c=Se,f=q,y=n;break;case 5:c=n,f=q,y=de}}return[c,f,y]},h.prototype.derive=function(r,t,n,c){var f=h.RGBtoHSB(this.r,this.g,this.b),y=f[2];0==y&&n>1&&(y=.05);var T=((f[0]+r)%360+360)%360,B=Math.max(Math.min(f[1]*t,1),0);y=Math.max(Math.min(y*n,1),0);var q=Math.max(Math.min(this.a*c,1),0),de=h.HSBtoRGB(T,B,y);return de.push(q),h.fromArray(de)},h.prototype.brighter=function(){return this.derive(0,1,1/.7,1)},h.prototype.darker=function(){return this.derive(0,1,.7,1)},h.nameToHex=Object.freeze({aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgreen:"#006400",darkgrey:"#A9A9A9",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",green:"#008000",greenyellow:"#ADFF2F",grey:"#808080",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgreen:"#90EE90",lightgrey:"#D3D3D3",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"}),h}();var ln,wp,zo,Ru,V0,Lf,Nf,U0,B4=Object.freeze({__proto__:null,stringToArray:function(h,r){void 0===r&&(r=",");var t=[],n=function(je){return"\r"===je||"\n"===je},c=!1;if(""===h)return[[""]];for(var y,T,B,f=function(je,Qe,rt){var _t=h[rt-1],Vt=h[rt],Ut=h[rt+1],Rt=function(){t[je]||(t[je]=[]),t[je][Qe]||(t[je][Qe]="")};if(Rt(),'"'===Vt){if(c)return'"'===Ut?(t[je][Qe]+='"',rt++):c=!1,y=je,T=Qe,B=rt,"continue";if(void 0===_t||_t===r||n(_t))return c=!0,y=je,T=Qe,B=rt,"continue"}if(!c){if(Vt===r)return Qe++,Rt(),y=je,T=Qe,B=rt,"continue";if(n(Vt))return Qe=0,je++,Rt(),"\r"===Vt&&"\n"===Ut&&rt++,y=je,T=Qe,B=rt,"continue"}t[je][Qe]+=Vt,y=je,T=Qe,B=rt},q=0,de=0,Se=0;Se<h.length;Se++)f(q,de,Se),q=y,de=T,Se=B;return t}});function uo(){return void 0===wp&&(wp=!!document.documentMode),wp}function El(){return void 0===zo&&(zo=!uo()&&!!window.StyleMedia),zo}function Du(){return void 0===ln&&(ln=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),ln}function Ou(){if(void 0===Ru){var h=window;Ru=!!h.chrome&&(!!h.chrome.webstore||!!h.chrome.runtime)||/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}return Ru}function tn(){if(void 0===V0){var h=window;V0=void 0!==h.InstallTrigger}return V0}function bs(){return void 0===Lf&&(Lf=(/iPad|iPhone|iPod/.test(navigator.platform)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1)&&!window.MSStream),Lf}function H0(h){if(!h)return null;var r=h.tabIndex,t=h.getAttribute("tabIndex");return uo()&&0===r&&null===t?!0==={a:!0,body:!0,button:!0,frame:!0,iframe:!0,img:!0,input:!0,isindex:!0,object:!0,select:!0,textarea:!0}[h.nodeName.toLowerCase()]?"0":null:-1!==r||null!==t&&(""!==t||tn())?r.toString():null}function Xa(){if(!document.body)return-1;var h=1e6,r=navigator.userAgent.toLowerCase().match(/firefox/)?6e6:1e9,t=document.createElement("div");for(document.body.appendChild(t);;){var n=2*h;if(t.style.height=n+"px",n>r||t.clientHeight!==n)break;h=n}return document.body.removeChild(t),h}function If(){return null==U0&&G1(),U0}function G1(){var h=document.body,r=document.createElement("div");r.style.width=r.style.height="100px",r.style.opacity="0",r.style.overflow="scroll",r.style.msOverflowStyle="scrollbar",r.style.position="absolute",h.appendChild(r);var t=r.offsetWidth-r.clientWidth;0===t&&0===r.clientWidth&&(t=null),r.parentNode&&r.parentNode.removeChild(r),null!=t&&(U0=t,Nf=0===t)}function Ya(){return null==Nf&&G1(),Nf}function V1(){return document.body?document.body.clientWidth:window.innerHeight?window.innerWidth:document.documentElement&&document.documentElement.clientWidth?document.documentElement.clientWidth:-1}function U1(){return document.body?document.body.clientHeight:window.innerHeight?window.innerHeight:document.documentElement&&document.documentElement.clientHeight?document.documentElement.clientHeight:-1}var W0,Aa=Object.freeze({__proto__:null,isBrowserIE:uo,isBrowserEdge:El,isBrowserSafari:Du,isBrowserChrome:Ou,isBrowserFirefox:tn,isIOSUserAgent:bs,getTabIndex:H0,getMaxDivHeight:Xa,getScrollbarWidth:If,isInvisibleScrollbar:Ya,hasOverflowScrolling:function(){var h=["webkit","moz","o","ms"],r=document.createElement("div"),n=!1;document.getElementsByTagName("body")[0].appendChild(r),r.setAttribute("style",h.map(function(B){return"-"+B+"-overflow-scrolling: touch"}).concat("overflow-scrolling: touch").join(";"));var f=window.getComputedStyle(r);if("touch"===f.overflowScrolling&&(n=!0),!n)for(var y=0,T=h;y<T.length;y++)if("touch"===f[T[y]+"OverflowScrolling"]){n=!0;break}return r.parentNode&&r.parentNode.removeChild(r),n},getBodyWidth:V1,getBodyHeight:U1});function Er(h,r){if(h&&r&&0!==r.length){if(r.indexOf(" ")>=0)return void r.split(" ").forEach(function(n){return Er(h,n)});if(h.classList)h.classList.add(r);else if(h.className&&h.className.length>0){var t=h.className.split(" ");t.indexOf(r)<0&&(t.push(r),h.setAttribute("class",t.join(" ")))}else h.setAttribute("class",r);return h}}function zi(h,r){if(h&&r&&0!==r.length){if(r.indexOf(" ")>=0)return void r.split(" ").forEach(function(n){return zi(h,n)});if(h.classList)h.classList.remove(r);else if(h.className&&h.className.length>0){var t=h.className.split(" ").filter(function(n){return n!==r}).join(" ");h.setAttribute("class",t)}}}function Fr(h,r,t){t?Er(h,r):zi(h,r)}function qa(h,r){if(h.classList)return h.classList.contains(r);if(h.className){var t=h.className===r,n=h.className.indexOf(" "+r+" ")>=0,c=0===h.className.indexOf(r+" "),f=h.className.lastIndexOf(" "+r)===h.className.length-r.length-1;return t||n||c||f}return!1}function H1(h){var r=Element.prototype.matches||Element.prototype.msMatchesSelector,t=r.call(h,W.INPUT_SELECTOR),n=r.call(h,W.FOCUSABLE_EXCLUDE),c=Ol(h);return t&&!n&&c}function Nn(h,r){Fr(h,"ag-hidden",!r)}function Xn(h,r){Fr(h,"ag-invisible",!r)}function Ka(h,r){var t="disabled",n=r?function(c){return c.setAttribute(t,"")}:function(c){return c.removeAttribute(t)};n(h),Ts(h.querySelectorAll("input"),function(c){return n(c)})}function Rl(h,r,t){for(var n=0;h;){if(qa(h,r))return!0;if(h=h.parentElement,t&&++n>t)break}return!1}function $s(h){var r=window.getComputedStyle(h),n=r.width,c=r.paddingTop,f=r.paddingRight,y=r.paddingBottom,T=r.paddingLeft,B=r.marginTop,q=r.marginRight,de=r.marginBottom,Se=r.marginLeft,ke=r.boxSizing;return{height:parseFloat(r.height),width:parseFloat(n),paddingTop:parseFloat(c),paddingRight:parseFloat(f),paddingBottom:parseFloat(y),paddingLeft:parseFloat(T),marginTop:parseFloat(B),marginRight:parseFloat(q),marginBottom:parseFloat(de),marginLeft:parseFloat(Se),boxSizing:ke}}function Dl(h){var r=$s(h);return"border-box"===r.boxSizing?r.height-r.paddingTop-r.paddingBottom:r.height}function jo(h){var r=$s(h);return"border-box"===r.boxSizing?r.width-r.paddingLeft-r.paddingRight:r.width}function el(h){var r=$s(h);return Math.ceil(h.offsetHeight+(r.marginBottom+r.marginTop))}function z0(h){var r=$s(h);return Math.ceil(h.offsetWidth+(r.marginLeft+r.marginRight))}function Ei(){if("boolean"==typeof W0)return W0;var h=document.createElement("div");return h.style.direction="rtl",h.style.width="1px",h.style.height="1px",h.style.position="fixed",h.style.top="0px",h.style.overflow="hidden",h.dir="rtl",h.innerHTML='<div style="width: 2px">\n            <span style="display: inline-block; width: 1px"></span>\n            <span style="display: inline-block; width: 1px"></span>\n        </div>',document.body.appendChild(h),h.scrollLeft=1,W0=0===Math.floor(h.scrollLeft),document.body.removeChild(h),W0}function Pu(h,r){var t=h.scrollLeft;return r&&(t=Math.abs(t),Ou()&&!Ei()&&(t=h.scrollWidth-h.clientWidth-t)),t}function Fu(h,r,t){t&&(Ei()?r*=-1:(Du()||Ou())&&(r=h.scrollWidth-h.clientWidth-r)),h.scrollLeft=r}function So(h){for(;h&&h.firstChild;)h.removeChild(h.firstChild)}function ji(h){h&&h.parentNode&&h.parentNode.removeChild(h)}function Ol(h){return null!==h.offsetParent}function ua(h){var r=document.createElement("div");return r.innerHTML=(h||"").trim(),r.firstChild}function ki(h){return h&&h.clientHeight?h.clientHeight:0}function Ma(h){return h&&h.clientWidth?h.clientWidth:0}function Qa(h,r,t){t&&t.nextSibling===r||(t?t.nextSibling?h.insertBefore(r,t.nextSibling):h.appendChild(r):h.firstChild&&h.firstChild!==r&&h.insertAdjacentElement("afterbegin",r))}function bo(h,r){for(var t=0;t<r.length;t++){var n=r[t],c=h.children[t];c!==n&&h.insertBefore(n,c)}}function Lu(h,r,t){t?t.insertAdjacentElement("afterend",r):h.firstChild?h.insertAdjacentElement("afterbegin",r):h.appendChild(r)}function tl(h,r){!r||Object.keys(r).forEach(function(t){var n=$n(t);n&&(h.style[n]=r[t])})}function Pl(h){return h.clientWidth<h.scrollWidth}function As(h){return h.clientHeight<h.scrollHeight}function _i(h,r){"flex"===r?(h.style.removeProperty("width"),h.style.removeProperty("minWidth"),h.style.removeProperty("maxWidth"),h.style.flex="1 1 auto"):Ta(h,r)}function Ta(h,r){r=yn(r),h.style.width=r.toString(),h.style.maxWidth=r.toString(),h.style.minWidth=r.toString()}function sr(h,r){r=yn(r),h.style.height=r.toString(),h.style.maxHeight=r.toString(),h.style.minHeight=r.toString()}function yn(h){return"number"==typeof h?h+"px":h}function ti(h){return"function"==typeof Node?h instanceof Node:h&&"object"==typeof h&&"number"==typeof h.nodeType&&"string"==typeof h.nodeName}function Ao(h){return"function"==typeof HTMLElement?h instanceof HTMLElement:h&&ft(h)&&1===h.nodeType&&"string"==typeof h.nodeName}function Ea(h){return ti(h)||Ao(h)}function Ri(h){if(null==h)return[];var r=[];return Ts(h,function(t){return r.push(t)}),r}function Ms(h,r){if(h)for(var t=0;t<h.length;t++){var n=h[t];r(n.name,n.value)}}function Ja(h,r,t){null==t?h.removeAttribute(r):h.setAttribute(r,t.toString())}function Ts(h,r){if(null!=h)for(var t=0;t<h.length;t++)r(h[t])}var vn=Object.freeze({__proto__:null,addCssClass:Er,removeCssClass:zi,addOrRemoveCssClass:Fr,radioCssClass:function(h,r,t){for(var n=h.parentElement,c=n&&n.firstChild;c;)r&&Fr(c,r,c===h),t&&Fr(c,t,c!==h),c=c.nextSibling},containsClass:qa,isFocusableFormField:H1,setDisplayed:Nn,setVisible:Xn,setDisabled:Ka,isElementChildOfClass:Rl,getElementSize:$s,getInnerHeight:Dl,getInnerWidth:jo,getAbsoluteHeight:el,getAbsoluteWidth:z0,isRtlNegativeScroll:Ei,getScrollLeft:Pu,setScrollLeft:Fu,clearElement:So,removeElement:function(h,r){ji(h.querySelector(r))},removeFromParent:ji,isVisible:Ol,loadTemplate:ua,appendHtml:function(h,r){h.lastChild?h.insertAdjacentHTML("afterbegin",r):h.innerHTML=r},getElementAttribute:function(h,r){return h.attributes&&h.attributes[r]?h.attributes[r].value:null},offsetHeight:ki,offsetWidth:Ma,ensureDomOrder:Qa,setDomChildOrder:bo,insertWithDomOrder:Lu,prependDC:function(h,r){v(h.firstChild)?h.insertBefore(r,h.firstChild):h.appendChild(r)},addStylesToElement:tl,isHorizontalScrollShowing:Pl,isVerticalScrollShowing:As,setElementWidth:_i,setFixedWidth:Ta,setElementHeight:function(h,r){"flex"===r?(h.style.removeProperty("height"),h.style.removeProperty("minHeight"),h.style.removeProperty("maxHeight"),h.style.flex="1 1 auto"):sr(h,r)},setFixedHeight:sr,formatSize:yn,isNode:ti,isElement:Ao,isNodeOrElement:Ea,copyNodeList:Ri,iterateNamedNodeMap:Ms,setCheckboxState:function(h,r){"boolean"==typeof r?(h.checked=r,h.indeterminate=!1):h.indeterminate=!0},addOrRemoveAttribute:Ja,nodeListForEach:Ts}),Nu=Object.freeze({__proto__:null,getNameOfClass:function(h){var t=h.toString(),n=/function (.{1,})\(/.exec(t);return n&&n.length>1?n[1]:""},findLineByLeastSquares:function(h){var r=h.length,t=0;if(r<=1)return h;for(var n=0;n<h.length;n++){var c=h[n],f=c.toString().split("e-");f.length>1?t=Math.max(t,parseInt(f[1],10)):Math.floor(c)!==c&&(t=Math.max(t,c.toString().split(".")[1].length))}for(var y=0,T=0,B=0,q=0,de=0,Se=0;Se<r;Se++)y+=Se,T+=de=h[Se],q+=Se*Se,B+=Se*de;var ke=(r*B-y*T)/(r*q-y*y),je=T/r-ke*y/r,Qe=[];for(Se=0;Se<=r;Se++)Qe.push(parseFloat((Se*ke+je).toFixed(t)));return Qe},cssStyleObjectToMarkup:function(h){if(!h)return"";var r=[];return ce(h,function(t,n){var c=hr(t);r.push(c+": "+n+";")}),r.join(" ")},message:function(h){var r=document.createElement("div"),t=document.querySelector("#__ag__message");r.innerHTML=h,t||(t=ua('<div id="__ag__message" style="display: inline-block; position: absolute; top: 0px; left: 0px; color: white; background-color: black; z-index: 20; padding: 2px; border: 1px solid darkred; height: 200px; overflow-y: auto;"></div>'),document.body&&document.body.appendChild(t)),t.insertBefore(r,t.children[0])},bindCellRendererToHtmlElement:function(h,r){h.then(function(t){var n=t.getGui();null!=n&&("object"==typeof n?r.appendChild(n):r.innerHTML=n)})}});function si(h,r,t){h.setAttribute(Jn(r),t.toString())}function io(h,r){h.removeAttribute(Jn(r))}function Jn(h){return"aria-"+h}function co(h,r){r?h.setAttribute("role",r):h.removeAttribute("role")}function Sp(h){return h.isSortAscending()?"ascending":h.isSortDescending()?"descending":"none"}function Yo(h){return parseInt(h.getAttribute("aria-posinset"),10)}function Da(h,r){var t="label";r?si(h,t,r):io(h,t)}function Nl(h,r){var t="labelledby";r?si(h,t,r):io(h,t)}function To(h,r){var t="describedby";r?si(h,t,r):io(h,t)}function X0(h,r){si(h,"disabled",r)}function Y0(h,r){si(h,"expanded",r)}function j1(h,r){si(h,"setsize",r)}function X1(h,r){si(h,"posinset",r)}function Y1(h,r){si(h,"multiselectable",r)}function q1(h,r){si(h,"rowcount",r)}function xp(h,r){si(h,"rowindex",r)}function K1(h,r){si(h,"colcount",r)}function bp(h,r){si(h,"colindex",r)}function Q1(h,r){si(h,"colspan",r)}function J1(h,r){si(h,"sort",r)}function Z1(h){io(h,"sort")}function Iu(h,r){var t="selected";r?si(h,t,r):io(h,t)}function $1(h,r){si(h,"checked",void 0===r?"mixed":r)}var G4=Object.freeze({__proto__:null,setAriaRole:co,getAriaSortState:Sp,getAriaLevel:function(h){return parseInt(h.getAttribute("aria-level"),10)},getAriaPosInSet:Yo,getAriaDescribedBy:function(h){return h.getAttribute("aria-describedby")||""},setAriaLabel:Da,setAriaLabelledBy:Nl,setAriaDescribedBy:To,setAriaLevel:function(h,r){si(h,"level",r)},setAriaDisabled:X0,setAriaExpanded:Y0,removeAriaExpanded:function(h){io(h,"expanded")},setAriaSetSize:j1,setAriaPosInSet:X1,setAriaMultiSelectable:Y1,setAriaRowCount:q1,setAriaRowIndex:xp,setAriaColCount:K1,setAriaColIndex:bp,setAriaColSpan:Q1,setAriaSort:J1,removeAriaSort:Z1,setAriaSelected:Iu,setAriaChecked:$1});function rl(h,r,t){if(void 0===r&&(r=!0),void 0===t&&(t="-"),!h)return null;var n=[h.getFullYear(),h.getMonth()+1,h.getDate()].map(function(c){return Zr(c,2)}).join(t);return r&&(n+=" "+[h.getHours(),h.getMinutes(),h.getSeconds()].map(function(c){return Zr(c,2)}).join(":")),n}function Za(h){if(!h)return null;var r=h.split(" "),t=r[0],n=r[1];if(!t)return null;var c=t.split("-").map(function(je){return parseInt(je,10)});if(3!==c.filter(function(je){return!isNaN(je)}).length)return null;var f=c[0],y=c[1],T=c[2],B=new Date(f,y-1,T);if(B.getFullYear()!==f||B.getMonth()!==y-1||B.getDate()!==T)return null;if(!n||"00:00:00"===n)return B;var q=n.split(":").map(function(je){return parseInt(je,10)}),de=q[0],Se=q[1],ke=q[2];return de>=0&&de<24&&B.setHours(de),Se>=0&&Se<60&&B.setMinutes(Se),ke>=0&&ke<60&&B.setSeconds(ke),B}var Vf=Object.freeze({__proto__:null,serialiseDate:rl,parseDateTimeFromString:Za});function ey(h,r,t){var n={},c=h.filter(function(f){return!r.some(function(y){return y===f})});return c.length>0&&c.forEach(function(f){return n[f]=ty(f,t)}),n}function ty(h,r,t,n){var c=n?Mp:Es,f=r.map(function(y){return{value:y,relevance:c(h.toLowerCase(),y.toLocaleLowerCase())}});return f.sort(function(y,T){return T.relevance-y.relevance}),t&&(f=f.filter(function(y){return 0!==y.relevance})),f.map(function(y){return y.value})}function Ap(h){var n,c,f,r=h.toLowerCase(),t=new Array(r.length-1);for(n=c=0,f=t.length;c<=f;n=c+=1)t[n]=r.slice(n,n+2);return t}function Es(h,r){if(0===h.length&&0===r.length)return 0;var y,T,t=Ap(h),n=Ap(r),c=t.length+n.length,f=0;for(y=0,T=t.length;y<T;y++){var de,B=t[y],q=void 0;for(q=0,de=n.length;q<de;q++)B===n[q]&&f++}return f>0?2*f/c:0}function Mp(h,r){for(var t=h.replace(/\s/g,""),n=r.replace(/\s/g,""),c=0,f=0,y=0;y<t.length;y++){var T=n.indexOf(t[y],f);-1!==T&&(c+=100-100*(f=T)/1e4*100)}return c}var Oa=Object.freeze({__proto__:null,fuzzyCheckStrings:ey,fuzzySuggestions:ty,get_bigrams:Ap,string_distances:Es,string_weighted_distances:Mp}),Uf={columnGroupOpened:"expanded",columnGroupClosed:"contracted",columnSelectClosed:"tree-closed",columnSelectOpen:"tree-open",columnSelectIndeterminate:"tree-indeterminate",columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",groupContracted:"tree-closed",groupExpanded:"tree-open",chart:"chart",close:"cross",cancel:"cancel",check:"tick",first:"first",previous:"previous",next:"next",last:"last",linked:"linked",unlinked:"unlinked",colorPicker:"color-picker",groupLoading:"loading",menu:"menu",filter:"filter",columns:"columns",maximize:"maximize",minimize:"minimize",menuPin:"pin",menuValue:"aggregation",menuAddRowGroup:"group",menuRemoveRowGroup:"group",clipboardCopy:"copy",clipboardPaste:"paste",pivotPanel:"pivot",rowGroupPanel:"group",valuePanel:"aggregation",columnDrag:"grip",rowDrag:"grip",save:"save",csvExport:"csv",excelExport:"excel",smallDown:"small-down",smallLeft:"small-left",smallRight:"small-right",smallUp:"small-up",sortAscending:"asc",sortDescending:"desc",sortUnSort:"none"};function qo(h,r,t){var n=Bi(h,r,t);if(n&&n.className.indexOf("ag-icon")>-1)return n;var c=document.createElement("span");return c.appendChild(n),c}function Bi(h,r,t,n){var c=null,f=t&&t.getColDef().icons;if(f&&(c=f[h]),r&&!c){var y=r.getIcons();y&&(c=y[h])}if(!c){var B=document.createElement("span"),q=Uf[h];return q||(n?q=h:(console.warn("AG Grid: Did not find icon "+h),q="")),B.setAttribute("class","ag-icon ag-icon-"+q),B.setAttribute("unselectable","on"),co(B,"presentation"),B}var T=void 0;if("function"==typeof c)T=c();else{if("string"!=typeof c)throw new Error("icon from grid options needs to be a string or a function");T=c}return"string"==typeof T?ua(T):Ea(T)?T:void console.warn("AG Grid: iconRenderer should return back a string or a dom object")}var Tp=Object.freeze({__proto__:null,iconNameClassMap:Uf,createIcon:qo,createIconNoSpan:Bi});function ku(h,r){return(h.which||h.keyCode)===r}function Rp(h){if(h.altKey||h.ctrlKey||h.metaKey)return!1;var r=1===h.key.length,t=function(h){return(El()||uo())&&"Del"===h.key&&46===h.charCode}(h);return r||t}function fo(h,r,t,n,c){var f=h.getSuppressKeyboardEventFunc(),y=n?n.getColDef().suppressKeyboardEvent:void 0;if(!f&&!y)return!1;var T={event:r,editing:c,column:n,api:h.getApi(),node:t,data:t.data,colDef:n.getColDef(),context:h.getContext(),columnApi:h.getColumnApi()};return!(!y||!y(T))||!!f&&f(T)}function Hf(h,r,t,n){var c=n.getDefinition(),f=c&&c.suppressHeaderKeyboardEvent;return!!v(f)&&!!f({api:h.getApi(),columnApi:h.getColumnApi(),context:h.getContext(),colDef:c,column:n,headerRowIndex:t,event:r})}var Wf=Object.freeze({__proto__:null,isKeyPressed:ku,isEventFromPrintableCharacter:Rp,isUserSuppressingKeyboardEvent:fo,isUserSuppressingHeaderKeyboardEvent:Hf});function Op(h,r,t){if(0===t)return!1;var n=Math.abs(h.clientX-r.clientX),c=Math.abs(h.clientY-r.clientY);return Math.max(n,c)<=t}var li=Object.freeze({__proto__:null,normalizeWheel:function(h){var c=0,f=0,y=0,T=0;return"detail"in h&&(f=h.detail),"wheelDelta"in h&&(f=-h.wheelDelta/120),"wheelDeltaY"in h&&(f=-h.wheelDeltaY/120),"wheelDeltaX"in h&&(c=-h.wheelDeltaX/120),"axis"in h&&h.axis===h.HORIZONTAL_AXIS&&(c=f,f=0),y=10*c,T=10*f,"deltaY"in h&&(T=h.deltaY),"deltaX"in h&&(y=h.deltaX),(y||T)&&h.deltaMode&&(1==h.deltaMode?(y*=40,T*=40):(y*=800,T*=800)),y&&!c&&(c=y<1?-1:1),T&&!f&&(f=T<1?-1:1),{spinX:c,spinY:f,pixelX:y,pixelY:T}},isLeftClick:function(h){return"buttons"in h?1==h.buttons:1==(h.which||h.button)},areEventsNear:Op}),Si=Object.freeze({__proto__:null,sortRowNodesByOrder:function(h,r){if(h){for(var t=function(B,q){var de=r[B.id],Se=r[q.id],ke=void 0!==de,je=void 0!==Se;return ke&&je?de-Se:ke||je?ke?1:-1:B.__objectId-q.__objectId},f=!1,y=0;y<h.length-1;y++)if(t(h[y],h[y+1])>0){f=!0;break}f&&h.sort(t)}},traverseNodesWithKey:function(h,r){var t=[];!function n(c){!c||c.forEach(function(f){if(f.group||f.hasChildren()){t.push(f.key);var y=t.join("|");r(f,y),n(f.childrenAfterGroup),t.pop()}})}(h)}});function jf(h){var r=new Set;return h.forEach(function(t){return r.add(t)}),r}var V4=Object.freeze({__proto__:null,convertToSet:jf}),ri=function(){return ri=Object.assign||function(h){for(var r,t=1,n=arguments.length;t<n;t++)for(var c in r=arguments[t])Object.prototype.hasOwnProperty.call(r,c)&&(h[c]=r[c]);return h},ri.apply(this,arguments)},wr=ri(ri(ri(ri(ri(ri(ri(ri(ri(ri(ri(ri(ri(ri(ri(ri(ri(ri(ri(ri({},Nu),G4),he),Aa),B4),Vf),vn),Zt),Fn),Oa),F),Tp),Wf),rr),li),En),He),Si),V4),Ue),$a=function(){function h(r,t){void 0===r&&(r=0),void 0===t&&(t=1),this.nextValue=r,this.step=t}return h.prototype.next=function(){var r=this.nextValue;return this.nextValue+=this.step,r},h.prototype.peek=function(){return this.nextValue},h.prototype.skip=function(r){this.nextValue+=r},h}();!function(h){h[h.IN_PROGRESS=0]="IN_PROGRESS",h[h.RESOLVED=1]="RESOLVED"}(e.Ws0||(e.Ws0={}));var Di=function(){function h(r){var t=this;this.status=e.Ws0.IN_PROGRESS,this.resolution=null,this.waiters=[],r(function(n){return t.onDone(n)},function(n){return t.onReject(n)})}return h.all=function(r){return new h(function(t){var n=r.length,c=new Array(n);se(r,function(f,y){f.then(function(T){c[y]=T,0==--n&&t(c)})})})},h.resolve=function(r){return void 0===r&&(r=null),new h(function(t){return t(r)})},h.prototype.then=function(r){var t=this;return new h(function(n){t.status===e.Ws0.RESOLVED?n(r(t.resolution)):t.waiters.push(function(c){return n(r(c))})})},h.prototype.resolveNow=function(r,t){return this.status===e.Ws0.RESOLVED?t(this.resolution):r},h.prototype.onDone=function(r){this.status=e.Ws0.RESOLVED,this.resolution=r,se(this.waiters,function(t){return t(r)})},h.prototype.onReject=function(r){console.warn("TBI")},h}(),Fp=(function(){function h(){this.timestamp=(new Date).getTime()}h.prototype.print=function(r){var t=(new Date).getTime()-this.timestamp;console.info(r+" = "+t),this.timestamp=(new Date).getTime()}}(),function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}()),Bu=function(){return Bu=Object.assign||function(h){for(var r,t=1,n=arguments.length;t<n;t++)for(var c in r=arguments[t])Object.prototype.hasOwnProperty.call(r,c)&&(h[c]=r[c]);return h},Bu.apply(this,arguments)},Gu=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Oi=function(){return function(h){h[h.NOTHING=0]="NOTHING",h[h.WAITING_TO_SHOW=1]="WAITING_TO_SHOW",h[h.SHOWING=2]="SHOWING"}(Oi||(Oi={})),Oi}(),q0=function(h){function r(t){var n=h.call(this)||this;return n.DEFAULT_HIDE_TOOLTIP_TIMEOUT=1e4,n.SHOW_QUICK_TOOLTIP_DIFF=1e3,n.FADE_OUT_TOOLTIP_TIMEOUT=1e3,n.state=Oi.NOTHING,n.tooltipInstanceCount=0,n.tooltipMouseTrack=!1,n.parentComp=t,n}return Fp(r,h),r.prototype.postConstruct=function(){this.tooltipShowDelay=this.gridOptionsWrapper.getTooltipShowDelay()||2e3,this.tooltipMouseTrack=this.gridOptionsWrapper.isTooltipMouseTrack();var t=this.parentComp.getGui();this.addManagedListener(t,"mouseenter",this.onMouseEnter.bind(this)),this.addManagedListener(t,"mouseleave",this.onMouseLeave.bind(this)),this.addManagedListener(t,"mousemove",this.onMouseMove.bind(this)),this.addManagedListener(t,"mousedown",this.onMouseDown.bind(this)),this.addManagedListener(t,"keydown",this.onKeyDown.bind(this))},r.prototype.destroy=function(){this.setToDoNothing(),h.prototype.destroy.call(this)},r.prototype.onMouseEnter=function(t){if(!bs()&&this.state==Oi.NOTHING){var n=this.isLastTooltipHiddenRecently()?200:this.tooltipShowDelay;this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),n),this.lastMouseEvent=t,this.state=Oi.WAITING_TO_SHOW}},r.prototype.onMouseLeave=function(){this.setToDoNothing()},r.prototype.onKeyDown=function(){this.setToDoNothing()},r.prototype.setToDoNothing=function(){this.state===Oi.SHOWING&&this.hideTooltip(),this.clearTimeouts(),this.state=Oi.NOTHING},r.prototype.onMouseMove=function(t){this.lastMouseEvent=t,this.tooltipMouseTrack&&this.state===Oi.SHOWING&&this.tooltipComp&&this.positionTooltipUnderLastMouseEvent()},r.prototype.onMouseDown=function(){this.setToDoNothing()},r.prototype.hideTooltip=function(){this.tooltipComp&&(this.destroyTooltipComp(),r.lastTooltipHideTime=(new Date).getTime()),this.state=Oi.NOTHING},r.prototype.destroyTooltipComp=function(){var t=this;Er(this.tooltipComp.getGui(),"ag-tooltip-hiding");var n=this.tooltipPopupDestroyFunc,c=this.tooltipComp;window.setTimeout(function(){n(),t.getContext().destroyBean(c)},this.FADE_OUT_TOOLTIP_TIMEOUT),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0},r.prototype.isLastTooltipHiddenRecently=function(){return(new Date).getTime()-r.lastTooltipHideTime<this.SHOW_QUICK_TOOLTIP_DIFF},r.prototype.showTooltip=function(){var t=Bu({api:this.gridApi,columnApi:this.columnApi,context:this.gridOptionsWrapper.getContext()},this.parentComp.getTooltipParams());if(v(t.value)){this.state=Oi.SHOWING,this.tooltipInstanceCount++;var n=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.userComponentFactory.getTooltipCompDetails(t).newAgStackInstance().then(n)}else this.setToDoNothing()},r.prototype.newTooltipComponentCallback=function(t,n){if(this.state!==Oi.SHOWING||this.tooltipInstanceCount!==t)this.getContext().destroyBean(n);else{var f=n.getGui();this.tooltipComp=n,qa(f,"ag-tooltip")||Er(f,"ag-tooltip-custom"),this.gridOptionsWrapper.isReactUi()&&Er(f,"ag-tooltip-reactui");var y=this.gridOptionsWrapper.getLocaleTextFunc(),T=this.popupService.addPopup({eChild:f,ariaLabel:y("ariaLabelTooltip","Tooltip")});T&&(this.tooltipPopupDestroyFunc=T.hideFunc),this.positionTooltipUnderLastMouseEvent(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.DEFAULT_HIDE_TOOLTIP_TIMEOUT)}},r.prototype.positionTooltipUnderLastMouseEvent=function(){this.popupService.positionPopupUnderMouseEvent({type:"tooltip",mouseEvent:this.lastMouseEvent,ePopup:this.tooltipComp.getGui(),nudgeY:18})},r.prototype.clearTimeouts=function(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0),this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)},Gu([Ee("popupService")],r.prototype,"popupService",void 0),Gu([Ee("userComponentFactory")],r.prototype,"userComponentFactory",void 0),Gu([Ee("columnApi")],r.prototype,"columnApi",void 0),Gu([Ee("gridApi")],r.prototype,"gridApi",void 0),Gu([zt],r.prototype,"postConstruct",null),r}(ct),Xf=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Yr=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},U4=new $a,dn=function(h){function r(t){var n=h.call(this)||this;return n.displayed=!0,n.visible=!0,n.compId=U4.next(),n.cssClassStates={},t&&n.setTemplate(t),n}return Xf(r,h),r.prototype.preConstructOnComponent=function(){this.usingBrowserTooltips=this.gridOptionsWrapper.isEnableBrowserTooltips()},r.prototype.getCompId=function(){return this.compId},r.prototype.getTooltipParams=function(){return{value:this.tooltipText,location:"UNKNOWN"}},r.prototype.setTooltip=function(t){var n=this;this.tooltipText!=t&&(this.tooltipText&&(n.usingBrowserTooltips?n.getGui().removeAttribute("title"):n.tooltipFeature=n.destroyBean(n.tooltipFeature)),null!=t&&(this.tooltipText=t,this.tooltipText&&(n.usingBrowserTooltips?n.getGui().setAttribute("title",n.tooltipText):n.tooltipFeature=n.createBean(new q0(n)))))},r.prototype.createChildComponentsFromTags=function(t,n){var c=this;se(Ri(t.childNodes),function(y){if(y instanceof HTMLElement){var T=c.createComponentFromElement(y,function(q){q.getGui()&&c.copyAttributesFromNode(y,q.getGui())},n);if(T){if(T.addItems&&y.children.length){c.createChildComponentsFromTags(y,n);var B=Array.prototype.slice.call(y.children);T.addItems(B)}c.swapComponentForNode(T,t,y)}else y.childNodes&&c.createChildComponentsFromTags(y,n)}})},r.prototype.createComponentFromElement=function(t,n,c){var f=t.nodeName,y=c?c[t.getAttribute("ref")]:void 0,T=this.agStackComponentsRegistry.getComponentClass(f);if(T){r.elementGettingCreated=t;var B=new T(y);return B.setParentComponent(this),this.createBean(B,null,n),B}return null},r.prototype.copyAttributesFromNode=function(t,n){Ms(t.attributes,function(c,f){return n.setAttribute(c,f)})},r.prototype.swapComponentForNode=function(t,n,c){var f=t.getGui();n.replaceChild(f,c),n.insertBefore(document.createComment(c.nodeName),f),this.addDestroyFunc(this.destroyBean.bind(this,t)),this.swapInComponentForQuerySelectors(t,c)},r.prototype.swapInComponentForQuerySelectors=function(t,n){var c=this;this.iterateOverQuerySelectors(function(f){c[f.attributeName]===n&&(c[f.attributeName]=t)})},r.prototype.iterateOverQuerySelectors=function(t){for(var n=Object.getPrototypeOf(this);null!=n;){var c=n.__agComponentMetaData,f=yt(n.constructor);c&&c[f]&&c[f].querySelectors&&se(c[f].querySelectors,function(y){return t(y)}),n=Object.getPrototypeOf(n)}},r.prototype.setTemplate=function(t,n){var c=ua(t);this.setTemplateFromElement(c,n)},r.prototype.setTemplateFromElement=function(t,n){this.eGui=t,this.eGui.__agComponent=this,this.wireQuerySelectors(),this.getContext()&&this.createChildComponentsFromTags(this.getGui(),n)},r.prototype.createChildComponentsPreConstruct=function(){this.getGui()&&this.createChildComponentsFromTags(this.getGui())},r.prototype.wireQuerySelectors=function(){var t=this;if(this.eGui){var n=this;this.iterateOverQuerySelectors(function(c){var f=function(q){return n[c.attributeName]=q};if(c.refSelector&&t.eGui.getAttribute("ref")===c.refSelector)f(t.eGui);else{var T=t.eGui.querySelector(c.querySelector);T&&f(T.__agComponent||T)}})}},r.prototype.getGui=function(){return this.eGui},r.prototype.getFocusableElement=function(){return this.eGui},r.prototype.setParentComponent=function(t){this.parentComponent=t},r.prototype.getParentComponent=function(){return this.parentComponent},r.prototype.setGui=function(t){this.eGui=t},r.prototype.queryForHtmlElement=function(t){return this.eGui.querySelector(t)},r.prototype.queryForHtmlInputElement=function(t){return this.eGui.querySelector(t)},r.prototype.appendChild=function(t,n){if(n||(n=this.eGui),null!=t)if(Ea(t))n.appendChild(t);else{var c=t;n.appendChild(c.getGui()),this.addDestroyFunc(this.destroyBean.bind(this,c))}},r.prototype.isDisplayed=function(){return this.displayed},r.prototype.setVisible=function(t){t!==this.visible&&(this.visible=t,Xn(this.eGui,t))},r.prototype.setDisplayed=function(t){t!==this.displayed&&(this.displayed=t,Nn(this.eGui,t),this.dispatchEvent({type:r.EVENT_DISPLAYED_CHANGED,visible:this.displayed}))},r.prototype.destroy=function(){this.tooltipFeature&&(this.tooltipFeature=this.destroyBean(this.tooltipFeature)),h.prototype.destroy.call(this)},r.prototype.addGuiEventListener=function(t,n){var c=this;this.eGui.addEventListener(t,n),this.addDestroyFunc(function(){return c.eGui.removeEventListener(t,n)})},r.prototype.addCssClass=function(t){!0!==this.cssClassStates[t]&&(Er(this.eGui,t),this.cssClassStates[t]=!0)},r.prototype.removeCssClass=function(t){!1!==this.cssClassStates[t]&&(zi(this.eGui,t),this.cssClassStates[t]=!1)},r.prototype.addOrRemoveCssClass=function(t,n){this.cssClassStates[t]!==n&&(Fr(this.eGui,t,n),this.cssClassStates[t]=n)},r.prototype.getAttribute=function(t){var n=this.eGui;return n?n.getAttribute(t):null},r.prototype.getRefElement=function(t){return this.queryForHtmlElement('[ref="'+t+'"]')},r.EVENT_DISPLAYED_CHANGED="displayedChanged",Yr([Ee("agStackComponentsRegistry")],r.prototype,"agStackComponentsRegistry",void 0),Yr([ro],r.prototype,"preConstructOnComponent",null),Yr([ro],r.prototype,"createChildComponentsPreConstruct",null),r}(ct);function Bt(h){return Yf.bind(this,"[ref="+h+"]",h)}function Yf(h,r,t,n,c){null!==h?"number"!=typeof c?function(h,r,t){var n=function(h,r){return h.__agComponentMetaData||(h.__agComponentMetaData={}),h.__agComponentMetaData[r]||(h.__agComponentMetaData[r]={}),h.__agComponentMetaData[r]}(h,yt(h.constructor));n[r]||(n[r]=[]),n[r].push(t)}(t,"querySelectors",{attributeName:n,querySelector:h,refSelector:r}):console.error("AG Grid: QuerySelector should be on an attribute"):console.error("AG Grid: QuerySelector selector should not be null")}var Wt=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Mn=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},es=function(h){function r(){return h.call(this,'\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field ref="eFloatingFilterText"></ag-input-text-field>\n            </div>')||this}return Wt(r,h),r.prototype.destroy=function(){h.prototype.destroy.call(this)},r.prototype.init=function(t){this.params=t;var n=this.columnModel.getDisplayNameForColumn(t.column,"header",!0),c=this.gridOptionsWrapper.getLocaleTextFunc();this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(n+" "+c("ariaFilterInput","Filter Input"))},r.prototype.onParentModelChanged=function(t){var n=this;t?this.params.parentFilterInstance(function(c){if(c.getModelAsString){var f=c.getModelAsString(t);n.eFloatingFilterText.setValue(f)}}):this.eFloatingFilterText.setValue("")},Mn([Bt("eFloatingFilterText")],r.prototype,"eFloatingFilterText",void 0),Mn([Ee("columnModel")],r.prototype,"columnModel",void 0),r}(dn),xi=function(){function h(r,t,n,c){var f=this;this.alive=!0,this.context=r,this.eParent=c,t.getDateCompDetails(n).newAgStackInstance().then(function(B){f.alive?(f.dateComp=B,B&&(c.appendChild(B.getGui()),B.afterGuiAttached&&B.afterGuiAttached(),f.tempValue&&B.setDate(f.tempValue),null!=f.disabled&&f.setDateCompDisabled(f.disabled))):r.destroyBean(B)})}return h.prototype.destroy=function(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)},h.prototype.getDate=function(){return this.dateComp?this.dateComp.getDate():this.tempValue},h.prototype.setDate=function(r){this.dateComp?this.dateComp.setDate(r):this.tempValue=r},h.prototype.setDisabled=function(r){this.dateComp?this.setDateCompDisabled(r):this.disabled=r},h.prototype.setDisplayed=function(r){Nn(this.eParent,r)},h.prototype.setInputPlaceholder=function(r){this.dateComp&&this.dateComp.setInputPlaceholder&&this.dateComp.setInputPlaceholder(r)},h.prototype.setInputAriaLabel=function(r){this.dateComp&&this.dateComp.setInputAriaLabel&&this.dateComp.setInputAriaLabel(r)},h.prototype.afterGuiAttached=function(r){this.dateComp&&"function"==typeof this.dateComp.afterGuiAttached&&this.dateComp.afterGuiAttached(r)},h.prototype.setDateCompDisabled=function(r){null!=this.dateComp&&null!=this.dateComp.setDisabled&&this.dateComp.setDisabled(r)},h}(),K0=function(){return K0=Object.assign||function(h){for(var r,t=1,n=arguments.length;t<n;t++)for(var c in r=arguments[t])Object.prototype.hasOwnProperty.call(r,c)&&(h[c]=r[c]);return h},K0.apply(this,arguments)},Il=function(){function h(){this.customFilterOptions={}}return h.prototype.init=function(r,t){this.filterOptions=r.filterOptions||t,this.mapCustomOptions(),this.selectDefaultItem(r),this.checkForDeprecatedParams()},h.prototype.checkForDeprecatedParams=function(){wr.some(this.filterOptions,function(r){return"string"!=typeof r&&null!=r.test})&&console.warn("AG Grid: [IFilterOptionDef] since v26.2.0, test() has been replaced with predicate()."),wr.some(this.filterOptions,function(r){return"string"!=typeof r&&null!=r.hideFilterInput})&&console.warn("AG Grid: [IFilterOptionDef] since v26.2.0, useOfHideFilterInput has been replaced with numberOfInputs.")},h.prototype.getFilterOptions=function(){return this.filterOptions},h.prototype.mapCustomOptions=function(){var r=this;!this.filterOptions||this.filterOptions.forEach(function(t){if("string"!=typeof t){if(!Y([["displayKey"],["displayName"],["predicate","test"]],function(B){return!!Z(B,function(q){return null!=t[q]})||(console.warn("AG Grid: ignoring FilterOptionDef as it doesn't contain one of '"+B+"'"),!1)}))return void(r.filterOptions=wr.filter(r.filterOptions,function(T){return T===t})||[]);var f=t.test,y=K0({},t);null!=f&&null==t.predicate&&(y.predicate=function(T,B){return f(T[0],B)},delete y.test),y.hideFilterInput&&null==y.numberOfInputs&&(y.numberOfInputs=0,delete y.hideFilterInput),r.customFilterOptions[t.displayKey]=y}})},h.prototype.selectDefaultItem=function(r){if(r.defaultOption)this.defaultOption=r.defaultOption;else if(this.filterOptions.length>=1){var t=this.filterOptions[0];"string"==typeof t?this.defaultOption=t:t.displayKey?this.defaultOption=t.displayKey:console.warn("AG Grid: invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'")}else console.warn("AG Grid: no filter options for filter")},h.prototype.getDefaultOption=function(){return this.defaultOption},h.prototype.getCustomOption=function(r){return this.customFilterOptions[r]},h}(),Pa={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose One",equals:"Equals",notEqual:"Not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"In range",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equals",greaterThanOrEqual:"Greater than or equals",contains:"Contains",notContains:"Not contains",startsWith:"Starts with",endsWith:"Ends with",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd"},Yt=function(){function h(){}return h.BACKSPACE=8,h.TAB=9,h.ENTER=13,h.SHIFT=16,h.ESCAPE=27,h.SPACE=32,h.LEFT=37,h.UP=38,h.RIGHT=39,h.DOWN=40,h.DELETE=46,h.A=65,h.C=67,h.V=86,h.D=68,h.Z=90,h.Y=89,h.F2=113,h.PAGE_UP=33,h.PAGE_DOWN=34,h.PAGE_HOME=36,h.PAGE_END=35,h}(),qf=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Lp=function(){return Lp=Object.assign||function(h){for(var r,t=1,n=arguments.length;t<n;t++)for(var c in r=arguments[t])Object.prototype.hasOwnProperty.call(r,c)&&(h[c]=r[c]);return h},Lp.apply(this,arguments)},Np=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Qo=function(h){function r(t,n){void 0===n&&(n={});var c=h.call(this)||this;return c.eFocusableElement=t,c.callbacks=n,c.callbacks=Lp({shouldStopEventPropagation:function(){return!1},onTabKeyDown:function(y){if(!y.defaultPrevented){var T=c.focusService.findNextFocusableElement(c.eFocusableElement,!1,y.shiftKey);!T||(T.focus(),y.preventDefault())}}},n),c}return qf(r,h),r.prototype.postConstruct=function(){Er(this.eFocusableElement,r.FOCUS_MANAGED_CLASS),this.addKeyDownListeners(this.eFocusableElement),this.callbacks.onFocusIn&&this.addManagedListener(this.eFocusableElement,"focusin",this.callbacks.onFocusIn),this.callbacks.onFocusOut&&this.addManagedListener(this.eFocusableElement,"focusout",this.callbacks.onFocusOut)},r.prototype.addKeyDownListeners=function(t){var n=this;this.addManagedListener(t,"keydown",function(c){if(!c.defaultPrevented&&!fr(c)){if(n.callbacks.shouldStopEventPropagation(c))return void kr(c);c.keyCode===Yt.TAB?n.callbacks.onTabKeyDown(c):n.callbacks.handleKeyDown&&n.callbacks.handleKeyDown(c)}})},r.FOCUS_MANAGED_CLASS="ag-focus-managed",Np([Ee("focusService")],r.prototype,"focusService",void 0),Np([zt],r.prototype,"postConstruct",null),r}(ct),Q0=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),oo=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Lo=function(h){function r(t){var n=h.call(this)||this;return n.filterNameKey=t,n.applyActive=!1,n.hidePopup=null,n.appliedModel=null,n}return Q0(r,h),r.prototype.postConstruct=function(){this.resetTemplate(),this.createManagedBean(new Qo(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)}))},r.prototype.handleKeyDown=function(t){},r.prototype.getFilterTitle=function(){return this.translate(this.filterNameKey)},r.prototype.onFilterChanged=function(){console.warn("AG Grid: you should not call onFilterChanged() directly on the filter, please call\n        gridApi.onFilterChanged() instead. onFilterChanged is not part of the exposed filter interface (it was\n        a method that existed on an old version of the filters that was not intended for public use."),this.providedFilterParams.filterChangedCallback()},r.prototype.isFilterActive=function(){return!!this.appliedModel},r.prototype.resetTemplate=function(t){var n='\n            <div class="ag-filter-wrapper">\n                <div class="ag-filter-body-wrapper ag-'+this.getCssIdentifier()+'-body-wrapper">\n                    '+this.createBodyTemplate()+"\n                </div>\n            </div>";this.setTemplate(n,t)},r.prototype.isReadOnly=function(){return!!this.providedFilterParams.readOnly},r.prototype.init=function(t){var n=this;this.setParams(t),this.resetUiToDefaults(!0).then(function(){n.updateUiVisibility(),n.setupOnBtApplyDebounce()})},r.prototype.setParams=function(t){r.checkForDeprecatedParams(t),this.providedFilterParams=t,this.newRowsActionKeep="keep"===t.newRowsAction||"clear"!==t.newRowsAction&&[W.ROW_MODEL_TYPE_SERVER_SIDE,W.ROW_MODEL_TYPE_INFINITE].indexOf(this.rowModel.getType())>=0,this.applyActive=r.isUseApplyButton(t),this.createButtonPanel()},r.prototype.createButtonPanel=function(){var t=this,n=this.providedFilterParams.buttons;if(!(!n||n.length<1||this.isReadOnly())){var c=document.createElement("div");Er(c,"ag-filter-apply-panel"),jf(n).forEach(function(y){return function(T){var B,q;switch(T){case"apply":B=t.translate("applyFilter"),q=function(ke){return t.onBtApply(!1,!1,ke)};break;case"clear":B=t.translate("clearFilter"),q=function(){return t.onBtClear()};break;case"reset":B=t.translate("resetFilter"),q=function(){return t.onBtReset()};break;case"cancel":B=t.translate("cancelFilter"),q=function(ke){t.onBtCancel(ke)};break;default:return void console.warn("Unknown button type specified")}var de=ua('<button\n                    type="button"\n                    ref="'+T+'FilterButton"\n                    class="ag-standard-button ag-filter-apply-panel-button"\n                >'+B+"\n                </button>");c.appendChild(de),t.addManagedListener(de,"click",q)}(y)}),this.getGui().appendChild(c)}},r.checkForDeprecatedParams=function(t){var n=t.buttons||[];if(!(n.length>0)){var c=t.applyButton,f=t.resetButton;t.clearButton&&(console.warn("AG Grid: as of AG Grid v23.2, filterParams.clearButton is deprecated. Please use filterParams.buttons instead"),n.push("clear")),f&&(console.warn("AG Grid: as of AG Grid v23.2, filterParams.resetButton is deprecated. Please use filterParams.buttons instead"),n.push("reset")),c&&(console.warn("AG Grid: as of AG Grid v23.2, filterParams.applyButton is deprecated. Please use filterParams.buttons instead"),n.push("apply")),t.apply&&(console.warn("AG Grid: as of AG Grid v21, filterParams.apply is deprecated. Please use filterParams.buttons instead"),n.push("apply")),t.buttons=n}},r.prototype.getDefaultDebounceMs=function(){return 0},r.prototype.setupOnBtApplyDebounce=function(){var t=r.getDebounceMs(this.providedFilterParams,this.getDefaultDebounceMs());this.onBtApplyDebounce=Sr(this.onBtApply.bind(this),t)},r.prototype.getModel=function(){return this.appliedModel},r.prototype.setModel=function(t){var n=this;return(t?this.setModelIntoUi(t):this.resetUiToDefaults()).then(function(){n.updateUiVisibility(),n.applyModel()})},r.prototype.onBtCancel=function(t){var n=this,c=this.getModel(),f=function(){n.onUiChanged(!1,"prevent"),n.providedFilterParams.closeOnApply&&n.close(t)};null!=c?this.setModelIntoUi(c).then(f):this.resetUiToDefaults().then(f)},r.prototype.onBtClear=function(){var t=this;this.resetUiToDefaults().then(function(){return t.onUiChanged()})},r.prototype.onBtReset=function(){this.onBtClear(),this.onBtApply()},r.prototype.applyModel=function(){var t=this.getModelFromUi();if(!this.isModelValid(t))return!1;var n=this.appliedModel;return this.appliedModel=t,!this.areModelsEqual(n,t)},r.prototype.isModelValid=function(t){return!0},r.prototype.onBtApply=function(t,n,c){void 0===t&&(t=!1),void 0===n&&(n=!1),this.applyModel()&&this.providedFilterParams.filterChangedCallback({afterFloatingFilter:t,afterDataChange:n}),this.providedFilterParams.closeOnApply&&this.applyActive&&!t&&!n&&this.close(c)},r.prototype.onNewRowsLoaded=function(){var t=this;this.newRowsActionKeep||this.resetUiToDefaults().then(function(){return t.appliedModel=null})},r.prototype.close=function(t){if(this.hidePopup){var f,c=t&&t.key;("Enter"===c||"Space"===c)&&(f={keyboardEvent:t}),this.hidePopup(f),this.hidePopup=null}},r.prototype.isNewRowsActionKeep=function(){return this.newRowsActionKeep},r.prototype.onUiChanged=function(t,n){if(void 0===t&&(t=!1),this.updateUiVisibility(),this.providedFilterParams.filterModifiedCallback(),this.applyActive&&!this.isReadOnly){var c=this.isModelValid(this.getModelFromUi());Ka(this.getRefElement("applyFilterButton"),!c)}t&&!n||"immediately"===n?this.onBtApply(t):(!this.applyActive&&!n||"debounce"===n)&&this.onBtApplyDebounce()},r.prototype.afterGuiAttached=function(t){null!=t&&(this.hidePopup=t.hidePopup)},r.getDebounceMs=function(t,n){return r.isUseApplyButton(t)?(null!=t.debounceMs&&console.warn("AG Grid: debounceMs is ignored when apply button is present"),0):null!=t.debounceMs?t.debounceMs:n},r.isUseApplyButton=function(t){return r.checkForDeprecatedParams(t),!!t.buttons&&t.buttons.indexOf("apply")>=0},r.prototype.destroy=function(){this.hidePopup=null,h.prototype.destroy.call(this)},r.prototype.translate=function(t){return this.gridOptionsWrapper.getLocaleTextFunc()(t,Pa[t])},r.prototype.getCellValue=function(t){return this.providedFilterParams.valueGetter(t)},oo([Ee("rowModel")],r.prototype,"rowModel",void 0),oo([zt],r.prototype,"postConstruct",null),r}(dn),Ip=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),ca=function(h){function r(t,n){var c=h.call(this,n)||this;return c.labelSeparator="",c.labelAlignment="left",c.label="",c.config=t||{},c}return Ip(r,h),r.prototype.postConstruct=function(){Er(this.getGui(),"ag-labeled"),Er(this.eLabel,"ag-label");var t=this.config,n=t.labelSeparator,c=t.label,f=t.labelWidth,y=t.labelAlignment;null!=n&&this.setLabelSeparator(n),null!=c&&this.setLabel(c),null!=f&&this.setLabelWidth(f),this.setLabelAlignment(y||this.labelAlignment),this.refreshLabel()},r.prototype.refreshLabel=function(){So(this.eLabel),"string"==typeof this.label?this.eLabel.innerText=this.label+this.labelSeparator:this.label&&this.eLabel.appendChild(this.label),""===this.label?(Er(this.eLabel,"ag-hidden"),co(this.eLabel,"presentation")):(zi(this.eLabel,"ag-hidden"),co(this.eLabel,null))},r.prototype.setLabelSeparator=function(t){return this.labelSeparator===t||(this.labelSeparator=t,null!=this.label&&this.refreshLabel()),this},r.prototype.getLabelId=function(){return this.eLabel.id=this.eLabel.id||"ag-"+this.getCompId()+"-label",this.eLabel.id},r.prototype.getLabel=function(){return this.label},r.prototype.setLabel=function(t){return this.label===t||(this.label=t,this.refreshLabel()),this},r.prototype.setLabelAlignment=function(t){var n=this.getGui();return Fr(n,"ag-label-align-left","left"===t),Fr(n,"ag-label-align-right","right"===t),Fr(n,"ag-label-align-top","top"===t),this},r.prototype.setLabelWidth=function(t){return null==this.label||_i(this.eLabel,t),this},function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);c>3&&f&&Object.defineProperty(r,t,f)}([zt],r.prototype,"postConstruct",null),r}(dn),ly=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),fa=function(h){function r(t,n,c){var f=h.call(this,t,n)||this;return f.className=c,f.disabled=!1,f}return ly(r,h),r.prototype.postConstruct=function(){h.prototype.postConstruct.call(this),this.className&&Er(this.getGui(),this.className)},r.prototype.onValueChange=function(t){var n=this;return this.addManagedListener(this,r.EVENT_CHANGED,function(){return t(n.getValue())}),this},r.prototype.getWidth=function(){return this.getGui().clientWidth},r.prototype.setWidth=function(t){return Ta(this.getGui(),t),this},r.prototype.getPreviousValue=function(){return this.previousValue},r.prototype.getValue=function(){return this.value},r.prototype.setValue=function(t,n){return this.value===t||(this.previousValue=this.value,this.value=t,n||this.dispatchEvent({type:r.EVENT_CHANGED})),this},r.prototype.setDisabled=function(t){t=!!t;var n=this.getGui();return Ka(n,t),Fr(n,"ag-disabled",t),this.disabled=t,this},r.prototype.isDisabled=function(){return!!this.disabled},r.EVENT_CHANGED="valueChange",r}(ca),uy=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),J0=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Z0=function(h){function r(t,n,c,f){var y=h.call(this,t,'<div class="ag-picker-field" role="presentation">\n                <div ref="eLabel"></div>\n                <div ref="eWrapper"\n                    class="ag-wrapper ag-picker-field-wrapper"\n                    tabIndex="-1"\n                    '+(f?'aria-haspopup="'+f+'"':"")+'\n                >\n                    <div ref="eDisplayField" class="ag-picker-field-display"></div>\n                    <div ref="eIcon" class="ag-picker-field-icon" aria-hidden="true"></div>\n                </div>\n            </div>',n)||this;return y.pickerIcon=c,y.isPickerDisplayed=!1,y.isDestroyingPicker=!1,y.skipClick=!1,y}return uy(r,h),r.prototype.postConstruct=function(){var t=this;h.prototype.postConstruct.call(this);var n=this.getCompId()+"-display";this.eDisplayField.setAttribute("id",n),To(this.eWrapper,n);var c=function(){t.skipClick?t.skipClick=!1:t.isDisabled()||(t.pickerComponent=t.showPicker())},f=this.getGui();if(this.addManagedListener(f,"mousedown",function(T){!t.skipClick&&t.pickerComponent&&t.pickerComponent.isAlive()&&Ol(t.pickerComponent.getGui())&&f.contains(T.target)&&(t.skipClick=!0)}),this.addManagedListener(f,"keydown",function(T){switch(T.keyCode){case Yt.UP:case Yt.DOWN:case Yt.ENTER:case Yt.SPACE:c();case Yt.ESCAPE:t.isPickerDisplayed&&T.preventDefault()}}),this.addManagedListener(this.eWrapper,"click",c),this.addManagedListener(this.eLabel,"click",c),this.pickerIcon){var y=Bi(this.pickerIcon,this.gridOptionsWrapper);y&&this.eIcon.appendChild(y)}},r.prototype.refreshLabel=function(){v(this.getLabel())?Nl(this.eWrapper,this.getLabelId()):this.eWrapper.removeAttribute("aria-labelledby"),h.prototype.refreshLabel.call(this)},r.prototype.setAriaLabel=function(t){return Da(this.eWrapper,t),this},r.prototype.setInputWidth=function(t){return _i(this.eWrapper,t),this},r.prototype.getFocusableElement=function(){return this.eWrapper},J0([Bt("eLabel")],r.prototype,"eLabel",void 0),J0([Bt("eWrapper")],r.prototype,"eWrapper",void 0),J0([Bt("eDisplayField")],r.prototype,"eDisplayField",void 0),J0([Bt("eIcon")],r.prototype,"eIcon",void 0),r}(fa),Kf=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),$0=function(h){function r(t){void 0===t&&(t="default");var n=h.call(this,'<div class="ag-list ag-'+t+'-list" role="listbox"></div>')||this;return n.cssIdentifier=t,n.options=[],n.itemEls=[],n}return Kf(r,h),r.prototype.init=function(){this.addManagedListener(this.getGui(),"keydown",this.handleKeyDown.bind(this))},r.prototype.handleKeyDown=function(t){var n=t.keyCode;switch(n){case Yt.ENTER:if(this.highlightedEl){var c=this.itemEls.indexOf(this.highlightedEl);this.setValueByIndex(c)}else this.setValue(this.getValue());break;case Yt.DOWN:case Yt.UP:var f=n===Yt.DOWN,y=void 0;if(t.preventDefault(),this.highlightedEl){var B=this.itemEls.indexOf(this.highlightedEl)+(f?1:-1);B=Math.min(Math.max(B,0),this.itemEls.length-1),y=this.itemEls[B]}else y=this.itemEls[f?0:this.itemEls.length-1];this.highlightItem(y)}},r.prototype.addOptions=function(t){var n=this;return t.forEach(function(c){return n.addOption(c)}),this},r.prototype.addOption=function(t){var n=t.value,f=Oe(t.text||n);return this.options.push({value:n,text:f}),this.renderOption(n,f),this},r.prototype.renderOption=function(t,n){var c=this,f=document.createElement("div");co(f,"option"),Er(f,"ag-list-item"),Er(f,"ag-"+this.cssIdentifier+"-list-item"),f.innerHTML="<span>"+n+"</span>",f.tabIndex=-1,this.itemEls.push(f),this.addManagedListener(f,"mouseover",function(){return c.highlightItem(f)}),this.addManagedListener(f,"mouseleave",function(){return c.clearHighlighted()}),this.addManagedListener(f,"click",function(){return c.setValue(t)}),this.getGui().appendChild(f)},r.prototype.setValue=function(t,n){if(this.value===t)return this.fireItemSelected(),this;if(null==t)return this.reset(),this;var c=$(this.options,function(y){return y.value===t});if(-1!==c){var f=this.options[c];this.value=f.value,this.displayValue=null!=f.text?f.text:f.value,this.highlightItem(this.itemEls[c]),n||this.fireChangeEvent()}return this},r.prototype.setValueByIndex=function(t){return this.setValue(this.options[t].value)},r.prototype.getValue=function(){return this.value},r.prototype.getDisplayValue=function(){return this.displayValue},r.prototype.refreshHighlighted=function(){var t=this;this.clearHighlighted();var n=$(this.options,function(c){return c.value===t.value});-1!==n&&this.highlightItem(this.itemEls[n])},r.prototype.reset=function(){this.value=null,this.displayValue=null,this.clearHighlighted(),this.fireChangeEvent()},r.prototype.highlightItem=function(t){!t.offsetParent||(this.clearHighlighted(),this.highlightedEl=t,Er(this.highlightedEl,r.ACTIVE_CLASS),Iu(this.highlightedEl,!0),this.highlightedEl.focus())},r.prototype.clearHighlighted=function(){!this.highlightedEl||!this.highlightedEl.offsetParent||(zi(this.highlightedEl,r.ACTIVE_CLASS),Iu(this.highlightedEl,!1),this.highlightedEl=null)},r.prototype.fireChangeEvent=function(){this.dispatchEvent({type:fa.EVENT_CHANGED}),this.fireItemSelected()},r.prototype.fireItemSelected=function(){this.dispatchEvent({type:r.EVENT_ITEM_SELECTED})},r.EVENT_ITEM_SELECTED="selectedItem",r.ACTIVE_CLASS="ag-active-item",function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);c>3&&f&&Object.defineProperty(r,t,f)}([zt],r.prototype,"init",null),r}(dn),cy=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Qf=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Bl=function(h){function r(t){return h.call(this,t,"ag-select","smallDown","listbox")||this}return cy(r,h),r.prototype.init=function(){var t=this;this.listComponent=this.createBean(new $0("select")),this.listComponent.setParentComponent(this),this.eWrapper.tabIndex=0,this.listComponent.addManagedListener(this.listComponent,$0.EVENT_ITEM_SELECTED,function(){t.hideList&&t.hideList()}),this.listComponent.addManagedListener(this.listComponent,fa.EVENT_CHANGED,function(){t.setValue(t.listComponent.getValue(),!1,!0),t.hideList&&t.hideList()})},r.prototype.showPicker=function(){var t=this,n=this.listComponent.getGui(),c=this.addManagedListener(document.body,"wheel",function(B){!n.contains(B.target)&&t.hideList&&t.hideList()}),f=this.addManagedListener(n,"focusout",function(B){!n.contains(B.relatedTarget)&&t.hideList&&t.hideList()}),y=this.gridOptionsWrapper.getLocaleTextFunc(),T=this.popupService.addPopup({modal:!0,eChild:n,closeOnEsc:!0,closedCallback:function(){t.hideList=null,t.isPickerDisplayed=!1,f(),c(),t.isAlive()&&t.getFocusableElement().focus()},ariaLabel:y("ariaLabelSelectField","Select Field")});return T&&(this.hideList=T.hideFunc),this.isPickerDisplayed=!0,_i(n,z0(this.eWrapper)),n.style.maxHeight=Dl(this.popupService.getPopupParent())+"px",n.style.position="absolute",this.popupService.positionPopupUnderComponent({type:"ag-list",eventSource:this.eWrapper,ePopup:n,keepWithinBounds:!0}),this.listComponent.refreshHighlighted(),this.listComponent},r.prototype.addOptions=function(t){var n=this;return t.forEach(function(c){return n.addOption(c)}),this},r.prototype.addOption=function(t){return this.listComponent.addOption(t),this},r.prototype.setValue=function(t,n,c){return this.value===t?this:(c||this.listComponent.setValue(t,!0),this.listComponent.getValue()===this.getValue()?this:(this.eDisplayField.innerHTML=this.listComponent.getDisplayValue(),h.prototype.setValue.call(this,t,n)))},r.prototype.destroy=function(){this.hideList&&this.hideList(),this.destroyBean(this.listComponent),h.prototype.destroy.call(this)},Qf([Ee("popupService")],r.prototype,"popupService",void 0),Qf([zt],r.prototype,"init",null),r}(Z0),Bp=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),ec=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Fa=function(h){function r(t,n,c,f){void 0===c&&(c="text"),void 0===f&&(f="input");var y=h.call(this,t,'\n            <div role="presentation">\n                <div ref="eLabel" class="ag-input-field-label"></div>\n                <div ref="eWrapper" class="ag-wrapper ag-input-wrapper" role="presentation">\n                    <'+f+' ref="eInput" class="ag-input-field-input"></'+f+">\n                </div>\n            </div>",n)||this;return y.inputType=c,y.displayFieldTag=f,y}return Bp(r,h),r.prototype.postConstruct=function(){h.prototype.postConstruct.call(this),this.setInputType(),Er(this.eLabel,this.className+"-label"),Er(this.eWrapper,this.className+"-input-wrapper"),Er(this.eInput,this.className+"-input"),Er(this.getGui(),"ag-input-field"),this.eInput.id=this.eInput.id||"ag-"+this.getCompId()+"-input";var t=this.config,n=t.width,c=t.value;null!=n&&this.setWidth(n),null!=c&&this.setValue(c),this.addInputListeners()},r.prototype.refreshLabel=function(){v(this.getLabel())?Nl(this.eInput,this.getLabelId()):this.eInput.removeAttribute("aria-labelledby"),h.prototype.refreshLabel.call(this)},r.prototype.addInputListeners=function(){var t=this;this.addManagedListener(this.eInput,"input",function(n){return t.setValue(n.target.value)})},r.prototype.setInputType=function(){"input"===this.displayFieldTag&&this.eInput.setAttribute("type",this.inputType)},r.prototype.getInputElement=function(){return this.eInput},r.prototype.setInputWidth=function(t){return _i(this.eWrapper,t),this},r.prototype.setInputName=function(t){return this.getInputElement().setAttribute("name",t),this},r.prototype.getFocusableElement=function(){return this.eInput},r.prototype.setMaxLength=function(t){return this.eInput.maxLength=t,this},r.prototype.setInputPlaceholder=function(t){return Ja(this.eInput,"placeholder",t),this},r.prototype.setInputAriaLabel=function(t){return Da(this.eInput,t),this},r.prototype.setDisabled=function(t){return Ka(this.eInput,t),h.prototype.setDisabled.call(this,t)},ec([Bt("eLabel")],r.prototype,"eLabel",void 0),ec([Bt("eWrapper")],r.prototype,"eWrapper",void 0),ec([Bt("eInput")],r.prototype,"eInput",void 0),r}(fa),Gp=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),La=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Xi=function(){return function(h){h[h.One=0]="One",h[h.Two=1]="Two"}(Xi||(Xi={})),Xi}(),ho=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return Gp(r,h),r.prototype.getNumberOfInputs=function(t){var n=this.optionsFactory.getCustomOption(t);if(n){var c=n.numberOfInputs;return null!=c?c:1}return t===r.EMPTY?0:t===r.IN_RANGE?2:1},r.prototype.onFloatingFilterChanged=function(t,n){this.setTypeFromFloatingFilter(t),this.setValueFromFloatingFilter(n),this.onUiChanged(!0)},r.prototype.setTypeFromFloatingFilter=function(t){this.eType1.setValue(t),this.eType2.setValue(this.optionsFactory.getDefaultOption()),(this.isDefaultOperator("AND")?this.eJoinOperatorAnd:this.eJoinOperatorOr).setValue(!0)},r.prototype.getModelFromUi=function(){return this.isConditionUiComplete(Xi.One)?this.isAllowTwoConditions()&&this.isConditionUiComplete(Xi.Two)?{filterType:this.getFilterType(),operator:this.getJoinOperator(),condition1:this.createCondition(Xi.One),condition2:this.createCondition(Xi.Two)}:this.createCondition(Xi.One):null},r.prototype.getConditionTypes=function(){return[this.eType1.getValue(),this.eType2.getValue()]},r.prototype.getJoinOperator=function(){return!0===this.eJoinOperatorOr.getValue()?"OR":"AND"},r.prototype.areModelsEqual=function(t,n){if(!t&&!n)return!0;if(!t&&n||t&&!n)return!1;var T,c=!t.operator,f=!n.operator;if(!c&&f||c&&!f)return!1;if(c)T=this.areSimpleModelsEqual(t,n);else{var de=t,Se=n;T=de.operator===Se.operator&&this.areSimpleModelsEqual(de.condition1,Se.condition1)&&this.areSimpleModelsEqual(de.condition2,Se.condition2)}return T},r.prototype.setModelIntoUi=function(t){if(t.operator){var c=t,f="OR"===c.operator;this.eJoinOperatorAnd.setValue(!f),this.eJoinOperatorOr.setValue(f),this.eType1.setValue(c.condition1.type),this.eType2.setValue(c.condition2.type),this.setConditionIntoUi(c.condition1,Xi.One),this.setConditionIntoUi(c.condition2,Xi.Two)}else{var y=t;this.eJoinOperatorAnd.setValue(this.isDefaultOperator("AND")),this.eJoinOperatorOr.setValue(this.isDefaultOperator("OR")),this.eType1.setValue(y.type),this.eType2.setValue(this.optionsFactory.getDefaultOption()),this.setConditionIntoUi(y,Xi.One),this.setConditionIntoUi(null,Xi.Two)}return Di.resolve()},r.prototype.doesFilterPass=function(t){var n=this,c=this.getModel();if(null==c)return!0;var f=c.operator,y=[];return f?y.push(c.condition1,c.condition2):y.push(c),(f&&"OR"===f?Z:Y)(y,function(q){return n.individualConditionPasses(t,q)})},r.prototype.setParams=function(t){h.prototype.setParams.call(this,t),this.optionsFactory=new Il,this.optionsFactory.init(t,this.getDefaultFilterOptions()),this.allowTwoConditions=!t.suppressAndOrCondition,this.alwaysShowBothConditions=!!t.alwaysShowBothConditions,this.defaultJoinOperator=this.getDefaultJoinOperator(t.defaultJoinOperator),this.putOptionsIntoDropdown(),this.addChangedListeners()},r.prototype.getDefaultJoinOperator=function(t){return oe(["AND","OR"],t)?t:"AND"},r.prototype.putOptionsIntoDropdown=function(){var t=this,n=this.optionsFactory.getFilterOptions(),c=[this.eType1,this.eType2];se(n,function(f){var y="string"==typeof f?t.createBoilerplateListOption(f):t.createCustomListOption(f);se(c,function(T){return T.addOption(y)})}),se(c,function(f){return f.setDisabled(n.length<=1)})},r.prototype.createBoilerplateListOption=function(t){return{value:t,text:this.translate(t)}},r.prototype.createCustomListOption=function(t){var n=t.displayKey,c=this.optionsFactory.getCustomOption(t.displayKey);return{value:n,text:c?this.gridOptionsWrapper.getLocaleTextFunc()(c.displayKey,c.displayName):this.translate(n)}},r.prototype.isAllowTwoConditions=function(){return this.allowTwoConditions},r.prototype.createBodyTemplate=function(){return'\n            <ag-select class="ag-filter-select" ref="eOptions1"></ag-select>\n            '+this.createValueTemplate(Xi.One)+'\n            <div class="ag-filter-condition" ref="eJoinOperatorPanel">\n               <ag-radio-button ref="eJoinOperatorAnd" class="ag-filter-condition-operator ag-filter-condition-operator-and"></ag-radio-button>\n               <ag-radio-button ref="eJoinOperatorOr" class="ag-filter-condition-operator ag-filter-condition-operator-or"></ag-radio-button>\n            </div>\n            <ag-select class="ag-filter-select" ref="eOptions2"></ag-select>\n            '+this.createValueTemplate(Xi.Two)},r.prototype.getCssIdentifier=function(){return"simple-filter"},r.prototype.updateUiVisibility=function(){var t=this,c=[this.eCondition1Body,this.eCondition2Body];se([[this.eType1],[this.eType2,this.eJoinOperatorPanel,this.eJoinOperatorAnd,this.eJoinOperatorOr]],function(f,y){var T=t.isConditionVisible(y),B=t.isConditionDisabled(y);se(f,function(q){q instanceof Fa||q instanceof Bl?(q.setDisabled(B),q.setDisplayed(T)):(Ka(q,B),Nn(q,T))})}),se(c,function(f,y){Nn(f,t.isConditionBodyVisible(y))}),this.forEachInput(function(f,y,T,B){t.setElementDisplayed(f,y<B),t.setElementDisabled(f,t.isConditionDisabled(T))}),this.resetPlaceholder()},r.prototype.afterGuiAttached=function(t){if(h.prototype.afterGuiAttached.call(this,t),this.resetPlaceholder(),!t||!t.suppressFocus&&!this.isReadOnly()){var n=this.getInputs()[0][0];if(!n)return;n instanceof Fa&&n.getInputElement().focus()}},r.prototype.resetPlaceholder=function(){var t=this,n=this.gridOptionsWrapper.getLocaleTextFunc();this.forEachInput(function(c,f,y,T){if(c instanceof Fa){var B=0===f&&T>1?"inRangeStart":0===f?"filterOoo":"inRangeEnd",q=0===f&&T>1?n("ariaFilterFromValue","Filter from value"):0===f?n("ariaFilterValue","Filter Value"):n("ariaFilterToValue","Filter to Value");c.setInputPlaceholder(t.translate(B)),c.setInputAriaLabel(q)}})},r.prototype.setElementValue=function(t,n,c){t instanceof Fa&&t.setValue(n?String(n):null,c)},r.prototype.setElementDisplayed=function(t,n){t instanceof dn&&Nn(t.getGui(),n)},r.prototype.setElementDisabled=function(t,n){t instanceof dn&&Ka(t.getGui(),n)},r.prototype.attachElementOnChange=function(t,n){t instanceof Fa&&t.onValueChange(n)},r.prototype.forEachInput=function(t){var n=this,c=this.getInputs();this.getConditionTypes().forEach(function(f,y){for(var T=n.getNumberOfInputs(f),B=0;B<c[y].length;B++){var q=c[y][B];null!=q&&t(q,B,y,T)}})},r.prototype.isConditionVisible=function(t){return 0===t||!!this.allowTwoConditions&&(this.isReadOnly()?this.isConditionUiComplete(t):!!this.alwaysShowBothConditions||this.isConditionUiComplete(t-1))},r.prototype.isConditionDisabled=function(t){return!(!this.isReadOnly()&&this.isConditionVisible(t))||0!==t&&!this.isConditionUiComplete(t-1)},r.prototype.isConditionBodyVisible=function(t){if(!this.isConditionVisible(t))return!1;var n=this.getConditionTypes()[t];return this.getNumberOfInputs(n)>0},r.prototype.isConditionUiComplete=function(t){return!(this.getConditionTypes()[t]===r.EMPTY||wr.some(this.getValues(t),function(c){return null==c}))},r.prototype.resetUiToDefaults=function(t){var n=this,f=this.gridOptionsWrapper.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator"),y="ag-simple-filter-and-or-"+this.getCompId(),T=this.optionsFactory.getDefaultOption();return this.eType1.setValue(T,t).setAriaLabel(f).setDisabled(this.isReadOnly()),this.eType2.setValue(this.optionsFactory.getDefaultOption(),t).setAriaLabel(f).setDisabled(this.isReadOnly()),this.eJoinOperatorAnd.setValue(this.isDefaultOperator("AND"),t).setName(y).setLabel(this.translate("andCondition")).setDisabled(this.isReadOnly()),this.eJoinOperatorOr.setValue(this.isDefaultOperator("OR"),t).setName(y).setLabel(this.translate("orCondition")).setDisabled(this.isReadOnly()),this.forEachInput(function(B){n.setElementValue(B,null,t),n.setElementDisabled(B,n.isReadOnly())}),this.resetPlaceholder(),Di.resolve()},r.prototype.setConditionIntoUi=function(t,n){var c=this,f=this.mapValuesFromModel(t);this.forEachInput(function(y,T,B,q){B===n&&c.setElementValue(y,f[T]?f[T]:null)})},r.prototype.setValueFromFloatingFilter=function(t){var n=this;this.forEachInput(function(c,f,y,T){n.setElementValue(c,0===f&&0===y?t:null)})},r.prototype.isDefaultOperator=function(t){return t===this.defaultJoinOperator},r.prototype.addChangedListeners=function(){var t=this;if(!this.isReadOnly()){var n=function(){return t.onUiChanged()};this.eType1.onValueChange(n),this.eType2.onValueChange(n),this.eJoinOperatorOr.onValueChange(n),this.eJoinOperatorAnd.onValueChange(n),this.forEachInput(function(c){t.attachElementOnChange(c,n)})}},r.prototype.individualConditionPasses=function(t,n){var c=this.getCellValue(t.node),f=this.mapValuesFromModel(n),y=this.optionsFactory.getCustomOption(n.type),T=this.evaluateCustomFilter(y,f,c);return null!=T?T:null==c?this.evaluateNullValue(n.type):this.evaluateNonNullValue(f,c,n)},r.prototype.evaluateCustomFilter=function(t,n,c){if(null!=t){var f=t.predicate;if(null!=f&&!wr.some(n,function(y){return null==y}))return f(n,c)}},r.EMPTY="empty",r.EQUALS="equals",r.NOT_EQUAL="notEqual",r.LESS_THAN="lessThan",r.LESS_THAN_OR_EQUAL="lessThanOrEqual",r.GREATER_THAN="greaterThan",r.GREATER_THAN_OR_EQUAL="greaterThanOrEqual",r.IN_RANGE="inRange",r.CONTAINS="contains",r.NOT_CONTAINS="notContains",r.STARTS_WITH="startsWith",r.ENDS_WITH="endsWith",La([Bt("eOptions1")],r.prototype,"eType1",void 0),La([Bt("eOptions2")],r.prototype,"eType2",void 0),La([Bt("eJoinOperatorPanel")],r.prototype,"eJoinOperatorPanel",void 0),La([Bt("eJoinOperatorAnd")],r.prototype,"eJoinOperatorAnd",void 0),La([Bt("eJoinOperatorOr")],r.prototype,"eJoinOperatorOr",void 0),La([Bt("eCondition1Body")],r.prototype,"eCondition1Body",void 0),La([Bt("eCondition2Body")],r.prototype,"eCondition2Body",void 0),r}(Lo),po=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),ui=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return po(r,h),r.prototype.setParams=function(t){h.prototype.setParams.call(this,t),this.scalarFilterParams=t,this.checkDeprecatedParams()},r.prototype.checkDeprecatedParams=function(){this.scalarFilterParams.nullComparator&&(console.warn("AG Grid: Since v21.0, the property filterParams.nullComparator is deprecated. Please use filterParams.includeBlanksInEquals, filterParams.includeBlanksInLessThan and filterParams.includeBlanksInGreaterThan instead."),this.scalarFilterParams.includeBlanksInEquals=this.scalarFilterParams.nullComparator.equals,this.scalarFilterParams.includeBlanksInLessThan=this.scalarFilterParams.nullComparator.lessThan,this.scalarFilterParams.includeBlanksInGreaterThan=this.scalarFilterParams.nullComparator.greaterThan)},r.prototype.evaluateNullValue=function(t){switch(t){case r.EQUALS:case r.NOT_EQUAL:if(this.scalarFilterParams.includeBlanksInEquals)return!0;break;case r.GREATER_THAN:case r.GREATER_THAN_OR_EQUAL:if(this.scalarFilterParams.includeBlanksInGreaterThan)return!0;break;case r.LESS_THAN:case r.LESS_THAN_OR_EQUAL:if(this.scalarFilterParams.includeBlanksInLessThan)return!0;break;case r.IN_RANGE:if(this.scalarFilterParams.includeBlanksInRange)return!0}return!1},r.prototype.evaluateNonNullValue=function(t,n,c){var f=this.comparator(),y=f(t[0],n);switch(c.type){case r.EQUALS:return 0===y;case r.NOT_EQUAL:return 0!==y;case r.GREATER_THAN:return y>0;case r.GREATER_THAN_OR_EQUAL:return y>=0;case r.LESS_THAN:return y<0;case r.LESS_THAN_OR_EQUAL:return y<=0;case r.IN_RANGE:var T=f(t[1],n);return this.scalarFilterParams.inRangeInclusive?y>=0&&T<=0:y>0&&T<0;default:return console.warn('AG Grid: Unexpected type of filter "'+c.type+'", it looks like the filter was configured with incorrect Filter Options'),!0}},r}(ho),ci=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),tc=function(){return tc=Object.assign||function(h){for(var r,t=1,n=arguments.length;t<n;t++)for(var c in r=arguments[t])Object.prototype.hasOwnProperty.call(r,c)&&(h[c]=r[c]);return h},tc.apply(this,arguments)},Vu=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Jf=function(h){function r(){var t=h.call(this,"dateFilter")||this;return t.minValidYear=1e3,t.maxValidYear=1/0,t}return ci(r,h),r.prototype.afterGuiAttached=function(t){h.prototype.afterGuiAttached.call(this,t),this.dateCondition1FromComp.afterGuiAttached(t)},r.prototype.mapValuesFromModel=function(t){var n=t||{},c=n.dateFrom,f=n.dateTo,y=n.type;return[c&&Za(c)||null,f&&Za(f)||null].slice(0,this.getNumberOfInputs(y))},r.prototype.comparator=function(){return this.dateFilterParams.comparator?this.dateFilterParams.comparator:this.defaultComparator.bind(this)},r.prototype.defaultComparator=function(t,n){return null==n||n<t?-1:n>t?1:0},r.prototype.setParams=function(t){h.prototype.setParams.call(this,t),this.dateFilterParams=t;var n=function(f,y){if(null!=t[f]){if(!isNaN(t[f]))return null==t[f]?y:Number(t[f]);console.warn("AG Grid: DateFilter "+f+" is not a number")}return y};this.minValidYear=n("minValidYear",1e3),this.maxValidYear=n("maxValidYear",1/0),this.minValidYear>this.maxValidYear&&console.warn("AG Grid: DateFilter minValidYear should be <= maxValidYear"),this.createDateComponents()},r.prototype.createDateComponents=function(){var t=this,n=function(f){return new xi(t.getContext(),t.userComponentFactory,{onDateChanged:function(){return t.onUiChanged()},filterParams:t.dateFilterParams},f)};this.dateCondition1FromComp=n(this.eCondition1PanelFrom),this.dateCondition1ToComp=n(this.eCondition1PanelTo),this.dateCondition2FromComp=n(this.eCondition2PanelFrom),this.dateCondition2ToComp=n(this.eCondition2PanelTo),this.addDestroyFunc(function(){t.forEachInput(function(c){return c.destroy()})})},r.prototype.setElementValue=function(t,n,c){t.setDate(n)},r.prototype.setElementDisplayed=function(t,n){t.setDisplayed(n)},r.prototype.setElementDisabled=function(t,n){t.setDisabled(n)},r.prototype.getDefaultFilterOptions=function(){return r.DEFAULT_FILTER_OPTIONS},r.prototype.createValueTemplate=function(t){var n=t===Xi.One?"1":"2";return'\n            <div class="ag-filter-body" ref="eCondition'+n+'Body">\n                <div class="ag-filter-from ag-filter-date-from" ref="eCondition'+n+'PanelFrom"></div>\n                <div class="ag-filter-to ag-filter-date-to" ref="eCondition'+n+'PanelTo"></div>\n            </div>'},r.prototype.isConditionUiComplete=function(t){var n=this;if(!h.prototype.isConditionUiComplete.call(this,t))return!1;var f=!0;return this.forEachInput(function(y,T,B,q){B!==t||!f||T>=q||(f=f&&function(T){return null!=T&&T.getUTCFullYear()>=n.minValidYear&&T.getUTCFullYear()<=n.maxValidYear}(y.getDate()))}),f},r.prototype.areSimpleModelsEqual=function(t,n){return t.dateFrom===n.dateFrom&&t.dateTo===n.dateTo&&t.type===n.type},r.prototype.getFilterType=function(){return"date"},r.prototype.createCondition=function(t){var n=this.getConditionTypes()[t],c={},f=this.getValues(t);return f.length>0&&(c.dateFrom=rl(f[0])),f.length>1&&(c.dateTo=rl(f[1])),tc({dateFrom:null,dateTo:null,filterType:this.getFilterType(),type:n},c)},r.prototype.resetPlaceholder=function(){var t=this.gridOptionsWrapper.getLocaleTextFunc(),n=this.translate("dateFormatOoo"),c=t("ariaFilterValue","Filter Value");this.forEachInput(function(f){f.setInputPlaceholder(n),f.setInputAriaLabel(c)})},r.prototype.getInputs=function(){return[[this.dateCondition1FromComp,this.dateCondition1ToComp],[this.dateCondition2FromComp,this.dateCondition2ToComp]]},r.prototype.getValues=function(t){var n=[];return this.forEachInput(function(c,f,y,T){t===y&&f<T&&n.push(c.getDate())}),n},r.DEFAULT_FILTER_OPTIONS=[ui.EQUALS,ui.GREATER_THAN,ui.LESS_THAN,ui.NOT_EQUAL,ui.IN_RANGE],Vu([Bt("eCondition1PanelFrom")],r.prototype,"eCondition1PanelFrom",void 0),Vu([Bt("eCondition1PanelTo")],r.prototype,"eCondition1PanelTo",void 0),Vu([Bt("eCondition2PanelFrom")],r.prototype,"eCondition2PanelFrom",void 0),Vu([Bt("eCondition2PanelTo")],r.prototype,"eCondition2PanelTo",void 0),Vu([Ee("userComponentFactory")],r.prototype,"userComponentFactory",void 0),r}(ui),fy=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Uu=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return fy(r,h),r.prototype.getDefaultDebounceMs=function(){return 0},r.prototype.destroy=function(){h.prototype.destroy.call(this)},r.prototype.getTextFromModel=function(t){if(!t)return null;if(null!=t.operator){var c=t,f=c||{},y=f.condition1,T=f.condition2,B=this.optionsFactory.getCustomOption(y.type),q=this.optionsFactory.getCustomOption(T.type);return[this.conditionToString(y,B),c.operator,this.conditionToString(T,q)].join(" ")}var de=t,Se=this.optionsFactory.getCustomOption(de.type),ke=Se||{},je=ke.displayKey,Qe=ke.displayName;return je&&Qe&&0===ke.numberOfInputs?(this.gridOptionsWrapper.getLocaleTextFunc()(je,Qe),Qe):this.conditionToString(de,Se)},r.prototype.isEventFromFloatingFilter=function(t){return t&&t.afterFloatingFilter},r.prototype.getLastType=function(){return this.lastType},r.prototype.isReadOnly=function(){return this.readOnly},r.prototype.setLastTypeFromModel=function(t){t?this.lastType=(t.operator?t.condition1:t).type:this.lastType=this.optionsFactory.getDefaultOption()},r.prototype.canWeEditAfterModelFromParentFilter=function(t){return t?!t.operator&&this.isTypeEditable(t.type):this.isTypeEditable(this.lastType)},r.prototype.init=function(t){this.optionsFactory=new Il,this.optionsFactory.init(t.filterParams,this.getDefaultFilterOptions()),this.lastType=this.optionsFactory.getDefaultOption(),this.readOnly=!!t.filterParams.readOnly;var n=this.isTypeEditable(this.lastType);this.setEditable(n)},r.prototype.doesFilterHaveSingleInput=function(t){var c=(this.optionsFactory.getCustomOption(t)||{}).numberOfInputs;return null==c||1==c},r.prototype.isTypeEditable=function(t){return!!t&&!this.isReadOnly()&&this.doesFilterHaveSingleInput(t)&&t!==ho.IN_RANGE&&t!==ho.EMPTY},r}(dn),rc=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Gl=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Zf=function(h){function r(){return h.call(this,'\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field ref="eReadOnlyText"></ag-input-text-field>\n                <div ref="eDateWrapper" style="display: flex;"></div>\n            </div>')||this}return rc(r,h),r.prototype.getDefaultFilterOptions=function(){return Jf.DEFAULT_FILTER_OPTIONS},r.prototype.conditionToString=function(t,n){var c=t.type,y=c==ho.IN_RANGE||2===(n||{}).numberOfInputs,T=Za(t.dateFrom),B=Za(t.dateTo);return y?rl(T,!1)+"-"+rl(B,!1):null!=T?""+rl(T,!1):""+c},r.prototype.init=function(t){h.prototype.init.call(this,t),this.params=t,this.createDateComponent();var n=this.gridOptionsWrapper.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(n("ariaDateFilterInput","Date Filter Input"))},r.prototype.setEditable=function(t){Nn(this.eDateWrapper,t),Nn(this.eReadOnlyText.getGui(),!t)},r.prototype.onParentModelChanged=function(t,n){if(!this.isEventFromFloatingFilter(n)){h.prototype.setLastTypeFromModel.call(this,t);var c=!this.isReadOnly()&&this.canWeEditAfterModelFromParentFilter(t);this.setEditable(c),c?(this.dateComp.setDate(t?Za(t.dateFrom):null),this.eReadOnlyText.setValue("")):(this.eReadOnlyText.setValue(this.getTextFromModel(t)),this.dateComp.setDate(null))}},r.prototype.onDateChanged=function(){var t=this,c=rl(this.dateComp.getDate());this.params.parentFilterInstance(function(f){f&&f.onFloatingFilterChanged(t.getLastType(),Za(c))})},r.prototype.createDateComponent=function(){var t=this,n=Lo.getDebounceMs(this.params.filterParams,this.getDefaultDebounceMs()),c={onDateChanged:Sr(this.onDateChanged.bind(this),n),filterParams:this.params.column.getColDef().filterParams};this.dateComp=new xi(this.getContext(),this.userComponentFactory,c,this.eDateWrapper),this.addDestroyFunc(function(){return t.dateComp.destroy()})},Gl([Ee("userComponentFactory")],r.prototype,"userComponentFactory",void 0),Gl([Bt("eReadOnlyText")],r.prototype,"eReadOnlyText",void 0),Gl([Bt("eDateWrapper")],r.prototype,"eDateWrapper",void 0),r}(Uu),Hp=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Rs=function(h){function r(){return h.call(this,'\n            <div class="ag-filter-filter">\n                <ag-input-text-field class="ag-date-filter" ref="eDateInput"></ag-input-text-field>\n            </div>')||this}return Hp(r,h),r.prototype.destroy=function(){h.prototype.destroy.call(this)},r.prototype.init=function(t){var n=this,c=this.eDateInput.getInputElement();this.shouldUseBrowserDatePicker(t)&&(uo()?console.warn("ag-grid: browserDatePicker is specified to true, but it is not supported in IE 11; reverting to text date picker"):c.type="date"),this.addManagedListener(c,"mousedown",function(){n.eDateInput.isDisabled()||c.focus()}),this.addManagedListener(c,"input",function(B){B.target===document.activeElement&&(n.eDateInput.isDisabled()||t.onDateChanged())});var f=t.filterParams||{},y=f.minValidYear,T=f.maxValidYear;y&&(c.min=y+"-01-01"),T&&(c.max=T+"-12-31")},r.prototype.getDate=function(){return Za(this.eDateInput.getValue())},r.prototype.setDate=function(t){this.eDateInput.setValue(rl(t,!1))},r.prototype.setInputPlaceholder=function(t){this.eDateInput.setInputPlaceholder(t)},r.prototype.setDisabled=function(t){this.eDateInput.setDisabled(t)},r.prototype.afterGuiAttached=function(t){(!t||!t.suppressFocus)&&this.eDateInput.getInputElement().focus()},r.prototype.shouldUseBrowserDatePicker=function(t){return t.filterParams&&null!=t.filterParams.browserDatePicker?t.filterParams.browserDatePicker:Ou()||tn()},function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);c>3&&f&&Object.defineProperty(r,t,f)}([Bt("eDateInput")],r.prototype,"eDateInput",void 0),r}(dn),Hu=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),nc=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},$f=function(h){function r(){return h.call(this,"numberFilter")||this}return Hu(r,h),r.prototype.mapValuesFromModel=function(t){var n=t||{};return[n.filter||null,n.filterTo||null].slice(0,this.getNumberOfInputs(n.type))},r.prototype.getDefaultDebounceMs=function(){return 500},r.prototype.comparator=function(){return function(t,n){return t===n?0:t<n?1:-1}},r.prototype.setParams=function(t){this.numberFilterParams=t;var n=this.getAllowedCharPattern();if(n){var c={allowedCharPattern:n};this.resetTemplate({eValueFrom1:c,eValueTo1:c,eValueFrom2:c,eValueTo2:c})}h.prototype.setParams.call(this,t)},r.prototype.getDefaultFilterOptions=function(){return r.DEFAULT_FILTER_OPTIONS},r.prototype.createValueTemplate=function(t){var n=t===Xi.One?"1":"2",f=this.getAllowedCharPattern()?"ag-input-text-field":"ag-input-number-field";return'\n            <div class="ag-filter-body" ref="eCondition'+n+'Body" role="presentation">\n                <'+f+' class="ag-filter-from ag-filter-filter" ref="eValue-index0-'+n+'"></'+f+">\n                <"+f+' class="ag-filter-to ag-filter-filter" ref="eValue-index1-'+n+'"></'+f+">\n            </div>"},r.prototype.getValues=function(t){var n=this,c=[];return this.forEachInput(function(f,y,T,B){t===T&&y<B&&c.push(n.stringToFloat(f.getValue()))}),c},r.prototype.areSimpleModelsEqual=function(t,n){return t.filter===n.filter&&t.filterTo===n.filterTo&&t.type===n.type},r.prototype.getFilterType=function(){return"number"},r.prototype.stringToFloat=function(t){if("number"==typeof t)return t;var n=d(t);return null!=n&&""===n.trim()&&(n=null),this.numberFilterParams.numberParser?this.numberFilterParams.numberParser(n):null==n||"-"===n.trim()?null:parseFloat(n)},r.prototype.createCondition=function(t){var n=this.getConditionTypes()[t],c={filterType:this.getFilterType(),type:n},f=this.getValues(t);return f.length>0&&(c.filter=f[0]),f.length>1&&(c.filterTo=f[1]),c},r.prototype.getInputs=function(){return[[this.eValueFrom1,this.eValueTo1],[this.eValueFrom2,this.eValueTo2]]},r.prototype.getAllowedCharPattern=function(){return(this.numberFilterParams||{}).allowedCharPattern||(Ou()||El()?null:"\\d\\-\\.")},r.DEFAULT_FILTER_OPTIONS=[ui.EQUALS,ui.NOT_EQUAL,ui.LESS_THAN,ui.LESS_THAN_OR_EQUAL,ui.GREATER_THAN,ui.GREATER_THAN_OR_EQUAL,ui.IN_RANGE],nc([Bt("eValue-index0-1")],r.prototype,"eValueFrom1",void 0),nc([Bt("eValue-index1-1")],r.prototype,"eValueTo1",void 0),nc([Bt("eValue-index0-2")],r.prototype,"eValueFrom2",void 0),nc([Bt("eValue-index1-2")],r.prototype,"eValueTo2",void 0),r}(ui),Wu=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Vl=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},ic=function(h){function r(){return h.call(this,"textFilter")||this}return Wu(r,h),r.trimInput=function(t){var n=t&&t.trim();return""===n?t:n},r.prototype.getDefaultDebounceMs=function(){return 500},r.prototype.setParams=function(t){h.prototype.setParams.call(this,t),this.textFilterParams=t,this.comparator=this.textFilterParams.textCustomComparator||r.DEFAULT_COMPARATOR,this.formatter=this.textFilterParams.textFormatter||(this.textFilterParams.caseSensitive?r.DEFAULT_FORMATTER:r.DEFAULT_LOWERCASE_FORMATTER)},r.prototype.createCondition=function(t){var n=this.getConditionTypes()[t],c={filterType:this.getFilterType(),type:n},f=this.getValues(t);return f.length>0&&(c.filter=f[0]),f.length>1&&(c.filterTo=f[1]),c},r.prototype.getFilterType=function(){return"text"},r.prototype.areSimpleModelsEqual=function(t,n){return t.filter===n.filter&&t.filterTo===n.filterTo&&t.type===n.type},r.prototype.getInputs=function(){return[[this.eValueFrom1,this.eValueTo1],[this.eValueFrom2,this.eValueTo2]]},r.prototype.getValues=function(t){var n=this,c=[];return this.forEachInput(function(f,y,T,B){if(t===T&&y<B){var q=d(f.getValue()),de=(n.textFilterParams.trimInput?r.trimInput(q):q)||null;c.push(de),f.setValue(de,!0)}}),c},r.prototype.getDefaultFilterOptions=function(){return r.DEFAULT_FILTER_OPTIONS},r.prototype.createValueTemplate=function(t){var n=t===Xi.One?"1":"2";return'\n            <div class="ag-filter-body" ref="eCondition'+n+'Body" role="presentation">\n                <ag-input-text-field class=".ag-filter-from ag-filter-filter" ref="eValue-index0-'+n+'"></ag-input-text-field>\n                <ag-input-text-field class="ag-filter-to ag-filter-filter" ref="eValue-index1-'+n+'"></ag-input-text-field>\n            </div>'},r.prototype.mapValuesFromModel=function(t){var n=t||{};return[n.filter||null,n.filterTo||null].slice(0,this.getNumberOfInputs(n.type))},r.prototype.evaluateNullValue=function(t){return t===ho.NOT_EQUAL||t===ho.NOT_CONTAINS},r.prototype.evaluateNonNullValue=function(t,n,c){var f=this,y=wr.map(t,function(B){return f.formatter(B)})||[],T=this.formatter(n);return wr.some(y,function(B){return f.comparator(c.type,T,B)})},r.DEFAULT_FILTER_OPTIONS=[ho.CONTAINS,ho.NOT_CONTAINS,ho.EQUALS,ho.NOT_EQUAL,ho.STARTS_WITH,ho.ENDS_WITH],r.DEFAULT_FORMATTER=function(t){return t},r.DEFAULT_LOWERCASE_FORMATTER=function(t){return null==t?null:t.toString().toLowerCase()},r.DEFAULT_COMPARATOR=function(t,n,c){switch(t){case r.CONTAINS:return n.indexOf(c)>=0;case r.NOT_CONTAINS:return n.indexOf(c)<0;case r.EQUALS:return n===c;case r.NOT_EQUAL:return n!=c;case r.STARTS_WITH:return 0===n.indexOf(c);case r.ENDS_WITH:var f=n.lastIndexOf(c);return f>=0&&f===n.length-c.length;default:return!1}},Vl([Bt("eValue-index0-1")],r.prototype,"eValueFrom1",void 0),Vl([Bt("eValue-index1-1")],r.prototype,"eValueTo1",void 0),Vl([Bt("eValue-index0-2")],r.prototype,"eValueFrom2",void 0),Vl([Bt("eValue-index1-2")],r.prototype,"eValueTo2",void 0),r}(ho),hy=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Wp=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},vy=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return hy(r,h),r.prototype.postConstruct=function(){this.setTemplate('\n            <div class="ag-floating-filter-input" role="presentation">\n                <ag-input-text-field ref="eFloatingFilterInput"></ag-input-text-field>\n            </div>')},r.prototype.getDefaultDebounceMs=function(){return 500},r.prototype.onParentModelChanged=function(t,n){this.isEventFromFloatingFilter(n)||(this.setLastTypeFromModel(t),this.eFloatingFilterInput.setValue(this.getTextFromModel(t)),this.setEditable(this.canWeEditAfterModelFromParentFilter(t)))},r.prototype.init=function(t){if(h.prototype.init.call(this,t),this.params=t,this.applyActive=Lo.isUseApplyButton(this.params.filterParams),!this.isReadOnly()){var n=Lo.getDebounceMs(this.params.filterParams,this.getDefaultDebounceMs()),c=Sr(this.syncUpWithParentFilter.bind(this),n),f=this.eFloatingFilterInput.getGui();this.addManagedListener(f,"input",c),this.addManagedListener(f,"keypress",c),this.addManagedListener(f,"keydown",c)}var y=t.column.getDefinition();(this.isReadOnly()||y.filterParams&&y.filterParams.filterOptions&&1===y.filterParams.filterOptions.length&&"inRange"===y.filterParams.filterOptions[0])&&this.eFloatingFilterInput.setDisabled(!0);var T=this.columnModel.getDisplayNameForColumn(t.column,"header",!0),B=this.gridOptionsWrapper.getLocaleTextFunc();this.eFloatingFilterInput.setInputAriaLabel(T+" "+B("ariaFilterInput","Filter Input"))},r.prototype.syncUpWithParentFilter=function(t){var n=this,c=ku(t,Yt.ENTER);if(!this.applyActive||c){var f=this.eFloatingFilterInput.getValue();this.params.filterParams.trimInput&&(f=ic.trimInput(f),this.eFloatingFilterInput.setValue(f,!0)),this.params.parentFilterInstance(function(y){y&&y.onFloatingFilterChanged(n.getLastType(),f||null)})}},r.prototype.conditionToString=function(t,n){return t.type==ho.IN_RANGE||2===(n||{}).numberOfInputs?t.filter+"-"+t.filterTo:null!=t.filter?""+t.filter:""+t.type},r.prototype.setEditable=function(t){this.eFloatingFilterInput.setDisabled(!t)},Wp([Ee("columnModel")],r.prototype,"columnModel",void 0),Wp([Bt("eFloatingFilterInput")],r.prototype,"eFloatingFilterInput",void 0),Wp([zt],r.prototype,"postConstruct",null),r}(Uu),oc=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),zp=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return oc(r,h),r.prototype.getDefaultFilterOptions=function(){return $f.DEFAULT_FILTER_OPTIONS},r}(vy),ed=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),zu=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return ed(r,h),r.prototype.getDefaultFilterOptions=function(){return ic.DEFAULT_FILTER_OPTIONS},r}(vy),No=function(){function h(r,t){var n=this;void 0===t&&(t=!1),this.destroyFuncs=[],this.touching=!1,this.eventService=new Zn,this.eElement=r,this.preventMouseClick=t;var c=this.onTouchStart.bind(this),f=this.onTouchMove.bind(this),y=this.onTouchEnd.bind(this);this.eElement.addEventListener("touchstart",c,{passive:!0}),this.eElement.addEventListener("touchmove",f,{passive:!0}),this.eElement.addEventListener("touchend",y,{passive:!1}),this.destroyFuncs.push(function(){n.eElement.removeEventListener("touchstart",c,{passive:!0}),n.eElement.removeEventListener("touchmove",f,{passive:!0}),n.eElement.removeEventListener("touchend",y,{passive:!1})})}return h.prototype.getActiveTouch=function(r){for(var t=0;t<r.length;t++)if(r[t].identifier===this.touchStart.identifier)return r[t];return null},h.prototype.addEventListener=function(r,t){this.eventService.addEventListener(r,t)},h.prototype.removeEventListener=function(r,t){this.eventService.removeEventListener(r,t)},h.prototype.onTouchStart=function(r){var t=this;if(!this.touching){this.touchStart=r.touches[0],this.touching=!0,this.moved=!1;var n=this.touchStart;window.setTimeout(function(){t.touching&&t.touchStart===n&&!t.moved&&(t.moved=!0,t.eventService.dispatchEvent({type:h.EVENT_LONG_TAP,touchStart:t.touchStart,touchEvent:r}))},500)}},h.prototype.onTouchMove=function(r){if(this.touching){var t=this.getActiveTouch(r.touches);t&&!Op(t,this.touchStart,4)&&(this.moved=!0)}},h.prototype.onTouchEnd=function(r){this.touching&&(this.moved||(this.eventService.dispatchEvent({type:h.EVENT_TAP,touchStart:this.touchStart}),this.checkForDoubleTap()),this.preventMouseClick&&r.preventDefault(),this.touching=!1)},h.prototype.checkForDoubleTap=function(){var r=(new Date).getTime();this.lastTapTime&&this.lastTapTime>0&&r-this.lastTapTime>h.DOUBLE_TAP_MILLIS?(this.eventService.dispatchEvent({type:h.EVENT_DOUBLE_TAP,touchStart:this.touchStart}),this.lastTapTime=null):this.lastTapTime=r},h.prototype.destroy=function(){this.destroyFuncs.forEach(function(r){return r()})},h.EVENT_TAP="tap",h.EVENT_DOUBLE_TAP="doubleTap",h.EVENT_LONG_TAP="longTap",h.DOUBLE_TAP_MILLIS=500,h}(),jp=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),vo=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},gy=function(h){function r(){var t=null!==h&&h.apply(this,arguments)||this;return t.lastMovingChanged=0,t}return jp(r,h),r.prototype.destroy=function(){h.prototype.destroy.call(this)},r.prototype.refresh=function(t){return this.params=t,this.workOutTemplate()==this.currentTemplate&&this.workOutShowMenu()==this.currentShowMenu&&this.workOutSort()==this.currentSort&&(this.setDisplayName(t),!0)},r.prototype.workOutTemplate=function(){var t=I(this.params.template,r.TEMPLATE);return t&&t.trim?t.trim():t},r.prototype.init=function(t){this.params=t,this.currentTemplate=this.workOutTemplate(),this.setTemplate(this.currentTemplate),this.setupTap(),this.setupIcons(t.column),this.setMenu(),this.setupSort(),this.setupFilterIcon(),this.setDisplayName(t)},r.prototype.setDisplayName=function(t){if(this.currentDisplayName!=t.displayName){this.currentDisplayName=t.displayName;var n=Oe(this.currentDisplayName);this.eText&&(this.eText.innerHTML=n)}},r.prototype.setupIcons=function(t){this.addInIcon("sortAscending",this.eSortAsc,t),this.addInIcon("sortDescending",this.eSortDesc,t),this.addInIcon("sortUnSort",this.eSortNone,t),this.addInIcon("menu",this.eMenu,t),this.addInIcon("filter",this.eFilter,t)},r.prototype.addInIcon=function(t,n,c){if(null!=n){var f=Bi(t,this.gridOptionsWrapper,c);f&&n.appendChild(f)}},r.prototype.setupTap=function(){var t=this,n=this.gridOptionsWrapper;if(!n.isSuppressTouch()){var c=new No(this.getGui(),!0),f=n.isSuppressMenuHide(),y=f&&v(this.eMenu),T=y?new No(this.eMenu,!0):c;this.params.enableMenu&&this.addManagedListener(T,No[y?"EVENT_TAP":"EVENT_LONG_TAP"],function(ke){n.getApi().showColumnMenuAfterMouseClick(t.params.column,ke.touchStart)}),this.params.enableSorting&&this.addManagedListener(c,No.EVENT_TAP,function(ke){f&&t.eMenu.contains(ke.touchStart.target)||t.sortController.progressSort(t.params.column,!1,"uiColumnSorted")}),this.addDestroyFunc(function(){return c.destroy()}),y&&this.addDestroyFunc(function(){return T.destroy()})}},r.prototype.workOutShowMenu=function(){var t=!this.gridOptionsWrapper.isSuppressMenuHide(),n=bs()&&t;return this.params.enableMenu&&!n},r.prototype.setMenu=function(){var t=this;if(this.eMenu){if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu)return void ji(this.eMenu);var n=this.gridOptionsWrapper.isSuppressMenuHide();this.addManagedListener(this.eMenu,"click",function(){return t.showMenu(t.eMenu)}),Fr(this.eMenu,"ag-header-menu-always-show",n)}},r.prototype.showMenu=function(t){t||(t=this.eMenu),this.menuFactory.showMenuAfterButtonClick(this.params.column,t,"columnMenu")},r.prototype.removeSortIcons=function(){ji(this.eSortAsc),ji(this.eSortDesc),ji(this.eSortNone),ji(this.eSortOrder)},r.prototype.workOutSort=function(){return this.params.enableSorting},r.prototype.setupSort=function(){var t=this;if(this.currentSort=this.params.enableSorting,this.currentSort){var n=this.gridOptionsWrapper.isMultiSortKeyCtrl();this.addManagedListener(this.params.column,it.EVENT_MOVING_CHANGED,function(){t.lastMovingChanged=(new Date).getTime()}),this.eLabel&&this.addManagedListener(this.eLabel,"click",function(c){var f=t.params.column.isMoving(),y=(new Date).getTime();f||y-t.lastMovingChanged<50||t.params.progressSort(n?c.ctrlKey||c.metaKey:c.shiftKey)}),this.addManagedListener(this.params.column,it.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.onSortChanged(),this.addManagedListener(this.eventService,Ge.EVENT_SORT_CHANGED,this.setMultiSortOrder.bind(this)),this.setMultiSortOrder()}else this.removeSortIcons()},r.prototype.onSortChanged=function(){if(Fr(this.getGui(),"ag-header-cell-sorted-asc",this.params.column.isSortAscending()),Fr(this.getGui(),"ag-header-cell-sorted-desc",this.params.column.isSortDescending()),Fr(this.getGui(),"ag-header-cell-sorted-none",this.params.column.isSortNone()),this.eSortAsc&&Fr(this.eSortAsc,"ag-hidden",!this.params.column.isSortAscending()),this.eSortDesc&&Fr(this.eSortDesc,"ag-hidden",!this.params.column.isSortDescending()),this.eSortNone){var t=!this.params.column.getColDef().unSortIcon&&!this.gridOptionsWrapper.isUnSortIcon();Fr(this.eSortNone,"ag-hidden",t||!this.params.column.isSortNone())}},r.prototype.setMultiSortOrder=function(){if(this.eSortOrder){var t=this.params.column,n=this.sortController.getColumnsWithSortingOrdered(),c=n.indexOf(t),f=n.length>1,y=t.isSorting()&&f;Nn(this.eSortOrder,y),c>=0?this.eSortOrder.innerHTML=(c+1).toString():So(this.eSortOrder)}},r.prototype.setupFilterIcon=function(){!this.eFilter||(this.addManagedListener(this.params.column,it.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.onFilterChanged())},r.prototype.onFilterChanged=function(){var t=this.params.column.isFilterActive();Fr(this.eFilter,"ag-hidden",!t)},r.TEMPLATE='<div class="ag-cell-label-container" role="presentation">\n            <span ref="eMenu" class="ag-header-icon ag-header-cell-menu-button" aria-hidden="true"></span>\n            <div ref="eLabel" class="ag-header-cell-label" role="presentation" unselectable="on">\n                <span ref="eText" class="ag-header-cell-text" unselectable="on"></span>\n                <span ref="eFilter" class="ag-header-icon ag-header-label-icon ag-filter-icon" aria-hidden="true"></span>\n                <span ref="eSortOrder" class="ag-header-icon ag-header-label-icon ag-sort-order" aria-hidden="true"></span>\n                <span ref="eSortAsc" class="ag-header-icon ag-header-label-icon ag-sort-ascending-icon" aria-hidden="true"></span>\n                <span ref="eSortDesc" class="ag-header-icon ag-header-label-icon ag-sort-descending-icon" aria-hidden="true"></span>\n                <span ref="eSortNone" class="ag-header-icon ag-header-label-icon ag-sort-none-icon" aria-hidden="true"></span>\n            </div>\n        </div>',vo([Ee("sortController")],r.prototype,"sortController",void 0),vo([Ee("menuFactory")],r.prototype,"menuFactory",void 0),vo([Bt("eFilter")],r.prototype,"eFilter",void 0),vo([Bt("eSortAsc")],r.prototype,"eSortAsc",void 0),vo([Bt("eSortDesc")],r.prototype,"eSortDesc",void 0),vo([Bt("eSortNone")],r.prototype,"eSortNone",void 0),vo([Bt("eSortOrder")],r.prototype,"eSortOrder",void 0),vo([Bt("eMenu")],r.prototype,"eMenu",void 0),vo([Bt("eLabel")],r.prototype,"eLabel",void 0),vo([Bt("eText")],r.prototype,"eText",void 0),r}(dn),Ul=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),ju=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},ac=function(h){function r(){return h.call(this,r.TEMPLATE)||this}return Ul(r,h),r.prototype.destroy=function(){h.prototype.destroy.call(this)},r.prototype.init=function(t){this.params=t,this.checkWarnings(),this.setupLabel(),this.addGroupExpandIcon(),this.setupExpandIcons()},r.prototype.checkWarnings=function(){this.params.template&&Lt(function(){return console.warn("A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)")},"HeaderGroupComp.templateNotSupported")},r.prototype.setupExpandIcons=function(){var t=this;this.addInIcon("columnGroupOpened","agOpened"),this.addInIcon("columnGroupClosed","agClosed");var n=function(T){if(!fr(T)){var B=!t.params.columnGroup.isExpanded();t.columnModel.setColumnGroupOpened(t.params.columnGroup.getOriginalColumnGroup(),B,"uiColumnExpanded")}};this.addTouchAndClickListeners(this.eCloseIcon,n),this.addTouchAndClickListeners(this.eOpenIcon,n);var c=function(T){kr(T)};this.addManagedListener(this.eCloseIcon,"dblclick",c),this.addManagedListener(this.eOpenIcon,"dblclick",c),this.addManagedListener(this.getGui(),"dblclick",n),this.updateIconVisibility();var f=this.params.columnGroup.getOriginalColumnGroup();this.addManagedListener(f,kt.EVENT_EXPANDED_CHANGED,this.updateIconVisibility.bind(this)),this.addManagedListener(f,kt.EVENT_EXPANDABLE_CHANGED,this.updateIconVisibility.bind(this))},r.prototype.addTouchAndClickListeners=function(t,n){var c=new No(t,!0);this.addManagedListener(c,No.EVENT_TAP,n),this.addDestroyFunc(function(){return c.destroy()}),this.addManagedListener(t,"click",n)},r.prototype.updateIconVisibility=function(){if(this.params.columnGroup.isExpandable()){var n=this.params.columnGroup.isExpanded();Nn(this.eOpenIcon,n),Nn(this.eCloseIcon,!n)}else Nn(this.eOpenIcon,!1),Nn(this.eCloseIcon,!1)},r.prototype.addInIcon=function(t,n){var c=Bi(t,this.gridOptionsWrapper,null);c&&this.getRefElement(n).appendChild(c)},r.prototype.addGroupExpandIcon=function(){if(!this.params.columnGroup.isExpandable())return Nn(this.eOpenIcon,!1),void Nn(this.eCloseIcon,!1)},r.prototype.setupLabel=function(){var t=this.params.displayName;if(v(t)){var n=Oe(t);this.getRefElement("agLabel").innerHTML=n}},r.TEMPLATE='<div class="ag-header-group-cell-label" ref="agContainer" role="presentation">\n            <span ref="agLabel" class="ag-header-group-text" role="presentation"></span>\n            <span ref="agOpened" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"></span>\n            <span ref="agClosed" class="ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"></span>\n        </div>',ju([Ee("columnModel")],r.prototype,"columnModel",void 0),ju([Bt("agOpened")],r.prototype,"eOpenIcon",void 0),ju([Bt("agClosed")],r.prototype,"eCloseIcon",void 0),r}(dn),my=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),nl=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return my(r,h),r.prototype.isPopup=function(){return!0},r.prototype.setParentComponent=function(t){Er(t.getGui(),"ag-has-popup"),h.prototype.setParentComponent.call(this,t)},r.prototype.destroy=function(){var t=this.parentComponent;t&&t.isAlive()&&zi(t.getGui(),"ag-has-popup"),h.prototype.destroy.call(this)},r}(dn),Xp=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Yp=function(h){function r(){return h.call(this,r.TEMPLATE)||this}return Xp(r,h),r.prototype.init=function(t){this.params=t,this.focusAfterAttached=t.cellStartedEdit,this.eTextArea.setMaxLength(t.maxLength||200).setCols(t.cols||60).setRows(t.rows||10),v(t.value)&&this.eTextArea.setValue(t.value.toString(),!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this))},r.prototype.onKeyDown=function(t){var n=t.which||t.keyCode;(n===Yt.LEFT||n===Yt.UP||n===Yt.RIGHT||n===Yt.DOWN||t.shiftKey&&n===Yt.ENTER)&&t.stopPropagation()},r.prototype.afterGuiAttached=function(){var t=this.gridOptionsWrapper.getLocaleTextFunc();this.eTextArea.setInputAriaLabel(t("ariaInputEditor","Input Editor")),this.focusAfterAttached&&this.eTextArea.getFocusableElement().focus()},r.prototype.getValue=function(){return this.params.parseValue(this.eTextArea.getValue())},r.TEMPLATE='<div class="ag-large-text" tabindex="0">\n            <ag-input-text-area ref="eTextArea" class="ag-large-text-input"></ag-input-text-area>\n        </div>',function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);c>3&&f&&Object.defineProperty(r,t,f)}([Bt("eTextArea")],r.prototype,"eTextArea",void 0),r}(nl),Xu=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),sc=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Yu=function(h){function r(){var t=h.call(this,'<div class="ag-cell-edit-wrapper"><ag-select class="ag-cell-editor" ref="eSelect"></ag-select></div>')||this;return t.startedByEnter=!1,t}return Xu(r,h),r.prototype.init=function(t){var n=this;if(this.focusAfterAttached=t.cellStartedEdit,g(t.values))console.warn("AG Grid: no values found for select cellEditor");else{this.startedByEnter=t.keyPress===Yt.ENTER;var c=!1;t.values.forEach(function(f){var y={value:f},T=n.valueFormatterService.formatValue(t.column,null,null,f);y.text=null!=T?T:f,n.eSelect.addOption(y),c=c||t.value===f}),c?this.eSelect.setValue(t.value,!0):t.values.length&&this.eSelect.setValue(t.values[0],!0),this.gridOptionsWrapper.isFullRowEdit()||this.eSelect.onValueChange(function(){return t.stopEditing()})}},r.prototype.afterGuiAttached=function(){this.focusAfterAttached&&this.eSelect.getFocusableElement().focus(),this.startedByEnter&&this.eSelect.showPicker()},r.prototype.focusIn=function(){this.eSelect.getFocusableElement().focus()},r.prototype.getValue=function(){return this.eSelect.getValue()},r.prototype.isPopup=function(){return!1},sc([Ee("valueFormatterService")],r.prototype,"valueFormatterService",void 0),sc([Bt("eSelect")],r.prototype,"eSelect",void 0),r}(nl),lc=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),qu=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return lc(r,h),r.prototype.isPopup=function(){return!0},r}(Yu),Cy=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ku=function(h){function r(){return h.call(this,r.TEMPLATE)||this}return Cy(r,h),r.prototype.init=function(t){this.params=t;var c,n=this.eInput;t.cellStartedEdit?(this.focusAfterAttached=!0,t.keyPress===Yt.BACKSPACE||t.keyPress===Yt.DELETE?c="":t.charPress?c=t.charPress:(c=this.getStartValue(t),t.keyPress!==Yt.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,c=this.getStartValue(t)),null!=c&&n.setValue(c,!0),this.addManagedListener(n.getGui(),"keydown",function(f){var y=f.keyCode;(y===Yt.PAGE_UP||y===Yt.PAGE_DOWN)&&f.preventDefault()})},r.prototype.afterGuiAttached=function(){var t=this.gridOptionsWrapper.getLocaleTextFunc(),n=this.eInput;if(n.setInputAriaLabel(t("ariaInputEditor","Input Editor")),this.focusAfterAttached){Du()||n.getFocusableElement().focus();var c=n.getInputElement();if(this.highlightAllOnFocus)c.select();else{var f=n.getValue(),y=v(f)&&f.length||0;y&&c.setSelectionRange(y,y)}}},r.prototype.focusIn=function(){var t=this.eInput,n=t.getFocusableElement(),c=t.getInputElement();n.focus(),c.select()},r.prototype.focusOut=function(){var t=this.eInput.getInputElement();uo()&&t.setSelectionRange(0,0)},r.prototype.getValue=function(){return this.params.parseValue(this.eInput.getValue())},r.prototype.getStartValue=function(t){return t.useFormatter||t.column.getColDef().refData?t.formatValue(t.value):t.value},r.prototype.isPopup=function(){return!1},r.TEMPLATE='<div class="ag-cell-edit-wrapper"><ag-input-text-field class="ag-cell-editor" ref="eInput"></ag-input-text-field></div>',function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);c>3&&f&&Object.defineProperty(r,t,f)}([Bt("eInput")],r.prototype,"eInput",void 0),r}(nl),Kp=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),td=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return Kp(r,h),r.prototype.isPopup=function(){return!0},r}(Ku),wy=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Qp=function(h){function r(){var t=h.call(this,r.TEMPLATE)||this;return t.refreshCount=0,t}return wy(r,h),r.prototype.init=function(t){this.eValue=this.queryForHtmlElement(".ag-value-change-value"),this.eDelta=this.queryForHtmlElement(".ag-value-change-delta"),this.refresh(t)},r.prototype.showDelta=function(t,n){var c=Math.abs(n),f=t.formatValue(c),y=v(f)?f:c,T=n>=0;this.eDelta.innerHTML=T?"\u2191"+y:"\u2193"+y,Fr(this.eDelta,"ag-value-change-delta-up",T),Fr(this.eDelta,"ag-value-change-delta-down",!T)},r.prototype.setTimerToRemoveDelta=function(){var t=this;this.refreshCount++;var n=this.refreshCount;window.setTimeout(function(){n===t.refreshCount&&t.hideDeltaValue()},2e3)},r.prototype.hideDeltaValue=function(){zi(this.eValue,"ag-value-change-value-highlight"),So(this.eDelta)},r.prototype.refresh=function(t){var n=t.value;return n!==this.lastValue&&(v(t.valueFormatted)?this.eValue.innerHTML=t.valueFormatted:v(t.value)?this.eValue.innerHTML=n:So(this.eValue),!this.filterManager.isSuppressFlashingCellsBecauseFiltering())&&("number"==typeof n&&"number"==typeof this.lastValue&&this.showDelta(t,n-this.lastValue),this.lastValue&&Er(this.eValue,"ag-value-change-value-highlight"),this.setTimerToRemoveDelta(),this.lastValue=n,!0)},r.TEMPLATE='<span><span class="ag-value-change-delta"></span><span class="ag-value-change-value"></span></span>',function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);c>3&&f&&Object.defineProperty(r,t,f)}([Ee("filterManager")],r.prototype,"filterManager",void 0),r}(dn),Jp=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),il=function(h){function r(){var t=h.call(this,r.TEMPLATE)||this;return t.refreshCount=0,t.eCurrent=t.queryForHtmlElement(".ag-value-slide-current"),t}return Jp(r,h),r.prototype.init=function(t){this.refresh(t)},r.prototype.addSlideAnimation=function(){var t=this;this.refreshCount++;var n=this.refreshCount;this.ePrevious&&this.getGui().removeChild(this.ePrevious),this.ePrevious=ua('<span class="ag-value-slide-previous ag-value-slide-out"></span>'),this.ePrevious.innerHTML=this.eCurrent.innerHTML,this.getGui().insertBefore(this.ePrevious,this.eCurrent),window.setTimeout(function(){n===t.refreshCount&&Er(t.ePrevious,"ag-value-slide-out-end")},50),window.setTimeout(function(){n===t.refreshCount&&(t.getGui().removeChild(t.ePrevious),t.ePrevious=null)},3e3)},r.prototype.refresh=function(t){var n=t.value;return g(n)&&(n=""),n!==this.lastValue&&!this.filterManager.isSuppressFlashingCellsBecauseFiltering()&&(this.addSlideAnimation(),this.lastValue=n,v(t.valueFormatted)?this.eCurrent.innerHTML=t.valueFormatted:v(t.value)?this.eCurrent.innerHTML=n:So(this.eCurrent),!0)},r.TEMPLATE='<span>\n            <span class="ag-value-slide-current"></span>\n        </span>',function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);c>3&&f&&Object.defineProperty(r,t,f)}([Ee("filterManager")],r.prototype,"filterManager",void 0),r}(dn);!function(h){h[h.Above=0]="Above",h[h.Below=1]="Below"}(e.oh5||(e.oh5={}));var un=function(){function h(r){this.rowIndex=null,this.key=null,this.childrenMapped={},this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=h.OBJECT_ID_SEQUENCE++,this.__autoHeights={},this.alreadyRendered=!1,this.highlighted=null,this.selected=!1,this.beans=r}return h.prototype.setData=function(r){this.setDataCommon(r,!1)},h.prototype.updateData=function(r){this.setDataCommon(r,!0)},h.prototype.setDataCommon=function(r,t){var n=this.data;this.data=r,this.beans.valueCache.onDataChanged(),this.updateDataOnDetailNode(),this.checkRowSelectable();var c=this.createDataChangedEvent(r,n,t);this.dispatchLocalEvent(c)},h.prototype.updateDataOnDetailNode=function(){this.detailNode&&(this.detailNode.data=this.data)},h.prototype.createDataChangedEvent=function(r,t,n){return{type:h.EVENT_DATA_CHANGED,node:this,oldData:t,newData:r,update:n}},h.prototype.createLocalRowEvent=function(r){return{type:r,node:this}},h.prototype.getRowIndexString=function(){return this.rowPinned===W.PINNED_TOP?"t-"+this.rowIndex:this.rowPinned===W.PINNED_BOTTOM?"b-"+this.rowIndex:this.rowIndex.toString()},h.prototype.createDaemonNode=function(){var r=new h(this.beans);return r.id=this.id,r.data=this.data,r.daemon=!0,r.selected=this.selected,r.level=this.level,r},h.prototype.setDataAndId=function(r,t){var n=v(this.id)?this.createDaemonNode():null,c=this.data;this.data=r,this.updateDataOnDetailNode(),this.setId(t),this.beans.selectionService.syncInRowNode(this,n),this.checkRowSelectable();var f=this.createDataChangedEvent(r,c,!1);this.dispatchLocalEvent(f)},h.prototype.checkRowSelectable=function(){var r=this.beans.gridOptionsWrapper.getIsRowSelectableFunc();this.setRowSelectable(!r||r(this))},h.prototype.setRowSelectable=function(r){this.selectable!==r&&(this.selectable=r,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(h.EVENT_SELECTABLE_CHANGED)))},h.prototype.setId=function(r){var t=this.beans.gridOptionsWrapper.getRowNodeIdFunc();t?this.data?(this.id=t(this.data),this.id&&"string"==typeof this.id&&We(this.id,h.ID_PREFIX_ROW_GROUP)&&console.error("AG Grid: Row ID's cannot start with "+h.ID_PREFIX_ROW_GROUP+", this is a reserved prefix for AG Grid's row grouping feature."),this.id&&"string"!=typeof this.id&&(this.id=""+this.id)):this.id=void 0:this.id=r},h.prototype.isPixelInRange=function(r){return!(!v(this.rowTop)||!v(this.rowHeight))&&r>=this.rowTop&&r<this.rowTop+this.rowHeight},h.prototype.setFirstChild=function(r){this.firstChild!==r&&(this.firstChild=r,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(h.EVENT_FIRST_CHILD_CHANGED)))},h.prototype.setLastChild=function(r){this.lastChild!==r&&(this.lastChild=r,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(h.EVENT_LAST_CHILD_CHANGED)))},h.prototype.setChildIndex=function(r){this.childIndex!==r&&(this.childIndex=r,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(h.EVENT_CHILD_INDEX_CHANGED)))},h.prototype.setRowTop=function(r){this.oldRowTop=this.rowTop,this.rowTop!==r&&(this.rowTop=r,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(h.EVENT_TOP_CHANGED)),this.setDisplayed(null!==r))},h.prototype.clearRowTopAndRowIndex=function(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)},h.prototype.setDisplayed=function(r){this.displayed!==r&&(this.displayed=r,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(h.EVENT_DISPLAYED_CHANGED)))},h.prototype.setDragging=function(r){this.dragging!==r&&(this.dragging=r,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(h.EVENT_DRAGGING_CHANGED)))},h.prototype.setHighlighted=function(r){r!==this.highlighted&&(this.highlighted=r,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(h.EVENT_HIGHLIGHT_CHANGED)))},h.prototype.setAllChildrenCount=function(r){this.allChildrenCount!==r&&(this.allChildrenCount=r,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(h.EVENT_ALL_CHILDREN_COUNT_CHANGED)))},h.prototype.setMaster=function(r){this.master!==r&&(this.master&&!r&&(this.expanded=!1),this.master=r,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(h.EVENT_MASTER_CHANGED)))},h.prototype.setRowHeight=function(r,t){void 0===t&&(t=!1),this.rowHeight=r,this.rowHeightEstimated=t,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(h.EVENT_HEIGHT_CHANGED))},h.prototype.setRowAutoHeight=function(r,t){this.__autoHeights||(this.__autoHeights={}),this.__autoHeights[t.getId()]=r,null!=r&&(null==this.checkAutoHeightsDebounced&&(this.checkAutoHeightsDebounced=Sr(this.checkAutoHeights.bind(this),1)),this.checkAutoHeightsDebounced())},h.prototype.checkAutoHeights=function(){var r=!1,t=!0,n=0,c=this.__autoHeights;if(null!=c&&(this.beans.columnModel.getAllDisplayedAutoHeightCols().forEach(function(T){var B=c[T.getId()];null!=B?(t=!1,B>n&&(n=B)):r=!0}),!r&&((t||n<10)&&(n=this.beans.gridOptionsWrapper.getRowHeightForNode(this).height),n!=this.rowHeight))){this.setRowHeight(n);var y=this.beans.rowModel;y.onRowHeightChanged&&y.onRowHeightChanged()}},h.prototype.setRowIndex=function(r){this.rowIndex!==r&&(this.rowIndex=r,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(h.EVENT_ROW_INDEX_CHANGED)))},h.prototype.setUiLevel=function(r){this.uiLevel!==r&&(this.uiLevel=r,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(h.EVENT_UI_LEVEL_CHANGED)))},h.prototype.setExpanded=function(r){if(this.expanded!==r){this.expanded=r,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(h.EVENT_EXPANDED_CHANGED));var t=ut({},this.createGlobalRowEvent(Ge.EVENT_ROW_GROUP_OPENED),{expanded:r});this.beans.rowNodeEventThrottle.dispatchExpanded(t),this.beans.gridOptionsWrapper.isGroupIncludeFooter()&&this.beans.rowRenderer.refreshCells({rowNodes:[this]})}},h.prototype.createGlobalRowEvent=function(r){return{type:r,node:this,data:this.data,rowIndex:this.rowIndex,rowPinned:this.rowPinned,context:this.beans.gridOptionsWrapper.getContext(),api:this.beans.gridOptionsWrapper.getApi(),columnApi:this.beans.gridOptionsWrapper.getColumnApi()}},h.prototype.dispatchLocalEvent=function(r){this.eventService&&this.eventService.dispatchEvent(r)},h.prototype.setDataValue=function(r,t,n){var c=this.beans.columnModel.getPrimaryColumn(r),f=this.beans.valueService.getValue(c,this);this.beans.valueService.setValue(this,c,t,n),this.dispatchCellChangedEvent(c,t,f)},h.prototype.setGroupValue=function(r,t){var n=this.beans.columnModel.getGridColumn(r);g(this.groupData)&&(this.groupData={});var c=n.getColId(),f=this.groupData[c];f!==t&&(this.groupData[c]=t,this.dispatchCellChangedEvent(n,t,f))},h.prototype.setAggData=function(r){var t=this,n=Je([this.aggData,r]),c=this.aggData;this.aggData=r,this.eventService&&n.forEach(function(f){var y=t.beans.columnModel.getGridColumn(f);t.dispatchCellChangedEvent(y,t.aggData?t.aggData[f]:void 0,c?c[f]:void 0)})},h.prototype.updateHasChildren=function(){var r=this.group&&!this.footer||this.childrenAfterGroup&&this.childrenAfterGroup.length>0;r!==this.__hasChildren&&(this.__hasChildren=!!r,this.eventService&&this.eventService.dispatchEvent(this.createLocalRowEvent(h.EVENT_HAS_CHILDREN_CHANGED)))},h.prototype.hasChildren=function(){return null==this.__hasChildren&&this.updateHasChildren(),this.__hasChildren},h.prototype.isEmptyRowGroupNode=function(){return this.group&&C(this.childrenAfterGroup)},h.prototype.dispatchCellChangedEvent=function(r,t,n){this.dispatchLocalEvent({type:h.EVENT_CELL_CHANGED,node:this,column:r,newValue:t,oldValue:n})},h.prototype.resetQuickFilterAggregateText=function(){this.quickFilterAggregateText=null},h.prototype.isExpandable=function(){return!!(this.hasChildren()&&!this.footer||this.master)},h.prototype.isSelected=function(){return this.footer?this.sibling.isSelected():this.selected},h.prototype.depthFirstSearch=function(r){this.childrenAfterGroup&&this.childrenAfterGroup.forEach(function(t){return t.depthFirstSearch(r)}),r(this)},h.prototype.calculateSelectedFromChildren=function(){var r=!1,t=!1,n=!1;if(this.childrenAfterGroup)for(var f=0;f<this.childrenAfterGroup.length;f++){var y=this.childrenAfterGroup[f];if(y.selectable)switch(y.isSelected()){case!0:r=!0;break;case!1:t=!0;break;default:n=!0}}this.selectThisNode(n?void 0:!(!r||t)||!(!r&&t)&&void 0)},h.prototype.setSelectedInitialValue=function(r){this.selected=r},h.prototype.setSelected=function(r,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1),this.setSelectedParams({newValue:r,clearSelection:t,suppressFinishActions:n,rangeSelect:!1})},h.prototype.isRowPinned=function(){return this.rowPinned===W.PINNED_TOP||this.rowPinned===W.PINNED_BOTTOM},h.prototype.setSelectedParams=function(r){var t=this.beans.gridOptionsWrapper.isGroupSelectsChildren(),n=!0===r.newValue,c=!0===r.clearSelection,f=!0===r.suppressFinishActions,y=!0===r.rangeSelect,T=t&&!0===r.groupSelectsFiltered;if(void 0===this.id)return console.warn("AG Grid: cannot select node until id for node is known"),0;if(this.rowPinned)return console.warn("AG Grid: cannot select pinned rows"),0;if(this.footer)return this.sibling.setSelectedParams(r);if(y&&this.beans.selectionService.getLastSelectedNode()){var B=this.beans.selectionService.getLastSelectedNode()!==this,q=this.beans.gridOptionsWrapper.isRowSelectionMulti();if(B&&q){var de=this.doRowRangeSelection(r.newValue);return this.beans.selectionService.setLastSelectedNode(this),de}}var Se=0;return T&&this.group||this.selectThisNode(n)&&Se++,t&&this.group&&(Se+=this.selectChildNodes(n,T)),f||(n&&(c||!this.beans.gridOptionsWrapper.isRowSelectionMulti())&&(Se+=this.beans.selectionService.clearOtherNodes(this)),Se>0&&(this.beans.selectionService.updateGroupsFromChildrenSelections(),this.beans.eventService.dispatchEvent({type:Ge.EVENT_SELECTION_CHANGED,api:this.beans.gridApi,columnApi:this.beans.columnApi})),n&&this.beans.selectionService.setLastSelectedNode(this)),Se},h.prototype.doRowRangeSelection=function(r){var t=this;void 0===r&&(r=!0);var n=this.beans.gridOptionsWrapper.isGroupSelectsChildren(),c=this.beans.selectionService.getLastSelectedNode(),f=this.beans.rowModel.getNodesInRangeForSelection(this,c),y=0;return f.forEach(function(B){B.group&&n||!1===r&&t===B||B.selectThisNode(r)&&y++}),this.beans.selectionService.updateGroupsFromChildrenSelections(),this.beans.eventService.dispatchEvent({type:Ge.EVENT_SELECTION_CHANGED,api:this.beans.gridApi,columnApi:this.beans.columnApi}),y},h.prototype.isParentOfNode=function(r){for(var t=this.parent;t;){if(t===r)return!0;t=t.parent}return!1},h.prototype.selectThisNode=function(r){if(!this.selectable&&r||this.selected===r)return!1;this.selected=r,this.eventService&&this.dispatchLocalEvent(this.createLocalRowEvent(h.EVENT_ROW_SELECTED));var c=this.createGlobalRowEvent(Ge.EVENT_ROW_SELECTED);return this.beans.eventService.dispatchEvent(c),!0},h.prototype.selectChildNodes=function(r,t){var n=t?this.childrenAfterFilter:this.childrenAfterGroup;if(g(n))return 0;for(var c=0,f=0;f<n.length;f++)c+=n[f].setSelectedParams({newValue:r,clearSelection:!1,suppressFinishActions:!0,groupSelectsFiltered:t});return c},h.prototype.addEventListener=function(r,t){this.eventService||(this.eventService=new Zn),this.eventService.addEventListener(r,t)},h.prototype.removeEventListener=function(r,t){!this.eventService||(this.eventService.removeEventListener(r,t),this.eventService.noRegisteredListenersExist()&&(this.eventService=null))},h.prototype.onMouseEnter=function(){this.dispatchLocalEvent(this.createLocalRowEvent(h.EVENT_MOUSE_ENTER))},h.prototype.onMouseLeave=function(){this.dispatchLocalEvent(this.createLocalRowEvent(h.EVENT_MOUSE_LEAVE))},h.prototype.getFirstChildOfFirstChild=function(r){for(var t=this,n=!0,c=!1,f=null;n&&!c;){var y=t.parent;v(y)&&t.firstChild?y.rowGroupColumn===r&&(c=!0,f=y):n=!1,t=y}return c?f:null},h.prototype.isFullWidthCell=function(){var r=this.beans.gridOptionsWrapper.getIsFullWidthCellFunc();return!!r&&r(this)},h.prototype.getRoute=function(){if(null!=this.key){for(var r=[],t=this;null!=t.key;)r.push(t.key),t=t.parent;return r.reverse()}},h.ID_PREFIX_ROW_GROUP="row-group-",h.ID_PREFIX_TOP_PINNED="t-",h.ID_PREFIX_BOTTOM_PINNED="b-",h.OBJECT_ID_SEQUENCE=0,h.EVENT_ROW_SELECTED="rowSelected",h.EVENT_DATA_CHANGED="dataChanged",h.EVENT_CELL_CHANGED="cellChanged",h.EVENT_ALL_CHILDREN_COUNT_CHANGED="allChildrenCountChanged",h.EVENT_MASTER_CHANGED="masterChanged",h.EVENT_MOUSE_ENTER="mouseEnter",h.EVENT_MOUSE_LEAVE="mouseLeave",h.EVENT_HEIGHT_CHANGED="heightChanged",h.EVENT_TOP_CHANGED="topChanged",h.EVENT_DISPLAYED_CHANGED="displayedChanged",h.EVENT_FIRST_CHILD_CHANGED="firstChildChanged",h.EVENT_LAST_CHILD_CHANGED="lastChildChanged",h.EVENT_CHILD_INDEX_CHANGED="childIndexChanged",h.EVENT_ROW_INDEX_CHANGED="rowIndexChanged",h.EVENT_EXPANDED_CHANGED="expandedChanged",h.EVENT_HAS_CHILDREN_CHANGED="hasChildrenChanged",h.EVENT_SELECTABLE_CHANGED="selectableChanged",h.EVENT_UI_LEVEL_CHANGED="uiLevelChanged",h.EVENT_HIGHLIGHT_CHANGED="rowHighlightChanged",h.EVENT_DRAGGING_CHANGED="draggingChanged",h}(),rd=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Hl=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Ds=function(h){function r(){return h.call(this,'\n            <div class="ag-selection-checkbox" role="presentation">\n                <ag-checkbox role="presentation" ref="eCheckbox"></ag-checkbox>\n            </div>')||this}return rd(r,h),r.prototype.postConstruct=function(){this.eCheckbox.setPassive(!0)},r.prototype.getCheckboxId=function(){return this.eCheckbox.getInputElement().id},r.prototype.onDataChanged=function(){this.onSelectionChanged()},r.prototype.onSelectableChanged=function(){this.showOrHideSelect()},r.prototype.onSelectionChanged=function(){var t=this.gridOptionsWrapper.getLocaleTextFunc(),n=this.rowNode.isSelected(),c=void 0===n?t("ariaIndeterminate","indeterminate"):!0===n?t("ariaChecked","checked"):t("ariaUnchecked","unchecked"),f=t("ariaRowToggleSelection","Press Space to toggle row selection");this.eCheckbox.setValue(n,!0),this.eCheckbox.setInputAriaLabel(f+" ("+c+")")},r.prototype.onCheckedClicked=function(t){var n=this.gridOptionsWrapper.isGroupSelectsFiltered();return this.rowNode.setSelectedParams({newValue:!1,rangeSelect:t.shiftKey,groupSelectsFiltered:n})},r.prototype.onUncheckedClicked=function(t){var n=this.gridOptionsWrapper.isGroupSelectsFiltered();return this.rowNode.setSelectedParams({newValue:!0,rangeSelect:t.shiftKey,groupSelectsFiltered:n})},r.prototype.init=function(t){var n=this;if(this.rowNode=t.rowNode,this.column=t.column,this.onSelectionChanged(),this.addGuiEventListener("click",function(T){return kr(T)}),this.addGuiEventListener("dblclick",function(T){return kr(T)}),this.addManagedListener(this.eCheckbox.getInputElement(),"click",function(T){var B=n.eCheckbox.getValue();void 0===n.eCheckbox.getPreviousValue()?0===n.onUncheckedClicked(T||{})&&n.onCheckedClicked(T):B?n.onCheckedClicked(T):n.onUncheckedClicked(T||{})}),this.addManagedListener(this.rowNode,un.EVENT_ROW_SELECTED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.rowNode,un.EVENT_DATA_CHANGED,this.onDataChanged.bind(this)),this.addManagedListener(this.rowNode,un.EVENT_SELECTABLE_CHANGED,this.onSelectableChanged.bind(this)),this.gridOptionsWrapper.getIsRowSelectableFunc()||this.checkboxCallbackExists()){var y=this.showOrHideSelect.bind(this);this.addManagedListener(this.eventService,Ge.EVENT_DISPLAYED_COLUMNS_CHANGED,y),this.addManagedListener(this.rowNode,un.EVENT_DATA_CHANGED,y),this.addManagedListener(this.rowNode,un.EVENT_CELL_CHANGED,y),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")},r.prototype.showOrHideSelect=function(){var t=this.rowNode.selectable;t&&this.checkboxCallbackExists()&&(t=this.column.isCellCheckboxSelection(this.rowNode)),this.setVisible(t)},r.prototype.checkboxCallbackExists=function(){var t=this.column?this.column.getColDef():null;return!!t&&"function"==typeof t.checkboxSelection},Hl([Bt("eCheckbox")],r.prototype,"eCheckbox",void 0),Hl([zt],r.prototype,"postConstruct",null),r}(dn),Wl=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Jo=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f};(function(h){h[h.ToolPanel=0]="ToolPanel",h[h.HeaderCell=1]="HeaderCell",h[h.RowDrag=2]="RowDrag",h[h.ChartPanel=3]="ChartPanel"})(e.rvo||(e.rvo={})),function(h){h[h.Up=0]="Up",h[h.Down=1]="Down"}(e.HO_||(e.HO_={})),function(h){h[h.Left=0]="Left",h[h.Right=1]="Right"}(e.poj||(e.poj={}));var ao=function(h){function r(){var n=null!==h&&h.apply(this,arguments)||this;return n.dragSourceAndParamsList=[],n.dropTargets=[],n}var t;return Wl(r,h),t=r,r.prototype.init=function(){this.ePinnedIcon=qo("columnMovePin",this.gridOptionsWrapper,null),this.eHideIcon=qo("columnMoveHide",this.gridOptionsWrapper,null),this.eMoveIcon=qo("columnMoveMove",this.gridOptionsWrapper,null),this.eLeftIcon=qo("columnMoveLeft",this.gridOptionsWrapper,null),this.eRightIcon=qo("columnMoveRight",this.gridOptionsWrapper,null),this.eGroupIcon=qo("columnMoveGroup",this.gridOptionsWrapper,null),this.eAggregateIcon=qo("columnMoveValue",this.gridOptionsWrapper,null),this.ePivotIcon=qo("columnMovePivot",this.gridOptionsWrapper,null),this.eDropNotAllowedIcon=qo("dropNotAllowed",this.gridOptionsWrapper,null)},r.prototype.addDragSource=function(n,c){void 0===c&&(c=!1);var f={eElement:n.eElement,dragStartPixels:n.dragStartPixels,onDragStart:this.onDragStart.bind(this,n),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this)};this.dragSourceAndParamsList.push({params:f,dragSource:n}),this.dragService.addDragSource(f,c)},r.prototype.removeDragSource=function(n){var c=O(this.dragSourceAndParamsList,function(f){return f.dragSource===n});c&&(this.dragService.removeDragSource(c.params),k(this.dragSourceAndParamsList,c))},r.prototype.clearDragSourceParamsList=function(){var n=this;this.dragSourceAndParamsList.forEach(function(c){return n.dragService.removeDragSource(c.params)}),this.dragSourceAndParamsList.length=0},r.prototype.nudge=function(){this.dragging&&this.onDragging(this.eventLastTime,!0)},r.prototype.onDragStart=function(n,c){this.dragging=!0,this.dragSource=n,this.eventLastTime=c,this.dragItem=this.dragSource.getDragItem(),this.lastDropTarget=this.dragSource.dragSourceDropTarget,this.dragSource.onDragStarted&&this.dragSource.onDragStarted(),this.createGhost()},r.prototype.onDragStop=function(n){if(this.eventLastTime=null,this.dragging=!1,this.dragSource.onDragStopped&&this.dragSource.onDragStopped(),this.lastDropTarget&&this.lastDropTarget.onDragStop){var c=this.createDropTargetEvent(this.lastDropTarget,n,null,null,!1);this.lastDropTarget.onDragStop(c)}this.lastDropTarget=null,this.dragItem=null,this.removeGhost()},r.prototype.onDragging=function(n,c){var f=this,y=this.getHorizontalDirection(n),T=this.getVerticalDirection(n);this.eventLastTime=n,this.positionGhost(n);var B=this.dropTargets.filter(function(ke){return f.isMouseOnDropTarget(n,ke)}),q=B.length,de=null;if(q>0&&(de=1===q?B[0]:B.reduce(function(ke,je){if(!ke)return je;var Qe=ke.getContainer(),rt=je.getContainer();return Qe.contains(rt)?je:ke})),de!==this.lastDropTarget)this.leaveLastTargetIfExists(n,y,T,c),this.enterDragTargetIfExists(de,n,y,T,c),this.lastDropTarget=de;else if(de&&de.onDragging){var Se=this.createDropTargetEvent(de,n,y,T,c);de.onDragging(Se)}},r.prototype.enterDragTargetIfExists=function(n,c,f,y,T){if(n){if(n.onDragEnter){var B=this.createDropTargetEvent(n,c,f,y,T);n.onDragEnter(B)}this.setGhostIcon(n.getIconName?n.getIconName():null)}},r.prototype.leaveLastTargetIfExists=function(n,c,f,y){if(this.lastDropTarget){if(this.lastDropTarget.onDragLeave){var T=this.createDropTargetEvent(this.lastDropTarget,n,c,f,y);this.lastDropTarget.onDragLeave(T)}this.setGhostIcon(null)}},r.prototype.getAllContainersFromDropTarget=function(n){var c=n.getSecondaryContainers?n.getSecondaryContainers():null,f=[[n.getContainer()]];return c?f.concat(c):f},r.prototype.allContainersIntersect=function(n,c){for(var f=0,y=c;f<y.length;f++){var B=y[f].getBoundingClientRect();if(0===B.width||0===B.height)return!1;if(!(n.clientX>=B.left&&n.clientX<B.right&&n.clientY>=B.top&&n.clientY<B.bottom))return!1}return!0},r.prototype.isMouseOnDropTarget=function(n,c){for(var y=!1,T=0,B=this.getAllContainersFromDropTarget(c);T<B.length;T++)if(this.allContainersIntersect(n,B[T])){y=!0;break}return y&&c.isInterestedIn(this.dragSource.type)},r.prototype.addDropTarget=function(n){this.dropTargets.push(n)},r.prototype.removeDropTarget=function(n){this.dropTargets=this.dropTargets.filter(function(c){return c.getContainer()!==n.getContainer()})},r.prototype.hasExternalDropZones=function(){return this.dropTargets.some(function(n){return n.external})},r.prototype.findExternalZone=function(n){return O(this.dropTargets.filter(function(f){return f.external}),function(f){return f.getContainer()===n.getContainer()})},r.prototype.getHorizontalDirection=function(n){var c=this.eventLastTime&&this.eventLastTime.clientX,f=n.clientX;return c===f?null:c>f?e.poj.Left:e.poj.Right},r.prototype.getVerticalDirection=function(n){var c=this.eventLastTime&&this.eventLastTime.clientY,f=n.clientY;return c===f?null:c>f?e.HO_.Up:e.HO_.Down},r.prototype.createDropTargetEvent=function(n,c,f,y,T){var B=n.getContainer(),q=B.getBoundingClientRect();return{event:c,x:c.clientX-q.left,y:c.clientY-q.top,vDirection:y,hDirection:f,dragSource:this.dragSource,fromNudge:T,dragItem:this.dragItem,api:this.gridApi,columnApi:this.columnApi,dropZoneTarget:B}},r.prototype.positionGhost=function(n){var c=this.eGhost;if(c){var y=c.getBoundingClientRect().height,T=V1()-2,B=U1()-2,q=n.pageY-y/2,de=n.pageX-10,Se=this.gridOptionsWrapper.getDocument(),ke=window.pageYOffset||Se.documentElement.scrollTop,je=window.pageXOffset||Se.documentElement.scrollLeft;T>0&&de+c.clientWidth>T+je&&(de=T+je-c.clientWidth),de<0&&(de=0),B>0&&q+c.clientHeight>B+ke&&(q=B+ke-c.clientHeight),q<0&&(q=0),c.style.left=de+"px",c.style.top=q+"px"}},r.prototype.removeGhost=function(){this.eGhost&&this.eGhostParent&&this.eGhostParent.removeChild(this.eGhost),this.eGhost=null},r.prototype.createGhost=function(){this.eGhost=ua(t.GHOST_TEMPLATE);var n=this.environment.getTheme().theme;n&&Er(this.eGhost,n),this.eGhostIcon=this.eGhost.querySelector(".ag-dnd-ghost-icon"),this.setGhostIcon(null);var c=this.eGhost.querySelector(".ag-dnd-ghost-label"),f=this.dragSource.dragItemName;Dr(f)&&(f=f()),c.innerHTML=Oe(f)||"",this.eGhost.style.height="25px",this.eGhost.style.top="20px",this.eGhost.style.left="20px";var y=this.gridOptionsWrapper.getDocument(),T=y.fullscreenElement||y.querySelector("body");this.eGhostParent=T,this.eGhostParent?this.eGhostParent.appendChild(this.eGhost):console.warn("AG Grid: could not find document body, it is needed for dragging columns")},r.prototype.setGhostIcon=function(n,c){void 0===c&&(c=!1),So(this.eGhostIcon);var f=null;switch(n||(n=this.dragSource.defaultIconName||t.ICON_NOT_ALLOWED),n){case t.ICON_PINNED:f=this.ePinnedIcon;break;case t.ICON_MOVE:f=this.eMoveIcon;break;case t.ICON_LEFT:f=this.eLeftIcon;break;case t.ICON_RIGHT:f=this.eRightIcon;break;case t.ICON_GROUP:f=this.eGroupIcon;break;case t.ICON_AGGREGATE:f=this.eAggregateIcon;break;case t.ICON_PIVOT:f=this.ePivotIcon;break;case t.ICON_NOT_ALLOWED:f=this.eDropNotAllowedIcon;break;case t.ICON_HIDE:f=this.eHideIcon}Fr(this.eGhostIcon,"ag-shake-left-to-right",c),(f!==this.eHideIcon||!this.gridOptionsWrapper.isSuppressDragLeaveHidesColumns())&&f&&this.eGhostIcon.appendChild(f)},r.ICON_PINNED="pinned",r.ICON_MOVE="move",r.ICON_LEFT="left",r.ICON_RIGHT="right",r.ICON_GROUP="group",r.ICON_AGGREGATE="aggregate",r.ICON_PIVOT="pivot",r.ICON_NOT_ALLOWED="notAllowed",r.ICON_HIDE="hide",r.GHOST_TEMPLATE='<div class="ag-dnd-ghost ag-unselectable">\n            <span class="ag-dnd-ghost-icon ag-shake-left-to-right"></span>\n            <div class="ag-dnd-ghost-label"></div>\n        </div>',Jo([Ee("dragService")],r.prototype,"dragService",void 0),Jo([Ee("environment")],r.prototype,"environment",void 0),Jo([Ee("columnApi")],r.prototype,"columnApi",void 0),Jo([Ee("gridApi")],r.prototype,"gridApi",void 0),Jo([zt],r.prototype,"init",null),Jo([Ln],r.prototype,"clearDragSourceParamsList",null),t=Jo([Kt("dragAndDropService")],r)}(ct),zl=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Na=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},jl=function(h){function r(t,n,c,f,y,T){var B=h.call(this)||this;return B.cellValueFn=t,B.rowNode=n,B.column=c,B.customGui=f,B.dragStartPixels=y,B.suppressVisibilityChange=T,B.dragSource=null,B}return zl(r,h),r.prototype.isCustomGui=function(){return null!=this.customGui},r.prototype.postConstruct=function(){if(this.customGui?this.setDragElement(this.customGui,this.dragStartPixels):(this.setTemplate('<div class="ag-drag-handle ag-row-drag" aria-hidden="true"></div>'),this.getGui().appendChild(Bi("rowDrag",this.beans.gridOptionsWrapper,null)),this.addDragSource()),this.checkCompatibility(),!this.suppressVisibilityChange){var t=this.beans.gridOptionsWrapper.isRowDragManaged()?new nd(this,this.beans,this.rowNode,this.column):new xn(this,this.beans,this.rowNode,this.column);this.createManagedBean(t,this.beans.context)}},r.prototype.setDragElement=function(t,n){this.setTemplateFromElement(t),this.addDragSource(n)},r.prototype.getSelectedCount=function(){if(!this.beans.gridOptionsWrapper.isRowDragMultiRow())return 1;var n=this.beans.selectionService.getSelectedNodes();return-1!==n.indexOf(this.rowNode)?n.length:1},r.prototype.checkCompatibility=function(){var t=this.beans.gridOptionsWrapper.isRowDragManaged();this.beans.gridOptionsWrapper.isTreeData()&&t&&Lt(function(){return console.warn("AG Grid: If using row drag with tree data, you cannot have rowDragManaged=true")},"RowDragComp.managedAndTreeData")},r.prototype.addDragSource=function(t){var n=this;void 0===t&&(t=4),this.dragSource&&this.removeDragSource();var c={rowNode:this.rowNode,columns:this.column?[this.column]:void 0,defaultTextValue:this.cellValueFn()},f=this.column&&this.column.getColDef().rowDragText;this.dragSource={type:e.rvo.RowDrag,eElement:this.getGui(),dragItemName:function(){var T=n.getSelectedCount();return f?f(c,T):1===T?n.cellValueFn():T+" rows"},getDragItem:function(){return c},dragStartPixels:t,dragSourceDomDataKey:this.beans.gridOptionsWrapper.getDomDataKey()},this.addMouseDownListenerIfNeeded(),this.beans.dragAndDropService.addDragSource(this.dragSource,!0)},r.prototype.addMouseDownListenerIfNeeded=function(){var t=this;this.customGui||!this.column||!this.gridOptionsWrapper.isEnableCellTextSelect()||this.addManagedListener(this.getGui(),"mousedown",function(n){n.preventDefault(),t.beans.focusService.setFocusedCell(t.rowNode.rowIndex,t.column,t.rowNode.rowPinned,!0)})},r.prototype.removeDragSource=function(){this.dragSource&&this.beans.dragAndDropService.removeDragSource(this.dragSource),this.dragSource=null},Na([Ee("beans")],r.prototype,"beans",void 0),Na([zt],r.prototype,"postConstruct",null),Na([Ln],r.prototype,"removeDragSource",null),r}(dn),$p=function(h){function r(t,n,c){var f=h.call(this)||this;return f.parent=t,f.rowNode=n,f.column=c,f}return zl(r,h),r.prototype.setDisplayedOrVisible=function(t){if(t)this.parent.setDisplayed(!1);else{var n=!0,c=!1;this.column&&(n=this.column.isRowDrag(this.rowNode)||this.parent.isCustomGui(),c=Dr(this.column.getColDef().rowDrag)),c?(this.parent.setDisplayed(!0),this.parent.setVisible(n)):(this.parent.setDisplayed(n),this.parent.setVisible(!0))}},r}(ct),xn=function(h){function r(t,n,c,f){var y=h.call(this,t,c,f)||this;return y.beans=n,y}return zl(r,h),r.prototype.postConstruct=function(){this.addManagedListener(this.beans.gridOptionsWrapper,"suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.addManagedListener(this.rowNode,un.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,un.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,un.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,Ge.EVENT_NEW_COLUMNS_LOADED,this.workOutVisibility.bind(this)),this.workOutVisibility()},r.prototype.onSuppressRowDrag=function(){this.workOutVisibility()},r.prototype.workOutVisibility=function(){var t=this.beans.gridOptionsWrapper.isSuppressRowDrag();this.setDisplayedOrVisible(t)},Na([zt],r.prototype,"postConstruct",null),r}($p),nd=function(h){function r(t,n,c,f){var y=h.call(this,t,c,f)||this;return y.beans=n,y}return zl(r,h),r.prototype.postConstruct=function(){this.addManagedListener(this.beans.eventService,Ge.EVENT_SORT_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,Ge.EVENT_FILTER_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,Ge.EVENT_COLUMN_ROW_GROUP_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.eventService,Ge.EVENT_NEW_COLUMNS_LOADED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,un.EVENT_DATA_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.rowNode,un.EVENT_CELL_CHANGED,this.workOutVisibility.bind(this)),this.addManagedListener(this.beans.gridOptionsWrapper,"suppressRowDrag",this.onSuppressRowDrag.bind(this)),this.workOutVisibility()},r.prototype.onSuppressRowDrag=function(){this.workOutVisibility()},r.prototype.workOutVisibility=function(){var n=this.beans.ctrlsService.getGridBodyCtrl().getRowDragFeature(),c=n&&n.shouldPreventRowMove(),f=this.beans.gridOptionsWrapper.isSuppressRowDrag(),y=this.beans.dragAndDropService.hasExternalDropZones();this.setDisplayedOrVisible(c&&!y||f)},Na([zt],r.prototype,"postConstruct",null),r}($p),xy=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),cc=function(){return cc=Object.assign||function(h){for(var r,t=1,n=arguments.length;t<n;t++)for(var c in r=arguments[t])Object.prototype.hasOwnProperty.call(r,c)&&(h[c]=r[c]);return h},cc.apply(this,arguments)},Xl=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},by=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return xy(r,h),r.prototype.init=function(t,n,c,f,y,T,B){this.params=B,this.eGui=n,this.eCheckbox=c,this.eExpanded=f,this.eContracted=y,this.comp=t,this.compClass=T;var q=this.isTopLevelFooter(),de=this.isEmbeddedRowMismatch(),Se=null==B.value,ke=!1;if(this.gridOptionsWrapper.isGroupIncludeFooter()&&this.gridOptionsWrapper.isGroupHideOpenParents()){var je=B.node;je.footer&&(ke=(B.colDef&&B.colDef.showRowGroup)!==(je.rowGroupColumn&&je.rowGroupColumn.getColId()))}this.cellIsBlank=!q&&(de||Se||ke),!this.cellIsBlank&&(this.setupShowingValueForOpenedParent(),this.findDisplayedGroupNode(),this.addFullWidthRowDraggerIfNeeded(),this.addExpandAndContract(),this.addCheckboxIfNeeded(),this.addValueElement(),this.setupIndent())},r.prototype.isTopLevelFooter=function(){if(!this.gridOptionsWrapper.isGroupIncludeTotalFooter()||null!=this.params.value||-1!=this.params.node.level)return!1;var t=this.params.colDef;if(null==t||!0===t.showRowGroup)return!0;var c=this.columnModel.getRowGroupColumns();return!c||0===c.length||c[0].getId()===t.showRowGroup},r.prototype.isEmbeddedRowMismatch=function(){if(!this.params.fullWidth||!this.gridOptionsWrapper.isEmbedFullWidthRows())return!1;var t=this.params.pinned===W.PINNED_LEFT,n=this.params.pinned===W.PINNED_RIGHT,c=!t&&!n;return this.gridOptionsWrapper.isEnableRtl()?this.columnModel.isPinningLeft()?!n:!c:this.columnModel.isPinningLeft()?!t:!c},r.prototype.findDisplayedGroupNode=function(){var t=this.params.column,n=this.params.node;if(this.showingValueForOpenedParent)for(var c=n.parent;null!=c;){if(c.rowGroupColumn&&t.isRowGroupDisplayed(c.rowGroupColumn.getId())){this.displayedGroupNode=c;break}c=c.parent}g(this.displayedGroupNode)&&(this.displayedGroupNode=n)},r.prototype.setupShowingValueForOpenedParent=function(){var t=this.params.node,n=this.params.column;if(this.gridOptionsWrapper.isGroupHideOpenParents())if(t.groupData){if(null!=t.rowGroupColumn){var f=t.rowGroupColumn.getId();if(n.isRowGroupDisplayed(f))return void(this.showingValueForOpenedParent=!1)}var T=null!=t.groupData[n.getId()];this.showingValueForOpenedParent=T}else this.showingValueForOpenedParent=!1;else this.showingValueForOpenedParent=!1},r.prototype.addValueElement=function(){this.displayedGroupNode.footer?this.addFooterValue():(this.addGroupValue(),this.addChildCount())},r.prototype.addGroupValue=function(){var t=this.adjustParamsWithDetailsFromRelatedColumn(),n=this.getInnerCompDetails(t),c=t.valueFormatted;this.comp.setInnerRenderer(n,null!=c?c:t.value)},r.prototype.adjustParamsWithDetailsFromRelatedColumn=function(){var t=this.displayedGroupNode.rowGroupColumn,n=this.params.column;if(!t)return this.params;if(null!=n&&!n.isRowGroupDisplayed(t.getId()))return this.params;var y=this.params,T=this.params,Se=this.valueFormatterService.formatValue(t,T.node,T.scope,T.value);return cc(cc({},y),{valueFormatted:Se})},r.prototype.addFooterValue=function(){var t=this.params.footerValueGetter,n="";if(t){var c=Te(this.params);c.value=this.params.value,"function"==typeof t?n=t(c):"string"==typeof t?n=this.expressionService.evaluate(t,c):console.warn("AG Grid: footerValueGetter should be either a function or a string (expression)")}else n="Total "+(null!=this.params.value?this.params.value:"");var f=this.getInnerCompDetails(this.params);this.comp.setInnerRenderer(f,n)},r.prototype.getInnerCompDetails=function(t){var n=this;if(t.fullWidth)return this.userComponentFactory.getFullWidthGroupRowInnerCellRenderer(this.gridOptions.groupRowRendererParams,t);var c=this.userComponentFactory.getInnerRendererDetails(t,t),f=function(Se){return Se&&Se.componentClass==n.compClass};if(c&&!f(c))return c;var y=this.displayedGroupNode.rowGroupColumn,T=y?y.getColDef():void 0;if(T){var B=this.userComponentFactory.getCellRendererDetails(T,t);if(B&&!f(B))return B;if(f(B)&&T.cellRendererParams&&T.cellRendererParams.innerRenderer)return this.userComponentFactory.getInnerRendererDetails(T.cellRendererParams,t)}},r.prototype.addChildCount=function(){this.params.suppressCount||(this.addManagedListener(this.displayedGroupNode,un.EVENT_ALL_CHILDREN_COUNT_CHANGED,this.updateChildCount.bind(this)),this.updateChildCount())},r.prototype.updateChildCount=function(){var t=this.displayedGroupNode.allChildrenCount,n=this.isShowRowGroupForThisRow();this.comp.setChildCount(n&&null!=t&&t>=0?"("+t+")":"")},r.prototype.isShowRowGroupForThisRow=function(){if(this.gridOptionsWrapper.isTreeData())return!0;var t=this.displayedGroupNode.rowGroupColumn;if(!t)return!1;var n=this.params.column;return null==n||n.isRowGroupDisplayed(t.getId())},r.prototype.addExpandAndContract=function(){var t=this.params,n=Bi("groupExpanded",this.gridOptionsWrapper,null),c=Bi("groupContracted",this.gridOptionsWrapper,null);n&&this.eExpanded.appendChild(n),c&&this.eContracted.appendChild(c);var f=t.eGridCell;!this.gridOptionsWrapper.isEnableGroupEdit()&&this.isExpandable()&&!t.suppressDoubleClickExpand&&this.addManagedListener(f,"dblclick",this.onCellDblClicked.bind(this)),this.addManagedListener(this.eExpanded,"click",this.onExpandClicked.bind(this)),this.addManagedListener(this.eContracted,"click",this.onExpandClicked.bind(this)),this.addManagedListener(f,"keydown",this.onKeyDown.bind(this)),this.addManagedListener(t.node,un.EVENT_EXPANDED_CHANGED,this.showExpandAndContractIcons.bind(this)),this.showExpandAndContractIcons();var y=this.onRowNodeIsExpandableChanged.bind(this);this.addManagedListener(this.displayedGroupNode,un.EVENT_ALL_CHILDREN_COUNT_CHANGED,y),this.addManagedListener(this.displayedGroupNode,un.EVENT_MASTER_CHANGED,y),this.addManagedListener(this.displayedGroupNode,un.EVENT_HAS_CHILDREN_CHANGED,y)},r.prototype.onExpandClicked=function(t){fr(t)||(kr(t),this.onExpandOrContract())},r.prototype.onExpandOrContract=function(){var t=this.displayedGroupNode;t.setExpanded(!t.expanded)},r.prototype.isExpandable=function(){if(this.showingValueForOpenedParent)return!0;var t=this.displayedGroupNode,n=this.columnModel.isPivotMode()&&t.leafGroup;if(!t.isExpandable()||t.footer||n)return!1;var f=this.params.column;return null==f||"string"!=typeof f.getColDef().showRowGroup||this.isShowRowGroupForThisRow()},r.prototype.showExpandAndContractIcons=function(){var t=this,c=t.displayedGroupNode,f=t.columnModel,y=t.params.node,T=this.isExpandable();if(T){var B=!!this.showingValueForOpenedParent||y.expanded;this.comp.setExpandedDisplayed(B),this.comp.setContractedDisplayed(!B)}else this.comp.setExpandedDisplayed(!1),this.comp.setContractedDisplayed(!1);var q=f.isPivotMode(),de=q&&c.leafGroup,Se=T&&!de,ke=y.footer&&-1===y.level;this.comp.addOrRemoveCssClass("ag-cell-expandable",Se),this.comp.addOrRemoveCssClass("ag-row-group",Se),q?this.comp.addOrRemoveCssClass("ag-pivot-leaf-group",de):ke||this.comp.addOrRemoveCssClass("ag-row-group-leaf-indent",!Se)},r.prototype.onRowNodeIsExpandableChanged=function(){this.showExpandAndContractIcons(),this.setIndent()},r.prototype.setupIndent=function(){this.params.suppressPadding||(this.addManagedListener(this.params.node,un.EVENT_UI_LEVEL_CHANGED,this.setIndent.bind(this)),this.setIndent())},r.prototype.setIndent=function(){if(!this.gridOptionsWrapper.isGroupHideOpenParents()){var t=this.params,n=t.node,c=!!t.colDef,f=this.gridOptionsWrapper.isTreeData(),T=!c||f||!0===t.colDef.showRowGroup?n.uiLevel:0;t.padding>=0&&Lt(function(){return console.warn("AG Grid: cellRendererParams.padding no longer works, it was deprecated in since v14.2 and removed in v26, configuring padding for groupCellRenderer should be done with Sass variables and themes. Please see the AG Grid documentation page for Themes, in particular the property $row-group-indent-size.")},"groupCellRenderer->doDeprecatedWay"),this.indentClass&&this.comp.addOrRemoveCssClass(this.indentClass,!1),this.indentClass="ag-row-group-indent-"+T,this.comp.addOrRemoveCssClass(this.indentClass,!0)}},r.prototype.addFullWidthRowDraggerIfNeeded=function(){var t=this;if(this.params.fullWidth&&this.params.rowDrag){var n=new jl(function(){return t.params.value},this.params.node);this.createManagedBean(n,this.context),this.eGui.insertAdjacentElement("afterbegin",n.getGui())}},r.prototype.isUserWantsSelected=function(){var t=this.params.checkbox;return"function"==typeof t?t(this.params):!0===t},r.prototype.addCheckboxIfNeeded=function(){var t=this,n=this.displayedGroupNode,c=this.isUserWantsSelected()&&!n.footer&&!n.rowPinned&&!n.detail;if(c){var f=new Ds;this.getContext().createBean(f),f.init({rowNode:n,column:this.params.column}),this.eCheckbox.appendChild(f.getGui()),this.addDestroyFunc(function(){return t.getContext().destroyBean(f)})}this.comp.setCheckboxVisible(c)},r.prototype.onKeyDown=function(t){ku(t,Yt.ENTER)&&!this.params.suppressEnterExpand&&(this.params.column&&this.params.column.isCellEditable(this.params.node)||this.onExpandOrContract())},r.prototype.onCellDblClicked=function(t){fr(t)||st(this.eExpanded,t)||st(this.eContracted,t)||this.onExpandOrContract()},Xl([Ee("expressionService")],r.prototype,"expressionService",void 0),Xl([Ee("valueFormatterService")],r.prototype,"valueFormatterService",void 0),Xl([Ee("columnModel")],r.prototype,"columnModel",void 0),Xl([Ee("userComponentFactory")],r.prototype,"userComponentFactory",void 0),Xl([Ee("gridOptions")],r.prototype,"gridOptions",void 0),r}(ct),H4=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ju=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},ol=function(h){function r(){return h.call(this,r.TEMPLATE)||this}return H4(r,h),r.prototype.init=function(t){var n=this,c={setInnerRenderer:function(q,de){return n.setRenderDetails(q,de)},setChildCount:function(q){return n.eChildCount.innerHTML=q},addOrRemoveCssClass:function(q,de){return n.addOrRemoveCssClass(q,de)},setContractedDisplayed:function(q){return Nn(n.eContracted,q)},setExpandedDisplayed:function(q){return Nn(n.eExpanded,q)},setCheckboxVisible:function(q){return Fr(n.eCheckbox,"ag-invisible",!q)}},f=this.createManagedBean(new by),y=!t.colDef,T=this.getGui();f.init(c,T,this.eCheckbox,this.eExpanded,this.eContracted,this.constructor,t),y&&co(T,"gridcell")},r.prototype.setRenderDetails=function(t,n){var c=this;if(t){var f=t.newAgStackInstance();if(!f)return;f.then(function(y){if(y){var T=function(){return c.context.destroyBean(y)};c.isAlive()?(c.eValue.appendChild(y.getGui()),c.addDestroyFunc(T)):T()}})}else this.eValue.innerText=n},r.prototype.destroy=function(){this.getContext().destroyBean(this.innerCellRenderer),h.prototype.destroy.call(this)},r.prototype.refresh=function(){return!1},r.TEMPLATE='<span class="ag-cell-wrapper">\n            <span class="ag-group-expanded" ref="eExpanded"></span>\n            <span class="ag-group-contracted" ref="eContracted"></span>\n            <span class="ag-group-checkbox ag-invisible" ref="eCheckbox"></span>\n            <span class="ag-group-value" ref="eValue"></span>\n            <span class="ag-group-child-count" ref="eChildCount"></span>\n        </span>',Ju([Ee("userComponentFactory")],r.prototype,"userComponentFactory",void 0),Ju([Bt("eExpanded")],r.prototype,"eExpanded",void 0),Ju([Bt("eContracted")],r.prototype,"eContracted",void 0),Ju([Bt("eCheckbox")],r.prototype,"eCheckbox",void 0),Ju([Bt("eValue")],r.prototype,"eValue",void 0),Ju([Bt("eChildCount")],r.prototype,"eChildCount",void 0),r}(dn),W4=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),bi=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},id=function(h){function r(){return h.call(this,r.TEMPLATE)||this}return W4(r,h),r.prototype.init=function(t){t.node.failedLoad?this.setupFailed():this.setupLoading()},r.prototype.setupFailed=function(){this.eLoadingText.innerText="ERR"},r.prototype.setupLoading=function(){var t=Bi("groupLoading",this.gridOptionsWrapper,null);t&&this.eLoadingIcon.appendChild(t);var n=this.gridOptionsWrapper.getLocaleTextFunc();this.eLoadingText.innerText=n("loadingOoo","Loading")},r.prototype.refresh=function(t){return!1},r.TEMPLATE='<div class="ag-loading">\n            <span class="ag-loading-icon" ref="eLoadingIcon"></span>\n            <span class="ag-loading-text" ref="eLoadingText"></span>\n        </div>',bi([Bt("eLoadingIcon")],r.prototype,"eLoadingIcon",void 0),bi([Bt("eLoadingText")],r.prototype,"eLoadingText",void 0),r}(dn),Zu=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),z4=function(h){function r(){return h.call(this)||this}return Zu(r,h),r.prototype.destroy=function(){h.prototype.destroy.call(this)},r.prototype.init=function(t){var n=this.gridOptionsWrapper.getOverlayLoadingTemplate()?this.gridOptionsWrapper.getOverlayLoadingTemplate():r.DEFAULT_LOADING_OVERLAY_TEMPLATE,c=this.gridOptionsWrapper.getLocaleTextFunc(),f=n.replace("[LOADING...]",c("loadingOoo","Loading..."));this.setTemplate(f)},r.DEFAULT_LOADING_OVERLAY_TEMPLATE='<span class="ag-overlay-loading-center">[LOADING...]</span>',r}(dn),Ay=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Zo=function(h){function r(){return h.call(this)||this}return Ay(r,h),r.prototype.destroy=function(){h.prototype.destroy.call(this)},r.prototype.init=function(t){var n=this.gridOptionsWrapper.getOverlayNoRowsTemplate()?this.gridOptionsWrapper.getOverlayNoRowsTemplate():r.DEFAULT_NO_ROWS_TEMPLATE,c=this.gridOptionsWrapper.getLocaleTextFunc(),f=n.replace("[NO_ROWS_TO_SHOW]",c("noRowsToShow","No Rows To Show"));this.setTemplate(f)},r.DEFAULT_NO_ROWS_TEMPLATE='<span class="ag-overlay-no-rows-center">[NO_ROWS_TO_SHOW]</span>',r}(dn),Ia=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),ev=function(h){function r(){return h.call(this,'<div class="ag-tooltip"></div>')||this}return Ia(r,h),r.prototype.init=function(t){var n=t.value;this.getGui().innerHTML=Oe(n)},r}(nl),fc=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),al=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},od=function(h){function r(){var t=null!==h&&h.apply(this,arguments)||this;return t.agGridDefaults={agDateInput:Rs,agColumnHeader:gy,agColumnGroupHeader:ac,agTextColumnFloatingFilter:zu,agNumberColumnFloatingFilter:zp,agDateColumnFloatingFilter:Zf,agReadOnlyFloatingFilter:es,agAnimateShowChangeCellRenderer:Qp,agAnimateSlideCellRenderer:il,agGroupCellRenderer:ol,agGroupRowRenderer:ol,agLoadingCellRenderer:id,agCellEditor:Ku,agTextCellEditor:Ku,agSelectCellEditor:Yu,agPopupTextCellEditor:td,agPopupSelectCellEditor:qu,agLargeTextCellEditor:Yp,agTextColumnFilter:ic,agNumberColumnFilter:$f,agDateColumnFilter:Jf,agLoadingOverlay:z4,agNoRowsOverlay:Zo,agTooltipComponent:ev},t.agDeprecatedNames={set:{newComponentName:"agSetColumnFilter",propertyHolder:"filter"},text:{newComponentName:"agTextColumnFilter",propertyHolder:"filter"},number:{newComponentName:"agNumberColumnFilter",propertyHolder:"filter"},date:{newComponentName:"agDateColumnFilter",propertyHolder:"filter"},group:{newComponentName:"agGroupCellRenderer",propertyHolder:"cellRenderer"},animateShowChange:{newComponentName:"agAnimateShowChangeCellRenderer",propertyHolder:"cellRenderer"},animateSlide:{newComponentName:"agAnimateSlideCellRenderer",propertyHolder:"cellRenderer"},select:{newComponentName:"agSelectCellEditor",propertyHolder:"cellEditor"},largeText:{newComponentName:"agLargeTextCellEditor",propertyHolder:"cellEditor"},popupSelect:{newComponentName:"agPopupSelectCellEditor",propertyHolder:"cellEditor"},popupText:{newComponentName:"agPopupTextCellEditor",propertyHolder:"cellEditor"},richSelect:{newComponentName:"agRichSelectCellEditor",propertyHolder:"cellEditor"},headerComponent:{newComponentName:"agColumnHeader",propertyHolder:"headerComponent"}},t.jsComponents={},t.frameworkComponents={},t}return fc(r,h),r.prototype.init=function(){var t=this;null!=this.gridOptions.components&&ce(this.gridOptions.components,function(n,c){return t.registerComponent(n,c)}),null!=this.gridOptions.frameworkComponents&&ce(this.gridOptions.frameworkComponents,function(n,c){return t.registerFwComponent(n,c)})},r.prototype.registerDefaultComponent=function(t,n){var c=this.translateIfDeprecated(t);this.agGridDefaults[c]?console.error("Trying to overwrite a default component. You should call registerComponent"):this.agGridDefaults[c]=n},r.prototype.registerComponent=function(t,n){var c=this.translateIfDeprecated(t);this.frameworkComponents[c]?console.error("Trying to register a component that you have already registered for frameworks: "+c):this.jsComponents[c]=n},r.prototype.registerFwComponent=function(t,n){var c=this.translateIfDeprecated(t);this.jsComponents[c]?console.error("Trying to register a component that you have already registered for plain javascript: "+c):this.frameworkComponents[c]=n},r.prototype.retrieve=function(t){var n=this.translateIfDeprecated(t),c=this.frameworkComponents[n]||this.getFrameworkOverrides().frameworkComponent(n);if(c)return{componentFromFramework:!0,component:c};var f=this.jsComponents[n];if(f)return{componentFromFramework:!1,component:f};var y=this.agGridDefaults[n];return y?{componentFromFramework:!1,component:y}:(Object.keys(this.agGridDefaults).indexOf(n)<0&&console.warn("AG Grid: Looking for component ["+n+"] but it wasn't found."),null)},r.prototype.translateIfDeprecated=function(t){var n=this.agDeprecatedNames[t];return null!=n?(Lt(function(){console.warn("ag-grid. Since v15.0 component names have been renamed to be namespaced. You should rename "+n.propertyHolder+":"+t+" to "+n.propertyHolder+":"+n.newComponentName)},"DEPRECATE_COMPONENT_"+t),n.newComponentName):t},al([Ee("gridOptions")],r.prototype,"gridOptions",void 0),al([zt],r.prototype,"init",null),al([Kt("userComponentRegistry")],r)}(ct),My={propertyName:"dateComponent",isCellRenderer:function(){return!1}},Ty={propertyName:"headerComponent",isCellRenderer:function(){return!1}},j4={propertyName:"headerGroupComponent",isCellRenderer:function(){return!1}},Ey={propertyName:"cellRenderer",isCellRenderer:function(){return!0}},tv={propertyName:"cellEditor",isCellRenderer:function(){return!1}},Eo={propertyName:"innerRenderer",isCellRenderer:function(){return!0}},ad={propertyName:"loadingOverlayComponent",isCellRenderer:function(){return!1}},Yl={propertyName:"noRowsOverlayComponent",isCellRenderer:function(){return!1}},X4={propertyName:"tooltipComponent",isCellRenderer:function(){return!1}},rv={propertyName:"filter",isCellRenderer:function(){return!1}},Ry={propertyName:"floatingFilterComponent",isCellRenderer:function(){return!1}},Dy={propertyName:"toolPanel",isCellRenderer:function(){return!1}},Oy={propertyName:"statusPanel",isCellRenderer:function(){return!1}},Py=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),ql=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},sd=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return Py(r,h),r.prototype.getHeaderCompDetails=function(t,n){return this.getCompDetails(t,Ty,"agColumnHeader",n)},r.prototype.getHeaderGroupCompDetails=function(t){var n=t.columnGroup.getColGroupDef();return this.getCompDetails(n,j4,"agColumnGroupHeader",t)},r.prototype.getFullWidthCellRendererDetails=function(t,n,c){return this.getCompDetails(this.gridOptions,{propertyName:n,isCellRenderer:function(){return!0}},c,t)},r.prototype.getInnerRendererDetails=function(t,n){return this.getCompDetails(t,Eo,null,n)},r.prototype.getFullWidthGroupRowInnerCellRenderer=function(t,n){return this.getCompDetails(t,Eo,null,n)},r.prototype.getCellRendererDetails=function(t,n){return this.getCompDetails(t,Ey,null,n)},r.prototype.getCellEditorDetails=function(t,n){return this.getCompDetails(t,tv,"agCellEditor",n,!0)},r.prototype.getFilterDetails=function(t,n,c){return this.getCompDetails(t,rv,c,n,!0)},r.prototype.getDateCompDetails=function(t){return this.getCompDetails(this.gridOptions,My,"agDateInput",t,!0)},r.prototype.getLoadingOverlayCompDetails=function(t){return this.getCompDetails(this.gridOptions,ad,"agLoadingOverlay",t,!0)},r.prototype.getNoRowsOverlayCompDetails=function(t){return this.getCompDetails(this.gridOptions,Yl,"agNoRowsOverlay",t,!0)},r.prototype.getTooltipCompDetails=function(t){return this.getCompDetails(t.colDef,X4,"agTooltipComponent",t,!0)},r.prototype.getSetFilterCellRendererDetails=function(t,n){return this.getCompDetails(t,Ey,null,n)},r.prototype.getFloatingFilterCompDetails=function(t,n,c){return this.getCompDetails(t,Ry,c,n)},r.prototype.getToolPanelCompDetails=function(t,n){return this.getCompDetails(t,Dy,null,n,!0)},r.prototype.getStatusPanelCompDetails=function(t,n){return this.getCompDetails(t,Oy,null,n,!0)},r.prototype.getCompDetails=function(t,n,c,f,y){var T=this;void 0===y&&(y=!1);var q,de,Se,B=n.propertyName;if(t){var ke=t,je=ke[B+"Selector"],Qe=je?je(f):null;Qe?(q=Qe.component,de=Qe.frameworkComponent,Se=Qe.params):(q=ke[B],de=ke[B+"Framework"]),!0===q&&(q=void 0)}var rt=function(on){var Br=T.userComponentRegistry.retrieve(on);Br?(q=Br.componentFromFramework?void 0:Br.component,de=Br.componentFromFramework?Br.component:void 0):(q=void 0,de=void 0)};if("string"==typeof q&&rt(q),null==q&&null==de&&null!=c&&rt(c),q&&!this.agComponentUtils.doesImplementIComponent(q)&&(q=this.agComponentUtils.adaptFunction(B,q)),q||de){var Ut=this.mergeParamsWithApplicationProvidedParams(t,B,f,Se),Rt=null==q,qt=q||de;return{componentFromFramework:Rt,componentClass:qt,params:Ut,type:n,newAgStackInstance:function(on){return T.newAgStackInstance(qt,Rt,Ut,n,on)}}}y&&console.error("Could not find component "+((t?t[B]:c)||c)+", did you forget to configure this component?")},r.prototype.newAgStackInstance=function(t,n,c,f,y){var B;if(n){var de=this.componentMetadataProvider.retrieve(f.propertyName);B=this.frameworkComponentWrapper.wrap(t,de.mandatoryMethodList,de.optionalMethodList,f,y)}else B=new t;var Se=this.initComponent(B,c);return null==Se?Di.resolve(B):Se.then(function(){return B})},r.prototype.mergeParamsWithApplicationProvidedParams=function(t,n,c,f){void 0===f&&(f=null);var y={};pt(y,c);var T=t?t[n+"Params"]:null;return null!=T&&("function"==typeof T?pt(y,T(c)):"object"==typeof T&&pt(y,T)),pt(y,f),y},r.prototype.initComponent=function(t,n){if(this.context.createBean(t),null!=t.init)return t.init(n)},ql([Ee("gridOptions")],r.prototype,"gridOptions",void 0),ql([Ee("agComponentUtils")],r.prototype,"agComponentUtils",void 0),ql([Ee("componentMetadataProvider")],r.prototype,"componentMetadataProvider",void 0),ql([Ee("userComponentRegistry")],r.prototype,"userComponentRegistry",void 0),ql([Nr("frameworkComponentWrapper")],r.prototype,"frameworkComponentWrapper",void 0),ql([Kt("userComponentFactory")],r)}(ct),dc=function(){function h(){}return h.parse=function(r){if(!r)return null;if(!0===r)return{toolPanels:[h.DEFAULT_COLUMN_COMP,h.DEFAULT_FILTER_COMP],defaultToolPanel:"columns"};if("string"==typeof r)return h.parse([r]);if(Array.isArray(r)){var t=[];return r.forEach(function(c){var f=h.DEFAULT_BY_KEY[c];f?t.push(f):console.warn("ag-grid: the key "+c+" is not a valid key for specifying a tool panel, valid keys are: "+Object.keys(h.DEFAULT_BY_KEY).join(","))}),0===t.length?null:{toolPanels:t,defaultToolPanel:t[0].id}}return{toolPanels:h.parseComponents(r.toolPanels),defaultToolPanel:r.defaultToolPanel,hiddenByDefault:r.hiddenByDefault,position:r.position}},h.parseComponents=function(r){var t=[];return r&&r.forEach(function(n){var c=null;if("string"==typeof n){var f=h.DEFAULT_BY_KEY[n];if(!f)return void console.warn("ag-grid: the key "+n+" is not a valid key for specifying a tool panel, valid keys are: "+Object.keys(h.DEFAULT_BY_KEY).join(","));c=f}else c=n;t.push(c)}),t},h.DEFAULT_BY_KEY={columns:h.DEFAULT_COLUMN_COMP={id:"columns",labelDefault:"Columns",labelKey:"columns",iconKey:"columns",toolPanel:"agColumnsToolPanel"},filters:h.DEFAULT_FILTER_COMP={id:"filters",labelDefault:"Filters",labelKey:"filters",iconKey:"filter",toolPanel:"agFiltersToolPanel"}},h}(),ka=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},nv=function(h,r){return function(t,n){r(t,n,h)}},sl=function(){for(var h=0,r=0,t=arguments.length;r<t;r++)h+=arguments[r].length;var n=Array(h),c=0;for(r=0;r<t;r++)for(var f=arguments[r],y=0,T=f.length;y<T;y++,c++)n[c]=f[y];return n};function Ot(h){return!0===h||"true"===h}function iv(h){return"number"==typeof h?h:"string"==typeof h?parseInt(h,10):void 0}function ud(h,r){var t=parseInt(h,10);return Or(t)&&t>0?t:r}var vr=function(){function h(){this.propertyEventService=new Zn,this.domDataKey="__AG_"+Math.random().toString(),this.destroyed=!1}var r;return r=h,h.prototype.agWire=function(t,n){this.gridOptions.api=t,this.gridOptions.columnApi=n,this.checkForDeprecated(),this.checkForViolations()},h.prototype.destroy=function(){this.gridOptions.api=null,this.gridOptions.columnApi=null,this.destroyed=!0},h.prototype.init=function(){var t=this;!0!==this.gridOptions.suppressPropertyNamesCheck&&(this.checkGridOptionsProperties(),this.checkColumnDefProperties()),null!=this.gridOptions.sideBar&&(this.gridOptions.sideBar=dc.parse(this.gridOptions.sideBar));var n=this.useAsyncEvents();if(this.eventService.addGlobalListener(this.globalEventHandler.bind(this),n),this.isGroupSelectsChildren()&&this.isSuppressParentsInRowNodes()&&console.warn("AG Grid: 'groupSelectsChildren' does not work with 'suppressParentsInRowNodes', this selection method needs the part in rowNode to work"),this.isGroupSelectsChildren()&&(this.isRowSelectionMulti()||console.warn("AG Grid: rowSelection must be 'multiple' for groupSelectsChildren to make sense"),this.isRowModelServerSide()&&console.warn("AG Grid: group selects children is NOT support for Server Side Row Model. This is because the rows are lazy loaded, so selecting a group is not possible asthe grid has no way of knowing what the children are.")),this.isGroupRemoveSingleChildren()&&this.isGroupHideOpenParents()&&console.warn("AG Grid: groupRemoveSingleChildren and groupHideOpenParents do not work with each other, you need to pick one. And don't ask us how to us these together on our support forum either you will get the same answer!"),this.isRowModelServerSide()){var c=function(T){return"AG Grid: '"+T+"' is not supported on the Server-Side Row Model"};v(this.gridOptions.groupDefaultExpanded)&&console.warn(c("groupDefaultExpanded")),v(this.gridOptions.groupDefaultExpanded)&&console.warn(c("groupIncludeFooter")),v(this.gridOptions.groupDefaultExpanded)&&console.warn(c("groupIncludeTotalFooter"))}this.isEnableRangeSelection()&&ne.assertRegistered(e.GXE.RangeSelectionModule,"enableRangeSelection"),!this.isEnableRangeSelection()&&(this.isEnableRangeHandle()||this.isEnableFillHandle())&&console.warn("AG Grid: 'enableRangeHandle' and 'enableFillHandle' will not work unless 'enableRangeSelection' is set to true");var f=function(T){t.gridOptions.icons&&t.gridOptions.icons[T]&&console.warn("gridOptions.icons."+T+" is no longer supported. For information on how to style checkboxes and radio buttons, see https://www.ag-grid.com/javascript-grid-icons/")};f("radioButtonOff"),f("radioButtonOn"),f("checkboxChecked"),f("checkboxUnchecked"),f("checkboxIndeterminate"),this.getScrollbarWidth()},h.prototype.checkColumnDefProperties=function(){var t=this;null!=this.gridOptions.columnDefs&&this.gridOptions.columnDefs.forEach(function(n){var c=Object.getOwnPropertyNames(n),f=sl(Qn.ALL_PROPERTIES,Qn.FRAMEWORK_PROPERTIES);t.checkProperties(c,f,f,"colDef","https://www.ag-grid.com/javascript-grid-column-properties/")})},h.prototype.checkGridOptionsProperties=function(){var t=Object.getOwnPropertyNames(this.gridOptions),n=sl(ja.ALL_PROPERTIES,ja.FRAMEWORK_PROPERTIES,D(Ge).map(function(f){return Wo.getCallbackForEvent(f)})),c=sl(n,["api","columnApi"]);this.checkProperties(t,c,n,"gridOptions","https://www.ag-grid.com/javascript-grid-properties/")},h.prototype.checkProperties=function(t,n,c,f,y){var T=ey(t,n,c);ce(T,function(B,q){console.warn("ag-grid: invalid "+f+" property '"+B+"' did you mean any of these: "+q.slice(0,8).join(", "))}),Object.keys(T).length>0&&console.warn("ag-grid: to see all the valid "+f+" properties please check: "+y)},h.prototype.getDomDataKey=function(){return this.domDataKey},h.prototype.getDomData=function(t,n){var c=t[this.getDomDataKey()];return c?c[n]:void 0},h.prototype.setDomData=function(t,n,c){var f=this.getDomDataKey(),y=t[f];g(y)&&(t[f]=y={}),y[n]=c},h.prototype.isRowSelection=function(){return"single"===this.gridOptions.rowSelection||"multiple"===this.gridOptions.rowSelection},h.prototype.isSuppressRowDeselection=function(){return Ot(this.gridOptions.suppressRowDeselection)},h.prototype.isRowSelectionMulti=function(){return"multiple"===this.gridOptions.rowSelection},h.prototype.isRowMultiSelectWithClick=function(){return Ot(this.gridOptions.rowMultiSelectWithClick)},h.prototype.getContext=function(){return this.gridOptions.context},h.prototype.isPivotMode=function(){return Ot(this.gridOptions.pivotMode)},h.prototype.isSuppressExpandablePivotGroups=function(){return Ot(this.gridOptions.suppressExpandablePivotGroups)},h.prototype.getPivotColumnGroupTotals=function(){return this.gridOptions.pivotColumnGroupTotals},h.prototype.getPivotRowTotals=function(){return this.gridOptions.pivotRowTotals},h.prototype.isRowModelInfinite=function(){return this.gridOptions.rowModelType===W.ROW_MODEL_TYPE_INFINITE},h.prototype.isRowModelViewport=function(){return this.gridOptions.rowModelType===W.ROW_MODEL_TYPE_VIEWPORT},h.prototype.isRowModelServerSide=function(){return this.gridOptions.rowModelType===W.ROW_MODEL_TYPE_SERVER_SIDE},h.prototype.isRowModelDefault=function(){return g(this.gridOptions.rowModelType)||this.gridOptions.rowModelType===W.ROW_MODEL_TYPE_CLIENT_SIDE},h.prototype.isFullRowEdit=function(){return"fullRow"===this.gridOptions.editType},h.prototype.isSuppressFocusAfterRefresh=function(){return Ot(this.gridOptions.suppressFocusAfterRefresh)},h.prototype.isSuppressBrowserResizeObserver=function(){return Ot(this.gridOptions.suppressBrowserResizeObserver)},h.prototype.isSuppressMaintainUnsortedOrder=function(){return Ot(this.gridOptions.suppressMaintainUnsortedOrder)},h.prototype.isSuppressClearOnFillReduction=function(){return Ot(this.gridOptions.suppressClearOnFillReduction)},h.prototype.isShowToolPanel=function(){return Ot(this.gridOptions.sideBar&&Array.isArray(this.getSideBar().toolPanels))},h.prototype.getSideBar=function(){return this.gridOptions.sideBar},h.prototype.isSuppressTouch=function(){return Ot(this.gridOptions.suppressTouch)},h.prototype.isMaintainColumnOrder=function(){return Ot(this.gridOptions.maintainColumnOrder)},h.prototype.isSuppressRowTransform=function(){return Ot(this.gridOptions.suppressRowTransform)},h.prototype.isSuppressColumnStateEvents=function(){return Ot(this.gridOptions.suppressColumnStateEvents)},h.prototype.isAllowDragFromColumnsToolPanel=function(){return Ot(this.gridOptions.allowDragFromColumnsToolPanel)},h.prototype.useAsyncEvents=function(){return!Ot(this.gridOptions.suppressAsyncEvents)},h.prototype.isEnableCellChangeFlash=function(){return Ot(this.gridOptions.enableCellChangeFlash)},h.prototype.getCellFlashDelay=function(){return this.gridOptions.cellFlashDelay||500},h.prototype.getCellFadeDelay=function(){return this.gridOptions.cellFadeDelay||1e3},h.prototype.isGroupSelectsChildren=function(){var t=Ot(this.gridOptions.groupSelectsChildren);return t&&this.isTreeData()?(console.warn("AG Grid: groupSelectsChildren does not work with tree data"),!1):t},h.prototype.isSuppressRowHoverHighlight=function(){return Ot(this.gridOptions.suppressRowHoverHighlight)},h.prototype.isColumnHoverHighlight=function(){return Ot(this.gridOptions.columnHoverHighlight)},h.prototype.isGroupSelectsFiltered=function(){return Ot(this.gridOptions.groupSelectsFiltered)},h.prototype.isGroupHideOpenParents=function(){return Ot(this.gridOptions.groupHideOpenParents)},h.prototype.isGroupMaintainOrder=function(){return Ot(this.gridOptions.groupMaintainOrder)},h.prototype.getAutoGroupColumnDef=function(){return this.gridOptions.autoGroupColumnDef},h.prototype.isGroupMultiAutoColumn=function(){return this.gridOptions.groupDisplayType?this.matchesGroupDisplayType("multipleColumns",this.gridOptions.groupDisplayType):Ot(this.gridOptions.groupHideOpenParents)},h.prototype.isGroupUseEntireRow=function(t){return!t&&!!this.gridOptions.groupDisplayType&&this.matchesGroupDisplayType("groupRows",this.gridOptions.groupDisplayType)},h.prototype.isGroupSuppressAutoColumn=function(){return!(!this.gridOptions.groupDisplayType||!this.matchesGroupDisplayType("custom",this.gridOptions.groupDisplayType))||!!this.gridOptions.treeDataDisplayType&&this.matchesTreeDataDisplayType("custom",this.gridOptions.treeDataDisplayType)},h.prototype.isGroupRemoveSingleChildren=function(){return Ot(this.gridOptions.groupRemoveSingleChildren)},h.prototype.isGroupRemoveLowestSingleChildren=function(){return Ot(this.gridOptions.groupRemoveLowestSingleChildren)},h.prototype.isGroupIncludeFooter=function(){return Ot(this.gridOptions.groupIncludeFooter)},h.prototype.isGroupIncludeTotalFooter=function(){return Ot(this.gridOptions.groupIncludeTotalFooter)},h.prototype.isGroupSuppressBlankHeader=function(){return Ot(this.gridOptions.groupSuppressBlankHeader)},h.prototype.isSuppressRowClickSelection=function(){return Ot(this.gridOptions.suppressRowClickSelection)},h.prototype.isSuppressCellSelection=function(){return Ot(this.gridOptions.suppressCellSelection)},h.prototype.isSuppressMultiSort=function(){return Ot(this.gridOptions.suppressMultiSort)},h.prototype.isMultiSortKeyCtrl=function(){return"ctrl"===this.gridOptions.multiSortKey},h.prototype.isPivotSuppressAutoColumn=function(){return Ot(this.gridOptions.pivotSuppressAutoColumn)},h.prototype.isSuppressDragLeaveHidesColumns=function(){return Ot(this.gridOptions.suppressDragLeaveHidesColumns)},h.prototype.isSuppressScrollOnNewData=function(){return Ot(this.gridOptions.suppressScrollOnNewData)},h.prototype.isSuppressScrollWhenPopupsAreOpen=function(){return Ot(this.gridOptions.suppressScrollWhenPopupsAreOpen)},h.prototype.isRowDragEntireRow=function(){return Ot(this.gridOptions.rowDragEntireRow)},h.prototype.isSuppressRowDrag=function(){return Ot(this.gridOptions.suppressRowDrag)},h.prototype.isRowDragManaged=function(){return Ot(this.gridOptions.rowDragManaged)},h.prototype.isSuppressMoveWhenRowDragging=function(){return Ot(this.gridOptions.suppressMoveWhenRowDragging)},h.prototype.isRowDragMultiRow=function(){return Ot(this.gridOptions.rowDragMultiRow)},h.prototype.getDomLayout=function(){var t=this.gridOptions.domLayout||W.DOM_LAYOUT_NORMAL;return-1===[W.DOM_LAYOUT_PRINT,W.DOM_LAYOUT_AUTO_HEIGHT,W.DOM_LAYOUT_NORMAL].indexOf(t)?(Lt(function(){return console.warn("AG Grid: "+t+" is not valid for DOM Layout, valid values are "+W.DOM_LAYOUT_NORMAL+", "+W.DOM_LAYOUT_AUTO_HEIGHT+" and "+W.DOM_LAYOUT_PRINT)},"warn about dom layout values"),W.DOM_LAYOUT_NORMAL):t},h.prototype.isSuppressHorizontalScroll=function(){return Ot(this.gridOptions.suppressHorizontalScroll)},h.prototype.isSuppressMaxRenderedRowRestriction=function(){return Ot(this.gridOptions.suppressMaxRenderedRowRestriction)},h.prototype.isExcludeChildrenWhenTreeDataFiltering=function(){return Ot(this.gridOptions.excludeChildrenWhenTreeDataFiltering)},h.prototype.isAlwaysShowHorizontalScroll=function(){return Ot(this.gridOptions.alwaysShowHorizontalScroll)},h.prototype.isAlwaysShowVerticalScroll=function(){return Ot(this.gridOptions.alwaysShowVerticalScroll)},h.prototype.isDebounceVerticalScrollbar=function(){return Ot(this.gridOptions.debounceVerticalScrollbar)},h.prototype.isSuppressLoadingOverlay=function(){return Ot(this.gridOptions.suppressLoadingOverlay)},h.prototype.isSuppressNoRowsOverlay=function(){return Ot(this.gridOptions.suppressNoRowsOverlay)},h.prototype.isSuppressFieldDotNotation=function(){return Ot(this.gridOptions.suppressFieldDotNotation)},h.prototype.getPinnedTopRowData=function(){return this.gridOptions.pinnedTopRowData},h.prototype.getPinnedBottomRowData=function(){return this.gridOptions.pinnedBottomRowData},h.prototype.isFunctionsPassive=function(){return Ot(this.gridOptions.functionsPassive)},h.prototype.isSuppressChangeDetection=function(){return Ot(this.gridOptions.suppressChangeDetection)},h.prototype.isSuppressAnimationFrame=function(){return Ot(this.gridOptions.suppressAnimationFrame)},h.prototype.getQuickFilterText=function(){return this.gridOptions.quickFilterText},h.prototype.isCacheQuickFilter=function(){return Ot(this.gridOptions.cacheQuickFilter)},h.prototype.isUnSortIcon=function(){return Ot(this.gridOptions.unSortIcon)},h.prototype.isSuppressMenuHide=function(){return Ot(this.gridOptions.suppressMenuHide)},h.prototype.isEnterMovesDownAfterEdit=function(){return Ot(this.gridOptions.enterMovesDownAfterEdit)},h.prototype.isEnterMovesDown=function(){return Ot(this.gridOptions.enterMovesDown)},h.prototype.isUndoRedoCellEditing=function(){return Ot(this.gridOptions.undoRedoCellEditing)},h.prototype.getUndoRedoCellEditingLimit=function(){return iv(this.gridOptions.undoRedoCellEditingLimit)},h.prototype.getRowStyle=function(){return this.gridOptions.rowStyle},h.prototype.getRowClass=function(){return this.gridOptions.rowClass},h.prototype.getRowStyleFunc=function(){return this.gridOptions.getRowStyle},h.prototype.getRowClassFunc=function(){return this.gridOptions.getRowClass},h.prototype.rowClassRules=function(){return this.gridOptions.rowClassRules},h.prototype.getServerSideStoreType=function(){return this.gridOptions.serverSideStoreType},h.prototype.getServerSideStoreParamsFunc=function(){return this.gridOptions.getServerSideStoreParams},h.prototype.getCreateChartContainerFunc=function(){return this.gridOptions.createChartContainer},h.prototype.getPopupParent=function(){return this.gridOptions.popupParent},h.prototype.getBlockLoadDebounceMillis=function(){return this.gridOptions.blockLoadDebounceMillis},h.prototype.getPostProcessPopupFunc=function(){return this.gridOptions.postProcessPopup},h.prototype.getPaginationNumberFormatterFunc=function(){return this.gridOptions.paginationNumberFormatter},h.prototype.getChildCountFunc=function(){return this.gridOptions.getChildCount},h.prototype.getIsApplyServerSideTransactionFunc=function(){return this.gridOptions.isApplyServerSideTransaction},h.prototype.getDefaultGroupOrderComparator=function(){return this.gridOptions.defaultGroupOrderComparator},h.prototype.getIsFullWidthCellFunc=function(){return this.gridOptions.isFullWidthCell},h.prototype.getFullWidthCellRendererParams=function(){return this.gridOptions.fullWidthCellRendererParams},h.prototype.isEmbedFullWidthRows=function(){return Ot(this.gridOptions.embedFullWidthRows)||Ot(this.gridOptions.deprecatedEmbedFullWidthRows)},h.prototype.isDetailRowAutoHeight=function(){return Ot(this.gridOptions.detailRowAutoHeight)},h.prototype.getSuppressKeyboardEventFunc=function(){return this.gridOptions.suppressKeyboardEvent},h.prototype.getBusinessKeyForNodeFunc=function(){return this.gridOptions.getBusinessKeyForNode},h.prototype.getApi=function(){return this.gridOptions.api},h.prototype.getColumnApi=function(){return this.gridOptions.columnApi},h.prototype.isImmutableData=function(){return Ot(this.gridOptions.immutableData)},h.prototype.isEnsureDomOrder=function(){return Ot(this.gridOptions.ensureDomOrder)},h.prototype.isEnableCharts=function(){return!!Ot(this.gridOptions.enableCharts)&&ne.assertRegistered(e.GXE.GridChartsModule,"enableCharts")},h.prototype.getColResizeDefault=function(){return this.gridOptions.colResizeDefault},h.prototype.isSingleClickEdit=function(){return Ot(this.gridOptions.singleClickEdit)},h.prototype.isSuppressClickEdit=function(){return Ot(this.gridOptions.suppressClickEdit)},h.prototype.isStopEditingWhenCellsLoseFocus=function(){return Ot(this.gridOptions.stopEditingWhenCellsLoseFocus)},h.prototype.getGroupDefaultExpanded=function(){return this.gridOptions.groupDefaultExpanded},h.prototype.getMaxConcurrentDatasourceRequests=function(){return this.gridOptions.maxConcurrentDatasourceRequests},h.prototype.getMaxBlocksInCache=function(){return this.gridOptions.maxBlocksInCache},h.prototype.getCacheOverflowSize=function(){return this.gridOptions.cacheOverflowSize},h.prototype.getPaginationPageSize=function(){return iv(this.gridOptions.paginationPageSize)},h.prototype.isPaginateChildRows=function(){return!(!this.isGroupRemoveSingleChildren()&&!this.isGroupRemoveLowestSingleChildren())||Ot(this.gridOptions.paginateChildRows)},h.prototype.getCacheBlockSize=function(){return ud(this.gridOptions.cacheBlockSize)},h.prototype.getInfiniteInitialRowCount=function(){return this.gridOptions.infiniteInitialRowCount},h.prototype.isPurgeClosedRowNodes=function(){return Ot(this.gridOptions.purgeClosedRowNodes)},h.prototype.isSuppressPaginationPanel=function(){return Ot(this.gridOptions.suppressPaginationPanel)},h.prototype.getRowData=function(){return this.gridOptions.rowData},h.prototype.isEnableRtl=function(){return Ot(this.gridOptions.enableRtl)},h.prototype.getRowGroupPanelShow=function(){return this.gridOptions.rowGroupPanelShow},h.prototype.getPivotPanelShow=function(){return this.gridOptions.pivotPanelShow},h.prototype.isAngularCompileRows=function(){return Ot(this.gridOptions.angularCompileRows)},h.prototype.isAngularCompileFilters=function(){return Ot(this.gridOptions.angularCompileFilters)},h.prototype.isDebug=function(){return Ot(this.gridOptions.debug)},h.prototype.getColumnDefs=function(){return this.gridOptions.columnDefs},h.prototype.getColumnTypes=function(){return this.gridOptions.columnTypes},h.prototype.getDatasource=function(){return this.gridOptions.datasource},h.prototype.getViewportDatasource=function(){return this.gridOptions.viewportDatasource},h.prototype.getServerSideDatasource=function(){return this.gridOptions.serverSideDatasource},h.prototype.isAccentedSort=function(){return Ot(this.gridOptions.accentedSort)},h.prototype.isEnableBrowserTooltips=function(){return Ot(this.gridOptions.enableBrowserTooltips)},h.prototype.isEnableCellExpressions=function(){return Ot(this.gridOptions.enableCellExpressions)},h.prototype.isEnableGroupEdit=function(){return Ot(this.gridOptions.enableGroupEdit)},h.prototype.isSuppressMiddleClickScrolls=function(){return Ot(this.gridOptions.suppressMiddleClickScrolls)},h.prototype.isPreventDefaultOnContextMenu=function(){return Ot(this.gridOptions.preventDefaultOnContextMenu)},h.prototype.isSuppressPreventDefaultOnMouseWheel=function(){return Ot(this.gridOptions.suppressPreventDefaultOnMouseWheel)},h.prototype.isSuppressColumnVirtualisation=function(){return Ot(this.gridOptions.suppressColumnVirtualisation)},h.prototype.isSuppressContextMenu=function(){return Ot(this.gridOptions.suppressContextMenu)},h.prototype.isAllowContextMenuWithControlKey=function(){return Ot(this.gridOptions.allowContextMenuWithControlKey)},h.prototype.isSuppressCopyRowsToClipboard=function(){return Ot(this.gridOptions.suppressCopyRowsToClipboard)},h.prototype.isCopyHeadersToClipboard=function(){return Ot(this.gridOptions.copyHeadersToClipboard)},h.prototype.isSuppressClipboardPaste=function(){return Ot(this.gridOptions.suppressClipboardPaste)},h.prototype.isSuppressLastEmptyLineOnPaste=function(){return Ot(this.gridOptions.suppressLastEmptyLineOnPaste)},h.prototype.isPagination=function(){return Ot(this.gridOptions.pagination)},h.prototype.isSuppressEnterpriseResetOnNewColumns=function(){return Ot(this.gridOptions.suppressEnterpriseResetOnNewColumns)},h.prototype.getProcessDataFromClipboardFunc=function(){return this.gridOptions.processDataFromClipboard},h.prototype.getAsyncTransactionWaitMillis=function(){return v(this.gridOptions.asyncTransactionWaitMillis)?this.gridOptions.asyncTransactionWaitMillis:W.BATCH_WAIT_MILLIS},h.prototype.isSuppressMovableColumns=function(){return Ot(this.gridOptions.suppressMovableColumns)},h.prototype.isAnimateRows=function(){return!this.isEnsureDomOrder()&&Ot(this.gridOptions.animateRows)},h.prototype.isSuppressColumnMoveAnimation=function(){return Ot(this.gridOptions.suppressColumnMoveAnimation)},h.prototype.isSuppressAggFuncInHeader=function(){return Ot(this.gridOptions.suppressAggFuncInHeader)},h.prototype.isSuppressAggAtRootLevel=function(){return Ot(this.gridOptions.suppressAggAtRootLevel)},h.prototype.isSuppressAggFilteredOnly=function(){return Ot(this.gridOptions.suppressAggFilteredOnly)},h.prototype.isShowOpenedGroup=function(){return Ot(this.gridOptions.showOpenedGroup)},h.prototype.isReactUi=function(){return Ot(this.gridOptions.reactUi)},h.prototype.isEnableRangeSelection=function(){return ne.isRegistered(e.GXE.RangeSelectionModule)&&Ot(this.gridOptions.enableRangeSelection)},h.prototype.isEnableRangeHandle=function(){return Ot(this.gridOptions.enableRangeHandle)},h.prototype.isEnableFillHandle=function(){return Ot(this.gridOptions.enableFillHandle)},h.prototype.getFillHandleDirection=function(){var t=this.gridOptions.fillHandleDirection;return t?"x"!==t&&"y"!==t&&"xy"!==t?(Lt(function(){return console.warn("AG Grid: valid values for fillHandleDirection are 'x', 'y' and 'xy'. Default to 'xy'.")},"warn invalid fill direction"),"xy"):t:"xy"},h.prototype.getFillOperation=function(){return this.gridOptions.fillOperation},h.prototype.isSuppressMultiRangeSelection=function(){return Ot(this.gridOptions.suppressMultiRangeSelection)},h.prototype.isPaginationAutoPageSize=function(){return Ot(this.gridOptions.paginationAutoPageSize)},h.prototype.isRememberGroupStateWhenNewData=function(){return Ot(this.gridOptions.rememberGroupStateWhenNewData)},h.prototype.getIcons=function(){return this.gridOptions.icons},h.prototype.getAggFuncs=function(){return this.gridOptions.aggFuncs},h.prototype.getSortingOrder=function(){return this.gridOptions.sortingOrder},h.prototype.getAlignedGrids=function(){return this.gridOptions.alignedGrids},h.prototype.isMasterDetail=function(){return!!Ot(this.gridOptions.masterDetail)&&ne.assertRegistered(e.GXE.MasterDetailModule,"masterDetail")},h.prototype.isKeepDetailRows=function(){return Ot(this.gridOptions.keepDetailRows)},h.prototype.getKeepDetailRowsCount=function(){var t=this.gridOptions.keepDetailRowsCount;return v(t)&&t>0?this.gridOptions.keepDetailRowsCount:10},h.prototype.getIsRowMasterFunc=function(){return this.gridOptions.isRowMaster},h.prototype.getIsRowSelectableFunc=function(){return this.gridOptions.isRowSelectable},h.prototype.getGroupRowRendererParams=function(){return this.gridOptions.groupRowRendererParams},h.prototype.getOverlayLoadingTemplate=function(){return this.gridOptions.overlayLoadingTemplate},h.prototype.getOverlayNoRowsTemplate=function(){return this.gridOptions.overlayNoRowsTemplate},h.prototype.isSuppressAutoSize=function(){return Ot(this.gridOptions.suppressAutoSize)},h.prototype.isEnableCellTextSelection=function(){return Ot(this.gridOptions.enableCellTextSelection)},h.prototype.isSuppressParentsInRowNodes=function(){return Ot(this.gridOptions.suppressParentsInRowNodes)},h.prototype.isSuppressClipboardApi=function(){return Ot(this.gridOptions.suppressClipboardApi)},h.prototype.isFunctionsReadOnly=function(){return Ot(this.gridOptions.functionsReadOnly)},h.prototype.isFloatingFilter=function(){return this.gridOptions.floatingFilter},h.prototype.isEnableCellTextSelect=function(){return Ot(this.gridOptions.enableCellTextSelection)},h.prototype.isEnableOldSetFilterModel=function(){return Ot(this.gridOptions.enableOldSetFilterModel)},h.prototype.getDefaultColDef=function(){return this.gridOptions.defaultColDef},h.prototype.getDefaultColGroupDef=function(){return this.gridOptions.defaultColGroupDef},h.prototype.getDefaultExportParams=function(t){return this.gridOptions.defaultExportParams?(console.warn("AG Grid: Since v25.2 `defaultExportParams`  has been replaced by `default"+Pe(t)+"ExportParams`'"),this.gridOptions.defaultExportParams):"csv"===t&&this.gridOptions.defaultCsvExportParams?this.gridOptions.defaultCsvExportParams:"excel"===t&&this.gridOptions.defaultExcelExportParams?this.gridOptions.defaultExcelExportParams:void 0},h.prototype.isSuppressCsvExport=function(){return Ot(this.gridOptions.suppressCsvExport)},h.prototype.isAllowShowChangeAfterFilter=function(){return Ot(this.gridOptions.allowShowChangeAfterFilter)},h.prototype.isSuppressExcelExport=function(){return Ot(this.gridOptions.suppressExcelExport)},h.prototype.isSuppressMakeColumnVisibleAfterUnGroup=function(){return Ot(this.gridOptions.suppressMakeColumnVisibleAfterUnGroup)},h.prototype.getDataPathFunc=function(){return this.gridOptions.getDataPath},h.prototype.getIsServerSideGroupFunc=function(){return this.gridOptions.isServerSideGroup},h.prototype.getIsServerSideGroupOpenByDefaultFunc=function(){return this.gridOptions.isServerSideGroupOpenByDefault},h.prototype.getIsGroupOpenByDefaultFunc=function(){return this.gridOptions.isGroupOpenByDefault},h.prototype.getServerSideGroupKeyFunc=function(){return this.gridOptions.getServerSideGroupKey},h.prototype.getGroupRowAggNodesFunc=function(){return this.gridOptions.groupRowAggNodes},h.prototype.getContextMenuItemsFunc=function(){return this.gridOptions.getContextMenuItems},h.prototype.getMainMenuItemsFunc=function(){return this.gridOptions.getMainMenuItems},h.prototype.getRowNodeIdFunc=function(){return this.gridOptions.getRowNodeId},h.prototype.getNavigateToNextHeaderFunc=function(){return this.gridOptions.navigateToNextHeader},h.prototype.getTabToNextHeaderFunc=function(){return this.gridOptions.tabToNextHeader},h.prototype.getNavigateToNextCellFunc=function(){return this.gridOptions.navigateToNextCell},h.prototype.getTabToNextCellFunc=function(){return this.gridOptions.tabToNextCell},h.prototype.getGridTabIndex=function(){return(this.gridOptions.tabIndex||0).toString()},h.prototype.isTreeData=function(){return!!Ot(this.gridOptions.treeData)&&ne.assertRegistered(e.GXE.RowGroupingModule,"Tree Data")},h.prototype.isValueCache=function(){return Ot(this.gridOptions.valueCache)},h.prototype.isValueCacheNeverExpires=function(){return Ot(this.gridOptions.valueCacheNeverExpires)},h.prototype.isDeltaSort=function(){return Ot(this.gridOptions.deltaSort)},h.prototype.isAggregateOnlyChangedColumns=function(){return Ot(this.gridOptions.aggregateOnlyChangedColumns)},h.prototype.getProcessSecondaryColDefFunc=function(){return this.gridOptions.processSecondaryColDef},h.prototype.getProcessSecondaryColGroupDefFunc=function(){return this.gridOptions.processSecondaryColGroupDef},h.prototype.getSendToClipboardFunc=function(){return this.gridOptions.sendToClipboard},h.prototype.getProcessRowPostCreateFunc=function(){return this.gridOptions.processRowPostCreate},h.prototype.getProcessCellForClipboardFunc=function(){return this.gridOptions.processCellForClipboard},h.prototype.getProcessHeaderForClipboardFunc=function(){return this.gridOptions.processHeaderForClipboard},h.prototype.getProcessCellFromClipboardFunc=function(){return this.gridOptions.processCellFromClipboard},h.prototype.getViewportRowModelPageSize=function(){return ud(this.gridOptions.viewportRowModelPageSize,5)},h.prototype.getViewportRowModelBufferSize=function(){return function(h,r){return h>=0?h:5}(this.gridOptions.viewportRowModelBufferSize)},h.prototype.isServerSideSortingAlwaysResets=function(){return Ot(this.gridOptions.serverSideSortingAlwaysResets)},h.prototype.isServerSideFilteringAlwaysResets=function(){return Ot(this.gridOptions.serverSideFilteringAlwaysResets)},h.prototype.getPostSortFunc=function(){return this.gridOptions.postSort},h.prototype.getChartToolbarItemsFunc=function(){return this.gridOptions.getChartToolbarItems},h.prototype.getChartThemeOverrides=function(){return this.gridOptions.chartThemeOverrides},h.prototype.getCustomChartThemes=function(){return this.gridOptions.customChartThemes},h.prototype.getChartThemes=function(){return this.gridOptions.chartThemes||["ag-default","ag-material","ag-pastel","ag-vivid","ag-solar"]},h.prototype.getClipboardDeliminator=function(){return v(this.gridOptions.clipboardDeliminator)?this.gridOptions.clipboardDeliminator:"\t"},h.prototype.setProperty=function(t,n,c){void 0===c&&(c=!1);var f=this.gridOptions,y=f[t];(c||y!==n)&&(f[t]=n,this.propertyEventService.dispatchEvent({type:t,currentValue:n,previousValue:y}))},h.prototype.addEventListener=function(t,n){this.propertyEventService.addEventListener(t,n)},h.prototype.removeEventListener=function(t,n){this.propertyEventService.removeEventListener(t,n)},h.prototype.isSkipHeaderOnAutoSize=function(){return!!this.gridOptions.skipHeaderOnAutoSize},h.prototype.getAutoSizePadding=function(){var t=this.gridOptions.autoSizePadding;return null!=t&&t>=0?t:20},h.prototype.getHeaderHeight=function(){return"number"==typeof this.gridOptions.headerHeight?this.gridOptions.headerHeight:this.getFromTheme(25,"headerHeight")},h.prototype.getFloatingFiltersHeight=function(){return"number"==typeof this.gridOptions.floatingFiltersHeight?this.gridOptions.floatingFiltersHeight:this.getFromTheme(25,"headerHeight")},h.prototype.getGroupHeaderHeight=function(){return"number"==typeof this.gridOptions.groupHeaderHeight?this.gridOptions.groupHeaderHeight:this.getHeaderHeight()},h.prototype.getPivotHeaderHeight=function(){return"number"==typeof this.gridOptions.pivotHeaderHeight?this.gridOptions.pivotHeaderHeight:this.getHeaderHeight()},h.prototype.getPivotGroupHeaderHeight=function(){return"number"==typeof this.gridOptions.pivotGroupHeaderHeight?this.gridOptions.pivotGroupHeaderHeight:this.getGroupHeaderHeight()},h.prototype.isExternalFilterPresent=function(){return"function"==typeof this.gridOptions.isExternalFilterPresent&&this.gridOptions.isExternalFilterPresent()},h.prototype.doesExternalFilterPass=function(t){return"function"==typeof this.gridOptions.doesExternalFilterPass&&this.gridOptions.doesExternalFilterPass(t)},h.prototype.getTooltipShowDelay=function(){var t=this.gridOptions.tooltipShowDelay;return v(t)?(t<0&&console.warn("ag-grid: tooltipShowDelay should not be lower than 0"),Math.max(200,t)):null},h.prototype.isTooltipMouseTrack=function(){return Ot(this.gridOptions.tooltipMouseTrack)},h.prototype.isSuppressModelUpdateAfterUpdateTransaction=function(){return Ot(this.gridOptions.suppressModelUpdateAfterUpdateTransaction)},h.prototype.getDocument=function(){var t=null;return this.gridOptions.getDocument&&v(this.gridOptions.getDocument)&&(t=this.gridOptions.getDocument()),t&&v(t)?t:document},h.prototype.getMinColWidth=function(){var t=this.gridOptions.minColWidth;if(v(t)&&t>r.MIN_COL_WIDTH)return this.gridOptions.minColWidth;var n=this.getFromTheme(null,"headerCellMinWidth");return v(n)?Math.max(n,r.MIN_COL_WIDTH):r.MIN_COL_WIDTH},h.prototype.getMaxColWidth=function(){return this.gridOptions.maxColWidth&&this.gridOptions.maxColWidth>r.MIN_COL_WIDTH?this.gridOptions.maxColWidth:null},h.prototype.getColWidth=function(){return"number"!=typeof this.gridOptions.colWidth||this.gridOptions.colWidth<r.MIN_COL_WIDTH?200:this.gridOptions.colWidth},h.prototype.getRowBuffer=function(){var t=this.gridOptions.rowBuffer;return"number"==typeof t?t<0&&(Lt(function(){return console.warn("AG Grid: rowBuffer should not be negative")},"warn rowBuffer negative"),this.gridOptions.rowBuffer=t=0):t=W.ROW_BUFFER_SIZE,t},h.prototype.getRowBufferInPixels=function(){return this.getRowBuffer()*this.getRowHeightAsNumber()},h.prototype.getScrollbarWidth=function(){if(null==this.scrollbarWidth){var n="number"==typeof this.gridOptions.scrollbarWidth&&this.gridOptions.scrollbarWidth>=0?this.gridOptions.scrollbarWidth:If();null!=n&&(this.scrollbarWidth=n,this.eventService.dispatchEvent({type:Ge.EVENT_SCROLLBAR_WIDTH_CHANGED}))}return this.scrollbarWidth},h.prototype.checkForDeprecated=function(){var t=this.gridOptions;t.deprecatedEmbedFullWidthRows&&console.warn("AG Grid: since v21.2, deprecatedEmbedFullWidthRows has been replaced with embedFullWidthRows."),t.enableOldSetFilterModel&&console.warn("AG Grid: since v22.x, enableOldSetFilterModel is deprecated. Please move to the new Set Filter Model as the old one may not be supported in v23 onwards."),t.floatingFilter&&(console.warn("AG Grid: since v23.1, floatingFilter on the gridOptions is deprecated. Please use floatingFilter on the colDef instead."),t.defaultColDef||(t.defaultColDef={}),null==t.defaultColDef.floatingFilter&&(t.defaultColDef.floatingFilter=!0)),t.rowDeselection&&console.warn("AG Grid: since v24.x, rowDeselection is deprecated and the behaviour is true by default. Please use `suppressRowDeselection` to prevent rows from being deselected."),t.enableMultiRowDragging&&(t.rowDragMultiRow=!0,delete t.enableMultiRowDragging,console.warn("AG Grid: since v26.1, `enableMultiRowDragging` is deprecated. Please use `rowDragMultiRow`."));var n=function(T,B,q){null!=t[T]&&(console.warn("ag-grid: since version "+q+", '"+T+"' is deprecated / renamed, please use the new property name '"+B+"' instead."),null==t[B]&&(t[B]=t[T]))};if(n("batchUpdateWaitMillis","asyncTransactionWaitMillis","23.1.x"),n("deltaRowDataMode","immutableData","23.1.x"),(t.immutableColumns||t.deltaColumnMode)&&console.warn("AG Grid: since v24.0, immutableColumns and deltaColumnMode properties are gone. The grid now works like this as default. To keep column order maintained, set grid property applyColumnDefOrder=true"),n("suppressSetColumnStateEvents","suppressColumnStateEvents","24.0.x"),t.groupRowInnerRenderer||t.groupRowInnerRendererParams||t.groupRowInnerRendererFramework){console.warn("AG Grid: since v24.0, grid properties groupRowInnerRenderer, groupRowInnerRendererFramework and groupRowInnerRendererParams are no longer used."),console.warn("  Instead use the grid properties groupRowRendererParams.innerRenderer, groupRowRendererParams.innerRendererFramework and groupRowRendererParams.innerRendererParams."),console.warn("  For example instead of this:"),console.warn('    groupRowInnerRenderer: "myRenderer"'),console.warn("    groupRowInnerRendererParams: {x: a}"),console.warn("  Replace with this:"),console.warn("    groupRowRendererParams: {"),console.warn('      innerRenderer: "myRenderer",'),console.warn("      innerRendererParams: {x: a}"),console.warn("    }"),console.warn("  We have copied the properties over for you. However to stop this error message, please change your application code."),t.groupRowRendererParams||(t.groupRowRendererParams={});var c=t.groupRowRendererParams;t.groupRowInnerRenderer&&(c.innerRenderer=t.groupRowInnerRenderer),t.groupRowInnerRendererParams&&(c.innerRendererParams=t.groupRowInnerRendererParams),t.groupRowInnerRendererFramework&&(c.innerRendererFramework=t.groupRowInnerRendererFramework)}t.rememberGroupStateWhenNewData&&console.warn("AG Grid: since v24.0, grid property rememberGroupStateWhenNewData is deprecated. This feature was provided before Transaction Updates worked (which keep group state). Now that transaction updates are possible and they keep group state, this feature is no longer needed."),t.detailCellRendererParams&&t.detailCellRendererParams.autoHeight&&(console.warn("AG Grid: since v24.1, grid property detailCellRendererParams.autoHeight is replaced with grid property detailRowAutoHeight. This allows this feature to work when you provide a custom DetailCellRenderer"),t.detailRowAutoHeight=!0),t.suppressKeyboardEvent&&console.warn("AG Grid: since v24.1 suppressKeyboardEvent in the gridOptions has been deprecated and will be removed in\n                 future versions of AG Grid. If you need this to be set for every column use the defaultColDef property."),t.suppressEnterpriseResetOnNewColumns&&console.warn("AG Grid: since v25, grid property suppressEnterpriseResetOnNewColumns is deprecated. This was a temporary property to allow changing columns in Server Side Row Model without triggering a reload. Now that it is possible to dynamically change columns in the grid, this is no longer needed."),t.suppressColumnStateEvents&&console.warn('AG Grid: since v25, grid property suppressColumnStateEvents no longer works due to a refactor that we did. It should be possible to achieve similar using event.source, which would be "api" if the event was due to setting column state via the API'),t.defaultExportParams&&console.warn("AG Grid: since v25.2, the grid property `defaultExportParams` has been replaced by `defaultCsvExportParams` and `defaultExcelExportParams`."),t.stopEditingWhenGridLosesFocus&&(console.warn("AG Grid: since v25.2.2, the grid property `stopEditingWhenGridLosesFocus` has been replaced by `stopEditingWhenCellsLoseFocus`."),t.stopEditingWhenCellsLoseFocus=!0),t.applyColumnDefOrder&&console.warn("AG Grid: since v26.0, the grid property `applyColumnDefOrder` is no longer needed, as this is the default behaviour. To turn this behaviour off, set maintainColumnOrder=true"),t.groupMultiAutoColumn&&(console.warn("AG Grid: since v26.0, the grid property `groupMultiAutoColumn` has been replaced by `groupDisplayType = 'multipleColumns'`"),t.groupDisplayType="multipleColumns"),t.groupUseEntireRow&&(console.warn("AG Grid: since v26.0, the grid property `groupUseEntireRow` has been replaced by `groupDisplayType = 'groupRows'`"),t.groupDisplayType="groupRows"),t.groupSuppressAutoColumn&&(console.warn("AG Grid: since v26.0, the grid property `groupSuppressAutoColumn` has been replaced by `"+(t.treeData?"treeDataDisplayType":"groupDisplayType")+" = 'custom'`"),t.groupDisplayType="custom"),t.defaultGroupSortComparator&&(console.warn("AG Grid: since v26.0, the grid property `defaultGroupSortComparator` has been replaced by `defaultGroupOrderComparator`"),t.defaultGroupOrderComparator=t.defaultGroupSortComparator),t.colWidth&&console.warn("AG Grid: since v26.1, the grid property `colWidth` is deprecated and should be set via `defaultColDef.width`."),t.minColWidth&&console.warn("AG Grid: since v26.1, the grid property `minColWidth` is deprecated and should be set via `defaultColDef.minWidth`."),t.maxColWidth&&console.warn("AG Grid: since v26.1, the grid property `maxColWidth` is deprecated and should be set via `defaultColDef.maxWidth`.")},h.prototype.checkForViolations=function(){this.isTreeData()&&this.treeDataViolations()},h.prototype.treeDataViolations=function(){this.isRowModelDefault()&&g(this.getDataPathFunc())&&console.warn("AG Grid: property usingTreeData=true with rowModel=clientSide, but you did not provide getDataPath function, please provide getDataPath function if using tree data."),this.isRowModelServerSide()&&(g(this.getIsServerSideGroupFunc())&&console.warn("AG Grid: property usingTreeData=true with rowModel=serverSide, but you did not provide isServerSideGroup function, please provide isServerSideGroup function if using tree data."),g(this.getServerSideGroupKeyFunc())&&console.warn("AG Grid: property usingTreeData=true with rowModel=serverSide, but you did not provide getServerSideGroupKey function, please provide getServerSideGroupKey function if using tree data."))},h.prototype.getLocaleTextFunc=function(){if(this.gridOptions.localeTextFunc)return this.gridOptions.localeTextFunc;var t=this.gridOptions.localeText;return function(n,c){return t&&t[n]?t[n]:c}},h.prototype.globalEventHandler=function(t,n){if(!this.destroyed){var c=Wo.getCallbackForEvent(t);"function"==typeof this.gridOptions[c]&&this.gridOptions[c](n)}},h.prototype.getRowHeightAsNumber=function(){return!this.gridOptions.rowHeight||g(this.gridOptions.rowHeight)?this.getDefaultRowHeight():this.gridOptions.rowHeight&&this.isNumeric(this.gridOptions.rowHeight)?this.gridOptions.rowHeight:(console.warn("AG Grid row height must be a number if not using standard row model"),this.getDefaultRowHeight())},h.prototype.getRowHeightForNode=function(t,n,c){if(void 0===n&&(n=!1),null==c&&(c=this.getDefaultRowHeight()),"function"==typeof this.gridOptions.getRowHeight){if(n)return{height:this.getDefaultRowHeight(),estimated:!0};var y=this.gridOptions.getRowHeight({node:t,data:t.data,api:this.gridOptions.api,context:this.gridOptions.context});if(this.isNumeric(y))return 0===y&&Lt(function(){return console.warn("AG Grid: The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead.")},"invalidRowHeight"),{height:Math.max(1,y),estimated:!1}}return t.detail&&this.isMasterDetail()?this.isNumeric(this.gridOptions.detailRowHeight)?{height:this.gridOptions.detailRowHeight,estimated:!1}:{height:300,estimated:!1}:{height:this.gridOptions.rowHeight&&this.isNumeric(this.gridOptions.rowHeight)?this.gridOptions.rowHeight:c,estimated:!1}},h.prototype.isDynamicRowHeight=function(){return"function"==typeof this.gridOptions.getRowHeight},h.prototype.getListItemHeight=function(){return this.getFromTheme(20,"listItemHeight")},h.prototype.chartMenuPanelWidth=function(){return this.environment.chartMenuPanelWidth()},h.prototype.isNumeric=function(t){return!isNaN(t)&&"number"==typeof t&&isFinite(t)},h.prototype.getFromTheme=function(t,n){var c=this.environment.getTheme().theme;return c&&0===c.indexOf("ag-theme")?this.environment.getSassVariable(c,n):t},h.prototype.getDefaultRowHeight=function(){return this.getFromTheme(25,"rowHeight")},h.prototype.matchesGroupDisplayType=function(t,n){var c=["groupRows","multipleColumns","custom","singleColumn"];return c.indexOf(n)<0?(console.warn("AG Grid: '"+n+"' is not a valid groupDisplayType value - possible values are: '"+c.join("', '")+"'"),!1):n===t},h.prototype.matchesTreeDataDisplayType=function(t,n){var c=["auto","custom"];return c.indexOf(n)<0?(console.warn("AG Grid: '"+n+"' is not a valid treeDataDisplayType value - possible values are: '"+c.join("', '")+"'"),!1):n===t},h.MIN_COL_WIDTH=10,h.PROP_HEADER_HEIGHT="headerHeight",h.PROP_GROUP_REMOVE_SINGLE_CHILDREN="groupRemoveSingleChildren",h.PROP_GROUP_REMOVE_LOWEST_SINGLE_CHILDREN="groupRemoveLowestSingleChildren",h.PROP_PIVOT_HEADER_HEIGHT="pivotHeaderHeight",h.PROP_SUPPRESS_CLIPBOARD_PASTE="suppressClipboardPaste",h.PROP_GROUP_HEADER_HEIGHT="groupHeaderHeight",h.PROP_PIVOT_GROUP_HEADER_HEIGHT="pivotGroupHeaderHeight",h.PROP_NAVIGATE_TO_NEXT_CELL="navigateToNextCell",h.PROP_TAB_TO_NEXT_CELL="tabToNextCell",h.PROP_NAVIGATE_TO_NEXT_HEADER="navigateToNextHeader",h.PROP_TAB_TO_NEXT_HEADER="tabToNextHeader",h.PROP_IS_EXTERNAL_FILTER_PRESENT="isExternalFilterPresent",h.PROP_DOES_EXTERNAL_FILTER_PASS="doesExternalFilterPass",h.PROP_FLOATING_FILTERS_HEIGHT="floatingFiltersHeight",h.PROP_SUPPRESS_ROW_CLICK_SELECTION="suppressRowClickSelection",h.PROP_SUPPRESS_ROW_DRAG="suppressRowDrag",h.PROP_SUPPRESS_MOVE_WHEN_ROW_DRAG="suppressMoveWhenRowDragging",h.PROP_GET_ROW_CLASS="getRowClass",h.PROP_GET_ROW_STYLE="getRowStyle",h.PROP_GET_ROW_HEIGHT="getRowHeight",h.PROP_POPUP_PARENT="popupParent",h.PROP_DOM_LAYOUT="domLayout",h.PROP_FILL_HANDLE_DIRECTION="fillHandleDirection",h.PROP_GROUP_ROW_AGG_NODES="groupRowAggNodes",h.PROP_GET_BUSINESS_KEY_FOR_NODE="getBusinessKeyForNode",h.PROP_GET_CHILD_COUNT="getChildCount",h.PROP_PROCESS_ROW_POST_CREATE="processRowPostCreate",h.PROP_GET_ROW_NODE_ID="getRowNodeId",h.PROP_IS_FULL_WIDTH_CELL="isFullWidthCell",h.PROP_IS_ROW_SELECTABLE="isRowSelectable",h.PROP_IS_ROW_MASTER="isRowMaster",h.PROP_POST_SORT="postSort",h.PROP_GET_DOCUMENT="getDocument",h.PROP_POST_PROCESS_POPUP="postProcessPopup",h.PROP_DEFAULT_GROUP_ORDER_COMPARATOR="defaultGroupOrderComparator",h.PROP_PAGINATION_NUMBER_FORMATTER="paginationNumberFormatter",h.PROP_GET_CONTEXT_MENU_ITEMS="getContextMenuItems",h.PROP_GET_MAIN_MENU_ITEMS="getMainMenuItems",h.PROP_PROCESS_CELL_FOR_CLIPBOARD="processCellForClipboard",h.PROP_PROCESS_CELL_FROM_CLIPBOARD="processCellFromClipboard",h.PROP_SEND_TO_CLIPBOARD="sendToClipboard",h.PROP_PROCESS_TO_SECONDARY_COLDEF="processSecondaryColDef",h.PROP_PROCESS_SECONDARY_COL_GROUP_DEF="processSecondaryColGroupDef",h.PROP_GET_CHART_TOOLBAR_ITEMS="getChartToolbarItems",h.PROP_GET_SERVER_SIDE_STORE_PARAMS="getServerSideStoreParams",h.PROP_IS_SERVER_SIDE_GROUPS_OPEN_BY_DEFAULT="isServerSideGroupOpenByDefault",h.PROP_IS_APPLY_SERVER_SIDE_TRANSACTION="isApplyServerSideTransaction",h.PROP_IS_SERVER_SIDE_GROUP="isServerSideGroup",h.PROP_GET_SERVER_SIDE_GROUP_KEY="getServerSideGroupKey",ka([Ee("gridOptions")],h.prototype,"gridOptions",void 0),ka([Ee("eventService")],h.prototype,"eventService",void 0),ka([Ee("environment")],h.prototype,"environment",void 0),ka([nv(0,Dn("gridApi")),nv(1,Dn("columnApi"))],h.prototype,"agWire",null),ka([Ln],h.prototype,"destroy",null),ka([zt],h.prototype,"init",null),r=ka([Kt("gridOptionsWrapper")],h)}(),Rr=function(){function h(r,t){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=r,this.pathRoot={rowNode:t,children:null},this.mapToItems[t.id]=this.pathRoot}return h.prototype.setInactive=function(){this.active=!1},h.prototype.isActive=function(){return this.active},h.prototype.depthFirstSearchChangedPath=function(r,t){if(r.children)for(var n=0;n<r.children.length;n++)this.depthFirstSearchChangedPath(r.children[n],t);t(r.rowNode)},h.prototype.depthFirstSearchEverything=function(r,t,n){if(r.childrenAfterGroup)for(var c=0;c<r.childrenAfterGroup.length;c++){var f=r.childrenAfterGroup[c];f.childrenAfterGroup?this.depthFirstSearchEverything(r.childrenAfterGroup[c],t,n):n&&t(f)}t(r)},h.prototype.forEachChangedNodeDepthFirst=function(r,t){void 0===t&&(t=!1),this.active?this.depthFirstSearchChangedPath(this.pathRoot,r):this.depthFirstSearchEverything(this.pathRoot.rowNode,r,t)},h.prototype.executeFromRootNode=function(r){r(this.pathRoot.rowNode)},h.prototype.createPathItems=function(r){for(var t=r,n=0;!this.mapToItems[t.id];)this.mapToItems[t.id]={rowNode:t,children:null},n++,t=t.parent;return n},h.prototype.populateColumnsMap=function(r,t){var n=this;if(this.keepingColumns&&t)for(var c=r;c;)this.nodeIdsToColumns[c.id]||(this.nodeIdsToColumns[c.id]={}),t.forEach(function(f){return n.nodeIdsToColumns[c.id][f.getId()]=!0}),c=c.parent},h.prototype.linkPathItems=function(r,t){for(var n=r,c=0;c<t;c++){var f=this.mapToItems[n.id],y=this.mapToItems[n.parent.id];y.children||(y.children=[]),y.children.push(f),n=n.parent}},h.prototype.addParentNode=function(r,t){if(r&&!r.isRowPinned()){var n=this.createPathItems(r);this.linkPathItems(r,n),this.populateColumnsMap(r,t)}},h.prototype.canSkip=function(r){return this.active&&!this.mapToItems[r.id]},h.prototype.getValueColumnsForNode=function(r,t){if(!this.keepingColumns)return t;var n=this.nodeIdsToColumns[r.id];return t.filter(function(f){return n[f.getId()]})},h.prototype.getNotValueColumnsForNode=function(r,t){if(!this.keepingColumns)return null;var n=this.nodeIdsToColumns[r.id];return t.filter(function(f){return!n[f.getId()]})},h}(),ov=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),e0=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},cd=function(h,r){return function(t,n){r(t,n,h)}},Kl=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return ov(r,h),r.prototype.setBeans=function(t){this.logger=t.create("selectionService"),this.reset(),this.gridOptionsWrapper.isRowModelDefault()&&this.addManagedListener(this.eventService,Ge.EVENT_ROW_DATA_CHANGED,this.reset.bind(this))},r.prototype.init=function(){this.groupSelectsChildren=this.gridOptionsWrapper.isGroupSelectsChildren(),this.addManagedListener(this.eventService,Ge.EVENT_ROW_SELECTED,this.onRowSelected.bind(this))},r.prototype.setLastSelectedNode=function(t){this.lastSelectedNode=t},r.prototype.getLastSelectedNode=function(){return this.lastSelectedNode},r.prototype.getSelectedNodes=function(){var t=[];return ce(this.selectedNodes,function(n,c){c&&t.push(c)}),t},r.prototype.getSelectedRows=function(){var t=[];return ce(this.selectedNodes,function(n,c){c&&c.data&&t.push(c.data)}),t},r.prototype.removeGroupsFromSelection=function(){var t=this;ce(this.selectedNodes,function(n,c){c&&c.group&&(t.selectedNodes[c.id]=void 0)})},r.prototype.updateGroupsFromChildrenSelections=function(t){if(this.gridOptionsWrapper.isGroupSelectsChildren()&&this.rowModel.getType()===W.ROW_MODEL_TYPE_CLIENT_SIDE){var c=this.rowModel.getRootNode();t||(t=new Rr(!0,c)).setInactive(),t.forEachChangedNodeDepthFirst(function(f){f!==c&&f.calculateSelectedFromChildren()})}},r.prototype.getNodeForIdIfSelected=function(t){return this.selectedNodes[t]},r.prototype.clearOtherNodes=function(t){var n=this,c={},f=0;return ce(this.selectedNodes,function(y,T){T&&T.id!==t.id&&(f+=n.selectedNodes[T.id].setSelectedParams({newValue:!1,clearSelection:!1,suppressFinishActions:!0}),n.groupSelectsChildren&&T.parent&&(c[T.parent.id]=T.parent))}),ce(c,function(y,T){T.calculateSelectedFromChildren()}),f},r.prototype.onRowSelected=function(t){var n=t.node;this.groupSelectsChildren&&n.group||(this.selectedNodes[n.id]=n.isSelected()?n:void 0)},r.prototype.syncInRowNode=function(t,n){this.syncInOldRowNode(t,n),this.syncInNewRowNode(t)},r.prototype.syncInOldRowNode=function(t,n){v(n)&&t.id!==n.id&&n&&this.selectedNodes[n.id]==t&&(this.selectedNodes[n.id]=n)},r.prototype.syncInNewRowNode=function(t){v(this.selectedNodes[t.id])?(t.setSelectedInitialValue(!0),this.selectedNodes[t.id]=t):t.setSelectedInitialValue(!1)},r.prototype.reset=function(){this.logger.log("reset"),this.selectedNodes={},this.lastSelectedNode=null},r.prototype.getBestCostNodeSelection=function(){if(this.rowModel.getType()===W.ROW_MODEL_TYPE_CLIENT_SIDE){var n=this.rowModel.getTopLevelNodes();if(null!==n){var c=[];return function f(y){for(var T=0,B=y.length;T<B;T++){var q=y[T];q.isSelected()?c.push(q):q.group&&q.children&&f(q.children)}}(n),c}console.warn("selectAll not available doing rowModel=virtual")}else console.warn("getBestCostNodeSelection is only available when using normal row model")},r.prototype.setRowModel=function(t){this.rowModel=t},r.prototype.isEmpty=function(){var t=0;return ce(this.selectedNodes,function(n,c){c&&t++}),0===t},r.prototype.deselectAllRowNodes=function(t){void 0===t&&(t=!1);var n=function(B){return B.selectThisNode(!1)},c=this.rowModel.getType()===W.ROW_MODEL_TYPE_CLIENT_SIDE;if(t){if(!c)return void console.error("AG Grid: selecting just filtered only works with In Memory Row Model");this.rowModel.forEachNodeAfterFilter(n)}else ce(this.selectedNodes,function(T,B){B&&n(B)}),this.reset();c&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(),this.eventService.dispatchEvent({type:Ge.EVENT_SELECTION_CHANGED,api:this.gridApi,columnApi:this.columnApi})},r.prototype.selectAllRowNodes=function(t){if(void 0===t&&(t=!1),this.rowModel.getType()!==W.ROW_MODEL_TYPE_CLIENT_SIDE)throw new Error("selectAll only available with normal row model, ie not "+this.rowModel.getType());var n=this.rowModel,c=function(T){return T.selectThisNode(!0)};t?n.forEachNodeAfterFilter(c):n.forEachNode(c),this.rowModel.getType()===W.ROW_MODEL_TYPE_CLIENT_SIDE&&this.groupSelectsChildren&&this.updateGroupsFromChildrenSelections(),this.eventService.dispatchEvent({type:Ge.EVENT_SELECTION_CHANGED,api:this.gridApi,columnApi:this.columnApi})},r.prototype.selectNode=function(t,n){t&&t.setSelectedParams({newValue:!0,clearSelection:!n})},r.prototype.deselectIndex=function(t){var n=this.rowModel.getRow(t);this.deselectNode(n)},r.prototype.deselectNode=function(t){t&&t.setSelectedParams({newValue:!1,clearSelection:!1})},r.prototype.selectIndex=function(t,n){var c=this.rowModel.getRow(t);this.selectNode(c,n)},e0([Ee("rowModel")],r.prototype,"rowModel",void 0),e0([Ee("columnApi")],r.prototype,"columnApi",void 0),e0([Ee("gridApi")],r.prototype,"gridApi",void 0),e0([cd(0,Dn("loggerFactory"))],r.prototype,"setBeans",null),e0([zt],r.prototype,"init",null),e0([Kt("selectionService")],r)}(ct),fd=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},av=function(){function h(){}return h.prototype.sizeColumnsToFit=function(r){void 0===r&&console.error("AG Grid: missing parameter to columnApi.sizeColumnsToFit(gridWidth)"),this.columnModel.sizeColumnsToFit(r,"api")},h.prototype.setColumnGroupOpened=function(r,t){this.columnModel.setColumnGroupOpened(r,t,"api")},h.prototype.getColumnGroup=function(r,t){return this.columnModel.getColumnGroup(r,t)},h.prototype.getOriginalColumnGroup=function(r){return this.columnModel.getOriginalColumnGroup(r)},h.prototype.getDisplayNameForColumn=function(r,t){return this.columnModel.getDisplayNameForColumn(r,t)||""},h.prototype.getDisplayNameForColumnGroup=function(r,t){return this.columnModel.getDisplayNameForColumnGroup(r,t)||""},h.prototype.getColumn=function(r){return this.columnModel.getPrimaryColumn(r)},h.prototype.applyColumnState=function(r){return this.columnModel.applyColumnState(r,"api")},h.prototype.getColumnState=function(){return this.columnModel.getColumnState()},h.prototype.resetColumnState=function(){this.columnModel.resetColumnState("api")},h.prototype.getColumnGroupState=function(){return this.columnModel.getColumnGroupState()},h.prototype.setColumnGroupState=function(r){this.columnModel.setColumnGroupState(r,"api")},h.prototype.resetColumnGroupState=function(){this.columnModel.resetColumnGroupState("api")},h.prototype.isPinning=function(){return this.columnModel.isPinningLeft()||this.columnModel.isPinningRight()},h.prototype.isPinningLeft=function(){return this.columnModel.isPinningLeft()},h.prototype.isPinningRight=function(){return this.columnModel.isPinningRight()},h.prototype.getDisplayedColAfter=function(r){return this.columnModel.getDisplayedColAfter(r)},h.prototype.getDisplayedColBefore=function(r){return this.columnModel.getDisplayedColBefore(r)},h.prototype.setColumnVisible=function(r,t){this.columnModel.setColumnVisible(r,t,"api")},h.prototype.setColumnsVisible=function(r,t){this.columnModel.setColumnsVisible(r,t,"api")},h.prototype.setColumnPinned=function(r,t){this.columnModel.setColumnPinned(r,t,"api")},h.prototype.setColumnsPinned=function(r,t){this.columnModel.setColumnsPinned(r,t,"api")},h.prototype.getAllColumns=function(){return this.columnModel.getAllPrimaryColumns()},h.prototype.getAllGridColumns=function(){return this.columnModel.getAllGridColumns()},h.prototype.getDisplayedLeftColumns=function(){return this.columnModel.getDisplayedLeftColumns()},h.prototype.getDisplayedCenterColumns=function(){return this.columnModel.getDisplayedCenterColumns()},h.prototype.getDisplayedRightColumns=function(){return this.columnModel.getDisplayedRightColumns()},h.prototype.getAllDisplayedColumns=function(){return this.columnModel.getAllDisplayedColumns()},h.prototype.getAllDisplayedVirtualColumns=function(){return this.columnModel.getViewportColumns()},h.prototype.moveColumn=function(r,t){"number"==typeof r?(console.warn("AG Grid: you are using moveColumn(fromIndex, toIndex) - moveColumn takes a column key and a destination index, not two indexes, to move with indexes use moveColumnByIndex(from,to) instead"),this.columnModel.moveColumnByIndex(r,t,"api")):this.columnModel.moveColumn(r,t,"api")},h.prototype.moveColumnByIndex=function(r,t){this.columnModel.moveColumnByIndex(r,t,"api")},h.prototype.moveColumns=function(r,t){this.columnModel.moveColumns(r,t,"api")},h.prototype.moveRowGroupColumn=function(r,t){this.columnModel.moveRowGroupColumn(r,t)},h.prototype.setColumnAggFunc=function(r,t){this.columnModel.setColumnAggFunc(r,t)},h.prototype.setColumnWidth=function(r,t,n,c){void 0===n&&(n=!0),this.columnModel.setColumnWidths([{key:r,newWidth:t}],!1,n,c)},h.prototype.setColumnWidths=function(r,t,n){void 0===t&&(t=!0),this.columnModel.setColumnWidths(r,!1,t,n)},h.prototype.setPivotMode=function(r){this.columnModel.setPivotMode(r)},h.prototype.isPivotMode=function(){return this.columnModel.isPivotMode()},h.prototype.getSecondaryPivotColumn=function(r,t){return this.columnModel.getSecondaryPivotColumn(r,t)},h.prototype.setValueColumns=function(r){this.columnModel.setValueColumns(r,"api")},h.prototype.getValueColumns=function(){return this.columnModel.getValueColumns()},h.prototype.removeValueColumn=function(r){this.columnModel.removeValueColumn(r,"api")},h.prototype.removeValueColumns=function(r){this.columnModel.removeValueColumns(r,"api")},h.prototype.addValueColumn=function(r){this.columnModel.addValueColumn(r,"api")},h.prototype.addValueColumns=function(r){this.columnModel.addValueColumns(r,"api")},h.prototype.setRowGroupColumns=function(r){this.columnModel.setRowGroupColumns(r,"api")},h.prototype.removeRowGroupColumn=function(r){this.columnModel.removeRowGroupColumn(r,"api")},h.prototype.removeRowGroupColumns=function(r){this.columnModel.removeRowGroupColumns(r,"api")},h.prototype.addRowGroupColumn=function(r){this.columnModel.addRowGroupColumn(r,"api")},h.prototype.addRowGroupColumns=function(r){this.columnModel.addRowGroupColumns(r,"api")},h.prototype.getRowGroupColumns=function(){return this.columnModel.getRowGroupColumns()},h.prototype.setPivotColumns=function(r){this.columnModel.setPivotColumns(r,"api")},h.prototype.removePivotColumn=function(r){this.columnModel.removePivotColumn(r,"api")},h.prototype.removePivotColumns=function(r){this.columnModel.removePivotColumns(r,"api")},h.prototype.addPivotColumn=function(r){this.columnModel.addPivotColumn(r,"api")},h.prototype.addPivotColumns=function(r){this.columnModel.addPivotColumns(r,"api")},h.prototype.getPivotColumns=function(){return this.columnModel.getPivotColumns()},h.prototype.getLeftDisplayedColumnGroups=function(){return this.columnModel.getDisplayedTreeLeft()},h.prototype.getCenterDisplayedColumnGroups=function(){return this.columnModel.getDisplayedTreeCentre()},h.prototype.getRightDisplayedColumnGroups=function(){return this.columnModel.getDisplayedTreeRight()},h.prototype.getAllDisplayedColumnGroups=function(){return this.columnModel.getAllDisplayedTrees()},h.prototype.autoSizeColumn=function(r,t){return this.columnModel.autoSizeColumn(r,t,"api")},h.prototype.autoSizeColumns=function(r,t){return this.columnModel.autoSizeColumns(r,t,"api")},h.prototype.autoSizeAllColumns=function(r){this.columnModel.autoSizeAllColumns(r,"api")},h.prototype.setSecondaryColumns=function(r){this.columnModel.setSecondaryColumns(r,"api")},h.prototype.getSecondaryColumns=function(){return this.columnModel.getSecondaryColumns()},h.prototype.getPrimaryColumns=function(){return this.columnModel.getAllPrimaryColumns()},h.prototype.cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid=function(){setTimeout(wr.removeAllReferences.bind(window,this,"Column API"),100)},h.prototype.columnGroupOpened=function(r,t){console.error("AG Grid: columnGroupOpened no longer exists, use setColumnGroupOpened"),this.setColumnGroupOpened(r,t)},h.prototype.hideColumns=function(r,t){console.error("AG Grid: hideColumns is deprecated, use setColumnsVisible"),this.columnModel.setColumnsVisible(r,!t,"api")},h.prototype.hideColumn=function(r,t){console.error("AG Grid: hideColumn is deprecated, use setColumnVisible"),this.columnModel.setColumnVisible(r,!t,"api")},h.prototype.setState=function(r){return console.error("AG Grid: setState is deprecated, use setColumnState"),this.setColumnState(r)},h.prototype.getState=function(){return console.error("AG Grid: getState is deprecated, use getColumnState"),this.getColumnState()},h.prototype.resetState=function(){console.error("AG Grid: resetState is deprecated, use resetColumnState"),this.resetColumnState()},h.prototype.getAggregationColumns=function(){return console.error("AG Grid: getAggregationColumns is deprecated, use getValueColumns"),this.columnModel.getValueColumns()},h.prototype.removeAggregationColumn=function(r){console.error("AG Grid: removeAggregationColumn is deprecated, use removeValueColumn"),this.columnModel.removeValueColumn(r,"api")},h.prototype.removeAggregationColumns=function(r){console.error("AG Grid: removeAggregationColumns is deprecated, use removeValueColumns"),this.columnModel.removeValueColumns(r,"api")},h.prototype.addAggregationColumn=function(r){console.error("AG Grid: addAggregationColumn is deprecated, use addValueColumn"),this.columnModel.addValueColumn(r,"api")},h.prototype.addAggregationColumns=function(r){console.error("AG Grid: addAggregationColumns is deprecated, use addValueColumns"),this.columnModel.addValueColumns(r,"api")},h.prototype.setColumnAggFunction=function(r,t){console.error("AG Grid: setColumnAggFunction is deprecated, use setColumnAggFunc"),this.columnModel.setColumnAggFunc(r,t,"api")},h.prototype.getDisplayNameForCol=function(r){return console.error("AG Grid: getDisplayNameForCol is deprecated, use getDisplayNameForColumn"),this.getDisplayNameForColumn(r,null)},h.prototype.setColumnState=function(r){return console.error("AG Grid: setColumnState is deprecated, use applyColumnState"),this.columnModel.applyColumnState({state:r,applyOrder:!0},"api")},fd([Ee("columnModel")],h.prototype,"columnModel",void 0),fd([Ln],h.prototype,"cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid",null),fd([Kt("columnApi")],h)}();(function(h){h[h.FILL=0]="FILL",h[h.RANGE=1]="RANGE"})(e.Lm6||(e.Lm6={})),function(h){h[h.VALUE=0]="VALUE",h[h.DIMENSION=1]="DIMENSION"}(e.StC||(e.StC={}));var t0="ag-cell-range-selected",uv=function(){function h(r,t){this.beans=r,this.cellCtrl=t}return h.prototype.setComp=function(r){this.cellComp=r,this.onRangeSelectionChanged()},h.prototype.onRangeSelectionChanged=function(){this.rangeCount=this.beans.rangeService.getCellRangeCount(this.cellCtrl.getCellPosition()),this.hasChartRange=this.getHasChartRange(),this.cellComp.addOrRemoveCssClass(t0,0!==this.rangeCount),this.cellComp.addOrRemoveCssClass(t0+"-1",1===this.rangeCount),this.cellComp.addOrRemoveCssClass(t0+"-2",2===this.rangeCount),this.cellComp.addOrRemoveCssClass(t0+"-3",3===this.rangeCount),this.cellComp.addOrRemoveCssClass(t0+"-4",this.rangeCount>=4),this.cellComp.addOrRemoveCssClass("ag-cell-range-chart",this.hasChartRange),this.cellComp.setAriaSelected(this.rangeCount>0||void 0),this.cellComp.addOrRemoveCssClass("ag-cell-range-single-cell",this.isSingleCell()),this.updateRangeBorders(),this.refreshHandle()},h.prototype.updateRangeBorders=function(){var r=this.getRangeBorders(),t=this.isSingleCell(),c=!t&&r.right,f=!t&&r.bottom,y=!t&&r.left;this.cellComp.addOrRemoveCssClass("ag-cell-range-top",!t&&r.top),this.cellComp.addOrRemoveCssClass("ag-cell-range-right",c),this.cellComp.addOrRemoveCssClass("ag-cell-range-bottom",f),this.cellComp.addOrRemoveCssClass("ag-cell-range-left",y)},h.prototype.isSingleCell=function(){var r=this.beans.rangeService;return 1===this.rangeCount&&r&&!r.isMoreThanOneCell()},h.prototype.getHasChartRange=function(){var r=this.beans.rangeService;if(!this.rangeCount||!r)return!1;var t=r.getCellRanges();return t.length>0&&t.every(function(n){return oe([e.StC.DIMENSION,e.StC.VALUE],n.type)})},h.prototype.updateRangeBordersIfRangeCount=function(){this.rangeCount>0&&(this.updateRangeBorders(),this.refreshHandle())},h.prototype.getRangeBorders=function(){var Se,ke,r=this,t=this.beans.gridOptionsWrapper.isEnableRtl(),n=!1,c=!1,f=!1,y=!1,T=this.cellCtrl.getCellPosition().column,B=this.beans,q=B.rangeService,de=B.columnModel;t?(Se=de.getDisplayedColAfter(T),ke=de.getDisplayedColBefore(T)):(Se=de.getDisplayedColBefore(T),ke=de.getDisplayedColAfter(T));var je=q.getCellRanges().filter(function(Ut){return q.isCellInSpecificRange(r.cellCtrl.getCellPosition(),Ut)});Se||(y=!0),ke||(c=!0);for(var Qe=0;Qe<je.length&&!(n&&c&&f&&y);Qe++){var rt=je[Qe],_t=q.getRangeStartRow(rt),Vt=q.getRangeEndRow(rt);!n&&this.beans.rowPositionUtils.sameRow(_t,this.cellCtrl.getCellPosition())&&(n=!0),!f&&this.beans.rowPositionUtils.sameRow(Vt,this.cellCtrl.getCellPosition())&&(f=!0),!y&&Se&&rt.columns.indexOf(Se)<0&&(y=!0),!c&&ke&&rt.columns.indexOf(ke)<0&&(c=!0)}return{top:n,right:c,bottom:f,left:y}},h.prototype.refreshHandle=function(){if(this.beans.rangeService){var r=this.shouldHaveSelectionHandle();this.selectionHandle&&!r&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),r&&this.addSelectionHandle(),this.cellComp.addOrRemoveCssClass("ag-cell-range-handle",!!this.selectionHandle)}},h.prototype.shouldHaveSelectionHandle=function(){var r=this.beans,t=r.gridOptionsWrapper,n=r.rangeService,c=n.getCellRanges(),f=c.length;if(this.rangeCount<1||f<1)return!1;var y=H(c),T=this.cellCtrl.getCellPosition(),B=t.isEnableFillHandle()&&!this.cellCtrl.isSuppressFillHandle(),q=t.isEnableRangeHandle(),de=1===f&&!this.cellCtrl.isEditing()&&(B||q);if(this.hasChartRange){var ke=c[0].type===e.StC.DIMENSION&&n.isCellInSpecificRange(T,c[0]);this.cellComp.addOrRemoveCssClass("ag-cell-range-chart-category",ke),de=y.type===e.StC.VALUE}return de&&null!=y.endRow&&n.isContiguousRange(y)&&n.isBottomRightCell(y,T)},h.prototype.addSelectionHandle=function(){var r=this.beans,t=r.gridOptionsWrapper,c=H(r.rangeService.getCellRanges()).type,y=t.isEnableFillHandle()&&g(c)?e.Lm6.FILL:e.Lm6.RANGE;this.selectionHandle&&this.selectionHandle.getType()!==y&&(this.selectionHandle=this.beans.context.destroyBean(this.selectionHandle)),this.selectionHandle||(this.selectionHandle=this.beans.selectionHandleFactory.createSelectionHandle(y)),this.selectionHandle.refresh(this.cellCtrl)},h.prototype.destroy=function(){this.beans.context.destroyBean(this.selectionHandle)},h}(),ky=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),By=function(h){function r(t,n){var c=h.call(this)||this;return c.cellCtrl=t,c.beans=n,c.column=t.getColumn(),c.rowNode=t.getRowNode(),c.setupColSpan(),c.setupRowSpan(),c}return ky(r,h),r.prototype.setupRowSpan=function(){this.rowSpan=this.column.getRowSpan(this.rowNode)},r.prototype.setComp=function(t){this.cellComp=t,this.onLeftChanged(),this.onWidthChanged(),this.applyRowSpan()},r.prototype.onDisplayColumnsChanged=function(){var t=this.getColSpanningList();X(this.colsSpanning,t)||(this.colsSpanning=t,this.onWidthChanged(),this.onLeftChanged())},r.prototype.setupColSpan=function(){null!=this.column.getColDef().colSpan&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListener(this.beans.eventService,Ge.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayColumnsChanged.bind(this)),this.addManagedListener(this.beans.eventService,Ge.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onWidthChanged.bind(this)))},r.prototype.onWidthChanged=function(){if(this.cellComp){var t=this.getCellWidth();this.cellComp.setWidth(t+"px")}},r.prototype.getCellWidth=function(){return this.colsSpanning?this.colsSpanning.reduce(function(t,n){return t+n.getActualWidth()},0):this.column.getActualWidth()},r.prototype.getColSpanningList=function(){var t=this.column.getColSpan(this.rowNode),n=[];if(1===t)n.push(this.column);else for(var c=this.column,f=this.column.getPinned(),y=0;c&&y<t&&(n.push(c),(c=this.beans.columnModel.getDisplayedColAfter(c))&&!g(c)&&f===c.getPinned());y++);return n},r.prototype.onLeftChanged=function(){if(this.cellComp){var t=this.modifyLeftForPrintLayout(this.getCellLeft());this.cellComp.setLeft(t+"px")}},r.prototype.getCellLeft=function(){return(this.beans.gridOptionsWrapper.isEnableRtl()&&this.colsSpanning?H(this.colsSpanning):this.column).getLeft()},r.prototype.modifyLeftForPrintLayout=function(t){if(!this.cellCtrl.isPrintLayout()||this.column.getPinned()===W.PINNED_LEFT)return t;var n=this.beans.columnModel.getDisplayedColumnsLeftWidth();return this.column.getPinned()===W.PINNED_RIGHT?n+this.beans.columnModel.getBodyContainerWidth()+(t||0):n+(t||0)},r.prototype.applyRowSpan=function(){if(1!==this.rowSpan){var t=this.beans.gridOptionsWrapper.getRowHeightAsNumber();this.cellComp.setHeight(t*this.rowSpan+"px"),this.cellComp.setZIndex("1")}},r.prototype.destroy=function(){h.prototype.destroy.call(this)},r}(ct),Jl=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),n0=function(h){function r(t,n){var c=h.call(this)||this;return c.staticClasses=[],c.cellCtrl=t,c.beans=n,c.column=t.getColumn(),c.rowNode=t.getRowNode(),c}return Jl(r,h),r.prototype.setComp=function(t,n){this.cellComp=t,this.scope=n,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()},r.prototype.applyCellClassRules=function(){var t=this,n=this.column.getColDef(),c={value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,colDef:n,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsWrapper.getApi(),columnApi:this.beans.gridOptionsWrapper.getColumnApi(),$scope:this.scope,context:this.beans.gridOptionsWrapper.getContext()};this.beans.stylingService.processClassRules(n.cellClassRules,c,function(f){return t.cellComp.addOrRemoveCssClass(f,!0)},function(f){return t.cellComp.addOrRemoveCssClass(f,!1)})},r.prototype.applyUserStyles=function(){var t=this.column.getColDef();if(t.cellStyle){var n;if("function"==typeof t.cellStyle){var c={column:this.column,value:this.cellCtrl.getValue(),colDef:t,data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex,$scope:this.scope,api:this.beans.gridOptionsWrapper.getApi(),columnApi:this.beans.gridOptionsWrapper.getColumnApi(),context:this.beans.gridOptionsWrapper.getContext()};n=(0,t.cellStyle)(c)}else n=t.cellStyle;this.cellComp.setUserStyles(n)}},r.prototype.applyClassesFromColDef=function(){var t=this,n=this.column.getColDef(),c={value:this.cellCtrl.getValue(),data:this.rowNode.data,node:this.rowNode,colDef:n,rowIndex:this.rowNode.rowIndex,$scope:this.scope,api:this.beans.gridOptionsWrapper.getApi(),columnApi:this.beans.gridOptionsWrapper.getColumnApi(),context:this.beans.gridOptionsWrapper.getContext()};this.staticClasses.length&&this.staticClasses.forEach(function(f){return t.cellComp.addOrRemoveCssClass(f,!1)}),this.staticClasses=this.beans.stylingService.getStaticCellClasses(n,c),this.staticClasses.length&&this.staticClasses.forEach(function(f){return t.cellComp.addOrRemoveCssClass(f,!0)})},r.prototype.destroy=function(){h.prototype.destroy.call(this)},r}(ct),Gy=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),cv=function(h){function r(t,n){var c=h.call(this)||this;return c.ctrl=t,c.beans=n,c}return Gy(r,h),r.prototype.setComp=function(t){this.comp=t,this.setupTooltip()},r.prototype.setupTooltip=function(){this.browserTooltips=this.beans.gridOptionsWrapper.isEnableBrowserTooltips(),this.updateTooltipText(),this.browserTooltips?this.comp.setTitle(null!=this.tooltipSanatised?this.tooltipSanatised:void 0):this.createTooltipFeatureIfNeeded()},r.prototype.updateTooltipText=function(){this.tooltip=this.ctrl.getTooltipValue(),this.tooltipSanatised=Oe(this.tooltip)},r.prototype.createTooltipFeatureIfNeeded=function(){var t=this;null==this.genericTooltipFeature&&(this.genericTooltipFeature=this.createManagedBean(new q0({getTooltipParams:function(){return t.getTooltipParams()},getGui:function(){return t.ctrl.getGui()}}),this.beans.context))},r.prototype.refreshToolTip=function(){this.updateTooltipText(),this.browserTooltips&&this.comp.setTitle(null!=this.tooltipSanatised?this.tooltipSanatised:void 0)},r.prototype.getTooltipParams=function(){var t=this.ctrl,n=t.getColumn?t.getColumn():void 0,c=t.getColDef?t.getColDef():void 0,f=t.getRowNode?t.getRowNode():void 0;return{location:t.getLocation(),colDef:c,column:n,rowIndex:t.getRowIndex?t.getRowIndex():void 0,node:f,data:f?f.data:void 0,value:this.getTooltipText(),valueFormatted:t.getValueFormatted?t.getValueFormatted():void 0}},r.prototype.getTooltipText=function(){return this.tooltip},r.prototype.destroy=function(){h.prototype.destroy.call(this)},r}(ct),rn=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},hd=function(){function h(){}return h.prototype.postConstruct=function(){this.doingMasterDetail=this.gridOptionsWrapper.isMasterDetail(),this.gridOptionsWrapper.isRowModelDefault()&&(this.clientSideRowModel=this.rowModel),this.gridOptionsWrapper.isRowModelServerSide()&&(this.serverSideRowModel=this.rowModel)},rn([Ee("resizeObserverService")],h.prototype,"resizeObserverService",void 0),rn([Ee("paginationProxy")],h.prototype,"paginationProxy",void 0),rn([Ee("context")],h.prototype,"context",void 0),rn([Ee("columnApi")],h.prototype,"columnApi",void 0),rn([Ee("gridApi")],h.prototype,"gridApi",void 0),rn([Ee("gridOptionsWrapper")],h.prototype,"gridOptionsWrapper",void 0),rn([Ee("expressionService")],h.prototype,"expressionService",void 0),rn([Ee("rowRenderer")],h.prototype,"rowRenderer",void 0),rn([Ee("$compile")],h.prototype,"$compile",void 0),rn([Ee("templateService")],h.prototype,"templateService",void 0),rn([Ee("valueService")],h.prototype,"valueService",void 0),rn([Ee("eventService")],h.prototype,"eventService",void 0),rn([Ee("columnModel")],h.prototype,"columnModel",void 0),rn([Ee("headerNavigationService")],h.prototype,"headerNavigationService",void 0),rn([Ee("navigationService")],h.prototype,"navigationService",void 0),rn([Ee("columnAnimationService")],h.prototype,"columnAnimationService",void 0),rn([Nr("rangeService")],h.prototype,"rangeService",void 0),rn([Ee("focusService")],h.prototype,"focusService",void 0),rn([Nr("contextMenuFactory")],h.prototype,"contextMenuFactory",void 0),rn([Ee("popupService")],h.prototype,"popupService",void 0),rn([Ee("valueFormatterService")],h.prototype,"valueFormatterService",void 0),rn([Ee("stylingService")],h.prototype,"stylingService",void 0),rn([Ee("columnHoverService")],h.prototype,"columnHoverService",void 0),rn([Ee("userComponentFactory")],h.prototype,"userComponentFactory",void 0),rn([Ee("userComponentRegistry")],h.prototype,"userComponentRegistry",void 0),rn([Ee("animationFrameService")],h.prototype,"animationFrameService",void 0),rn([Ee("dragAndDropService")],h.prototype,"dragAndDropService",void 0),rn([Ee("sortController")],h.prototype,"sortController",void 0),rn([Ee("filterManager")],h.prototype,"filterManager",void 0),rn([Ee("rowContainerHeightService")],h.prototype,"rowContainerHeightService",void 0),rn([Ee("frameworkOverrides")],h.prototype,"frameworkOverrides",void 0),rn([Ee("cellPositionUtils")],h.prototype,"cellPositionUtils",void 0),rn([Ee("rowPositionUtils")],h.prototype,"rowPositionUtils",void 0),rn([Ee("selectionService")],h.prototype,"selectionService",void 0),rn([Nr("selectionHandleFactory")],h.prototype,"selectionHandleFactory",void 0),rn([Ee("rowCssClassCalculator")],h.prototype,"rowCssClassCalculator",void 0),rn([Ee("rowModel")],h.prototype,"rowModel",void 0),rn([Ee("ctrlsService")],h.prototype,"ctrlsService",void 0),rn([Ee("ctrlsFactory")],h.prototype,"ctrlsFactory",void 0),rn([Ee("agStackComponentsRegistry")],h.prototype,"agStackComponentsRegistry",void 0),rn([Ee("valueCache")],h.prototype,"valueCache",void 0),rn([Ee("rowNodeEventThrottle")],h.prototype,"rowNodeEventThrottle",void 0),rn([zt],h.prototype,"postConstruct",null),rn([Kt("beans")],h)}(),Y4=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Vy=function(h){function r(t,n,c){var f=h.call(this)||this;return f.cellCtrl=t,f.beans=n,f.column=c,f}return Y4(r,h),r.prototype.onMouseEvent=function(t,n){if(!fr(n))switch(t){case"click":this.onCellClicked(n);break;case"mousedown":case"touchstart":this.onMouseDown(n);break;case"dblclick":this.onCellDoubleClicked(n);break;case"mouseout":this.onMouseOut(n);break;case"mouseover":this.onMouseOver(n)}},r.prototype.onCellClicked=function(t){if(this.isDoubleClickOnIPad())return this.onCellDoubleClicked(t),void t.preventDefault();var n=this.beans,c=n.eventService,f=n.gridOptionsWrapper,y=this.cellCtrl.createEvent(t,Ge.EVENT_CELL_CLICKED);c.dispatchEvent(y);var T=this.column.getColDef();T.onCellClicked&&window.setTimeout(function(){return T.onCellClicked(y)},0),(f.isSingleClickEdit()||T.singleClickEdit)&&!f.isSuppressClickEdit()&&this.cellCtrl.startRowOrCellEdit()},r.prototype.isDoubleClickOnIPad=function(){if(!bs()||Pr("dblclick"))return!1;var t=(new Date).getTime(),n=t-this.lastIPadMouseClickEvent<200;return this.lastIPadMouseClickEvent=t,n},r.prototype.onCellDoubleClicked=function(t){var n=this.column.getColDef(),c=this.cellCtrl.createEvent(t,Ge.EVENT_CELL_DOUBLE_CLICKED);this.beans.eventService.dispatchEvent(c),"function"==typeof n.onCellDoubleClicked&&window.setTimeout(function(){return n.onCellDoubleClicked(c)},0),!this.beans.gridOptionsWrapper.isSingleClickEdit()&&!this.beans.gridOptionsWrapper.isSuppressClickEdit()&&this.cellCtrl.startRowOrCellEdit()},r.prototype.onMouseDown=function(t){var n=t.ctrlKey,c=t.metaKey,f=t.shiftKey,y=t.target,T=this.beans,B=T.eventService,q=T.rangeService;if(!this.isRightClickInExistingRange(t)){var de=q&&0!=q.getCellRanges().length;if(!f||!de){var Se=(uo()||El())&&!this.cellCtrl.isEditing()&&!H1(y);this.cellCtrl.focusCell(Se)}if(f&&de&&t.preventDefault(),!this.containsWidget(y)){if(q){var ke=this.cellCtrl.getCellPosition();f?q.extendLatestRangeToCell(ke):q.setRangeToCell(ke,n||c)}B.dispatchEvent(this.cellCtrl.createEvent(t,Ge.EVENT_CELL_MOUSE_DOWN))}}},r.prototype.isRightClickInExistingRange=function(t){var n=this.beans.rangeService;return!(!n||!n.isCellInAnyRange(this.cellCtrl.getCellPosition())||2!==t.button)},r.prototype.containsWidget=function(t){return Rl(t,"ag-selection-checkbox",3)},r.prototype.onMouseOut=function(t){if(!this.mouseStayingInsideCell(t)){var n=this.cellCtrl.createEvent(t,Ge.EVENT_CELL_MOUSE_OUT);this.beans.eventService.dispatchEvent(n),this.beans.columnHoverService.clearMouseOver()}},r.prototype.onMouseOver=function(t){if(!this.mouseStayingInsideCell(t)){var n=this.cellCtrl.createEvent(t,Ge.EVENT_CELL_MOUSE_OVER);this.beans.eventService.dispatchEvent(n),this.beans.columnHoverService.setMouseOver([this.column])}},r.prototype.mouseStayingInsideCell=function(t){if(!t.target||!t.relatedTarget)return!1;var n=this.cellCtrl.getGui(),c=n.contains(t.target),f=n.contains(t.relatedTarget);return c&&f},r.prototype.destroy=function(){},r}(hd),Uy=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Hy=function(h){function r(t,n,c,f,y,T){var B=h.call(this)||this;return B.cellCtrl=t,B.beans=n,B.column=c,B.rowNode=f,B.rowCtrl=T,B}return Uy(r,h),r.prototype.setComp=function(t){this.eGui=t},r.prototype.onKeyDown=function(t){var n=t.which||t.keyCode;switch(n){case Yt.ENTER:this.onEnterKeyDown(t);break;case Yt.F2:this.onF2KeyDown();break;case Yt.ESCAPE:this.onEscapeKeyDown();break;case Yt.TAB:this.onTabKeyDown(t);break;case Yt.BACKSPACE:case Yt.DELETE:this.onBackspaceOrDeleteKeyPressed(n);break;case Yt.DOWN:case Yt.UP:case Yt.RIGHT:case Yt.LEFT:this.onNavigationKeyPressed(t,n)}},r.prototype.onNavigationKeyPressed=function(t,n){this.cellCtrl.isEditing()||(t.shiftKey&&this.cellCtrl.isRangeSelectionEnabled()?this.onShiftRangeSelect(n):this.beans.navigationService.navigateToNextCell(t,n,this.cellCtrl.getCellPosition(),!0),t.preventDefault())},r.prototype.onShiftRangeSelect=function(t){if(this.beans.rangeService){var n=this.beans.rangeService.extendLatestRangeInDirection(t);n&&this.beans.navigationService.ensureCellVisible(n)}},r.prototype.onTabKeyDown=function(t){this.beans.navigationService.onTabKeyDown(this.cellCtrl,t)},r.prototype.onBackspaceOrDeleteKeyPressed=function(t){this.cellCtrl.isEditing()||this.cellCtrl.startRowOrCellEdit(t)},r.prototype.onEnterKeyDown=function(t){this.cellCtrl.isEditing()||this.rowCtrl.isEditing()?this.cellCtrl.stopEditingAndFocus():this.beans.gridOptionsWrapper.isEnterMovesDown()?this.beans.navigationService.navigateToNextCell(null,Yt.DOWN,this.cellCtrl.getCellPosition(),!1):(this.cellCtrl.startRowOrCellEdit(Yt.ENTER),this.cellCtrl.isEditing()&&t.preventDefault())},r.prototype.onF2KeyDown=function(){this.cellCtrl.isEditing()||this.cellCtrl.startRowOrCellEdit(Yt.F2)},r.prototype.onEscapeKeyDown=function(){this.cellCtrl.isEditing()&&(this.cellCtrl.stopRowOrCellEdit(!0),this.cellCtrl.focusCell(!0))},r.prototype.onKeyPress=function(t){if(Ye(t)===this.eGui&&!this.cellCtrl.isEditing()){var f=String.fromCharCode(t.charCode);" "===f?this.onSpaceKeyPressed(t):Rp(t)&&(this.cellCtrl.startRowOrCellEdit(null,f),t.preventDefault())}},r.prototype.onSpaceKeyPressed=function(t){var n=this.beans.gridOptionsWrapper;if(!this.cellCtrl.isEditing()&&n.isRowSelection()){var c=this.rowNode.isSelected(),f=!c;if(f||!n.isSuppressRowDeselection()){var y=this.beans.gridOptionsWrapper.isGroupSelectsFiltered(),T=this.rowNode.setSelectedParams({newValue:f,rangeSelect:t.shiftKey,groupSelectsFiltered:y});void 0===c&&0===T&&this.rowNode.setSelectedParams({newValue:!1,rangeSelect:t.shiftKey,groupSelectsFiltered:y})}}t.preventDefault()},r.prototype.destroy=function(){},r}(ct),vc=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Zl=function(h){function r(t,n,c,f){var y=h.call(this,'<div class="ag-drag-handle ag-row-drag" draggable="true"></div>')||this;return y.rowNode=t,y.column=n,y.beans=c,y.eCell=f,y}return vc(r,h),r.prototype.postConstruct=function(){this.getGui().appendChild(Bi("rowDrag",this.beans.gridOptionsWrapper,null)),this.addGuiEventListener("mousedown",function(n){n.stopPropagation()}),this.addDragSource(),this.checkVisibility()},r.prototype.addDragSource=function(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))},r.prototype.onDragStart=function(t){var n=this,c=this.column.getColDef().dndSourceOnRowDrag,f=uo();f||t.dataTransfer.setDragImage(this.eCell,0,0),c?c({rowNode:this.rowNode,dragEvent:t}):function(){try{var B=JSON.stringify(n.rowNode.data);f?t.dataTransfer.setData("text",B):(t.dataTransfer.setData("application/json",B),t.dataTransfer.setData("text/plain",B))}catch(q){}}()},r.prototype.checkVisibility=function(){var t=this.column.isDndSource(this.rowNode);this.setDisplayed(t)},function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);c>3&&f&&Object.defineProperty(r,t,f)}([zt],r.prototype,"postConstruct",null),r}(dn),Wy=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),gc=function(){return gc=Object.assign||function(h){for(var r,t=1,n=arguments.length;t<n;t++)for(var c in r=arguments[t])Object.prototype.hasOwnProperty.call(r,c)&&(h[c]=r[c]);return h},gc.apply(this,arguments)},gd="ag-cell-not-inline-editing",qy=0,go=function(h){function r(t,n,c,f){var y=h.call(this)||this;return y.suppressRefreshCell=!1,y.column=t,y.rowNode=n,y.beans=c,y.rowCtrl=f,y.instanceId=t.getId()+"-"+qy++,y.createCellPosition(),y.addFeatures(),y}return Wy(r,h),r.prototype.addFeatures=function(){var t=this;this.cellPositionFeature=new By(this,this.beans),this.addDestroyFunc(function(){return t.cellPositionFeature.destroy()}),this.cellCustomStyleFeature=new n0(this,this.beans),this.addDestroyFunc(function(){return t.cellCustomStyleFeature.destroy()}),this.cellMouseListenerFeature=new Vy(this,this.beans,this.column),this.addDestroyFunc(function(){return t.cellMouseListenerFeature.destroy()}),this.cellKeyboardListenerFeature=new Hy(this,this.beans,this.column,this.rowNode,this.scope,this.rowCtrl),this.addDestroyFunc(function(){return t.cellKeyboardListenerFeature.destroy()}),this.beans.rangeService&&this.beans.gridOptionsWrapper.isEnableRangeSelection()&&(this.cellRangeFeature=new uv(this.beans,this),this.addDestroyFunc(function(){return t.cellRangeFeature.destroy()})),this.addTooltipFeature()},r.prototype.addTooltipFeature=function(){var t=this;this.tooltipFeature=new cv({getColumn:function(){return t.column},getColDef:function(){return t.column.getColDef()},getRowIndex:function(){return t.cellPosition.rowIndex},getRowNode:function(){return t.rowNode},getGui:function(){return t.getGui()},getLocation:function(){return"cell"},getTooltipValue:function(){var y=t.column.getColDef(),T=t.rowNode.data;if(y.tooltipField&&v(T))return ot(T,y.tooltipField,t.column.isTooltipFieldContainsDots());var B=y.tooltipValueGetter;return B?B({location:"cell",api:t.beans.gridOptionsWrapper.getApi(),columnApi:t.beans.gridOptionsWrapper.getColumnApi(),context:t.beans.gridOptionsWrapper.getContext(),colDef:t.column.getColDef(),column:t.column,rowIndex:t.cellPosition.rowIndex,node:t.rowNode,data:t.rowNode.data,value:t.value,valueFormatted:t.valueFormatted}):null},getValueFormatted:function(){return t.valueFormatted}},this.beans),this.addDestroyFunc(function(){return t.tooltipFeature.destroy()})},r.prototype.setComp=function(t,n,c,f,y){this.cellComp=t,this.gow=this.beans.gridOptionsWrapper,this.scope=n,this.eGui=c,this.printLayout=f,this.updateAndFormatValue(!0),this.addDomData(),this.onCellFocused(),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),this.setupAriaExpanded(),this.setupAutoHeight();var T=Oe(this.column.getId()),B=this.beans.columnModel.getAriaColumnIndex(this.column);this.cellComp.setTabIndex(-1),this.cellComp.setRole("gridcell"),this.cellComp.setAriaColIndex(B),this.cellComp.setColId(T),this.cellComp.setUnselectable(this.beans.gridOptionsWrapper.isEnableCellTextSelection()?null:"on"),this.cellPositionFeature.setComp(t),this.cellCustomStyleFeature.setComp(t,n),this.tooltipFeature.setComp(t),this.cellKeyboardListenerFeature.setComp(this.eGui),this.cellRangeFeature&&this.cellRangeFeature.setComp(t),y&&this.isCellEditable()?this.startEditing():this.showValue()},r.prototype.setupAutoHeight=function(){var t=this;if(this.column.getColDef().autoHeight){var n=function y(T){var B=t.beans.gridOptionsWrapper.getDocument();B&&B.contains(t.eGui)||!(T<5)?t.rowNode.setRowAutoHeight(t.eGui.offsetHeight,t.column):t.beans.frameworkOverrides.setTimeout(function(){return y(T++)},0)},c=function(){return n(0)};c();var f=this.beans.resizeObserverService.observeResize(this.eGui,c);this.addDestroyFunc(function(){f(),t.rowNode.setRowAutoHeight(void 0,t.column)})}},r.prototype.getInstanceId=function(){return this.instanceId},r.prototype.showValue=function(t){void 0===t&&(t=!1);var n=null!=this.valueFormatted?this.valueFormatted:this.value,c=this.createCellRendererParams(),f=this.beans.userComponentFactory.getCellRendererDetails(this.column.getColDef(),c);this.cellComp.setRenderDetails(f,n,t),this.refreshHandle()},r.prototype.setupControlComps=function(){var t=this.column.getColDef();this.includeSelection=this.isIncludeControl(t.checkboxSelection),this.includeRowDrag=this.isIncludeControl(t.rowDrag),this.includeDndSource=this.isIncludeControl(t.dndSource);var n=this.beans.gridOptionsWrapper.isEnableCellTextSelection()||1==this.column.getColDef().autoHeight;this.cellComp.setIncludeSelection(this.includeSelection),this.cellComp.setIncludeDndSource(this.includeDndSource),this.cellComp.setIncludeRowDrag(this.includeRowDrag),this.cellComp.setForceWrapper(n)},r.prototype.isIncludeControl=function(t){return!(null!=this.rowNode.rowPinned||"function"!=typeof t&&!0!==t)},r.prototype.setupAriaExpanded=function(){var t=this,n=this.column.getColDef();if(this.rowNode.isExpandable()){var c=n.showRowGroup,f=this.rowNode.rowGroupColumn,y=!0===c,T=f&&f.getColId()===c;if(y||T){var q=function(){t.cellComp.setAriaExpanded(!!t.rowNode.expanded)};this.addManagedListener(this.rowNode,un.EVENT_EXPANDED_CHANGED,q),q()}}},r.prototype.refreshShouldDestroy=function(){var t=this.column.getColDef(),n=this.includeSelection!=this.isIncludeControl(t.checkboxSelection),c=this.includeRowDrag!=this.isIncludeControl(t.rowDrag),f=this.includeDndSource!=this.isIncludeControl(t.dndSource);return n||c||f},r.prototype.startEditing=function(t,n,c){if(void 0===t&&(t=null),void 0===n&&(n=null),void 0===c&&(c=!1),this.isCellEditable()&&!this.editing){var f=this.createCellEditorParams(t,n,c),y=this.column.getColDef(),T=this.beans.userComponentFactory.getCellEditorDetails(y,f),B=!!y.cellEditorPopup,q=y.cellEditorPopupPosition;this.setEditing(!0,B),this.cellComp.setEditDetails(T,B,q);var de=this.createEvent(null,Ge.EVENT_CELL_EDITING_STARTED);this.beans.eventService.dispatchEvent(de)}},r.prototype.setEditing=function(t,n){void 0===n&&(n=!1),this.editing!==t&&(this.editing=t,this.editingInPopup=n,this.setInlineEditingClass())},r.prototype.stopRowOrCellEdit=function(t){void 0===t&&(t=!1),this.beans.gridOptionsWrapper.isFullRowEdit()?this.rowCtrl.stopRowEditing(t):this.stopEditing(t)},r.prototype.onPopupEditorClosed=function(){!this.isEditing()||this.stopEditingAndFocus()},r.prototype.takeValueFromCellEditor=function(t){var n={newValueExists:!1};if(t)return n;var c=this.cellComp.getCellEditor();return c?c.isCancelAfterEnd&&c.isCancelAfterEnd()?n:{newValue:c.getValue(),newValueExists:!0}:n},r.prototype.saveNewValue=function(t,n){n!==t&&(this.suppressRefreshCell=!0,this.rowNode.setDataValue(this.column,n),this.suppressRefreshCell=!1)},r.prototype.stopEditing=function(t){if(void 0===t&&(t=!1),this.editing){var n=this.takeValueFromCellEditor(t),c=n.newValue,f=n.newValueExists,y=this.getValueFromValueService();f&&this.saveNewValue(y,c),this.setEditing(!1),this.cellComp.setEditDetails(),this.updateAndFormatValue(),this.refreshCell({forceRefresh:!0,suppressFlash:!0}),this.dispatchEditingStoppedEvent(y,c)}},r.prototype.dispatchEditingStoppedEvent=function(t,n){var c=gc(gc({},this.createEvent(null,Ge.EVENT_CELL_EDITING_STOPPED)),{oldValue:t,newValue:n});this.beans.eventService.dispatchEvent(c)},r.prototype.setInlineEditingClass=function(){if(this.isAlive()){var t=this.editing&&!this.editingInPopup,n=this.editing&&this.editingInPopup;this.cellComp.addOrRemoveCssClass("ag-cell-inline-editing",t),this.cellComp.addOrRemoveCssClass(gd,!t),this.cellComp.addOrRemoveCssClass("ag-cell-popup-editing",n),this.rowCtrl.setInlineEditingCss(this.editing)}},r.prototype.hackSayEditingInPopup=function(){this.editingInPopup||(this.editingInPopup=!0,this.setInlineEditingClass())},r.prototype.createCellEditorParams=function(t,n,c){var f={value:this.getValueFromValueService(),keyPress:t,charPress:n,column:this.column,colDef:this.column.getColDef(),rowIndex:this.getCellPosition().rowIndex,node:this.rowNode,data:this.rowNode.data,api:this.beans.gridOptionsWrapper.getApi(),cellStartedEdit:c,columnApi:this.beans.gridOptionsWrapper.getColumnApi(),context:this.beans.gridOptionsWrapper.getContext(),onKeyDown:this.onKeyDown.bind(this),stopEditing:this.stopEditingAndFocus.bind(this),eGridCell:this.getGui(),parseValue:this.parseValue.bind(this),formatValue:this.formatValue.bind(this)};return this.scope&&(f.$scope=this.scope),f},r.prototype.createCellRendererParams=function(){var t=this,c={value:this.value,valueFormatted:this.valueFormatted,getValue:this.getValueFromValueService.bind(this),setValue:function(y){return t.beans.valueService.setValue(t.rowNode,t.column,y)},formatValue:this.formatValue.bind(this),data:this.rowNode.data,node:this.rowNode,colDef:this.column.getColDef(),column:this.column,rowIndex:this.getCellPosition().rowIndex,api:this.beans.gridOptionsWrapper.getApi(),columnApi:this.beans.gridOptionsWrapper.getColumnApi(),context:this.beans.gridOptionsWrapper.getContext(),refreshCell:this.refreshCell.bind(this),eGridCell:this.getGui(),eParentOfValue:this.cellComp.getParentOfValue(),registerRowDragger:function(y,T,B,q){return t.registerRowDragger(y,T,q)},addRowCompListener:function(y,T){console.warn("AG Grid: since AG Grid v26, params.addRowCompListener() is deprecated. If you need this functionality, please contact AG Grid support and advise why so that we can revert with an appropriate workaround, as we dont have any valid use cases for it. This method was originally provided as a work around to know when cells were destroyed in AG Grid before custom Cell Renderers could be provided."),t.rowCtrl.addEventListener(y,T)}};return this.scope&&(c.$scope=this.scope),c},r.prototype.parseValue=function(t){var n=this.column.getColDef(),c={node:this.rowNode,data:this.rowNode.data,oldValue:this.getValue(),newValue:t,colDef:n,column:this.column,api:this.beans.gridOptionsWrapper.getApi(),columnApi:this.beans.gridOptionsWrapper.getColumnApi(),context:this.beans.gridOptionsWrapper.getContext()},f=n.valueParser;return v(f)?this.beans.expressionService.evaluate(f,c):t},r.prototype.setFocusOutOnEditor=function(){if(this.editing){var t=this.cellComp.getCellEditor();t&&t.focusOut&&t.focusOut()}},r.prototype.setFocusInOnEditor=function(){if(this.editing){var t=this.cellComp.getCellEditor();t&&t.focusIn?t.focusIn():this.focusCell(!0)}},r.prototype.onCellChanged=function(t){t.column===this.column&&this.refreshCell({})},r.prototype.refreshCell=function(t){if(!this.suppressRefreshCell&&!this.editing){var n=this.column.getColDef(),c=null!=t&&!!t.newData,f=null!=t&&!!t.suppressFlash||!!n.suppressCellFlash,T=t&&t.forceRefresh||null==n.field&&null==n.valueGetter&&null==n.showRowGroup||c,B=this.updateAndFormatValue();if(T||B){this.showValue(c);var de=this.beans.filterManager.isSuppressFlashingCellsBecauseFiltering();!f&&!de&&(this.beans.gridOptionsWrapper.isEnableCellChangeFlash()||n.enableCellChangeFlash)&&this.flashCell(),this.cellCustomStyleFeature.applyUserStyles(),this.cellCustomStyleFeature.applyClassesFromColDef()}this.refreshToolTip(),this.cellCustomStyleFeature.applyCellClassRules()}},r.prototype.stopEditingAndFocus=function(t){void 0===t&&(t=!1),this.stopRowOrCellEdit(),this.focusCell(!0),t||this.navigateAfterEdit()},r.prototype.navigateAfterEdit=function(){this.beans.gridOptionsWrapper.isFullRowEdit()||this.beans.gridOptionsWrapper.isEnterMovesDownAfterEdit()&&this.beans.navigationService.navigateToNextCell(null,Yt.DOWN,this.getCellPosition(),!1)},r.prototype.flashCell=function(t){this.animateCell("data-changed",t&&t.flashDelay,t&&t.fadeDelay)},r.prototype.animateCell=function(t,n,c){var f=this,y="ag-cell-"+t,T="ag-cell-"+t+"-animation",B=this.beans.gridOptionsWrapper;n||(n=B.getCellFlashDelay()),v(c)||(c=B.getCellFadeDelay()),this.cellComp.addOrRemoveCssClass(y,!0),this.cellComp.addOrRemoveCssClass(T,!1),window.setTimeout(function(){f.cellComp.addOrRemoveCssClass(y,!1),f.cellComp.addOrRemoveCssClass(T,!0),f.cellComp.setTransition("background-color "+c+"ms"),window.setTimeout(function(){f.cellComp.addOrRemoveCssClass(T,!1),f.cellComp.setTransition("transition")},c)},n)},r.prototype.onFlashCells=function(t){var n=this.beans.cellPositionUtils.createId(this.getCellPosition());t.cells[n]&&this.animateCell("highlight")},r.prototype.isCellEditable=function(){return this.column.isCellEditable(this.rowNode)},r.prototype.isSuppressFillHandle=function(){return this.column.isSuppressFillHandle()},r.prototype.formatValue=function(t){var n=this.callValueFormatter(t);return null!=n?n:t},r.prototype.callValueFormatter=function(t){return this.beans.valueFormatterService.formatValue(this.column,this.rowNode,this.scope,t)},r.prototype.updateAndFormatValue=function(t){void 0===t&&(t=!1);var n=this.value,c=this.valueFormatted;return this.value=this.getValueFromValueService(),this.valueFormatted=this.callValueFormatter(this.value),!!t||!this.valuesAreEqual(n,this.value)||this.valueFormatted!=c},r.prototype.valuesAreEqual=function(t,n){var c=this.column.getColDef();return c.equals?c.equals(t,n):t===n},r.prototype.getComp=function(){return this.cellComp},r.prototype.getValueFromValueService=function(){var t=this.rowNode.leafGroup&&this.beans.columnModel.isPivotMode(),n=this.rowNode.group&&this.rowNode.expanded&&!this.rowNode.footer&&!t,c=this.beans.gridOptionsWrapper.isGroupIncludeFooter(),f=this.beans.gridOptionsWrapper.isGroupSuppressBlankHeader();return this.beans.valueService.getValue(this.column,this.rowNode,!1,n&&c&&!f)},r.prototype.getValue=function(){return this.value},r.prototype.getValueFormatted=function(){return this.valueFormatted},r.prototype.addDomData=function(){var t=this,n=this.getGui();this.beans.gridOptionsWrapper.setDomData(n,r.DOM_DATA_KEY_CELL_CTRL,this),this.addDestroyFunc(function(){return t.beans.gridOptionsWrapper.setDomData(n,r.DOM_DATA_KEY_CELL_CTRL,null)})},r.prototype.createEvent=function(t,n){var c={type:n,node:this.rowNode,data:this.rowNode.data,value:this.value,column:this.column,colDef:this.column.getColDef(),context:this.beans.gridOptionsWrapper.getContext(),api:this.beans.gridApi,columnApi:this.beans.columnApi,rowPinned:this.rowNode.rowPinned,event:t,rowIndex:this.rowNode.rowIndex};return this.scope&&(c.$scope=this.scope),c},r.prototype.onKeyPress=function(t){this.cellKeyboardListenerFeature.onKeyPress(t)},r.prototype.onKeyDown=function(t){this.cellKeyboardListenerFeature.onKeyDown(t)},r.prototype.onMouseEvent=function(t,n){this.cellMouseListenerFeature.onMouseEvent(t,n)},r.prototype.getGui=function(){return this.eGui},r.prototype.refreshToolTip=function(){this.tooltipFeature.refreshToolTip()},r.prototype.getColSpanningList=function(){return this.cellPositionFeature.getColSpanningList()},r.prototype.onLeftChanged=function(){this.cellPositionFeature.onLeftChanged(),this.refreshAriaIndex()},r.prototype.refreshAriaIndex=function(){var t=this.beans.columnModel.getAriaColumnIndex(this.column);this.cellComp.setAriaColIndex(t)},r.prototype.isSuppressNavigable=function(){return this.column.isSuppressNavigable(this.rowNode)},r.prototype.onWidthChanged=function(){return this.cellPositionFeature.onWidthChanged()},r.prototype.getColumn=function(){return this.column},r.prototype.getRowNode=function(){return this.rowNode},r.prototype.getBeans=function(){return this.beans},r.prototype.isPrintLayout=function(){return this.printLayout},r.prototype.appendChild=function(t){this.eGui.appendChild(t)},r.prototype.refreshHandle=function(){this.editing||this.cellRangeFeature&&this.cellRangeFeature.refreshHandle()},r.prototype.getCellPosition=function(){return this.cellPosition},r.prototype.isEditing=function(){return this.editing},r.prototype.startRowOrCellEdit=function(t,n){this.beans.gridOptionsWrapper.isFullRowEdit()?this.rowCtrl.startRowEditing(t,n,this):this.startEditing(t,n,!0)},r.prototype.getRowCtrl=function(){return this.rowCtrl},r.prototype.getRowPosition=function(){return{rowIndex:this.cellPosition.rowIndex,rowPinned:this.cellPosition.rowPinned}},r.prototype.updateRangeBordersIfRangeCount=function(){this.cellRangeFeature&&this.cellRangeFeature.updateRangeBordersIfRangeCount()},r.prototype.onRangeSelectionChanged=function(){this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()},r.prototype.isRangeSelectionEnabled=function(){return null!=this.cellRangeFeature},r.prototype.focusCell=function(t){void 0===t&&(t=!1),this.beans.focusService.setFocusedCell(this.getCellPosition().rowIndex,this.column,this.rowNode.rowPinned,t)},r.prototype.onRowIndexChanged=function(){this.createCellPosition(),this.onCellFocused(),this.cellRangeFeature&&this.cellRangeFeature.onRangeSelectionChanged()},r.prototype.onFirstRightPinnedChanged=function(){if(this.cellComp){var t=this.column.isFirstRightPinned();this.cellComp.addOrRemoveCssClass("ag-cell-first-right-pinned",t)}},r.prototype.onLastLeftPinnedChanged=function(){if(this.cellComp){var t=this.column.isLastLeftPinned();this.cellComp.addOrRemoveCssClass("ag-cell-last-left-pinned",t)}},r.prototype.onCellFocused=function(t){if(this.cellComp){var n=this.beans.focusService.isCellFocused(this.cellPosition);if(this.gow.isSuppressCellSelection()||this.cellComp.addOrRemoveCssClass("ag-cell-focus",n),n&&t&&t.forceBrowserFocus){var c=this.cellComp.getFocusableElement();c.focus(),(!document.activeElement||document.activeElement===document.body)&&c.focus()}var f=this.beans.gridOptionsWrapper.isFullRowEdit();!n&&!f&&this.editing&&this.stopRowOrCellEdit()}},r.prototype.createCellPosition=function(){this.cellPosition={rowIndex:this.rowNode.rowIndex,rowPinned:this.rowNode.rowPinned,column:this.column}},r.prototype.applyStaticCssClasses=function(){this.cellComp.addOrRemoveCssClass("ag-cell",!0),this.cellComp.addOrRemoveCssClass(gd,!0);var t=1==this.column.getColDef().autoHeight;this.cellComp.addOrRemoveCssClass("ag-cell-auto-height",t),this.cellComp.addOrRemoveCssClass("ag-cell-normal-height",!t)},r.prototype.onColumnHover=function(){if(this.cellComp&&this.beans.gridOptionsWrapper.isColumnHoverHighlight()){var t=this.beans.columnHoverService.isHovered(this.column);this.cellComp.addOrRemoveCssClass("ag-column-hover",t)}},r.prototype.onNewColumnsLoaded=function(){!this.cellComp||(this.setWrapText(),this.editing||this.refreshCell({forceRefresh:!0,suppressFlash:!0}))},r.prototype.setWrapText=function(){var t=1==this.column.getColDef().wrapText;this.cellComp.addOrRemoveCssClass("ag-cell-wrap-text",t)},r.prototype.dispatchCellContextMenuEvent=function(t){var n=this.column.getColDef(),c=this.createEvent(t,Ge.EVENT_CELL_CONTEXT_MENU);this.beans.eventService.dispatchEvent(c),n.onCellContextMenu&&window.setTimeout(function(){return n.onCellContextMenu(c)},0)},r.prototype.getCellRenderer=function(){return this.cellComp?this.cellComp.getCellRenderer():null},r.prototype.getCellEditor=function(){return this.cellComp?this.cellComp.getCellEditor():null},r.prototype.destroy=function(){h.prototype.destroy.call(this)},r.prototype.createSelectionCheckbox=function(){var t=new Ds;return this.beans.context.createBean(t),t.init({rowNode:this.rowNode,column:this.column}),t},r.prototype.createDndSource=function(){var t=new Zl(this.rowNode,this.column,this.beans,this.eGui);return this.beans.context.createBean(t),t},r.prototype.registerRowDragger=function(t,n,c){var f=this;if(this.customRowDragComp)this.customRowDragComp.setDragElement(t,n);else{var y=this.createRowDragComp(t,n,c);y&&(this.customRowDragComp=y,this.addDestroyFunc(function(){return f.beans.context.destroyBean(y)}))}},r.prototype.createRowDragComp=function(t,n,c){var f=this,y=this.beans.gridOptionsWrapper.isPagination(),T=this.beans.gridOptionsWrapper.isRowDragManaged(),B=this.beans.gridOptionsWrapper.isRowModelDefault();if(T){if(!B)return void Lt(function(){return console.warn("AG Grid: managed row dragging is only allowed in the Client Side Row Model")},"CellComp.addRowDragging");if(y)return void Lt(function(){return console.warn("AG Grid: managed row dragging is not possible when doing pagination")},"CellComp.addRowDragging")}var q=new jl(function(){return f.value},this.rowNode,this.column,t,n,c);return this.beans.context.createBean(q),q},r.DOM_DATA_KEY_CELL_CTRL="cellCtrl",r}(ct),ll=function(){return ll=Object.assign||function(h){for(var r,t=1,n=arguments.length;t<n;t++)for(var c in r=arguments[t])Object.prototype.hasOwnProperty.call(r,c)&&(h[c]=r[c]);return h},ll.apply(this,arguments)},Ky=function(){function h(){}return h.createChildScopeOrNull=function(r,t,n){if(!n.isAngularCompileRows())return null;var f=t.$new();return f.data=ll({},r.data),f.rowNode=r,f.context=n.getContext(),{scope:f,scopeDestroyFunc:function(){f.$destroy(),f.data=null,f.rowNode=null,f.context=null}}},h}(),K4=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Yi=function(){return function(h){h.Normal="Normal",h.FullWidth="FullWidth",h.FullWidthLoading="FullWidthLoading",h.FullWidthGroup="FullWidthGroup",h.FullWidthDetail="FullWidthDetail"}(Yi||(Yi={})),Yi}(),J4=dt([[Yi.FullWidthLoading,"agLoadingCellRenderer"],[Yi.FullWidthGroup,"agGroupRowRenderer"],[Yi.FullWidthDetail,"agDetailCellRenderer"]]),Z4=dt([[Yi.FullWidth,"fullWidthCellRenderer"],[Yi.FullWidthLoading,"loadingCellRenderer"],[Yi.FullWidthGroup,"groupRowRenderer"],[Yi.FullWidthDetail,"detailCellRenderer"]]),pv=0,Os=function(h){function r(t,n,c,f,y,T){var B=h.call(this)||this;return B.allRowGuis=[],B.active=!0,B.centerCellCtrls={list:[],map:{}},B.leftCellCtrls={list:[],map:{}},B.rightCellCtrls={list:[],map:{}},B.lastMouseDownOnDragger=!1,B.updateColumnListsPending=!1,B.parentScope=t,B.beans=c,B.rowNode=n,B.paginationPage=B.beans.paginationProxy.getCurrentPage(),B.useAnimationFrameForCreate=y,B.printLayout=T,B.instanceId=n.id+"-"+pv++,B.setAnimateFlags(f),B.rowFocused=B.beans.focusService.isRowFocused(B.rowNode.rowIndex,B.rowNode.rowPinned),B.setupAngular1Scope(),B.rowLevel=B.beans.rowCssClassCalculator.calculateRowLevel(B.rowNode),B.setRowType(),B.addListeners(),B.setInitialRowTop(),B}return K4(r,h),r.prototype.getBeans=function(){return this.beans},r.prototype.getInstanceId=function(){return this.instanceId},r.prototype.setComp=function(t,n,c){var f={rowComp:t,element:n,pinned:c};this.allRowGuis.push(f),c===W.PINNED_LEFT?this.leftGui=f:c===W.PINNED_RIGHT?this.rightGui=f:this.isFullWidth()&&!this.beans.gridOptionsWrapper.isEmbedFullWidthRows()?this.fullWidthGui=f:this.centerGui=f,(null!=this.leftGui&&null!=this.rightGui&&null!=this.centerGui||null!=this.fullWidthGui)&&this.initialiseRowComps()},r.prototype.isCacheable=function(){return this.rowType===Yi.FullWidthDetail&&this.beans.gridOptionsWrapper.isKeepDetailRows()},r.prototype.setCached=function(t){var n=t?"none":void 0;this.allRowGuis.forEach(function(c){return c.rowComp.setDisplay(n)})},r.prototype.initialiseRowComps=function(){var t=this,n=this.beans.gridOptionsWrapper;this.onRowHeightChanged(),this.updateRowIndexes(),this.setFocusedClasses(),this.setStylesFromGridOptions(),n.isRowSelection()&&this.rowNode.selectable&&this.onRowSelected(),this.updateColumnLists(!this.useAnimationFrameForCreate),this.slideRowIn&&hn(this.onTopChanged.bind(this)),this.fadeRowIn&&hn(function(){t.allRowGuis.forEach(function(T){return T.rowComp.addOrRemoveCssClass("ag-opacity-zero",!1)})});var c=this.getRowBusinessKey(),f=Oe(this.rowNode.id),y=Oe(c);this.allRowGuis.forEach(function(T){var B=T.rowComp;B.setRole("row"),t.getInitialRowClasses(T.pinned).forEach(function(de){return B.addOrRemoveCssClass(de,!0)}),t.rowNode.group&&B.setAriaExpanded(1==t.rowNode.expanded),null!=f&&B.setRowId(f),null!=y&&B.setRowBusinessKey(y),t.isFullWidth()&&B.setTabIndex(-1),n.setDomData(T.element,r.DOM_DATA_KEY_ROW_CTRL,t),t.addDestroyFunc(function(){return n.setDomData(T.element,r.DOM_DATA_KEY_ROW_CTRL,null)}),t.useAnimationFrameForCreate?t.beans.animationFrameService.createTask(t.addHoverFunctionality.bind(t,T.element),t.rowNode.rowIndex,"createTasksP2"):t.addHoverFunctionality(T.element),t.isFullWidth()&&t.setupFullWidth(T),n.isRowDragEntireRow()&&t.addRowDraggerToRow(T),t.beans.animationFrameService.addDestroyTask(function(){t.isAlive()&&T.rowComp.addOrRemoveCssClass("ag-after-created",!0)})}),this.executeProcessRowPostCreateFunc()},r.prototype.addRowDraggerToRow=function(t){if(this.beans.gridOptionsWrapper.isEnableRangeSelection())Lt(function(){console.warn("AG Grid: Setting `rowDragEntireRow: true` in the gridOptions doesn't work with `enableRangeSelection: true`")},"rowDragAndRangeSelectionEnabled");else{var c=new jl(function(){return"1 row"},this.rowNode,void 0,t.element,void 0,!0);this.createManagedBean(c,this.beans.context)}},r.prototype.getFullWidthCellRendererType=function(){return Z4.get(this.rowType)},r.prototype.getFullWidthCellRendererName=function(){return J4.get(this.rowType)},r.prototype.setupFullWidth=function(t){var n=this.createFullWidthParams(t.element,t.pinned),c=this.getFullWidthCellRendererType(),f=this.getFullWidthCellRendererName(),y=this.beans.userComponentFactory.getFullWidthCellRendererDetails(n,c,f);if(y)t.rowComp.showFullWidth(y);else{var T=ne.isRegistered(e.GXE.MasterDetailModule);"agDetailCellRenderer"!==f||T?console.error("AG Grid: fullWidthCellRenderer "+f+" not found"):console.warn("AG Grid: cell renderer agDetailCellRenderer (for master detail) not found. Did you forget to include the master detail module?")}},r.prototype.getScope=function(){return this.scope},r.prototype.isPrintLayout=function(){return this.printLayout},r.prototype.setupAngular1Scope=function(){var t=Ky.createChildScopeOrNull(this.rowNode,this.parentScope,this.beans.gridOptionsWrapper);t&&(this.scope=t.scope,this.addDestroyFunc(t.scopeDestroyFunc))},r.prototype.getCellElement=function(t){var n=this.getCellCtrl(t);return n?n.getGui():null},r.prototype.executeProcessRowPostCreateFunc=function(){var t=this.beans.gridOptionsWrapper.getProcessRowPostCreateFunc();t&&t({eRow:this.centerGui?this.centerGui.element:void 0,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,api:this.beans.gridOptionsWrapper.getApi(),rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this),columnApi:this.beans.gridOptionsWrapper.getColumnApi(),context:this.beans.gridOptionsWrapper.getContext()})},r.prototype.setRowType=function(){var t=this.rowNode.stub,n=this.rowNode.isFullWidthCell(),c=this.beans.doingMasterDetail&&this.rowNode.detail,f=this.beans.columnModel.isPivotMode(),T=!!this.rowNode.group&&!this.rowNode.footer&&this.beans.gridOptionsWrapper.isGroupUseEntireRow(f);this.rowType=t?Yi.FullWidthLoading:c?Yi.FullWidthDetail:n?Yi.FullWidth:T?Yi.FullWidthGroup:Yi.Normal},r.prototype.updateColumnLists=function(t){var n=this;if(void 0===t&&(t=!1),!this.isFullWidth()){if(t||this.beans.gridOptionsWrapper.isSuppressAnimationFrame()||this.printLayout)return void this.updateColumnListsImpl();this.updateColumnListsPending||(this.beans.animationFrameService.createTask(function(){!n.active||n.updateColumnListsImpl()},this.rowNode.rowIndex,"createTasksP1"),this.updateColumnListsPending=!0)}},r.prototype.createCellCtrls=function(t,n,c){var f=this;void 0===c&&(c=null);var y={list:[],map:{}},T=function(q,de){y.list.push(de),y.map[q]=de};return n.forEach(function(B){var q=B.getInstanceId(),de=t.map[q];de||(de=new go(B,f.rowNode,f.beans,f)),T(q,de)}),t.list.forEach(function(B){if(null==y.map[B.getColumn().getInstanceId()]){if(!f.isCellEligibleToBeRemoved(B,c))return void T(B.getColumn().getInstanceId(),B);B.destroy()}}),y},r.prototype.updateColumnListsImpl=function(){var t=this;this.updateColumnListsPending=!1;var n=this.beans.columnModel;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,n.getAllDisplayedColumns()),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{var c=n.getViewportCenterColumnsForRow(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,c);var f=n.getDisplayedLeftColumnsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,f,W.PINNED_LEFT);var y=n.getDisplayedRightColumnsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,y,W.PINNED_RIGHT)}this.allRowGuis.forEach(function(T){T.rowComp.setCellCtrls((T.pinned===W.PINNED_LEFT?t.leftCellCtrls:T.pinned===W.PINNED_RIGHT?t.rightCellCtrls:t.centerCellCtrls).list)})},r.prototype.isCellEligibleToBeRemoved=function(t,n){var c=!0;if(t.getColumn().getPinned()!=n)return c;var T=t.isEditing(),B=this.beans.focusService.isCellFocused(t.getCellPosition());if(T||B){var de=t.getColumn();return!(this.beans.columnModel.getAllDisplayedColumns().indexOf(de)>=0)&&c}return c},r.prototype.setAnimateFlags=function(t){if(t){var n=v(this.rowNode.oldRowTop);this.slideRowIn=n,this.fadeRowIn=!n}else this.slideRowIn=!1,this.fadeRowIn=!1},r.prototype.isEditing=function(){return this.editingRow},r.prototype.stopRowEditing=function(t){this.stopEditing(t)},r.prototype.isFullWidth=function(){return this.rowType!==Yi.Normal},r.prototype.getRowType=function(){return this.rowType},r.prototype.refreshFullWidth=function(){var t=this,n=function(de,Se){if(!de)return!0;var ke=de.rowComp.getFullWidthCellRenderer();if(!ke||!ke.refresh)return!1;var je=t.createFullWidthParams(de.element,Se);return ke.refresh(je)},c=n(this.fullWidthGui,null),f=n(this.centerGui,null),y=n(this.leftGui,W.PINNED_LEFT),T=n(this.rightGui,W.PINNED_RIGHT);return c&&f&&y&&T},r.prototype.addListeners=function(){this.addManagedListener(this.rowNode,un.EVENT_HEIGHT_CHANGED,this.onRowHeightChanged.bind(this)),this.addManagedListener(this.rowNode,un.EVENT_ROW_SELECTED,this.onRowSelected.bind(this)),this.addManagedListener(this.rowNode,un.EVENT_ROW_INDEX_CHANGED,this.onRowIndexChanged.bind(this)),this.addManagedListener(this.rowNode,un.EVENT_TOP_CHANGED,this.onTopChanged.bind(this)),this.addManagedListener(this.rowNode,un.EVENT_EXPANDED_CHANGED,this.updateExpandedCss.bind(this)),this.addManagedListener(this.rowNode,un.EVENT_HAS_CHILDREN_CHANGED,this.updateExpandedCss.bind(this)),this.addManagedListener(this.rowNode,un.EVENT_DATA_CHANGED,this.onRowNodeDataChanged.bind(this)),this.addManagedListener(this.rowNode,un.EVENT_CELL_CHANGED,this.onRowNodeCellChanged.bind(this)),this.addManagedListener(this.rowNode,un.EVENT_HIGHLIGHT_CHANGED,this.onRowNodeHighlightChanged.bind(this)),this.addManagedListener(this.rowNode,un.EVENT_DRAGGING_CHANGED,this.onRowNodeDraggingChanged.bind(this)),this.addManagedListener(this.rowNode,un.EVENT_UI_LEVEL_CHANGED,this.onUiLevelChanged.bind(this));var t=this.beans.eventService;this.addManagedListener(t,Ge.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED,this.onPaginationPixelOffsetChanged.bind(this)),this.addManagedListener(t,Ge.EVENT_HEIGHT_SCALE_CHANGED,this.onTopChanged.bind(this)),this.addManagedListener(t,Ge.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(t,Ge.EVENT_VIRTUAL_COLUMNS_CHANGED,this.onVirtualColumnsChanged.bind(this)),this.addManagedListener(t,Ge.EVENT_CELL_FOCUSED,this.onCellFocusChanged.bind(this)),this.addManagedListener(t,Ge.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),this.addManagedListener(t,Ge.EVENT_MODEL_UPDATED,this.onModelUpdated.bind(this)),this.addManagedListener(t,Ge.EVENT_COLUMN_MOVED,this.onColumnMoved.bind(this)),this.addListenersForCellComps()},r.prototype.onColumnMoved=function(){this.updateColumnLists()},r.prototype.addListenersForCellComps=function(){var t=this;this.addManagedListener(this.rowNode,un.EVENT_ROW_INDEX_CHANGED,function(){t.getAllCellCtrls().forEach(function(n){return n.onRowIndexChanged()})}),this.addManagedListener(this.rowNode,un.EVENT_CELL_CHANGED,function(n){t.getAllCellCtrls().forEach(function(c){return c.onCellChanged(n)})})},r.prototype.onRowNodeDataChanged=function(t){this.getAllCellCtrls().forEach(function(n){return n.refreshCell({suppressFlash:!t.update,newData:!t.update})}),this.onRowSelected(),this.postProcessCss()},r.prototype.onRowNodeCellChanged=function(){this.postProcessCss()},r.prototype.postProcessCss=function(){this.setStylesFromGridOptions(),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.postProcessRowDragging()},r.prototype.onRowNodeHighlightChanged=function(){var t=this.rowNode.highlighted;this.allRowGuis.forEach(function(n){var f=t===e.oh5.Below;n.rowComp.addOrRemoveCssClass("ag-row-highlight-above",t===e.oh5.Above),n.rowComp.addOrRemoveCssClass("ag-row-highlight-below",f)})},r.prototype.onRowNodeDraggingChanged=function(){this.postProcessRowDragging()},r.prototype.postProcessRowDragging=function(){var t=this.rowNode.dragging;this.allRowGuis.forEach(function(n){return n.rowComp.addOrRemoveCssClass("ag-row-dragging",t)})},r.prototype.updateExpandedCss=function(){var t=this.rowNode.isExpandable(),n=1==this.rowNode.expanded;this.allRowGuis.forEach(function(c){c.rowComp.addOrRemoveCssClass("ag-row-group",t),c.rowComp.addOrRemoveCssClass("ag-row-group-expanded",t&&n),c.rowComp.addOrRemoveCssClass("ag-row-group-contracted",t&&!n),c.rowComp.setAriaExpanded(t&&n)})},r.prototype.onDisplayedColumnsChanged=function(){this.updateColumnLists(!0),this.beans.columnModel.wasAutoRowHeightEverActive()&&this.rowNode.checkAutoHeights()},r.prototype.onVirtualColumnsChanged=function(){this.updateColumnLists()},r.prototype.getRowPosition=function(){return{rowPinned:this.rowNode.rowPinned,rowIndex:this.rowNode.rowIndex}},r.prototype.onKeyboardNavigate=function(t){var n=O(this.allRowGuis,function(q){return q.element.contains(t.target)});if((n?n.element:null)===t.target){var y=this.rowNode,T=this.beans.focusService.getFocusedCell();this.beans.navigationService.navigateToNextCell(t,t.keyCode,{rowIndex:y.rowIndex,rowPinned:y.rowPinned,column:T&&T.column},!0),t.preventDefault()}},r.prototype.onTabKeyDown=function(t){if(!t.defaultPrevented&&!fr(t)){var n=O(this.allRowGuis,function(T){return T.element.contains(t.target)}),c=n?n.element:null,f=c===t.target,y=null;f||(y=this.beans.focusService.findNextFocusableElement(c,!1,t.shiftKey)),(this.isFullWidth()&&f||!y)&&this.beans.navigationService.onTabKeyDown(this,t)}},r.prototype.onFullWidthRowFocused=function(t){var n=this.rowNode,c=this.isFullWidth()&&t.rowIndex===n.rowIndex&&t.rowPinned==n.rowPinned,f=this.fullWidthGui?this.fullWidthGui.element:this.centerGui.element;Fr(f,"ag-full-width-focus",c),c&&f.focus({preventScroll:!0})},r.prototype.refreshCell=function(t){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,t),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,t),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,t),this.updateColumnLists()},r.prototype.removeCellCtrl=function(t,n){var c={list:[],map:{}};return t.list.forEach(function(f){f!==n&&(c.list.push(f),c.map[f.getInstanceId()]=f)}),c},r.prototype.onMouseEvent=function(t,n){switch(t){case"dblclick":this.onRowDblClick(n);break;case"click":this.onRowClick(n);break;case"touchstart":case"mousedown":this.onRowMouseDown(n)}},r.prototype.createRowEvent=function(t,n){return{type:t,node:this.rowNode,data:this.rowNode.data,rowIndex:this.rowNode.rowIndex,rowPinned:this.rowNode.rowPinned,context:this.beans.gridOptionsWrapper.getContext(),api:this.beans.gridOptionsWrapper.getApi(),columnApi:this.beans.gridOptionsWrapper.getColumnApi(),event:n}},r.prototype.createRowEventWithSource=function(t,n){var c=this.createRowEvent(t,n);return c.source=this,c},r.prototype.onRowDblClick=function(t){if(!fr(t)){var n=this.createRowEventWithSource(Ge.EVENT_ROW_DOUBLE_CLICKED,t);this.beans.eventService.dispatchEvent(n)}},r.prototype.onRowMouseDown=function(t){if(this.lastMouseDownOnDragger=Rl(t.target,"ag-row-drag",3),this.isFullWidth()){var n=this.rowNode;this.beans.focusService.setFocusedCell(n.rowIndex,this.beans.columnModel.getAllDisplayedColumns()[0],n.rowPinned,!0)}},r.prototype.onRowClick=function(t){if(!fr(t)&&!this.lastMouseDownOnDragger){var c=this.createRowEventWithSource(Ge.EVENT_ROW_CLICKED,t);this.beans.eventService.dispatchEvent(c);var f=t.ctrlKey||t.metaKey,y=t.shiftKey;if(!(this.beans.gridOptionsWrapper.isGroupSelectsChildren()&&this.rowNode.group||!this.rowNode.selectable||this.rowNode.rowPinned||!this.beans.gridOptionsWrapper.isRowSelection()||this.beans.gridOptionsWrapper.isSuppressRowClickSelection())){var B=this.beans.gridOptionsWrapper.isRowMultiSelectWithClick(),q=!this.beans.gridOptionsWrapper.isSuppressRowDeselection();this.rowNode.isSelected()?B?this.rowNode.setSelectedParams({newValue:!1}):f?q&&this.rowNode.setSelectedParams({newValue:!1}):this.rowNode.setSelectedParams({newValue:!y,clearSelection:!y,rangeSelect:y}):this.rowNode.setSelectedParams({newValue:!0,clearSelection:!B&&!f,rangeSelect:y})}}},r.prototype.setupDetailRowAutoHeight=function(t){var n=this;if(this.beans.gridOptionsWrapper.isDetailRowAutoHeight()){var c=function(){var T=t.clientHeight;null!=T&&T>0&&n.beans.frameworkOverrides.setTimeout(function(){n.rowNode.setRowHeight(T),n.beans.clientSideRowModel?n.beans.clientSideRowModel.onRowHeightChanged():n.beans.serverSideRowModel&&n.beans.serverSideRowModel.onRowHeightChanged()},0)},f=this.beans.resizeObserverService.observeResize(t,c);this.addDestroyFunc(f),c()}},r.prototype.createFullWidthParams=function(t,n){var c=this;return{fullWidth:!0,data:this.rowNode.data,node:this.rowNode,value:this.rowNode.key,valueFormatted:this.rowNode.key,$scope:this.scope?this.scope:this.parentScope,$compile:this.beans.$compile,rowIndex:this.rowNode.rowIndex,api:this.beans.gridOptionsWrapper.getApi(),columnApi:this.beans.gridOptionsWrapper.getColumnApi(),context:this.beans.gridOptionsWrapper.getContext(),eGridCell:t,eParentOfValue:t,pinned:n,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:function(T,B,q,de){return c.addFullWidthRowDragging(T,B,q,de)}}},r.prototype.addFullWidthRowDragging=function(t,n,c,f){if(void 0===c&&(c=""),this.isFullWidth()){var y=new jl(function(){return c},this.rowNode,void 0,t,n,f);this.createManagedBean(y,this.beans.context)}},r.prototype.onUiLevelChanged=function(){var t=this.beans.rowCssClassCalculator.calculateRowLevel(this.rowNode);if(this.rowLevel!=t){var n="ag-row-level-"+t,c="ag-row-level-"+this.rowLevel;this.allRowGuis.forEach(function(f){f.rowComp.addOrRemoveCssClass(n,!0),f.rowComp.addOrRemoveCssClass(c,!1)})}this.rowLevel=t},r.prototype.isFirstRowOnPage=function(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageFirstRow()},r.prototype.isLastRowOnPage=function(){return this.rowNode.rowIndex===this.beans.paginationProxy.getPageLastRow()},r.prototype.onModelUpdated=function(){var t=this.isFirstRowOnPage(),n=this.isLastRowOnPage();this.firstRowOnPage!==t&&(this.firstRowOnPage=t,this.allRowGuis.forEach(function(c){return c.rowComp.addOrRemoveCssClass("ag-row-first",t)})),this.lastRowOnPage!==n&&(this.lastRowOnPage=n,this.allRowGuis.forEach(function(c){return c.rowComp.addOrRemoveCssClass("ag-row-last",n)}))},r.prototype.stopEditing=function(t){if(void 0===t&&(t=!1),this.getAllCellCtrls().forEach(function(c){return c.stopEditing(t)}),this.editingRow){if(!t){var n=this.createRowEvent(Ge.EVENT_ROW_VALUE_CHANGED);this.beans.eventService.dispatchEvent(n)}this.setEditingRow(!1)}},r.prototype.setInlineEditingCss=function(t){this.allRowGuis.forEach(function(n){n.rowComp.addOrRemoveCssClass("ag-row-inline-editing",t),n.rowComp.addOrRemoveCssClass("ag-row-not-inline-editing",!t)})},r.prototype.setEditingRow=function(t){this.editingRow=t,this.allRowGuis.forEach(function(c){return c.rowComp.addOrRemoveCssClass("ag-row-editing",t)});var n=this.createRowEvent(t?Ge.EVENT_ROW_EDITING_STARTED:Ge.EVENT_ROW_EDITING_STOPPED);this.beans.eventService.dispatchEvent(n)},r.prototype.startRowEditing=function(t,n,c){void 0===t&&(t=null),void 0===n&&(n=null),void 0===c&&(c=null),!this.editingRow&&(this.getAllCellCtrls().forEach(function(f){var y=f===c;y?f.startEditing(t,n,y):f.startEditing(null,null,y)}),this.setEditingRow(!0))},r.prototype.getAllCellCtrls=function(){var t=function(){for(var h=0,r=0,t=arguments.length;r<t;r++)h+=arguments[r].length;var n=Array(h),c=0;for(r=0;r<t;r++)for(var f=arguments[r],y=0,T=f.length;y<T;y++,c++)n[c]=f[y];return n}(this.centerCellCtrls.list,this.leftCellCtrls.list,this.rightCellCtrls.list);return t},r.prototype.postProcessClassesFromGridOptions=function(){var t=this,n=this.beans.rowCssClassCalculator.processClassesFromGridOptions(this.rowNode,this.scope);!n||!n.length||n.forEach(function(c){t.allRowGuis.forEach(function(f){return f.rowComp.addOrRemoveCssClass(c,!0)})})},r.prototype.postProcessRowClassRules=function(){var t=this;this.beans.rowCssClassCalculator.processRowClassRules(this.rowNode,this.scope,function(n){t.allRowGuis.forEach(function(c){return c.rowComp.addOrRemoveCssClass(n,!0)})},function(n){t.allRowGuis.forEach(function(c){return c.rowComp.addOrRemoveCssClass(n,!1)})})},r.prototype.setStylesFromGridOptions=function(){var t=this.processStylesFromGridOptions();this.allRowGuis.forEach(function(n){return n.rowComp.setUserStyles(t)})},r.prototype.getRowBusinessKey=function(){var t=this.beans.gridOptionsWrapper.getBusinessKeyForNodeFunc();if("function"==typeof t)return t(this.rowNode)},r.prototype.getInitialRowClasses=function(t){var n={rowNode:this.rowNode,rowFocused:this.rowFocused,fadeRowIn:this.fadeRowIn,rowIsEven:this.rowNode.rowIndex%2==0,rowLevel:this.rowLevel,fullWidthRow:this.isFullWidth(),firstRowOnPage:this.isFirstRowOnPage(),lastRowOnPage:this.isLastRowOnPage(),printLayout:this.printLayout,expandable:this.rowNode.isExpandable(),scope:this.scope,pinned:t};return this.beans.rowCssClassCalculator.getInitialRowClasses(n)},r.prototype.processStylesFromGridOptions=function(){var t=this.beans.gridOptionsWrapper.getRowStyle();if(!t||"function"!=typeof t){var c,n=this.beans.gridOptionsWrapper.getRowStyleFunc();return n&&(c=n({data:this.rowNode.data,node:this.rowNode,rowIndex:this.rowNode.rowIndex,$scope:this.scope,api:this.beans.gridOptionsWrapper.getApi(),columnApi:this.beans.gridOptionsWrapper.getColumnApi(),context:this.beans.gridOptionsWrapper.getContext()})),ut({},t,c)}console.warn("AG Grid: rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead")},r.prototype.onRowSelected=function(){var t=this,n=this.rowNode.isSelected();this.allRowGuis.forEach(function(c){c.rowComp.setAriaSelected(!!n||void 0),c.rowComp.addOrRemoveCssClass("ag-row-selected",n),c.rowComp.setAriaLabel(t.createAriaLabel())})},r.prototype.createAriaLabel=function(){var t=this.rowNode.isSelected();if(!t||!this.beans.gridOptionsWrapper.isSuppressRowDeselection())return this.beans.gridOptionsWrapper.getLocaleTextFunc()(t?"ariaRowDeselect":"ariaRowSelect","Press SPACE to "+(t?"deselect":"select")+" this row.")},r.prototype.isUseAnimationFrameForCreate=function(){return this.useAnimationFrameForCreate},r.prototype.addHoverFunctionality=function(t){var n=this;!this.active||(this.addManagedListener(t,"mouseenter",function(){return n.rowNode.onMouseEnter()}),this.addManagedListener(t,"mouseleave",function(){return n.rowNode.onMouseLeave()}),this.addManagedListener(this.rowNode,un.EVENT_MOUSE_ENTER,function(){n.beans.gridOptionsWrapper.isSuppressRowHoverHighlight()||Er(t,"ag-row-hover")}),this.addManagedListener(this.rowNode,un.EVENT_MOUSE_LEAVE,function(){zi(t,"ag-row-hover")}))},r.prototype.roundRowTopToBounds=function(t){var c=this.beans.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),f=this.applyPaginationOffset(c.top,!0)-100,y=this.applyPaginationOffset(c.bottom,!0)+100;return Math.min(Math.max(f,t),y)},r.prototype.getFrameworkOverrides=function(){return this.beans.frameworkOverrides},r.prototype.onRowHeightChanged=function(){if(v(this.rowNode.rowHeight)){var t=this.rowNode.rowHeight+"px";this.allRowGuis.forEach(function(n){return n.rowComp.setHeight(t)})}},r.prototype.addEventListener=function(t,n){("renderedRowRemoved"===t||"rowRemoved"===t)&&(t=Ge.EVENT_VIRTUAL_ROW_REMOVED,console.warn("AG Grid: Since version 11, event renderedRowRemoved is now called "+Ge.EVENT_VIRTUAL_ROW_REMOVED)),h.prototype.addEventListener.call(this,t,n)},r.prototype.removeEventListener=function(t,n){("renderedRowRemoved"===t||"rowRemoved"===t)&&(t=Ge.EVENT_VIRTUAL_ROW_REMOVED,console.warn("AG Grid: Since version 11, event renderedRowRemoved and rowRemoved is now called "+Ge.EVENT_VIRTUAL_ROW_REMOVED)),h.prototype.removeEventListener.call(this,t,n)},r.prototype.destroyFirstPass=function(){this.active=!1,this.setupRemoveAnimation();var t=this.createRowEvent(Ge.EVENT_VIRTUAL_ROW_REMOVED);this.dispatchEvent(t),this.beans.eventService.dispatchEvent(t),h.prototype.destroy.call(this)},r.prototype.setupRemoveAnimation=function(){if(null!=this.rowNode.rowTop){var n=this.roundRowTopToBounds(this.rowNode.rowTop);this.setRowTop(n)}else this.allRowGuis.forEach(function(c){return c.rowComp.addOrRemoveCssClass("ag-opacity-zero",!0)})},r.prototype.destroySecondPass=function(){this.allRowGuis.length=0;var t=function(c){return c.list.forEach(function(f){return f.destroy()}),{list:[],map:{}}};this.centerCellCtrls=t(this.centerCellCtrls),this.leftCellCtrls=t(this.leftCellCtrls),this.rightCellCtrls=t(this.rightCellCtrls)},r.prototype.setFocusedClasses=function(){var t=this;this.allRowGuis.forEach(function(n){n.rowComp.addOrRemoveCssClass("ag-row-focus",t.rowFocused),n.rowComp.addOrRemoveCssClass("ag-row-no-focus",!t.rowFocused)})},r.prototype.onCellFocusChanged=function(){var t=this.beans.focusService.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);t!==this.rowFocused&&(this.rowFocused=t,this.setFocusedClasses()),!t&&this.editingRow&&this.stopEditing(!1)},r.prototype.onPaginationChanged=function(){var t=this.beans.paginationProxy.getCurrentPage();this.paginationPage!==t&&(this.paginationPage=t,this.onTopChanged())},r.prototype.onTopChanged=function(){this.setRowTop(this.rowNode.rowTop)},r.prototype.onPaginationPixelOffsetChanged=function(){this.onTopChanged()},r.prototype.applyPaginationOffset=function(t,n){return void 0===n&&(n=!1),this.rowNode.isRowPinned()?t:t+this.beans.paginationProxy.getPixelOffset()*(n?1:-1)},r.prototype.setRowTop=function(t){if(!this.printLayout&&v(t)){var n=this.applyPaginationOffset(t),c=this.rowNode.isRowPinned()?n:this.beans.rowContainerHeightService.getRealPixelPosition(n);this.setRowTopStyle(c+"px")}},r.prototype.getInitialRowTop=function(){return this.initialTop},r.prototype.getInitialTransform=function(){return this.initialTransform},r.prototype.setInitialRowTop=function(){if(this.printLayout)return"";var t=this.slideRowIn?this.roundRowTopToBounds(this.rowNode.oldRowTop):this.rowNode.rowTop,n=this.applyPaginationOffset(t),f=(this.rowNode.isRowPinned()?n:this.beans.rowContainerHeightService.getRealPixelPosition(n))+"px";this.beans.gridOptionsWrapper.isSuppressRowTransform()?this.initialTop=f:this.initialTransform="translateY("+f+")"},r.prototype.setRowTopStyle=function(t){var n=this.beans.gridOptionsWrapper.isSuppressRowTransform();this.allRowGuis.forEach(function(c){return n?c.rowComp.setTop(t):c.rowComp.setTransform("translateY("+t+")")})},r.prototype.getRowNode=function(){return this.rowNode},r.prototype.getCellCtrl=function(t){var n=null;return this.getAllCellCtrls().forEach(function(c){c.getColumn()==t&&(n=c)}),null!=n||this.getAllCellCtrls().forEach(function(c){c.getColSpanningList().indexOf(t)>=0&&(n=c)}),n},r.prototype.onRowIndexChanged=function(){null!=this.rowNode.rowIndex&&(this.onCellFocusChanged(),this.updateRowIndexes())},r.prototype.updateRowIndexes=function(){var t=this,n=this.rowNode.getRowIndexString(),c=this.beans.headerNavigationService.getHeaderRowCount(),f=this.rowNode.rowIndex%2==0;this.allRowGuis.forEach(function(y){y.rowComp.setRowIndex(n),y.rowComp.setAriaRowIndex(c+t.rowNode.rowIndex+1),y.rowComp.addOrRemoveCssClass("ag-row-even",f),y.rowComp.addOrRemoveCssClass("ag-row-odd",!f)})},r.prototype.getPinnedLeftRowElement=function(){return this.leftGui?this.leftGui.element:void 0},r.prototype.getPinnedRightRowElement=function(){return this.rightGui?this.rightGui.element:void 0},r.prototype.getBodyRowElement=function(){return this.centerGui?this.centerGui.element:void 0},r.prototype.getFullWidthRowElement=function(){return this.fullWidthGui?this.fullWidthGui.element:void 0},r.DOM_DATA_KEY_ROW_CTRL="renderedRow",r}(ct),Qy=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Io=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},vv=function(){for(var h=0,r=0,t=arguments.length;r<t;r++)h+=arguments[r].length;var n=Array(h),c=0;for(r=0;r<t;r++)for(var f=arguments[r],y=0,T=f.length;y<T;y++,c++)n[c]=f[y];return n},Jy=function(h){function r(){var t=null!==h&&h.apply(this,arguments)||this;return t.destroyFuncsForColumnListeners=[],t.rowCtrlsByRowIndex={},t.zombieRowCtrls={},t.allRowCtrls=[],t.topRowCtrls=[],t.bottomRowCtrls=[],t.refreshInProgress=!1,t}return Qy(r,h),r.prototype.postConstruct=function(){var t=this;this.ctrlsService.whenReady(function(){t.gridBodyCtrl=t.ctrlsService.getGridBodyCtrl(),t.initialise()})},r.prototype.initialise=function(){this.addManagedListener(this.eventService,Ge.EVENT_PAGINATION_CHANGED,this.onPageLoaded.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_PINNED_ROW_DATA_CHANGED,this.onPinnedRowDataChanged.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_BODY_SCROLL,this.redrawAfterScroll.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_BODY_HEIGHT_CHANGED,this.redrawAfterScroll.bind(this)),this.addManagedListener(this.gridOptionsWrapper,vr.PROP_DOM_LAYOUT,this.onDomLayoutChanged.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_NEW_COLUMNS_LOADED,this.onNewColumnsLoaded.bind(this)),this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=this.gridOptionsWrapper.getDomLayout()===W.DOM_LAYOUT_PRINT,this.embedFullWidthRows=this.printLayout||this.gridOptionsWrapper.isEmbedFullWidthRows(),this.redrawAfterModelUpdate()},r.prototype.initialiseCache=function(){if(this.gridOptionsWrapper.isKeepDetailRows()){var t=this.gridOptionsWrapper.getKeepDetailRowsCount();this.cachedRowCtrls=new Zy(null!=t?t:3)}},r.prototype.getRowCtrls=function(){return this.allRowCtrls},r.prototype.updateAllRowCtrls=function(){var t=$e(this.rowCtrlsByRowIndex);this.beans.gridOptionsWrapper.isEnsureDomOrder()&&t.sort(function(f,y){return f.getRowNode().rowIndex-y.getRowNode.rowIndex});var n=$e(this.zombieRowCtrls),c=this.cachedRowCtrls?this.cachedRowCtrls.getEntries():[];this.allRowCtrls=vv(t,n,c)},r.prototype.registerCellEventListeners=function(){var t=this;this.addManagedListener(this.eventService,Ge.EVENT_CELL_FOCUSED,function(c){t.getAllCellCtrls().forEach(function(f){return f.onCellFocused(c)}),t.getAllRowCtrls().forEach(function(f){f.isFullWidth()&&f.onFullWidthRowFocused(c)})}),this.addManagedListener(this.eventService,Ge.EVENT_FLASH_CELLS,function(c){t.getAllCellCtrls().forEach(function(f){return f.onFlashCells(c)})}),this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_HOVER_CHANGED,function(){t.getAllCellCtrls().forEach(function(c){return c.onColumnHover()})}),this.addManagedListener(this.eventService,Ge.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,function(){t.printLayout&&t.getAllCellCtrls().forEach(function(c){return c.onLeftChanged()})}),this.gridOptionsWrapper.isEnableRangeSelection()&&(this.addManagedListener(this.eventService,Ge.EVENT_RANGE_SELECTION_CHANGED,function(){t.getAllCellCtrls().forEach(function(c){return c.onRangeSelectionChanged()})}),this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_MOVED,function(){t.getAllCellCtrls().forEach(function(c){return c.updateRangeBordersIfRangeCount()})}),this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_PINNED,function(){t.getAllCellCtrls().forEach(function(c){return c.updateRangeBordersIfRangeCount()})}),this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_VISIBLE,function(){t.getAllCellCtrls().forEach(function(c){return c.updateRangeBordersIfRangeCount()})})),this.refreshListenersToColumnsForCellComps(),this.addManagedListener(this.eventService,Ge.EVENT_GRID_COLUMNS_CHANGED,this.refreshListenersToColumnsForCellComps.bind(this)),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))},r.prototype.removeGridColumnListeners=function(){this.destroyFuncsForColumnListeners.forEach(function(t){return t()}),this.destroyFuncsForColumnListeners.length=0},r.prototype.refreshListenersToColumnsForCellComps=function(){var t=this;this.removeGridColumnListeners();var n=this.columnModel.getAllGridColumns();!n||n.forEach(function(c){var f=function(Se){t.getAllCellCtrls().forEach(function(ke){ke.getColumn()===c&&Se(ke)})},y=function(){f(function(Se){return Se.onLeftChanged()})},T=function(){f(function(Se){return Se.onWidthChanged()})},B=function(){f(function(Se){return Se.onFirstRightPinnedChanged()})},q=function(){f(function(Se){return Se.onLastLeftPinnedChanged()})};c.addEventListener(it.EVENT_LEFT_CHANGED,y),c.addEventListener(it.EVENT_WIDTH_CHANGED,T),c.addEventListener(it.EVENT_FIRST_RIGHT_PINNED_CHANGED,B),c.addEventListener(it.EVENT_LAST_LEFT_PINNED_CHANGED,q),t.destroyFuncsForColumnListeners.push(function(){c.removeEventListener(it.EVENT_LEFT_CHANGED,y),c.removeEventListener(it.EVENT_WIDTH_CHANGED,T),c.removeEventListener(it.EVENT_FIRST_RIGHT_PINNED_CHANGED,B),c.removeEventListener(it.EVENT_LAST_LEFT_PINNED_CHANGED,q)})})},r.prototype.onDomLayoutChanged=function(){var t=this.gridOptionsWrapper.getDomLayout()===W.DOM_LAYOUT_PRINT,n=t||this.gridOptionsWrapper.isEmbedFullWidthRows(),c=n!==this.embedFullWidthRows||this.printLayout!==t;this.printLayout=t,this.embedFullWidthRows=n,c&&this.redrawAfterModelUpdate()},r.prototype.datasourceChanged=function(){this.firstRenderedRow=0,this.lastRenderedRow=-1;var t=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(t)},r.prototype.onPageLoaded=function(t){this.redrawAfterModelUpdate({recycleRows:t.keepRenderedRows,animate:t.animate,newData:t.newData,newPage:t.newPage,onlyBody:!0})},r.prototype.getAllCellsForColumn=function(t){var n=[];return this.getAllRowCtrls().forEach(function(c){var f=c.getCellElement(t);f&&n.push(f)}),n},r.prototype.refreshFloatingRowComps=function(){this.refreshFloatingRows(this.topRowCtrls,this.pinnedRowModel.getPinnedTopRowData()),this.refreshFloatingRows(this.bottomRowCtrls,this.pinnedRowModel.getPinnedBottomRowData())},r.prototype.getTopRowCtrls=function(){return this.topRowCtrls},r.prototype.getBottomRowCtrls=function(){return this.bottomRowCtrls},r.prototype.refreshFloatingRows=function(t,n){var c=this;t.forEach(function(f){f.destroyFirstPass(),f.destroySecondPass()}),t.length=0,n&&n.forEach(function(f){var y=new Os(c.$scope,f,c.beans,!1,!1,c.printLayout);t.push(y)})},r.prototype.onPinnedRowDataChanged=function(){this.redrawAfterModelUpdate({recycleRows:!0})},r.prototype.getRenderedIndexesForRowNodes=function(t){var n=[];return g(t)||ce(this.rowCtrlsByRowIndex,function(c,f){var y=f.getRowNode();t.indexOf(y)>=0&&n.push(c)}),n},r.prototype.redrawRows=function(t){var n=null!=t&&t.length>0;if(n){var c=this.getRenderedIndexesForRowNodes(t);this.removeRowCtrls(c)}this.redrawAfterModelUpdate({recycleRows:n})},r.prototype.getCellToRestoreFocusToAfterRefresh=function(t){var n=t.suppressKeepFocus?null:this.focusService.getFocusCellToUseAfterRefresh();if(null==n)return null;var c=document.activeElement,f=this.gridOptionsWrapper.getDomData(c,go.DOM_DATA_KEY_CELL_CTRL),y=this.gridOptionsWrapper.getDomData(c,Os.DOM_DATA_KEY_ROW_CTRL);return f||y?n:null},r.prototype.redrawAfterModelUpdate=function(t){void 0===t&&(t={}),this.getLockOnRefresh();var n=this.getCellToRestoreFocusToAfterRefresh(t);this.updateContainerHeights(),this.scrollToTopIfNewData(t);var c=!this.printLayout&&!!t.recycleRows,f=t.animate&&this.gridOptionsWrapper.isAnimateRows(),y=c?this.recycleRows():null;c||this.removeAllRowComps();var B=function(){if(null==n||null==y)return!1;var de=!1;return ce(y,function(Se,ke){var je=ke.getRowNode();je.rowIndex==n.rowIndex&&je.rowPinned==n.rowPinned&&(de=!0)}),de}();this.redraw(y,f),t.onlyBody||this.refreshFloatingRowComps(),this.dispatchDisplayedRowsChanged(),B||this.restoreFocusedCell(n),this.releaseLockOnRefresh()},r.prototype.scrollToTopIfNewData=function(t){var n=t.newData||t.newPage,c=this.gridOptionsWrapper.isSuppressScrollOnNewData();n&&!c&&this.gridBodyCtrl.getScrollFeature().scrollToTop()},r.prototype.updateContainerHeights=function(){if(this.printLayout)this.rowContainerHeightService.setModelHeight(null);else{var t=this.paginationProxy.getCurrentPageHeight();0===t&&(t=1),this.rowContainerHeightService.setModelHeight(t)}},r.prototype.getLockOnRefresh=function(){if(this.refreshInProgress)throw new Error("AG Grid: cannot get grid to draw rows when it is in the middle of drawing rows. Your code probably called a grid API method while the grid was in the render stage. To overcome this, put the API call into a timeout, e.g. instead of api.refreshView(), call setTimeout(function() { api.refreshView(); }, 0). To see what part of your code that caused the refresh check this stacktrace.");this.refreshInProgress=!0},r.prototype.releaseLockOnRefresh=function(){this.refreshInProgress=!1},r.prototype.restoreFocusedCell=function(t){t&&this.focusService.setFocusedCell(t.rowIndex,t.column,t.rowPinned,!0)},r.prototype.stopEditing=function(t){void 0===t&&(t=!1),this.getAllRowCtrls().forEach(function(n){n.stopEditing(t)})},r.prototype.onNewColumnsLoaded=function(){this.getAllCellCtrls().forEach(function(t){return t.onNewColumnsLoaded()})},r.prototype.getAllCellCtrls=function(){var t=[];return this.getAllRowCtrls().forEach(function(n){return t=t.concat(n.getAllCellCtrls())}),t},r.prototype.getAllRowCtrls=function(){var t=this,n=vv(this.topRowCtrls,this.bottomRowCtrls);return Object.keys(this.rowCtrlsByRowIndex).forEach(function(c){return n.push(t.rowCtrlsByRowIndex[c])}),n},r.prototype.addRenderedRowListener=function(t,n,c){var f=this.rowCtrlsByRowIndex[n];f&&f.addEventListener(t,c)},r.prototype.flashCells=function(t){void 0===t&&(t={});var n=t.flashDelay,c=t.fadeDelay;this.getCellCtrls(t.rowNodes,t.columns).forEach(function(f){return f.flashCell({flashDelay:n,fadeDelay:c})})},r.prototype.refreshCells=function(t){void 0===t&&(t={});var n={forceRefresh:t.force,newData:!1,suppressFlash:t.suppressFlash};this.getCellCtrls(t.rowNodes,t.columns).forEach(function(c){if(c.refreshShouldDestroy()){var f=c.getRowCtrl();f&&f.refreshCell(c)}else c.refreshCell(n)})},r.prototype.getCellRendererInstances=function(t){return this.getCellCtrls(t.rowNodes,t.columns).map(function(c){return c.getCellRenderer()}).filter(function(c){return null!=c})},r.prototype.getCellEditorInstances=function(t){var n=[];return this.getCellCtrls(t.rowNodes,t.columns).forEach(function(c){var f=c.getCellEditor();f&&n.push(f)}),n},r.prototype.getEditingCells=function(){var t=[];return this.getAllCellCtrls().forEach(function(n){if(n.isEditing()){var c=n.getCellPosition();t.push(c)}}),t},r.prototype.getCellCtrls=function(t,n){var f,T,c=this,y=[];v(t)&&(f={top:{},bottom:{},normal:{}},t.forEach(function(q){var de=q.id;q.rowPinned===W.PINNED_TOP?f.top[de]=!0:q.rowPinned===W.PINNED_BOTTOM?f.bottom[de]=!0:f.normal[de]=!0})),v(n)&&(T={},n.forEach(function(q){var de=c.columnModel.getGridColumn(q);v(de)&&(T[de.getId()]=!0)}));var B=function(de){var Se=de.getRowNode(),ke=Se.id,je=Se.rowPinned;if(v(f))if(je===W.PINNED_BOTTOM){if(!f.bottom[ke])return}else if(je===W.PINNED_TOP){if(!f.top[ke])return}else if(!f.normal[ke])return;de.getAllCellCtrls().forEach(function(Qe){var rt=Qe.getColumn().getId();T&&!T[rt]||y.push(Qe)})};return ce(this.rowCtrlsByRowIndex,function(q,de){B(de)}),this.topRowCtrls&&this.topRowCtrls.forEach(B),this.bottomRowCtrls&&this.bottomRowCtrls.forEach(B),y},r.prototype.destroy=function(){this.removeAllRowComps(),h.prototype.destroy.call(this)},r.prototype.removeAllRowComps=function(){var t=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(t)},r.prototype.recycleRows=function(){var t=[];ce(this.rowCtrlsByRowIndex,function(c,f){null==f.getRowNode().id&&t.push(c)}),this.removeRowCtrls(t);var n={};return ce(this.rowCtrlsByRowIndex,function(c,f){var y=f.getRowNode();n[y.id]=f}),this.rowCtrlsByRowIndex={},n},r.prototype.removeRowCtrls=function(t){var n=this;t.forEach(function(c){var f=n.rowCtrlsByRowIndex[c];f&&(f.destroyFirstPass(),f.destroySecondPass()),delete n.rowCtrlsByRowIndex[c]})},r.prototype.redrawAfterScroll=function(){this.getLockOnRefresh(),this.redraw(null,!1,!0),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged()},r.prototype.removeRowCompsNotToDraw=function(t){var n={};t.forEach(function(y){return n[y]=!0});var f=Object.keys(this.rowCtrlsByRowIndex).filter(function(y){return!n[y]});this.removeRowCtrls(f)},r.prototype.calculateIndexesToDraw=function(t){var n=this,c=Vr(this.firstRenderedRow,this.lastRenderedRow),f=function(T,B){var q=B.getRowNode().rowIndex;null!=q&&(q<n.firstRenderedRow||q>n.lastRenderedRow)&&n.doNotUnVirtualiseRow(B)&&c.push(q)};return ce(this.rowCtrlsByRowIndex,f),ce(t,f),c.sort(function(y,T){return y-T}),c},r.prototype.redraw=function(t,n,c){var f=this;void 0===n&&(n=!1),void 0===c&&(c=!1),this.rowContainerHeightService.updateOffset(),this.workOutFirstAndLastRowsToRender();var y=this.calculateIndexesToDraw(t);this.removeRowCompsNotToDraw(y),this.printLayout&&(n=!1),y.forEach(function(B){v(f.createOrUpdateRowCtrl(B,t,n,c))}),t&&(!c||this.gridOptionsWrapper.isSuppressAnimationFrame()||this.printLayout?this.destroyRowCtrls(t,n):this.beans.animationFrameService.addDestroyTask(function(){f.destroyRowCtrls(t,n),f.updateAllRowCtrls(),f.dispatchDisplayedRowsChanged()})),this.updateAllRowCtrls(),this.checkAngularCompile(),this.gridBodyCtrl.updateRowCount()},r.prototype.dispatchDisplayedRowsChanged=function(){this.eventService.dispatchEvent({type:Ge.EVENT_DISPLAYED_ROWS_CHANGED})},r.prototype.onDisplayedColumnsChanged=function(){var t=this.columnModel.isPinningLeft(),n=this.columnModel.isPinningRight();(this.pinningLeft!==t||n!==this.pinningRight)&&(this.pinningLeft=t,this.pinningRight=n,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())},r.prototype.redrawFullWidthEmbeddedRows=function(){var t=[];ce(this.rowCtrlsByRowIndex,function(n,c){if(c.isFullWidth()){var f=c.getRowNode().rowIndex;t.push(f.toString())}}),this.refreshFloatingRowComps(),this.removeRowCtrls(t),this.redrawAfterScroll()},r.prototype.refreshFullWidthRows=function(t){var n=[],c=!!t,f=c?{}:void 0;c&&f&&t.forEach(function(y){return f[y.id]=!0}),ce(this.rowCtrlsByRowIndex,function(y,T){if(T.isFullWidth()){var B=T.getRowNode();if(c&&f&&!f[B.id]&&!f[B.level>0&&B.parent?B.parent.id:void 0])return;if(!T.refreshFullWidth()){var ke=T.getRowNode().rowIndex;n.push(ke.toString())}}}),this.removeRowCtrls(n),this.redrawAfterScroll()},r.prototype.createOrUpdateRowCtrl=function(t,n,c,f){var y,T=this.rowCtrlsByRowIndex[t];if(T||v(y=this.paginationProxy.getRow(t))&&v(n)&&n[y.id]&&y.alreadyRendered&&(T=n[y.id],n[y.id]=null),!T){if(y||(y=this.paginationProxy.getRow(t)),!v(y))return;T=this.createRowCon(y,c,f)}return y&&(y.alreadyRendered=!0),this.rowCtrlsByRowIndex[t]=T,T},r.prototype.destroyRowCtrls=function(t,n){var c=this,f=[];ce(t,function(y,T){if(T){if(c.cachedRowCtrls&&T.isCacheable())return void c.cachedRowCtrls.addRow(T);T.destroyFirstPass(),n?(c.zombieRowCtrls[T.getInstanceId()]=T,f.push(function(){T.destroySecondPass(),delete c.zombieRowCtrls[T.getInstanceId()]})):T.destroySecondPass()}}),n&&(f.push(function(){c.updateAllRowCtrls(),c.dispatchDisplayedRowsChanged()}),Ur(f))},r.prototype.checkAngularCompile=function(){var t=this;this.gridOptionsWrapper.isAngularCompileRows()&&window.setTimeout(function(){t.$scope.$apply()},0)},r.prototype.workOutFirstAndLastRowsToRender=function(){var n,c,t=this;if(this.paginationProxy.isRowsToRender())if(this.printLayout)n=this.paginationProxy.getPageFirstRow(),c=this.paginationProxy.getPageLastRow();else{var f=this.gridOptionsWrapper.getRowBufferInPixels(),y=this.ctrlsService.getGridBodyCtrl(),T=!1,B=void 0,q=void 0;do{var de=this.paginationProxy.getPixelOffset(),Se=this.paginationProxy.getCurrentPagePixelRange(),ke=Se.pageFirstPixel,je=Se.pageLastPixel,Qe=this.rowContainerHeightService.getDivStretchOffset(),rt=y.getScrollFeature().getVScrollPosition(),Vt=rt.bottom;B=Math.max(rt.top+de-f,ke)+Qe,q=Math.min(Vt+de+f,je)+Qe,T=this.ensureAllRowsInRangeHaveHeightsCalculated(B,q)}while(T);var Ut=this.paginationProxy.getRowIndexAtPixel(B),Rt=this.paginationProxy.getRowIndexAtPixel(q),qt=this.paginationProxy.getPageFirstRow(),It=this.paginationProxy.getPageLastRow();Ut<qt&&(Ut=qt),Rt>It&&(Rt=It),n=Ut,c=Rt}else n=0,c=-1;var on=this.gridOptionsWrapper.getDomLayout()===W.DOM_LAYOUT_NORMAL,Br=this.gridOptionsWrapper.isSuppressMaxRenderedRowRestriction(),gn=Math.max(this.gridOptionsWrapper.getRowBuffer(),500);if(on&&!Br&&c-n>gn&&(c=n+gn),(n!==this.firstRenderedRow||c!==this.lastRenderedRow)&&(this.firstRenderedRow=n,this.lastRenderedRow=c,this.eventService.dispatchEvent({type:Ge.EVENT_VIEWPORT_CHANGED,firstRow:n,lastRow:c,api:this.gridApi,columnApi:this.columnApi})),this.paginationProxy.isRowsToRender()){var ei={type:Ge.EVENT_FIRST_DATA_RENDERED,firstRow:n,lastRow:c,api:this.gridApi,columnApi:this.columnApi};window.setTimeout(function(){return t.eventService.dispatchEventOnce(ei)},50)}},r.prototype.ensureAllRowsInRangeHaveHeightsCalculated=function(t,n){var c=this.paginationProxy.ensureRowHeightsValid(t,n,-1,-1);return c&&this.updateContainerHeights(),c},r.prototype.getFirstVirtualRenderedRow=function(){return this.firstRenderedRow},r.prototype.getLastVirtualRenderedRow=function(){return this.lastRenderedRow},r.prototype.doNotUnVirtualiseRow=function(t){var f=t.getRowNode(),y=this.focusService.isRowNodeFocused(f),T=t.isEditing();return!!(y||T||f.detail)&&!!this.paginationProxy.isRowPresent(f)},r.prototype.createRowCon=function(t,n,c){var f=this.cachedRowCtrls?this.cachedRowCtrls.getRow(t):null;if(f)return f;var y=this.gridOptionsWrapper.isSuppressAnimationFrame();return new Os(this.$scope,t,this.beans,n,c&&!y&&!this.printLayout,this.printLayout)},r.prototype.getRenderedNodes=function(){var t=this.rowCtrlsByRowIndex;return Object.keys(t).map(function(n){return t[n].getRowNode()})},r.prototype.getRowByPosition=function(t){var n;switch(t.rowPinned){case W.PINNED_TOP:n=this.topRowCtrls[t.rowIndex];break;case W.PINNED_BOTTOM:n=this.bottomRowCtrls[t.rowIndex];break;default:n=this.rowCtrlsByRowIndex[t.rowIndex]}return n},r.prototype.getRowNode=function(t){switch(t.rowPinned){case W.PINNED_TOP:return this.pinnedRowModel.getPinnedTopRowData()[t.rowIndex];case W.PINNED_BOTTOM:return this.pinnedRowModel.getPinnedBottomRowData()[t.rowIndex];default:return this.rowModel.getRow(t.rowIndex)}},r.prototype.isRangeInRenderedViewport=function(t,n){return!(null==t||null==n||n<this.firstRenderedRow||t>this.lastRenderedRow)},Io([Ee("paginationProxy")],r.prototype,"paginationProxy",void 0),Io([Ee("columnModel")],r.prototype,"columnModel",void 0),Io([Ee("$scope")],r.prototype,"$scope",void 0),Io([Ee("pinnedRowModel")],r.prototype,"pinnedRowModel",void 0),Io([Ee("rowModel")],r.prototype,"rowModel",void 0),Io([Ee("focusService")],r.prototype,"focusService",void 0),Io([Ee("columnApi")],r.prototype,"columnApi",void 0),Io([Ee("gridApi")],r.prototype,"gridApi",void 0),Io([Ee("beans")],r.prototype,"beans",void 0),Io([Ee("rowContainerHeightService")],r.prototype,"rowContainerHeightService",void 0),Io([Nr("ctrlsService")],r.prototype,"ctrlsService",void 0),Io([zt],r.prototype,"postConstruct",null),Io([Kt("rowRenderer")],r)}(ct),Zy=function(){function h(r){this.entriesMap={},this.entriesList=[],this.maxCount=r}return h.prototype.toString=function(){return this.entriesList.map(function(r){return r.getRowNode().data.name}).join(", ")},h.prototype.addRow=function(r){if(this.entriesMap[r.getRowNode().id]=r,this.entriesList.push(r),r.setCached(!0),this.entriesList.length>this.maxCount){var t=this.entriesList[0];t.destroyFirstPass(),t.destroySecondPass(),this.removeFromCache(t)}},h.prototype.getRow=function(r){if(null==r||null==r.id)return null;var t=this.entriesMap[r.id];return t?(this.removeFromCache(t),t.setCached(!1),t.getRowNode()!=r?null:t):null},h.prototype.removeFromCache=function(r){var t=r.getRowNode().id;delete this.entriesMap[t],k(this.entriesList,r)},h.prototype.getEntries=function(){return this.entriesList},h}(),yc=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Cc=function(h){function r(t,n){var c=h.call(this,t)||this;return c.ctrl=n,c}return yc(r,h),r.prototype.getCtrl=function(){return this.ctrl},r}(dn),Ga=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),ul=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},gv=function(h){function r(t){var n=h.call(this,r.TEMPLATE,t)||this;return n.headerCompVersion=0,n.column=t.getColumnGroupChild(),n.pinned=t.getPinned(),n}return Ga(r,h),r.prototype.postConstruct=function(){var t=this,n=this.getGui(),c=function(B,q,de){var Se=de||n;null!=q&&""!=q?Se.setAttribute(B,q):Se.removeAttribute(B)};this.ctrl.setComp({setWidth:function(B){return n.style.width=B},addOrRemoveCssClass:function(B,q){return t.addOrRemoveCssClass(B,q)},setAriaSort:function(B){return B?J1(n,B):Z1(n)},setColId:function(B){return c("col-id",B)},setTitle:function(B){return c("title",B)},setAriaDescribedBy:function(B){return To(n,B)},setUserCompDetails:function(B){return t.setUserCompDetails(B)},getUserCompInstance:function(){return t.headerComp}},this.getGui(),this.eResize);var y=this.ctrl.getSelectAllGui();this.eResize.insertAdjacentElement("afterend",y)},r.prototype.destroyHeaderComp=function(){this.headerComp&&(this.getGui().removeChild(this.headerCompGui),this.headerComp=this.destroyBean(this.headerComp),this.headerCompGui=void 0)},r.prototype.setUserCompDetails=function(t){var n=this;this.headerCompVersion++;var c=this.headerCompVersion;t.newAgStackInstance().then(function(f){return n.afterCompCreated(c,f)})},r.prototype.afterCompCreated=function(t,n){t==this.headerCompVersion&&this.isAlive()?(this.destroyHeaderComp(),this.headerComp=n,this.headerCompGui=n.getGui(),this.getGui().appendChild(this.headerCompGui),this.ctrl.setDragSource(this.headerCompGui)):this.destroyBean(n)},r.TEMPLATE='<div class="ag-header-cell" role="columnheader" unselectable="on" tabindex="-1">\n            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>\n        </div>',ul([Bt("eResize")],r.prototype,"eResize",void 0),ul([zt],r.prototype,"postConstruct",null),ul([Ln],r.prototype,"destroyHeaderComp",null),r}(Cc),mv=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),wc=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},$y=function(h){function r(t){return h.call(this,r.TEMPLATE,t)||this}return mv(r,h),r.prototype.postConstruct=function(){var t=this,n=this.getGui(),c=function(T,B){return null!=B?n.setAttribute(T,B):n.removeAttribute(T)};this.ctrl.setComp({addOrRemoveCssClass:function(T,B){return t.addOrRemoveCssClass(T,B)},addOrRemoveResizableCssClass:function(T,B){return Fr(t.eResize,T,B)},setWidth:function(T){return n.style.width=T},setColId:function(T){return n.setAttribute("col-id",T)},setAriaExpanded:function(T){return c("aria-expanded",T)},setTitle:function(T){return c("title",T)},setUserCompDetails:function(T){return t.setUserCompDetails(T)}},n,this.eResize)},r.prototype.setUserCompDetails=function(t){var n=this;t.newAgStackInstance().then(function(c){return n.afterHeaderCompCreated(c)})},r.prototype.afterHeaderCompCreated=function(t){var n=this,c=function(){return n.destroyBean(t)};this.isAlive()?(this.getGui().appendChild(t.getGui()),this.addDestroyFunc(c),this.ctrl.setDragSource(t.getGui())):c()},r.TEMPLATE='<div class="ag-header-group-cell" role="columnheader" tabindex="-1">\n            <div ref="eResize" class="ag-header-cell-resize" role="presentation"></div>\n        </div>',wc([Ee("userComponentFactory")],r.prototype,"userComponentFactory",void 0),wc([Bt("eResize")],r.prototype,"eResize",void 0),wc([zt],r.prototype,"postConstruct",null),r}(Cc),e2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),_c=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Sc=function(h){function r(t){return h.call(this,r.TEMPLATE,t)||this}return e2(r,h),r.prototype.postConstruct=function(){var t=this,n=this.getGui();this.ctrl.setComp({addOrRemoveCssClass:function(y,T){return t.addOrRemoveCssClass(y,T)},addOrRemoveBodyCssClass:function(y,T){return Fr(t.eFloatingFilterBody,y,T)},addOrRemoveButtonWrapperCssClass:function(y,T){return Fr(t.eButtonWrapper,y,T)},setCompDetails:function(y){return t.setCompDetails(y)},getFloatingFilterComp:function(){return t.compPromise},setWidth:function(y){return n.style.width=y},setMenuIcon:function(y){return t.eButtonShowMainFilter.appendChild(y)}},n,this.eButtonShowMainFilter,this.eFloatingFilterBody)},r.prototype.setCompDetails=function(t){var n=this;this.compPromise=t.newAgStackInstance(),this.compPromise.then(function(c){return n.afterCompCreated(c)})},r.prototype.afterCompCreated=function(t){var n=this;!t||(this.addDestroyFunc(function(){return n.context.destroyBean(t)}),this.isAlive()&&(this.eFloatingFilterBody.appendChild(t.getGui()),t.afterGuiAttached&&t.afterGuiAttached()))},r.TEMPLATE='<div class="ag-header-cell ag-floating-filter" role="gridcell" tabindex="-1">\n            <div ref="eFloatingFilterBody" role="presentation"></div>\n            <div class="ag-floating-filter-button ag-hidden" ref="eButtonWrapper" role="presentation">\n                <button type="button" aria-label="Open Filter Menu" class="ag-floating-filter-button-button" ref="eButtonShowMainFilter" tabindex="-1"></button>\n            </div>\n        </div>',_c([Bt("eFloatingFilterBody")],r.prototype,"eFloatingFilterBody",void 0),_c([Bt("eButtonWrapper")],r.prototype,"eButtonWrapper",void 0),_c([Bt("eButtonShowMainFilter")],r.prototype,"eButtonShowMainFilter",void 0),_c([zt],r.prototype,"postConstruct",null),r}(Cc),md=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),xc=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f};!function(h){h.COLUMN_GROUP="group",h.COLUMN="column",h.FLOATING_FILTER="filter"}(e.A6C||(e.A6C={}));var yv=function(h){function r(t){var n=h.call(this)||this;n.headerComps={};var c=t.getType()==e.A6C.COLUMN_GROUP?"ag-header-row-column-group":t.getType()==e.A6C.FLOATING_FILTER?"ag-header-row-column-filter":"ag-header-row-column";return n.setTemplate('<div class="ag-header-row '+c+'" role="row"></div>'),n.ctrl=t,n}return md(r,h),r.prototype.init=function(){var t=this;this.ctrl.setComp({setTransform:function(f){return t.getGui().style.transform=f},setHeight:function(f){return t.getGui().style.height=f},setTop:function(f){return t.getGui().style.top=f},setHeaderCtrls:function(f){return t.setHeaderCtrls(f)},setWidth:function(f){return t.getGui().style.width=f},setAriaRowIndex:function(f){return xp(t.getGui(),f)}})},r.prototype.destroyHeaderCtrls=function(){this.setHeaderCtrls([])},r.prototype.setHeaderCtrls=function(t){var n=this;if(this.isAlive()){var c=this.headerComps;if(this.headerComps={},t.forEach(function(B){var q=B.getInstanceId(),de=c[q];delete c[q],null==de&&(de=n.createHeaderComp(B),n.getGui().appendChild(de.getGui())),n.headerComps[q]=de}),ce(c,function(B,q){n.getGui().removeChild(q.getGui()),n.destroyBean(q)}),this.gridOptionsWrapper.isEnsureDomOrder()){var y=$e(this.headerComps);y.sort(function(B,q){return B.getCtrl().getColumnGroupChild().getLeft()-q.getCtrl().getColumnGroupChild().getLeft()});var T=y.map(function(B){return B.getGui()});bo(this.getGui(),T)}}},r.prototype.createHeaderComp=function(t){var n;switch(this.ctrl.getType()){case e.A6C.COLUMN_GROUP:n=new $y(t);break;case e.A6C.FLOATING_FILTER:n=new Sc(t);break;default:n=new gv(t)}return this.createBean(n),n.setParentComponent(this),n},xc([zt],r.prototype,"init",null),xc([Ln],r.prototype,"destroyHeaderCtrls",null),r}(dn),t2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),cl=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f};!function(h){h[h.UP=0]="UP",h[h.DOWN=1]="DOWN",h[h.LEFT=2]="LEFT",h[h.RIGHT=3]="RIGHT"}(e.Y8R||(e.Y8R={}));var Cv=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return t2(r,h),r.prototype.postConstruct=function(){var t=this;this.ctrlsService.whenReady(function(n){t.gridBodyCon=n.gridBodyCtrl})},r.prototype.getHeaderRowCount=function(){var t=this.ctrlsService.getHeaderRowContainerCtrl();return t?t.getRowCount():0},r.prototype.getHeaderRowType=function(t){var n=this.ctrlsService.getHeaderRowContainerCtrl();if(n)return n.getRowType(t)},r.prototype.navigateVertically=function(t,n,c){if(n||(n=this.focusService.getFocusedHeader()),!n)return!1;var f=n.headerRowIndex,y=n.column,T=this.getHeaderRowCount(),B=t===e.Y8R.UP,q=B?f-1:f+1,de=null,Se=!1;q<0&&(q=0,de=y,Se=!0),q>=T&&(q=-1);var ke=this.getHeaderRowType(f);if(!Se){if(ke===e.A6C.COLUMN_GROUP){var je=y;de=B?y.getParent():je.getDisplayedChildren()[0]}else ke===e.A6C.FLOATING_FILTER?de=y:(je=y,de=B?je.getParent():je);if(!de)return!1}return this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:q,column:de},allowUserOverride:!0,event:c})},r.prototype.navigateHorizontally=function(t,n,c){void 0===n&&(n=!1);var B,q,f=this.focusService.getFocusedHeader();return(B=t===e.Y8R.LEFT!==this.gridOptionsWrapper.isEnableRtl()?this.headerPositionUtils.findHeader(f,q="Before"):this.headerPositionUtils.findHeader(f,q="After"))?this.focusService.focusHeaderPosition({headerPosition:B,direction:q,fromTab:n,allowUserOverride:!0,event:c}):!n||this.focusNextHeaderRow(f,q,c)},r.prototype.focusNextHeaderRow=function(t,n,c){var f=t.headerRowIndex,y=null;return"Before"===n?f>0&&(y=this.headerPositionUtils.findColAtEdgeForHeaderRow(f-1,"end")):y=this.headerPositionUtils.findColAtEdgeForHeaderRow(f+1,"start"),this.focusService.focusHeaderPosition({headerPosition:y,direction:n,fromTab:!0,allowUserOverride:!0,event:c})},r.prototype.scrollToColumn=function(t,n){if(void 0===n&&(n="After"),!t.getPinned()){var c;if(t instanceof xt){var f=t.getDisplayedLeafColumns();c="Before"===n?H(f):f[0]}else c=t;this.gridBodyCon.getScrollFeature().ensureColumnVisible(c),this.gridBodyCon.getScrollFeature().horizontallyScrollHeaderCenterAndFloatingCenter(),this.animationFrameService.flushAllFrames()}},cl([Ee("focusService")],r.prototype,"focusService",void 0),cl([Ee("headerPositionUtils")],r.prototype,"headerPositionUtils",void 0),cl([Ee("animationFrameService")],r.prototype,"animationFrameService",void 0),cl([Ee("ctrlsService")],r.prototype,"ctrlsService",void 0),cl([zt],r.prototype,"postConstruct",null),cl([Kt("headerNavigationService")],r)}(ct),r2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),bc=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},wv=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return r2(r,h),r.prototype.setComp=function(t,n,c){this.comp=t,this.eGui=n,this.createManagedBean(new Qo(c,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.onPivotModeChanged.bind(this)),this.onPivotModeChanged(),this.setupHeaderHeight(),this.ctrlsService.registerGridHeaderCtrl(this)},r.prototype.setupHeaderHeight=function(){var t=this.setHeaderHeight.bind(this);t(),this.addManagedListener(this.gridOptionsWrapper,vr.PROP_HEADER_HEIGHT,t),this.addManagedListener(this.gridOptionsWrapper,vr.PROP_PIVOT_HEADER_HEIGHT,t),this.addManagedListener(this.gridOptionsWrapper,vr.PROP_GROUP_HEADER_HEIGHT,t),this.addManagedListener(this.gridOptionsWrapper,vr.PROP_PIVOT_GROUP_HEADER_HEIGHT,t),this.addManagedListener(this.gridOptionsWrapper,vr.PROP_FLOATING_FILTERS_HEIGHT,t),this.addManagedListener(this.eventService,Ge.EVENT_DISPLAYED_COLUMNS_CHANGED,t)},r.prototype.setHeaderHeight=function(){var T,B,q,n=this.columnModel,c=this.gridOptionsWrapper,f=0,y=n.getHeaderRowCount();n.isPivotMode()?(B=c.getPivotGroupHeaderHeight(),q=c.getPivotHeaderHeight()):(n.hasFloatingFilters()&&(y++,f=1),B=c.getGroupHeaderHeight(),q=c.getHeaderHeight());var ke=y-(1+f);T=f*c.getFloatingFiltersHeight(),T+=ke*B,this.comp.setHeightAndMinHeight((T+=q)+1+"px")},r.prototype.onPivotModeChanged=function(){var t=this.columnModel.isPivotMode();this.comp.addOrRemoveCssClass("ag-pivot-on",t),this.comp.addOrRemoveCssClass("ag-pivot-off",!t)},r.prototype.onTabKeyDown=function(t){var n=this.gridOptionsWrapper.isEnableRtl();(this.headerNavigationService.navigateHorizontally(t.shiftKey!==n?e.Y8R.LEFT:e.Y8R.RIGHT,!0,t)||this.focusService.focusNextGridCoreContainer(t.shiftKey))&&t.preventDefault()},r.prototype.handleKeyDown=function(t){var n=null;switch(t.keyCode){case Yt.LEFT:n=e.Y8R.LEFT;case Yt.RIGHT:v(n)||(n=e.Y8R.RIGHT),this.headerNavigationService.navigateHorizontally(n,!1,t);break;case Yt.UP:n=e.Y8R.UP;case Yt.DOWN:v(n)||(n=e.Y8R.DOWN),this.headerNavigationService.navigateVertically(n,null,t)&&t.preventDefault();break;default:return}},r.prototype.onFocusOut=function(t){var n=t.relatedTarget;!n&&this.eGui.contains(document.activeElement)||this.eGui.contains(n)||this.focusService.clearFocusedHeader()},bc([Ee("headerNavigationService")],r.prototype,"headerNavigationService",void 0),bc([Ee("focusService")],r.prototype,"focusService",void 0),bc([Ee("columnModel")],r.prototype,"columnModel",void 0),bc([Ee("ctrlsService")],r.prototype,"ctrlsService",void 0),r}(ct),_v=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),o0=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},yd=function(h){function r(t){var n=h.call(this)||this;return n.callback=t,n}return _v(r,h),r.prototype.postConstruct=function(){var t=this.setWidth.bind(this);this.addManagedListener(this.gridOptionsWrapper,vr.PROP_DOM_LAYOUT,t),this.addManagedListener(this.eventService,Ge.EVENT_DISPLAYED_COLUMNS_CHANGED,t),this.addManagedListener(this.eventService,Ge.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,t),this.setWidth()},r.prototype.setWidth=function(){var t=this.columnModel,n=this.gridOptionsWrapper.getDomLayout()===W.DOM_LAYOUT_PRINT,c=t.getBodyContainerWidth(),f=t.getDisplayedColumnsLeftWidth(),y=t.getDisplayedColumnsRightWidth();this.callback(n?c+f+y:c)},o0([Ee("columnModel")],r.prototype,"columnModel",void 0),o0([zt],r.prototype,"postConstruct",null),r}(ct),fl=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Sv=function(){function h(r,t){this.needToMoveLeft=!1,this.needToMoveRight=!1,this.pinned=r,this.eContainer=t,this.centerContainer=!v(r)}return h.prototype.init=function(){var r=this;this.ctrlsService.whenReady(function(){r.gridBodyCon=r.ctrlsService.getGridBodyCtrl()})},h.prototype.getIconName=function(){return this.pinned?ao.ICON_PINNED:ao.ICON_MOVE},h.prototype.onDragEnter=function(r){var t=r.dragItem.columns;if(r.dragSource.type===e.rvo.ToolPanel)this.setColumnsVisible(t,!0,"uiColumnDragged");else{var c=r.dragItem.visibleState,f=(t||[]).filter(function(y){return c[y.getId()]});this.setColumnsVisible(f,!0,"uiColumnDragged")}this.setColumnsPinned(t,this.pinned,"uiColumnDragged"),this.onDragging(r,!0)},h.prototype.onDragLeave=function(r){if(!this.gridOptionsWrapper.isSuppressDragLeaveHidesColumns()&&!r.fromNudge){var n=r.dragSource.getDragItem();this.setColumnsVisible(n.columns,!1,"uiColumnDragged")}this.ensureIntervalCleared()},h.prototype.setColumnsVisible=function(r,t,n){if(void 0===n&&(n="api"),r){var c=r.filter(function(f){return!f.getColDef().lockVisible});this.columnModel.setColumnsVisible(c,t,n)}},h.prototype.setColumnsPinned=function(r,t,n){if(void 0===n&&(n="api"),r){var c=r.filter(function(f){return!f.getColDef().lockPinned});this.columnModel.setColumnsPinned(c,t,n)}},h.prototype.onDragStop=function(){this.ensureIntervalCleared()},h.prototype.normaliseX=function(r){return this.gridOptionsWrapper.isEnableRtl()&&(r=this.eContainer.clientWidth-r),this.centerContainer&&(r+=this.ctrlsService.getCenterRowContainerCtrl().getCenterViewportScrollLeft()),r},h.prototype.checkCenterForScrolling=function(r){if(this.centerContainer){var t=this.ctrlsService.getCenterRowContainerCtrl().getCenterViewportScrollLeft(),n=t+this.ctrlsService.getCenterRowContainerCtrl().getCenterWidth();this.gridOptionsWrapper.isEnableRtl()?(this.needToMoveRight=r<t+50,this.needToMoveLeft=r>n-50):(this.needToMoveLeft=r<t+50,this.needToMoveRight=r>n-50),this.needToMoveLeft||this.needToMoveRight?this.ensureIntervalStarted():this.ensureIntervalCleared()}},h.prototype.onDragging=function(r,t){var n=this;if(void 0===t&&(t=!1),this.lastDraggingEvent=r,!g(r.hDirection)){var c=this.normaliseX(r.x);t||this.checkCenterForScrolling(c);var f=this.normaliseDirection(r.hDirection),y=r.dragSource.type,T=r.dragSource.getDragItem().columns;T=T.filter(function(B){return!B.getColDef().lockPinned||B.getPinned()==n.pinned}),this.attemptMoveColumns(y,T,f,c,t)}},h.prototype.normaliseDirection=function(r){if(!this.gridOptionsWrapper.isEnableRtl())return r;switch(r){case e.poj.Left:return e.poj.Right;case e.poj.Right:return e.poj.Left;default:console.error("AG Grid: Unknown direction "+r)}},h.prototype.calculateOldIndex=function(r){var t=this.columnModel.getAllGridColumns(),n=te(r.map(function(B){return t.indexOf(B)})),c=n[0];return H(n)-c!=n.length-1?null:c},h.prototype.attemptMoveColumns=function(r,t,n,c,f){var y=n===e.poj.Left,T=n===e.poj.Right,B=t.slice();this.columnModel.sortColumnsLikeGridColumns(B);var q=this.calculateValidMoves(B,T,c),de=this.calculateOldIndex(B);if(0!==q.length){var Se=q[0],ke=null!==de&&!f;if(r==e.rvo.HeaderCell&&(ke=null!==de),!ke||!(y&&Se>=de||T&&Se<=de))for(var je=0;je<q.length;je++){var Qe=q[je];if(this.columnModel.doesMovePassRules(B,Qe))return void this.columnModel.moveColumns(B,Qe,"uiColumnDragged")}}},h.prototype.calculateValidMoves=function(r,t,n){if(this.gridOptionsWrapper.isSuppressMovableColumns()||r.some(function(Br){return Br.getColDef().suppressMovable}))return[];var rt,f=this.columnModel.getDisplayedColumns(this.pinned),y=this.columnModel.getAllGridColumns(),T=f.filter(function(Br){return oe(r,Br)}),B=f.filter(function(Br){return!oe(r,Br)}),q=y.filter(function(Br){return!oe(r,Br)}),de=0,Se=n;if(t){var ke=0;T.forEach(function(Br){return ke+=Br.getActualWidth()}),Se-=ke}if(Se>0){for(var je=0;je<B.length&&!((Se-=B[je].getActualWidth())<0);je++)de++;t&&de++}de>0?rt=q.indexOf(B[de-1])+1:-1===(rt=q.indexOf(B[0]))&&(rt=0);var Vt=[rt],Ut=function(gn,In){return gn-In};if(t){for(var Rt=rt+1,qt=y.length-1;Rt<=qt;)Vt.push(Rt),Rt++;Vt.sort(Ut)}else{qt=y.length-1;for(var It=y[Rt=rt];Rt<=qt&&this.isColumnHidden(f,It);)Rt++,Vt.push(Rt),It=y[Rt];for(Rt=rt-1;Rt>=0;)Vt.push(Rt),Rt--;Vt.sort(Ut).reverse()}return Vt},h.prototype.isColumnHidden=function(r,t){return r.indexOf(t)<0},h.prototype.ensureIntervalStarted=function(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),100),this.dragAndDropService.setGhostIcon(this.needToMoveLeft?ao.ICON_LEFT:ao.ICON_RIGHT,!0))},h.prototype.ensureIntervalCleared=function(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.dragAndDropService.setGhostIcon(ao.ICON_MOVE))},h.prototype.moveInterval=function(){var r;this.intervalCount++,(r=10+5*this.intervalCount)>100&&(r=100);var t=null,n=this.gridBodyCon.getScrollFeature();if(this.needToMoveLeft?t=n.scrollHorizontally(-r):this.needToMoveRight&&(t=n.scrollHorizontally(r)),0!==t)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;var f=this.lastDraggingEvent.dragItem.columns.filter(function(T){return!T.getColDef().lockPinned});f.length>0&&(this.dragAndDropService.setGhostIcon(ao.ICON_PINNED),this.failedMoveAttempts>7)&&(this.setColumnsPinned(f,this.needToMoveLeft?W.PINNED_LEFT:W.PINNED_RIGHT,"uiColumnDragged"),this.dragAndDropService.nudge())}},fl([Ee("columnModel")],h.prototype,"columnModel",void 0),fl([Ee("dragAndDropService")],h.prototype,"dragAndDropService",void 0),fl([Ee("gridOptionsWrapper")],h.prototype,"gridOptionsWrapper",void 0),fl([Ee("ctrlsService")],h.prototype,"ctrlsService",void 0),fl([zt],h.prototype,"init",null),h}(),vi=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},xv=function(){function h(r){this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[],this.pinned=r}return h.prototype.onDragEnter=function(r){var t=this;if(this.clearColumnsList(),!this.gridOptionsWrapper.isFunctionsReadOnly()){var n=r.dragItem.columns;!n||n.forEach(function(c){!c.isPrimary()||c.isAnyFunctionActive()||(c.isAllowValue()?t.columnsToAggregate.push(c):c.isAllowRowGroup()?t.columnsToGroup.push(c):c.isAllowPivot()&&t.columnsToPivot.push(c))})}},h.prototype.getIconName=function(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?ao.ICON_PINNED:ao.ICON_MOVE:null},h.prototype.onDragLeave=function(r){this.clearColumnsList()},h.prototype.clearColumnsList=function(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0},h.prototype.onDragging=function(r){},h.prototype.onDragStop=function(r){this.columnsToAggregate.length>0&&this.columnModel.addValueColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&this.columnModel.addRowGroupColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&this.columnModel.addPivotColumns(this.columnsToPivot,"toolPanelDragAndDrop")},vi([Ee("columnModel")],h.prototype,"columnModel",void 0),vi([Ee("gridOptionsWrapper")],h.prototype,"gridOptionsWrapper",void 0),h}(),n2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),qi=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Cd=function(h){function r(t,n){var c=h.call(this)||this;return c.pinned=t,c.eContainer=n,c}return n2(r,h),r.prototype.postConstruct=function(){var t=this;this.ctrlsService.whenReady(function(n){switch(t.pinned){case W.PINNED_LEFT:t.eSecondaryContainers=[[n.gridBodyCtrl.getBodyViewportElement(),n.leftRowContainerCtrl.getContainerElement()],[n.bottomLeftRowContainerCtrl.getContainerElement()],[n.topLeftRowContainerCtrl.getContainerElement()]];break;case W.PINNED_RIGHT:t.eSecondaryContainers=[[n.gridBodyCtrl.getBodyViewportElement(),n.rightRowContainerCtrl.getContainerElement()],[n.bottomRightRowContainerCtrl.getContainerElement()],[n.topRightRowContainerCtrl.getContainerElement()]];break;default:t.eSecondaryContainers=[[n.gridBodyCtrl.getBodyViewportElement(),n.centerRowContainerCtrl.getViewportElement()],[n.bottomCenterRowContainerCtrl.getViewportElement()],[n.topCenterRowContainerCtrl.getViewportElement()]]}})},r.prototype.isInterestedIn=function(t){return t===e.rvo.HeaderCell||t===e.rvo.ToolPanel&&this.gridOptionsWrapper.isAllowDragFromColumnsToolPanel()},r.prototype.getSecondaryContainers=function(){return this.eSecondaryContainers},r.prototype.getContainer=function(){return this.eContainer},r.prototype.init=function(){this.moveColumnFeature=this.createManagedBean(new Sv(this.pinned,this.eContainer)),this.bodyDropPivotTarget=this.createManagedBean(new xv(this.pinned)),this.dragAndDropService.addDropTarget(this)},r.prototype.getIconName=function(){return this.currentDropListener.getIconName()},r.prototype.isDropColumnInPivotMode=function(t){return this.columnModel.isPivotMode()&&t.dragSource.type===e.rvo.ToolPanel},r.prototype.onDragEnter=function(t){this.currentDropListener=this.isDropColumnInPivotMode(t)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(t)},r.prototype.onDragLeave=function(t){this.currentDropListener.onDragLeave(t)},r.prototype.onDragging=function(t){this.currentDropListener.onDragging(t)},r.prototype.onDragStop=function(t){this.currentDropListener.onDragStop(t)},qi([Ee("dragAndDropService")],r.prototype,"dragAndDropService",void 0),qi([Ee("columnModel")],r.prototype,"columnModel",void 0),qi([Ee("ctrlsService")],r.prototype,"ctrlsService",void 0),qi([zt],r.prototype,"postConstruct",null),qi([zt],r.prototype,"init",null),r}(ct),i2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),a2=0,a0=function(h){function r(t,n){var c=h.call(this)||this;return c.lastFocusEvent=null,c.columnGroupChild=t,c.parentRowCtrl=n,c.instanceId=t.getUniqueId()+"-"+a2++,c}return i2(r,h),r.prototype.shouldStopEventPropagation=function(t){var n=this.focusService.getFocusedHeader();return Hf(this.gridOptionsWrapper,t,n.headerRowIndex,n.column)},r.prototype.setGui=function(t){this.eGui=t,this.addDomData()},r.prototype.addDomData=function(){var t=this,n=r.DOM_DATA_KEY_HEADER_CTRL;this.gridOptionsWrapper.setDomData(this.eGui,n,this),this.addDestroyFunc(function(){return t.gridOptionsWrapper.setDomData(t.eGui,n,null)})},r.prototype.focus=function(t){return!!this.eGui&&(this.lastFocusEvent=t||null,this.eGui.focus(),!0)},r.prototype.getRowIndex=function(){return this.parentRowCtrl.getRowIndex()},r.prototype.getParentRowCtrl=function(){return this.parentRowCtrl},r.prototype.getPinned=function(){return this.parentRowCtrl.getPinned()},r.prototype.getInstanceId=function(){return this.instanceId},r.prototype.getColumnGroupChild=function(){return this.columnGroupChild},r.DOM_DATA_KEY_HEADER_CTRL="headerCtrl",function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);c>3&&f&&Object.defineProperty(r,t,f)}([Ee("focusService")],r.prototype,"focusService",void 0),r}(ct),bv=function(){function h(){}return h.getFloatingFilterType=function(r){return this.filterToFloatingFilterMapping[r]},h.filterToFloatingFilterMapping={set:"agSetColumnFloatingFilter",agSetColumnFilter:"agSetColumnFloatingFilter",multi:"agMultiColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",number:"agNumberColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",date:"agDateColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",text:"agTextColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"},h}(),$4=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ps=function(h){function r(t,n,c,f){var y=h.call(this)||this;return y.columnOrGroup=t,y.eCell=n,y.ariaEl=y.eCell.querySelector("[role=columnheader]")||y.eCell,y.colsSpanning=f,y.beans=c,y}return $4(r,h),r.prototype.setColsSpanning=function(t){this.colsSpanning=t,this.onLeftChanged()},r.prototype.getColumnOrGroup=function(){return this.beans.gridOptionsWrapper.isEnableRtl()&&this.colsSpanning?H(this.colsSpanning):this.columnOrGroup},r.prototype.postConstruct=function(){this.addManagedListener(this.columnOrGroup,it.EVENT_LEFT_CHANGED,this.onLeftChanged.bind(this)),this.setLeftFirstTime(),this.addManagedListener(this.eventService,Ge.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onLeftChanged.bind(this)),this.addManagedListener(this.beans.gridOptionsWrapper,vr.PROP_DOM_LAYOUT,this.onLeftChanged.bind(this))},r.prototype.setLeftFirstTime=function(){var t=this.beans.gridOptionsWrapper.isSuppressColumnMoveAnimation(),n=v(this.columnOrGroup.getOldLeft());this.beans.columnAnimationService.isActive()&&n&&!t?this.animateInLeft():this.onLeftChanged()},r.prototype.animateInLeft=function(){var t=this,n=this.getColumnOrGroup(),c=n.getLeft(),f=n.getOldLeft(),y=this.modifyLeftForPrintLayout(n,f),T=this.modifyLeftForPrintLayout(n,c);this.setLeft(y),this.actualLeft=T,this.beans.columnAnimationService.executeNextVMTurn(function(){t.actualLeft===T&&t.setLeft(T)})},r.prototype.onLeftChanged=function(){var t=this.getColumnOrGroup(),n=t.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(t,n),this.setLeft(this.actualLeft)},r.prototype.modifyLeftForPrintLayout=function(t,n){if(this.beans.gridOptionsWrapper.getDomLayout()!==W.DOM_LAYOUT_PRINT||t.getPinned()===W.PINNED_LEFT)return n;var f=this.beans.columnModel.getDisplayedColumnsLeftWidth();return t.getPinned()===W.PINNED_RIGHT?f+this.beans.columnModel.getBodyContainerWidth()+n:f+n},r.prototype.setLeft=function(t){var n;if(v(t)&&(this.eCell.style.left=t+"px"),this.columnOrGroup instanceof it)n=this.columnOrGroup;else{var f=this.columnOrGroup.getLeafColumns();if(!f.length)return;f.length>1&&Q1(this.ariaEl,f.length),n=f[0]}var y=this.beans.columnModel.getAriaColumnIndex(n);bp(this.ariaEl,y)},function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);c>3&&f&&Object.defineProperty(r,t,f)}([zt],r.prototype,"postConstruct",null),r}(ct),$o=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ac=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Mc=function(h){function r(t,n){var c=h.call(this)||this;return c.columns=t,c.element=n,c}return $o(r,h),r.prototype.postConstruct=function(){this.gridOptionsWrapper.isColumnHoverHighlight()&&this.addMouseHoverListeners()},r.prototype.addMouseHoverListeners=function(){this.addManagedListener(this.element,"mouseout",this.onMouseOut.bind(this)),this.addManagedListener(this.element,"mouseover",this.onMouseOver.bind(this))},r.prototype.onMouseOut=function(){this.columnHoverService.clearMouseOver()},r.prototype.onMouseOver=function(){this.columnHoverService.setMouseOver(this.columns)},Ac([Ee("columnHoverService")],r.prototype,"columnHoverService",void 0),Ac([zt],r.prototype,"postConstruct",null),r}(ct),Av=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),fi=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},$l=function(h){function r(t,n){var c=h.call(this,t,n)||this;return c.column=t,c}return Av(r,h),r.prototype.setComp=function(t,n,c,f){h.prototype.setGui.call(this,n),this.comp=t,this.eButtonShowMainFilter=c,this.eFloatingFilterBody=f;var y=this.column.getColDef();this.active=!(!y.filter&&!y.filterFramework||!y.floatingFilter),this.setupWidth(),this.setupLeft(),this.setupHover(),this.setupFocus(),this.setupUserComp(),this.setupSyncWithFilter(),this.setupUi(),this.addManagedListener(this.eButtonShowMainFilter,"click",this.showParentFilter.bind(this))},r.prototype.setupUi=function(){if(this.comp.addOrRemoveButtonWrapperCssClass("ag-hidden",!this.active||this.suppressFilterButton),this.active){this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton);var t=Bi("filter",this.gridOptionsWrapper,this.column);t&&this.eButtonShowMainFilter.appendChild(t)}},r.prototype.setupFocus=function(){this.createManagedBean(new Qo(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))},r.prototype.onTabKeyDown=function(t){if(document.activeElement!==this.eGui){var f=this.focusService.findNextFocusableElement(this.eGui,null,t.shiftKey);f&&(t.preventDefault(),f.focus())}},r.prototype.handleKeyDown=function(t){var c=document.activeElement===this.eGui;switch(t.keyCode){case Yt.UP:case Yt.DOWN:c||t.preventDefault();case Yt.LEFT:case Yt.RIGHT:if(c)return;t.stopPropagation();case Yt.ENTER:c&&this.focusService.focusInto(this.eGui)&&t.preventDefault();break;case Yt.ESCAPE:c||this.eGui.focus()}},r.prototype.onFocusIn=function(t){if(!this.eGui.contains(t.relatedTarget)){var c=this.focusService.isKeyboardMode(),f=!!t.relatedTarget&&!qa(t.relatedTarget,"ag-floating-filter"),y=!!t.relatedTarget&&Rl(t.relatedTarget,"ag-floating-filter");if(c&&f&&y&&t.target===this.eGui){var T=this.lastFocusEvent;if(T&&T&&T.keyCode===Yt.TAB){var q=this.beans.focusService.getFocusedHeader(),de=this.beans.columnModel.getDisplayedColAfter(this.column);this.focusService.focusInto(this.eGui,!!(c&&T.shiftKey&&q&&de===q.column))}}var je=this.getRowIndex();this.beans.focusService.setFocusedHeader(je,this.column)}},r.prototype.setupHover=function(){var t=this;this.createManagedBean(new Mc([this.column],this.eGui));var n=function(){if(t.gridOptionsWrapper.isColumnHoverHighlight()){var f=t.columnHoverService.isHovered(t.column);t.comp.addOrRemoveCssClass("ag-column-hover",f)}};this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_HOVER_CHANGED,n),n()},r.prototype.setupLeft=function(){var t=new Ps(this.column,this.eGui,this.beans);this.createManagedBean(t)},r.prototype.setupUserComp=function(){if(this.active){var t=this.column.getColDef(),n=this.filterManager.createFilterParams(this.column,t),c=this.userComponentFactory.mergeParamsWithApplicationProvidedParams(t,"filter",n),f=r.getDefaultFloatingFilterType(t);null==f&&(f="agReadOnlyFloatingFilter");var y={api:this.gridApi,column:this.column,filterParams:c,currentParentModel:this.currentParentModel.bind(this),parentFilterInstance:this.parentFilterInstance.bind(this),showParentFilter:this.showParentFilter.bind(this),onFloatingFilterChanged:this.onFloatingFilterChanged.bind(this),suppressFilterButton:!1};this.suppressFilterButton=!!t.floatingFilterComponentParams&&!!t.floatingFilterComponentParams.suppressFilterButton;var T=this.userComponentFactory.getFloatingFilterCompDetails(t,y,f);T&&this.comp.setCompDetails(T)}},r.getDefaultFloatingFilterType=function(t){if(null==t)return null;var n=null;return"string"==typeof t.filter?n=bv.getFloatingFilterType(t.filter):t.filterFramework||!0===t.filter&&(n=ne.isRegistered(e.GXE.SetFilterModule)?"agSetColumnFloatingFilter":"agTextColumnFloatingFilter"),n},r.prototype.currentParentModel=function(){var t=this.getFilterComponent(!1);return t?t.resolveNow(null,function(n){return n&&n.getModel()}):null},r.prototype.getFilterComponent=function(t){return void 0===t&&(t=!0),this.filterManager.getFilterComponent(this.column,"NO_UI",t)},r.prototype.onFloatingFilterChanged=function(){console.warn("AG Grid: since version 21.x, how floating filters are implemented has changed. Instead of calling params.onFloatingFilterChanged(), get a reference to the main filter via params.parentFilterInstance() and then set a value on the parent filter directly.")},r.prototype.parentFilterInstance=function(t){var n=this,c=this.getFilterComponent();c&&c.then(function(f){var y=n.frameworkComponentWrapper?n.frameworkComponentWrapper.unwrap(f):f;t(y)})},r.prototype.showParentFilter=function(){this.menuFactory.showMenuAfterButtonClick(this.column,this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter,"floatingFilter","filterMenuTab",["filterMenuTab"])},r.prototype.setupSyncWithFilter=function(){var t=this;if(this.active){var n=function(f){var y=t.comp.getFloatingFilterComp();if(y){var T=t.currentParentModel();y.then(function(B){return B&&B.onParentModelChanged(T,f)})}};this.addManagedListener(this.column,it.EVENT_FILTER_CHANGED,n),this.filterManager.isFilterActive(this.column)&&n(null)}},r.prototype.setupWidth=function(){var t=this,n=function(){var f=t.column.getActualWidth()+"px";t.comp.setWidth(f)};this.addManagedListener(this.column,it.EVENT_WIDTH_CHANGED,n),n()},fi([Ee("userComponentFactory")],r.prototype,"userComponentFactory",void 0),fi([Ee("filterManager")],r.prototype,"filterManager",void 0),fi([Ee("columnHoverService")],r.prototype,"columnHoverService",void 0),fi([Ee("gridApi")],r.prototype,"gridApi",void 0),fi([Ee("menuFactory")],r.prototype,"menuFactory",void 0),fi([Ee("beans")],r.prototype,"beans",void 0),fi([Nr("frameworkComponentWrapper")],r.prototype,"frameworkComponentWrapper",void 0),r}(a0),s0=function(){function h(){}return h.getHeaderClassesFromColDef=function(r,t,n,c){return g(r)?[]:this.getColumnClassesFromCollDef(r.headerClass,r,t,n,c)},h.getToolPanelClassesFromColDef=function(r,t,n,c){return g(r)?[]:this.getColumnClassesFromCollDef(r.toolPanelClass,r,t,n,c)},h.getColumnClassesFromCollDef=function(r,t,n,c,f){return g(r)?[]:"string"==typeof(y="function"==typeof r?r({colDef:t,column:c,columnGroup:f,context:n.getContext(),api:n.getApi()}):r)?[y]:Array.isArray(y)?y:[];var y},h}(),s2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),wd=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Mv=function(h){function r(t,n,c,f,y){var T=h.call(this)||this;return T.pinned=t,T.column=n,T.eResize=c,T.comp=f,T.ctrl=y,T}return s2(r,h),r.prototype.postConstruct=function(){var f,y,t=this,n=this.column.getColDef(),c=[],B=function(){c.forEach(function(Se){return Se()}),c.length=0},q=function(){var Se=t.column.isResizable(),ke=!t.gridOptionsWrapper.isSuppressAutoSize()&&!n.suppressAutoSize;(Se!==f||ke!==y)&&(f=Se,y=ke,B(),function(){if(Nn(t.eResize,f),f){var Se=t.horizontalResizeService.addResizeBar({eResizeBar:t.eResize,onResizeStart:t.onResizeStart.bind(t),onResizing:t.onResizing.bind(t,!1),onResizeEnd:t.onResizing.bind(t,!0)});if(c.push(Se),y){var ke=t.gridOptionsWrapper.isSkipHeaderOnAutoSize(),je=function(){t.columnModel.autoSizeColumn(t.column,ke,"uiColumnResized")};t.eResize.addEventListener("dblclick",je);var Qe=new No(t.eResize);Qe.addEventListener(No.EVENT_DOUBLE_TAP,je),t.addDestroyFunc(function(){t.eResize.removeEventListener("dblclick",je),Qe.removeEventListener(No.EVENT_DOUBLE_TAP,je),Qe.destroy()})}}}())};q(),this.addDestroyFunc(B),this.ctrl.addRefreshFunction(q)},r.prototype.onResizing=function(t,n){var c=this.normaliseResizeAmount(n);this.columnModel.setColumnWidths([{key:this.column,newWidth:this.resizeStartWidth+c}],this.resizeWithShiftKey,t,"uiColumnDragged"),t&&this.comp.addOrRemoveCssClass("ag-column-resizing",!1)},r.prototype.onResizeStart=function(t){this.resizeStartWidth=this.column.getActualWidth(),this.resizeWithShiftKey=t,this.comp.addOrRemoveCssClass("ag-column-resizing",!0)},r.prototype.normaliseResizeAmount=function(t){var n=t,c=this.pinned!==W.PINNED_LEFT,f=this.pinned===W.PINNED_RIGHT;return this.gridOptionsWrapper.isEnableRtl()?c&&(n*=-1):f&&(n*=-1),n},wd([Ee("horizontalResizeService")],r.prototype,"horizontalResizeService",void 0),wd([Ee("columnModel")],r.prototype,"columnModel",void 0),wd([zt],r.prototype,"postConstruct",null),r}(ct),l2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),dl=function(h){function r(t,n,c){void 0===n&&(n="ag-checkbox"),void 0===c&&(c="checkbox");var f=h.call(this,t,n,c)||this;return f.labelAlignment="right",f.selected=!1,f.readOnly=!1,f.passive=!1,f}return l2(r,h),r.prototype.addInputListeners=function(){this.addManagedListener(this.eInput,"click",this.onCheckboxClick.bind(this)),this.addManagedListener(this.eLabel,"click",this.toggle.bind(this))},r.prototype.getNextValue=function(){return void 0===this.selected||!this.selected},r.prototype.setPassive=function(t){this.passive=t},r.prototype.isReadOnly=function(){return this.readOnly},r.prototype.setReadOnly=function(t){Fr(this.eWrapper,"ag-disabled",t),this.eInput.disabled=t,this.readOnly=t},r.prototype.setDisabled=function(t){return Fr(this.eWrapper,"ag-disabled",t),h.prototype.setDisabled.call(this,t)},r.prototype.toggle=function(){if(!this.eInput.disabled){var t=this.isSelected(),n=this.getNextValue();this.passive?this.dispatchChange(n,t):this.setValue(n)}},r.prototype.getValue=function(){return this.isSelected()},r.prototype.setValue=function(t,n){return this.refreshSelectedClass(t),this.setSelected(t,n),this},r.prototype.setName=function(t){return this.getInputElement().name=t,this},r.prototype.isSelected=function(){return this.selected},r.prototype.setSelected=function(t,n){this.isSelected()!==t&&(this.previousValue=this.isSelected(),t=this.selected="boolean"==typeof t?t:void 0,this.eInput.checked=t,this.eInput.indeterminate=void 0===t,n||this.dispatchChange(this.selected,this.previousValue))},r.prototype.dispatchChange=function(t,n,c){this.dispatchEvent({type:r.EVENT_CHANGED,selected:t,previousValue:n,event:c});var f=this.getInputElement();this.eventService.dispatchEvent({type:Ge.EVENT_CHECKBOX_CHANGED,id:f.id,name:f.name,selected:t,previousValue:n})},r.prototype.onCheckboxClick=function(t){if(!this.passive&&!this.eInput.disabled){var n=this.isSelected(),c=this.selected=t.target.checked;this.refreshSelectedClass(c),this.dispatchChange(c,n,t)}},r.prototype.refreshSelectedClass=function(t){Fr(this.eWrapper,"ag-checked",!0===t),Fr(this.eWrapper,"ag-indeterminate",null==t)},r}(Fa),u2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),l0=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},c2=function(h){function r(t){var n=h.call(this)||this;n.cbSelectAllVisible=!1,n.processingEventFromCheckbox=!1,n.column=t;var c=t.getColDef();return n.filteredOnly=!!c&&!!c.headerCheckboxSelectionFilteredOnly,n}return u2(r,h),r.prototype.onSpaceKeyPressed=function(t){var n=this.cbSelectAll;n.isDisplayed()&&!n.getGui().contains(document.activeElement)&&(t.preventDefault(),n.setValue(!n.getValue()))},r.prototype.getCheckboxGui=function(){return this.cbSelectAll.getGui()},r.prototype.setComp=function(t){this.comp=t,this.cbSelectAll=this.createManagedBean(new dl),this.cbSelectAll.addCssClass("ag-header-select-all"),co(this.cbSelectAll.getGui(),"presentation"),this.showOrHideSelectAll(),this.addManagedListener(this.eventService,Ge.EVENT_NEW_COLUMNS_LOADED,this.showOrHideSelectAll.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_DISPLAYED_COLUMNS_CHANGED,this.showOrHideSelectAll.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_SELECTION_CHANGED,this.onSelectionChanged.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_MODEL_UPDATED,this.onModelChanged.bind(this)),this.addManagedListener(this.cbSelectAll,dl.EVENT_CHANGED,this.onCbSelectAll.bind(this)),this.cbSelectAll.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()},r.prototype.showOrHideSelectAll=function(){this.cbSelectAllVisible=this.isCheckboxSelection(),this.cbSelectAll.setDisplayed(this.cbSelectAllVisible),this.cbSelectAllVisible&&(this.checkRightRowModelType(),this.updateStateOfCheckbox()),this.refreshHeaderAriaDescribedBy(this.cbSelectAllVisible)},r.prototype.refreshHeaderAriaDescribedBy=function(t){var n=t?this.cbSelectAll.getInputElement().id:void 0;this.comp.setAriaDescribedBy(n)},r.prototype.onModelChanged=function(){!this.cbSelectAllVisible||this.updateStateOfCheckbox()},r.prototype.onSelectionChanged=function(){!this.cbSelectAllVisible||this.updateStateOfCheckbox()},r.prototype.getNextCheckboxState=function(t){return(0!==t.selected||0!==t.notSelected)&&(t.selected>0&&t.notSelected>0?null:t.selected>0)},r.prototype.updateStateOfCheckbox=function(){if(!this.processingEventFromCheckbox){this.processingEventFromCheckbox=!0;var t=this.getSelectionCount(),n=this.getNextCheckboxState(t);this.cbSelectAll.setValue(n),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}},r.prototype.refreshSelectAllLabel=function(){var t=this.gridOptionsWrapper.getLocaleTextFunc(),c=this.cbSelectAll.getValue()?t("ariaChecked","checked"):t("ariaUnchecked","unchecked"),f=t("ariaRowSelectAll","Press Space to toggle all rows selection");this.cbSelectAll.setInputAriaLabel(f+" ("+c+")")},r.prototype.getSelectionCount=function(){var t=this,n=0,c=0,f=function(T){t.gridOptionsWrapper.isGroupSelectsChildren()&&T.group||(T.isSelected()?n++:T.selectable&&c++)};return this.filteredOnly?this.gridApi.forEachNodeAfterFilter(f):this.gridApi.forEachNode(f),{notSelected:c,selected:n}},r.prototype.checkRightRowModelType=function(){var t=this.rowModel.getType();t===W.ROW_MODEL_TYPE_CLIENT_SIDE||console.warn("AG Grid: selectAllCheckbox is only available if using normal row model, you are using "+t)},r.prototype.onCbSelectAll=function(){!this.processingEventFromCheckbox&&this.cbSelectAllVisible&&(this.cbSelectAll.getValue()?this.selectionService.selectAllRowNodes(this.filteredOnly):this.selectionService.deselectAllRowNodes(this.filteredOnly))},r.prototype.isCheckboxSelection=function(){var t=this.column.getColDef().headerCheckboxSelection;return"function"==typeof t&&(t=t({column:this.column,colDef:this.column.getColDef(),columnApi:this.columnApi,api:this.gridApi})),!(!t||(this.gridOptionsWrapper.isRowModelServerSide()?(console.warn("headerCheckboxSelection is not supported for Server Side Row Model"),1):this.gridOptionsWrapper.isRowModelInfinite()?(console.warn("headerCheckboxSelection is not supported for Infinite Row Model"),1):this.gridOptionsWrapper.isRowModelViewport()&&(console.warn("headerCheckboxSelection is not supported for Viewport Row Model"),1)))},l0([Ee("gridApi")],r.prototype,"gridApi",void 0),l0([Ee("columnApi")],r.prototype,"columnApi",void 0),l0([Ee("rowModel")],r.prototype,"rowModel",void 0),l0([Ee("selectionService")],r.prototype,"selectionService",void 0),r}(ct),f2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Va=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Tc=function(h){function r(t,n){var c=h.call(this,t,n)||this;return c.refreshFunctions=[],c.userHeaderClasses=new Set,c.column=t,c}return f2(r,h),r.prototype.setComp=function(t,n,c){var f=this;h.prototype.setGui.call(this,n),this.comp=t,this.colDefVersion=this.columnModel.getColDefVersion(),this.updateState(),this.setupWidth(),this.setupMovingCss(),this.setupMenuClass(),this.setupSortableClass(),this.addColumnHoverListener(),this.setupFilterCss(),this.setupColId(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(),this.setupSelectAll(),this.setupUserComp(),this.createManagedBean(new Mv(this.getPinned(),this.column,c,t,this)),this.createManagedBean(new Mc([this.column],n)),this.createManagedBean(new Ps(this.column,n,this.beans)),this.createManagedBean(new Qo(n,{shouldStopEventPropagation:function(T){return f.shouldStopEventPropagation(T)},onTabKeyDown:function(){return null},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedListener(this.eventService,Ge.EVENT_NEW_COLUMNS_LOADED,this.onNewColumnsLoaded.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_VALUE_CHANGED,this.onColumnValueChanged.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_ROW_GROUP_CHANGED,this.onColumnRowGroupChanged.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_PIVOT_CHANGED,this.onColumnPivotChanged.bind(this))},r.prototype.setupUserComp=function(){var t=this.lookupUserCompDetails();this.setCompDetails(t)},r.prototype.setCompDetails=function(t){this.userCompDetails=t,this.comp.setUserCompDetails(t)},r.prototype.lookupUserCompDetails=function(){var t=this.createParams(),n=this.column.getColDef();return this.userComponentFactory.getHeaderCompDetails(n,t)},r.prototype.createParams=function(){var t=this,n=this.column.getColDef();return{column:this.column,displayName:this.displayName,enableSorting:n.sortable,enableMenu:this.menuEnabled,showColumnMenu:function(y){t.gridApi.showColumnMenuAfterButtonClick(t.column,y)},progressSort:function(y){t.sortController.progressSort(t.column,!!y,"uiColumnSorted")},setSort:function(y,T){t.sortController.setSortForColumn(t.column,y,!!T,"uiColumnSorted")},api:this.gridApi,columnApi:this.columnApi,context:this.gridOptionsWrapper.getContext(),eGridHeader:this.getGui()}},r.prototype.setupSelectAll=function(){this.selectAllFeature=this.createManagedBean(new c2(this.column)),this.selectAllFeature.setComp(this.comp)},r.prototype.getSelectAllGui=function(){return this.selectAllFeature.getCheckboxGui()},r.prototype.handleKeyDown=function(t){t.keyCode===Yt.SPACE&&this.selectAllFeature.onSpaceKeyPressed(t),t.keyCode===Yt.ENTER&&this.onEnterKeyPressed(t)},r.prototype.onEnterKeyPressed=function(t){var n=this.comp.getUserCompInstance();n&&(t.ctrlKey||t.metaKey?this.menuEnabled&&n.showMenu&&(t.preventDefault(),n.showMenu()):this.sortable&&this.sortController.progressSort(this.column,t.shiftKey,"uiColumnSorted"))},r.prototype.isMenuEnabled=function(){return this.menuEnabled},r.prototype.onFocusIn=function(t){if(!this.getGui().contains(t.relatedTarget)){var n=this.getRowIndex();this.focusService.setFocusedHeader(n,this.column)}this.setActiveHeader(!0)},r.prototype.onFocusOut=function(t){this.getGui().contains(t.relatedTarget)||this.setActiveHeader(!1)},r.prototype.setupTooltip=function(){var t=this,c=this.createManagedBean(new cv({getColumn:function(){return t.column},getColDef:function(){return t.column.getColDef()},getGui:function(){return t.eGui},getLocation:function(){return"header"},getTooltipValue:function(){return t.column.getColDef().headerTooltip}},this.beans));c.setComp(this.comp),this.refreshFunctions.push(function(){return c.refreshToolTip()})},r.prototype.setupClassesFromColDef=function(){var t=this,n=function(){var f=t.column.getColDef(),T=s0.getHeaderClassesFromColDef(f,t.gridOptionsWrapper,t.column,null),B=t.userHeaderClasses;t.userHeaderClasses=new Set(T),T.forEach(function(q){B.has(q)?B.delete(q):t.comp.addOrRemoveCssClass(q,!0)}),B.forEach(function(q){return t.comp.addOrRemoveCssClass(q,!1)})};this.refreshFunctions.push(n),n()},r.prototype.getGui=function(){return this.eGui},r.prototype.setDragSource=function(t){var n=this;this.dragSourceElement=t,this.removeDragSource(),t&&(!this.draggable||(this.moveDragSource={type:e.rvo.HeaderCell,eElement:t,defaultIconName:ao.ICON_HIDE,getDragItem:function(){return n.createDragItem()},dragItemName:this.displayName,onDragStarted:function(){return n.column.setMoving(!0,"uiColumnMoved")},onDragStopped:function(){return n.column.setMoving(!1,"uiColumnMoved")}},this.dragAndDropService.addDragSource(this.moveDragSource,!0)))},r.prototype.createDragItem=function(){var t={};return t[this.column.getId()]=this.column.isVisible(),{columns:[this.column],visibleState:t}},r.prototype.removeDragSource=function(){this.moveDragSource&&(this.dragAndDropService.removeDragSource(this.moveDragSource),this.moveDragSource=void 0)},r.prototype.onNewColumnsLoaded=function(){var t=this.columnModel.getColDefVersion();t!=this.colDefVersion&&(this.colDefVersion=t,this.refresh())},r.prototype.updateState=function(){var t=this.column.getColDef();this.menuEnabled=this.menuFactory.isMenuEnabled(this.column)&&!t.suppressMenu,this.sortable=t.sortable,this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()},r.prototype.addRefreshFunction=function(t){this.refreshFunctions.push(t)},r.prototype.refresh=function(){this.updateState(),this.refreshHeaderComp(),this.refreshFunctions.forEach(function(t){return t()})},r.prototype.refreshHeaderComp=function(){var t=this.lookupUserCompDetails();null!=this.comp.getUserCompInstance()&&this.userCompDetails.componentClass==t.componentClass&&this.attemptHeaderCompRefresh(t.params)?this.setDragSource(this.dragSourceElement):this.setCompDetails(t)},r.prototype.attemptHeaderCompRefresh=function(t){var n=this.comp.getUserCompInstance();return!(!n||!n.refresh)&&n.refresh(t)},r.prototype.calculateDisplayName=function(){return this.columnModel.getDisplayNameForColumn(this.column,"header",!0)},r.prototype.checkDisplayName=function(){this.displayName!==this.calculateDisplayName()&&this.refresh()},r.prototype.workOutDraggable=function(){var t=this.column.getColDef();return!(this.gridOptionsWrapper.isSuppressMovableColumns()||t.suppressMovable||t.lockPosition)||!!t.enableRowGroup||!!t.enablePivot},r.prototype.onColumnRowGroupChanged=function(){this.checkDisplayName()},r.prototype.onColumnPivotChanged=function(){this.checkDisplayName()},r.prototype.onColumnValueChanged=function(){this.checkDisplayName()},r.prototype.setupWidth=function(){var t=this,n=function(){t.comp.setWidth(t.column.getActualWidth()+"px")};this.addManagedListener(this.column,it.EVENT_WIDTH_CHANGED,n),n()},r.prototype.setupMovingCss=function(){var t=this,n=function(){t.comp.addOrRemoveCssClass("ag-header-cell-moving",t.column.isMoving())};this.addManagedListener(this.column,it.EVENT_MOVING_CHANGED,n),n()},r.prototype.setupMenuClass=function(){var t=this,n=function(){t.comp.addOrRemoveCssClass("ag-column-menu-visible",t.column.isMenuVisible())};this.addManagedListener(this.column,it.EVENT_MENU_VISIBLE_CHANGED,n),n()},r.prototype.setupSortableClass=function(){var t=this,n=function(){t.comp.addOrRemoveCssClass("ag-header-cell-sortable",!!t.sortable)},c=function(){t.comp.setAriaSort(t.sortable?Sp(t.column):void 0)};n(),c(),this.addRefreshFunction(n),this.addRefreshFunction(c),this.addManagedListener(this.column,it.EVENT_SORT_CHANGED,c)},r.prototype.addColumnHoverListener=function(){var t=this,n=function(){if(t.gridOptionsWrapper.isColumnHoverHighlight()){var f=t.columnHoverService.isHovered(t.column);t.comp.addOrRemoveCssClass("ag-column-hover",f)}};this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_HOVER_CHANGED,n),n()},r.prototype.setupFilterCss=function(){var t=this,n=function(){t.comp.addOrRemoveCssClass("ag-header-cell-filtered",t.column.isFilterActive())};this.addManagedListener(this.column,it.EVENT_FILTER_ACTIVE_CHANGED,n),n()},r.prototype.setupColId=function(){this.comp.setColId(this.column.getColId())},r.prototype.addActiveHeaderMouseListeners=function(){var t=this,n=function(f){return t.setActiveHeader("mouseenter"===f.type)};this.addManagedListener(this.getGui(),"mouseenter",n),this.addManagedListener(this.getGui(),"mouseleave",n)},r.prototype.setActiveHeader=function(t){this.comp.addOrRemoveCssClass("ag-header-active",t)},Va([Ee("columnModel")],r.prototype,"columnModel",void 0),Va([Ee("columnHoverService")],r.prototype,"columnHoverService",void 0),Va([Ee("beans")],r.prototype,"beans",void 0),Va([Ee("sortController")],r.prototype,"sortController",void 0),Va([Ee("menuFactory")],r.prototype,"menuFactory",void 0),Va([Ee("dragAndDropService")],r.prototype,"dragAndDropService",void 0),Va([Ee("gridApi")],r.prototype,"gridApi",void 0),Va([Ee("columnApi")],r.prototype,"columnApi",void 0),Va([Ee("userComponentFactory")],r.prototype,"userComponentFactory",void 0),Va([Ln],r.prototype,"removeDragSource",null),r}(a0),d2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),_d=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},t5=function(h){function r(t,n,c,f){var y=h.call(this)||this;return y.eResize=n,y.comp=t,y.pinned=c,y.columnGroup=f,y}return d2(r,h),r.prototype.postConstruct=function(){var t=this;if(this.columnGroup.isResizable()){var n=this.horizontalResizeService.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});if(this.addDestroyFunc(n),!this.gridOptionsWrapper.isSuppressAutoSize()){var c=this.gridOptionsWrapper.isSkipHeaderOnAutoSize();this.eResize.addEventListener("dblclick",function(f){var y=[];t.columnGroup.getDisplayedLeafColumns().forEach(function(T){T.getColDef().suppressAutoSize||y.push(T.getColId())}),y.length>0&&t.columnModel.autoSizeColumns(y,c,"uiColumnResized")})}}else this.comp.addOrRemoveResizableCssClass("ag-hidden",!0)},r.prototype.onResizeStart=function(t){var n=this,c=this.columnGroup.getDisplayedLeafColumns();this.resizeCols=c.filter(function(T){return T.isResizable()}),this.resizeStartWidth=0,this.resizeCols.forEach(function(T){return n.resizeStartWidth+=T.getActualWidth()}),this.resizeRatios=[],this.resizeCols.forEach(function(T){return n.resizeRatios.push(T.getActualWidth()/n.resizeStartWidth)});var f=null;if(t&&(f=this.columnModel.getDisplayedGroupAfter(this.columnGroup)),f){var y=f.getDisplayedLeafColumns();this.resizeTakeFromCols=y.filter(function(T){return T.isResizable()}),this.resizeTakeFromStartWidth=0,this.resizeTakeFromCols.forEach(function(T){return n.resizeTakeFromStartWidth+=T.getActualWidth()}),this.resizeTakeFromRatios=[],this.resizeTakeFromCols.forEach(function(T){return n.resizeTakeFromRatios.push(T.getActualWidth()/n.resizeTakeFromStartWidth)})}else this.resizeTakeFromCols=null,this.resizeTakeFromStartWidth=null,this.resizeTakeFromRatios=null;this.comp.addOrRemoveCssClass("ag-column-resizing",!0)},r.prototype.onResizing=function(t,n){var c=[],f=this.normaliseDragChange(n);c.push({columns:this.resizeCols,ratios:this.resizeRatios,width:this.resizeStartWidth+f}),this.resizeTakeFromCols&&c.push({columns:this.resizeTakeFromCols,ratios:this.resizeTakeFromRatios,width:this.resizeTakeFromStartWidth-f}),this.columnModel.resizeColumnSets(c,t,"uiColumnDragged"),t&&this.comp.addOrRemoveCssClass("ag-column-resizing",!1)},r.prototype.normaliseDragChange=function(t){var n=t;return this.gridOptionsWrapper.isEnableRtl()?this.pinned!==W.PINNED_LEFT&&(n*=-1):this.pinned===W.PINNED_RIGHT&&(n*=-1),n},_d([Ee("horizontalResizeService")],r.prototype,"horizontalResizeService",void 0),_d([Ee("columnModel")],r.prototype,"columnModel",void 0),_d([zt],r.prototype,"postConstruct",null),r}(ct),Sd=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),p2=function(h){function r(t,n){var c=h.call(this)||this;return c.removeChildListenersFuncs=[],c.columnGroup=n,c.comp=t,c}return Sd(r,h),r.prototype.postConstruct=function(){this.addListenersToChildrenColumns(),this.addManagedListener(this.columnGroup,xt.EVENT_DISPLAYED_CHILDREN_CHANGED,this.onDisplayedChildrenChanged.bind(this)),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))},r.prototype.addListenersToChildrenColumns=function(){var t=this;this.removeListenersOnChildrenColumns();var n=this.onWidthChanged.bind(this);this.columnGroup.getLeafColumns().forEach(function(c){c.addEventListener(it.EVENT_WIDTH_CHANGED,n),c.addEventListener(it.EVENT_VISIBLE_CHANGED,n),t.removeChildListenersFuncs.push(function(){c.removeEventListener(it.EVENT_WIDTH_CHANGED,n),c.removeEventListener(it.EVENT_VISIBLE_CHANGED,n)})})},r.prototype.removeListenersOnChildrenColumns=function(){this.removeChildListenersFuncs.forEach(function(t){return t()}),this.removeChildListenersFuncs=[]},r.prototype.onDisplayedChildrenChanged=function(){this.addListenersToChildrenColumns(),this.onWidthChanged()},r.prototype.onWidthChanged=function(){this.comp.setWidth(this.columnGroup.getActualWidth()+"px")},function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);c>3&&f&&Object.defineProperty(r,t,f)}([zt],r.prototype,"postConstruct",null),r}(ct),eu=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),tu=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Tv=function(h){function r(t,n){var c=h.call(this,t,n)||this;return c.columnGroup=t,c}return eu(r,h),r.prototype.setComp=function(t,n,c){h.prototype.setGui.call(this,n),this.comp=t,this.displayName=this.columnModel.getDisplayNameForColumnGroup(this.columnGroup,"header"),this.addClasses(),this.addAttributes(),this.setupMovingCss(),this.setupExpandable(),this.setupTooltip(),this.setupUserComp();var f=this.getParentRowCtrl().getPinned(),y=this.columnGroup.getOriginalColumnGroup().getLeafColumns();this.createManagedBean(new Mc(y,n)),this.createManagedBean(new Ps(this.columnGroup,n,this.beans)),this.createManagedBean(new t5(t,c,f,this.columnGroup)),this.createManagedBean(new p2(t,this.columnGroup)),this.createManagedBean(new Qo(n,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:function(){},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))},r.prototype.setupUserComp=function(){var t=this,n=this.displayName,c={displayName:this.displayName,columnGroup:this.columnGroup,setExpanded:function(de){t.columnModel.setColumnGroupOpened(t.columnGroup.getOriginalColumnGroup(),de,"gridInitializing")},api:this.gridApi,columnApi:this.columnApi,context:this.gridOptionsWrapper.getContext()};if(!n){for(var f=this.columnGroup,y=f.getLeafColumns();f.getParent()&&f.getParent().getLeafColumns().length===y.length;)f=f.getParent();var T=f.getColGroupDef();T&&(n=T.headerName),n||(n=y?this.columnModel.getDisplayNameForColumn(y[0],"header",!0):"")}var B=this.userComponentFactory.getHeaderGroupCompDetails(c);this.comp.setUserCompDetails(B)},r.prototype.setupTooltip=function(){var t=this,n=this.columnGroup.getColGroupDef(),c={getColumn:function(){return t.columnGroup},getGui:function(){return t.eGui},getLocation:function(){return"headerGroup"},getTooltipValue:function(){return n&&n.headerTooltip}};n&&(c.getColDef=function(){return n}),this.createManagedBean(new cv(c,this.beans)).setComp(this.comp)},r.prototype.setupExpandable=function(){var t=this.columnGroup.getOriginalColumnGroup();this.refreshExpanded(),this.addManagedListener(t,kt.EVENT_EXPANDABLE_CHANGED,this.refreshExpanded.bind(this)),this.addManagedListener(t,kt.EVENT_EXPANDED_CHANGED,this.refreshExpanded.bind(this))},r.prototype.refreshExpanded=function(){var t=this.columnGroup;this.expandable=t.isExpandable();var n=t.isExpanded();this.comp.setAriaExpanded(this.expandable?n?"true":"false":void 0)},r.prototype.addAttributes=function(){this.comp.setColId(this.columnGroup.getUniqueId())},r.prototype.addClasses=function(){var t=this,n=this.columnGroup.getColGroupDef(),c=s0.getHeaderClassesFromColDef(n,this.gridOptionsWrapper,null,this.columnGroup);c.push(this.columnGroup.isPadding()?"ag-header-group-cell-no-group":"ag-header-group-cell-with-group"),c.forEach(function(f){return t.comp.addOrRemoveCssClass(f,!0)})},r.prototype.setupMovingCss=function(){var t=this,c=this.columnGroup.getOriginalColumnGroup().getLeafColumns(),f=function(){return t.comp.addOrRemoveCssClass("ag-header-cell-moving",t.columnGroup.isMoving())};c.forEach(function(y){t.addManagedListener(y,it.EVENT_MOVING_CHANGED,f)}),f()},r.prototype.onFocusIn=function(t){if(!this.eGui.contains(t.relatedTarget)){var n=this.getRowIndex();this.beans.focusService.setFocusedHeader(n,this.columnGroup)}},r.prototype.handleKeyDown=function(t){var n=document.activeElement;if(this.expandable&&n===this.eGui&&t.keyCode===Yt.ENTER){var f=this.columnGroup,y=!f.isExpanded();this.columnModel.setColumnGroupOpened(f.getOriginalColumnGroup(),y,"uiColumnExpanded")}},r.prototype.setDragSource=function(t){var n=this;if(!this.isSuppressMoving()){var c=this.columnGroup.getOriginalColumnGroup().getLeafColumns(),f={type:e.rvo.HeaderCell,eElement:t,defaultIconName:ao.ICON_HIDE,dragItemName:this.displayName,getDragItem:this.getDragItemForGroup.bind(this),onDragStarted:function(){return c.forEach(function(T){return T.setMoving(!0,"uiColumnDragged")})},onDragStopped:function(){return c.forEach(function(T){return T.setMoving(!1,"uiColumnDragged")})}};this.dragAndDropService.addDragSource(f,!0),this.addDestroyFunc(function(){return n.dragAndDropService.removeDragSource(f)})}},r.prototype.getDragItemForGroup=function(){var t=this.columnGroup.getOriginalColumnGroup().getLeafColumns(),n={};t.forEach(function(f){return n[f.getId()]=f.isVisible()});var c=[];return this.columnModel.getAllDisplayedColumns().forEach(function(f){t.indexOf(f)>=0&&(c.push(f),k(t,f))}),t.forEach(function(f){return c.push(f)}),{columns:c,visibleState:n}},r.prototype.isSuppressMoving=function(){var t=!1;return this.columnGroup.getLeafColumns().forEach(function(c){(c.getColDef().suppressMovable||c.getColDef().lockPosition)&&(t=!0)}),t||this.gridOptionsWrapper.isSuppressMovableColumns()},tu([Ee("beans")],r.prototype,"beans",void 0),tu([Ee("columnModel")],r.prototype,"columnModel",void 0),tu([Ee("dragAndDropService")],r.prototype,"dragAndDropService",void 0),tu([Ee("userComponentFactory")],r.prototype,"userComponentFactory",void 0),tu([Ee("gridApi")],r.prototype,"gridApi",void 0),tu([Ee("columnApi")],r.prototype,"columnApi",void 0),r}(a0),v2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ev=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},g2=0,u0=function(h){function r(t,n,c){var f=h.call(this)||this;return f.instanceId=g2++,f.headerCellCtrls={},f.rowIndex=t,f.pinned=n,f.type=c,f}return v2(r,h),r.prototype.getInstanceId=function(){return this.instanceId},r.prototype.setComp=function(t){this.comp=t,this.onRowHeightChanged(),this.onVirtualColumnsChanged(),this.setWidth(),this.addEventListeners(),Du()&&this.comp.setTransform("translateZ(0)"),t.setAriaRowIndex(this.rowIndex+1)},r.prototype.addEventListeners=function(){this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_RESIZED,this.onColumnResized.bind(this)),this.addManagedListener(this.gridOptionsWrapper,vr.PROP_DOM_LAYOUT,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_VIRTUAL_COLUMNS_CHANGED,this.onVirtualColumnsChanged.bind(this)),this.addManagedListener(this.gridOptionsWrapper,vr.PROP_HEADER_HEIGHT,this.onRowHeightChanged.bind(this)),this.addManagedListener(this.gridOptionsWrapper,vr.PROP_PIVOT_HEADER_HEIGHT,this.onRowHeightChanged.bind(this)),this.addManagedListener(this.gridOptionsWrapper,vr.PROP_GROUP_HEADER_HEIGHT,this.onRowHeightChanged.bind(this)),this.addManagedListener(this.gridOptionsWrapper,vr.PROP_PIVOT_GROUP_HEADER_HEIGHT,this.onRowHeightChanged.bind(this)),this.addManagedListener(this.gridOptionsWrapper,vr.PROP_FLOATING_FILTERS_HEIGHT,this.onRowHeightChanged.bind(this))},r.prototype.getHtmlElementForColumnHeader=function(t){if(this.type==e.A6C.COLUMN){var n=O(this.headerCellCtrls,function(f){return f.getColumnGroupChild()==t});if(n)return n.getGui()}},r.prototype.onDisplayedColumnsChanged=function(){this.onVirtualColumnsChanged(),this.setWidth()},r.prototype.getType=function(){return this.type},r.prototype.onColumnResized=function(){this.setWidth()},r.prototype.setWidth=function(){var t=this.getWidthForRow();this.comp.setWidth(t+"px")},r.prototype.getWidthForRow=function(){return this.gridOptionsWrapper.getDomLayout()===W.DOM_LAYOUT_PRINT?null!=this.pinned?0:this.columnModel.getContainerWidth(W.PINNED_RIGHT)+this.columnModel.getContainerWidth(W.PINNED_LEFT)+this.columnModel.getContainerWidth(null):this.columnModel.getContainerWidth(this.pinned)},r.prototype.onRowHeightChanged=function(){var f,y,t=this.columnModel.getHeaderRowCount(),n=[],c=0;this.columnModel.isPivotMode()?(f=this.gridOptionsWrapper.getPivotGroupHeaderHeight(),y=this.gridOptionsWrapper.getPivotHeaderHeight()):(this.columnModel.hasFloatingFilters()&&(t++,c=1),f=this.gridOptionsWrapper.getGroupHeaderHeight(),y=this.gridOptionsWrapper.getHeaderHeight());for(var B=t-(1+c),q=0;q<B;q++)n.push(f);for(n.push(y),q=0;q<c;q++)n.push(this.gridOptionsWrapper.getFloatingFiltersHeight());var de=0;for(q=0;q<this.rowIndex;q++)de+=n[q];this.comp.setTop(de+"px"),this.comp.setHeight(n[this.rowIndex]+"px")},r.prototype.getPinned=function(){return this.pinned},r.prototype.getRowIndex=function(){return this.rowIndex},r.prototype.onVirtualColumnsChanged=function(){var t=this,n=this.headerCellCtrls;this.headerCellCtrls={},this.getColumnsInViewport().forEach(function(T){if(!T.isEmptyGroup()){var B=T.getUniqueId(),q=n[B];if(delete n[B],q&&q.getColumnGroupChild()!=T&&(t.destroyBean(q),q=void 0),null==q)switch(t.type){case e.A6C.FLOATING_FILTER:q=t.createBean(new $l(T,t));break;case e.A6C.COLUMN_GROUP:q=t.createBean(new Tv(T,t));break;default:q=t.createBean(new Tc(T,t))}t.headerCellCtrls[B]=q}}),ce(n,function(T,B){var q=function(B){return!!t.focusService.isHeaderWrapperFocused(B)&&t.columnModel.isDisplayed(B.getColumnGroupChild())}(B);q?t.headerCellCtrls[T]=B:t.destroyBean(B)});var y=$e(this.headerCellCtrls);this.comp.setHeaderCtrls(y)},r.prototype.getColumnsInViewport=function(){return this.gridOptionsWrapper.getDomLayout()===W.DOM_LAYOUT_PRINT?this.getColumnsInViewportPrintLayout():this.getColumnsInViewportNormalLayout()},r.prototype.getColumnsInViewportPrintLayout=function(){var t=this;if(null!=this.pinned)return[];var n=[],c=this.getActualDepth();return[W.PINNED_LEFT,null,W.PINNED_RIGHT].forEach(function(f){var y=t.columnModel.getVirtualHeaderGroupRow(f,c);n=n.concat(y)}),n},r.prototype.getActualDepth=function(){return this.type==e.A6C.FLOATING_FILTER?this.rowIndex-1:this.rowIndex},r.prototype.getColumnsInViewportNormalLayout=function(){return this.columnModel.getVirtualHeaderGroupRow(this.pinned,this.getActualDepth())},r.prototype.focusHeader=function(t,n){var f=O($e(this.headerCellCtrls),function(y){return y.getColumnGroupChild()==t});return!!f&&(f.focus(n),!0)},Ev([Ee("columnModel")],r.prototype,"columnModel",void 0),Ev([Ee("focusService")],r.prototype,"focusService",void 0),r}(ct),m2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),c0=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Rv=function(h){function r(t){var n=h.call(this)||this;return n.groupsRowCtrls=[],n.pinned=t,n}return m2(r,h),r.prototype.setComp=function(t,n){this.comp=t,this.setupCenterWidth(),this.setupPinnedWidth(),this.setupDragAndDrop(n),this.addManagedListener(this.eventService,Ge.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.ctrlsService.registerHeaderContainer(this,this.pinned),this.columnModel.isReady()&&this.refresh()},r.prototype.setupDragAndDrop=function(t){var n=new Cd(this.pinned,t);this.createManagedBean(n)},r.prototype.refresh=function(t){var n=this;void 0===t&&(t=!1);var Se,c=new $a,f=this.focusService.getFocusHeaderToUseAfterRefresh();(function(){var Se=n.columnModel.getHeaderRowCount()-1;n.groupsRowCtrls=n.destroyBeans(n.groupsRowCtrls);for(var ke=0;ke<Se;ke++){var je=n.createBean(new u0(c.next(),n.pinned,e.A6C.COLUMN_GROUP));n.groupsRowCtrls.push(je)}})(),Se=c.next(),(null==n.columnsRowCtrl||!t||n.columnsRowCtrl.getRowIndex()!==Se)&&(n.destroyBean(n.columnsRowCtrl),n.columnsRowCtrl=n.createBean(new u0(Se,n.pinned,e.A6C.COLUMN))),function(){var ke=function(){n.filtersRowCtrl=n.destroyBean(n.filtersRowCtrl)};if(!n.columnModel.isPivotMode()&&n.columnModel.hasFloatingFilters()){var je=c.next();if(n.filtersRowCtrl){var Qe=n.filtersRowCtrl.getRowIndex()!==je;(!t||Qe)&&ke()}n.filtersRowCtrl||(n.filtersRowCtrl=n.createBean(new u0(je,n.pinned,e.A6C.FLOATING_FILTER)))}else ke()}();var q=this.getAllCtrls();this.comp.setCtrls(q),this.restoreFocusOnHeader(f)},r.prototype.restoreFocusOnHeader=function(t){null==t||t.column.getPinned()!=this.pinned||this.focusService.focusHeaderPosition({headerPosition:t})},r.prototype.getAllCtrls=function(){var t=function(){for(var h=0,r=0,t=arguments.length;r<t;r++)h+=arguments[r].length;var n=Array(h),c=0;for(r=0;r<t;r++)for(var f=arguments[r],y=0,T=f.length;y<T;y++,c++)n[c]=f[y];return n}(this.groupsRowCtrls,[this.columnsRowCtrl]);return this.filtersRowCtrl&&t.push(this.filtersRowCtrl),t},r.prototype.onGridColumnsChanged=function(){this.refresh(!0)},r.prototype.setupCenterWidth=function(){var t=this;null==this.pinned&&this.createManagedBean(new yd(function(n){return t.comp.setCenterWidth(n+"px")}))},r.prototype.setHorizontalScroll=function(t){this.comp.setContainerTransform("translateX("+t+"px)")},r.prototype.setupPinnedWidth=function(){var t=this;if(null!=this.pinned){var n=this.pinned===W.PINNED_LEFT,c=this.pinned===W.PINNED_RIGHT,f=function(){var T=n?t.pinnedWidthService.getPinnedLeftWidth():t.pinnedWidthService.getPinnedRightWidth();if(null!=T){var B=0==T,q=t.gridOptionsWrapper.isEnableRtl(),de=t.gridOptionsWrapper.getScrollbarWidth(),Se=t.scrollVisibleService.isVerticalScrollShowing()&&(q&&n||!q&&c);t.comp.setPinnedContainerWidth((Se?T+de:T)+"px"),t.comp.addOrRemoveCssClass("ag-hidden",B)}};this.addManagedListener(this.eventService,Ge.EVENT_LEFT_PINNED_WIDTH_CHANGED,f),this.addManagedListener(this.eventService,Ge.EVENT_RIGHT_PINNED_WIDTH_CHANGED,f),this.addManagedListener(this.eventService,Ge.EVENT_SCROLL_VISIBILITY_CHANGED,f),this.addManagedListener(this.eventService,Ge.EVENT_SCROLLBAR_WIDTH_CHANGED,f)}},r.prototype.getHtmlElementForColumnHeader=function(t){if(this.columnsRowCtrl)return this.columnsRowCtrl.getHtmlElementForColumnHeader(t)},r.prototype.getRowType=function(t){var c=this.getAllCtrls()[t];return c?c.getType():void 0},r.prototype.focusHeader=function(t,n,c){var y=this.getAllCtrls()[t];return!!y&&y.focusHeader(n,c)},r.prototype.getRowCount=function(){return this.getAllCtrls().length},c0([Ee("ctrlsService")],r.prototype,"ctrlsService",void 0),c0([Ee("scrollVisibleService")],r.prototype,"scrollVisibleService",void 0),c0([Ee("pinnedWidthService")],r.prototype,"pinnedWidthService",void 0),c0([Ee("columnModel")],r.prototype,"columnModel",void 0),c0([Ee("focusService")],r.prototype,"focusService",void 0),r}(ct),Dv=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),xd=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Ec=function(h){function r(t){var n=h.call(this)||this;return n.headerRowComps={},n.rowCompsList=[],n.pinned=t,n}return Dv(r,h),r.prototype.init=function(){var t=this;this.selectAndSetTemplate();var n={addOrRemoveCssClass:function(y,T){return t.addOrRemoveCssClass(y,T)},setCtrls:function(y){return t.setCtrls(y)},setCenterWidth:function(y){return t.eCenterContainer.style.width=y},setContainerTransform:function(y){return t.eCenterContainer.style.transform=y},setPinnedContainerWidth:function(y){var T=t.getGui();T.style.width=y,T.style.maxWidth=y,T.style.minWidth=y}};this.createManagedBean(new Rv(this.pinned)).setComp(n,this.getGui())},r.prototype.selectAndSetTemplate=function(){this.setTemplate(this.pinned==W.PINNED_LEFT?r.PINNED_LEFT_TEMPLATE:this.pinned==W.PINNED_RIGHT?r.PINNED_RIGHT_TEMPLATE:r.CENTER_TEMPLATE),this.eRowContainer=this.eCenterContainer?this.eCenterContainer:this.getGui()},r.prototype.destroyRowComps=function(){this.setCtrls([])},r.prototype.destroyRowComp=function(t){this.destroyBean(t),this.eRowContainer.removeChild(t.getGui())},r.prototype.setCtrls=function(t){var f,n=this,c=this.headerRowComps;this.headerRowComps={},this.rowCompsList=[],t.forEach(function(T){var B=T.getInstanceId(),q=c[B];delete c[B];var de=q||n.createBean(new yv(T));n.headerRowComps[B]=de,n.rowCompsList.push(de),function(B){var q=B.getGui();q.parentElement!=n.eRowContainer&&n.eRowContainer.appendChild(q),f&&Qa(n.eRowContainer,q,f),f=q}(de)}),$e(c).forEach(function(T){return n.destroyRowComp(T)})},r.PINNED_LEFT_TEMPLATE='<div class="ag-pinned-left-header" role="presentation"/>',r.PINNED_RIGHT_TEMPLATE='<div class="ag-pinned-right-header" role="presentation"/>',r.CENTER_TEMPLATE='<div class="ag-header-viewport" role="presentation">\n            <div class="ag-header-container" ref="eCenterContainer" role="rowgroup"></div>\n        </div>',xd([Bt("eCenterContainer")],r.prototype,"eCenterContainer",void 0),xd([zt],r.prototype,"init",null),xd([Ln],r.prototype,"destroyRowComps",null),r}(dn),C2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),da=function(h){function r(){return h.call(this,r.TEMPLATE)||this}return C2(r,h),r.prototype.postConstruct=function(){var t=this,n={addOrRemoveCssClass:function(T,B){return t.addOrRemoveCssClass(T,B)},setHeightAndMinHeight:function(T){t.getGui().style.height=T,t.getGui().style.minHeight=T}};this.createManagedBean(new wv).setComp(n,this.getGui(),this.getFocusableElement());var f=function(T){t.createManagedBean(T),t.appendChild(T)};f(new Ec(W.PINNED_LEFT)),f(new Ec(null)),f(new Ec(W.PINNED_RIGHT))},r.TEMPLATE='<div class="ag-header" role="presentation" unselectable="on"/>',function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);c>3&&f&&Object.defineProperty(r,t,f)}([zt],r.prototype,"postConstruct",null),r}(dn),r5=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),bd=function(){return bd=Object.assign||function(h){for(var r,t=1,n=arguments.length;t<n;t++)for(var c in r=arguments[t])Object.prototype.hasOwnProperty.call(r,c)&&(h[c]=r[c]);return h},bd.apply(this,arguments)},ea=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},w2=function(h){function r(){var n=null!==h&&h.apply(this,arguments)||this;return n.allAdvancedFilters=new Map,n.activeAdvancedFilters=[],n.quickFilter=null,n.quickFilterParts=null,n.processingFilterChange=!1,n}var t;return r5(r,h),t=r,r.prototype.init=function(){this.addManagedListener(this.eventService,Ge.EVENT_ROW_DATA_CHANGED,this.onNewRowsLoaded.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_NEW_COLUMNS_LOADED,this.onNewColumnsLoaded.bind(this)),this.quickFilter=this.parseQuickFilter(this.gridOptionsWrapper.getQuickFilterText()),this.setQuickFilterParts(),this.allowShowChangeAfterFilter=this.gridOptionsWrapper.isAllowShowChangeAfterFilter()},r.prototype.setQuickFilterParts=function(){this.quickFilterParts=this.quickFilter?this.quickFilter.split(" "):null},r.prototype.setFilterModel=function(n){var c=this,f=[],y=this.getFilterModel();if(n){var T=jf(Object.keys(n));this.allAdvancedFilters.forEach(function(B,q){f.push(c.setModelOnFilterWrapper(B.filterPromise,n[q])),T.delete(q)}),T.forEach(function(B){var q=c.columnModel.getPrimaryColumn(B);if(q)if(q.isFilterAllowed()){var de=c.getOrCreateFilterWrapper(q,"NO_UI");f.push(c.setModelOnFilterWrapper(de.filterPromise,n[B]))}else console.warn("AG-Grid: setFilterModel() - unable to fully apply model, filtering disabled for colId: "+B);else console.warn("AG-Grid: setFilterModel() - no column found for colId: "+B)})}else this.allAdvancedFilters.forEach(function(B){f.push(c.setModelOnFilterWrapper(B.filterPromise,null))});Di.all(f).then(function(){var B=c.getFilterModel(),q=[];c.allAdvancedFilters.forEach(function(de,Se){wr.jsonEquals(y?y[Se]:null,B?B[Se]:null)||q.push(de.column)}),q.length>0&&c.onFilterChanged({columns:q})})},r.prototype.setModelOnFilterWrapper=function(n,c){return new Di(function(f){n.then(function(y){"function"!=typeof y.setModel&&(console.warn("Warning ag-grid - filter missing setModel method, which is needed for setFilterModel"),f()),(y.setModel(c)||Di.resolve()).then(function(){return f()})})})},r.prototype.getFilterModel=function(){var n={};return this.allAdvancedFilters.forEach(function(c,f){var T=c.filterPromise.resolveNow(null,function(q){return q});if(null==T)return null;if("function"==typeof T.getModel){var B=T.getModel();v(B)&&(n[f]=B)}else console.warn("Warning ag-grid - filter API missing getModel method, which is needed for getFilterModel")}),n},r.prototype.isAdvancedFilterPresent=function(){return this.activeAdvancedFilters.length>0},r.prototype.updateActiveFilters=function(){var n=this;this.activeAdvancedFilters.length=0;var c=function(y){return!!y&&(y.isFilterActive?y.isFilterActive():(console.warn("AG Grid: Filter is missing isFilterActive() method"),!1))};this.allAdvancedFilters.forEach(function(f){if(f.filterPromise.resolveNow(!1,c)){var y=f.filterPromise.resolveNow(null,function(T){return T});n.activeAdvancedFilters.push(y)}})},r.prototype.updateFilterFlagInColumns=function(n,c){this.allAdvancedFilters.forEach(function(f){var y=f.filterPromise.resolveNow(!1,function(T){return T.isFilterActive()});f.column.setFilterActive(y,n,c)})},r.prototype.isAnyFilterPresent=function(){return this.isQuickFilterPresent()||this.isAdvancedFilterPresent()||this.gridOptionsWrapper.isExternalFilterPresent()},r.prototype.doAdvancedFiltersPass=function(n,c){for(var f=n.data,y=0;y<this.activeAdvancedFilters.length;y++){var T=this.activeAdvancedFilters[y];if(null!=T&&T!==c){if("function"!=typeof T.doesFilterPass)throw new Error("Filter is missing method doesFilterPass");if(!T.doesFilterPass({node:n,data:f}))return!1}}return!0},r.prototype.parseQuickFilter=function(n){return v(n)?this.gridOptionsWrapper.isRowModelDefault()?n.toUpperCase():(console.warn("ag-grid: quick filtering only works with the Client-Side Row Model"),null):null},r.prototype.setQuickFilter=function(n){var c=this.parseQuickFilter(n);this.quickFilter!==c&&(this.quickFilter=c,this.setQuickFilterParts(),this.onFilterChanged())},r.prototype.onFilterChanged=function(n){void 0===n&&(n={});var c=n.filterInstance,f=n.additionalEventAttributes,y=n.columns;this.updateActiveFilters(),this.updateFilterFlagInColumns("filterChanged",f),this.allAdvancedFilters.forEach(function(B){!B.filterPromise||B.filterPromise.then(function(q){q&&q!==c&&q.onAnyFilterChanged&&q.onAnyFilterChanged()})});var T={type:Ge.EVENT_FILTER_CHANGED,api:this.gridApi,columnApi:this.columnApi,columns:y||[]};f&&pt(T,f),this.processingFilterChange=!0,this.eventService.dispatchEvent(T),this.processingFilterChange=!1},r.prototype.isSuppressFlashingCellsBecauseFiltering=function(){return!this.allowShowChangeAfterFilter&&this.processingFilterChange},r.prototype.isQuickFilterPresent=function(){return null!==this.quickFilter},r.prototype.doesRowPassOtherFilters=function(n,c){return this.doesRowPassFilter({rowNode:c,filterInstanceToSkip:n})},r.prototype.doesRowPassQuickFilterNoCache=function(n,c){var f=this;return Z(this.columnModel.getAllColumnsForQuickFilter(),function(T){var B=f.getQuickFilterTextForColumn(T,n);return v(B)&&B.indexOf(c)>=0})},r.prototype.doesRowPassQuickFilterCache=function(n,c){return n.quickFilterAggregateText||this.aggregateRowForQuickFilter(n),n.quickFilterAggregateText.indexOf(c)>=0},r.prototype.doesRowPassQuickFilter=function(n){var c=this,f=this.gridOptionsWrapper.isCacheQuickFilter();return Y(this.quickFilterParts,function(y){return f?c.doesRowPassQuickFilterCache(n,y):c.doesRowPassQuickFilterNoCache(n,y)})},r.prototype.doesRowPassFilter=function(n){return!(this.isQuickFilterPresent()&&!this.doesRowPassQuickFilter(n.rowNode)||this.gridOptionsWrapper.isExternalFilterPresent()&&!this.gridOptionsWrapper.doesExternalFilterPass(n.rowNode)||this.isAdvancedFilterPresent()&&!this.doAdvancedFiltersPass(n.rowNode,n.filterInstanceToSkip))},r.prototype.getQuickFilterTextForColumn=function(n,c){var f=this.valueService.getValue(n,c,!0),y=n.getColDef();if(y.getQuickFilterText){var T={value:f,node:c,data:c.data,column:n,colDef:y,context:this.gridOptionsWrapper.getContext()};f=y.getQuickFilterText(T)}return v(f)?f.toString().toUpperCase():null},r.prototype.aggregateRowForQuickFilter=function(n){var c=this,f=[];se(this.columnModel.getAllColumnsForQuickFilter(),function(T){var B=c.getQuickFilterTextForColumn(T,n);v(B)&&f.push(B)}),n.quickFilterAggregateText=f.join(t.QUICK_FILTER_SEPARATOR)},r.prototype.onNewRowsLoaded=function(n){this.allAdvancedFilters.forEach(function(c){c.filterPromise.then(function(f){f.onNewRowsLoaded&&f.onNewRowsLoaded()})}),this.updateFilterFlagInColumns(n),this.updateActiveFilters()},r.prototype.createValueGetter=function(n){var c=this;return function(f){return c.valueService.getValue(n,f,!0)}},r.prototype.getFilterComponent=function(n,c,f){if(void 0===f&&(f=!0),f)return this.getOrCreateFilterWrapper(n,c).filterPromise;var y=this.cachedFilter(n);return y?y.filterPromise:null},r.prototype.isFilterActive=function(n){var c=this.cachedFilter(n);return!!c&&c.filterPromise.resolveNow(!1,function(f){return f.isFilterActive()})},r.prototype.getOrCreateFilterWrapper=function(n,c){var f=this.cachedFilter(n);return f?"NO_UI"!==c&&this.putIntoGui(f,c):(f=this.createFilterWrapper(n,c),this.allAdvancedFilters.set(n.getColId(),f)),f},r.prototype.cachedFilter=function(n){return this.allAdvancedFilters.get(n.getColId())},r.prototype.createFilterInstance=function(n,c){var B,f=this,y=ne.isRegistered(e.GXE.SetFilterModule)?"agSetColumnFilter":"agTextColumnFilter",T=n.getColDef(),q=bd(bd({},this.createFilterParams(n,T,c)),{filterModifiedCallback:function(){f.eventService.dispatchEvent({type:Ge.EVENT_FILTER_MODIFIED,api:f.gridApi,columnApi:f.columnApi,column:n,filterInstance:B})},filterChangedCallback:function(je){return f.onFilterChanged({filterInstance:B,additionalEventAttributes:je,columns:[n]})},doesRowPassOtherFilter:function(je){return f.doesRowPassOtherFilters(B,je)}}),de=this.userComponentFactory.getFilterDetails(T,q,y);if(!de)return null;var Se=de.newAgStackInstance();return Se&&Se.then(function(ke){return B=ke}),Se},r.prototype.createFilterParams=function(n,c,f){void 0===f&&(f=null);var y={api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi(),column:n,colDef:Te(c),rowModel:this.rowModel,filterChangedCallback:function(){},filterModifiedCallback:function(){},valueGetter:this.createValueGetter(n),context:this.gridOptionsWrapper.getContext(),doesRowPassOtherFilter:function(){return!0}};return f&&(y.$scope=f),y},r.prototype.createFilterWrapper=function(n,c){var f={column:n,filterPromise:null,scope:null,compiledElement:null,guiPromise:Di.resolve(null)};return f.scope=this.gridOptionsWrapper.isAngularCompileFilters()?this.$scope.$new():null,f.filterPromise=this.createFilterInstance(n,f.scope),f.filterPromise&&this.putIntoGui(f,c),f},r.prototype.putIntoGui=function(n,c){var f=this,y=document.createElement("div");y.className="ag-filter",n.guiPromise=new Di(function(T){n.filterPromise.then(function(B){var q=B.getGui();if(v(q)||console.warn("getGui method from filter returned "+q+", it should be a DOM element or an HTML template string."),"string"==typeof q&&(q=ua(q)),y.appendChild(q),n.scope){var de=f.$compile(y)(n.scope);n.compiledElement=de,window.setTimeout(function(){return n.scope.$apply()},0)}T(y),f.eventService.dispatchEvent({type:Ge.EVENT_FILTER_OPENED,column:n.column,source:c,eGui:y,api:f.gridApi,columnApi:f.columnApi})})})},r.prototype.onNewColumnsLoaded=function(){var n=this,c=!1,f=[];this.allAdvancedFilters.forEach(function(y){!n.columnModel.getPrimaryColumn(y.column)&&(c=!0,f.push(y.column),n.disposeFilterWrapper(y,"filterDestroyed"))}),c&&this.onFilterChanged({columns:f})},r.prototype.destroyFilter=function(n,c){void 0===c&&(c="api");var f=this.allAdvancedFilters.get(n.getColId());f&&(this.disposeFilterWrapper(f,c),this.onFilterChanged({columns:[n]}))},r.prototype.disposeFilterWrapper=function(n,c){var f=this;n.filterPromise.then(function(y){(y.setModel(null)||Di.resolve()).then(function(){f.getContext().destroyBean(y),n.column.setFilterActive(!1,c),n.scope&&(n.compiledElement&&n.compiledElement.remove(),n.scope.$destroy()),f.allAdvancedFilters.delete(n.column.getColId())})})},r.prototype.destroy=function(){var n=this;h.prototype.destroy.call(this),this.allAdvancedFilters.forEach(function(c){return n.disposeFilterWrapper(c,"filterDestroyed")})},r.QUICK_FILTER_SEPARATOR="\n",ea([Ee("$compile")],r.prototype,"$compile",void 0),ea([Ee("$scope")],r.prototype,"$scope",void 0),ea([Ee("valueService")],r.prototype,"valueService",void 0),ea([Ee("columnModel")],r.prototype,"columnModel",void 0),ea([Ee("rowModel")],r.prototype,"rowModel",void 0),ea([Ee("columnApi")],r.prototype,"columnApi",void 0),ea([Ee("gridApi")],r.prototype,"gridApi",void 0),ea([Ee("userComponentFactory")],r.prototype,"userComponentFactory",void 0),ea([zt],r.prototype,"init",null),ea([Ln],r.prototype,"destroy",null),t=ea([Kt("filterManager")],r)}(ct),ko=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),hl=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Rc=function(h){function r(){var t=null!==h&&h.apply(this,arguments)||this;return t.initialised=!1,t}return ko(r,h),r.prototype.init=function(){this.cellExpressions=this.gridOptionsWrapper.isEnableCellExpressions(),this.initialised=!0},r.prototype.getValue=function(t,n,c,f){if(void 0===c&&(c=!1),void 0===f&&(f=!1),this.initialised||this.init(),n){var de,y=t.getColDef(),T=y.field,B=t.getId(),q=n.data,Se=n.groupData&&void 0!==n.groupData[B],ke=!f&&n.aggData&&void 0!==n.aggData[B];if(c&&y.filterValueGetter?de=this.executeFilterValueGetter(y.filterValueGetter,q,t,n):this.gridOptionsWrapper.isTreeData()&&ke?de=n.aggData[B]:this.gridOptionsWrapper.isTreeData()&&y.valueGetter?de=this.executeValueGetter(y.valueGetter,q,t,n):this.gridOptionsWrapper.isTreeData()&&T&&q?de=ot(q,T,t.isFieldContainsDots()):Se?de=n.groupData[B]:ke?de=n.aggData[B]:y.valueGetter?de=this.executeValueGetter(y.valueGetter,q,t,n):T&&q&&(de=ot(q,T,t.isFieldContainsDots())),this.cellExpressions&&"string"==typeof de&&0===de.indexOf("=")){var je=de.substring(1);de=this.executeValueGetter(je,q,t,n)}if(null==de){var Qe=this.getOpenedGroup(n,t);if(null!=Qe)return Qe}return de}},r.prototype.getOpenedGroup=function(t,n){if(this.gridOptionsWrapper.isShowOpenedGroup()&&n.getColDef().showRowGroup)for(var f=n.getColDef().showRowGroup,y=t.parent;null!=y;){if(y.rowGroupColumn&&(!0===f||f===y.rowGroupColumn.getId()))return y.key;y=y.parent}},r.prototype.setValue=function(t,n,c,f){var y=this.columnModel.getPrimaryColumn(n);if(t&&y){g(t.data)&&(t.data={});var T=y.getColDef(),B=T.field,q=T.newValueHandler,de=T.valueSetter;if(g(B)&&g(q)&&g(de))return void console.warn("AG Grid: you need either field or valueSetter set on colDef for editing to work");var ke,Se={node:t,data:t.data,oldValue:this.getValue(y,t),newValue:c,colDef:y.getColDef(),column:y,api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi(),context:this.gridOptionsWrapper.getContext()};if(Se.newValue=c,void 0===(ke=q&&v(q)?q(Se):v(de)?this.expressionService.evaluate(de,Se):this.setValueUsingField(t.data,B,c,y.isFieldContainsDots()))&&(ke=!0),ke){t.resetQuickFilterAggregateText(),this.valueCache.onDataChanged(),Se.newValue=this.getValue(y,t);var je=y.getColDef().onCellValueChanged;"function"==typeof je&&setTimeout(function(){return je(Se)},0),this.eventService.dispatchEvent({type:Ge.EVENT_CELL_VALUE_CHANGED,event:null,rowIndex:t.rowIndex,rowPinned:t.rowPinned,column:Se.column,api:Se.api,columnApi:Se.columnApi,colDef:Se.colDef,context:Se.context,data:t.data,node:t,oldValue:Se.oldValue,newValue:Se.newValue,value:Se.newValue,source:f})}}},r.prototype.setValueUsingField=function(t,n,c,f){if(!n)return!1;if(f)for(var T=n.split("."),B=t;T.length>0&&B;){var q=T.shift();0===T.length?B[q]=c:B=B[q]}else t[n]=c;return!0},r.prototype.executeFilterValueGetter=function(t,n,c,f){var y={data:n,node:f,column:c,colDef:c.getColDef(),api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi(),context:this.gridOptionsWrapper.getContext(),getValue:this.getValueCallback.bind(this,f)};return this.expressionService.evaluate(t,y)},r.prototype.executeValueGetter=function(t,n,c,f){var y=c.getId(),T=this.valueCache.getValue(f,y);if(void 0!==T)return T;var B={data:n,node:f,column:c,colDef:c.getColDef(),api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi(),context:this.gridOptionsWrapper.getContext(),getValue:this.getValueCallback.bind(this,f)},q=this.expressionService.evaluate(t,B);return this.valueCache.setValue(f,y,q),q},r.prototype.getValueCallback=function(t,n){var c=this.columnModel.getPrimaryColumn(n);return c?this.getValue(c,t):null},r.prototype.getKeyForNode=function(t,n){var c=this.getValue(t,n),f=t.getColDef().keyCreator,y=c;return f&&(y=f({value:c,colDef:t.getColDef(),column:t,node:n,data:n.data,api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi(),context:this.gridOptionsWrapper.getContext()})),"string"==typeof y||null==y||"[object Object]"===(y=String(y))&&Lt(function(){console.warn("AG Grid: a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (se AG Grid docs) or b) to toString() on the object to return a key")},"getKeyForNode - warn about [object,object]"),y},hl([Ee("expressionService")],r.prototype,"expressionService",void 0),hl([Ee("columnModel")],r.prototype,"columnModel",void 0),hl([Ee("valueCache")],r.prototype,"valueCache",void 0),hl([zt],r.prototype,"init",null),hl([Kt("valueService")],r)}(ct),_2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ad=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f};!function(h){h.AUTO_HEIGHT="ag-layout-auto-height",h.NORMAL="ag-layout-normal",h.PRINT="ag-layout-print"}(e.LBn||(e.LBn={}));var pl=function(h){function r(t){var n=h.call(this)||this;return n.view=t,n}return _2(r,h),r.prototype.postConstruct=function(){this.addManagedListener(this.gridOptionsWrapper,vr.PROP_DOM_LAYOUT,this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()},r.prototype.updateLayoutClasses=function(){var t=this.gridOptionsWrapper.getDomLayout(),n={autoHeight:t===W.DOM_LAYOUT_AUTO_HEIGHT,normal:t===W.DOM_LAYOUT_NORMAL,print:t===W.DOM_LAYOUT_PRINT};this.view.updateLayoutClasses(n.autoHeight?e.LBn.AUTO_HEIGHT:n.print?e.LBn.PRINT:e.LBn.NORMAL,n)},Ad([Ee("gridOptionsWrapper")],r.prototype,"gridOptionsWrapper",void 0),Ad([zt],r.prototype,"postConstruct",null),r}(ct),Ov=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),ha=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Md=function(h){function r(t){var n=h.call(this)||this;return n.scrollLeft=-1,n.nextScrollTop=-1,n.scrollTop=-1,n.eBodyViewport=t,n.resetLastHorizontalScrollElementDebounced=Sr(n.resetLastHorizontalScrollElement.bind(n),500),n}return Ov(r,h),r.prototype.postConstruct=function(){var t=this;this.enableRtl=this.gridOptionsWrapper.isEnableRtl(),this.addManagedListener(this.eventService,Ge.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this)),this.ctrlsService.whenReady(function(n){t.centerRowContainerCon=n.centerRowContainerCtrl,t.onDisplayedColumnsWidthChanged(),t.addScrollListener()})},r.prototype.addScrollListener=function(){var t=this.ctrlsService.getFakeHScrollCtrl();this.addManagedListener(this.centerRowContainerCon.getViewportElement(),"scroll",this.onCenterViewportScroll.bind(this)),this.addManagedListener(t.getViewport(),"scroll",this.onFakeHorizontalScroll.bind(this));var n=this.gridOptionsWrapper.isDebounceVerticalScrollbar()?Sr(this.onVerticalScroll.bind(this),100):this.onVerticalScroll.bind(this);this.addManagedListener(this.eBodyViewport,"scroll",n)},r.prototype.onDisplayedColumnsWidthChanged=function(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()},r.prototype.horizontallyScrollHeaderCenterAndFloatingCenter=function(t){void 0===t&&(t=this.centerRowContainerCon.getCenterViewportScrollLeft());var n=this.enableRtl?t:-t,c=this.ctrlsService.getTopCenterRowContainerCtrl(),f=this.ctrlsService.getBottomCenterRowContainerCtrl(),y=this.ctrlsService.getFakeHScrollCtrl();this.ctrlsService.getHeaderRowContainerCtrl().setHorizontalScroll(n),f.setContainerTranslateX(n),c.setContainerTranslateX(n),Fu(this.lastHorizontalScrollElement===this.centerRowContainerCon.getViewportElement()?y.getViewport():this.centerRowContainerCon.getViewportElement(),Math.abs(t),this.enableRtl)},r.prototype.isControllingScroll=function(t){return this.lastHorizontalScrollElement?t===this.lastHorizontalScrollElement:(this.lastHorizontalScrollElement=t,!0)},r.prototype.onFakeHorizontalScroll=function(){var t=this.ctrlsService.getFakeHScrollCtrl().getViewport();!this.isControllingScroll(t)||this.onBodyHorizontalScroll(t)},r.prototype.onCenterViewportScroll=function(){var t=this.centerRowContainerCon.getViewportElement();!this.isControllingScroll(t)||this.onBodyHorizontalScroll(t)},r.prototype.onBodyHorizontalScroll=function(t){var n=this.centerRowContainerCon.getViewportElement();this.shouldBlockScrollUpdate("horizontal",n.scrollLeft,!0)||(this.doHorizontalScroll(Math.round(Pu(t,this.enableRtl))),this.resetLastHorizontalScrollElementDebounced())},r.prototype.onVerticalScroll=function(){var t=this.eBodyViewport.scrollTop;this.shouldBlockScrollUpdate("vertical",t,!0)||(this.animationFrameService.setScrollTop(t),this.nextScrollTop=t,this.gridOptionsWrapper.isSuppressAnimationFrame()?(this.scrollTop=this.nextScrollTop,this.redrawRowsAfterScroll()):this.animationFrameService.schedule())},r.prototype.resetLastHorizontalScrollElement=function(){this.lastHorizontalScrollElement=null},r.prototype.doHorizontalScroll=function(t){var c=Pu(this.ctrlsService.getFakeHScrollCtrl().getViewport(),this.enableRtl);this.scrollLeft===t&&t===c||(this.scrollLeft=t,this.fireScrollEvent("horizontal"),this.horizontallyScrollHeaderCenterAndFloatingCenter(t),this.onHorizontalViewportChanged())},r.prototype.fireScrollEvent=function(t){var n=this,c={type:Ge.EVENT_BODY_SCROLL,api:this.gridApi,columnApi:this.columnApi,direction:t,left:this.scrollLeft,top:this.scrollTop};this.eventService.dispatchEvent(c),window.clearTimeout(this.scrollTimer),this.scrollTimer=void 0,this.scrollTimer=window.setTimeout(function(){var f=ut({},c,{type:Ge.EVENT_BODY_SCROLL_END});n.eventService.dispatchEvent(f)},100)},r.prototype.shouldBlockScrollUpdate=function(t,n,c){if(void 0===c&&(c=!1),c&&!bs())return!1;if("vertical"===t){var f=Dl(this.eBodyViewport);if(n<0||n+f>this.eBodyViewport.scrollHeight)return!0}if("horizontal"===t){var T=this.centerRowContainerCon.getCenterWidth(),B=this.centerRowContainerCon.getViewportElement().scrollWidth;if(this.enableRtl&&Ei()){if(n>0)return!0}else if(n<0)return!0;if(Math.abs(n)+T>B)return!0}return!1},r.prototype.redrawRowsAfterScroll=function(){this.fireScrollEvent("vertical")},r.prototype.onHorizontalViewportChanged=function(){this.centerRowContainerCon.onHorizontalViewportChanged()},r.prototype.checkScrollLeft=function(){this.scrollLeft!==this.centerRowContainerCon.getCenterViewportScrollLeft()&&this.onBodyHorizontalScroll(this.centerRowContainerCon.getViewportElement())},r.prototype.executeAnimationFrameScroll=function(){var t=this.scrollTop!=this.nextScrollTop;return t&&(this.scrollTop=this.nextScrollTop,this.redrawRowsAfterScroll()),t},r.prototype.setHorizontalScrollPosition=function(t){var c=this.centerRowContainerCon.getViewportElement().scrollWidth-this.centerRowContainerCon.getCenterWidth();this.shouldBlockScrollUpdate("horizontal",t)&&(t=this.enableRtl&&Ei()?t>0?0:c:Math.min(Math.max(t,0),c)),Fu(this.centerRowContainerCon.getViewportElement(),Math.abs(t),this.enableRtl),this.doHorizontalScroll(t)},r.prototype.setVerticalScrollPosition=function(t){this.eBodyViewport.scrollTop=t},r.prototype.getVScrollPosition=function(){return{top:this.eBodyViewport.scrollTop,bottom:this.eBodyViewport.scrollTop+this.eBodyViewport.offsetHeight}},r.prototype.getHScrollPosition=function(){return this.centerRowContainerCon.getHScrollPosition()},r.prototype.isHorizontalScrollShowing=function(){return this.centerRowContainerCon.isHorizontalScrollShowing()},r.prototype.scrollHorizontally=function(t){var n=this.centerRowContainerCon.getViewportElement().scrollLeft;return this.setHorizontalScrollPosition(n+t),this.centerRowContainerCon.getViewportElement().scrollLeft-n},r.prototype.scrollToTop=function(){this.eBodyViewport.scrollTop=0},r.prototype.ensureNodeVisible=function(t,n){void 0===n&&(n=null);for(var c=this.rowModel.getRowCount(),f="function"==typeof t,y=-1,T=0;T<c;T++){var B=this.rowModel.getRow(T);if(f){if(t(B)){y=T;break}}else if(t===B||t===B.data){y=T;break}}y>=0&&this.ensureIndexVisible(y,n)},r.prototype.ensureIndexVisible=function(t,n){if(this.gridOptionsWrapper.getDomLayout()!==W.DOM_LAYOUT_PRINT){var c=this.paginationProxy.getRowCount();if("number"!=typeof t||t<0||t>=c)return void console.warn("invalid row index for ensureIndexVisible: "+t);this.gridOptionsWrapper.isPagination()&&!this.gridOptionsWrapper.isSuppressPaginationPanel()||this.paginationProxy.goToPageWithIndex(t);var B,T=this.paginationProxy.getRow(t);do{var q=T.rowTop,de=T.rowHeight,Se=this.paginationProxy.getPixelOffset(),ke=T.rowTop-Se,je=ke+T.rowHeight,Qe=this.getVScrollPosition(),rt=this.heightScaler.getDivStretchOffset(),_t=Qe.top+rt,Vt=Qe.bottom+rt,Ut=Vt-_t,Rt=this.heightScaler.getScrollPositionForPixel(ke),qt=this.heightScaler.getScrollPositionForPixel(je-Ut),It=Math.min((Rt+qt)/2,ke),gn=null;"top"===n?gn=Rt:"bottom"===n?gn=qt:"middle"===n?gn=It:_t>ke?gn=Rt:Vt<je&&(gn=qt),null!==gn&&(this.eBodyViewport.scrollTop=gn,this.rowRenderer.redrawAfterScroll()),B=q!==T.rowTop||de!==T.rowHeight}while(B);this.animationFrameService.flushAllFrames()}},r.prototype.ensureColumnVisible=function(t){var n=this.columnModel.getGridColumn(t);if(n&&!n.isPinned()&&this.columnModel.isColumnDisplayed(n)){var q,de,c=n.getLeft(),f=c+n.getActualWidth(),y=this.centerRowContainerCon.getCenterWidth(),T=this.centerRowContainerCon.getCenterViewportScrollLeft(),B=this.columnModel.getBodyContainerWidth();this.enableRtl?(q=B-T-y,de=B-T):(q=T,de=y+T);var Se=q>c,ke=de<f,je=y<n.getActualWidth(),Qe=Se||je;(Qe||ke)&&this.centerRowContainerCon.setCenterViewportScrollLeft(this.enableRtl?Qe?B-y-c:B-f:Qe?c:f-y),this.centerRowContainerCon.onHorizontalViewportChanged(),this.animationFrameService.flushAllFrames()}},ha([Ee("ctrlsService")],r.prototype,"ctrlsService",void 0),ha([Ee("animationFrameService")],r.prototype,"animationFrameService",void 0),ha([Ee("columnApi")],r.prototype,"columnApi",void 0),ha([Ee("gridApi")],r.prototype,"gridApi",void 0),ha([Ee("paginationProxy")],r.prototype,"paginationProxy",void 0),ha([Ee("rowModel")],r.prototype,"rowModel",void 0),ha([Ee("rowContainerHeightService")],r.prototype,"heightScaler",void 0),ha([Ee("rowRenderer")],r.prototype,"rowRenderer",void 0),ha([Ee("columnModel")],r.prototype,"columnModel",void 0),ha([zt],r.prototype,"postConstruct",null),r}(ct),Dc=function(){function h(r){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=r.scrollContainer,this.scrollHorizontally=-1!==r.scrollAxis.indexOf("x"),this.scrollVertically=-1!==r.scrollAxis.indexOf("y"),this.scrollByTick=null!=r.scrollByTick?r.scrollByTick:20,r.onScrollCallback&&(this.onScrollCallback=r.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=r.getVerticalPosition,this.setVerticalPosition=r.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=r.getHorizontalPosition,this.setHorizontalPosition=r.setHorizontalPosition),this.shouldSkipVerticalScroll=r.shouldSkipVerticalScroll||function(){return!1},this.shouldSkipHorizontalScroll=r.shouldSkipHorizontalScroll||function(){return!1}}return h.prototype.check=function(r,t){void 0===t&&(t=!1);var n=t||this.shouldSkipVerticalScroll();if(!n||!this.shouldSkipHorizontalScroll()){var c=this.scrollContainer.getBoundingClientRect(),f=this.scrollByTick;this.tickLeft=r.clientX<c.left+f,this.tickRight=r.clientX>c.right-f,this.tickUp=r.clientY<c.top+f&&!n,this.tickDown=r.clientY>c.bottom-f&&!n,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}},h.prototype.ensureTickingStarted=function(){null===this.tickingInterval&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)},h.prototype.doTick=function(){var r;if(this.tickCount++,r=this.tickCount>20?200:this.tickCount>10?80:40,this.scrollVertically){var t=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(t-r),this.tickDown&&this.setVerticalPosition(t+r)}if(this.scrollHorizontally){var n=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(n-r),this.tickRight&&this.setHorizontalPosition(n+r)}this.onScrollCallback&&this.onScrollCallback()},h.prototype.ensureCleared=function(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)},h}(),Pv=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Fv=function(){return Fv=Object.assign||function(h){for(var r,t=1,n=arguments.length;t<n;t++)for(var c in r=arguments[t])Object.prototype.hasOwnProperty.call(r,c)&&(h[c]=r[c]);return h},Fv.apply(this,arguments)},Ki=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Oc=function(){for(var h=0,r=0,t=arguments.length;r<t;r++)h+=arguments[r].length;var n=Array(h),c=0;for(r=0;r<t;r++)for(var f=arguments[r],y=0,T=f.length;y<T;y++,c++)n[c]=f[y];return n},Lv=function(h){function r(t){var n=h.call(this)||this;return n.isMultiRowDrag=!1,n.isGridSorted=!1,n.isGridFiltered=!1,n.isRowGroupActive=!1,n.eContainer=t,n}return Pv(r,h),r.prototype.postConstruct=function(){var t=this;this.gridOptionsWrapper.isRowModelDefault()&&(this.clientSideRowModel=this.rowModel);var n=function(){t.onSortChanged(),t.onFilterChanged(),t.onRowGroupChanged()};this.addManagedListener(this.eventService,Ge.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_ROW_GROUP_CHANGED,this.onRowGroupChanged.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_MODEL_UPDATED,function(){n()}),n(),this.ctrlsService.whenReady(function(){var c=t.ctrlsService.getGridBodyCtrl();t.autoScrollService=new Dc({scrollContainer:c.getBodyViewportElement(),scrollAxis:"y",getVerticalPosition:function(){return c.getScrollFeature().getVScrollPosition().top},setVerticalPosition:function(y){return c.getScrollFeature().setVerticalScrollPosition(y)},onScrollCallback:function(){t.onDragging(t.lastDraggingEvent)}})})},r.prototype.onSortChanged=function(){this.isGridSorted=this.sortController.isSortActive()},r.prototype.onFilterChanged=function(){this.isGridFiltered=this.filterManager.isAnyFilterPresent()},r.prototype.onRowGroupChanged=function(){var t=this.columnModel.getRowGroupColumns();this.isRowGroupActive=!C(t)},r.prototype.getContainer=function(){return this.eContainer},r.prototype.isInterestedIn=function(t){return t===e.rvo.RowDrag},r.prototype.getIconName=function(){return this.gridOptionsWrapper.isRowDragManaged()&&this.shouldPreventRowMove()?ao.ICON_NOT_ALLOWED:ao.ICON_MOVE},r.prototype.shouldPreventRowMove=function(){return this.isGridSorted||this.isGridFiltered||this.isRowGroupActive},r.prototype.getRowNodes=function(t){if(!this.isFromThisGrid(t))return t.dragItem.rowNodes||[];var n=this.gridOptionsWrapper.isRowDragMultiRow(),c=this.selectionService.getSelectedNodes(),f=t.dragItem.rowNode;return n&&-1!==c.indexOf(f)?(this.isMultiRowDrag=!0,Oc(c)):(this.isMultiRowDrag=!1,[f])},r.prototype.onDragEnter=function(t){this.dispatchGridEvent(Ge.EVENT_ROW_DRAG_ENTER,t),this.getRowNodes(t).forEach(function(n){n.setDragging(!0)}),this.onEnterOrDragging(t)},r.prototype.onDragging=function(t){this.onEnterOrDragging(t)},r.prototype.isFromThisGrid=function(t){return t.dragSource.dragSourceDomDataKey===this.gridOptionsWrapper.getDomDataKey()},r.prototype.isDropZoneWithinThisGrid=function(t){return!this.ctrlsService.getGridBodyCtrl().getGui().contains(t.dropZoneTarget)},r.prototype.onEnterOrDragging=function(t){this.dispatchGridEvent(Ge.EVENT_ROW_DRAG_MOVE,t),this.lastDraggingEvent=t;var n=this.mouseEventService.getNormalisedPosition(t).y;this.gridOptionsWrapper.isRowDragManaged()&&this.doManagedDrag(t,n),this.autoScrollService.check(t.event)},r.prototype.doManagedDrag=function(t,n){var f,c=this,y=this.isFromThisGrid(t);y?(f=[t.dragItem.rowNode],this.isMultiRowDrag&&(f=Oc(this.selectionService.getSelectedNodes()).sort(function(B,q){return c.getRowIndexNumber(B)-c.getRowIndexNumber(q)})),t.dragItem.rowNodes=f):f=t.dragItem.rowNodes,this.gridOptionsWrapper.isRowDragManaged()&&this.shouldPreventRowMove()||(this.gridOptionsWrapper.isSuppressMoveWhenRowDragging()||!y?this.isDropZoneWithinThisGrid(t)||this.clientSideRowModel.highlightRowAtPixel(f[0],n):this.moveRows(f,n))},r.prototype.getRowIndexNumber=function(t){return parseInt(H(t.getRowIndexString().split("-")),10)},r.prototype.moveRowAndClearHighlight=function(t){var n=this,c=this.clientSideRowModel.getLastHighlightedRowNode(),f=c&&c.highlighted===e.oh5.Below,y=this.mouseEventService.getNormalisedPosition(t).y,T=t.dragItem.rowNodes,B=f?1:0;if(this.isFromThisGrid(t))T.forEach(function(Se){Se.rowTop<y&&(B-=1)}),this.moveRows(T,y,B);else{var q=this.gridOptionsWrapper.getRowNodeIdFunc(),de=this.clientSideRowModel.getRowIndexAtPixel(y)+1;this.clientSideRowModel.getHighlightPosition(y)===e.oh5.Above&&de--,this.clientSideRowModel.updateRowData({add:T.map(function(Se){return Se.data}).filter(function(Se){return!n.clientSideRowModel.getRowNode(q?q(Se):Se.id)}),addIndex:de})}this.clearRowHighlight()},r.prototype.clearRowHighlight=function(){this.clientSideRowModel.highlightRowAtPixel(null)},r.prototype.moveRows=function(t,n,c){void 0===c&&(c=0),this.clientSideRowModel.ensureRowsAtPixel(t,n,c)&&(this.focusService.clearFocusedCell(),this.rangeService&&this.rangeService.removeAllCellRanges())},r.prototype.addRowDropZone=function(t){var n=this;if(t.getContainer())if(this.dragAndDropService.findExternalZone(t))console.warn("AG Grid: addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.");else{var c={getContainer:t.getContainer};t.fromGrid?(t.fromGrid=void 0,c=t):(t.onDragEnter&&(c.onDragEnter=function(f){t.onDragEnter(n.draggingToRowDragEvent(Ge.EVENT_ROW_DRAG_ENTER,f))}),t.onDragLeave&&(c.onDragLeave=function(f){t.onDragLeave(n.draggingToRowDragEvent(Ge.EVENT_ROW_DRAG_LEAVE,f))}),t.onDragging&&(c.onDragging=function(f){t.onDragging(n.draggingToRowDragEvent(Ge.EVENT_ROW_DRAG_MOVE,f))}),t.onDragStop&&(c.onDragStop=function(f){t.onDragStop(n.draggingToRowDragEvent(Ge.EVENT_ROW_DRAG_END,f))})),this.dragAndDropService.addDropTarget(Fv({isInterestedIn:function(y){return y===e.rvo.RowDrag},getIconName:function(){return ao.ICON_MOVE},external:!0},c))}else Lt(function(){return console.warn("AG Grid: addRowDropZone - A container target needs to be provided")},"add-drop-zone-empty-target")},r.prototype.getRowDropZone=function(t){var n=this,c=this.getContainer.bind(this),f=this.onDragEnter.bind(this),y=this.onDragLeave.bind(this),T=this.onDragging.bind(this),B=this.onDragStop.bind(this);return t?{getContainer:c,onDragEnter:t.onDragEnter?function(q){f(q),t.onDragEnter(n.draggingToRowDragEvent(Ge.EVENT_ROW_DRAG_ENTER,q))}:f,onDragLeave:t.onDragLeave?function(q){y(q),t.onDragLeave(n.draggingToRowDragEvent(Ge.EVENT_ROW_DRAG_LEAVE,q))}:y,onDragging:t.onDragging?function(q){T(q),t.onDragging(n.draggingToRowDragEvent(Ge.EVENT_ROW_DRAG_MOVE,q))}:T,onDragStop:t.onDragStop?function(q){B(q),t.onDragStop(n.draggingToRowDragEvent(Ge.EVENT_ROW_DRAG_END,q))}:B,fromGrid:!0}:{getContainer:c,onDragEnter:f,onDragLeave:y,onDragging:T,onDragStop:B,fromGrid:!0}},r.prototype.draggingToRowDragEvent=function(t,n){var T,B,c=this.mouseEventService.getNormalisedPosition(n).y,y=-1;switch(c>this.paginationProxy.getCurrentPageHeight()||(y=this.rowModel.getRowIndexAtPixel(c),T=this.rowModel.getRow(y)),n.vDirection){case e.HO_.Down:B="down";break;case e.HO_.Up:B="up";break;default:B=null}return{type:t,api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi(),event:n.event,node:n.dragItem.rowNode,nodes:n.dragItem.rowNodes,overIndex:y,overNode:T,y:c,vDirection:B}},r.prototype.dispatchGridEvent=function(t,n){var c=this.draggingToRowDragEvent(t,n);this.eventService.dispatchEvent(c)},r.prototype.onDragLeave=function(t){this.dispatchGridEvent(Ge.EVENT_ROW_DRAG_LEAVE,t),this.stopDragging(t),this.gridOptionsWrapper.isRowDragManaged()&&this.clearRowHighlight(),this.isFromThisGrid(t)&&(this.isMultiRowDrag=!1)},r.prototype.onDragStop=function(t){this.dispatchGridEvent(Ge.EVENT_ROW_DRAG_END,t),this.stopDragging(t),this.gridOptionsWrapper.isRowDragManaged()&&(this.gridOptionsWrapper.isSuppressMoveWhenRowDragging()||!this.isFromThisGrid(t))&&!this.isDropZoneWithinThisGrid(t)&&this.moveRowAndClearHighlight(t)},r.prototype.stopDragging=function(t){this.autoScrollService.ensureCleared(),this.getRowNodes(t).forEach(function(n){n.setDragging(!1)})},Ki([Ee("dragAndDropService")],r.prototype,"dragAndDropService",void 0),Ki([Ee("rowModel")],r.prototype,"rowModel",void 0),Ki([Ee("paginationProxy")],r.prototype,"paginationProxy",void 0),Ki([Ee("columnModel")],r.prototype,"columnModel",void 0),Ki([Ee("focusService")],r.prototype,"focusService",void 0),Ki([Ee("sortController")],r.prototype,"sortController",void 0),Ki([Ee("filterManager")],r.prototype,"filterManager",void 0),Ki([Ee("selectionService")],r.prototype,"selectionService",void 0),Ki([Ee("mouseEventService")],r.prototype,"mouseEventService",void 0),Ki([Ee("ctrlsService")],r.prototype,"ctrlsService",void 0),Ki([Nr("rangeService")],r.prototype,"rangeService",void 0),Ki([zt],r.prototype,"postConstruct",null),r}(ct),S2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),mo=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f};!function(h){h.ANIMATION_ON="ag-row-animation",h.ANIMATION_OFF="ag-row-no-animation"}(e.SJN||(e.SJN={}));var Nv="ag-selectable",Iv="ag-force-vertical-scroll",kv="ag-column-moving",Bv=function(h){function r(){var t=null!==h&&h.apply(this,arguments)||this;return t.angularApplyTriggered=!1,t}return S2(r,h),r.prototype.getScrollFeature=function(){return this.bodyScrollFeature},r.prototype.getBodyViewportElement=function(){return this.eBodyViewport},r.prototype.setComp=function(t,n,c,f,y){this.comp=t,this.eGridBody=n,this.eBodyViewport=c,this.eTop=f,this.eBottom=y,this.setCellTextSelection(this.gridOptionsWrapper.isEnableCellTextSelect()),this.createManagedBean(new pl(this.comp)),this.bodyScrollFeature=this.createManagedBean(new Md(this.eBodyViewport)),this.addRowDragListener(),this.setupRowAnimationCssClass(),this.ctrlsService.registerGridBodyCtrl(this),this.addEventListeners(),this.addFocusListeners([f,c,y]),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.$scope&&this.addAngularApplyCheck()},r.prototype.getComp=function(){return this.comp},r.prototype.addEventListeners=function(){this.addManagedListener(this.eventService,Ge.EVENT_GRID_COLUMNS_CHANGED,this.onGridColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_PINNED_ROW_DATA_CHANGED,this.setFloatingHeights.bind(this))},r.prototype.addFocusListeners=function(t){var n=this;t.forEach(function(c){n.addManagedListener(c,"focusin",function(){Er(c,"ag-has-focus")}),n.addManagedListener(c,"focusout",function(f){c.contains(f.relatedTarget)||zi(c,"ag-has-focus")})})},r.prototype.setColumnMovingCss=function(t){this.comp.setColumnMovingCss(t?kv:null,t)},r.prototype.setCellTextSelection=function(t){void 0===t&&(t=!1),this.comp.setCellSelectableCss(t?Nv:null,t)},r.prototype.onScrollVisibilityChanged=function(){var t=this.scrollVisibleService.isVerticalScrollShowing();this.setVerticalScrollPaddingVisible(t)},r.prototype.onGridColumnsChanged=function(){var t=this.columnModel.getAllGridColumns();this.comp.setColumnCount(t?t.length:0)},r.prototype.disableBrowserDragging=function(){this.addManagedListener(this.eGridBody,"dragstart",function(t){if(t.target instanceof HTMLImageElement)return t.preventDefault(),!1})},r.prototype.addStopEditingWhenGridLosesFocus=function(){var t=this;if(this.gridOptionsWrapper.isStopEditingWhenCellsLoseFocus()){var n=function(y){var T=y.relatedTarget;if(null!==H0(T)){var B=c.some(function(de){return de.contains(T)})&&t.mouseEventService.isElementInThisGrid(T);if(!B){var q=t.popupService;B=q.getActivePopups().some(function(de){return de.contains(T)})||q.isElementWithinCustomPopup(T)}B||t.rowRenderer.stopEditing()}else t.rowRenderer.stopEditing()},c=[this.eBodyViewport,this.eBottom,this.eTop];c.forEach(function(f){return t.addManagedListener(f,"focusout",n)})}},r.prototype.updateRowCount=function(){var t=this.headerNavigationService.getHeaderRowCount(),n=this.paginationProxy.getType(),c=-1;n===W.ROW_MODEL_TYPE_CLIENT_SIDE&&(c=0,this.paginationProxy.forEachNode(function(y){y.group||c++})),this.comp.setRowCount(-1===c?-1:t+c)},r.prototype.registerBodyViewportResizeListener=function(t){this.comp.registerBodyViewportResizeListener(t)},r.prototype.setVerticalScrollPaddingVisible=function(t){this.comp.setPinnedTopBottomOverflowY(t?"scroll":"hidden")},r.prototype.isVerticalScrollShowing=function(){var t=this.gridOptionsWrapper.isAlwaysShowVerticalScroll();return this.comp.setAlwaysVerticalScrollClass(t?Iv:null,t),t||As(this.eBodyViewport)},r.prototype.setupRowAnimationCssClass=function(){var t=this,n=function(){var f=t.gridOptionsWrapper.isAnimateRows()&&!t.rowContainerHeightService.isStretching();t.comp.setRowAnimationCssOnBodyViewport(f?e.SJN.ANIMATION_ON:e.SJN.ANIMATION_OFF,f)};n(),this.addManagedListener(this.eventService,Ge.EVENT_HEIGHT_SCALE_CHANGED,n)},r.prototype.getGridBodyElement=function(){return this.eGridBody},r.prototype.addBodyViewportListener=function(){var t=this;this.addManagedListener(this.eBodyViewport,"contextmenu",function(f){t.gridOptionsWrapper.isPreventDefaultOnContextMenu()&&f.preventDefault();var y=Ye(f);(y===t.eBodyViewport||y===t.ctrlsService.getCenterRowContainerCtrl().getViewportElement())&&t.contextMenuFactory&&t.contextMenuFactory.onContextMenu(f,null,null,null,null,t.eGridBody)}),this.addManagedListener(this.eBodyViewport,"wheel",this.onWheel.bind(this))},r.prototype.onWheel=function(t){!this.gridOptionsWrapper.isSuppressScrollWhenPopupsAreOpen()||this.popupService.hasAnchoredPopup()&&t.preventDefault()},r.prototype.getGui=function(){return this.eGridBody},r.prototype.scrollVertically=function(t){var n=this.eBodyViewport.scrollTop;return this.bodyScrollFeature.setVerticalScrollPosition(n+t),this.eBodyViewport.scrollTop-n},r.prototype.addRowDragListener=function(){this.rowDragFeature=this.createManagedBean(new Lv(this.eBodyViewport)),this.dragAndDropService.addDropTarget(this.rowDragFeature)},r.prototype.getRowDragFeature=function(){return this.rowDragFeature},r.prototype.setFloatingHeights=function(){var t=this.pinnedRowModel,n=t.getPinnedTopTotalHeight();n&&(n+=1);var c=t.getPinnedBottomTotalHeight();c&&(c+=1),this.comp.setTopHeight(n),this.comp.setBottomHeight(c),this.comp.setTopDisplay(n?"inherit":"none"),this.comp.setBottomDisplay(c?"inherit":"none")},r.prototype.sizeColumnsToFit=function(t){var n=this,f=this.isVerticalScrollShowing()&&!uo()?this.gridOptionsWrapper.getScrollbarWidth():0,T=jo(this.eBodyViewport)-f;T>0?this.columnModel.sizeColumnsToFit(T,"sizeColumnsToFit"):void 0===t?window.setTimeout(function(){n.sizeColumnsToFit(100)},0):100===t?window.setTimeout(function(){n.sizeColumnsToFit(500)},100):500===t?window.setTimeout(function(){n.sizeColumnsToFit(-1)},500):console.warn("AG Grid: tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?")},r.prototype.addScrollEventListener=function(t){this.eBodyViewport.addEventListener("scroll",t)},r.prototype.removeScrollEventListener=function(t){this.eBodyViewport.removeEventListener("scroll",t)},r.prototype.requestAngularApply=function(){var t=this;this.angularApplyTriggered||(this.angularApplyTriggered=!0,window.setTimeout(function(){t.angularApplyTriggered=!1,t.$scope.$apply()},0))},r.prototype.addAngularApplyCheck=function(){var t=this;this.addManagedListener(this.eventService,Ge.EVENT_DISPLAYED_COLUMNS_CHANGED,function(){return t.requestAngularApply()}),this.addManagedListener(this.eventService,Ge.EVENT_VIRTUAL_COLUMNS_CHANGED,function(){return t.requestAngularApply()})},mo([Ee("rowContainerHeightService")],r.prototype,"rowContainerHeightService",void 0),mo([Ee("ctrlsService")],r.prototype,"ctrlsService",void 0),mo([Ee("columnModel")],r.prototype,"columnModel",void 0),mo([Ee("scrollVisibleService")],r.prototype,"scrollVisibleService",void 0),mo([Nr("contextMenuFactory")],r.prototype,"contextMenuFactory",void 0),mo([Ee("headerNavigationService")],r.prototype,"headerNavigationService",void 0),mo([Ee("paginationProxy")],r.prototype,"paginationProxy",void 0),mo([Ee("dragAndDropService")],r.prototype,"dragAndDropService",void 0),mo([Ee("pinnedRowModel")],r.prototype,"pinnedRowModel",void 0),mo([Ee("rowRenderer")],r.prototype,"rowRenderer",void 0),mo([Ee("popupService")],r.prototype,"popupService",void 0),mo([Ee("mouseEventService")],r.prototype,"mouseEventService",void 0),mo([Ee("$scope")],r.prototype,"$scope",void 0),r}(ct),x2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Bo=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Gv=function(h){function r(t){var n=h.call(this)||this;return n.element=t,n}return x2(r,h),r.prototype.postConstruct=function(){this.addMouseListeners(),this.mockContextMenuForIPad(),this.addKeyboardEvents()},r.prototype.addKeyboardEvents=function(){var t=this;["keydown","keypress"].forEach(function(c){var f=t.processKeyboardEvent.bind(t,c);t.addManagedListener(t.element,c,f)})},r.prototype.addMouseListeners=function(){var t=this;["dblclick","contextmenu","mouseover","mouseout","click",Pr("touchstart")?"touchstart":"mousedown"].forEach(function(f){var y=t.processMouseEvent.bind(t,f);t.addManagedListener(t.element,f,y)})},r.prototype.processMouseEvent=function(t,n){if(this.mouseEventService.isEventFromThisGrid(n)&&!fr(n)){var c=this.getRowForEvent(n),f=this.mouseEventService.getRenderedCellForEvent(n);"contextmenu"===t?this.handleContextMenuMouseEvent(n,null,c,f):(f&&f.onMouseEvent(t,n),c&&c.onMouseEvent(t,n))}},r.prototype.mockContextMenuForIPad=function(){var t=this;if(bs()){var n=new No(this.element);this.addManagedListener(n,No.EVENT_LONG_TAP,function(y){var T=t.getRowForEvent(y.touchEvent),B=t.mouseEventService.getRenderedCellForEvent(y.touchEvent);t.handleContextMenuMouseEvent(null,y.touchEvent,T,B)}),this.addDestroyFunc(function(){return n.destroy()})}},r.prototype.getRowForEvent=function(t){for(var n=Ye(t);n;){var c=this.gridOptionsWrapper.getDomData(n,Os.DOM_DATA_KEY_ROW_CTRL);if(c)return c;n=n.parentElement}return null},r.prototype.handleContextMenuMouseEvent=function(t,n,c,f){var y=c?c.getRowNode():null,T=f?f.getColumn():null,B=null;T&&(f.dispatchCellContextMenuEvent(t||n),B=this.valueService.getValue(T,y));var de=this.ctrlsService.getGridBodyCtrl(),Se=f?f.getGui():de.getGridBodyElement();this.contextMenuFactory&&this.contextMenuFactory.onContextMenu(t,n,y,T,B,Se)},r.prototype.processKeyboardEvent=function(t,n){var c=wi(this.gridOptionsWrapper,n,go.DOM_DATA_KEY_CELL_CTRL),f=wi(this.gridOptionsWrapper,n,Os.DOM_DATA_KEY_ROW_CTRL);n.defaultPrevented||(c?this.processCellKeyboardEvent(c,t,n):f&&f.isFullWidth()&&this.processFullWidthRowKeyboardEvent(f,t,n))},r.prototype.processCellKeyboardEvent=function(t,n,c){var f=t.getRowNode(),y=t.getColumn(),T=t.isEditing();if(!fo(this.gridOptionsWrapper,c,f,y,T))switch(n){case"keydown":!T&&this.navigationService.handlePageScrollingKey(c)||t.onKeyDown(c),this.doGridOperations(c,t.isEditing());break;case"keypress":t.onKeyPress(c)}if("keydown"===n){var de=t.createEvent(c,Ge.EVENT_CELL_KEY_DOWN);this.eventService.dispatchEvent(de)}if("keypress"===n){var Se=t.createEvent(c,Ge.EVENT_CELL_KEY_PRESS);this.eventService.dispatchEvent(Se)}},r.prototype.processFullWidthRowKeyboardEvent=function(t,n,c){var f=t.getRowNode(),y=this.focusService.getFocusedCell();if(!fo(this.gridOptionsWrapper,c,f,y&&y.column,!1)&&"keydown"===n)switch(c.keyCode){case Yt.UP:case Yt.DOWN:t.onKeyboardNavigate(c);break;case Yt.TAB:t.onTabKeyDown(c)}if("keydown"===n){var de=t.createRowEvent(Ge.EVENT_CELL_KEY_DOWN,c);this.eventService.dispatchEvent(de)}if("keypress"===n){var Se=t.createRowEvent(Ge.EVENT_CELL_KEY_PRESS,c);this.eventService.dispatchEvent(Se)}},r.prototype.doGridOperations=function(t,n){if((t.ctrlKey||t.metaKey)&&!n&&this.mouseEventService.isEventFromThisGrid(t))switch(t.which){case Yt.A:return this.onCtrlAndA(t);case Yt.C:return this.onCtrlAndC(t);case Yt.V:return this.onCtrlAndV();case Yt.D:return this.onCtrlAndD(t);case Yt.Z:return t.shiftKey?this.undoRedoService.redo():this.undoRedoService.undo();case Yt.Y:return this.undoRedoService.redo()}},r.prototype.onCtrlAndA=function(t){var n=this,c=n.pinnedRowModel,y=n.rangeService,T=W.PINNED_BOTTOM,B=W.PINNED_TOP;if(y&&n.paginationProxy.isRowsToRender()){var q=[c.isEmpty(B),c.isEmpty(T)],ke=q[0]?null:B,je=void 0,Qe=void 0;q[1]?(je=null,Qe=this.paginationProxy.getRowCount()-1):(je=T,Qe=c.getPinnedBottomRowData().length-1);var rt=this.columnModel.getAllDisplayedColumns();if(C(rt))return;y.setCellRange({rowStartIndex:0,rowStartPinned:ke,rowEndIndex:Qe,rowEndPinned:je,columnStart:rt[0],columnEnd:H(rt)})}t.preventDefault()},r.prototype.onCtrlAndC=function(t){!this.clipboardService||this.gridOptionsWrapper.isEnableCellTextSelection()||(this.clipboardService.copyToClipboard(),t.preventDefault())},r.prototype.onCtrlAndV=function(){ne.isRegistered(e.GXE.ClipboardModule)&&!this.gridOptionsWrapper.isSuppressClipboardPaste()&&this.clipboardService.pasteFromClipboard()},r.prototype.onCtrlAndD=function(t){ne.isRegistered(e.GXE.ClipboardModule)&&!this.gridOptionsWrapper.isSuppressClipboardPaste()&&this.clipboardService.copyRangeDown(),t.preventDefault()},Bo([Ee("mouseEventService")],r.prototype,"mouseEventService",void 0),Bo([Ee("valueService")],r.prototype,"valueService",void 0),Bo([Nr("contextMenuFactory")],r.prototype,"contextMenuFactory",void 0),Bo([Ee("ctrlsService")],r.prototype,"ctrlsService",void 0),Bo([Ee("navigationService")],r.prototype,"navigationService",void 0),Bo([Ee("focusService")],r.prototype,"focusService",void 0),Bo([Ee("undoRedoService")],r.prototype,"undoRedoService",void 0),Bo([Ee("columnModel")],r.prototype,"columnModel",void 0),Bo([Ee("paginationProxy")],r.prototype,"paginationProxy",void 0),Bo([Ee("pinnedRowModel")],r.prototype,"pinnedRowModel",void 0),Bo([Nr("rangeService")],r.prototype,"rangeService",void 0),Bo([Nr("clipboardService")],r.prototype,"clipboardService",void 0),Bo([zt],r.prototype,"postConstruct",null),r}(ct),Td=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),vl=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Ed=function(h){function r(t){var n=h.call(this)||this;return n.centerContainerCon=t,n}return Td(r,h),r.prototype.postConstruct=function(){var t=this;this.ctrlsService.whenReady(function(){t.gridBodyCon=t.ctrlsService.getGridBodyCtrl(),t.listenForResize()}),this.addManagedListener(this.eventService,Ge.EVENT_SCROLLBAR_WIDTH_CHANGED,this.onScrollbarWidthChanged.bind(this))},r.prototype.listenForResize=function(){var t=this.onCenterViewportResized.bind(this);this.centerContainerCon.registerViewportResizeListener(t),this.gridBodyCon.registerBodyViewportResizeListener(t)},r.prototype.onScrollbarWidthChanged=function(){this.checkViewportAndScrolls()},r.prototype.onCenterViewportResized=function(){if(this.centerContainerCon.isViewportVisible()){this.checkViewportAndScrolls();var t=this.centerContainerCon.getCenterWidth();t!==this.centerWidth&&(this.centerWidth=t,this.columnModel.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0},r.prototype.checkViewportAndScrolls=function(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCon.getScrollFeature().checkScrollLeft()},r.prototype.getBodyHeight=function(){return this.bodyHeight},r.prototype.checkBodyHeight=function(){var n=Dl(this.gridBodyCon.getBodyViewportElement());this.bodyHeight!==n&&(this.bodyHeight=n,this.eventService.dispatchEvent({type:Ge.EVENT_BODY_HEIGHT_CHANGED,api:this.gridApi,columnApi:this.columnApi}))},r.prototype.updateScrollVisibleService=function(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)},r.prototype.updateScrollVisibleServiceImpl=function(){var t={horizontalScrollShowing:this.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCon.isVerticalScrollShowing()};this.scrollVisibleService.setScrollsVisible(t),this.gridBodyCon.setVerticalScrollPaddingVisible(t.verticalScrollShowing)},r.prototype.isHorizontalScrollShowing=function(){return this.gridOptionsWrapper.isAlwaysShowHorizontalScroll()||this.centerContainerCon.isViewportHScrollShowing()},r.prototype.onHorizontalViewportChanged=function(){var t=this.centerContainerCon.getCenterWidth(),n=this.centerContainerCon.getViewportScrollLeft();this.columnModel.setViewportPosition(t,n)},vl([Ee("ctrlsService")],r.prototype,"ctrlsService",void 0),vl([Ee("columnModel")],r.prototype,"columnModel",void 0),vl([Ee("scrollVisibleService")],r.prototype,"scrollVisibleService",void 0),vl([Ee("columnApi")],r.prototype,"columnApi",void 0),vl([Ee("gridApi")],r.prototype,"gridApi",void 0),vl([zt],r.prototype,"postConstruct",null),r}(ct),b2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Vv=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Uv=function(h){function r(t){var n=h.call(this)||this;return n.element=t,n}return b2(r,h),r.prototype.postConstruct=function(){this.addManagedListener(this.eventService,Ge.EVENT_LEFT_PINNED_WIDTH_CHANGED,this.onPinnedLeftWidthChanged.bind(this))},r.prototype.onPinnedLeftWidthChanged=function(){var t=this.pinnedWidthService.getPinnedLeftWidth(),n=t>0;Nn(this.element,n),n&&Ta(this.element,t)},Vv([Ee("pinnedWidthService")],r.prototype,"pinnedWidthService",void 0),Vv([zt],r.prototype,"postConstruct",null),r}(ct),Hv=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Fs=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Wv=function(h){function r(t){var n=h.call(this)||this;return n.element=t,n}return Hv(r,h),r.prototype.postConstruct=function(){this.addManagedListener(this.eventService,Ge.EVENT_RIGHT_PINNED_WIDTH_CHANGED,this.onPinnedRightWidthChanged.bind(this))},r.prototype.onPinnedRightWidthChanged=function(){var t=this.pinnedWidthService.getPinnedRightWidth(),n=t>0;Nn(this.element,n),n&&Ta(this.element,t)},Fs([Ee("pinnedWidthService")],r.prototype,"pinnedWidthService",void 0),Fs([zt],r.prototype,"postConstruct",null),r}(ct),zv=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),jv=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Pc=function(h){function r(t,n){var c=h.call(this)||this;return c.eContainer=t,c.eWrapper=n,c}return zv(r,h),r.prototype.postConstruct=function(){this.addManagedListener(this.eventService,Ge.EVENT_ROW_CONTAINER_HEIGHT_CHANGED,this.onHeightChanged.bind(this))},r.prototype.onHeightChanged=function(){var t=this.maxDivHeightScaler.getUiContainerHeight(),n=null!=t?t+"px":"";this.eContainer.style.height=n,this.eWrapper&&(this.eWrapper.style.height=n)},jv([Ee("rowContainerHeightService")],r.prototype,"maxDivHeightScaler",void 0),jv([zt],r.prototype,"postConstruct",null),r}(ct),A2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Fc=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Xv=function(h){function r(t){var n=h.call(this)||this;return n.eContainer=t,n}return A2(r,h),r.prototype.postConstruct=function(){var t=this;if(this.gridOptionsWrapper.isEnableRangeSelection()&&!g(this.rangeService)){var n={eElement:this.eContainer,onDragStart:this.rangeService.onDragStart.bind(this.rangeService),onDragStop:this.rangeService.onDragStop.bind(this.rangeService),onDragging:this.rangeService.onDragging.bind(this.rangeService)};this.dragService.addDragSource(n),this.addDestroyFunc(function(){return t.dragService.removeDragSource(n)})}},Fc([Nr("rangeService")],r.prototype,"rangeService",void 0),Fc([Ee("dragService")],r.prototype,"dragService",void 0),Fc([zt],r.prototype,"postConstruct",null),r}(ct),Yv=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),ts=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f};!function(h){h.LEFT="left",h.RIGHT="right",h.CENTER="center",h.FULL_WIDTH="fullWidth",h.TOP_LEFT="topLeft",h.TOP_RIGHT="topRight",h.TOP_CENTER="topCenter",h.TOP_FULL_WITH="topFullWidth",h.BOTTOM_LEFT="bottomLeft",h.BOTTOM_RIGHT="bottomRight",h.BOTTOM_CENTER="bottomCenter",h.BOTTOM_FULL_WITH="bottomFullWidth"}(e.hA6||(e.hA6={}));var Lc=dt([[e.hA6.CENTER,"ag-center-cols-container"],[e.hA6.LEFT,"ag-pinned-left-cols-container"],[e.hA6.RIGHT,"ag-pinned-right-cols-container"],[e.hA6.FULL_WIDTH,"ag-full-width-container"],[e.hA6.TOP_CENTER,"ag-floating-top-container"],[e.hA6.TOP_LEFT,"ag-pinned-left-floating-top"],[e.hA6.TOP_RIGHT,"ag-pinned-right-floating-top"],[e.hA6.TOP_FULL_WITH,"ag-floating-top-full-width-container"],[e.hA6.BOTTOM_CENTER,"ag-floating-bottom-container"],[e.hA6.BOTTOM_LEFT,"ag-pinned-left-floating-bottom"],[e.hA6.BOTTOM_RIGHT,"ag-pinned-right-floating-bottom"],[e.hA6.BOTTOM_FULL_WITH,"ag-floating-bottom-full-width-container"]]),Nc=dt([[e.hA6.CENTER,"ag-center-cols-viewport"],[e.hA6.TOP_CENTER,"ag-floating-top-viewport"],[e.hA6.BOTTOM_CENTER,"ag-floating-bottom-viewport"]]),Kv=dt([[e.hA6.CENTER,"ag-center-cols-clipper"]]),nu=function(h){function r(t){var n=h.call(this)||this;return n.name=t,n}return Yv(r,h),r.getRowContainerCssClasses=function(t){return{container:Lc.get(t),viewport:Nc.get(t),wrapper:Kv.get(t)}},r.getPinned=function(t){switch(t){case e.hA6.BOTTOM_LEFT:case e.hA6.TOP_LEFT:case e.hA6.LEFT:return W.PINNED_LEFT;case e.hA6.BOTTOM_RIGHT:case e.hA6.TOP_RIGHT:case e.hA6.RIGHT:return W.PINNED_RIGHT;default:return null}},r.prototype.postConstruct=function(){var t=this;this.enableRtl=this.gridOptionsWrapper.isEnableRtl(),this.embedFullWidthRows=this.gridOptionsWrapper.isEmbedFullWidthRows(),this.addManagedListener(this.eventService,Ge.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_DISPLAYED_ROWS_CHANGED,this.onDisplayedRowsChanged.bind(this)),this.forContainers([e.hA6.CENTER],function(){return t.viewportSizeFeature=t.createManagedBean(new Ed(t))}),this.registerWithCtrlsService()},r.prototype.registerWithCtrlsService=function(){switch(this.name){case e.hA6.CENTER:this.ctrlsService.registerCenterRowContainerCtrl(this);break;case e.hA6.LEFT:this.ctrlsService.registerLeftRowContainerCtrl(this);break;case e.hA6.RIGHT:this.ctrlsService.registerRightRowContainerCtrl(this);break;case e.hA6.TOP_CENTER:this.ctrlsService.registerTopCenterRowContainerCtrl(this);break;case e.hA6.TOP_LEFT:this.ctrlsService.registerTopLeftRowContainerCon(this);break;case e.hA6.TOP_RIGHT:this.ctrlsService.registerTopRightRowContainerCtrl(this);break;case e.hA6.BOTTOM_CENTER:this.ctrlsService.registerBottomCenterRowContainerCtrl(this);break;case e.hA6.BOTTOM_LEFT:this.ctrlsService.registerBottomLeftRowContainerCtrl(this);break;case e.hA6.BOTTOM_RIGHT:this.ctrlsService.registerBottomRightRowContainerCtrl(this)}},r.prototype.forContainers=function(t,n){t.indexOf(this.name)>=0&&n()},r.prototype.getContainerElement=function(){return this.eContainer},r.prototype.getViewportSizeFeature=function(){return this.viewportSizeFeature},r.prototype.setComp=function(t,n,c,f){var y=this;this.comp=t,this.eContainer=n,this.eViewport=c,this.eWrapper=f,this.createManagedBean(new Gv(this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder(),this.stopHScrollOnPinnedRows();var de=function(){for(var h=0,r=0,t=arguments.length;r<t;r++)h+=arguments[r].length;var n=Array(h),c=0;for(r=0;r<t;r++)for(var f=arguments[r],y=0,T=f.length;y<T;y++,c++)n[c]=f[y];return n}([e.hA6.TOP_CENTER,e.hA6.TOP_LEFT,e.hA6.TOP_RIGHT],[e.hA6.BOTTOM_CENTER,e.hA6.BOTTOM_LEFT,e.hA6.BOTTOM_RIGHT],[e.hA6.CENTER,e.hA6.LEFT,e.hA6.RIGHT]),Se=[e.hA6.CENTER,e.hA6.LEFT,e.hA6.RIGHT,e.hA6.FULL_WIDTH],ke=[e.hA6.CENTER,e.hA6.TOP_CENTER,e.hA6.BOTTOM_CENTER],Qe=[e.hA6.RIGHT,e.hA6.BOTTOM_RIGHT,e.hA6.TOP_RIGHT];this.forContainers([e.hA6.LEFT,e.hA6.BOTTOM_LEFT,e.hA6.TOP_LEFT],function(){return y.createManagedBean(new Uv(y.eContainer))}),this.forContainers(Qe,function(){return y.createManagedBean(new Wv(y.eContainer))}),this.forContainers(Se,function(){return y.createManagedBean(new Pc(y.eContainer,y.eWrapper))}),this.forContainers(de,function(){return y.createManagedBean(new Xv(y.eContainer))}),this.forContainers(ke,function(){return y.createManagedBean(new yd(function(rt){return y.comp.setContainerWidth(rt+"px")}))})},r.prototype.listenOnDomOrder=function(){var t=this,n=function(){return t.comp.setDomOrder(t.gridOptionsWrapper.isEnsureDomOrder())};this.addManagedListener(this.gridOptionsWrapper,vr.PROP_DOM_LAYOUT,n),n()},r.prototype.stopHScrollOnPinnedRows=function(){var t=this;this.forContainers([e.hA6.TOP_CENTER,e.hA6.BOTTOM_CENTER],function(){t.addManagedListener(t.eViewport,"scroll",function(){return t.eViewport.scrollLeft=0})})},r.prototype.onDisplayedColumnsChanged=function(){var t=this;this.forContainers([e.hA6.CENTER],function(){return t.onHorizontalViewportChanged()})},r.prototype.onDisplayedColumnsWidthChanged=function(){var t=this;this.forContainers([e.hA6.CENTER],function(){return t.onHorizontalViewportChanged()})},r.prototype.onScrollVisibilityChanged=function(){if(this.name===e.hA6.CENTER){var n=this.scrollVisibleService.isHorizontalScrollShowing()&&this.gridOptionsWrapper.getScrollbarWidth()||0;this.comp.setViewportHeight(0==n?"100%":"calc(100% + "+n+"px)")}},r.prototype.addPreventScrollWhileDragging=function(){var t=this,n=function(f){t.dragService.isDragging()&&f.cancelable&&f.preventDefault()};this.eContainer.addEventListener("touchmove",n,{passive:!1}),this.addDestroyFunc(function(){return t.eContainer.removeEventListener("touchmove",n)})},r.prototype.onHorizontalViewportChanged=function(){var t=this.getCenterWidth(),n=this.getCenterViewportScrollLeft();this.columnModel.setViewportPosition(t,n)},r.prototype.getCenterWidth=function(){return jo(this.eViewport)},r.prototype.getCenterViewportScrollLeft=function(){return Pu(this.eViewport,this.enableRtl)},r.prototype.registerViewportResizeListener=function(t){var n=this.resizeObserverService.observeResize(this.eViewport,t);this.addDestroyFunc(function(){return n()})},r.prototype.isViewportVisible=function(){return Ol(this.eViewport)},r.prototype.isViewportHScrollShowing=function(){return Pl(this.eViewport)},r.prototype.getViewportScrollLeft=function(){return Pu(this.eViewport,this.enableRtl)},r.prototype.isHorizontalScrollShowing=function(){return this.gridOptionsWrapper.isAlwaysShowHorizontalScroll()||Pl(this.eViewport)},r.prototype.getViewportElement=function(){return this.eViewport},r.prototype.setContainerTranslateX=function(t){this.eContainer.style.transform="translateX("+t+"px)"},r.prototype.getHScrollPosition=function(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}},r.prototype.setCenterViewportScrollLeft=function(t){Fu(this.eViewport,t,this.enableRtl)},r.prototype.onDisplayedRowsChanged=function(){var t=this,n=this.name===e.hA6.TOP_FULL_WITH||this.name===e.hA6.BOTTOM_FULL_WITH||this.name===e.hA6.FULL_WIDTH,y=this.getRowCtrls().filter(function(B){var q=B.isFullWidth(),de=t.gridOptionsWrapper.getDomLayout()===W.DOM_LAYOUT_PRINT,Se=t.embedFullWidthRows||de;return n?!Se&&q:Se||!q});this.comp.setRowCtrls(y)},r.prototype.getRowCtrls=function(){switch(this.name){case e.hA6.TOP_CENTER:case e.hA6.TOP_LEFT:case e.hA6.TOP_RIGHT:case e.hA6.TOP_FULL_WITH:return this.rowRenderer.getTopRowCtrls();case e.hA6.BOTTOM_CENTER:case e.hA6.BOTTOM_LEFT:case e.hA6.BOTTOM_RIGHT:case e.hA6.BOTTOM_FULL_WITH:return this.rowRenderer.getBottomRowCtrls();default:return this.rowRenderer.getRowCtrls()}},ts([Ee("scrollVisibleService")],r.prototype,"scrollVisibleService",void 0),ts([Ee("dragService")],r.prototype,"dragService",void 0),ts([Ee("ctrlsService")],r.prototype,"ctrlsService",void 0),ts([Ee("columnModel")],r.prototype,"columnModel",void 0),ts([Ee("resizeObserverService")],r.prototype,"resizeObserverService",void 0),ts([Ee("rowRenderer")],r.prototype,"rowRenderer",void 0),ts([zt],r.prototype,"postConstruct",null),r}(ct),Qv=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),rs=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},f0='<div class="ag-root ag-unselectable" role="grid" unselectable="on">\n        <ag-header-root ref="gridHeader" unselectable="on"></ag-header-root>\n        <div class="ag-floating-top" ref="eTop" role="presentation" unselectable="on">\n            <ag-row-container ref="topLeftContainer" name="'+e.hA6.TOP_LEFT+'"></ag-row-container>\n            <ag-row-container ref="topCenterContainer" name="'+e.hA6.TOP_CENTER+'"></ag-row-container>\n            <ag-row-container ref="topRightContainer" name="'+e.hA6.TOP_RIGHT+'"></ag-row-container>\n            <ag-row-container ref="topFullWidthContainer" name="'+e.hA6.TOP_FULL_WITH+'"></ag-row-container>\n        </div>\n        <div class="ag-body-viewport" ref="eBodyViewport" role="presentation">\n            <ag-row-container ref="leftContainer" name="'+e.hA6.LEFT+'"></ag-row-container>\n            <ag-row-container ref="centerContainer" name="'+e.hA6.CENTER+'"></ag-row-container>\n            <ag-row-container ref="rightContainer" name="'+e.hA6.RIGHT+'"></ag-row-container>\n            <ag-row-container ref="fullWidthContainer" name="'+e.hA6.FULL_WIDTH+'"></ag-row-container>\n        </div>\n        <div class="ag-floating-bottom" ref="eBottom" role="presentation" unselectable="on">\n            <ag-row-container ref="bottomLeftContainer" name="'+e.hA6.BOTTOM_LEFT+'"></ag-row-container>\n            <ag-row-container ref="bottomCenterContainer" name="'+e.hA6.BOTTOM_CENTER+'"></ag-row-container>\n            <ag-row-container ref="bottomRightContainer" name="'+e.hA6.BOTTOM_RIGHT+'"></ag-row-container>\n            <ag-row-container ref="bottomFullWidthContainer" name="'+e.hA6.BOTTOM_FULL_WITH+'"></ag-row-container>\n        </div>\n        <ag-fake-horizontal-scroll></ag-fake-horizontal-scroll>\n        <ag-overlay-wrapper></ag-overlay-wrapper>\n    </div>',Jv=function(h){function r(){return h.call(this,f0)||this}return Qv(r,h),r.prototype.init=function(){var t=this,n=function(y,T){var B=y+"px";T.style.minHeight=B,T.style.height=B},c={setRowAnimationCssOnBodyViewport:function(y,T){return t.setRowAnimationCssOnBodyViewport(y,T)},setColumnCount:function(y){return K1(t.getGui(),y)},setRowCount:function(y){return q1(t.getGui(),y)},setTopHeight:function(y){return n(y,t.eTop)},setBottomHeight:function(y){return n(y,t.eBottom)},setTopDisplay:function(y){return t.eTop.style.display=y},setBottomDisplay:function(y){return t.eBottom.style.display=y},setColumnMovingCss:function(y,T){return t.addOrRemoveCssClass(kv,T)},updateLayoutClasses:function(y,T){Fr(t.eBodyViewport,e.LBn.AUTO_HEIGHT,T.autoHeight),Fr(t.eBodyViewport,e.LBn.NORMAL,T.normal),Fr(t.eBodyViewport,e.LBn.PRINT,T.print),t.addOrRemoveCssClass(e.LBn.AUTO_HEIGHT,T.autoHeight),t.addOrRemoveCssClass(e.LBn.NORMAL,T.normal),t.addOrRemoveCssClass(e.LBn.PRINT,T.print)},setAlwaysVerticalScrollClass:function(y,T){return Fr(t.eBodyViewport,Iv,T)},registerBodyViewportResizeListener:function(y){var T=t.resizeObserverService.observeResize(t.eBodyViewport,y);t.addDestroyFunc(function(){return T()})},setPinnedTopBottomOverflowY:function(y){return t.eTop.style.overflowY=t.eBottom.style.overflowY=y},setCellSelectableCss:function(y,T){[t.eTop,t.eBodyViewport,t.eBottom].forEach(function(B){return Fr(B,Nv,T)})}};this.ctrl=this.createManagedBean(new Bv),this.ctrl.setComp(c,this.getGui(),this.eBodyViewport,this.eTop,this.eBottom),(this.rangeService||this.gridOptionsWrapper.isRowSelectionMulti())&&Y1(this.getGui(),!0)},r.prototype.setRowAnimationCssOnBodyViewport=function(t,n){Fr(this.eBodyViewport,e.SJN.ANIMATION_ON,n),Fr(this.eBodyViewport,e.SJN.ANIMATION_OFF,!n)},r.prototype.getFloatingTopBottom=function(){return[this.eTop,this.eBottom]},rs([Ee("resizeObserverService")],r.prototype,"resizeObserverService",void 0),rs([Nr("rangeService")],r.prototype,"rangeService",void 0),rs([Bt("eBodyViewport")],r.prototype,"eBodyViewport",void 0),rs([Bt("eTop")],r.prototype,"eTop",void 0),rs([Bt("eBottom")],r.prototype,"eBottom",void 0),rs([Bt("gridHeader")],r.prototype,"headerRootComp",void 0),rs([zt],r.prototype,"init",null),r}(dn);!function(h){h[h.SINGLE_SHEET=0]="SINGLE_SHEET",h[h.MULTI_SHEET=1]="MULTI_SHEET"}(e.nPL||(e.nPL={})),function(h){h.EVERYTHING="group",h.FILTER="filter",h.SORT="sort",h.MAP="map",h.AGGREGATE="aggregate",h.PIVOT="pivot",h.NOTHING="nothing"}(e.j_r||(e.j_r={}));var _n=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Zv=function(){function h(){this.detailGridInfoMap={},this.destroyCalled=!1}return h.prototype.registerOverlayWrapperComp=function(r){this.overlayWrapperComp=r},h.prototype.registerSideBarComp=function(r){this.sideBarComp=r},h.prototype.init=function(){var r=this;switch(this.rowModel.getType()){case W.ROW_MODEL_TYPE_CLIENT_SIDE:this.clientSideRowModel=this.rowModel;break;case W.ROW_MODEL_TYPE_INFINITE:this.infiniteRowModel=this.rowModel;break;case W.ROW_MODEL_TYPE_SERVER_SIDE:this.serverSideRowModel=this.rowModel}this.ctrlsService.whenReady(function(){r.gridBodyCon=r.ctrlsService.getGridBodyCtrl()})},h.prototype.__getAlignedGridService=function(){return this.alignedGridsService},h.prototype.addDetailGridInfo=function(r,t){this.detailGridInfoMap[r]=t},h.prototype.removeDetailGridInfo=function(r){this.detailGridInfoMap[r]=void 0},h.prototype.getDetailGridInfo=function(r){return this.detailGridInfoMap[r]},h.prototype.forEachDetailGridInfo=function(r){var t=0;ce(this.detailGridInfoMap,function(n,c){v(c)&&(r(c,t),t++)})},h.prototype.getDataAsCsv=function(r){if(ne.assertRegistered(e.GXE.CsvExportModule,"api.getDataAsCsv"))return this.csvCreator.getDataAsCsv(r)},h.prototype.exportDataAsCsv=function(r){ne.assertRegistered(e.GXE.CsvExportModule,"api.exportDataAsCSv")&&this.csvCreator.exportDataAsCsv(r)},h.prototype.getDataAsExcel=function(r){if(ne.assertRegistered(e.GXE.ExcelExportModule,"api.getDataAsExcel"))return this.excelCreator.getFactoryMode(r&&r.exportMode||"xlsx")===e.nPL.MULTI_SHEET?void console.warn("AG Grid: The Excel Exporter is currently on Multi Sheet mode. End that operation by calling `api.getMultipleSheetAsExcel()` or `api.exportMultipleSheetsAsExcel()`"):this.excelCreator.getDataAsExcel(r)},h.prototype.exportDataAsExcel=function(r){if(ne.assertRegistered(e.GXE.ExcelExportModule,"api.exportDataAsExcel")){if(this.excelCreator.getFactoryMode(r&&r.exportMode||"xlsx")===e.nPL.MULTI_SHEET)return void console.warn("AG Grid: The Excel Exporter is currently on Multi Sheet mode. End that operation by calling `api.getMultipleSheetAsExcel()` or `api.exportMultipleSheetsAsExcel()`");this.excelCreator.exportDataAsExcel(r)}},h.prototype.getSheetDataForExcel=function(r){if(ne.assertRegistered(e.GXE.ExcelExportModule,"api.getSheetDataForExcel"))return this.excelCreator.setFactoryMode(e.nPL.MULTI_SHEET,r&&r.exportMode||"xlsx"),this.excelCreator.getSheetDataForExcel(r)},h.prototype.getMultipleSheetsAsExcel=function(r){if(ne.assertRegistered(e.GXE.ExcelExportModule,"api.getMultipleSheetsAsExcel"))return this.excelCreator.getMultipleSheetsAsExcel(r)},h.prototype.exportMultipleSheetsAsExcel=function(r){if(ne.assertRegistered(e.GXE.ExcelExportModule,"api.exportMultipleSheetsAsExcel"))return this.excelCreator.exportMultipleSheetsAsExcel(r)},h.prototype.setEnterpriseDatasource=function(r){console.warn("ag-grid: since version 18.x, api.setEnterpriseDatasource() should be replaced with api.setServerSideDatasource()"),this.setServerSideDatasource(r)},h.prototype.setGridAriaProperty=function(r,t){if(r){var n=this.ctrlsService.getGridBodyCtrl().getGui(),c="aria-"+r;null===t?n.removeAttribute(c):n.setAttribute(c,t)}},h.prototype.setServerSideDatasource=function(r){this.serverSideRowModel?this.serverSideRowModel.setDatasource(r):console.warn("AG Grid: you can only use an enterprise datasource when gridOptions.rowModelType is '"+W.ROW_MODEL_TYPE_SERVER_SIDE+"'")},h.prototype.setDatasource=function(r){this.gridOptionsWrapper.isRowModelInfinite()?this.rowModel.setDatasource(r):console.warn("AG Grid: you can only use a datasource when gridOptions.rowModelType is '"+W.ROW_MODEL_TYPE_INFINITE+"'")},h.prototype.setViewportDatasource=function(r){this.gridOptionsWrapper.isRowModelViewport()?this.rowModel.setViewportDatasource(r):console.warn("AG Grid: you can only use a viewport datasource when gridOptions.rowModelType is '"+W.ROW_MODEL_TYPE_VIEWPORT+"'")},h.prototype.setRowData=function(r){if(this.gridOptionsWrapper.isRowModelDefault())if(this.gridOptionsWrapper.isImmutableData()){var t=this.immutableService.createTransactionForRowData(r);if(!t)return;var f=this.clientSideRowModel.updateRowData(t[0],t[1]);f&&this.rowRenderer.refreshFullWidthRows(f.update)}else this.selectionService.reset(),this.clientSideRowModel.setRowData(r);else console.warn("cannot call setRowData unless using normal row model")},h.prototype.setFloatingTopRowData=function(r){console.warn("AG Grid: since v12, api.setFloatingTopRowData() is now api.setPinnedTopRowData()"),this.setPinnedTopRowData(r)},h.prototype.setFloatingBottomRowData=function(r){console.warn("AG Grid: since v12, api.setFloatingBottomRowData() is now api.setPinnedBottomRowData()"),this.setPinnedBottomRowData(r)},h.prototype.getFloatingTopRowCount=function(){return console.warn("AG Grid: since v12, api.getFloatingTopRowCount() is now api.getPinnedTopRowCount()"),this.getPinnedTopRowCount()},h.prototype.getFloatingBottomRowCount=function(){return console.warn("AG Grid: since v12, api.getFloatingBottomRowCount() is now api.getPinnedBottomRowCount()"),this.getPinnedBottomRowCount()},h.prototype.getFloatingTopRow=function(r){return console.warn("AG Grid: since v12, api.getFloatingTopRow() is now api.getPinnedTopRow()"),this.getPinnedTopRow(r)},h.prototype.getFloatingBottomRow=function(r){return console.warn("AG Grid: since v12, api.getFloatingBottomRow() is now api.getPinnedBottomRow()"),this.getPinnedBottomRow(r)},h.prototype.setPinnedTopRowData=function(r){this.pinnedRowModel.setPinnedTopRowData(r)},h.prototype.setPinnedBottomRowData=function(r){this.pinnedRowModel.setPinnedBottomRowData(r)},h.prototype.getPinnedTopRowCount=function(){return this.pinnedRowModel.getPinnedTopRowCount()},h.prototype.getPinnedBottomRowCount=function(){return this.pinnedRowModel.getPinnedBottomRowCount()},h.prototype.getPinnedTopRow=function(r){return this.pinnedRowModel.getPinnedTopRow(r)},h.prototype.getPinnedBottomRow=function(r){return this.pinnedRowModel.getPinnedBottomRow(r)},h.prototype.setColumnDefs=function(r,t){void 0===t&&(t="api"),this.columnModel.setColumnDefs(r,t)},h.prototype.setAutoGroupColumnDef=function(r,t){this.gridOptionsWrapper.setProperty("autoGroupColumnDef",r,!0)},h.prototype.expireValueCache=function(){this.valueCache.expire()},h.prototype.getVerticalPixelRange=function(){return this.gridBodyCon.getScrollFeature().getVScrollPosition()},h.prototype.getHorizontalPixelRange=function(){return this.gridBodyCon.getScrollFeature().getHScrollPosition()},h.prototype.setAlwaysShowHorizontalScroll=function(r){this.gridOptionsWrapper.setProperty("alwaysShowHorizontalScroll",r)},h.prototype.setAlwaysShowVerticalScroll=function(r){this.gridOptionsWrapper.setProperty("alwaysShowVerticalScroll",r)},h.prototype.refreshToolPanel=function(){!this.sideBarComp||this.sideBarComp.refresh()},h.prototype.refreshCells=function(r){void 0===r&&(r={}),Array.isArray(r)?console.warn("since AG Grid v11.1, refreshCells() now takes parameters, please see the documentation."):this.rowRenderer.refreshCells(r)},h.prototype.flashCells=function(r){void 0===r&&(r={}),this.rowRenderer.flashCells(r)},h.prototype.redrawRows=function(r){void 0===r&&(r={}),this.rowRenderer.redrawRows(r?r.rowNodes:void 0)},h.prototype.refreshView=function(){console.warn("AG Grid: since v11.1, refreshView() is deprecated, please call refreshCells() or redrawRows() instead"),this.redrawRows()},h.prototype.refreshRows=function(r){console.warn("since AG Grid v11.1, refreshRows() is deprecated, please use refreshCells({rowNodes: rows}) or redrawRows({rowNodes: rows}) instead"),this.refreshCells({rowNodes:r})},h.prototype.rowDataChanged=function(r){console.warn("AG Grid: rowDataChanged is deprecated, either call refreshView() to refresh everything, or call rowNode.setRowData(newData) to set value on a particular node"),this.redrawRows()},h.prototype.softRefreshView=function(){console.error("AG Grid: since v16, softRefreshView() is no longer supported. Please check the documentation on how to refresh.")},h.prototype.refreshGroupRows=function(){console.warn("AG Grid: since v11.1, refreshGroupRows() is no longer supported, call refreshCells() instead. Because refreshCells() now does dirty checking, it will only refresh cells that have changed, so it should not be necessary to only refresh the group rows."),this.refreshCells()},h.prototype.setFunctionsReadOnly=function(r){this.gridOptionsWrapper.setProperty("functionsReadOnly",r)},h.prototype.refreshHeader=function(){this.ctrlsService.getHeaderRowContainerCtrls().forEach(function(r){return r.refresh()})},h.prototype.isAnyFilterPresent=function(){return this.filterManager.isAnyFilterPresent()},h.prototype.isAdvancedFilterPresent=function(){return console.warn("AG Grid: isAdvancedFilterPresent() is deprecated, please use isColumnFilterPresent()"),this.isColumnFilterPresent()},h.prototype.isColumnFilterPresent=function(){return this.filterManager.isAdvancedFilterPresent()},h.prototype.isQuickFilterPresent=function(){return this.filterManager.isQuickFilterPresent()},h.prototype.getModel=function(){return this.rowModel},h.prototype.setRowNodeExpanded=function(r,t){r&&r.setExpanded(t)},h.prototype.onGroupExpandedOrCollapsed=function(r){g(this.clientSideRowModel)&&console.warn("AG Grid: cannot call onGroupExpandedOrCollapsed unless using normal row model"),v(r)&&console.warn("AG Grid: api.onGroupExpandedOrCollapsed - refreshFromIndex parameter is no longer used, the grid will refresh all rows"),this.clientSideRowModel.refreshModel({step:e.j_r.MAP})},h.prototype.refreshInMemoryRowModel=function(r){console.warn("ag-grid: since version 18.x, api.refreshInMemoryRowModel() should be replaced with api.refreshClientSideRowModel()"),this.refreshClientSideRowModel(r)},h.prototype.refreshClientSideRowModel=function(r){g(this.clientSideRowModel)&&console.warn("cannot call refreshClientSideRowModel unless using normal row model");var t=e.j_r.EVERYTHING,n={group:e.j_r.EVERYTHING,filter:e.j_r.FILTER,map:e.j_r.MAP,aggregate:e.j_r.AGGREGATE,sort:e.j_r.SORT,pivot:e.j_r.PIVOT};v(r)&&(t=n[r]),g(t)?console.error("AG Grid: invalid step "+r+", available steps are "+Object.keys(n).join(", ")):this.clientSideRowModel.refreshModel({step:t,keepRenderedRows:!0,animate:!0,keepEditingRows:!0})},h.prototype.isAnimationFrameQueueEmpty=function(){return this.animationFrameService.isQueueEmpty()},h.prototype.flushAllAnimationFrames=function(){this.animationFrameService.flushAllFrames()},h.prototype.getRowNode=function(r){return this.rowModel.getRowNode(r)},h.prototype.getSizesForCurrentTheme=function(){return{rowHeight:this.gridOptionsWrapper.getRowHeightAsNumber(),headerHeight:this.gridOptionsWrapper.getHeaderHeight()}},h.prototype.expandAll=function(){this.clientSideRowModel?this.clientSideRowModel.expandOrCollapseAll(!0):this.serverSideRowModel?this.serverSideRowModel.expandAll(!0):console.warn("AG Grid: expandAll only works with Client Side Row Model and Server Side Row Model")},h.prototype.collapseAll=function(){this.clientSideRowModel?this.clientSideRowModel.expandOrCollapseAll(!1):this.serverSideRowModel?this.serverSideRowModel.expandAll(!1):console.warn("AG Grid: collapseAll only works with Client Side Row Model and Server Side Row Model")},h.prototype.getToolPanelInstance=function(r){if(this.sideBarComp){var t=this.sideBarComp.getToolPanelInstance(r);return this.frameworkComponentWrapper?this.frameworkComponentWrapper.unwrap(t):t}console.warn("AG Grid: toolPanel is only available in AG Grid Enterprise")},h.prototype.addVirtualRowListener=function(r,t,n){"string"!=typeof r&&console.warn("AG Grid: addVirtualRowListener is deprecated, please use addRenderedRowListener."),this.addRenderedRowListener(r,t,n)},h.prototype.addRenderedRowListener=function(r,t,n){"virtualRowSelected"===r&&console.warn("AG Grid: event virtualRowSelected is deprecated, to register for individual row\n                selection events, add a listener directly to the row node."),this.rowRenderer.addRenderedRowListener(r,t,n)},h.prototype.setQuickFilter=function(r){this.filterManager.setQuickFilter(r)},h.prototype.selectIndex=function(r,t,n){console.warn("AG Grid: do not use api for selection, call node.setSelected(value) instead"),n&&console.warn("AG Grid: suppressEvents is no longer supported, stop listening for the event if you no longer want it"),this.selectionService.selectIndex(r,t)},h.prototype.deselectIndex=function(r,t){void 0===t&&(t=!1),console.warn("AG Grid: do not use api for selection, call node.setSelected(value) instead"),t&&console.warn("AG Grid: suppressEvents is no longer supported, stop listening for the event if you no longer want it"),this.selectionService.deselectIndex(r)},h.prototype.selectNode=function(r,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1),console.warn("AG Grid: API for selection is deprecated, call node.setSelected(value) instead"),n&&console.warn("AG Grid: suppressEvents is no longer supported, stop listening for the event if you no longer want it"),r.setSelectedParams({newValue:!0,clearSelection:!t})},h.prototype.deselectNode=function(r,t){void 0===t&&(t=!1),console.warn("AG Grid: API for selection is deprecated, call node.setSelected(value) instead"),t&&console.warn("AG Grid: suppressEvents is no longer supported, stop listening for the event if you no longer want it"),r.setSelectedParams({newValue:!1})},h.prototype.selectAll=function(){this.selectionService.selectAllRowNodes()},h.prototype.deselectAll=function(){this.selectionService.deselectAllRowNodes()},h.prototype.selectAllFiltered=function(){this.selectionService.selectAllRowNodes(!0)},h.prototype.deselectAllFiltered=function(){this.selectionService.deselectAllRowNodes(!0)},h.prototype.recomputeAggregates=function(){g(this.clientSideRowModel)&&console.warn("cannot call recomputeAggregates unless using normal row model"),console.warn("recomputeAggregates is deprecated, please call api.refreshClientSideRowModel('aggregate') instead"),this.clientSideRowModel.refreshModel({step:e.j_r.AGGREGATE})},h.prototype.sizeColumnsToFit=function(){this.gridBodyCon.sizeColumnsToFit()},h.prototype.showLoadingOverlay=function(){this.overlayWrapperComp.showLoadingOverlay()},h.prototype.showNoRowsOverlay=function(){this.overlayWrapperComp.showNoRowsOverlay()},h.prototype.hideOverlay=function(){this.overlayWrapperComp.hideOverlay()},h.prototype.isNodeSelected=function(r){return console.warn("AG Grid: no need to call api.isNodeSelected(), just call node.isSelected() instead"),r.isSelected()},h.prototype.getSelectedNodesById=function(){return console.error("AG Grid: since version 3.4, getSelectedNodesById no longer exists, use getSelectedNodes() instead"),null},h.prototype.getSelectedNodes=function(){return this.selectionService.getSelectedNodes()},h.prototype.getSelectedRows=function(){return this.selectionService.getSelectedRows()},h.prototype.getBestCostNodeSelection=function(){return this.selectionService.getBestCostNodeSelection()},h.prototype.getRenderedNodes=function(){return this.rowRenderer.getRenderedNodes()},h.prototype.ensureColIndexVisible=function(r){console.warn("AG Grid: ensureColIndexVisible(index) no longer supported, use ensureColumnVisible(colKey) instead.")},h.prototype.ensureColumnVisible=function(r){this.gridBodyCon.getScrollFeature().ensureColumnVisible(r)},h.prototype.ensureIndexVisible=function(r,t){this.gridBodyCon.getScrollFeature().ensureIndexVisible(r,t)},h.prototype.ensureNodeVisible=function(r,t){void 0===t&&(t=null),this.gridBodyCon.getScrollFeature().ensureNodeVisible(r,t)},h.prototype.forEachLeafNode=function(r){g(this.clientSideRowModel)&&console.warn("cannot call forEachNode unless using normal row model"),this.clientSideRowModel.forEachLeafNode(r)},h.prototype.forEachNode=function(r){this.rowModel.forEachNode(r)},h.prototype.forEachNodeAfterFilter=function(r){g(this.clientSideRowModel)&&console.warn("cannot call forEachNodeAfterFilter unless using normal row model"),this.clientSideRowModel.forEachNodeAfterFilter(r)},h.prototype.forEachNodeAfterFilterAndSort=function(r){g(this.clientSideRowModel)&&console.warn("cannot call forEachNodeAfterFilterAndSort unless using normal row model"),this.clientSideRowModel.forEachNodeAfterFilterAndSort(r)},h.prototype.getFilterApiForColDef=function(r){return console.warn("ag-grid API method getFilterApiForColDef deprecated, use getFilterInstance instead"),this.getFilterInstance(r)},h.prototype.getFilterInstance=function(r,t){var n=this,c=this.columnModel.getPrimaryColumn(r);if(c){var f=this.filterManager.getFilterComponent(c,"NO_UI"),y=f&&f.resolveNow(null,function(B){return B}),T=this.frameworkComponentWrapper?this.frameworkComponentWrapper.unwrap(y):y;return t&&(T?setTimeout(t,0,T):f&&f.then(function(B){var q=n.frameworkComponentWrapper?n.frameworkComponentWrapper.unwrap(B):B;t(q)})),T}},h.prototype.getFilterApi=function(r){return console.warn("AG Grid: getFilterApi is deprecated, use getFilterInstance instead"),this.getFilterInstance(r)},h.prototype.destroyFilter=function(r){var t=this.columnModel.getPrimaryColumn(r);if(t)return this.filterManager.destroyFilter(t,"filterDestroyed")},h.prototype.getStatusPanel=function(r){if(this.statusBarService){var t=this.statusBarService.getStatusPanel(r);return this.frameworkComponentWrapper?this.frameworkComponentWrapper.unwrap(t):t}},h.prototype.getColumnDef=function(r){var t=this.columnModel.getPrimaryColumn(r);return t?t.getColDef():null},h.prototype.getColumnDefs=function(){return this.columnModel.getColumnDefs()},h.prototype.onFilterChanged=function(){this.filterManager.onFilterChanged()},h.prototype.onSortChanged=function(){this.sortController.onSortChanged()},h.prototype.setSortModel=function(r,t){console.warn("AG Grid: as of version 24.0.0, setSortModel() is deprecated, sort information is now part of Column State. Please use columnApi.applyColumnState() instead.");var n=[];r&&r.forEach(function(c,f){n.push({colId:c.colId,sort:c.sort,sortIndex:f})}),this.columnModel.applyColumnState({state:n,defaultState:{sort:null}})},h.prototype.getSortModel=function(){console.warn("AG Grid: as of version 24.0.0, getSortModel() is deprecated, sort information is now part of Column State. Please use columnApi.getColumnState() instead.");var t=this.columnModel.getColumnState().filter(function(f){return null!=f.sort}),n={};t.forEach(function(f){n[f.colId]=f.sortIndex});var c=t.map(function(f){return{colId:f.colId,sort:f.sort}});return c.sort(function(f,y){return n[f.colId]-n[y.colId]}),c},h.prototype.setFilterModel=function(r){this.filterManager.setFilterModel(r)},h.prototype.getFilterModel=function(){return this.filterManager.getFilterModel()},h.prototype.getFocusedCell=function(){return this.focusService.getFocusedCell()},h.prototype.clearFocusedCell=function(){return this.focusService.clearFocusedCell()},h.prototype.setFocusedCell=function(r,t,n){this.focusService.setFocusedCell(r,t,n,!0)},h.prototype.setSuppressRowDrag=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_SUPPRESS_ROW_DRAG,r)},h.prototype.setSuppressMoveWhenRowDragging=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_SUPPRESS_MOVE_WHEN_ROW_DRAG,r)},h.prototype.setSuppressRowClickSelection=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_SUPPRESS_ROW_CLICK_SELECTION,r)},h.prototype.addRowDropZone=function(r){this.gridBodyCon.getRowDragFeature().addRowDropZone(r)},h.prototype.removeRowDropZone=function(r){var t=this.dragAndDropService.findExternalZone(r);t&&this.dragAndDropService.removeDropTarget(t)},h.prototype.getRowDropZoneParams=function(r){return this.gridBodyCon.getRowDragFeature().getRowDropZone(r)},h.prototype.setHeaderHeight=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_HEADER_HEIGHT,r)},h.prototype.setDomLayout=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_DOM_LAYOUT,r)},h.prototype.setEnableCellTextSelection=function(r){this.gridBodyCon.setCellTextSelection(r)},h.prototype.setFillHandleDirection=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_FILL_HANDLE_DIRECTION,r)},h.prototype.setGroupHeaderHeight=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_GROUP_HEADER_HEIGHT,r)},h.prototype.setFloatingFiltersHeight=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_FLOATING_FILTERS_HEIGHT,r)},h.prototype.setPivotGroupHeaderHeight=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_PIVOT_GROUP_HEADER_HEIGHT,r)},h.prototype.setIsExternalFilterPresent=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_IS_EXTERNAL_FILTER_PRESENT,r)},h.prototype.setDoesExternalFilterPass=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_DOES_EXTERNAL_FILTER_PASS,r)},h.prototype.setNavigateToNextCell=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_NAVIGATE_TO_NEXT_CELL,r)},h.prototype.setTabToNextCell=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_TAB_TO_NEXT_CELL,r)},h.prototype.setTabToNextHeader=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_TAB_TO_NEXT_HEADER,r)},h.prototype.setNavigateToNextHeader=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_NAVIGATE_TO_NEXT_HEADER,r)},h.prototype.setGroupRowAggNodes=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_GROUP_ROW_AGG_NODES,r)},h.prototype.setGetBusinessKeyForNode=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_GET_BUSINESS_KEY_FOR_NODE,r)},h.prototype.setGetChildCount=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_GET_CHILD_COUNT,r)},h.prototype.setProcessRowPostCreate=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_PROCESS_ROW_POST_CREATE,r)},h.prototype.setGetRowNodeId=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_GET_ROW_NODE_ID,r)},h.prototype.setGetRowClass=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_GET_ROW_CLASS,r)},h.prototype.setIsFullWidthCell=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_IS_FULL_WIDTH_CELL,r)},h.prototype.setIsRowSelectable=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_IS_ROW_SELECTABLE,r)},h.prototype.setIsRowMaster=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_IS_ROW_MASTER,r)},h.prototype.setPostSort=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_POST_SORT,r)},h.prototype.setGetDocument=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_GET_DOCUMENT,r)},h.prototype.setGetContextMenuItems=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_GET_CONTEXT_MENU_ITEMS,r)},h.prototype.setGetMainMenuItems=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_GET_MAIN_MENU_ITEMS,r)},h.prototype.setProcessCellForClipboard=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_PROCESS_CELL_FOR_CLIPBOARD,r)},h.prototype.setSendToClipboard=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_SEND_TO_CLIPBOARD,r)},h.prototype.setProcessCellFromClipboard=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_PROCESS_CELL_FROM_CLIPBOARD,r)},h.prototype.setProcessSecondaryColDef=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_PROCESS_TO_SECONDARY_COLDEF,r)},h.prototype.setProcessSecondaryColGroupDef=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_PROCESS_SECONDARY_COL_GROUP_DEF,r)},h.prototype.setPostProcessPopup=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_POST_PROCESS_POPUP,r)},h.prototype.setDefaultGroupOrderComparator=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_DEFAULT_GROUP_ORDER_COMPARATOR,r)},h.prototype.setGetChartToolbarItems=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_GET_CHART_TOOLBAR_ITEMS,r)},h.prototype.setPaginationNumberFormatter=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_PAGINATION_NUMBER_FORMATTER,r)},h.prototype.setGetServerSideStoreParams=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_GET_SERVER_SIDE_STORE_PARAMS,r)},h.prototype.setIsServerSideGroupOpenByDefault=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_IS_SERVER_SIDE_GROUPS_OPEN_BY_DEFAULT,r)},h.prototype.setIsApplyServerSideTransaction=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_IS_APPLY_SERVER_SIDE_TRANSACTION,r)},h.prototype.setIsServerSideGroup=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_IS_SERVER_SIDE_GROUP,r)},h.prototype.setGetServerSideGroupKey=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_GET_SERVER_SIDE_GROUP_KEY,r)},h.prototype.setGetRowStyle=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_GET_ROW_STYLE,r)},h.prototype.setGetRowHeight=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_GET_ROW_HEIGHT,r)},h.prototype.setPivotHeaderHeight=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_PIVOT_HEADER_HEIGHT,r)},h.prototype.isSideBarVisible=function(){return!!this.sideBarComp&&this.sideBarComp.isDisplayed()},h.prototype.setSideBarVisible=function(r){this.sideBarComp?this.sideBarComp.setDisplayed(r):r&&console.warn("AG Grid: sideBar is not loaded")},h.prototype.setSideBarPosition=function(r){this.sideBarComp?this.sideBarComp.setSideBarPosition(r):console.warn("AG Grid: sideBar is not loaded")},h.prototype.openToolPanel=function(r){this.sideBarComp?this.sideBarComp.openToolPanel(r):console.warn("AG Grid: toolPanel is only available in AG Grid Enterprise")},h.prototype.closeToolPanel=function(){this.sideBarComp?this.sideBarComp.close():console.warn("AG Grid: toolPanel is only available in AG Grid Enterprise")},h.prototype.getOpenedToolPanel=function(){return this.sideBarComp?this.sideBarComp.openedItem():null},h.prototype.getSideBar=function(){return this.gridOptionsWrapper.getSideBar()},h.prototype.setSideBar=function(r){this.gridOptionsWrapper.setProperty("sideBar",dc.parse(r))},h.prototype.setSuppressClipboardPaste=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_SUPPRESS_CLIPBOARD_PASTE,r)},h.prototype.isToolPanelShowing=function(){return this.sideBarComp.isToolPanelShowing()},h.prototype.doLayout=function(){Lt(function(){return console.warn("AG Grid - since version 25.1, doLayout was taken out, as it's not needed. The grid responds to grid size changes automatically")},"doLayoutDeprecated")},h.prototype.resetRowHeights=function(){v(this.clientSideRowModel)&&this.clientSideRowModel.resetRowHeights()},h.prototype.setGroupRemoveSingleChildren=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_GROUP_REMOVE_SINGLE_CHILDREN,r)},h.prototype.setGroupRemoveLowestSingleChildren=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_GROUP_REMOVE_LOWEST_SINGLE_CHILDREN,r)},h.prototype.onRowHeightChanged=function(){this.clientSideRowModel?this.clientSideRowModel.onRowHeightChanged():this.serverSideRowModel&&this.serverSideRowModel.onRowHeightChanged()},h.prototype.getValue=function(r,t){var n=this.columnModel.getPrimaryColumn(r);return g(n)&&(n=this.columnModel.getGridColumn(r)),g(n)?null:this.valueService.getValue(n,t)},h.prototype.addEventListener=function(r,t){var n=this.gridOptionsWrapper.useAsyncEvents();this.eventService.addEventListener(r,t,n)},h.prototype.addGlobalListener=function(r){var t=this.gridOptionsWrapper.useAsyncEvents();this.eventService.addGlobalListener(r,t)},h.prototype.removeEventListener=function(r,t){var n=this.gridOptionsWrapper.useAsyncEvents();this.eventService.removeEventListener(r,t,n)},h.prototype.removeGlobalListener=function(r){var t=this.gridOptionsWrapper.useAsyncEvents();this.eventService.removeGlobalListener(r,t)},h.prototype.dispatchEvent=function(r){this.eventService.dispatchEvent(r)},h.prototype.destroy=function(){if(!this.destroyCalled){this.destroyCalled=!0;var r=this.ctrlsService.getGridCtrl();r&&r.destroyGridUi(),this.context.destroy()}},h.prototype.cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid=function(){setTimeout(St.bind(window,this,"Grid API"),100)},h.prototype.warnIfDestroyed=function(r){return this.destroyCalled&&console.warn("AG Grid: Grid API method "+r+" was called on a grid that was destroyed."),this.destroyCalled},h.prototype.resetQuickFilter=function(){this.warnIfDestroyed("resetQuickFilter")||this.rowModel.forEachNode(function(r){return r.quickFilterAggregateText=null})},h.prototype.getRangeSelections=function(){return console.warn("AG Grid: in v20.1.x, api.getRangeSelections() is gone, please use getCellRanges() instead.\n        We had to change how cell selections works a small bit to allow charting to integrate. The return type of\n        getCellRanges() is a bit different, please check the AG Grid documentation."),null},h.prototype.getCellRanges=function(){return this.rangeService?this.rangeService.getCellRanges():(console.warn("AG Grid: cell range selection is only available in AG Grid Enterprise"),null)},h.prototype.camelCaseToHumanReadable=function(r){return Ve(r)},h.prototype.addRangeSelection=function(r){console.warn("AG Grid: As of version 21.x, range selection changed slightly to allow charting integration. Please call api.addCellRange() instead of api.addRangeSelection()")},h.prototype.addCellRange=function(r){this.rangeService||console.warn("AG Grid: cell range selection is only available in AG Grid Enterprise"),this.rangeService.addCellRange(r)},h.prototype.clearRangeSelection=function(){this.rangeService||console.warn("AG Grid: cell range selection is only available in AG Grid Enterprise"),this.rangeService.removeAllCellRanges()},h.prototype.undoCellEditing=function(){this.undoRedoService.undo()},h.prototype.redoCellEditing=function(){this.undoRedoService.redo()},h.prototype.getCurrentUndoSize=function(){return this.undoRedoService.getCurrentUndoStackSize()},h.prototype.getCurrentRedoSize=function(){return this.undoRedoService.getCurrentRedoStackSize()},h.prototype.getChartModels=function(){if(ne.assertRegistered(e.GXE.RangeSelectionModule,"api.getChartModels")&&ne.assertRegistered(e.GXE.GridChartsModule,"api.getChartModels"))return this.chartService.getChartModels()},h.prototype.getChartRef=function(r){if(ne.assertRegistered(e.GXE.RangeSelectionModule,"api.getChartRef")&&ne.assertRegistered(e.GXE.GridChartsModule,"api.getChartRef"))return this.chartService.getChartRef(r)},h.prototype.getChartImageDataURL=function(r){if(ne.assertRegistered(e.GXE.RangeSelectionModule,"api.getChartImageDataURL")&&ne.assertRegistered(e.GXE.GridChartsModule,"api.getChartImageDataURL"))return this.chartService.getChartImageDataURL(r)},h.prototype.createRangeChart=function(r){if(ne.assertRegistered(e.GXE.RangeSelectionModule,"api.createRangeChart")&&ne.assertRegistered(e.GXE.GridChartsModule,"api.createRangeChart"))return this.chartService.createRangeChart(r)},h.prototype.createCrossFilterChart=function(r){if(ne.assertRegistered(e.GXE.RangeSelectionModule,"api.createCrossFilterChart")&&ne.assertRegistered(e.GXE.GridChartsModule,"api.createCrossFilterChart"))return this.chartService.createCrossFilterChart(r)},h.prototype.restoreChart=function(r,t){if(ne.assertRegistered(e.GXE.RangeSelectionModule,"api.restoreChart")&&ne.assertRegistered(e.GXE.GridChartsModule,"api.restoreChart"))return this.chartService.restoreChart(r,t)},h.prototype.createPivotChart=function(r){if(ne.assertRegistered(e.GXE.RangeSelectionModule,"api.createPivotChart")&&ne.assertRegistered(e.GXE.GridChartsModule,"api.createPivotChart"))return this.chartService.createPivotChart(r)},h.prototype.copySelectedRowsToClipboard=function(r,t){this.clipboardService||console.warn("AG Grid: clipboard is only available in AG Grid Enterprise"),this.clipboardService.copySelectedRowsToClipboard(r,t)},h.prototype.copySelectedRangeToClipboard=function(r){this.clipboardService||console.warn("AG Grid: clipboard is only available in AG Grid Enterprise"),this.clipboardService.copySelectedRangeToClipboard(r)},h.prototype.copySelectedRangeDown=function(){this.clipboardService||console.warn("AG Grid: clipboard is only available in AG Grid Enterprise"),this.clipboardService.copyRangeDown()},h.prototype.showColumnMenuAfterButtonClick=function(r,t){var n=this.columnModel.getGridColumn(r);this.menuFactory.showMenuAfterButtonClick(n,t,"columnMenu")},h.prototype.showColumnMenuAfterMouseClick=function(r,t){var n=this.columnModel.getGridColumn(r);n||(n=this.columnModel.getPrimaryColumn(r)),n?this.menuFactory.showMenuAfterMouseEvent(n,t):console.error("AG Grid: column '"+r+"' not found")},h.prototype.hidePopupMenu=function(){this.contextMenuFactory&&this.contextMenuFactory.hideActiveMenu(),this.menuFactory.hideActiveMenu()},h.prototype.setPopupParent=function(r){this.gridOptionsWrapper.setProperty(vr.PROP_POPUP_PARENT,r)},h.prototype.tabToNextCell=function(){return this.navigationService.tabToNextCell(!1)},h.prototype.tabToPreviousCell=function(){return this.navigationService.tabToNextCell(!0)},h.prototype.getCellRendererInstances=function(r){return void 0===r&&(r={}),this.rowRenderer.getCellRendererInstances(r)},h.prototype.getCellEditorInstances=function(r){return void 0===r&&(r={}),this.rowRenderer.getCellEditorInstances(r)},h.prototype.getEditingCells=function(){return this.rowRenderer.getEditingCells()},h.prototype.stopEditing=function(r){void 0===r&&(r=!1),this.rowRenderer.stopEditing(r)},h.prototype.startEditingCell=function(r){var t=this.columnModel.getGridColumn(r.colKey);if(t){var n={rowIndex:r.rowIndex,rowPinned:r.rowPinned||null,column:t};null==r.rowPinned&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(r.rowIndex);var f=this.navigationService.getCellByPosition(n);!f||f.startRowOrCellEdit(r.keyPress,r.charPress)}else console.warn("AG Grid: no column found for "+r.colKey)},h.prototype.addAggFunc=function(r,t){this.aggFuncService&&this.aggFuncService.addAggFunc(r,t)},h.prototype.addAggFuncs=function(r){this.aggFuncService&&this.aggFuncService.addAggFuncs(r)},h.prototype.clearAggFuncs=function(){this.aggFuncService&&this.aggFuncService.clear()},h.prototype.applyServerSideTransaction=function(r){if(this.serverSideTransactionManager)return this.serverSideTransactionManager.applyTransaction(r);console.warn("AG Grid: Cannot apply Server Side Transaction if not using the Server Side Row Model.")},h.prototype.applyServerSideTransactionAsync=function(r,t){if(this.serverSideTransactionManager)return this.serverSideTransactionManager.applyTransactionAsync(r,t);console.warn("AG Grid: Cannot apply Server Side Transaction if not using the Server Side Row Model.")},h.prototype.retryServerSideLoads=function(){this.serverSideRowModel?this.serverSideRowModel.retryLoads():console.warn("AG Grid: API retryServerSideLoads() can only be used when using Server-Side Row Model.")},h.prototype.flushServerSideAsyncTransactions=function(){if(this.serverSideTransactionManager)return this.serverSideTransactionManager.flushAsyncTransactions();console.warn("AG Grid: Cannot flush Server Side Transaction if not using the Server Side Row Model.")},h.prototype.applyTransaction=function(r){if(this.clientSideRowModel){var t=this.clientSideRowModel.updateRowData(r);return this.rowRenderer.refreshFullWidthRows(t.update),this.gridOptionsWrapper.isSuppressChangeDetection()||this.rowRenderer.refreshCells(),t}console.error("AG Grid: updateRowData() only works with ClientSideRowModel. Working with InfiniteRowModel was deprecated in v23.1 and removed in v24.1")},h.prototype.updateRowData=function(r){return Lt(function(){return console.warn("AG Grid: as of v23.1, grid API updateRowData(transaction) is now called applyTransaction(transaction). updateRowData is deprecated and will be removed in a future major release.")},"updateRowData deprecated"),this.applyTransaction(r)},h.prototype.applyTransactionAsync=function(r,t){this.clientSideRowModel?this.clientSideRowModel.batchUpdateRowData(r,t):console.error("AG Grid: api.applyTransactionAsync() only works with ClientSideRowModel.")},h.prototype.flushAsyncTransactions=function(){this.clientSideRowModel?this.clientSideRowModel.flushAsyncTransactions():console.error("AG Grid: api.applyTransactionAsync() only works with ClientSideRowModel.")},h.prototype.batchUpdateRowData=function(r,t){Lt(function(){return console.warn("AG Grid: as of v23.1, grid API batchUpdateRowData(transaction, callback) is now called applyTransactionAsync(transaction, callback). batchUpdateRowData is deprecated and will be removed in a future major release.")},"batchUpdateRowData deprecated"),this.applyTransactionAsync(r,t)},h.prototype.insertItemsAtIndex=function(r,t,n){console.warn("AG Grid: insertItemsAtIndex() is deprecated, use updateRowData(transaction) instead."),this.updateRowData({add:t,addIndex:r,update:null,remove:null})},h.prototype.removeItems=function(r,t){console.warn("AG Grid: removeItems() is deprecated, use updateRowData(transaction) instead.");var n=r.map(function(c){return c.data});this.updateRowData({add:null,addIndex:null,update:null,remove:n})},h.prototype.addItems=function(r,t){console.warn("AG Grid: addItems() is deprecated, use updateRowData(transaction) instead."),this.updateRowData({add:r,addIndex:null,update:null,remove:null})},h.prototype.refreshVirtualPageCache=function(){console.warn("AG Grid: refreshVirtualPageCache() is now called refreshInfiniteCache(), please call refreshInfiniteCache() instead"),this.refreshInfiniteCache()},h.prototype.refreshInfinitePageCache=function(){console.warn("AG Grid: refreshInfinitePageCache() is now called refreshInfiniteCache(), please call refreshInfiniteCache() instead"),this.refreshInfiniteCache()},h.prototype.refreshInfiniteCache=function(){this.infiniteRowModel?this.infiniteRowModel.refreshCache():console.warn("AG Grid: api.refreshInfiniteCache is only available when rowModelType='infinite'.")},h.prototype.purgeVirtualPageCache=function(){console.warn("AG Grid: purgeVirtualPageCache() is now called purgeInfiniteCache(), please call purgeInfiniteCache() instead"),this.purgeInfinitePageCache()},h.prototype.purgeInfinitePageCache=function(){console.warn("AG Grid: purgeInfinitePageCache() is now called purgeInfiniteCache(), please call purgeInfiniteCache() instead"),this.purgeInfiniteCache()},h.prototype.purgeInfiniteCache=function(){this.infiniteRowModel?this.infiniteRowModel.purgeCache():console.warn("AG Grid: api.purgeInfiniteCache is only available when rowModelType='infinite'.")},h.prototype.purgeEnterpriseCache=function(r){console.warn("ag-grid: since version 18.x, api.purgeEnterpriseCache() should be replaced with api.purgeServerSideCache()"),this.purgeServerSideCache(r)},h.prototype.purgeServerSideCache=function(r){void 0===r&&(r=[]),this.serverSideRowModel?(console.warn("AG Grid: since v25.0, api.purgeServerSideCache is deprecated. Please use api.refreshServerSideStore({purge: true}) instead."),this.refreshServerSideStore({route:r,purge:!0})):console.warn("AG Grid: api.purgeServerSideCache is only available when rowModelType='serverSide'.")},h.prototype.refreshServerSideStore=function(r){this.serverSideRowModel?this.serverSideRowModel.refreshStore(r):console.warn("AG Grid: api.refreshServerSideStore is only available when rowModelType='serverSide'.")},h.prototype.getServerSideStoreState=function(){return this.serverSideRowModel?this.serverSideRowModel.getStoreState():(console.warn("AG Grid: api.getServerSideStoreState is only available when rowModelType='serverSide'."),[])},h.prototype.getVirtualRowCount=function(){return console.warn("AG Grid: getVirtualRowCount() is now called getInfiniteRowCount(), please call getInfiniteRowCount() instead"),this.getInfiniteRowCount()},h.prototype.getInfiniteRowCount=function(){if(this.infiniteRowModel)return this.infiniteRowModel.getRowCount();console.warn("AG Grid: api.getVirtualRowCount is only available when rowModelType='virtual'.")},h.prototype.isMaxRowFound=function(){return console.warn("AG Grid: api.isLastRowIndexKnown is deprecated, please use api.isLastRowIndexKnown()"),this.isLastRowIndexKnown()},h.prototype.isLastRowIndexKnown=function(){if(this.infiniteRowModel)return this.infiniteRowModel.isLastRowIndexKnown();console.warn("AG Grid: api.isMaxRowFound is only available when rowModelType='virtual'.")},h.prototype.setVirtualRowCount=function(r,t){console.warn("AG Grid: setVirtualRowCount() is now called setInfiniteRowCount(), please call setInfiniteRowCount() instead"),this.setRowCount(r,t)},h.prototype.setInfiniteRowCount=function(r,t){console.warn("AG Grid: setInfiniteRowCount() is now called setRowCount(), please call setRowCount() instead"),this.setRowCount(r,t)},h.prototype.setRowCount=function(r,t){this.infiniteRowModel?this.infiniteRowModel.setRowCount(r,t):console.warn("AG Grid: api.setRowCount is only available for Infinite Row Model.")},h.prototype.getVirtualPageState=function(){return console.warn("AG Grid: getVirtualPageState() is now called getCacheBlockState(), please call getCacheBlockState() instead"),this.getCacheBlockState()},h.prototype.getInfinitePageState=function(){return console.warn("AG Grid: getInfinitePageState() is now called getCacheBlockState(), please call getCacheBlockState() instead"),this.getCacheBlockState()},h.prototype.getCacheBlockState=function(){return this.rowNodeBlockLoader.getBlockState()},h.prototype.checkGridSize=function(){console.warn("in AG Grid v25.2.0, checkGridSize() was removed, as it was legacy and didn't do anything uesful.")},h.prototype.getFirstRenderedRow=function(){return console.warn("in AG Grid v12, getFirstRenderedRow() was renamed to getFirstDisplayedRow()"),this.getFirstDisplayedRow()},h.prototype.getFirstDisplayedRow=function(){return this.rowRenderer.getFirstVirtualRenderedRow()},h.prototype.getLastRenderedRow=function(){return console.warn("in AG Grid v12, getLastRenderedRow() was renamed to getLastDisplayedRow()"),this.getLastDisplayedRow()},h.prototype.getLastDisplayedRow=function(){return this.rowRenderer.getLastVirtualRenderedRow()},h.prototype.getDisplayedRowAtIndex=function(r){return this.rowModel.getRow(r)},h.prototype.getDisplayedRowCount=function(){return this.rowModel.getRowCount()},h.prototype.paginationIsLastPageFound=function(){return this.paginationProxy.isLastPageFound()},h.prototype.paginationGetPageSize=function(){return this.paginationProxy.getPageSize()},h.prototype.paginationSetPageSize=function(r){this.gridOptionsWrapper.setProperty("paginationPageSize",r)},h.prototype.paginationGetCurrentPage=function(){return this.paginationProxy.getCurrentPage()},h.prototype.paginationGetTotalPages=function(){return this.paginationProxy.getTotalPages()},h.prototype.paginationGetRowCount=function(){return this.paginationProxy.getMasterRowCount()},h.prototype.paginationGoToNextPage=function(){this.paginationProxy.goToNextPage()},h.prototype.paginationGoToPreviousPage=function(){this.paginationProxy.goToPreviousPage()},h.prototype.paginationGoToFirstPage=function(){this.paginationProxy.goToFirstPage()},h.prototype.paginationGoToLastPage=function(){this.paginationProxy.goToLastPage()},h.prototype.paginationGoToPage=function(r){this.paginationProxy.goToPage(r)},_n([Nr("immutableService")],h.prototype,"immutableService",void 0),_n([Nr("csvCreator")],h.prototype,"csvCreator",void 0),_n([Nr("excelCreator")],h.prototype,"excelCreator",void 0),_n([Ee("rowRenderer")],h.prototype,"rowRenderer",void 0),_n([Ee("navigationService")],h.prototype,"navigationService",void 0),_n([Ee("filterManager")],h.prototype,"filterManager",void 0),_n([Ee("columnModel")],h.prototype,"columnModel",void 0),_n([Ee("selectionService")],h.prototype,"selectionService",void 0),_n([Ee("gridOptionsWrapper")],h.prototype,"gridOptionsWrapper",void 0),_n([Ee("valueService")],h.prototype,"valueService",void 0),_n([Ee("alignedGridsService")],h.prototype,"alignedGridsService",void 0),_n([Ee("eventService")],h.prototype,"eventService",void 0),_n([Ee("pinnedRowModel")],h.prototype,"pinnedRowModel",void 0),_n([Ee("context")],h.prototype,"context",void 0),_n([Ee("rowModel")],h.prototype,"rowModel",void 0),_n([Ee("sortController")],h.prototype,"sortController",void 0),_n([Ee("paginationProxy")],h.prototype,"paginationProxy",void 0),_n([Ee("focusService")],h.prototype,"focusService",void 0),_n([Ee("dragAndDropService")],h.prototype,"dragAndDropService",void 0),_n([Nr("rangeService")],h.prototype,"rangeService",void 0),_n([Nr("clipboardService")],h.prototype,"clipboardService",void 0),_n([Nr("aggFuncService")],h.prototype,"aggFuncService",void 0),_n([Ee("menuFactory")],h.prototype,"menuFactory",void 0),_n([Nr("contextMenuFactory")],h.prototype,"contextMenuFactory",void 0),_n([Ee("valueCache")],h.prototype,"valueCache",void 0),_n([Ee("animationFrameService")],h.prototype,"animationFrameService",void 0),_n([Nr("statusBarService")],h.prototype,"statusBarService",void 0),_n([Nr("chartService")],h.prototype,"chartService",void 0),_n([Nr("undoRedoService")],h.prototype,"undoRedoService",void 0),_n([Nr("rowNodeBlockLoader")],h.prototype,"rowNodeBlockLoader",void 0),_n([Nr("ssrmTransactionManager")],h.prototype,"serverSideTransactionManager",void 0),_n([Ee("ctrlsService")],h.prototype,"ctrlsService",void 0),_n([Nr("frameworkComponentWrapper")],h.prototype,"frameworkComponentWrapper",void 0),_n([zt],h.prototype,"init",null),_n([Ln],h.prototype,"cleanDownReferencesToAvoidMemoryLeakInCaseApplicationIsKeepingReferenceToDestroyedGrid",null),_n([Kt("gridApi")],h)}(),M2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Rd=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Dd=function(h,r){return function(t,n){r(t,n,h)}},Od=function(h){function r(){var t=null!==h&&h.apply(this,arguments)||this;return t.expressionToFunctionCache={},t}return M2(r,h),r.prototype.setBeans=function(t){this.logger=t.create("ExpressionService")},r.prototype.evaluate=function(t,n){return"function"==typeof t?t(n):"string"==typeof t?this.evaluateExpression(t,n):void console.error("AG Grid: value should be either a string or a function",t)},r.prototype.evaluateExpression=function(t,n){try{return this.createExpressionFunction(t)(n.value,n.context,n.oldValue,n.newValue,n.value,n.node,n.data,n.colDef,n.rowIndex,n.api,n.columnApi,n.getValue,n.column,n.columnGroup)}catch(y){return console.log("Processing of the expression failed"),console.log("Expression = "+t),console.log("Params =",n),console.log("Exception = "+y),null}},r.prototype.createExpressionFunction=function(t){if(this.expressionToFunctionCache[t])return this.expressionToFunctionCache[t];var n=this.createFunctionBody(t),c=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, columnApi, getValue, column, columnGroup",n);return this.expressionToFunctionCache[t]=c,c},r.prototype.createFunctionBody=function(t){return t.indexOf("return")>=0?t:"return "+t+";"},Rd([Dd(0,Dn("loggerFactory"))],r.prototype,"setBeans",null),Rd([Kt("expressionService")],r)}(ct),n5=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Pd=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},$v=function(h){function r(){var t=null!==h&&h.apply(this,arguments)||this;return t.templateCache={},t.waitingCallbacks={},t}return n5(r,h),r.prototype.getTemplate=function(t,n){var c=this.templateCache[t];if(c)return c;var f=this.waitingCallbacks[t],y=this;if(!f){this.waitingCallbacks[t]=f=[];var T=new XMLHttpRequest;T.onload=function(){y.handleHttpResult(this,t)},T.open("GET",t),T.send()}return n&&f.push(n),null},r.prototype.handleHttpResult=function(t,n){if(200===t.status&&null!==t.response){this.templateCache[n]=t.response||t.responseText;for(var c=this.waitingCallbacks[n],f=0;f<c.length;f++)(0,c[f])();if(this.$scope){var T=this;window.setTimeout(function(){T.$scope.$apply()},0)}}else console.warn("Unable to get template error "+t.status+" - "+n)},Pd([Ee("$scope")],r.prototype,"$scope",void 0),Pd([Kt("templateService")],r)}(ct),eg=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),pa=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},so=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}var t;return eg(r,h),t=r,r.addKeyboardModeEvents=function(n,c){var f=t.instancesMonitored.get(n);f&&f.length>0?-1===f.indexOf(c)&&f.push(c):(t.instancesMonitored.set(n,[c]),n.addEventListener("keydown",t.toggleKeyboardMode),n.addEventListener("mousedown",t.toggleKeyboardMode))},r.removeKeyboardModeEvents=function(n,c){var f=t.instancesMonitored.get(n),y=[];f&&f.length&&(y=function(){for(var h=0,r=0,t=arguments.length;r<t;r++)h+=arguments[r].length;var n=Array(h),c=0;for(r=0;r<t;r++)for(var f=arguments[r],y=0,T=f.length;y<T;y++,c++)n[c]=f[y];return n}(f).filter(function(T){return T!==c}),t.instancesMonitored.set(n,y)),0===y.length&&(n.removeEventListener("keydown",t.toggleKeyboardMode),n.removeEventListener("mousedown",t.toggleKeyboardMode))},r.toggleKeyboardMode=function(n){var c=t.keyboardModeActive,f="keydown"===n.type;if(!(f&&(n.ctrlKey||n.metaKey||n.altKey)||c&&f||!c&&!f)){t.keyboardModeActive=f;var y=n.target.ownerDocument;if(y){var T=t.instancesMonitored.get(y);T&&T.forEach(function(B){B.dispatchEvent({type:f?Ge.EVENT_KEYBOARD_FOCUS:Ge.EVENT_MOUSE_FOCUS})})}}},r.prototype.init=function(){var n=this,c=this.clearFocusedCell.bind(this);this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_PIVOT_MODE_CHANGED,c),this.addManagedListener(this.eventService,Ge.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverythingChanged.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_GROUP_OPENED,c),this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_ROW_GROUP_CHANGED,c),this.ctrlsService.whenReady(function(f){n.gridCtrl=f.gridCtrl;var y=n.gridOptionsWrapper.getDocument();t.addKeyboardModeEvents(y,n.gridCtrl),n.addDestroyFunc(function(){return n.unregisterGridCompController(n.gridCtrl)})})},r.prototype.unregisterGridCompController=function(n){var c=this.gridOptionsWrapper.getDocument();t.removeKeyboardModeEvents(c,n)},r.prototype.onColumnEverythingChanged=function(){if(this.focusedCellPosition){var n=this.focusedCellPosition.column,c=this.columnModel.getGridColumn(n.getId());n!==c&&this.clearFocusedCell()}},r.prototype.isKeyboardMode=function(){return t.keyboardModeActive},r.prototype.getFocusCellToUseAfterRefresh=function(){return this.gridOptionsWrapper.isSuppressFocusAfterRefresh()||!this.focusedCellPosition||this.isDomDataMissingInHierarchy(document.activeElement,Os.DOM_DATA_KEY_ROW_CTRL)?null:this.focusedCellPosition},r.prototype.getFocusHeaderToUseAfterRefresh=function(){return this.gridOptionsWrapper.isSuppressFocusAfterRefresh()||!this.focusedHeaderPosition||this.isDomDataMissingInHierarchy(document.activeElement,a0.DOM_DATA_KEY_HEADER_CTRL)?null:this.focusedHeaderPosition},r.prototype.isDomDataMissingInHierarchy=function(n,c){for(var f=n;f;){if(this.gridOptionsWrapper.getDomData(f,c))return!1;f=f.parentNode}return!0},r.prototype.clearFocusedCell=function(){this.focusedCellPosition=null,this.onCellFocused(!1)},r.prototype.getFocusedCell=function(){return this.focusedCellPosition},r.prototype.setFocusedCell=function(n,c,f,y){void 0===y&&(y=!1);var T=this.columnModel.getGridColumn(c);T?(this.focusedCellPosition=T?{rowIndex:n,rowPinned:d(f),column:T}:null,this.onCellFocused(y)):this.focusedCellPosition=null},r.prototype.isCellFocused=function(n){return null!=this.focusedCellPosition&&this.focusedCellPosition.column===n.column&&this.isRowFocused(n.rowIndex,n.rowPinned)},r.prototype.isRowNodeFocused=function(n){return this.isRowFocused(n.rowIndex,n.rowPinned)},r.prototype.isHeaderWrapperFocused=function(n){if(null==this.focusedHeaderPosition)return!1;var c=n.getColumnGroupChild(),f=n.getRowIndex(),y=n.getPinned(),T=this.focusedHeaderPosition,B=T.column;return c===B&&f===T.headerRowIndex&&y==B.getPinned()},r.prototype.clearFocusedHeader=function(){this.focusedHeaderPosition=null},r.prototype.getFocusedHeader=function(){return this.focusedHeaderPosition},r.prototype.setFocusedHeader=function(n,c){this.focusedHeaderPosition={headerRowIndex:n,column:c}},r.prototype.focusHeaderPosition=function(n){var c=n.direction,f=n.fromTab,T=n.event,B=n.headerPosition;if(n.allowUserOverride){var ke,q=this.gridOptionsWrapper,de=this.getFocusedHeader(),Se=this.headerNavigationService.getHeaderRowCount();f?(ke=q.getTabToNextHeaderFunc())&&(B=ke({backwards:"Before"===c,previousHeaderPosition:de,nextHeaderPosition:B,headerRowCount:Se,api:q.getApi(),columnApi:q.getColumnApi()})):(ke=q.getNavigateToNextHeaderFunc())&&T&&(B=ke({key:T.key,previousHeaderPosition:de,nextHeaderPosition:B,headerRowCount:Se,event:T,api:q.getApi(),columnApi:q.getColumnApi()}))}return!!B&&(-1===B.headerRowIndex?this.focusGridView(B.column):(this.headerNavigationService.scrollToColumn(B.column,c),this.ctrlsService.getHeaderRowContainerCtrl(B.column.getPinned()).focusHeader(B.headerRowIndex,B.column,T)))},r.prototype.isAnyCellFocused=function(){return!!this.focusedCellPosition},r.prototype.isRowFocused=function(n,c){return null!=this.focusedCellPosition&&this.focusedCellPosition.rowIndex===n&&this.focusedCellPosition.rowPinned===d(c)},r.prototype.findFocusableElements=function(n,c,f){void 0===f&&(f=!1);var T=W.FOCUSABLE_EXCLUDE;c&&(T+=", "+c),f&&(T+=', [tabindex="-1"]');var je,B=Array.prototype.slice.apply(n.querySelectorAll(W.FOCUSABLE_SELECTOR)),q=Array.prototype.slice.apply(n.querySelectorAll(T));return q.length?(je=q,B.filter(function(Qe){return-1===je.indexOf(Qe)})):B},r.prototype.focusInto=function(n,c,f){void 0===c&&(c=!1),void 0===f&&(f=!1);var y=this.findFocusableElements(n,null,f),T=c?H(y):y[0];return!!T&&(T.focus(),!0)},r.prototype.findNextFocusableElement=function(n,c,f){var y=this.findFocusableElements(n,c?':not([tabindex="-1"])':null),B=(c?$(y,function(q){return q.contains(document.activeElement)}):y.indexOf(document.activeElement))+(f?-1:1);return B<0||B>=y.length?null:y[B]},r.prototype.isFocusUnderManagedComponent=function(n){var c=n.querySelectorAll("."+Qo.FOCUS_MANAGED_CLASS);if(!c.length)return!1;for(var f=0;f<c.length;f++)if(c[f].contains(document.activeElement))return!0;return!1},r.prototype.findTabbableParent=function(n,c){void 0===c&&(c=5);for(var f=0;n&&null===H0(n)&&++f<=c;)n=n.parentElement;return null===H0(n)?null:n},r.prototype.onCellFocused=function(n){var c={type:Ge.EVENT_CELL_FOCUSED,forceBrowserFocus:n,rowIndex:null,column:null,floating:null,api:this.gridApi,columnApi:this.columnApi,rowPinned:null,isFullWidthCell:!1};if(this.focusedCellPosition){var f=c.rowIndex=this.focusedCellPosition.rowIndex,y=c.rowPinned=this.focusedCellPosition.rowPinned;c.column=this.focusedCellPosition.column;var T=this.rowRenderer.getRowByPosition({rowIndex:f,rowPinned:y});T&&(c.isFullWidthCell=T.isFullWidth())}this.eventService.dispatchEvent(c)},r.prototype.focusGridView=function(n,c){var f=c?this.rowPositionUtils.getLastRow():this.rowPositionUtils.getFirstRow();if(!f)return!1;var y=f.rowIndex,T=f.rowPinned,B=this.getFocusedHeader();return!n&&B&&(n=B.column),!(null==y||!n)&&(this.navigationService.ensureCellVisible({rowIndex:y,column:n,rowPinned:T}),this.setFocusedCell(y,n,d(T),!0),this.rangeService&&this.rangeService.setRangeToCell({rowIndex:y,rowPinned:T,column:n}),!0)},r.prototype.focusNextGridCoreContainer=function(n){return!!this.gridCtrl.focusNextInnerContainer(n)||(n||this.gridCtrl.forceFocusOutOfContainer(),!1)},r.AG_KEYBOARD_FOCUS="ag-keyboard-focus",r.keyboardModeActive=!1,r.instancesMonitored=new Map,pa([Ee("columnModel")],r.prototype,"columnModel",void 0),pa([Ee("headerNavigationService")],r.prototype,"headerNavigationService",void 0),pa([Ee("columnApi")],r.prototype,"columnApi",void 0),pa([Ee("gridApi")],r.prototype,"gridApi",void 0),pa([Ee("rowRenderer")],r.prototype,"rowRenderer",void 0),pa([Ee("rowPositionUtils")],r.prototype,"rowPositionUtils",void 0),pa([Nr("rangeService")],r.prototype,"rangeService",void 0),pa([Ee("navigationService")],r.prototype,"navigationService",void 0),pa([Ee("ctrlsService")],r.prototype,"ctrlsService",void 0),pa([zt],r.prototype,"init",null),t=pa([Kt("focusService")],r)}(ct),E2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),iu=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},ns=function(){return function(h){h[h.vertical=0]="vertical",h[h.horizontal=1]="horizontal"}(ns||(ns={})),ns}(),R2=0,tg=function(h){function r(){var t=null!==h&&h.apply(this,arguments)||this;return t.popupList=[],t}return E2(r,h),r.prototype.postConstruct=function(){var t=this;this.ctrlsService.whenReady(function(n){t.gridCtrl=n.gridCtrl,t.addManagedListener(t.gridCtrl,Ge.EVENT_KEYBOARD_FOCUS,function(){se(t.popupList,function(c){return Er(c.element,so.AG_KEYBOARD_FOCUS)})}),t.addManagedListener(t.gridCtrl,Ge.EVENT_MOUSE_FOCUS,function(){se(t.popupList,function(c){return zi(c.element,so.AG_KEYBOARD_FOCUS)})})})},r.prototype.getPopupParent=function(){return this.gridOptionsWrapper.getPopupParent()||this.gridCtrl.getGui()},r.prototype.positionPopupForMenu=function(t){var n=t.eventSource.getBoundingClientRect(),c=this.getParentRect(),f=this.keepXYWithinBounds(t.ePopup,n.top-c.top,ns.vertical),y=t.ePopup.clientWidth>0?t.ePopup.clientWidth:200;t.ePopup.style.minWidth=y+"px";var q,B=c.right-c.left-y;function de(){return n.right-c.left-2}function Se(){return n.left-c.left-y}this.gridOptionsWrapper.isEnableRtl()?((q=Se())<0&&(q=de()),q>B&&(q=0)):((q=de())>B&&(q=Se()),q<0&&(q=0)),t.ePopup.style.left=q+"px",t.ePopup.style.top=f+"px"},r.prototype.positionPopupUnderMouseEvent=function(t){var n=t.ePopup,c=t.nudgeX,f=t.nudgeY,y=this.calculatePointerAlign(t.mouseEvent);this.positionPopup({ePopup:n,x:y.x,y:y.y,nudgeX:c,nudgeY:f,keepWithinBounds:!0}),this.callPostProcessPopup(t.type,t.ePopup,null,t.mouseEvent,t.column,t.rowNode)},r.prototype.calculatePointerAlign=function(t){var n=this.getParentRect();return{x:t.clientX-n.left,y:t.clientY-n.top}},r.prototype.positionPopupUnderComponent=function(t){var n=t.eventSource.getBoundingClientRect(),c=t.alignSide||"left",f=this.getParentRect(),y=n.left-f.left;"right"===c&&(y-=t.ePopup.offsetWidth-n.width),this.positionPopup({ePopup:t.ePopup,nudgeX:t.nudgeX,nudgeY:t.nudgeY,x:y,y:n.top-f.top+n.height,keepWithinBounds:t.keepWithinBounds}),this.callPostProcessPopup(t.type,t.ePopup,t.eventSource,null,t.column,t.rowNode)},r.prototype.positionPopupOverComponent=function(t){var n=t.eventSource.getBoundingClientRect(),c=this.getParentRect();this.positionPopup({ePopup:t.ePopup,nudgeX:t.nudgeX,nudgeY:t.nudgeY,x:n.left-c.left,y:n.top-c.top,keepWithinBounds:t.keepWithinBounds}),this.callPostProcessPopup(t.type,t.ePopup,t.eventSource,null,t.column,t.rowNode)},r.prototype.callPostProcessPopup=function(t,n,c,f,y,T){var B=this.gridOptionsWrapper.getPostProcessPopupFunc();B&&B({column:y,rowNode:T,ePopup:n,type:t,eventSource:c,mouseEvent:f})},r.prototype.positionPopup=function(t){var n=t.ePopup,f=t.nudgeX,y=t.nudgeY,T=t.x,B=t.y;f&&(T+=f),y&&(B+=y),t.keepWithinBounds&&(T=this.keepXYWithinBounds(n,T,ns.horizontal),B=this.keepXYWithinBounds(n,B,ns.vertical)),n.style.left=T+"px",n.style.top=B+"px"},r.prototype.getActivePopups=function(){return this.popupList.map(function(t){return t.element})},r.prototype.getPopupList=function(){return this.popupList},r.prototype.getParentRect=function(){var t=this.gridOptionsWrapper.getDocument(),n=this.getPopupParent();n===t.body&&(n=t.documentElement);var c=getComputedStyle(n),f=n.getBoundingClientRect();return{top:f.top+parseFloat(c.borderTopWidth)||0,left:f.left+parseFloat(c.borderLeftWidth)||0,right:f.right+parseFloat(c.borderRightWidth)||0,bottom:f.bottom+parseFloat(c.borderBottomWidth)||0}},r.prototype.keepXYWithinBounds=function(t,n,c){var f=c===ns.vertical,y=f?"clientHeight":"clientWidth",T=f?"top":"left",B=f?"offsetHeight":"offsetWidth",q=f?"scrollTop":"scrollLeft",de=this.gridOptionsWrapper.getDocument(),Se=de.documentElement,ke=this.getPopupParent(),je=ke.getBoundingClientRect(),Qe=de.documentElement.getBoundingClientRect(),rt=ke===de.body,_t=t[B],Ut=rt?(f?el:z0)(Se)+Se[q]:ke[y];rt&&(Ut-=Math.abs(Qe[T]-je[T]));var Rt=Ut-_t;return Math.min(Math.max(n,0),Math.abs(Rt))},r.prototype.keepPopupPositionedRelativeTo=function(t){var n=this,c=this.getPopupParent(),f=c.getBoundingClientRect(),y=t.element.getBoundingClientRect(),T=f.top-y.top,B=f.left-y.left,q=T,de=B,Se=t.ePopup.style.top,ke=parseInt(Se.substring(0,Se.length-1),10),je=t.ePopup.style.left,Qe=parseInt(je.substring(0,je.length-1),10);return new Di(function(rt){n.getFrameworkOverrides().setInterval(function(){var _t=c.getBoundingClientRect(),Vt=t.element.getBoundingClientRect();if(0==Vt.top&&0==Vt.left&&0==Vt.height&&0==Vt.width)t.hidePopup();else{var Rt=_t.top-Vt.top;if(Rt!=q){var qt=n.keepXYWithinBounds(t.ePopup,ke+T-Rt,ns.vertical);t.ePopup.style.top=qt+"px"}q=Rt;var It=_t.left-Vt.left;if(It!=de){var on=n.keepXYWithinBounds(t.ePopup,Qe+B-It,ns.horizontal);t.ePopup.style.left=on+"px"}de=It}},200).then(function(_t){rt(function(){null!=_t&&window.clearInterval(_t)})})})},r.prototype.addPopup=function(t){var n=this,c=t.modal,f=t.eChild,y=t.closeOnEsc,T=t.closedCallback,B=t.click,q=t.alwaysOnTop,de=t.afterGuiAttached,Se=t.positionCallback,ke=t.anchorToElement,je=t.ariaLabel,Qe=this.gridOptionsWrapper.getDocument(),rt=new Di(function(kn){return kn(function(){})});if(!Qe)return console.warn("ag-grid: could not find the document, document is empty"),{hideFunc:function(){},stopAnchoringPromise:rt};var _t=$(this.popupList,function(kn){return kn.element===f});if(-1!==_t){var Vt=this.popupList[_t];return{hideFunc:Vt.hideFunc,stopAnchoringPromise:Vt.stopAnchoringPromise}}var Ut=this.getPopupParent();null==f.style.top&&(f.style.top="0px"),null==f.style.left&&(f.style.left="0px");var Rt=document.createElement("div"),qt=this.environment.getTheme().theme;qt&&Er(Rt,qt),Er(Rt,"ag-popup"),Er(f,this.gridOptionsWrapper.isEnableRtl()?"ag-rtl":"ag-ltr"),Er(f,"ag-popup-child"),co(f,"dialog"),Da(f,je),this.focusService.isKeyboardMode()&&Er(f,so.AG_KEYBOARD_FOCUS),Rt.appendChild(f),Ut.appendChild(Rt),q?this.setAlwaysOnTop(Rt,!0):this.bringPopupToFront(Rt);var It=!1,on=function(Yn){Rt.contains(document.activeElement)&&(Yn.which||Yn.keyCode)===Yt.ESCAPE&&In({keyboardEvent:Yn})},Br=function(Yn){return In({mouseEvent:Yn})},gn=function(Yn){return In({touchEvent:Yn})},In=function(Yn){void 0===Yn&&(Yn={});var ei=Yn.mouseEvent,yo=Yn.touchEvent,aa=Yn.keyboardEvent;n.isEventFromCurrentPopup({mouseEvent:ei,touchEvent:yo},f)||n.isEventSameChainAsOriginalEvent({originalMouseEvent:B,mouseEvent:ei,touchEvent:yo})||It||(It=!0,Ut.removeChild(Rt),Qe.removeEventListener("keydown",on),Qe.removeEventListener("mousedown",Br),Qe.removeEventListener("touchstart",gn),Qe.removeEventListener("contextmenu",Br),n.eventService.removeEventListener(Ge.EVENT_DRAG_STARTED,Br),T&&T(ei||yo||aa),n.popupList=n.popupList.filter(function(Ai){return Ai.element!==f}),rt&&rt.then(function(Ai){return Ai&&Ai()}))};return de&&de({hidePopup:In}),window.setTimeout(function(){y&&Qe.addEventListener("keydown",on),c&&(Qe.addEventListener("mousedown",Br),n.eventService.addEventListener(Ge.EVENT_DRAG_STARTED,Br),Qe.addEventListener("touchstart",gn),Qe.addEventListener("contextmenu",Br))},0),Se&&Se(),ke&&(rt=this.keepPopupPositionedRelativeTo({element:ke,ePopup:f,hidePopup:In})),this.popupList.push({element:f,wrapper:Rt,hideFunc:In,stopAnchoringPromise:rt,instanceId:R2++,isAnchored:!!ke}),{hideFunc:In,stopAnchoringPromise:rt}},r.prototype.hasAnchoredPopup=function(){return Z(this.popupList,function(t){return t.isAnchored})},r.prototype.isEventFromCurrentPopup=function(t,n){var y=t.mouseEvent||t.touchEvent;if(!y)return!1;var T=$(this.popupList,function(de){return de.element===n});if(-1===T)return!1;for(var B=T;B<this.popupList.length;B++)if(st(this.popupList[B].element,y))return!0;return this.isElementWithinCustomPopup(y.target)},r.prototype.isElementWithinCustomPopup=function(t){for(;t&&t!==document.body;){if(t.classList.contains("ag-custom-component-popup")||null===t.parentElement)return!0;t=t.parentElement}return!1},r.prototype.isEventSameChainAsOriginalEvent=function(t){var n=t.originalMouseEvent,c=t.mouseEvent,f=t.touchEvent,y=null;if(c?y=c:f&&(y=f.touches[0]),y&&n){var B=c?c.screenY:0,q=Math.abs(n.screenX-(c?c.screenX:0))<5,de=Math.abs(n.screenY-B)<5;if(q&&de)return!0}return!1},r.prototype.getWrapper=function(t){for(;!qa(t,"ag-popup")&&t.parentElement;)t=t.parentElement;return qa(t,"ag-popup")?t:null},r.prototype.setAlwaysOnTop=function(t,n){var c=this.getWrapper(t);!c||(Fr(c,"ag-always-on-top",!!n),n&&this.bringPopupToFront(c))},r.prototype.bringPopupToFront=function(t){var n=this.getPopupParent(),c=Array.prototype.slice.call(n.querySelectorAll(".ag-popup")),f=c.length,y=Array.prototype.slice.call(n.querySelectorAll(".ag-popup.ag-always-on-top")),T=y.length,B=this.getWrapper(t);if(B&&!(f<=1)&&n.contains(t)){var q=c.indexOf(B);T?qa(B,"ag-always-on-top")?q!==f-1&&H(y).insertAdjacentElement("afterend",B):q!==f-T-1&&y[0].insertAdjacentElement("beforebegin",B):q!==f-1&&H(c).insertAdjacentElement("afterend",B);var Se={type:"popupToFront",api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi(),eWrapper:B};this.eventService.dispatchEvent(Se)}},iu([Ee("environment")],r.prototype,"environment",void 0),iu([Ee("focusService")],r.prototype,"focusService",void 0),iu([Ee("ctrlsService")],r.prototype,"ctrlsService",void 0),iu([zt],r.prototype,"postConstruct",null),iu([Kt("popupService")],r)}(ct),D2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Fd=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},O2=function(h,r){return function(t,n){r(t,n,h)}},rg=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return D2(r,h),r.prototype.setBeans=function(t){this.logging=t.isDebug()},r.prototype.create=function(t){return new Ic(t,this.isLogging.bind(this))},r.prototype.isLogging=function(){return this.logging},Fd([O2(0,Dn("gridOptionsWrapper"))],r.prototype,"setBeans",null),Fd([Kt("loggerFactory")],r)}(ct),Ic=function(){function h(r,t){this.name=r,this.isLoggingFunc=t}return h.prototype.isLogging=function(){return this.isLoggingFunc()},h.prototype.log=function(r){this.isLoggingFunc()&&console.log("AG Grid."+this.name+": "+r)},h}(),nn=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),wt=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Ld=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return nn(r,h),r.prototype.postConstruct=function(){var t=this;this.ctrlsService.whenReady(function(n){t.centerRowContainerCon=n.centerRowContainerCtrl})},r.prototype.getPreferredWidthForColumn=function(t,n){var c=this.getHeaderCellForColumn(t);if(!c)return-1;var f=document.createElement("span");f.style.position="fixed";var y=this.centerRowContainerCon.getContainerElement();y.appendChild(f),this.putRowCellsIntoDummyContainer(t,f),n||this.cloneItemIntoDummy(c,f);var T=f.offsetWidth;return y.removeChild(f),T+this.gridOptionsWrapper.getAutoSizePadding()},r.prototype.getHeaderCellForColumn=function(t){var n=null;return this.ctrlsService.getHeaderRowContainerCtrls().forEach(function(c){var f=c.getHtmlElementForColumnHeader(t);null!=f&&(n=f)}),n},r.prototype.putRowCellsIntoDummyContainer=function(t,n){var c=this;this.rowRenderer.getAllCellsForColumn(t).forEach(function(y){return c.cloneItemIntoDummy(y,n)})},r.prototype.cloneItemIntoDummy=function(t,n){var c=t.cloneNode(!0);c.style.width="",c.style.position="static",c.style.left="";var f=document.createElement("div");qa(c,"ag-header-cell")?(Er(f,"ag-header"),Er(f,"ag-header-row"),f.style.position="static"):Er(f,"ag-row");for(var y=t.parentElement;y;){if(y.classList.contains("ag-header-row")||y.classList.contains("ag-row")){for(var T=0;T<y.classList.length;T++){var B=y.classList[T];"ag-row-position-absolute"!=B&&Er(f,B)}break}y=y.parentElement}f.style.display="table-row",f.appendChild(c),n.appendChild(f)},wt([Ee("rowRenderer")],r.prototype,"rowRenderer",void 0),wt([Ee("ctrlsService")],r.prototype,"ctrlsService",void 0),wt([Ee("rowCssClassCalculator")],r.prototype,"rowCssClassCalculator",void 0),wt([zt],r.prototype,"postConstruct",null),wt([Kt("autoWidthCalculator")],r)}(ct),ng=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),ou=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},ta=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return ng(r,h),r.prototype.addResizeBar=function(t){var n=this,c={dragStartPixels:t.dragStartPixels||0,eElement:t.eResizeBar,onDragStart:this.onDragStart.bind(this,t),onDragStop:this.onDragStop.bind(this,t),onDragging:this.onDragging.bind(this,t)};return this.dragService.addDragSource(c,!0),function(){return n.dragService.removeDragSource(c)}},r.prototype.onDragStart=function(t,n){this.dragStartX=n.clientX,this.setResizeIcons();var c=n instanceof MouseEvent&&!0===n.shiftKey;t.onResizeStart(c)},r.prototype.setResizeIcons=function(){var t=this.ctrlsService.getGridCtrl();t.setResizeCursor(!0),t.disableUserSelect(!0)},r.prototype.onDragStop=function(t,n){t.onResizeEnd(this.resizeAmount),this.resetIcons()},r.prototype.resetIcons=function(){var t=this.ctrlsService.getGridCtrl();t.setResizeCursor(!1),t.disableUserSelect(!1)},r.prototype.onDragging=function(t,n){this.resizeAmount=n.clientX-this.dragStartX,t.onResizing(this.resizeAmount)},ou([Ee("dragService")],r.prototype,"dragService",void 0),ou([Ee("ctrlsService")],r.prototype,"ctrlsService",void 0),ou([Kt("horizontalResizeService")],r)}(ct),ig=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ls=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},kc=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return ig(r,h),r.prototype.postConstruct=function(){this.ctrlsService.registerGridCtrl(this)},r.prototype.setComp=function(t,n,c){var f=this;this.view=t,this.eGridHostDiv=n,this.eGui=c,this.mouseEventService.stampTopLevelGridCompWithGridInstance(n),this.createManagedBean(new pl(this.view)),this.addRtlSupport(),this.addManagedListener(this,Ge.EVENT_KEYBOARD_FOCUS,function(){f.view.addOrRemoveKeyboardFocusClass(!0)}),this.addManagedListener(this,Ge.EVENT_MOUSE_FOCUS,function(){f.view.addOrRemoveKeyboardFocusClass(!1)});var y=this.resizeObserverService.observeResize(this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc(function(){return y()})},r.prototype.showDropZones=function(){return ne.isRegistered(e.GXE.RowGroupingModule)},r.prototype.showSideBar=function(){return ne.isRegistered(e.GXE.SideBarModule)},r.prototype.showStatusBar=function(){return ne.isRegistered(e.GXE.StatusBarModule)},r.prototype.showWatermark=function(){return ne.isRegistered(e.GXE.EnterpriseCoreModule)},r.prototype.onGridSizeChanged=function(){this.eventService.dispatchEvent({type:Ge.EVENT_GRID_SIZE_CHANGED,api:this.gridApi,columnApi:this.columnApi,clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight})},r.prototype.addRtlSupport=function(){var t=this.gridOptionsWrapper.isEnableRtl()?"ag-rtl":"ag-ltr";this.view.setRtlClass(t)},r.prototype.destroyGridUi=function(){this.view.destroyGridUi()},r.prototype.getGui=function(){return this.eGui},r.prototype.setResizeCursor=function(t){this.view.setCursor(t?"ew-resize":null)},r.prototype.disableUserSelect=function(t){this.view.setUserSelect(t?"none":null)},r.prototype.focusNextInnerContainer=function(t){var n=this.view.getFocusableContainers(),f=$(n,function(y){return y.contains(document.activeElement)})+(t?-1:1);return!(f<0||f>=n.length)&&(0===f?this.focusGridHeader():this.focusService.focusInto(n[f]))},r.prototype.focusInnerElement=function(t){var n=this.view.getFocusableContainers();if(t){if(n.length>1)return this.focusService.focusInto(H(n),!0);var c=H(this.columnModel.getAllDisplayedColumns());if(this.focusService.focusGridView(c,!0))return!0}return this.focusGridHeader()},r.prototype.focusGridHeader=function(){var t=this.columnModel.getAllDisplayedColumns()[0];return!!t&&(t.getParent()&&(t=this.columnModel.getColumnGroupAtLevel(t,0)),this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:0,column:t}}),!0)},r.prototype.forceFocusOutOfContainer=function(t){void 0===t&&(t=!1),this.view.forceFocusOutOfContainer(t)},Ls([Ee("columnApi")],r.prototype,"columnApi",void 0),Ls([Ee("gridApi")],r.prototype,"gridApi",void 0),Ls([Ee("focusService")],r.prototype,"focusService",void 0),Ls([Ee("resizeObserverService")],r.prototype,"resizeObserverService",void 0),Ls([Ee("columnModel")],r.prototype,"columnModel",void 0),Ls([Ee("ctrlsService")],r.prototype,"ctrlsService",void 0),Ls([Ee("mouseEventService")],r.prototype,"mouseEventService",void 0),Ls([zt],r.prototype,"postConstruct",null),r}(ct),is=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Bc=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Nd=function(h){function r(t){var n=h.call(this)||this;n.skipTabGuardFocus=!1;var f=t.eTopGuard,y=t.eBottomGuard,T=t.focusInnerElement,B=t.onFocusIn,q=t.onFocusOut,de=t.shouldStopEventPropagation,Se=t.onTabKeyDown,ke=t.handleKeyDown,je=t.eFocusableElement;return n.comp=t.comp,n.eTopGuard=f,n.eBottomGuard=y,n.providedFocusInnerElement=T,n.eFocusableElement=je,n.providedFocusIn=B,n.providedFocusOut=q,n.providedShouldStopEventPropagation=de,n.providedOnTabKeyDown=Se,n.providedHandleKeyDown=ke,n}return is(r,h),r.prototype.postConstruct=function(){var t=this;this.createManagedBean(new Qo(this.eFocusableElement,{shouldStopEventPropagation:function(){return t.shouldStopEventPropagation()},onTabKeyDown:function(c){return t.onTabKeyDown(c)},handleKeyDown:function(c){return t.handleKeyDown(c)},onFocusIn:function(c){return t.onFocusIn(c)},onFocusOut:function(c){return t.onFocusOut(c)}})),this.activateTabGuards(),[this.eTopGuard,this.eBottomGuard].forEach(function(n){return t.addManagedListener(n,"focus",t.onFocus.bind(t))})},r.prototype.handleKeyDown=function(t){this.providedHandleKeyDown&&this.providedHandleKeyDown(t)},r.prototype.tabGuardsAreActive=function(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")},r.prototype.shouldStopEventPropagation=function(){return!!this.providedShouldStopEventPropagation&&this.providedShouldStopEventPropagation()},r.prototype.activateTabGuards=function(){this.comp.setTabIndex(this.getGridTabIndex())},r.prototype.deactivateTabGuards=function(){this.comp.setTabIndex()},r.prototype.onFocus=function(t){if(this.skipTabGuardFocus)this.skipTabGuardFocus=!1;else{var n=t.target===this.eBottomGuard;this.providedFocusInnerElement?this.providedFocusInnerElement(n):this.focusInnerElement(n)}},r.prototype.onFocusIn=function(t){this.providedFocusIn&&this.providedFocusIn(t)||this.deactivateTabGuards()},r.prototype.onFocusOut=function(t){this.providedFocusOut&&this.providedFocusOut(t)||this.eFocusableElement.contains(t.relatedTarget)||this.activateTabGuards()},r.prototype.onTabKeyDown=function(t){var n=this;if(this.providedOnTabKeyDown)this.providedOnTabKeyDown(t);else if(!t.defaultPrevented){var c=this.tabGuardsAreActive();c&&this.deactivateTabGuards();var f=this.getNextFocusableElement(t.shiftKey);c&&setTimeout(function(){return n.activateTabGuards()},0),f&&(f.focus(),t.preventDefault())}},r.prototype.getGridTabIndex=function(){return this.gridOptionsWrapper.getGridTabIndex()},r.prototype.focusInnerElement=function(t){void 0===t&&(t=!1);var n=this.focusService.findFocusableElements(this.eFocusableElement);this.tabGuardsAreActive()&&(n.splice(0,1),n.splice(n.length-1,1)),n.length&&n[t?n.length-1:0].focus()},r.prototype.getNextFocusableElement=function(t){return this.focusService.findNextFocusableElement(this.eFocusableElement,!1,t)},r.prototype.forceFocusOutOfContainer=function(t){void 0===t&&(t=!1);var n=t?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,n.focus()},Bc([Ee("focusService")],r.prototype,"focusService",void 0),Bc([zt],r.prototype,"postConstruct",null),r}(ct),Id=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),og=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return Id(r,h),r.prototype.initialiseTabGuard=function(t){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.getFocusableElement();var n=[this.eTopGuard,this.eBottomGuard],c={setTabIndex:function(y){n.forEach(function(T){return null!=y?T.setAttribute("tabIndex",y):T.removeAttribute("tabIndex")})}};this.addTabGuards(this.eTopGuard,this.eBottomGuard),this.tabGuardCtrl=this.createManagedBean(new Nd({comp:c,eTopGuard:this.eTopGuard,eBottomGuard:this.eBottomGuard,eFocusableElement:this.eFocusableElement,onFocusIn:t.onFocusIn,onFocusOut:t.onFocusOut,focusInnerElement:t.focusInnerElement,handleKeyDown:t.handleKeyDown,onTabKeyDown:t.onTabKeyDown,shouldStopEventPropagation:t.shouldStopEventPropagation}))},r.prototype.createTabGuard=function(t){var n=document.createElement("div");return n.classList.add("ag-tab-guard"),n.classList.add("ag-tab-guard-"+t),co(n,"presentation"),n},r.prototype.addTabGuards=function(t,n){this.eFocusableElement.insertAdjacentElement("afterbegin",t),this.eFocusableElement.insertAdjacentElement("beforeend",n)},r.prototype.removeAllChildrenExceptTabGuards=function(){var t=[this.eTopGuard,this.eBottomGuard];So(this.getFocusableElement()),this.addTabGuards.apply(this,t)},r.prototype.forceFocusOutOfContainer=function(t){void 0===t&&(t=!1),this.tabGuardCtrl.forceFocusOutOfContainer(t)},r.prototype.appendChild=function(t,n){Ea(t)||(t=t.getGui());var c=this.eBottomGuard;c?c.insertAdjacentElement("beforebegin",t):h.prototype.appendChild.call(this,t,n)},r}(dn),ag=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Gc=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},d0=function(h){function r(t){var n=h.call(this,void 0)||this;return n.eGridDiv=t,n}return ag(r,h),r.prototype.postConstruct=function(){var t=this;this.logger=this.loggerFactory.create("GridComp");var n={destroyGridUi:function(){return t.destroyBean(t)},setRtlClass:function(y){return Er(t.getGui(),y)},addOrRemoveKeyboardFocusClass:function(y){return t.addOrRemoveCssClass(so.AG_KEYBOARD_FOCUS,y)},forceFocusOutOfContainer:this.forceFocusOutOfContainer.bind(this),updateLayoutClasses:this.updateLayoutClasses.bind(this),getFocusableContainers:this.getFocusableContainers.bind(this),setUserSelect:function(y){t.getGui().style.userSelect=null!=y?y:"",t.getGui().style.webkitUserSelect=null!=y?y:""},setCursor:function(y){t.getGui().style.cursor=null!=y?y:""}};this.ctrl=this.createManagedBean(new kc);var c=this.createTemplate();this.setTemplate(c),this.ctrl.setComp(n,this.eGridDiv,this.getGui()),this.insertGridIntoDom(),this.initialiseTabGuard({onTabKeyDown:function(){},focusInnerElement:function(y){return t.ctrl.focusInnerElement(y)}})},r.prototype.insertGridIntoDom=function(){var t=this,n=this.getGui();this.eGridDiv.appendChild(n),this.addDestroyFunc(function(){t.eGridDiv.removeChild(n),t.logger.log("Grid removed from DOM")})},r.prototype.updateLayoutClasses=function(t,n){Fr(this.eRootWrapperBody,e.LBn.AUTO_HEIGHT,n.autoHeight),Fr(this.eRootWrapperBody,e.LBn.NORMAL,n.normal),Fr(this.eRootWrapperBody,e.LBn.PRINT,n.print),this.addOrRemoveCssClass(e.LBn.AUTO_HEIGHT,n.autoHeight),this.addOrRemoveCssClass(e.LBn.NORMAL,n.normal),this.addOrRemoveCssClass(e.LBn.PRINT,n.print)},r.prototype.createTemplate=function(){return'<div class="ag-root-wrapper">\n                '+(this.ctrl.showDropZones()?"<ag-grid-header-drop-zones></ag-grid-header-drop-zones>":"")+'\n                <div class="ag-root-wrapper-body" ref="rootWrapperBody">\n                    <ag-grid-body ref="gridBody"></ag-grid-body>\n                    '+(this.ctrl.showSideBar()?'<ag-side-bar ref="sideBar"></ag-side-bar>':"")+"\n                </div>\n                "+(this.ctrl.showStatusBar()?'<ag-status-bar ref="statusBar"></ag-status-bar>':"")+"\n                <ag-pagination></ag-pagination>\n                "+(this.ctrl.showWatermark()?"<ag-watermark></ag-watermark>":"")+"\n            </div>"},r.prototype.getFocusableElement=function(){return this.eRootWrapperBody},r.prototype.getFocusableContainers=function(){var t=[this.gridBodyComp.getGui()];return this.sideBarComp&&t.push(this.sideBarComp.getGui()),t.filter(function(n){return Ol(n)})},Gc([Ee("loggerFactory")],r.prototype,"loggerFactory",void 0),Gc([Bt("gridBody")],r.prototype,"gridBodyComp",void 0),Gc([Bt("sideBar")],r.prototype,"sideBarComp",void 0),Gc([Bt("rootWrapperBody")],r.prototype,"eRootWrapperBody",void 0),Gc([zt],r.prototype,"postConstruct",null),r}(og),Vc=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ns=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Uc=function(h){function r(){var t=null!==h&&h.apply(this,arguments)||this;return t.dragEndFunctions=[],t.dragSources=[],t}return Vc(r,h),r.prototype.init=function(){this.logger=this.loggerFactory.create("DragService")},r.prototype.removeAllListeners=function(){this.dragSources.forEach(this.removeListener.bind(this)),this.dragSources.length=0},r.prototype.removeListener=function(t){var n=t.dragSource.eElement;n.removeEventListener("mousedown",t.mouseDownListener),t.touchEnabled&&n.removeEventListener("touchstart",t.touchStartListener,{passive:!0})},r.prototype.removeDragSource=function(t){var n=O(this.dragSources,function(c){return c.dragSource===t});!n||(this.removeListener(n),k(this.dragSources,n))},r.prototype.isDragging=function(){return this.dragging},r.prototype.addDragSource=function(t,n){var c=this;void 0===n&&(n=!1);var f=this.onMouseDown.bind(this,t);t.eElement.addEventListener("mousedown",f);var y=null,T=this.gridOptionsWrapper.isSuppressTouch();n&&!T&&t.eElement.addEventListener("touchstart",y=function(q){q.preventDefault(),c.onTouchStart(t,q)},{passive:!0}),this.dragSources.push({dragSource:t,mouseDownListener:f,touchStartListener:y,touchEnabled:n})},r.prototype.onTouchStart=function(t,n){var c=this;this.currentDragParams=t,this.dragging=!1;var f=n.touches[0];this.touchLastTime=f,this.touchStart=f;var T=function(ke){return c.onTouchUp(ke,t.eElement)},q=t.eElement,de=[{target:document,type:"touchmove",listener:function(ke){ke.cancelable&&ke.preventDefault()},options:{passive:!1}},{target:q,type:"touchmove",listener:function(ke){return c.onTouchMove(ke,t.eElement)},options:{passive:!0}},{target:q,type:"touchend",listener:T,options:{passive:!0}},{target:q,type:"touchcancel",listener:T,options:{passive:!0}}];this.addTemporaryEvents(de),0===t.dragStartPixels&&this.onCommonMove(f,this.touchStart,t.eElement)},r.prototype.onMouseDown=function(t,n){var c=this,f=n;if(!(t.skipMouseEvent&&t.skipMouseEvent(n)||f._alreadyProcessedByDragService||(f._alreadyProcessedByDragService=!0,0!==n.button))){this.currentDragParams=t,this.dragging=!1,this.mouseStartEvent=n;var y=this.gridOptionsWrapper.getDocument();this.addTemporaryEvents([{target:y,type:"mousemove",listener:function(je){return c.onMouseMove(je,t.eElement)}},{target:y,type:"mouseup",listener:function(je){return c.onMouseUp(je,t.eElement)}},{target:y,type:"contextmenu",listener:function(je){return je.preventDefault()}}]),0===t.dragStartPixels&&this.onMouseMove(n,t.eElement)}},r.prototype.addTemporaryEvents=function(t){t.forEach(function(n){n.target.addEventListener(n.type,n.listener,n.options)}),this.dragEndFunctions.push(function(){t.forEach(function(n){n.target.removeEventListener(n.type,n.listener,n.options)})})},r.prototype.isEventNearStartEvent=function(t,n){var c=this.currentDragParams.dragStartPixels;return Op(t,n,v(c)?c:4)},r.prototype.getFirstActiveTouch=function(t){for(var n=0;n<t.length;n++)if(t[n].identifier===this.touchStart.identifier)return t[n];return null},r.prototype.onCommonMove=function(t,n,c){if(!this.dragging){if(!this.dragging&&this.isEventNearStartEvent(t,n))return;this.dragging=!0,this.eventService.dispatchEvent({type:Ge.EVENT_DRAG_STARTED,api:this.gridApi,columnApi:this.columnApi,target:c}),this.currentDragParams.onDragStart(n),this.currentDragParams.onDragging(n)}this.currentDragParams.onDragging(t)},r.prototype.onTouchMove=function(t,n){var c=this.getFirstActiveTouch(t.touches);!c||this.onCommonMove(c,this.touchStart,n)},r.prototype.onMouseMove=function(t,n){this.onCommonMove(t,this.mouseStartEvent,n)},r.prototype.onTouchUp=function(t,n){var c=this.getFirstActiveTouch(t.changedTouches);c||(c=this.touchLastTime),this.onUpCommon(c,n)},r.prototype.onMouseUp=function(t,n){this.onUpCommon(t,n)},r.prototype.onUpCommon=function(t,n){this.dragging&&(this.dragging=!1,this.currentDragParams.onDragStop(t),this.eventService.dispatchEvent({type:Ge.EVENT_DRAG_STOPPED,api:this.gridApi,columnApi:this.columnApi,target:n})),this.mouseStartEvent=null,this.touchStart=null,this.touchLastTime=null,this.currentDragParams=null,this.dragEndFunctions.forEach(function(f){return f()}),this.dragEndFunctions.length=0},Ns([Ee("loggerFactory")],r.prototype,"loggerFactory",void 0),Ns([Ee("columnApi")],r.prototype,"columnApi",void 0),Ns([Ee("gridApi")],r.prototype,"gridApi",void 0),Ns([zt],r.prototype,"init",null),Ns([Ln],r.prototype,"removeAllListeners",null),Ns([Kt("dragService")],r)}(ct),kd=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Bd=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},sg=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}var t;return kd(r,h),t=r,r.prototype.progressSort=function(n,c,f){void 0===f&&(f="api");var y=this.getNextSortDirection(n);this.setSortForColumn(n,y,c,f)},r.prototype.setSortForColumn=function(n,c,f,y){void 0===y&&(y="api"),c!==W.SORT_ASC&&c!==W.SORT_DESC&&(c=null),n.setSort(c,y),f&&!this.gridOptionsWrapper.isSuppressMultiSort()||this.clearSortBarThisColumn(n,y),this.updateSortIndex(n),this.dispatchSortChangedEvents()},r.prototype.updateSortIndex=function(n){var c=this.getColumnsWithSortingOrdered(),f=0;c.forEach(function(T){T!==n&&(T.setSortIndex(f),f++)}),n.getSort()&&n.setSortIndex(f),this.columnModel.getPrimaryAndSecondaryAndAutoColumns().filter(function(T){return null==T.getSort()}).forEach(function(T){return T.setSortIndex()})},r.prototype.onSortChanged=function(){this.dispatchSortChangedEvents()},r.prototype.isSortActive=function(){var c=this.columnModel.getPrimaryAndSecondaryAndAutoColumns().filter(function(f){return!!f.getSort()});return c&&c.length>0},r.prototype.dispatchSortChangedEvents=function(){this.eventService.dispatchEvent({type:Ge.EVENT_SORT_CHANGED,api:this.gridApi,columnApi:this.columnApi})},r.prototype.clearSortBarThisColumn=function(n,c){this.columnModel.getPrimaryAndSecondaryAndAutoColumns().forEach(function(f){f!==n&&f.setSort(void 0,c)})},r.prototype.getNextSortDirection=function(n){var c;if(c=n.getColDef().sortingOrder?n.getColDef().sortingOrder:this.gridOptionsWrapper.getSortingOrder()?this.gridOptionsWrapper.getSortingOrder():t.DEFAULT_SORTING_ORDER,!Array.isArray(c)||c.length<=0)return console.warn("ag-grid: sortingOrder must be an array with at least one element, currently it's "+c),null;var B,f=c.indexOf(n.getSort());return t.DEFAULT_SORTING_ORDER.indexOf(B=f<0||f==c.length-1?c[0]:c[f+1])<0?(console.warn("ag-grid: invalid sort type "+B),null):B},r.prototype.getColumnsWithSortingOrdered=function(){var n=this.columnModel.getPrimaryAndSecondaryAndAutoColumns(),c=n.filter(function(y){return!!y.getSort()}),f={};return n.forEach(function(y,T){return f[y.getId()]=T}),c.sort(function(y,T){var B=y.getSortIndex(),q=T.getSortIndex();return null!=B&&null!=q?B-q:null==B&&null==q?f[y.getId()]>f[T.getId()]?1:-1:null==q?-1:1}),c},r.prototype.getSortModel=function(){return this.getColumnsWithSortingOrdered().map(function(n){return{sort:n.getSort(),colId:n.getId()}})},r.prototype.getSortOptions=function(){return this.getColumnsWithSortingOrdered().map(function(n){return{sort:n.getSort(),column:n}})},r.DEFAULT_SORTING_ORDER=[W.SORT_ASC,W.SORT_DESC,null],Bd([Ee("columnModel")],r.prototype,"columnModel",void 0),Bd([Ee("columnApi")],r.prototype,"columnApi",void 0),Bd([Ee("gridApi")],r.prototype,"gridApi",void 0),t=Bd([Kt("sortController")],r)}(ct),P2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),lg=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},ug=function(h){function r(){var n=null!==h&&h.apply(this,arguments)||this;return n.gridInstanceId=t.gridInstanceSequence.next(),n}var t;return P2(r,h),t=r,r.prototype.stampTopLevelGridCompWithGridInstance=function(n){n[t.GRID_DOM_KEY]=this.gridInstanceId},r.prototype.getRenderedCellForEvent=function(n){return wi(this.gridOptionsWrapper,n,go.DOM_DATA_KEY_CELL_CTRL)},r.prototype.isEventFromThisGrid=function(n){return this.isElementInThisGrid(n.target)},r.prototype.isElementInThisGrid=function(n){for(var c=n;c;){var f=c[t.GRID_DOM_KEY];if(v(f))return f===this.gridInstanceId;c=c.parentElement}return!1},r.prototype.getCellPositionForEvent=function(n){var c=this.getRenderedCellForEvent(n);return c?c.getCellPosition():null},r.prototype.getNormalisedPosition=function(n){var y,T,c=this.gridOptionsWrapper.getDomLayout()===W.DOM_LAYOUT_NORMAL;if(null!=n.clientX||null!=n.clientY?(y=n.clientX,T=n.clientY):(y=n.x,T=n.y),c){var B=this.ctrlsService.getGridBodyCtrl(),q=B.getScrollFeature().getVScrollPosition();y+=B.getScrollFeature().getHScrollPosition().left,T+=q.top}return{x:y,y:T}},r.gridInstanceSequence=new $a,r.GRID_DOM_KEY="__ag_grid_instance",lg([Ee("ctrlsService")],r.prototype,"ctrlsService",void 0),t=lg([Kt("mouseEventService")],r)}(ct),cg=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Hc=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},fg=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return cg(r,h),r.prototype.getNextCellToFocus=function(t,n){for(var c=n,f=!1;!f;){switch(t){case Yt.UP:c=this.getCellAbove(c);break;case Yt.DOWN:c=this.getCellBelow(c);break;case Yt.RIGHT:c=this.gridOptionsWrapper.isEnableRtl()?this.getCellToLeft(c):this.getCellToRight(c);break;case Yt.LEFT:c=this.gridOptionsWrapper.isEnableRtl()?this.getCellToRight(c):this.getCellToLeft(c);break;default:c=null,console.warn("AG Grid: unknown key for navigation "+t)}f=!c||this.isCellGoodToFocusOn(c)}return c},r.prototype.isCellGoodToFocusOn=function(t){var c,n=t.column;switch(t.rowPinned){case W.PINNED_TOP:c=this.pinnedRowModel.getPinnedTopRow(t.rowIndex);break;case W.PINNED_BOTTOM:c=this.pinnedRowModel.getPinnedBottomRow(t.rowIndex);break;default:c=this.rowModel.getRow(t.rowIndex)}return!!c&&!n.isSuppressNavigable(c)},r.prototype.getCellToLeft=function(t){if(!t)return null;var n=this.columnModel.getDisplayedColBefore(t.column);return n?{rowIndex:t.rowIndex,column:n,rowPinned:t.rowPinned}:null},r.prototype.getCellToRight=function(t){if(!t)return null;var n=this.columnModel.getDisplayedColAfter(t.column);return n?{rowIndex:t.rowIndex,column:n,rowPinned:t.rowPinned}:null},r.prototype.getRowBelow=function(t){var n=t.rowIndex,c=t.rowPinned;if(this.isLastRowInContainer(t))switch(c){case W.PINNED_BOTTOM:return null;case W.PINNED_TOP:return this.rowModel.isRowsToRender()?{rowIndex:this.paginationProxy.getPageFirstRow(),rowPinned:null}:this.pinnedRowModel.isRowsToRender(W.PINNED_BOTTOM)?{rowIndex:0,rowPinned:W.PINNED_BOTTOM}:null;default:return this.pinnedRowModel.isRowsToRender(W.PINNED_BOTTOM)?{rowIndex:0,rowPinned:W.PINNED_BOTTOM}:null}return{rowIndex:n+1,rowPinned:c}},r.prototype.getCellBelow=function(t){if(!t)return null;var n=this.getRowBelow(t);return n?{rowIndex:n.rowIndex,column:t.column,rowPinned:n.rowPinned}:null},r.prototype.isLastRowInContainer=function(t){var n=t.rowPinned,c=t.rowIndex;return n===W.PINNED_TOP?this.pinnedRowModel.getPinnedTopRowData().length-1<=c:n===W.PINNED_BOTTOM?this.pinnedRowModel.getPinnedBottomRowData().length-1<=c:this.paginationProxy.getPageLastRow()<=c},r.prototype.getRowAbove=function(t){var n=t.rowIndex,c=t.rowPinned;return(c?0===n:n===this.paginationProxy.getPageFirstRow())?c===W.PINNED_TOP?null:c&&this.rowModel.isRowsToRender()?this.getLastBodyCell():this.pinnedRowModel.isRowsToRender(W.PINNED_TOP)?this.getLastFloatingTopRow():null:{rowIndex:n-1,rowPinned:c}},r.prototype.getCellAbove=function(t){if(!t)return null;var n=this.getRowAbove({rowIndex:t.rowIndex,rowPinned:t.rowPinned});return n?{rowIndex:n.rowIndex,column:t.column,rowPinned:n.rowPinned}:null},r.prototype.getLastBodyCell=function(){return{rowIndex:this.paginationProxy.getPageLastRow(),rowPinned:null}},r.prototype.getLastFloatingTopRow=function(){return{rowIndex:this.pinnedRowModel.getPinnedTopRowData().length-1,rowPinned:W.PINNED_TOP}},r.prototype.getNextTabbedCell=function(t,n){return n?this.getNextTabbedCellBackwards(t):this.getNextTabbedCellForwards(t)},r.prototype.getNextTabbedCellForwards=function(t){var n=this.columnModel.getAllDisplayedColumns(),c=t.rowIndex,f=t.rowPinned,y=this.columnModel.getDisplayedColAfter(t.column);if(!y){y=n[0];var T=this.getRowBelow(t);if(g(T)||!T.rowPinned&&!this.paginationProxy.isRowInPage(T))return null;c=T?T.rowIndex:null,f=T?T.rowPinned:null}return{rowIndex:c,column:y,rowPinned:f}},r.prototype.getNextTabbedCellBackwards=function(t){var n=this.columnModel.getAllDisplayedColumns(),c=t.rowIndex,f=t.rowPinned,y=this.columnModel.getDisplayedColBefore(t.column);if(!y){y=H(n);var T=this.getRowAbove({rowIndex:t.rowIndex,rowPinned:t.rowPinned});if(g(T)||!T.rowPinned&&!this.paginationProxy.isRowInPage(T))return null;c=T?T.rowIndex:null,f=T?T.rowPinned:null}return{rowIndex:c,column:y,rowPinned:f}},Hc([Ee("columnModel")],r.prototype,"columnModel",void 0),Hc([Ee("rowModel")],r.prototype,"rowModel",void 0),Hc([Ee("pinnedRowModel")],r.prototype,"pinnedRowModel",void 0),Hc([Ee("paginationProxy")],r.prototype,"paginationProxy",void 0),Hc([Kt("cellNavigationService")],r)}(ct),i5=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Gd=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Vd=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return i5(r,h),r.prototype.formatValue=function(t,n,c,f,y,T){void 0===T&&(T=!0);var q,B=null,de=t.getColDef();if(y?q=y:T&&(q=n&&n.rowPinned&&de.pinnedRowValueFormatter?de.pinnedRowValueFormatter:de.valueFormatter),q){var Se={value:f,node:n,data:n?n.data:null,colDef:de,column:t,api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi(),context:this.gridOptionsWrapper.getContext()};Se.$scope=c,B=this.expressionService.evaluate(q,Se)}else if(de.refData)return de.refData[f]||"";return null==B&&Array.isArray(f)&&(B=f.join(", ")),B},Gd([Ee("expressionService")],r.prototype,"expressionService",void 0),Gd([Kt("valueFormatterService")],r)}(ct),F2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Wc=function(h){function r(t){return h.call(this,t,"ag-radio-button","radio")||this}return F2(r,h),r.prototype.isSelected=function(){return this.eInput.checked},r.prototype.toggle=function(){this.eInput.disabled||this.isSelected()||this.setValue(!0)},r.prototype.addInputListeners=function(){h.prototype.addInputListeners.call(this),this.addManagedListener(this.eventService,Ge.EVENT_CHECKBOX_CHANGED,this.onChange.bind(this))},r.prototype.onChange=function(t){t.selected&&t.name&&this.eInput.name&&this.eInput.name===t.name&&t.id&&this.eInput.id!==t.id&&this.setValue(!1,!0)},r}(dl),o5=["mouseover","mouseout","mouseenter","mouseleave"],L2=function(){function h(){this.isOutsideAngular=function(r){return oe(o5,r)}}return h.prototype.setTimeout=function(r,t){window.setTimeout(r,t)},h.prototype.setInterval=function(r,t){return new Di(function(n){n(window.setInterval(r,t))})},h.prototype.addEventListener=function(r,t,n,c){r.addEventListener(t,n,c)},h.prototype.dispatchEvent=function(r,t,n){t()},h.prototype.frameworkComponent=function(r){return null},h}(),a5=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),zc=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},N2=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return a5(r,h),r.prototype.postConstruct=function(){this.addManagedListener(this.eventService,Ge.EVENT_DISPLAYED_COLUMNS_CHANGED,this.onDisplayedColumnsChanged.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,this.onDisplayedColumnsWidthChanged.bind(this))},r.prototype.onDisplayedColumnsChanged=function(){this.update()},r.prototype.onDisplayedColumnsWidthChanged=function(){this.update()},r.prototype.update=function(){this.updateImpl(),setTimeout(this.updateImpl.bind(this),500)},r.prototype.updateImpl=function(){var t=this.ctrlsService.getCenterRowContainerCtrl();if(t){var n={horizontalScrollShowing:t.isHorizontalScrollShowing(),verticalScrollShowing:this.isVerticalScrollShowing()};this.setScrollsVisible(n)}},r.prototype.setScrollsVisible=function(t){this.horizontalScrollShowing===t.horizontalScrollShowing&&this.verticalScrollShowing===t.verticalScrollShowing||(this.horizontalScrollShowing=t.horizontalScrollShowing,this.verticalScrollShowing=t.verticalScrollShowing,this.eventService.dispatchEvent({type:Ge.EVENT_SCROLL_VISIBILITY_CHANGED,api:this.gridApi,columnApi:this.columnApi}))},r.prototype.isHorizontalScrollShowing=function(){return this.horizontalScrollShowing},r.prototype.isVerticalScrollShowing=function(){return this.verticalScrollShowing},zc([Ee("columnApi")],r.prototype,"columnApi",void 0),zc([Ee("gridApi")],r.prototype,"gridApi",void 0),zc([Ee("ctrlsService")],r.prototype,"ctrlsService",void 0),zc([zt],r.prototype,"postConstruct",null),zc([Kt("scrollVisibleService")],r)}(ct),s5=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),I2=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},k2=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return s5(r,h),r.prototype.processAllCellClasses=function(t,n,c,f){this.processClassRules(t.cellClassRules,n,c,f),this.processStaticCellClasses(t,n,c)},r.prototype.processClassRules=function(t,n,c,f){if(null!=t)for(var y=Object.keys(t),T={},B={},q=function(je){var _t,Qe=y[je],rt=t[Qe];"string"==typeof rt?_t=de.expressionService.evaluate(rt,n):"function"==typeof rt&&(_t=rt(n)),Qe.split(" ").forEach(function(Vt){null==Vt||""==Vt.trim()||(_t?T[Vt]=!0:B[Vt]=!0)}),f&&Object.keys(B).forEach(f),Object.keys(T).forEach(c)},de=this,Se=0;Se<y.length;Se++)q(Se)},r.prototype.getStaticCellClasses=function(t,n){var f,c=t.cellClass;return c?("string"==typeof(f="function"==typeof c?(0,t.cellClass)(n):c)&&(f=[f]),f):[]},r.prototype.processStaticCellClasses=function(t,n,c){this.getStaticCellClasses(t,n).forEach(function(y){c(y)})},I2([Ee("expressionService")],r.prototype,"expressionService",void 0),I2([Kt("stylingService")],r)}(ct),l5=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),dg=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Is=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return l5(r,h),r.prototype.setMouseOver=function(t){this.selectedColumns=t,this.eventService.dispatchEvent({type:Ge.EVENT_COLUMN_HOVER_CHANGED,api:this.gridApi,columnApi:this.columnApi})},r.prototype.clearMouseOver=function(){this.selectedColumns=null,this.eventService.dispatchEvent({type:Ge.EVENT_COLUMN_HOVER_CHANGED,api:this.gridApi,columnApi:this.columnApi})},r.prototype.isHovered=function(t){return!!this.selectedColumns&&this.selectedColumns.indexOf(t)>=0},dg([Ee("columnApi")],r.prototype,"columnApi",void 0),dg([Ee("gridApi")],r.prototype,"gridApi",void 0),dg([Kt("columnHoverService")],r)}(ct),Ud=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Hd=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},hg=function(h){function r(){var t=null!==h&&h.apply(this,arguments)||this;return t.executeNextFuncs=[],t.executeLaterFuncs=[],t.active=!1,t.animationThreadCount=0,t}return Ud(r,h),r.prototype.postConstruct=function(){var t=this;this.ctrlsService.whenReady(function(n){return t.gridBodyCtrl=n.gridBodyCtrl})},r.prototype.isActive=function(){return this.active},r.prototype.start=function(){this.active||this.gridOptionsWrapper.isSuppressColumnMoveAnimation()||this.gridOptionsWrapper.isEnableRtl()||(this.ensureAnimationCssClassPresent(),this.active=!0)},r.prototype.finish=function(){!this.active||(this.flush(),this.active=!1)},r.prototype.executeNextVMTurn=function(t){this.active?this.executeNextFuncs.push(t):t()},r.prototype.executeLaterVMTurn=function(t){this.active?this.executeLaterFuncs.push(t):t()},r.prototype.ensureAnimationCssClassPresent=function(){var t=this;this.animationThreadCount++;var n=this.animationThreadCount;this.gridBodyCtrl.setColumnMovingCss(!0),this.executeLaterFuncs.push(function(){t.animationThreadCount===n&&t.gridBodyCtrl.setColumnMovingCss(!1)})},r.prototype.flush=function(){var t=this.executeNextFuncs;this.executeNextFuncs=[];var n=this.executeLaterFuncs;this.executeLaterFuncs=[],(0!==t.length||0!==n.length)&&(window.setTimeout(function(){return t.forEach(function(c){return c()})},0),window.setTimeout(function(){return n.forEach(function(c){return c()})},300))},Hd([Ee("ctrlsService")],r.prototype,"ctrlsService",void 0),Hd([zt],r.prototype,"postConstruct",null),Hd([Kt("columnAnimationService")],r)}(ct),Wd=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),jc=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},zd=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}var t;return Wd(r,h),t=r,r.prototype.createAutoGroupColumns=function(n){var c=this,f=[],y=this.gridOptionsWrapper.isTreeData(),T=this.gridOptionsWrapper.isGroupMultiAutoColumn();return y&&T&&(console.warn("AG Grid: you cannot mix groupMultiAutoColumn with treeData, only one column can be used to display groups when doing tree data"),T=!1),T?n.forEach(function(B,q){f.push(c.createOneAutoGroupColumn(B,q))}):f.push(this.createOneAutoGroupColumn()),f},r.prototype.createOneAutoGroupColumn=function(n,c){var y,f=this.generateDefaultColDef(n);y=n?W.GROUP_AUTO_COLUMN_ID+"-"+n.getId():t.GROUP_AUTO_COLUMN_BUNDLE_ID,pt(f,this.gridOptionsWrapper.getAutoGroupColumnDef()),(f=this.columnFactory.mergeColDefs(f)).colId=y,this.gridOptionsWrapper.isTreeData()||g(f.field)&&g(f.valueGetter)&&g(f.filterValueGetter)&&(f.filter=!1),c&&c>0&&(f.headerCheckboxSelection=!1);var q=new it(f,null,y,!0);return this.context.createBean(q),q},r.prototype.generateDefaultColDef=function(n){var c=this.gridOptionsWrapper.getAutoGroupColumnDef(),y={headerName:this.gridOptionsWrapper.getLocaleTextFunc()("group","Group")};if(c&&(c.cellRenderer||c.cellRendererFramework||c.cellRendererSelector)||(y.cellRenderer="agGroupCellRenderer"),n){var B=n.getColDef();ut(y,{headerName:this.columnModel.getDisplayNameForColumn(n,"header"),headerValueGetter:B.headerValueGetter}),B.cellRenderer&&ut(y,{cellRendererParams:{innerRenderer:B.cellRenderer,innerRendererParams:B.cellRendererParams}}),y.showRowGroup=n.getColId()}else y.showRowGroup=!0;return y},r.GROUP_AUTO_COLUMN_BUNDLE_ID=W.GROUP_AUTO_COLUMN_ID,jc([Ee("columnModel")],r.prototype,"columnModel",void 0),jc([Ee("columnFactory")],r.prototype,"columnFactory",void 0),t=jc([Kt("autoGroupColService")],r)}(ct),B2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),ra=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},jd=function(h){function r(){var t=null!==h&&h.apply(this,arguments)||this;return t.currentPage=0,t.topDisplayedRowIndex=0,t.bottomDisplayedRowIndex=0,t.pixelOffset=0,t.masterRowCount=0,t}return B2(r,h),r.prototype.postConstruct=function(){this.active=this.gridOptionsWrapper.isPagination(),this.paginateChildRows=this.gridOptionsWrapper.isPaginateChildRows(),this.addManagedListener(this.eventService,Ge.EVENT_MODEL_UPDATED,this.onModelUpdated.bind(this)),this.addManagedListener(this.gridOptionsWrapper,"paginationPageSize",this.onPaginationPageSizeChanged.bind(this)),this.onModelUpdated()},r.prototype.ensureRowHeightsValid=function(t,n,c,f){var y=this.rowModel.ensureRowHeightsValid(t,n,this.getPageFirstRow(),this.getPageLastRow());return y&&this.calculatePages(),y},r.prototype.onModelUpdated=function(t){this.calculatePages(),this.eventService.dispatchEvent({type:Ge.EVENT_PAGINATION_CHANGED,animate:!!t&&t.animate,newData:!!t&&t.newData,newPage:!!t&&t.newPage,keepRenderedRows:!!t&&t.keepRenderedRows,api:this.gridApi,columnApi:this.columnApi})},r.prototype.onPaginationPageSizeChanged=function(){this.calculatePages(),this.eventService.dispatchEvent({type:Ge.EVENT_PAGINATION_CHANGED,animate:!1,newData:!1,newPage:!1,keepRenderedRows:!0,api:this.gridApi,columnApi:this.columnApi})},r.prototype.goToPage=function(t){this.active&&this.currentPage!==t&&(this.currentPage=t,this.onModelUpdated({type:Ge.EVENT_MODEL_UPDATED,animate:!1,keepRenderedRows:!1,newData:!1,newPage:!0,api:this.gridApi,columnApi:this.columnApi}))},r.prototype.getPixelOffset=function(){return this.pixelOffset},r.prototype.getRow=function(t){return this.rowModel.getRow(t)},r.prototype.getRowNode=function(t){return this.rowModel.getRowNode(t)},r.prototype.getRowIndexAtPixel=function(t){return this.rowModel.getRowIndexAtPixel(t)},r.prototype.getCurrentPageHeight=function(){return g(this.topRowBounds)||g(this.bottomRowBounds)?0:Math.max(this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight-this.topRowBounds.rowTop,0)},r.prototype.getCurrentPagePixelRange=function(){return{pageFirstPixel:this.topRowBounds?this.topRowBounds.rowTop:0,pageLastPixel:this.bottomRowBounds?this.bottomRowBounds.rowTop+this.bottomRowBounds.rowHeight:0}},r.prototype.isRowPresent=function(t){return!!this.rowModel.isRowPresent(t)&&t.rowIndex>=this.topDisplayedRowIndex&&t.rowIndex<=this.bottomDisplayedRowIndex},r.prototype.isEmpty=function(){return this.rowModel.isEmpty()},r.prototype.isRowsToRender=function(){return this.rowModel.isRowsToRender()},r.prototype.getNodesInRangeForSelection=function(t,n){return this.rowModel.getNodesInRangeForSelection(t,n)},r.prototype.forEachNode=function(t){return this.rowModel.forEachNode(t)},r.prototype.getType=function(){return this.rowModel.getType()},r.prototype.getRowBounds=function(t){var n=this.rowModel.getRowBounds(t);return n.rowIndex=t,n},r.prototype.getPageFirstRow=function(){return this.topRowBounds?this.topRowBounds.rowIndex:-1},r.prototype.getPageLastRow=function(){return this.bottomRowBounds?this.bottomRowBounds.rowIndex:-1},r.prototype.getRowCount=function(){return this.rowModel.getRowCount()},r.prototype.getPageForIndex=function(t){return Math.floor(t/this.pageSize)},r.prototype.goToPageWithIndex=function(t){if(this.active){var n=this.getPageForIndex(t);this.goToPage(n)}},r.prototype.isRowInPage=function(t){return!this.active||this.getPageForIndex(t.rowIndex)===this.currentPage},r.prototype.isLastPageFound=function(){return this.rowModel.isLastRowIndexKnown()},r.prototype.getCurrentPage=function(){return this.currentPage},r.prototype.goToNextPage=function(){this.goToPage(this.currentPage+1)},r.prototype.goToPreviousPage=function(){this.goToPage(this.currentPage-1)},r.prototype.goToFirstPage=function(){this.goToPage(0)},r.prototype.goToLastPage=function(){var t=this.rowModel.getRowCount(),n=Math.floor(t/this.pageSize);this.goToPage(n)},r.prototype.getPageSize=function(){return this.pageSize},r.prototype.getTotalPages=function(){return this.totalPages},r.prototype.setPageSize=function(){this.pageSize=this.gridOptionsWrapper.getPaginationPageSize(),(null==this.pageSize||this.pageSize<1)&&(this.pageSize=100)},r.prototype.calculatePages=function(){this.active?(this.setPageSize(),this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly()):this.calculatedPagesNotActive(),this.topRowBounds=this.rowModel.getRowBounds(this.topDisplayedRowIndex),this.topRowBounds&&(this.topRowBounds.rowIndex=this.topDisplayedRowIndex),this.bottomRowBounds=this.rowModel.getRowBounds(this.bottomDisplayedRowIndex),this.bottomRowBounds&&(this.bottomRowBounds.rowIndex=this.bottomDisplayedRowIndex),this.setPixelOffset(v(this.topRowBounds)?this.topRowBounds.rowTop:0)},r.prototype.setPixelOffset=function(t){this.pixelOffset!==t&&(this.pixelOffset=t,this.eventService.dispatchEvent({type:Ge.EVENT_PAGINATION_PIXEL_OFFSET_CHANGED}))},r.prototype.setZeroRows=function(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0},r.prototype.calculatePagesMasterRowsOnly=function(){if(this.masterRowCount=this.rowModel.getTopLevelRowCount(),this.masterRowCount<=0)this.setZeroRows();else{var t=this.masterRowCount-1;this.totalPages=Math.floor(t/this.pageSize)+1,this.currentPage>=this.totalPages&&(this.currentPage=this.totalPages-1),(!Or(this.currentPage)||this.currentPage<0)&&(this.currentPage=0);var c=this.pageSize*(this.currentPage+1)-1;if(c>t&&(c=t),this.topDisplayedRowIndex=this.rowModel.getTopLevelRowDisplayedIndex(this.pageSize*this.currentPage),c===t)this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1;else{var f=this.rowModel.getTopLevelRowDisplayedIndex(c+1);this.bottomDisplayedRowIndex=f-1}}},r.prototype.getMasterRowCount=function(){return this.masterRowCount},r.prototype.calculatePagesAllRows=function(){if(this.masterRowCount=this.rowModel.getRowCount(),0!==this.masterRowCount){var t=this.masterRowCount-1;this.totalPages=Math.floor(t/this.pageSize)+1,this.currentPage>=this.totalPages&&(this.currentPage=this.totalPages-1),(!Or(this.currentPage)||this.currentPage<0)&&(this.currentPage=0),this.topDisplayedRowIndex=this.pageSize*this.currentPage,this.bottomDisplayedRowIndex=this.pageSize*(this.currentPage+1)-1,this.bottomDisplayedRowIndex>t&&(this.bottomDisplayedRowIndex=t)}else this.setZeroRows()},r.prototype.calculatedPagesNotActive=function(){this.pageSize=this.rowModel.getRowCount(),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.rowModel.getRowCount()-1},ra([Ee("rowModel")],r.prototype,"rowModel",void 0),ra([Ee("columnApi")],r.prototype,"columnApi",void 0),ra([Ee("gridApi")],r.prototype,"gridApi",void 0),ra([zt],r.prototype,"postConstruct",null),ra([Kt("paginationProxy")],r)}(ct),G2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),h0=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},V2=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return G2(r,h),r.prototype.postConstruct=function(){var t=this;this.ctrlsService.whenReady(function(n){t.centerRowContainerCon=n.centerRowContainerCtrl,t.addManagedListener(t.eventService,Ge.EVENT_BODY_HEIGHT_CHANGED,t.onBodyHeightChanged.bind(t)),t.addManagedListener(t.eventService,Ge.EVENT_SCROLL_VISIBILITY_CHANGED,t.onScrollVisibilityChanged.bind(t)),t.checkPageSize()})},r.prototype.notActive=function(){return!this.gridOptionsWrapper.isPaginationAutoPageSize()},r.prototype.onScrollVisibilityChanged=function(){this.checkPageSize()},r.prototype.onBodyHeightChanged=function(){this.checkPageSize()},r.prototype.checkPageSize=function(){if(!this.notActive()){var t=this.gridOptionsWrapper.getRowHeightAsNumber(),n=this.centerRowContainerCon.getViewportSizeFeature().getBodyHeight();if(n>0){var c=Math.floor(n/t);this.gridOptionsWrapper.setProperty("paginationPageSize",c)}}},h0([Ee("ctrlsService")],r.prototype,"ctrlsService",void 0),h0([zt],r.prototype,"postConstruct",null),h0([Kt("paginationAutoPageSizeService")],r)}(ct),pg=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),vg=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},gg=function(h){function r(){var t=null!==h&&h.apply(this,arguments)||this;return t.cacheVersion=0,t}return pg(r,h),r.prototype.init=function(){this.active=this.gridOptionsWrapper.isValueCache(),this.neverExpires=this.gridOptionsWrapper.isValueCacheNeverExpires()},r.prototype.onDataChanged=function(){this.neverExpires||this.expire()},r.prototype.expire=function(){this.cacheVersion++},r.prototype.setValue=function(t,n,c){this.active&&(t.__cacheVersion!==this.cacheVersion&&(t.__cacheVersion=this.cacheVersion,t.__cacheData={}),t.__cacheData[n]=c)},r.prototype.getValue=function(t,n){if(this.active&&t.__cacheVersion===this.cacheVersion)return t.__cacheData[n]},vg([zt],r.prototype,"init",null),vg([Kt("valueCache")],r)}(ct),p0=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),os=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Xd=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return p0(r,h),r.prototype.init=function(){this.rowModel.getType()===W.ROW_MODEL_TYPE_CLIENT_SIDE&&(this.clientSideRowModel=this.rowModel),this.addManagedListener(this.eventService,Ge.EVENT_CELL_VALUE_CHANGED,this.onCellValueChanged.bind(this))},r.prototype.onCellValueChanged=function(t){t.source!==W.SOURCE_PASTE&&this.doChangeDetection(t.node,t.column)},r.prototype.doChangeDetection=function(t,n){if(!this.gridOptionsWrapper.isSuppressChangeDetection()){if(this.clientSideRowModel&&!t.isRowPinned()){var c=this.gridOptionsWrapper.isAggregateOnlyChangedColumns(),f=new Rr(c,this.clientSideRowModel.getRootNode());f.addParentNode(t.parent,[n]),this.clientSideRowModel.doAggregate(f)}this.rowRenderer.refreshCells()}},os([Ee("rowModel")],r.prototype,"rowModel",void 0),os([Ee("rowRenderer")],r.prototype,"rowRenderer",void 0),os([zt],r.prototype,"init",null),os([Kt("changeDetectionService")],r)}(ct),au=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),as=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},su=function(h,r){return function(t,n){r(t,n,h)}},mg=function(h){function r(){var t=null!==h&&h.apply(this,arguments)||this;return t.consuming=!1,t}return au(r,h),r.prototype.setBeans=function(t){this.logger=t.create("AlignedGridsService")},r.prototype.init=function(){this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_MOVED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_VISIBLE,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_PINNED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_GROUP_OPENED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_RESIZED,this.fireColumnEvent.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_BODY_SCROLL,this.fireScrollEvent.bind(this))},r.prototype.fireEvent=function(t){if(!this.consuming){var n=this.gridOptionsWrapper.getAlignedGrids();n&&n.forEach(function(c){if(c.api){var f=c.api.__getAlignedGridService();t(f)}})}},r.prototype.onEvent=function(t){this.consuming=!0,t(),this.consuming=!1},r.prototype.fireColumnEvent=function(t){this.fireEvent(function(n){n.onColumnEvent(t)})},r.prototype.fireScrollEvent=function(t){"horizontal"===t.direction&&this.fireEvent(function(n){n.onScrollEvent(t)})},r.prototype.onScrollEvent=function(t){var n=this;this.onEvent(function(){n.ctrlsService.getGridBodyCtrl().getScrollFeature().setHorizontalScrollPosition(t.left)})},r.prototype.getMasterColumns=function(t){var n=[];return t.columns?t.columns.forEach(function(c){n.push(c)}):t.column&&n.push(t.column),n},r.prototype.getColumnIds=function(t){var n=[];return t.columns?t.columns.forEach(function(c){n.push(c.getColId())}):t.column&&n.push(t.column.getColId()),n},r.prototype.onColumnEvent=function(t){var n=this;this.onEvent(function(){switch(t.type){case Ge.EVENT_COLUMN_MOVED:case Ge.EVENT_COLUMN_VISIBLE:case Ge.EVENT_COLUMN_PINNED:case Ge.EVENT_COLUMN_RESIZED:n.processColumnEvent(t);break;case Ge.EVENT_COLUMN_GROUP_OPENED:n.processGroupOpenedEvent(t);break;case Ge.EVENT_COLUMN_PIVOT_CHANGED:console.warn("AG Grid: pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.")}})},r.prototype.processGroupOpenedEvent=function(t){var n=t.columnGroup,c=null;if(n){var f=n.getGroupId();c=this.columnModel.getOriginalColumnGroup(f)}n&&!c||(this.logger.log("onColumnEvent-> processing "+t+" expanded = "+n.isExpanded()),this.columnModel.setColumnGroupOpened(c,n.isExpanded(),"alignedGridChanged"))},r.prototype.processColumnEvent=function(t){var n=this,c=t.column,f=null;if(c&&(f=this.columnModel.getPrimaryColumn(c.getColId())),!c||f){var y=this.getMasterColumns(t);switch(t.type){case Ge.EVENT_COLUMN_MOVED:var T=t,q=t.columnApi.getColumnState().map(function(_t){return{colId:_t.colId}});this.columnModel.applyColumnState({state:q,applyOrder:!0},"alignedGridChanged"),this.logger.log("onColumnEvent-> processing "+t.type+" toIndex = "+T.toIndex);break;case Ge.EVENT_COLUMN_VISIBLE:var de=t;q=t.columnApi.getColumnState().map(function(Ut){return{colId:Ut.colId,hide:Ut.hide}}),this.columnModel.applyColumnState({state:q},"alignedGridChanged"),this.logger.log("onColumnEvent-> processing "+t.type+" visible = "+de.visible);break;case Ge.EVENT_COLUMN_PINNED:var Se=t;q=t.columnApi.getColumnState().map(function(Ut){return{colId:Ut.colId,pinned:Ut.pinned}}),this.columnModel.applyColumnState({state:q},"alignedGridChanged"),this.logger.log("onColumnEvent-> processing "+t.type+" pinned = "+Se.pinned);break;case Ge.EVENT_COLUMN_RESIZED:var ke=t;y.forEach(function(_t){n.logger.log("onColumnEvent-> processing "+t.type+" actualWidth = "+_t.getActualWidth());var Vt=[{key:_t.getColId(),newWidth:_t.getActualWidth()}];n.columnModel.setColumnWidths(Vt,!1,ke.finished,"alignedGridChanged")})}var Qe=this.ctrlsService.getGridBodyCtrl().isVerticalScrollShowing(),rt=this.gridOptionsWrapper.getAlignedGrids();rt&&rt.forEach(function(_t){_t.api&&_t.api.setAlwaysShowVerticalScroll(Qe)})}},as([Ee("columnModel")],r.prototype,"columnModel",void 0),as([Ee("ctrlsService")],r.prototype,"ctrlsService",void 0),as([su(0,Dn("loggerFactory"))],r.prototype,"setBeans",null),as([zt],r.prototype,"init",null),as([Kt("alignedGridsService")],r)}(ct),yg=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Yd=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},qd=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return yg(r,h),r.prototype.adaptFunction=function(t,n){var c=this.componentMetadataProvider.retrieve(t);return c&&c.functionAdapter?c.functionAdapter(n):null},r.prototype.adaptCellRendererFunction=function(t){return function(){function c(){}return c.prototype.refresh=function(f){return!1},c.prototype.getGui=function(){var f=t(this.params),y=typeof f;return"string"===y||"number"===y||"boolean"===y?ua("<span>"+f+"</span>"):null==f?ua("<span></span>"):f},c.prototype.init=function(f){this.params=f},c}()},r.prototype.doesImplementIComponent=function(t){return!!t&&t.prototype&&"getGui"in t.prototype},Yd([Ee("componentMetadataProvider")],r.prototype,"componentMetadataProvider",void 0),Yd([Kt("agComponentUtils")],r)}(ct),Kd=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Xc=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Yc=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return Kd(r,h),r.prototype.postConstruct=function(){this.componentMetaData={dateComponent:{mandatoryMethodList:["getDate","setDate"],optionalMethodList:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel"]},detailCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},headerComponent:{mandatoryMethodList:[],optionalMethodList:["refresh"]},headerGroupComponent:{mandatoryMethodList:[],optionalMethodList:[]},loadingCellRenderer:{mandatoryMethodList:[],optionalMethodList:[]},loadingOverlayComponent:{mandatoryMethodList:[],optionalMethodList:[]},noRowsOverlayComponent:{mandatoryMethodList:[],optionalMethodList:[]},floatingFilterComponent:{mandatoryMethodList:["onParentModelChanged"],optionalMethodList:["afterGuiAttached"]},floatingFilterWrapperComponent:{mandatoryMethodList:[],optionalMethodList:[]},cellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},cellEditor:{mandatoryMethodList:["getValue"],optionalMethodList:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached"]},innerRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},fullWidthCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},pinnedRowCellRenderer:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},groupRowRenderer:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"],functionAdapter:this.agComponentUtils.adaptCellRendererFunction.bind(this.agComponentUtils)},filter:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged"]},filterComponent:{mandatoryMethodList:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethodList:["afterGuiAttached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged"]},statusPanel:{mandatoryMethodList:[],optionalMethodList:["afterGuiAttached"]},toolPanel:{mandatoryMethodList:[],optionalMethodList:["refresh","afterGuiAttached"]},tooltipComponent:{mandatoryMethodList:[],optionalMethodList:[]}}},r.prototype.retrieve=function(t){return this.componentMetaData[t]},Xc([Ee("agComponentUtils")],r.prototype,"agComponentUtils",void 0),Xc([zt],r.prototype,"postConstruct",null),Xc([Kt("componentMetadataProvider")],r)}(ct),U2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Qd=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},_g={"ag-theme-custom":{headerHeight:25,headerCellMinWidth:24,listItemHeight:20,rowHeight:25,chartMenuPanelWidth:220},"ag-theme-material":{headerHeight:56,headerCellMinWidth:48,listItemHeight:32,rowHeight:48,chartMenuPanelWidth:240},"ag-theme-balham":{headerHeight:32,headerCellMinWidth:24,listItemHeight:24,rowHeight:28,chartMenuPanelWidth:220},"ag-theme-alpine":{headerHeight:48,headerCellMinWidth:36,listItemHeight:24,rowHeight:42,chartMenuPanelWidth:240}},Sg={headerHeight:["ag-header-row"],headerCellMinWidth:["ag-header-cell"],listItemHeight:["ag-virtual-list-item"],rowHeight:["ag-row"],chartMenuPanelWidth:["ag-chart-docked-container"]},v0={},Ro=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return U2(r,h),r.prototype.getSassVariable=function(t,n){var c="ag-theme-"+(t.match("material")?"material":t.match("balham")?"balham":t.match("alpine")?"alpine":"custom"),f=_g[c][n],y=0;v0[t]||(v0[t]={});var T=v0[t][n];if(null!=T)return T;if(Sg[n]){var B=Sg[n],q=document.createElement("div");Er(q,t),q.style.position="absolute";var de=B.reduce(function(ke,je){var Qe=document.createElement("div");return Qe.style.position="static",Er(Qe,je),ke.appendChild(Qe),Qe},q);if(document.body){document.body.appendChild(q);var Se=-1!==n.toLowerCase().indexOf("height")?"height":"width";y=parseInt(window.getComputedStyle(de)[Se],10),document.body.removeChild(q)}}return v0[t][n]=y||f,v0[t][n]},r.prototype.isThemeDark=function(){var t=this.getTheme().theme;return!!t&&t.indexOf("dark")>=0},r.prototype.chartMenuPanelWidth=function(){var t=this.getTheme().themeFamily;return this.getSassVariable(t,"chartMenuPanelWidth")},r.prototype.getTheme=function(){for(var t=/\bag-(material|(?:theme-([\w\-]*)))\b/,n=this.eGridDiv,c=null;n&&!(c=t.exec(n.className));)n=n.parentElement||void 0;if(!c)return{};var f=c[0];if(void 0===c[2]){var T=f.replace("ag-","ag-theme-");Lt(function(){return console.warn("AG Grid: As of v19 old theme are no longer provided. Please replace "+f+" with "+T+".")},"using-old-theme")}return{theme:f,el:n,themeFamily:f.replace(/-dark$/,"")}},Qd([Ee("eGridDiv")],r.prototype,"eGridDiv",void 0),Qd([Kt("environment")],r)}(ct),H2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Zd=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},W2=function(h){function r(){var t=null!==h&&h.apply(this,arguments)||this;return t.createTasksP1={list:[],sorted:!1},t.createTasksP2={list:[],sorted:!1},t.destroyTasks=[],t.ticking=!1,t.scrollGoingDown=!0,t.lastScrollTop=0,t.taskCount=0,t.cancelledTasks=new Set,t}return H2(r,h),r.prototype.setScrollTop=function(t){this.scrollGoingDown=t>this.lastScrollTop,this.lastScrollTop=t},r.prototype.init=function(){this.useAnimationFrame=!this.gridOptionsWrapper.isSuppressAnimationFrame()},r.prototype.isOn=function(){return this.useAnimationFrame},r.prototype.verifyAnimationFrameOn=function(t){!1===this.useAnimationFrame&&console.warn("AG Grid: AnimationFrameService."+t+" called but animation frames are off")},r.prototype.createTask=function(t,n,c){this.verifyAnimationFrameOn(c);var f={task:t,index:n,createOrder:++this.taskCount};this.addTaskToList(this[c],f),this.schedule()},r.prototype.cancelTask=function(t){this.cancelledTasks.add(t)},r.prototype.addTaskToList=function(t,n){t.list.push(n),t.sorted=!1},r.prototype.sortTaskList=function(t){if(!t.sorted){var n=this.scrollGoingDown?1:-1;t.list.sort(function(c,f){return c.index!==f.index?n*(f.index-c.index):f.createOrder-c.createOrder}),t.sorted=!0}},r.prototype.addDestroyTask=function(t){this.verifyAnimationFrameOn("createTasksP3"),this.destroyTasks.push(t),this.schedule()},r.prototype.executeFrame=function(t){this.verifyAnimationFrameOn("executeFrame");for(var n=this.createTasksP1,c=n.list,f=this.createTasksP2,y=f.list,T=this.destroyTasks,B=(new Date).getTime(),q=(new Date).getTime()-B,de=t<=0,Se=this.ctrlsService.getGridBodyCtrl();de||q<t;){if(!Se.getScrollFeature().executeAnimationFrameScroll()){var je=void 0;if(c.length)this.sortTaskList(n),je=c.pop().task;else if(y.length)this.sortTaskList(f),je=y.pop().task;else{if(!T.length){this.cancelledTasks.clear();break}je=T.pop()}this.cancelledTasks.has(je)||je()}q=(new Date).getTime()-B}c.length||y.length||T.length?this.requestFrame():this.stopTicking()},r.prototype.stopTicking=function(){this.ticking=!1},r.prototype.flushAllFrames=function(){!this.useAnimationFrame||this.executeFrame(-1)},r.prototype.schedule=function(){!this.useAnimationFrame||this.ticking||(this.ticking=!0,this.requestFrame())},r.prototype.requestFrame=function(){var t=this.executeFrame.bind(this,60);window.requestAnimationFrame?window.requestAnimationFrame(t):window.webkitRequestAnimationFrame?window.webkitRequestAnimationFrame(t):window.setTimeout(t,0)},r.prototype.isQueueEmpty=function(){return!this.ticking},r.prototype.debounce=function(t){var n=this,c=!1;return function(){n.isOn()?c||(c=!0,n.addDestroyTask(function(){c=!1,t()})):n.getFrameworkOverrides().setTimeout(t,0)}},Zd([Ee("ctrlsService")],r.prototype,"ctrlsService",void 0),Zd([zt],r.prototype,"init",null),Zd([Kt("animationFrameService")],r)}(ct),u5=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),g0=function(){return g0=Object.assign||function(h){for(var r,t=1,n=arguments.length;t<n;t++)for(var c in r=arguments[t])Object.prototype.hasOwnProperty.call(r,c)&&(h[c]=r[c]);return h},g0.apply(this,arguments)},Go=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},xg=function(h){function r(){var t=null!==h&&h.apply(this,arguments)||this;return t.timeLastPageEventProcessed=0,t}return u5(r,h),r.prototype.postConstruct=function(){var t=this;this.ctrlsService.whenReady(function(n){t.gridBodyCon=n.gridBodyCtrl})},r.prototype.handlePageScrollingKey=function(t){var n=t.which||t.keyCode,c=t.altKey,f=t.ctrlKey||t.metaKey,y=this.mouseEventService.getCellPositionForEvent(t);if(!y)return!1;var T=!1;switch(n){case Yt.PAGE_HOME:case Yt.PAGE_END:!f&&!c&&(this.onHomeOrEndKey(n),T=!0);break;case Yt.LEFT:case Yt.RIGHT:f&&!c&&(this.onCtrlLeftOrRight(n,y),T=!0);break;case Yt.UP:case Yt.DOWN:f&&!c&&(this.onCtrlUpOrDown(n,y),T=!0);break;case Yt.PAGE_DOWN:!f&&!c&&(this.onPageDown(y),T=!0);break;case Yt.PAGE_UP:!f&&!c&&(this.onPageUp(y),T=!0)}return T&&t.preventDefault(),T},r.prototype.isTimeSinceLastPageEventToRecent=function(){return(new Date).getTime()-this.timeLastPageEventProcessed<100},r.prototype.setTimeLastPageEventProcessed=function(){this.timeLastPageEventProcessed=(new Date).getTime()},r.prototype.navigateTo=function(t){var n=t.scrollIndex,c=t.scrollType,f=t.scrollColumn,y=t.focusIndex,T=t.focusColumn;v(f)&&!f.isPinned()&&this.gridBodyCon.getScrollFeature().ensureColumnVisible(f),v(n)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(n,c),this.animationFrameService.flushAllFrames(),this.focusService.setFocusedCell(y,T,null,!0),this.rangeService&&this.rangeService.setRangeToCell({rowIndex:y,rowPinned:null,column:T})},r.prototype.onPageDown=function(t){if(!this.isTimeSinceLastPageEventToRecent()){var c=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),f=this.gridOptionsWrapper.getScrollbarWidth(),y=c.bottom-c.top;this.ctrlsService.getCenterRowContainerCtrl().isHorizontalScrollShowing()&&(y-=f);var T=this.paginationProxy.getPixelOffset(),de=this.paginationProxy.getRowIndexAtPixel(c.top+y+T),Se=this.paginationProxy.getRow(t.rowIndex).rowTop,je=this.paginationProxy.getRowIndexAtPixel(Se+y-T+T),Qe=this.paginationProxy.getPageLastRow();je>Qe&&(je=Qe),de>Qe&&(de=Qe),this.navigateTo({scrollIndex:de,scrollType:"top",scrollColumn:null,focusIndex:je,focusColumn:t.column}),this.setTimeLastPageEventProcessed()}},r.prototype.onPageUp=function(t){if(!this.isTimeSinceLastPageEventToRecent()){var c=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition(),f=this.gridOptionsWrapper.getScrollbarWidth(),y=c.bottom-c.top;this.ctrlsService.getCenterRowContainerCtrl().isHorizontalScrollShowing()&&(y-=f);var T=this.paginationProxy.getPixelOffset(),de=this.paginationProxy.getRowIndexAtPixel(c.top+T),Se=this.paginationProxy.getRow(t.rowIndex),je=this.paginationProxy.getRowIndexAtPixel(Se.rowTop+Se.rowHeight-y-T+T),Qe=this.paginationProxy.getPageFirstRow();je<Qe&&(je=Qe),de<Qe&&(de=Qe),this.navigateTo({scrollIndex:de,scrollType:"bottom",scrollColumn:null,focusIndex:je,focusColumn:t.column}),this.setTimeLastPageEventProcessed()}},r.prototype.getIndexToFocus=function(t,n){var c=t;if(n){var f=this.paginationProxy.getRow(t);f&&f.stub&&(c-=1)}return c},r.prototype.onCtrlUpOrDown=function(t,n){var c=t===Yt.UP,f=c?this.paginationProxy.getPageFirstRow():this.paginationProxy.getPageLastRow();this.navigateTo({scrollIndex:f,scrollType:null,scrollColumn:n.column,focusIndex:this.getIndexToFocus(f,!c),focusColumn:n.column})},r.prototype.onCtrlLeftOrRight=function(t,n){var c=t===Yt.LEFT,f=this.columnModel.getAllDisplayedColumns(),T=c!==this.gridOptionsWrapper.isEnableRtl()?f[0]:H(f);this.navigateTo({scrollIndex:n.rowIndex,scrollType:null,scrollColumn:T,focusIndex:n.rowIndex,focusColumn:T})},r.prototype.onHomeOrEndKey=function(t){var n=t===Yt.PAGE_HOME,c=this.columnModel.getAllDisplayedColumns(),f=n?c[0]:H(c),y=n?this.paginationProxy.getPageFirstRow():this.paginationProxy.getPageLastRow();this.navigateTo({scrollIndex:y,scrollType:null,scrollColumn:f,focusIndex:this.getIndexToFocus(y,!n),focusColumn:f})},r.prototype.onTabKeyDown=function(t,n){var c=n.shiftKey;if(this.tabToNextCellCommon(t,c))n.preventDefault();else if(c){var y=t.getRowPosition(),T=y.rowIndex;if(y.rowPinned?0===T:T===this.paginationProxy.getPageFirstRow()){n.preventDefault();var de=this.headerNavigationService.getHeaderRowCount()-1,Se=H(this.columnModel.getAllDisplayedColumns());this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:de,column:Se},event:n})}}else t instanceof go&&t.focusCell(!0),this.focusService.focusNextGridCoreContainer(!1)&&n.preventDefault()},r.prototype.tabToNextCell=function(t){var n=this.focusService.getFocusedCell();if(!n)return!1;var c=this.getCellByPosition(n);return!!(c||(c=this.rowRenderer.getRowByPosition(n),c&&c.isFullWidth()))&&this.tabToNextCellCommon(c,t)},r.prototype.tabToNextCellCommon=function(t,n){var c=t.isEditing();if(!c&&t instanceof go){var y=t.getRowCtrl();y&&(c=y.isEditing())}return(c?this.gridOptionsWrapper.isFullRowEdit()?this.moveToNextEditingRow(t,n):this.moveToNextEditingCell(t,n):this.moveToNextCellNotEditing(t,n))||!!this.focusService.getFocusedHeader()},r.prototype.moveToNextEditingCell=function(t,n){var c=t.getCellPosition();t.stopEditing();var f=this.findNextCellToFocusOn(c,n,!0);return null!=f&&(f.startEditing(null,null,!0),f.focusCell(!1),!0)},r.prototype.moveToNextEditingRow=function(t,n){var c=t.getCellPosition(),f=this.findNextCellToFocusOn(c,n,!0);if(null==f)return!1;var y=f.getCellPosition(),T=this.isCellEditable(c),B=this.isCellEditable(y),q=y&&c.rowIndex===y.rowIndex&&c.rowPinned===y.rowPinned;return T&&t.setFocusOutOnEditor(),q||(t.getRowCtrl().stopEditing(),f.getRowCtrl().startRowEditing()),B?(f.setFocusInOnEditor(),f.focusCell()):f.focusCell(!0),!0},r.prototype.moveToNextCellNotEditing=function(t,n){var f,c=this.columnModel.getAllDisplayedColumns();f=t instanceof Os?g0(g0({},t.getRowPosition()),{column:n?c[0]:H(c)}):t.getCellPosition();var y=this.findNextCellToFocusOn(f,n,!1);if(y instanceof go)y.focusCell(!0);else if(y)return this.tryToFocusFullWidthRow(y.getRowPosition(),n);return v(y)},r.prototype.findNextCellToFocusOn=function(t,n,c){for(var f=t;;){n||(f=this.getLastCellOfColSpan(f)),f=this.cellNavigationService.getNextTabbedCell(f,n);var y=this.gridOptionsWrapper.getTabToNextCellFunc();if(v(y)){var B=y({backwards:n,editing:c,previousCellPosition:t,nextCellPosition:f||null,api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi()});v(B)?(B.floating&&(Lt(function(){console.warn("AG Grid: tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?")},"no floating in userCell"),B.rowPinned=B.floating),f={rowIndex:B.rowIndex,column:B.column,rowPinned:B.rowPinned}):f=null}if(!f)return null;if(f.rowIndex<0){var q=this.headerNavigationService.getHeaderRowCount();return this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:q+f.rowIndex,column:f.column}}),null}var de=this.gridOptionsWrapper.isFullRowEdit();if(!c||de||this.isCellEditable(f)){this.ensureCellVisible(f);var ke=this.getCellByPosition(f);if(!ke){var je=this.rowRenderer.getRowByPosition(f);if(!je||!je.isFullWidth())continue;return je}if(!ke.isSuppressNavigable())return this.rangeService&&this.rangeService.setRangeToCell(f),ke}}},r.prototype.isCellEditable=function(t){var n=this.lookupRowNodeForCell(t);return!!n&&t.column.isCellEditable(n)},r.prototype.getCellByPosition=function(t){var n=this.rowRenderer.getRowByPosition(t);return n?n.getCellCtrl(t.column):null},r.prototype.lookupRowNodeForCell=function(t){return t.rowPinned===W.PINNED_TOP?this.pinnedRowModel.getPinnedTopRow(t.rowIndex):t.rowPinned===W.PINNED_BOTTOM?this.pinnedRowModel.getPinnedBottomRow(t.rowIndex):this.paginationProxy.getRow(t.rowIndex)},r.prototype.navigateToNextCell=function(t,n,c,f){for(var y=c,T=!1;y&&(y===c||!this.isValidNavigateCell(y));)this.gridOptionsWrapper.isEnableRtl()?n===Yt.LEFT&&(y=this.getLastCellOfColSpan(y)):n===Yt.RIGHT&&(y=this.getLastCellOfColSpan(y)),T=g(y=this.cellNavigationService.getNextCellToFocus(n,y));if(T&&t&&t.keyCode===Yt.UP&&(y={rowIndex:-1,rowPinned:null,column:c.column}),f){var B=this.gridOptionsWrapper.getNavigateToNextCellFunc();if(v(B)){var de=B({key:n,previousCellPosition:c,nextCellPosition:y||null,event:t,api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi()});v(de)?(de.floating&&(Lt(function(){console.warn("AG Grid: tabToNextCellFunc return type should have attributes: rowIndex, rowPinned, column. However you had 'floating', maybe you meant 'rowPinned'?")},"no floating in userCell"),de.rowPinned=de.floating),y={rowPinned:de.rowPinned,rowIndex:de.rowIndex,column:de.column}):y=null}}if(y){if(y.rowIndex<0){var Se=this.headerNavigationService.getHeaderRowCount();return void this.focusService.focusHeaderPosition({headerPosition:{headerRowIndex:Se+y.rowIndex,column:c.column},event:t||void 0})}var ke=this.getNormalisedPosition(y);ke?this.focusPosition(ke):this.tryToFocusFullWidthRow(y)}},r.prototype.getNormalisedPosition=function(t){this.ensureCellVisible(t);var n=this.getCellByPosition(t);return n?(t=n.getCellPosition(),this.ensureCellVisible(t),t):null},r.prototype.tryToFocusFullWidthRow=function(t,n){void 0===n&&(n=!1);var c=this.columnModel.getAllDisplayedColumns(),f=this.rowRenderer.getRowByPosition(t);if(!f||!f.isFullWidth())return!1;var y={rowIndex:t.rowIndex,rowPinned:t.rowPinned,column:t.column||(n?H(c):c[0])};return this.focusPosition(y),!0},r.prototype.focusPosition=function(t){this.focusService.setFocusedCell(t.rowIndex,t.column,t.rowPinned,!0),this.rangeService&&this.rangeService.setRangeToCell(t)},r.prototype.isValidNavigateCell=function(t){return!!this.rowPositionUtils.getRowNode(t)},r.prototype.getLastCellOfColSpan=function(t){var n=this.getCellByPosition(t);if(!n)return t;var c=n.getColSpanningList();return 1===c.length?t:{rowIndex:t.rowIndex,column:H(c),rowPinned:t.rowPinned}},r.prototype.ensureCellVisible=function(t){g(t.rowPinned)&&this.gridBodyCon.getScrollFeature().ensureIndexVisible(t.rowIndex),t.column.isPinned()||this.gridBodyCon.getScrollFeature().ensureColumnVisible(t.column),this.gridBodyCon.getScrollFeature().horizontallyScrollHeaderCenterAndFloatingCenter(),this.animationFrameService.flushAllFrames()},Go([Ee("mouseEventService")],r.prototype,"mouseEventService",void 0),Go([Ee("paginationProxy")],r.prototype,"paginationProxy",void 0),Go([Ee("focusService")],r.prototype,"focusService",void 0),Go([Ee("animationFrameService")],r.prototype,"animationFrameService",void 0),Go([Nr("rangeService")],r.prototype,"rangeService",void 0),Go([Ee("columnModel")],r.prototype,"columnModel",void 0),Go([Ee("ctrlsService")],r.prototype,"ctrlsService",void 0),Go([Ee("rowRenderer")],r.prototype,"rowRenderer",void 0),Go([Ee("headerNavigationService")],r.prototype,"headerNavigationService",void 0),Go([Ee("rowPositionUtils")],r.prototype,"rowPositionUtils",void 0),Go([Ee("cellNavigationService")],r.prototype,"cellNavigationService",void 0),Go([Ee("pinnedRowModel")],r.prototype,"pinnedRowModel",void 0),Go([zt],r.prototype,"postConstruct",null),Go([Kt("navigationService")],r)}(ct),$d=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),m0=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},z2=function(h,r){return function(t,n){r(t,n,h)}},j2=function(h){function r(){var t=null!==h&&h.apply(this,arguments)||this;return t.scrollY=0,t.uiBodyHeight=0,t}return $d(r,h),r.prototype.agWire=function(t){this.logger=t.create("RowContainerHeightService")},r.prototype.postConstruct=function(){this.addManagedListener(this.eventService,Ge.EVENT_BODY_HEIGHT_CHANGED,this.updateOffset.bind(this)),this.maxDivHeight=Xa(),this.logger.log("maxDivHeight = "+this.maxDivHeight)},r.prototype.isStretching=function(){return this.stretching},r.prototype.getDivStretchOffset=function(){return this.divStretchOffset},r.prototype.updateOffset=function(){if(this.stretching){var n=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition().top,c=this.getUiBodyHeight();(n!==this.scrollY||c!==this.uiBodyHeight)&&(this.scrollY=n,this.uiBodyHeight=c,this.calculateOffset())}},r.prototype.calculateOffset=function(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;var t=this.scrollY/this.maxScrollY,n=t*this.pixelsToShave;this.logger.log("Div Stretch Offset = "+n+" ("+this.pixelsToShave+" * "+t+")"),this.setDivStretchOffset(n)},r.prototype.setUiContainerHeight=function(t){t!==this.uiContainerHeight&&(this.uiContainerHeight=t,this.eventService.dispatchEvent({type:Ge.EVENT_ROW_CONTAINER_HEIGHT_CHANGED}))},r.prototype.clearOffset=function(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)},r.prototype.setDivStretchOffset=function(t){var n="number"==typeof t?Math.floor(t):null;this.divStretchOffset!==n&&(this.divStretchOffset=n,this.eventService.dispatchEvent({type:Ge.EVENT_HEIGHT_SCALE_CHANGED}))},r.prototype.setModelHeight=function(t){this.modelHeight=t,this.stretching=null!=t&&this.maxDivHeight>0&&t>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()},r.prototype.getUiContainerHeight=function(){return this.uiContainerHeight},r.prototype.getRealPixelPosition=function(t){return t-this.divStretchOffset},r.prototype.getUiBodyHeight=function(){var n=this.ctrlsService.getGridBodyCtrl().getScrollFeature().getVScrollPosition();return n.bottom-n.top},r.prototype.getScrollPositionForPixel=function(t){if(this.pixelsToShave<=0)return t;var n=this.modelHeight-this.getUiBodyHeight();return this.maxScrollY*(t/n)},m0([Ee("ctrlsService")],r.prototype,"ctrlsService",void 0),m0([z2(0,Dn("loggerFactory"))],r.prototype,"agWire",null),m0([zt],r.prototype,"postConstruct",null),m0([Kt("rowContainerHeightService")],r)}(ct),X2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),eh=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},bg=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return X2(r,h),r.prototype.init=function(){this.groupSelectsChildren=this.gridOptionsWrapper.isGroupSelectsChildren(),this.isRowSelectableFunc=this.gridOptionsWrapper.getIsRowSelectableFunc()},r.prototype.updateSelectableAfterGrouping=function(t){this.isRowSelectableFunc&&this.recurseDown(t.childrenAfterGroup,function(f){return f.childrenAfterGroup})},r.prototype.updateSelectableAfterFiltering=function(t){this.isRowSelectableFunc&&this.recurseDown(t.childrenAfterGroup,function(f){return f.childrenAfterFilter})},r.prototype.recurseDown=function(t,n){var c=this;!t||t.forEach(function(f){var y;f.group&&(f.hasChildren()&&c.recurseDown(n(f),n),y=c.groupSelectsChildren?v(O(n(f),"selectable",!0)):!!c.isRowSelectableFunc&&c.isRowSelectableFunc(f),f.setRowSelectable(y))})},eh([zt],r.prototype,"init",null),eh([Kt("selectableService")],r)}(ct),Ag=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),na=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Y2=function(h){function r(){var t=h.call(this)||this;return t.previousAndFirstButtonsDisabled=!1,t.nextButtonDisabled=!1,t.lastButtonDisabled=!1,t}return Ag(r,h),r.prototype.postConstruct=function(){var t=this,n=this.gridOptionsWrapper.isEnableRtl();this.setTemplate(this.getTemplate()),this.btFirst.insertAdjacentElement("afterbegin",Bi(n?"last":"first",this.gridOptionsWrapper)),this.btPrevious.insertAdjacentElement("afterbegin",Bi(n?"next":"previous",this.gridOptionsWrapper)),this.btNext.insertAdjacentElement("afterbegin",Bi(n?"previous":"next",this.gridOptionsWrapper)),this.btLast.insertAdjacentElement("afterbegin",Bi(n?"first":"last",this.gridOptionsWrapper)),this.gridOptionsWrapper.isPagination()&&!this.gridOptionsWrapper.isSuppressPaginationPanel()?(this.addManagedListener(this.eventService,Ge.EVENT_PAGINATION_CHANGED,this.onPaginationChanged.bind(this)),[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}].forEach(function(y){var T=y.el,B=y.fn;t.addManagedListener(T,"click",B),t.addManagedListener(T,"keydown",function(q){(q.keyCode===Yt.ENTER||q.keyCode===Yt.SPACE)&&(q.preventDefault(),B())})}),this.onPaginationChanged()):this.setDisplayed(!1)},r.prototype.onPaginationChanged=function(){this.enableOrDisableButtons(),this.updateRowLabels(),this.setCurrentPageLabel(),this.setTotalLabels()},r.prototype.onBtFirst=function(){this.previousAndFirstButtonsDisabled||this.paginationProxy.goToFirstPage()},r.prototype.setCurrentPageLabel=function(){var t=this.paginationProxy.getTotalPages()>0,n=this.paginationProxy.getCurrentPage();this.lbCurrent.innerHTML=this.formatNumber(t?n+1:0)},r.prototype.formatNumber=function(t){var n=this.gridOptionsWrapper.getPaginationNumberFormatterFunc();return n?n({value:t}):pn(t)},r.prototype.getTemplate=function(){var t=this.gridOptionsWrapper.getLocaleTextFunc(),n=t("page","Page"),c=t("to","to"),f=t("of","of"),y=t("firstPage","First Page"),T=t("previousPage","Previous Page"),B=t("nextPage","Next Page"),q=t("lastPage","Last Page"),de=this.getCompId();return'<div class="ag-paging-panel ag-unselectable" id="ag-'+de+'">\n                <span class="ag-paging-row-summary-panel" role="status">\n                    <span id="ag-'+de+'-first-row" ref="lbFirstRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-'+de+'-to">'+c+'</span>\n                    <span id="ag-'+de+'-last-row" ref="lbLastRowOnPage" class="ag-paging-row-summary-panel-number"></span>\n                    <span id="ag-'+de+'-of">'+f+'</span>\n                    <span id="ag-'+de+'-row-count" ref="lbRecordCount" class="ag-paging-row-summary-panel-number"></span>\n                </span>\n                <span class="ag-paging-page-summary-panel" role="presentation">\n                    <div ref="btFirst" class="ag-paging-button" role="button" aria-label="'+y+'" tabindex="0"></div>\n                    <div ref="btPrevious" class="ag-paging-button" role="button" aria-label="'+T+'" tabindex="0"></div>\n                    <span class="ag-paging-description" role="status">\n                        <span id="ag-'+de+'-start-page">'+n+'</span>\n                        <span id="ag-'+de+'-start-page-number" ref="lbCurrent" class="ag-paging-number"></span>\n                        <span id="ag-'+de+'-of-page">'+f+'</span>\n                        <span id="ag-'+de+'-of-page-number" ref="lbTotal" class="ag-paging-number"></span>\n                    </span>\n                    <div ref="btNext" class="ag-paging-button" role="button" aria-label="'+B+'" tabindex="0"></div>\n                    <div ref="btLast" class="ag-paging-button" role="button" aria-label="'+q+'" tabindex="0"></div>\n                </span>\n            </div>'},r.prototype.onBtNext=function(){this.nextButtonDisabled||this.paginationProxy.goToNextPage()},r.prototype.onBtPrevious=function(){this.previousAndFirstButtonsDisabled||this.paginationProxy.goToPreviousPage()},r.prototype.onBtLast=function(){this.lastButtonDisabled||this.paginationProxy.goToLastPage()},r.prototype.enableOrDisableButtons=function(){var t=this.paginationProxy.getCurrentPage(),n=this.paginationProxy.isLastPageFound(),c=this.paginationProxy.getTotalPages();this.previousAndFirstButtonsDisabled=0===t,Fr(this.btFirst,"ag-disabled",this.previousAndFirstButtonsDisabled),X0(this.btFirst,this.previousAndFirstButtonsDisabled),Fr(this.btPrevious,"ag-disabled",this.previousAndFirstButtonsDisabled),X0(this.btPrevious,this.previousAndFirstButtonsDisabled);var f=this.isZeroPagesToDisplay();this.nextButtonDisabled=n&&t===c-1||f,Fr(this.btNext,"ag-disabled",this.nextButtonDisabled),X0(this.btNext,this.nextButtonDisabled),this.lastButtonDisabled=!n||f||t===c-1,Fr(this.btLast,"ag-disabled",this.lastButtonDisabled),X0(this.btLast,this.lastButtonDisabled)},r.prototype.updateRowLabels=function(){var y,T,t=this.paginationProxy.getCurrentPage(),n=this.paginationProxy.getPageSize(),c=this.paginationProxy.isLastPageFound(),f=this.paginationProxy.isLastPageFound()?this.paginationProxy.getMasterRowCount():null;this.isZeroPagesToDisplay()?y=T=0:(T=(y=n*t+1)+n-1,c&&T>f&&(T=f)),this.lbFirstRowOnPage.innerHTML=this.formatNumber(y),this.lbLastRowOnPage.innerHTML=this.rowNodeBlockLoader.isLoading()?"?":this.formatNumber(T)},r.prototype.isZeroPagesToDisplay=function(){var t=this.paginationProxy.isLastPageFound(),n=this.paginationProxy.getTotalPages();return t&&0===n},r.prototype.setTotalLabels=function(){var t=this.paginationProxy.isLastPageFound(),n=this.paginationProxy.getTotalPages(),c=t?this.paginationProxy.getMasterRowCount():null;if(1===c){var f=this.paginationProxy.getRow(0);if(f&&f.group&&!f.groupData&&!f.aggData)return void this.setTotalLabelsToZero()}if(t)this.lbTotal.innerHTML=this.formatNumber(n),this.lbRecordCount.innerHTML=this.formatNumber(c);else{var T=this.gridOptionsWrapper.getLocaleTextFunc()("more","more");this.lbTotal.innerHTML=T,this.lbRecordCount.innerHTML=T}},r.prototype.setTotalLabelsToZero=function(){this.lbFirstRowOnPage.innerHTML=this.formatNumber(0),this.lbCurrent.innerHTML=this.formatNumber(0),this.lbLastRowOnPage.innerHTML=this.formatNumber(0),this.lbTotal.innerHTML=this.formatNumber(0),this.lbRecordCount.innerHTML=this.formatNumber(0)},na([Ee("paginationProxy")],r.prototype,"paginationProxy",void 0),na([Ee("rowNodeBlockLoader")],r.prototype,"rowNodeBlockLoader",void 0),na([Bt("btFirst")],r.prototype,"btFirst",void 0),na([Bt("btPrevious")],r.prototype,"btPrevious",void 0),na([Bt("btNext")],r.prototype,"btNext",void 0),na([Bt("btLast")],r.prototype,"btLast",void 0),na([Bt("lbRecordCount")],r.prototype,"lbRecordCount",void 0),na([Bt("lbFirstRowOnPage")],r.prototype,"lbFirstRowOnPage",void 0),na([Bt("lbLastRowOnPage")],r.prototype,"lbLastRowOnPage",void 0),na([Bt("lbCurrent")],r.prototype,"lbCurrent",void 0),na([Bt("lbTotal")],r.prototype,"lbTotal",void 0),na([zt],r.prototype,"postConstruct",null),r}(dn),Mg=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),va=function(h){function r(){var t=null!==h&&h.apply(this,arguments)||this;return t.polyfillFunctions=[],t}return Mg(r,h),r.prototype.observeResize=function(t,n){var Se,c=this,f=Sr(n,50),B=this.gridOptionsWrapper.isSuppressBrowserResizeObserver();return window.ResizeObserver&&!B?((Se=new window.ResizeObserver(f)).observe(t),function(){return Se.disconnect()}):function(){var Se=Ma(t),ke=ki(t),je=!0;return function rt(){if(je){var _t=Ma(t),Vt=ki(t);(_t!==Se||Vt!==ke)&&(Se=_t,ke=Vt,n()),c.doNextPolyfillTurn(rt)}}(),function(){return je=!1}}()},r.prototype.doNextPolyfillTurn=function(t){this.polyfillFunctions.push(t),this.schedulePolyfill()},r.prototype.schedulePolyfill=function(){var t=this;this.polyfillScheduled||(this.polyfillScheduled=!0,this.getFrameworkOverrides().setTimeout(function(){var f=t.polyfillFunctions;t.polyfillScheduled=!1,t.polyfillFunctions=[],f.forEach(function(y){return y()})},50))},r=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f}([Kt("resizeObserverService")],r),r}(ct),th=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),lu=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},gl=function(){return function(h){h[h.Loading=0]="Loading",h[h.NoRows=1]="NoRows"}(gl||(gl={})),gl}(),c5=function(h){function r(){var t=h.call(this,r.TEMPLATE)||this;return t.inProgress=!1,t.destroyRequested=!1,t}return th(r,h),r.prototype.updateLayoutClasses=function(t,n){Fr(this.eOverlayWrapper,e.LBn.AUTO_HEIGHT,n.autoHeight),Fr(this.eOverlayWrapper,e.LBn.NORMAL,n.normal),Fr(this.eOverlayWrapper,e.LBn.PRINT,n.print)},r.prototype.postConstruct=function(){this.createManagedBean(new pl(this)),this.setDisplayed(!1),this.addManagedListener(this.eventService,Ge.EVENT_ROW_DATA_CHANGED,this.onRowDataChanged.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_ROW_DATA_UPDATED,this.onRowDataChanged.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_NEW_COLUMNS_LOADED,this.onNewColumnsLoaded.bind(this)),this.gridOptionsWrapper.isRowModelDefault()&&!this.gridOptionsWrapper.getRowData()&&this.showLoadingOverlay(),this.gridApi.registerOverlayWrapperComp(this)},r.prototype.setWrapperTypeClass=function(t){Fr(this.eOverlayWrapper,"ag-overlay-loading-wrapper",t===gl.Loading),Fr(this.eOverlayWrapper,"ag-overlay-no-rows-wrapper",t===gl.NoRows)},r.prototype.showLoadingOverlay=function(){if(!this.gridOptionsWrapper.isSuppressLoadingOverlay()){var t={api:this.gridOptionsWrapper.getApi()},c=this.userComponentFactory.getLoadingOverlayCompDetails(t).newAgStackInstance();this.showOverlay(c,gl.Loading)}},r.prototype.showNoRowsOverlay=function(){if(!this.gridOptionsWrapper.isSuppressNoRowsOverlay()){var t={api:this.gridOptionsWrapper.getApi()},c=this.userComponentFactory.getNoRowsOverlayCompDetails(t).newAgStackInstance();this.showOverlay(c,gl.NoRows)}},r.prototype.showOverlay=function(t,n){var c=this;this.inProgress||(this.setWrapperTypeClass(n),this.destroyActiveOverlay(),this.inProgress=!0,t&&t.then(function(f){c.inProgress=!1,c.eOverlayWrapper.appendChild(f.getGui()),c.activeOverlay=f,c.destroyRequested&&(c.destroyRequested=!1,c.destroyActiveOverlay())}),this.setDisplayed(!0))},r.prototype.destroyActiveOverlay=function(){this.inProgress?this.destroyRequested=!0:!this.activeOverlay||(this.activeOverlay=this.getContext().destroyBean(this.activeOverlay),So(this.eOverlayWrapper))},r.prototype.hideOverlay=function(){this.destroyActiveOverlay(),this.setDisplayed(!1)},r.prototype.destroy=function(){this.destroyActiveOverlay(),h.prototype.destroy.call(this)},r.prototype.showOrHideOverlay=function(){var t=this.paginationProxy.isEmpty(),n=this.gridOptionsWrapper.isSuppressNoRowsOverlay();t&&!n?this.showNoRowsOverlay():this.hideOverlay()},r.prototype.onRowDataChanged=function(){this.showOrHideOverlay()},r.prototype.onNewColumnsLoaded=function(){this.columnModel.isReady()&&!this.paginationProxy.isEmpty()&&this.hideOverlay()},r.TEMPLATE='\n        <div class="ag-overlay" aria-hidden="true">\n            <div class="ag-overlay-panel">\n                <div class="ag-overlay-wrapper" ref="eOverlayWrapper"></div>\n            </div>\n        </div>',lu([Ee("userComponentFactory")],r.prototype,"userComponentFactory",void 0),lu([Ee("paginationProxy")],r.prototype,"paginationProxy",void 0),lu([Ee("gridApi")],r.prototype,"gridApi",void 0),lu([Ee("columnModel")],r.prototype,"columnModel",void 0),lu([Bt("eOverlayWrapper")],r.prototype,"eOverlayWrapper",void 0),lu([zt],r.prototype,"postConstruct",null),r}(dn),Rg=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),ks=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Dg=function(h){function r(t){void 0===t&&(t={});var n=h.call(this,r.getTemplate(t))||this;n.suppressEnabledCheckbox=!0,n.suppressOpenCloseIcons=!1;var f=t.enabled,y=t.items,T=t.suppressEnabledCheckbox,B=t.suppressOpenCloseIcons;return n.title=t.title,n.cssIdentifier=t.cssIdentifier||"default",n.enabled=null==f||f,n.items=y||[],n.alignItems=t.alignItems||"center",null!=T&&(n.suppressEnabledCheckbox=T),null!=B&&(n.suppressOpenCloseIcons=B),n}return Rg(r,h),r.getTemplate=function(t){var n=t.cssIdentifier||"default";return'<div class="ag-group ag-'+n+'-group" role="presentation">\n            <div class="ag-group-title-bar ag-'+n+'-group-title-bar ag-unselectable" ref="eTitleBar" role="button">\n                <span class="ag-group-title-bar-icon ag-'+n+'-group-title-bar-icon" ref="eGroupOpenedIcon" role="presentation"></span>\n                <span class="ag-group-title-bar-icon ag-'+n+'-group-title-bar-icon" ref="eGroupClosedIcon" role="presentation"></span>\n                <span ref="eTitle" class="ag-group-title ag-'+n+'-group-title"></span>\n            </div>\n            <div ref="eToolbar" class="ag-group-toolbar ag-'+n+'-group-toolbar">\n                <ag-checkbox ref="cbGroupEnabled"></ag-checkbox>\n            </div>\n            <div ref="eContainer" class="ag-group-container ag-group-container-'+(t.direction||"vertical")+" ag-"+n+'-group-container"></div>\n        </div>'},r.prototype.postConstruct=function(){if(this.items.length){var t=this.items;this.items=[],this.addItems(t)}var n=this.gridOptionsWrapper.getLocaleTextFunc();this.cbGroupEnabled.setLabel(n("enabled","Enabled")),this.title&&this.setTitle(this.title),this.enabled&&this.setEnabled(this.enabled),this.setAlignItems(this.alignItems),this.hideEnabledCheckbox(this.suppressEnabledCheckbox),this.hideOpenCloseIcons(this.suppressOpenCloseIcons),this.setupExpandContract(),this.refreshAriaStatus(),this.refreshChildDisplay()},r.prototype.setupExpandContract=function(){var t=this;this.eGroupClosedIcon.appendChild(qo("columnSelectClosed",this.gridOptionsWrapper,null)),this.eGroupOpenedIcon.appendChild(qo("columnSelectOpen",this.gridOptionsWrapper,null)),this.addManagedListener(this.eTitleBar,"click",function(){return t.toggleGroupExpand()}),this.addManagedListener(this.eTitleBar,"keydown",function(n){switch(n.keyCode){case Yt.ENTER:case Yt.SPACE:n.preventDefault(),t.toggleGroupExpand();break;case Yt.RIGHT:case Yt.LEFT:n.preventDefault(),t.toggleGroupExpand(n.keyCode===Yt.RIGHT)}})},r.prototype.refreshAriaStatus=function(){this.suppressOpenCloseIcons||Y0(this.eTitleBar,this.expanded)},r.prototype.refreshChildDisplay=function(){var t=!this.suppressOpenCloseIcons;Nn(this.eToolbar,this.expanded&&!this.suppressEnabledCheckbox),Nn(this.eGroupOpenedIcon,t&&this.expanded),Nn(this.eGroupClosedIcon,t&&!this.expanded)},r.prototype.isExpanded=function(){return this.expanded},r.prototype.setAlignItems=function(t){var n=this.getGui();return this.alignItems!==t&&zi(n,"ag-group-item-alignment-"+this.alignItems),this.alignItems=t,Er(n,"ag-group-item-alignment-"+this.alignItems),this},r.prototype.toggleGroupExpand=function(t){return this.suppressOpenCloseIcons?(this.expanded=!0,this.refreshChildDisplay(),Nn(this.eContainer,!0),this):(this.expanded===(t=null!=t?t:!this.expanded)||(this.expanded=t,this.refreshAriaStatus(),this.refreshChildDisplay(),Nn(this.eContainer,t),this.dispatchEvent({type:this.expanded?r.EVENT_EXPANDED:r.EVENT_COLLAPSED})),this)},r.prototype.addItems=function(t){var n=this;t.forEach(function(c){return n.addItem(c)})},r.prototype.addItem=function(t){var n=this.eContainer,c=t instanceof dn?t.getGui():t;Er(c,"ag-group-item"),Er(c,"ag-"+this.cssIdentifier+"-group-item"),n.appendChild(c),this.items.push(c)},r.prototype.hideItem=function(t,n){Fr(this.items[n],"ag-hidden",t)},r.prototype.setTitle=function(t){return this.eTitle.innerText=t,this},r.prototype.addCssClassToTitleBar=function(t){Er(this.eTitleBar,t)},r.prototype.setEnabled=function(t,n){return this.enabled=t,this.refreshDisabledStyles(),this.toggleGroupExpand(t),n||this.cbGroupEnabled.setValue(t),this},r.prototype.isEnabled=function(){return this.enabled},r.prototype.onEnableChange=function(t){var n=this;return this.cbGroupEnabled.onValueChange(function(c){n.setEnabled(c,!0),t(c)}),this},r.prototype.hideEnabledCheckbox=function(t){return this.suppressEnabledCheckbox=t,this.refreshChildDisplay(),this.refreshDisabledStyles(),this},r.prototype.hideOpenCloseIcons=function(t){return this.suppressOpenCloseIcons=t,t&&this.toggleGroupExpand(!0),this},r.prototype.refreshDisabledStyles=function(){Fr(this.getGui(),"ag-disabled",!this.enabled),this.suppressEnabledCheckbox&&!this.enabled?(Er(this.eTitleBar,"ag-disabled-group-title-bar"),this.eTitleBar.removeAttribute("tabindex")):(zi(this.eTitleBar,"ag-disabled-group-title-bar"),this.eTitleBar.setAttribute("tabindex","0")),Fr(this.eContainer,"ag-disabled-group-container",!this.enabled)},r.EVENT_EXPANDED="expanded",r.EVENT_COLLAPSED="collapsed",ks([Bt("eTitleBar")],r.prototype,"eTitleBar",void 0),ks([Bt("eGroupOpenedIcon")],r.prototype,"eGroupOpenedIcon",void 0),ks([Bt("eGroupClosedIcon")],r.prototype,"eGroupClosedIcon",void 0),ks([Bt("eToolbar")],r.prototype,"eToolbar",void 0),ks([Bt("cbGroupEnabled")],r.prototype,"cbGroupEnabled",void 0),ks([Bt("eTitle")],r.prototype,"eTitle",void 0),ks([Bt("eContainer")],r.prototype,"eContainer",void 0),ks([zt],r.prototype,"postConstruct",null),r}(dn),q2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Kc=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},y0=function(h){function r(t,n){var c=h.call(this)||this;return c.element=t,c.dragStartPosition={x:0,y:0},c.position={x:0,y:0},c.lastSize={width:-1,height:-1},c.positioned=!1,c.resizersAdded=!1,c.resizeListeners=[],c.boundaryEl=null,c.isResizing=!1,c.isMoving=!1,c.resizable={},c.movable=!1,c.currentResizer=null,c.config=ut({},{popup:!1},n),c}return q2(r,h),r.prototype.center=function(){var t=this.offsetParent,n=t.clientHeight,f=t.clientWidth/2-this.getWidth()/2,y=n/2-this.getHeight()/2;this.offsetElement(f,y)},r.prototype.initialisePosition=function(){var t=this.config,n=t.centered,c=t.forcePopupParentAsOffsetParent,f=t.minWidth,y=t.width,T=t.minHeight,B=t.height,q=t.x,de=t.y;this.offsetParent||this.setOffsetParent();var Se=0,ke=0,je=!!this.element.offsetParent;if(je){var Qe=this.findBoundaryElement(),rt=window.getComputedStyle(Qe);if(null!=rt.minWidth){var _t=Qe.offsetWidth-this.element.offsetWidth;ke=parseInt(rt.minWidth,10)-_t}if(null!=rt.minHeight){var Vt=Qe.offsetHeight-this.element.offsetHeight;Se=parseInt(rt.minHeight,10)-Vt}}if(this.minHeight=T||Se,this.minWidth=f||ke,y&&this.setWidth(y),B&&this.setHeight(B),(!y||!B)&&this.refreshSize(),n)this.center();else if(q||de)this.offsetElement(q,de);else if(je&&c&&this.boundaryEl){var Ut=parseFloat(this.boundaryEl.style.top),Rt=parseFloat(this.boundaryEl.style.left);this.offsetElement(isNaN(Rt)?0:Rt,isNaN(Ut)?0:Ut)}this.positioned=!!this.offsetParent},r.prototype.isPositioned=function(){return this.positioned},r.prototype.getPosition=function(){return this.position},r.prototype.setMovable=function(t,n){if(this.config.popup&&t!==this.movable){this.movable=t;var c=this.moveElementDragListener||{eElement:n,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};t?(this.dragService.addDragSource(c),this.moveElementDragListener=c):(this.dragService.removeDragSource(c),this.moveElementDragListener=void 0)}},r.prototype.setResizable=function(t){var n=this;if(this.clearResizeListeners(),t?this.addResizers():this.removeResizers(),"boolean"==typeof t){if(!1===t)return;t={topLeft:t,top:t,topRight:t,right:t,bottomRight:t,bottom:t,bottomLeft:t,left:t}}Object.keys(t).forEach(function(c){var y=!!t[c],T=n.getResizerElement(c),B={dragStartPixels:0,eElement:T,onDragStart:function(de){return n.onResizeStart(de,c)},onDragging:n.onResize.bind(n),onDragStop:function(de){return n.onResizeEnd(de,c)}};(!!n.resizable[c]!==y||!n.isAlive()&&!y)&&(y?(n.dragService.addDragSource(B),n.resizeListeners.push(B),T.style.pointerEvents="all"):T.style.pointerEvents="none")})},r.prototype.removeSizeFromEl=function(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")},r.prototype.restoreLastSize=function(){this.element.style.flex="0 0 auto";var t=this.lastSize,n=t.height,c=t.width;-1!==c&&(this.element.style.width=c+"px"),-1!==n&&(this.element.style.height=n+"px")},r.prototype.getHeight=function(){return this.element.offsetHeight},r.prototype.setHeight=function(t){var n=this.config.popup,c=this.element,f=!1;if("string"==typeof t&&-1!==t.indexOf("%"))sr(c,t),t=el(c),f=!0;else if(this.positioned){var y=this.element.getBoundingClientRect(),T=this.offsetParent.getBoundingClientRect();t=Math.max(this.minHeight,t);var B=this.offsetParent.clientHeight,q=n?this.position.y:y.top;B&&t+q>B+(n?0:T.top)&&(t=B-q)}this.getHeight()!==t&&(f?(c.style.maxHeight="unset",c.style.minHeight="unset"):n?sr(c,t):(c.style.height=t+"px",c.style.flex="0 0 auto",this.lastSize.height="number"==typeof t?t:parseFloat(t)))},r.prototype.getWidth=function(){return this.element.offsetWidth},r.prototype.setWidth=function(t){var n=this.element,c=this.config.popup,f=!1;if("string"==typeof t&&-1!==t.indexOf("%"))Ta(n,t),t=z0(n),f=!0;else if(this.positioned){t=Math.max(this.minWidth,t);var y=this.offsetParent.clientWidth,T=c?this.position.x:this.element.getBoundingClientRect().left;y&&t+T>y&&(t=y-T)}this.getWidth()!==t&&(f?(n.style.maxWidth="unset",n.style.minWidth="unset"):this.config.popup?Ta(n,t):(n.style.width=t+"px",n.style.flex=" unset",this.lastSize.width="number"==typeof t?t:parseFloat(t)))},r.prototype.offsetElement=function(t,n){void 0===t&&(t=0),void 0===n&&(n=0);var c=this.config.forcePopupParentAsOffsetParent?this.boundaryEl:this.element;this.popupService.positionPopup({ePopup:c,x:t,y:n,keepWithinBounds:!0}),this.setPosition(parseFloat(c.style.left),parseFloat(c.style.top))},r.prototype.setPosition=function(t,n){this.position.x=t,this.position.y=n},r.prototype.updateDragStartPosition=function(t,n){this.dragStartPosition={x:t,y:n}},r.prototype.calculateMouseMovement=function(t){var n=t.e,f=t.isTop,T=t.topBuffer,B=n.clientX-this.dragStartPosition.x,q=n.clientY-this.dragStartPosition.y;return{movementX:this.shouldSkipX(n,!!t.isLeft,!!t.anywhereWithin,B)?0:B,movementY:this.shouldSkipY(n,!!f,T,q)?0:q}},r.prototype.shouldSkipX=function(t,n,c,f){var y=this.element.getBoundingClientRect(),T=this.offsetParent.getBoundingClientRect(),B=this.boundaryEl.getBoundingClientRect(),q=this.config.popup?this.position.x:y.left,de=q<=0&&T.left>=t.clientX||T.right<=t.clientX&&T.right<=B.right;return!!de||(n?f<0&&t.clientX>q+T.left||f>0&&t.clientX<q+T.left:c?f<0&&t.clientX>B.right||f>0&&t.clientX<q+T.left:f<0&&t.clientX>B.right||f>0&&t.clientX<B.right)},r.prototype.shouldSkipY=function(t,n,c,f){void 0===c&&(c=0);var y=this.element.getBoundingClientRect(),T=this.offsetParent.getBoundingClientRect(),B=this.boundaryEl.getBoundingClientRect(),q=this.config.popup?this.position.y:y.top,de=q<=0&&T.top>=t.clientY||T.bottom<=t.clientY&&T.bottom<=B.bottom;return!!de||(n?f<0&&t.clientY>q+T.top+c||f>0&&t.clientY<q+T.top:f<0&&t.clientY>B.bottom||f>0&&t.clientY<B.bottom)},r.prototype.createResizeMap=function(){var t=this.element;this.resizerMap={topLeft:{element:t.querySelector("[ref=eTopLeftResizer]")},top:{element:t.querySelector("[ref=eTopResizer]")},topRight:{element:t.querySelector("[ref=eTopRightResizer]")},right:{element:t.querySelector("[ref=eRightResizer]")},bottomRight:{element:t.querySelector("[ref=eBottomRightResizer]")},bottom:{element:t.querySelector("[ref=eBottomResizer]")},bottomLeft:{element:t.querySelector("[ref=eBottomLeftResizer]")},left:{element:t.querySelector("[ref=eLeftResizer]")}}},r.prototype.addResizers=function(){if(!this.resizersAdded){var t=this.element;if(t){var c=(new DOMParser).parseFromString('<div class="ag-resizer-wrapper">\n        <div ref="eTopLeftResizer" class="ag-resizer ag-resizer-topLeft"></div>\n        <div ref="eTopResizer" class="ag-resizer ag-resizer-top"></div>\n        <div ref="eTopRightResizer" class="ag-resizer ag-resizer-topRight"></div>\n        <div ref="eRightResizer" class="ag-resizer ag-resizer-right"></div>\n        <div ref="eBottomRightResizer" class="ag-resizer ag-resizer-bottomRight"></div>\n        <div ref="eBottomResizer" class="ag-resizer ag-resizer-bottom"></div>\n        <div ref="eBottomLeftResizer" class="ag-resizer ag-resizer-bottomLeft"></div>\n        <div ref="eLeftResizer" class="ag-resizer ag-resizer-left"></div>\n    </div>',"text/html").body;t.appendChild(c.firstChild),this.createResizeMap(),this.resizersAdded=!0}}},r.prototype.removeResizers=function(){this.resizerMap=void 0;var t=this.element.querySelector(".ag-resizer-wrapper");t&&this.element.removeChild(t),this.resizersAdded=!1},r.prototype.getResizerElement=function(t){return this.resizerMap[t].element},r.prototype.onResizeStart=function(t,n){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!n.match(/top/i),isRight:!!n.match(/right/i),isBottom:!!n.match(/bottom/i),isLeft:!!n.match(/left/i)},Er(this.element,"ag-resizing"),Er(this.resizerMap[n].element,"ag-active");var c=this.config;!c.popup&&!c.forcePopupParentAsOffsetParent&&this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(t.clientX,t.clientY)},r.prototype.getSiblings=function(){var n=this.element.parentElement;return n?Array.prototype.slice.call(n.children).filter(function(c){return!qa(c,"ag-hidden")}):null},r.prototype.getMinSizeOfSiblings=function(){for(var t=this.getSiblings()||[],n=0,c=0,f=0;f<t.length;f++){var y=t[f];if(y!==this.element){var B=this.minHeight||0,q=this.minWidth||0;if(y.style.flex&&"0 0 auto"!==y.style.flex){var de=window.getComputedStyle(y);de.minHeight&&(B=parseInt(de.minHeight,10)),de.minWidth&&(q=parseInt(de.minWidth,10))}else B=y.offsetHeight,q=y.offsetWidth;n+=B,c+=q}}return{height:n,width:c}},r.prototype.applySizeToSiblings=function(t){var n=null,c=this.getSiblings();if(c){for(var f=0;f<c.length;f++){var y=c[f];y!==n&&(t?y.style.height=y.offsetHeight+"px":y.style.width=y.offsetWidth+"px",y.style.flex="0 0 auto",y===this.element&&(n=c[f+1]))}n&&(n.style.removeProperty("height"),n.style.removeProperty("min-height"),n.style.removeProperty("max-height"),n.style.flex="1 1 auto")}},r.prototype.onResize=function(t){if(this.isResizing&&this.currentResizer){var n=this.config,c=n.popup,f=n.forcePopupParentAsOffsetParent,y=this.currentResizer,T=y.isTop,de=y.isLeft,Se=y.isRight||de,ke=y.isBottom||T,je=this.calculateMouseMovement({e:t,isLeft:de,isTop:T}),Qe=je.movementX,rt=je.movementY,_t=this.position.x,Vt=this.position.y,Ut=0,Rt=0;if(Se&&Qe){var qt=de?-1:1,It=this.getWidth(),on=It+Qe*qt,Br=!1;de&&(_t+(Ut=It-on)<=0||on<=this.minWidth)&&(Br=!0,Ut=0),Br||this.setWidth(on)}if(ke&&rt){qt=T?-1:1;var gn=this.getHeight(),In=gn+rt*qt,kn=!1;T?(Vt+(Rt=gn-In)<=0||In<=this.minHeight)&&(kn=!0,Rt=0):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&gn<In&&this.getMinSizeOfSiblings().height+In>this.element.parentElement.offsetHeight&&(kn=!0),kn||this.setHeight(In)}this.updateDragStartPosition(t.clientX,t.clientY),((c||f)&&Ut||Rt)&&this.offsetElement(_t+Ut,Vt+Rt)}},r.prototype.onResizeEnd=function(t,n){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null;var c={type:"resize",api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi()};zi(this.element,"ag-resizing"),zi(this.resizerMap[n].element,"ag-active"),this.dispatchEvent(c)},r.prototype.refreshSize=function(){var t=this.element;this.config.popup&&(this.config.width||this.setWidth(t.offsetWidth),this.config.height||this.setHeight(t.offsetHeight))},r.prototype.onMoveStart=function(t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,Er(this.element,"ag-moving"),this.updateDragStartPosition(t.clientX,t.clientY)},r.prototype.onMove=function(t){if(this.isMoving){var y,n=this.position,c=n.x,f=n.y;this.config.calculateTopBuffer&&(y=this.config.calculateTopBuffer());var T=this.calculateMouseMovement({e:t,isTop:!0,anywhereWithin:!0,topBuffer:y});this.offsetElement(c+T.movementX,f+T.movementY),this.updateDragStartPosition(t.clientX,t.clientY)}},r.prototype.onMoveEnd=function(){this.isMoving=!1,this.boundaryEl=null,zi(this.element,"ag-moving")},r.prototype.setOffsetParent=function(){this.offsetParent=this.config.forcePopupParentAsOffsetParent?this.popupService.getPopupParent():this.element.offsetParent},r.prototype.findBoundaryElement=function(){for(var t=this.element;t;){if("static"!==window.getComputedStyle(t).position)return t;t=t.parentElement}return this.element},r.prototype.clearResizeListeners=function(){for(;this.resizeListeners.length;){var t=this.resizeListeners.pop();this.dragService.removeDragSource(t)}},r.prototype.destroy=function(){h.prototype.destroy.call(this),this.moveElementDragListener&&this.dragService.removeDragSource(this.moveElementDragListener),this.clearResizeListeners(),this.removeResizers()},Kc([Ee("popupService")],r.prototype,"popupService",void 0),Kc([Ee("dragService")],r.prototype,"dragService",void 0),r}(ct),rh=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),C0=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},w0=function(h){function r(t){var n=h.call(this,r.getTemplate(t))||this;return n.closable=!0,n.config=t,n}return rh(r,h),r.getTemplate=function(t){var n=t&&t.cssIdentifier||"default";return'<div class="ag-panel ag-'+n+'-panel" tabindex="-1">\n            <div ref="eTitleBar" class="ag-panel-title-bar ag-'+n+'-panel-title-bar ag-unselectable">\n                <span ref="eTitle" class="ag-panel-title-bar-title ag-'+n+'-panel-title-bar-title"></span>\n                <div ref="eTitleBarButtons" class="ag-panel-title-bar-buttons ag-'+n+'-panel-title-bar-buttons"></div>\n            </div>\n            <div ref="eContentWrapper" class="ag-panel-content-wrapper ag-'+n+'-panel-content-wrapper"></div>\n        </div>'},r.prototype.postConstruct=function(){var t=this,n=this.config,c=n.component,f=n.closable,y=n.hideTitleBar,T=n.title,B=n.minWidth,q=void 0===B?250:B,de=n.width,Se=n.minHeight,ke=void 0===Se?250:Se,je=n.height,Qe=n.centered,rt=n.popup,_t=n.x,Vt=n.y;this.positionableFeature=new y0(this.getGui(),{minWidth:q,width:de,minHeight:ke,height:je,centered:Qe,x:_t,y:Vt,popup:rt,calculateTopBuffer:function(){return t.positionableFeature.getHeight()-t.getBodyHeight()}}),this.createManagedBean(this.positionableFeature);var Ut=this.getGui();c&&this.setBodyComponent(c),y?Er(this.eTitleBar,"ag-hidden"):(T&&this.setTitle(T),this.setClosable(null!=f?f:this.closable)),this.addManagedListener(this.eTitleBar,"mousedown",function(Rt){if(Ut.contains(Rt.relatedTarget)||Ut.contains(document.activeElement)||t.eTitleBarButtons.contains(Rt.target))Rt.preventDefault();else{var qt=t.eContentWrapper.querySelector("button, [href], input, select, textarea, [tabindex]");qt&&qt.focus()}}),(!rt||!this.positionableFeature.isPositioned())&&(this.renderComponent&&this.renderComponent(),this.positionableFeature.initialisePosition(),this.eContentWrapper.style.height="0")},r.prototype.renderComponent=function(){var t=this,n=this.getGui();n.focus(),this.close=function(){n.parentElement.removeChild(n),t.destroy()}},r.prototype.getHeight=function(){return this.positionableFeature.getHeight()},r.prototype.setHeight=function(t){this.positionableFeature.setHeight(t)},r.prototype.getWidth=function(){return this.positionableFeature.getWidth()},r.prototype.setWidth=function(t){this.positionableFeature.setWidth(t)},r.prototype.setClosable=function(t){if(t!==this.closable&&(this.closable=t),t){var n=this.closeButtonComp=new dn(r.CLOSE_BTN_TEMPLATE);this.getContext().createBean(n),(c=n.getGui()).appendChild(Er(Bi("close",this.gridOptionsWrapper),"ag-panel-title-bar-button-icon")),this.addTitleBarButton(n),n.addManagedListener(c,"click",this.onBtClose.bind(this))}else if(this.closeButtonComp){var c;(c=this.closeButtonComp.getGui()).parentElement.removeChild(c),this.closeButtonComp=this.destroyBean(this.closeButtonComp)}},r.prototype.setBodyComponent=function(t){t.setParentComponent(this),this.eContentWrapper.appendChild(t.getGui())},r.prototype.addTitleBarButton=function(t,n){var c=this.eTitleBarButtons,f=c.children,y=f.length;null==n&&(n=y),n=Math.max(0,Math.min(n,y));var T=t.getGui();Er(T,"ag-panel-title-bar-button"),0===n?c.insertAdjacentElement("afterbegin",T):n===y?c.insertAdjacentElement("beforeend",T):f[n-1].insertAdjacentElement("afterend",T),t.setParentComponent(this)},r.prototype.getBodyHeight=function(){return Dl(this.eContentWrapper)},r.prototype.getBodyWidth=function(){return jo(this.eContentWrapper)},r.prototype.setTitle=function(t){this.eTitle.innerText=t},r.prototype.onBtClose=function(){this.close()},r.prototype.destroy=function(){this.closeButtonComp&&(this.closeButtonComp=this.destroyBean(this.closeButtonComp));var t=this.getGui();t&&t.offsetParent&&this.close(),h.prototype.destroy.call(this)},r.CLOSE_BTN_TEMPLATE='<div class="ag-button"></div>',C0([Bt("eContentWrapper")],r.prototype,"eContentWrapper",void 0),C0([Bt("eTitleBar")],r.prototype,"eTitleBar",void 0),C0([Bt("eTitleBarButtons")],r.prototype,"eTitleBarButtons",void 0),C0([Bt("eTitle")],r.prototype,"eTitle",void 0),C0([zt],r.prototype,"postConstruct",null),r}(dn),nh=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),_0=function(){return _0=Object.assign||function(h){for(var r,t=1,n=arguments.length;t<n;t++)for(var c in r=arguments[t])Object.prototype.hasOwnProperty.call(r,c)&&(h[c]=r[c]);return h},_0.apply(this,arguments)},ih=function(h){function r(t){var n=h.call(this,_0(_0({},t),{popup:!0}))||this;return n.isMaximizable=!1,n.isMaximized=!1,n.maximizeListeners=[],n.resizeListenerDestroy=null,n.lastPosition={x:0,y:0,width:0,height:0},n}return nh(r,h),r.prototype.postConstruct=function(){var t=this,n=this.getGui(),c=this.config,f=c.movable,y=c.resizable,T=c.maximizable;Er(n,"ag-dialog"),h.prototype.postConstruct.call(this),this.addManagedListener(n,"focusin",function(B){n.contains(B.relatedTarget)||t.popupService.bringPopupToFront(n)}),f&&this.setMovable(f),T&&this.setMaximizable(T),y&&this.setResizable(y)},r.prototype.renderComponent=function(){var t=this.getGui(),n=this.config,c=n.alwaysOnTop,f=n.modal,y=n.title,T=this.gridOptionsWrapper.getLocaleTextFunc(),B=this.popupService.addPopup({modal:f,eChild:t,closeOnEsc:!0,closedCallback:this.destroy.bind(this),alwaysOnTop:c,ariaLabel:y||T("ariaLabelDialog","Dialog")});B&&(this.close=B.hideFunc)},r.prototype.toggleMaximize=function(){var t=this.positionableFeature.getPosition();if(this.isMaximized){var n=this.lastPosition,c=n.x,f=n.y,T=n.height;this.setWidth(n.width),this.setHeight(T),this.positionableFeature.offsetElement(c,f)}else this.lastPosition.width=this.getWidth(),this.lastPosition.height=this.getHeight(),this.lastPosition.x=t.x,this.lastPosition.y=t.y,this.positionableFeature.offsetElement(0,0),this.setHeight("100%"),this.setWidth("100%");this.isMaximized=!this.isMaximized,this.refreshMaximizeIcon()},r.prototype.refreshMaximizeIcon=function(){Nn(this.maximizeIcon,!this.isMaximized),Nn(this.minimizeIcon,this.isMaximized)},r.prototype.clearMaximizebleListeners=function(){this.maximizeListeners.length&&(this.maximizeListeners.forEach(function(t){return t()}),this.maximizeListeners.length=0),this.resizeListenerDestroy&&(this.resizeListenerDestroy(),this.resizeListenerDestroy=null)},r.prototype.destroy=function(){this.maximizeButtonComp=this.destroyBean(this.maximizeButtonComp),this.clearMaximizebleListeners(),h.prototype.destroy.call(this)},r.prototype.setResizable=function(t){this.positionableFeature.setResizable(t)},r.prototype.setMovable=function(t){this.positionableFeature.setMovable(t,this.eTitleBar)},r.prototype.setMaximizable=function(t){var n=this;if(!t)return this.clearMaximizebleListeners(),void(this.maximizeButtonComp&&(this.destroyBean(this.maximizeButtonComp),this.maximizeButtonComp=this.maximizeIcon=this.minimizeIcon=void 0));var c=this.eTitleBar;if(c&&t!==this.isMaximizable){var f=this.maximizeButtonComp=this.createBean(new dn('<div class="ag-dialog-button"></span>')),y=f.getGui();y.appendChild(this.maximizeIcon=Bi("maximize",this.gridOptionsWrapper)),Er(this.maximizeIcon,"ag-panel-title-bar-button-icon"),y.appendChild(this.minimizeIcon=Bi("minimize",this.gridOptionsWrapper)),Er(this.minimizeIcon,"ag-panel-title-bar-button-icon"),Er(this.minimizeIcon,"ag-hidden"),f.addManagedListener(y,"click",this.toggleMaximize.bind(this)),this.addTitleBarButton(f,0),this.maximizeListeners.push(this.addManagedListener(c,"dblclick",this.toggleMaximize.bind(this))),this.resizeListenerDestroy=this.addManagedListener(this,"resize",function(){n.isMaximized=!1,n.refreshMaximizeIcon()})}},function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);c>3&&f&&Object.defineProperty(r,t,f)}([Ee("popupService")],r.prototype,"popupService",void 0),r}(w0),oh=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Pg=function(h){function r(t,n,c){return void 0===n&&(n="ag-text-field"),void 0===c&&(c="text"),h.call(this,t,n,c)||this}return oh(r,h),r.prototype.postConstruct=function(){h.prototype.postConstruct.call(this),this.config.allowedCharPattern&&this.preventDisallowedCharacters()},r.prototype.setValue=function(t,n){var c=h.prototype.setValue.call(this,t,n);return this.eInput.value!==t&&(this.eInput.value=v(t)?t:""),c},r.prototype.preventDisallowedCharacters=function(){var t=new RegExp("["+this.config.allowedCharPattern+"]");this.addManagedListener(this.eInput,"keypress",function(f){f.key&&!t.test(f.key)&&f.preventDefault()}),this.addManagedListener(this.eInput,"paste",function(c){Z(c.clipboardData.getData("text"),function(y){return!t.test(y)})&&c.preventDefault()})},r}(Fa),J2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),ah=function(h){function r(t){return h.call(this,t,"ag-text-area",null,"textarea")||this}return J2(r,h),r.prototype.setValue=function(t,n){var c=h.prototype.setValue.call(this,t,n);return this.eInput.value=t,c},r.prototype.setCols=function(t){return this.eInput.cols=t,this},r.prototype.setRows=function(t){return this.eInput.rows=t,this},r}(Fa),Fg=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),S0=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},sh=function(h){function r(t){var n=h.call(this,t,r.TEMPLATE)||this;return n.labelAlignment="top",n}return Fg(r,h),r.prototype.init=function(){Er(this.eSlider.getGui(),"ag-slider-field")},r.prototype.onValueChange=function(t){var n=this,c=fa.EVENT_CHANGED;return this.addManagedListener(this.eText,c,function(){var f=parseFloat(n.eText.getValue());n.eSlider.setValue(f.toString(),!0),t(f||0)}),this.addManagedListener(this.eSlider,c,function(){var f=n.eSlider.getValue();n.eText.setValue(f,!0),t(parseFloat(f))}),this},r.prototype.setSliderWidth=function(t){return this.eSlider.setWidth(t),this},r.prototype.setTextFieldWidth=function(t){return this.eText.setWidth(t),this},r.prototype.setMinValue=function(t){return this.eSlider.setMinValue(t),this.eText.setMin(t),this},r.prototype.setMaxValue=function(t){return this.eSlider.setMaxValue(t),this.eText.setMax(t),this},r.prototype.getValue=function(){return this.eText.getValue()},r.prototype.setValue=function(t){return this.getValue()===t||(this.eText.setValue(t,!0),this.eSlider.setValue(t,!0),this.dispatchEvent({type:fa.EVENT_CHANGED})),this},r.prototype.setStep=function(t){return this.eSlider.setStep(t),this.eText.setStep(t),this},r.TEMPLATE='<div class="ag-slider">\n            <label ref="eLabel"></label>\n            <div class="ag-wrapper ag-slider-wrapper">\n                <ag-input-range ref="eSlider"></ag-input-range>\n                <ag-input-number-field ref="eText"></ag-input-number-field>\n            </div>\n        </div>',S0([Bt("eLabel")],r.prototype,"eLabel",void 0),S0([Bt("eSlider")],r.prototype,"eSlider",void 0),S0([Bt("eText")],r.prototype,"eText",void 0),S0([zt],r.prototype,"init",null),r}(ca),Lg=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Qi=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Qc=function(h){function r(t){var n=h.call(this,r.TEMPLATE)||this;return n.H=1,n.S=1,n.B=1,n.A=1,n.isSpectrumDragging=!1,n.isSpectrumHueDragging=!1,n.isSpectrumAlphaDragging=!1,n.colorChanged=!1,n.picker=t.picker,n}return Lg(r,h),r.prototype.postConstruct=function(){var t=this.getGui();this.initRecentColors(),this.addManagedListener(this.spectrumVal,"mousedown",this.onSpectrumDraggerDown.bind(this)),this.addManagedListener(t,"mousemove",this.onSpectrumDraggerMove.bind(this)),this.addManagedListener(this.spectrumHue,"mousedown",this.onSpectrumHueDown.bind(this)),this.addManagedListener(t,"mousemove",this.onSpectrumHueMove.bind(this)),this.addManagedListener(this.spectrumAlpha,"mousedown",this.onSpectrumAlphaDown.bind(this)),this.addManagedListener(t,"mousemove",this.onSpectrumAlphaMove.bind(this)),this.addManagedListener(document,"mouseup",this.onMouseUp.bind(this)),this.addManagedListener(this.recentColors,"click",this.onRecentColorClick.bind(this))},r.prototype.refreshSpectrumRect=function(){return this.spectrumValRect=this.spectrumVal.getBoundingClientRect()},r.prototype.refreshHueRect=function(){return this.spectrumHueRect=this.spectrumHue.getBoundingClientRect()},r.prototype.refreshAlphaRect=function(){return this.spectrumAlphaRect=this.spectrumAlpha.getBoundingClientRect()},r.prototype.onSpectrumDraggerDown=function(t){this.refreshSpectrumRect(),this.isSpectrumDragging=!0,this.moveDragger(t)},r.prototype.onSpectrumDraggerMove=function(t){this.isSpectrumDragging&&this.moveDragger(t)},r.prototype.onSpectrumHueDown=function(t){this.refreshHueRect(),this.isSpectrumHueDragging=!0,this.moveHueSlider(t)},r.prototype.onSpectrumHueMove=function(t){this.isSpectrumHueDragging&&this.moveHueSlider(t)},r.prototype.onSpectrumAlphaDown=function(t){this.refreshAlphaRect(),this.isSpectrumAlphaDragging=!0,this.moveAlphaSlider(t)},r.prototype.onSpectrumAlphaMove=function(t){this.isSpectrumAlphaDragging&&this.moveAlphaSlider(t)},r.prototype.onMouseUp=function(){this.isSpectrumDragging=!1,this.isSpectrumHueDragging=!1,this.isSpectrumAlphaDragging=!1},r.prototype.moveDragger=function(t){var n=this.spectrumValRect;if(n){var c=t.clientX-n.left,f=t.clientY-n.top;c=Math.max(c,0),c=Math.min(c,n.width),f=Math.max(f,0),f=Math.min(f,n.height),this.setSpectrumValue(c/n.width,1-f/n.height)}},r.prototype.moveHueSlider=function(t){var n=this.spectrumHueRect;if(n){var c=this.spectrumHueSlider,f=c.getBoundingClientRect(),y=t.clientX-n.left;y=Math.max(y,0),y=Math.min(y,n.width),this.H=1-y/n.width,c.style.left=y+f.width/2+"px",this.update()}},r.prototype.moveAlphaSlider=function(t){var n=this.spectrumAlphaRect;if(n){var c=this.spectrumAlphaSlider,f=c.getBoundingClientRect(),y=t.clientX-n.left;y=Math.max(y,0),y=Math.min(y,n.width),this.A=y/n.width,c.style.left=y+f.width/2+"px",this.update()}},r.prototype.update=function(){var t=Eu.fromHSB(360*this.H,this.S,this.B,this.A),n=Eu.fromHSB(360*this.H,1,1),c=t.toRgbaString(),f=this.picker;Eu.fromString(f.getValue()).toRgbaString()!==c&&(this.colorChanged=!0),f.setValue(c),this.spectrumColor.style.backgroundColor=n.toRgbaString(),this.spectrumDragger.style.backgroundColor=c},r.prototype.setSpectrumValue=function(t,n){var c=this.spectrumValRect||this.refreshSpectrumRect();if(c){var f=this.spectrumDragger,y=f.getBoundingClientRect();t=Math.max(0,t),t=Math.min(1,t),n=Math.max(0,n),n=Math.min(1,n),this.S=t,this.B=n,f.style.left=t*c.width-y.width/2+"px",f.style.top=(1-n)*c.height-y.height/2+"px",this.update()}},r.prototype.initRecentColors=function(){var n=r.recentColors.map(function(c,f){return'<div class="ag-recent-color" id='+f+' style="background-color: '+c+'; width: 15px; height: 15px;" recent-color="'+c+'"></div>'});this.recentColors.innerHTML=n.join("")},r.prototype.setValue=function(t){var n=Eu.fromString(t),c=n.toHSB(),f=c[0],y=c[1],T=c[2];this.H=(isNaN(f)?0:f)/360,this.A=n.a;var B=this.spectrumHueRect||this.refreshHueRect(),q=this.spectrumAlphaRect||this.refreshAlphaRect();this.spectrumHueSlider.style.left=(this.H-1)*-B.width+"px",this.spectrumAlphaSlider.style.left=this.A*q.width+"px",this.setSpectrumValue(y,T)},r.prototype.onRecentColorClick=function(t){var n=t.target;if(v(n.id)){var c=parseInt(n.id,10);this.setValue(r.recentColors[c]),this.destroy()}},r.prototype.addRecentColor=function(){var n=Eu.fromHSB(360*this.H,this.S,this.B,this.A).toRgbaString(),c=r.recentColors;!this.colorChanged||c[0]===n||(c=c.filter(function(f){return f!=n}),(c=[n].concat(c)).length>r.maxRecentColors&&(c=c.slice(0,r.maxRecentColors)),r.recentColors=c)},r.prototype.destroy=function(){this.addRecentColor(),h.prototype.destroy.call(this)},r.maxRecentColors=8,r.recentColors=[],r.TEMPLATE='<div class="ag-color-panel">\n            <div ref="spectrumColor" class="ag-spectrum-color">\n                <div class="ag-spectrum-sat ag-spectrum-fill">\n                    <div ref="spectrumVal" class="ag-spectrum-val ag-spectrum-fill">\n                        <div ref="spectrumDragger" class="ag-spectrum-dragger"></div>\n                    </div>\n                </div>\n            </div>\n            <div class="ag-spectrum-tools">\n                <div ref="spectrumHue" class="ag-spectrum-hue ag-spectrum-tool">\n                    <div class="ag-spectrum-hue-background"></div>\n                    <div ref="spectrumHueSlider" class="ag-spectrum-slider"></div>\n                </div>\n                <div ref="spectrumAlpha" class="ag-spectrum-alpha ag-spectrum-tool">\n                    <div class="ag-spectrum-alpha-background"></div>\n                    <div ref="spectrumAlphaSlider" class="ag-spectrum-slider"></div>\n                </div>\n                <div ref="recentColors" class="ag-recent-colors"></div>\n            </div>\n        </div>',Qi([Bt("spectrumColor")],r.prototype,"spectrumColor",void 0),Qi([Bt("spectrumVal")],r.prototype,"spectrumVal",void 0),Qi([Bt("spectrumDragger")],r.prototype,"spectrumDragger",void 0),Qi([Bt("spectrumHue")],r.prototype,"spectrumHue",void 0),Qi([Bt("spectrumHueSlider")],r.prototype,"spectrumHueSlider",void 0),Qi([Bt("spectrumAlpha")],r.prototype,"spectrumAlpha",void 0),Qi([Bt("spectrumAlphaSlider")],r.prototype,"spectrumAlphaSlider",void 0),Qi([Bt("recentColors")],r.prototype,"recentColors",void 0),Qi([zt],r.prototype,"postConstruct",null),r}(dn),Z2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ng=function(h){function r(t){var n=h.call(this,t,"ag-color-picker","colorPicker")||this;return t&&t.color&&(n.value=t.color),n}return Z2(r,h),r.prototype.postConstruct=function(){h.prototype.postConstruct.call(this),this.value&&this.setValue(this.value)},r.prototype.showPicker=function(){var t=this,n=this.getGui().getBoundingClientRect(),c=this.createBean(new ih({closable:!1,modal:!0,hideTitleBar:!0,minWidth:190,width:190,height:250,x:n.right-190,y:n.top-250}));this.isPickerDisplayed=!0,Er(c.getGui(),"ag-color-dialog");var f=this.createBean(new Qc({picker:this}));return f.addDestroyFunc(function(){c.isAlive()&&t.destroyBean(c)}),c.setParentComponent(this),c.setBodyComponent(f),f.setValue(this.getValue()),c.addDestroyFunc(function(){t.isDestroyingPicker?t.isDestroyingPicker=!1:(t.isDestroyingPicker=!0,f.isAlive()&&t.destroyBean(f)),t.isAlive()&&t.getFocusableElement().focus(),t.isPickerDisplayed=!1}),c},r.prototype.setValue=function(t){return this.value===t?this:(this.eDisplayField.style.backgroundColor=t,h.prototype.setValue.call(this,t))},r.prototype.getValue=function(){return this.value},r}(Z0),f5=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Jc=function(h){function r(t){return h.call(this,t,"ag-number-field","number")||this}return f5(r,h),r.prototype.postConstruct=function(){var t=this;h.prototype.postConstruct.call(this),this.addManagedListener(this.eInput,"blur",function(){var n=parseFloat(t.eInput.value),c=isNaN(n)?"":t.normalizeValue(n.toString());t.value!==c&&t.setValue(c)})},r.prototype.normalizeValue=function(t){if(""===t)return"";this.precision&&(t=this.adjustPrecision(t));var n=parseFloat(t);return null!=this.min&&n<this.min?t=this.min.toString():null!=this.max&&n>this.max&&(t=this.max.toString()),t},r.prototype.adjustPrecision=function(t){if(this.precision){var n=parseFloat(t).toFixed(this.precision);t=parseFloat(n).toString()}return t},r.prototype.setMin=function(t){return this.min===t||(this.min=t,Ja(this.eInput,"min",t)),this},r.prototype.setMax=function(t){return this.max===t||(this.max=t,Ja(this.eInput,"max",t)),this},r.prototype.setPrecision=function(t){return this.precision=t,this},r.prototype.setStep=function(t){return this.step===t||(this.step=t,Ja(this.eInput,"step",t)),this},r.prototype.setValue=function(t,n){return(t=this.adjustPrecision(t))!=this.normalizeValue(t)?this:h.prototype.setValue.call(this,t,n)},r}(Pg),Ig=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Zc=function(h){function r(t){return h.call(this,t,"ag-range-field","range")||this}return Ig(r,h),r.prototype.postConstruct=function(){h.prototype.postConstruct.call(this);var t=this.config,n=t.min,c=t.max,f=t.step;null!=n&&this.setMinValue(n),null!=c&&this.setMaxValue(c),this.setStep(f||1)},r.prototype.addInputListeners=function(){var t=this,n=uo();this.addManagedListener(this.eInput,n?"change":"input",function(f){t.setValue(f.target.value)})},r.prototype.setMinValue=function(t){return this.min=t,this.eInput.setAttribute("min",t.toString()),this},r.prototype.setMaxValue=function(t){return this.max=t,this.eInput.setAttribute("max",t.toString()),this},r.prototype.setStep=function(t){return this.eInput.setAttribute("step",t.toString()),this},r.prototype.setValue=function(t,n){null!=this.min&&(t=Math.max(parseFloat(t),this.min).toString()),null!=this.max&&(t=Math.min(parseFloat(t),this.max).toString());var c=h.prototype.setValue.call(this,t,n);return this.eInput.value=t,c},r}(Fa),x0=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),b0=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},$c=function(h){function r(t){var n=h.call(this,t,r.TEMPLATE)||this;return n.radius=0,n.offsetX=0,n.offsetY=0,n}return x0(r,h),r.prototype.postConstruct=function(){var t=this;h.prototype.postConstruct.call(this),this.dragListener={eElement:this.eParentCircle,dragStartPixels:0,onDragStart:function(c){t.parentCircleRect=t.eParentCircle.getBoundingClientRect()},onDragging:function(c){return t.calculateAngleDrag(c)},onDragStop:function(){}},this.dragService.addDragSource(this.dragListener),this.eAngleValue.setLabel("").setLabelWidth(5).setInputWidth(45).setMin(0).setMax(360).setValue(""+this.degrees).onValueChange(function(n){(null==n||""===n)&&(n="0"),n=t.eAngleValue.normalizeValue(n);var c=parseFloat(n);c>180&&(c-=360),t.setValue(c)}),this.updateNumberInput(),v(this.getValue())&&this.eAngleValue.setValue(this.normalizeNegativeValue(this.getValue()).toString()),this.addManagedListener(this,fa.EVENT_CHANGED,function(){t.eAngleValue.getInputElement().contains(document.activeElement)||t.updateNumberInput()})},r.prototype.updateNumberInput=function(){var t=this.normalizeNegativeValue(this.getValue());this.eAngleValue.setValue(t.toString())},r.prototype.positionChildCircle=function(t){var n=this.parentCircleRect||{width:24,height:24},c=this.eChildCircle,y=n.height/2;c.style.left=n.width/2+8*Math.cos(t)+"px",c.style.top=y+8*Math.sin(t)+"px"},r.prototype.calculatePolar=function(){var t=this.offsetX,n=this.offsetY,c=Math.atan2(n,t);this.degrees=this.toDegrees(c),this.radius=Math.sqrt(t*t+n*n),this.positionChildCircle(c)},r.prototype.calculateCartesian=function(){var t=this.toRadians(this.getValue()),n=this.getRadius();this.setOffsetX(Math.cos(t)*n).setOffsetY(Math.sin(t)*n)},r.prototype.setOffsetX=function(t){return this.offsetX!==t&&(this.offsetX=t,this.calculatePolar()),this},r.prototype.setOffsetY=function(t){return this.offsetY!==t&&(this.offsetY=t,this.calculatePolar()),this},r.prototype.calculateAngleDrag=function(t){var n=this.parentCircleRect,de=Math.atan2(t.clientY-n.top-n.height/2,t.clientX-n.left-n.width/2);this.setValue(de,!0)},r.prototype.toDegrees=function(t){return t/Math.PI*180},r.prototype.toRadians=function(t){return t/180*Math.PI},r.prototype.normalizeNegativeValue=function(t){return t<0?360+t:t},r.prototype.normalizeAngle180=function(t){return(t%=2*Math.PI)<-Math.PI?t+=2*Math.PI:t>=Math.PI&&(t-=2*Math.PI),t},r.prototype.getRadius=function(){return this.radius},r.prototype.setRadius=function(t){return this.radius===t||(this.radius=t,this.calculateCartesian()),this},r.prototype.onValueChange=function(t){var n=this;return this.addManagedListener(this,fa.EVENT_CHANGED,function(){t(n.degrees)}),this},r.prototype.getValue=function(t){return t?this.toRadians(this.degrees):this.degrees},r.prototype.setValue=function(t,n){var c;return c=n?t:this.normalizeAngle180(this.toRadians(t)),t=this.toDegrees(c),this.degrees!==t&&(this.degrees=Math.floor(t),this.calculateCartesian(),this.positionChildCircle(c),this.dispatchEvent({type:fa.EVENT_CHANGED})),this},r.prototype.setWidth=function(t){return Ta(this.getGui(),t),this},r.prototype.destroy=function(){this.dragService.removeDragSource(this.dragListener),h.prototype.destroy.call(this)},r.TEMPLATE='<div class="ag-angle-select">\n            <div ref="eLabel"></div>\n            <div class="ag-wrapper ag-angle-select-wrapper">\n                <div ref="eAngleSelectField" class="ag-angle-select-field">\n                    <div ref="eParentCircle" class="ag-angle-select-parent-circle">\n                        <div ref="eChildCircle" class="ag-angle-select-child-circle"></div>\n                    </div>\n                </div>\n                <ag-input-number-field ref="eAngleValue"></ag-input-number-field>\n            </div>\n        </div>',b0([Bt("eLabel")],r.prototype,"eLabel",void 0),b0([Bt("eParentCircle")],r.prototype,"eParentCircle",void 0),b0([Bt("eChildCircle")],r.prototype,"eChildCircle",void 0),b0([Bt("eAngleValue")],r.prototype,"eAngleValue",void 0),b0([Ee("dragService")],r.prototype,"dragService",void 0),r}(ca),kg=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),lh=function(h){function r(t){return h.call(this,t,"ag-toggle-button")||this}return kg(r,h),r.prototype.setValue=function(t,n){return h.prototype.setValue.call(this,t,n),Fr(this.getGui(),"ag-selected",this.getValue()),this},r}(dl),Bg=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),ef=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},tf=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return Bg(r,h),r.prototype.getFirstRow=function(){var n,t=0;return this.pinnedRowModel.getPinnedTopRowCount()?n=W.PINNED_TOP:this.rowModel.getRowCount()?(n=null,t=this.paginationProxy.getPageFirstRow()):this.pinnedRowModel.getPinnedBottomRowCount()&&(n=W.PINNED_BOTTOM),void 0===n?null:{rowIndex:t,rowPinned:n}},r.prototype.getLastRow=function(){var t,n=null,c=this.pinnedRowModel.getPinnedBottomRowCount(),f=this.pinnedRowModel.getPinnedTopRowCount();return c?(n=W.PINNED_BOTTOM,t=c-1):this.rowModel.getRowCount()?(n=null,t=this.paginationProxy.getPageLastRow()):f&&(n=W.PINNED_TOP,t=f-1),void 0===t?null:{rowIndex:t,rowPinned:n}},r.prototype.getRowNode=function(t){switch(t.rowPinned){case W.PINNED_TOP:return this.pinnedRowModel.getPinnedTopRowData()[t.rowIndex];case W.PINNED_BOTTOM:return this.pinnedRowModel.getPinnedBottomRowData()[t.rowIndex];default:return this.rowModel.getRow(t.rowIndex)}},r.prototype.sameRow=function(t,n){return!t&&!n||!(t&&!n||!t&&n)&&t.rowIndex===n.rowIndex&&t.rowPinned==n.rowPinned},r.prototype.before=function(t,n){switch(t.rowPinned){case W.PINNED_TOP:if(n.rowPinned!==W.PINNED_TOP)return!0;break;case W.PINNED_BOTTOM:if(n.rowPinned!==W.PINNED_BOTTOM)return!1;break;default:if(v(n.rowPinned))return n.rowPinned!==W.PINNED_TOP}return t.rowIndex<n.rowIndex},ef([Ee("rowModel")],r.prototype,"rowModel",void 0),ef([Ee("pinnedRowModel")],r.prototype,"pinnedRowModel",void 0),ef([Ee("paginationProxy")],r.prototype,"paginationProxy",void 0),ef([Kt("rowPositionUtils")],r)}(ct),$2=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),uh=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return $2(r,h),r.prototype.createId=function(t){return this.createIdFromValues(t.rowIndex,t.column,t.rowPinned)},r.prototype.createIdFromValues=function(t,n,c){return t+"."+(null==c?"null":c)+"."+n.getId()},r.prototype.equals=function(t,n){return t.column===n.column&&t.rowPinned===n.rowPinned&&t.rowIndex===n.rowIndex},r=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f}([Kt("cellPositionUtils")],r),r}(ct),uu=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),cu=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Gg=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return uu(r,h),r.prototype.init=function(){this.setPinnedTopRowData(this.gridOptionsWrapper.getPinnedTopRowData()),this.setPinnedBottomRowData(this.gridOptionsWrapper.getPinnedBottomRowData())},r.prototype.isEmpty=function(t){return C(t===W.PINNED_TOP?this.pinnedTopRows:this.pinnedBottomRows)},r.prototype.isRowsToRender=function(t){return!this.isEmpty(t)},r.prototype.getRowAtPixel=function(t,n){var c=n===W.PINNED_TOP?this.pinnedTopRows:this.pinnedBottomRows;if(C(c))return 0;for(var f=0;f<c.length;f++){var y=c[f];if(y.rowTop+y.rowHeight-1>=t)return f}return c.length-1},r.prototype.setPinnedTopRowData=function(t){this.pinnedTopRows=this.createNodesFromData(t,!0),this.eventService.dispatchEvent({type:Ge.EVENT_PINNED_ROW_DATA_CHANGED,api:this.gridApi,columnApi:this.columnApi})},r.prototype.setPinnedBottomRowData=function(t){this.pinnedBottomRows=this.createNodesFromData(t,!1),this.eventService.dispatchEvent({type:Ge.EVENT_PINNED_ROW_DATA_CHANGED,api:this.gridApi,columnApi:this.columnApi})},r.prototype.createNodesFromData=function(t,n){var c=this,f=[];if(t){var y=0;t.forEach(function(T,B){var q=new un(c.beans);q.data=T,q.id=(n?un.ID_PREFIX_TOP_PINNED:un.ID_PREFIX_BOTTOM_PINNED)+B,q.rowPinned=n?W.PINNED_TOP:W.PINNED_BOTTOM,q.setRowTop(y),q.setRowHeight(c.gridOptionsWrapper.getRowHeightForNode(q).height),q.setRowIndex(B),y+=q.rowHeight,f.push(q)})}return f},r.prototype.getPinnedTopRowData=function(){return this.pinnedTopRows},r.prototype.getPinnedBottomRowData=function(){return this.pinnedBottomRows},r.prototype.getPinnedTopTotalHeight=function(){return this.getTotalHeight(this.pinnedTopRows)},r.prototype.getPinnedTopRowCount=function(){return this.pinnedTopRows?this.pinnedTopRows.length:0},r.prototype.getPinnedBottomRowCount=function(){return this.pinnedBottomRows?this.pinnedBottomRows.length:0},r.prototype.getPinnedTopRow=function(t){return this.pinnedTopRows[t]},r.prototype.getPinnedBottomRow=function(t){return this.pinnedBottomRows[t]},r.prototype.forEachPinnedTopRow=function(t){C(this.pinnedTopRows)||this.pinnedTopRows.forEach(t)},r.prototype.forEachPinnedBottomRow=function(t){C(this.pinnedBottomRows)||this.pinnedBottomRows.forEach(t)},r.prototype.getPinnedBottomTotalHeight=function(){return this.getTotalHeight(this.pinnedBottomRows)},r.prototype.getTotalHeight=function(t){if(!t||0===t.length)return 0;var n=H(t);return n.rowTop+n.rowHeight},cu([Ee("columnApi")],r.prototype,"columnApi",void 0),cu([Ee("gridApi")],r.prototype,"gridApi",void 0),cu([Ee("beans")],r.prototype,"beans",void 0),cu([zt],r.prototype,"init",null),cu([Kt("pinnedRowModel")],r)}(ct),t3=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),ss=function(r){this.cellValueChanges=r},ch=function(h){function r(t,n,c){var f=h.call(this,t)||this;return f.initialRange=n,f.finalRange=c,f}return t3(r,h),r}(ss),Vg=function(){function h(r){this.actionStack=[],this.maxStackSize=r||h.DEFAULT_STACK_SIZE,this.actionStack=new Array(this.maxStackSize)}return h.prototype.pop=function(){return this.actionStack.pop()},h.prototype.push=function(r){!(r.cellValueChanges&&r.cellValueChanges.length>0)||(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(r))},h.prototype.clear=function(){this.actionStack=[]},h.prototype.getCurrentStackSize=function(){return this.actionStack.length},h.DEFAULT_STACK_SIZE=10,h}(),r3=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Bs=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},lo=function(h){function r(){var t=null!==h&&h.apply(this,arguments)||this;return t.cellValueChanges=[],t.activeCellEdit=null,t.activeRowEdit=null,t.isPasting=!1,t.isFilling=!1,t.onCellValueChanged=function(n){var c={column:n.column,rowIndex:n.rowIndex,rowPinned:n.rowPinned},f=null!==t.activeCellEdit&&t.cellPositionUtils.equals(t.activeCellEdit,c),y=null!==t.activeRowEdit&&t.rowPositionUtils.sameRow(t.activeRowEdit,c);if(f||y||t.isPasting||t.isFilling){var Se=n.oldValue,ke=n.value,je={rowPinned:n.rowPinned,rowIndex:n.rowIndex,columnId:n.column.getColId(),newValue:ke,oldValue:Se};t.cellValueChanges.push(je)}},t.clearStacks=function(){t.undoStack.clear(),t.redoStack.clear()},t}return r3(r,h),r.prototype.init=function(){if(this.gridOptionsWrapper.isUndoRedoCellEditing()){var t=this.gridOptionsWrapper.getUndoRedoCellEditingLimit();t<=0||(this.undoStack=new Vg(t),this.redoStack=new Vg(t),this.addRowEditingListeners(),this.addCellEditingListeners(),this.addPasteListeners(),this.addFillListeners(),this.addManagedListener(this.eventService,Ge.EVENT_CELL_VALUE_CHANGED,this.onCellValueChanged),this.addManagedListener(this.eventService,Ge.EVENT_MODEL_UPDATED,this.clearStacks),this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_PIVOT_MODE_CHANGED,this.clearStacks),this.addManagedListener(this.eventService,Ge.EVENT_NEW_COLUMNS_LOADED,this.clearStacks),this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_GROUP_OPENED,this.clearStacks),this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_ROW_GROUP_CHANGED,this.clearStacks),this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_MOVED,this.clearStacks),this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_PINNED,this.clearStacks),this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_VISIBLE,this.clearStacks),this.addManagedListener(this.eventService,Ge.EVENT_ROW_DRAG_END,this.clearStacks))}},r.prototype.getCurrentUndoStackSize=function(){return this.undoStack?this.undoStack.getCurrentStackSize():0},r.prototype.getCurrentRedoStackSize=function(){return this.redoStack?this.redoStack.getCurrentStackSize():0},r.prototype.undo=function(){if(this.undoStack){var t=this.undoStack.pop();!t||!t.cellValueChanges||(this.processAction(t,function(n){return n.oldValue}),t instanceof ch?this.processRangeAndCellFocus(t.cellValueChanges,t.initialRange):this.processRangeAndCellFocus(t.cellValueChanges),this.redoStack.push(t))}},r.prototype.redo=function(){if(this.redoStack){var t=this.redoStack.pop();!t||!t.cellValueChanges||(this.processAction(t,function(n){return n.newValue}),t instanceof ch?this.processRangeAndCellFocus(t.cellValueChanges,t.finalRange):this.processRangeAndCellFocus(t.cellValueChanges),this.undoStack.push(t))}},r.prototype.processAction=function(t,n){var c=this;t.cellValueChanges.forEach(function(f){var B=f.columnId,de=c.getRowNode({rowIndex:f.rowIndex,rowPinned:f.rowPinned});!de.displayed||de.setDataValue(B,n(f))})},r.prototype.processRangeAndCellFocus=function(t,n){var c;if(n){var f=n.startRow,y=n.endRow;return c={rowPinned:f.rowPinned,rowIndex:f.rowIndex,columnId:n.startColumn.getColId()},this.setLastFocusedCell(c),void this.gridApi.addCellRange({rowStartIndex:f.rowIndex,rowStartPinned:f.rowPinned,rowEndIndex:y.rowIndex,rowEndPinned:y.rowPinned,columnStart:n.startColumn,columns:n.columns})}var B=t[0],ke=this.getRowNode({rowIndex:B.rowIndex,rowPinned:B.rowPinned});this.setLastFocusedCell(c={rowPinned:B.rowPinned,rowIndex:ke.rowIndex,columnId:B.columnId})},r.prototype.setLastFocusedCell=function(t){var n=t.rowIndex,c=t.columnId,f=t.rowPinned;this.gridApi.ensureIndexVisible(n),this.gridApi.ensureColumnVisible(c),ne.isRegistered(e.GXE.RangeSelectionModule)&&this.gridApi.clearRangeSelection(),this.focusService.setFocusedCell(n,c,f,!0)},r.prototype.addRowEditingListeners=function(){var t=this;this.addManagedListener(this.eventService,Ge.EVENT_ROW_EDITING_STARTED,function(n){t.activeRowEdit={rowIndex:n.rowIndex,rowPinned:n.rowPinned}}),this.addManagedListener(this.eventService,Ge.EVENT_ROW_EDITING_STOPPED,function(){var n=new ss(t.cellValueChanges);t.pushActionsToUndoStack(n),t.activeRowEdit=null})},r.prototype.addCellEditingListeners=function(){var t=this;this.addManagedListener(this.eventService,Ge.EVENT_CELL_EDITING_STARTED,function(n){t.activeCellEdit={column:n.column,rowIndex:n.rowIndex,rowPinned:n.rowPinned}}),this.addManagedListener(this.eventService,Ge.EVENT_CELL_EDITING_STOPPED,function(){if(t.activeCellEdit=null,!t.activeRowEdit&&!t.isPasting&&!t.isFilling){var c=new ss(t.cellValueChanges);t.pushActionsToUndoStack(c)}})},r.prototype.addPasteListeners=function(){var t=this;this.addManagedListener(this.eventService,Ge.EVENT_PASTE_START,function(){t.isPasting=!0}),this.addManagedListener(this.eventService,Ge.EVENT_PASTE_END,function(){var n=new ss(t.cellValueChanges);t.pushActionsToUndoStack(n),t.isPasting=!1})},r.prototype.addFillListeners=function(){var t=this;this.addManagedListener(this.eventService,Ge.EVENT_FILL_START,function(){t.isFilling=!0}),this.addManagedListener(this.eventService,Ge.EVENT_FILL_END,function(n){var c=new ch(t.cellValueChanges,n.initialRange,n.finalRange);t.pushActionsToUndoStack(c),t.isFilling=!1})},r.prototype.pushActionsToUndoStack=function(t){this.undoStack.push(t),this.cellValueChanges=[],this.redoStack.clear()},r.prototype.getRowNode=function(t){switch(t.rowPinned){case W.PINNED_TOP:return this.pinnedRowModel.getPinnedTopRowData()[t.rowIndex];case W.PINNED_BOTTOM:return this.pinnedRowModel.getPinnedBottomRowData()[t.rowIndex];default:return this.rowModel.getRow(t.rowIndex)}},Bs([Ee("focusService")],r.prototype,"focusService",void 0),Bs([Ee("gridApi")],r.prototype,"gridApi",void 0),Bs([Ee("rowModel")],r.prototype,"rowModel",void 0),Bs([Ee("pinnedRowModel")],r.prototype,"pinnedRowModel",void 0),Bs([Ee("cellPositionUtils")],r.prototype,"cellPositionUtils",void 0),Bs([Ee("rowPositionUtils")],r.prototype,"rowPositionUtils",void 0),Bs([zt],r.prototype,"init",null),Bs([Kt("undoRedoService")],r)}(ct),n3=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),fh=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Ug=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return n3(r,h),r.prototype.findHeader=function(t,n){var c;if(c=t.column instanceof xt?this.columnModel["getDisplayedGroup"+n](t.column):this.columnModel["getDisplayedCol"+n](t.column))return{column:c,headerRowIndex:t.headerRowIndex}},r.prototype.findColAtEdgeForHeaderRow=function(t,n){var c=this.columnModel.getAllDisplayedColumns(),f=c["start"===n?0:c.length-1];if(f){var T=this.ctrlsService.getHeaderRowContainerCtrl(f.getPinned()).getRowType(t);return console.log("level="+t+" type = "+T),T==e.A6C.COLUMN_GROUP?{headerRowIndex:t,column:this.columnModel.getColumnGroupAtLevel(f,t)}:{headerRowIndex:null==T?-1:t,column:f}}},fh([Ee("columnModel")],r.prototype,"columnModel",void 0),fh([Ee("ctrlsService")],r.prototype,"ctrlsService",void 0),fh([Kt("headerPositionUtils")],r)}(ct),i3=function(){function h(){}return h.prototype.buildColumnDefs=function(r,t,n){var c=this,f=[],y={};return r.forEach(function(T){for(var q=!0,de=c.createDefFromColumn(T,t,n),Se=T.getOriginalParent();Se;){var ke=null;if(Se.isPadding())Se=Se.getOriginalParent();else{var je=y[Se.getGroupId()];if(je){je.children.push(de),q=!1;break}(ke=c.createDefFromGroup(Se))&&(ke.children=[de],y[ke.groupId]=ke,de=ke,Se=Se.getOriginalParent())}}q&&f.push(de)}),f},h.prototype.createDefFromGroup=function(r){var t=xe(r.getColGroupDef(),["children"]);return t&&(t.groupId=r.getGroupId()),t},h.prototype.createDefFromColumn=function(r,t,n){var c=xe(r.getColDef());return c.colId=r.getColId(),c.width=r.getActualWidth(),c.rowGroup=r.isRowGroupActive(),c.rowGroupIndex=r.isRowGroupActive()?t.indexOf(r):null,c.pivot=r.isPivotActive(),c.pivotIndex=r.isPivotActive()?n.indexOf(r):null,c.aggFunc=r.isValueActive()?r.getAggFunc():null,c.hide=!r.isVisible()||void 0,c.pinned=r.isPinned()?r.getPinned():null,c.sort=r.getSort()?r.getSort():null,c.sortIndex=null!=r.getSortIndex()?r.getSortIndex():null,c},h=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f}([Kt("columnDefFactory")],h),h}(),Wg=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},o3=function(){function h(){}return h.prototype.getInitialRowClasses=function(r){var t=[];return v(r.extraCssClass)&&t.push(r.extraCssClass),t.push("ag-row"),t.push(r.rowFocused?"ag-row-focus":"ag-row-no-focus"),r.fadeRowIn&&t.push("ag-opacity-zero"),t.push(r.rowIsEven?"ag-row-even":"ag-row-odd"),r.rowNode.isRowPinned()&&t.push("ag-row-pinned"),r.rowNode.isSelected()&&t.push("ag-row-selected"),r.rowNode.footer&&t.push("ag-row-footer"),t.push("ag-row-level-"+r.rowLevel),r.rowNode.stub&&t.push("ag-row-loading"),r.fullWidthRow&&t.push("ag-full-width-row"),r.expandable&&(t.push("ag-row-group"),t.push(r.rowNode.expanded?"ag-row-group-expanded":"ag-row-group-contracted")),r.rowNode.dragging&&t.push("ag-row-dragging"),fe(t,this.processClassesFromGridOptions(r.rowNode,r.scope)),fe(t,this.preProcessRowClassRules(r.rowNode,r.scope)),t.push(r.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),r.firstRowOnPage&&t.push("ag-row-first"),r.lastRowOnPage&&t.push("ag-row-last"),r.fullWidthRow&&(r.pinned===W.PINNED_LEFT&&t.push("ag-cell-last-left-pinned"),r.pinned===W.PINNED_RIGHT&&t.push("ag-cell-first-right-pinned")),t},h.prototype.processClassesFromGridOptions=function(r,t){var n=[],c=function(de){"string"==typeof de?n.push(de):Array.isArray(de)&&de.forEach(function(Se){return n.push(Se)})},f=this.gridOptionsWrapper.getRowClass();if(f){if("function"==typeof f)return console.warn("AG Grid: rowClass should not be a function, please use getRowClass instead"),[];c(f)}var y=this.gridOptionsWrapper.getRowClassFunc();return y&&c(y({data:r.data,node:r,rowIndex:r.rowIndex,$scope:t,api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi(),context:this.gridOptionsWrapper.getContext()})),n},h.prototype.preProcessRowClassRules=function(r,t){var n=[];return this.processRowClassRules(r,t,function(c){n.push(c)},function(c){}),n},h.prototype.processRowClassRules=function(r,t,n,c){var f={data:r.data,node:r,rowIndex:r.rowIndex,api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi(),$scope:t,context:this.gridOptionsWrapper.getContext()};this.stylingService.processClassRules(this.gridOptionsWrapper.rowClassRules(),f,n,c)},h.prototype.calculateRowLevel=function(r){return r.group?r.level:r.parent?r.parent.level+1:0},Wg([Ee("stylingService")],h.prototype,"stylingService",void 0),Wg([Ee("gridOptionsWrapper")],h.prototype,"gridOptionsWrapper",void 0),Wg([Kt("rowCssClassCalculator")],h)}(),a3=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),dh=function(h){function r(t){var n=h.call(this)||this;return n.state=r.STATE_WAITING_TO_LOAD,n.version=0,n.id=t,n}return a3(r,h),r.prototype.getId=function(){return this.id},r.prototype.load=function(){this.state=r.STATE_LOADING,this.loadFromDatasource()},r.prototype.getVersion=function(){return this.version},r.prototype.setStateWaitingToLoad=function(){this.version++,this.state=r.STATE_WAITING_TO_LOAD},r.prototype.getState=function(){return this.state},r.prototype.pageLoadFailed=function(t){this.isRequestMostRecentAndLive(t)&&(this.state=r.STATE_FAILED,this.processServerFail()),this.dispatchLoadCompleted(!1)},r.prototype.success=function(t,n){this.successCommon(t,n)},r.prototype.pageLoaded=function(t,n,c){this.successCommon(t,{rowData:n,rowCount:c})},r.prototype.isRequestMostRecentAndLive=function(t){var n=t===this.version,c=this.isAlive();return n&&c},r.prototype.successCommon=function(t,n){this.dispatchLoadCompleted(),this.isRequestMostRecentAndLive(t)&&(this.state=r.STATE_LOADED,this.processServerResult(n))},r.prototype.dispatchLoadCompleted=function(t){void 0===t&&(t=!0),this.dispatchEvent({type:r.EVENT_LOAD_COMPLETE,success:t,block:this})},r.EVENT_LOAD_COMPLETE="loadComplete",r.STATE_WAITING_TO_LOAD="needsLoading",r.STATE_LOADING="loading",r.STATE_LOADED="loaded",r.STATE_FAILED="failed",r}(ct),zg=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),jg=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},s3=function(h,r){return function(t,n){r(t,n,h)}},Xg=function(h){function r(){var n=null!==h&&h.apply(this,arguments)||this;return n.activeBlockLoadsCount=0,n.blocks=[],n.active=!0,n}var t;return zg(r,h),t=r,r.prototype.postConstruct=function(){this.maxConcurrentRequests=this.gridOptionsWrapper.getMaxConcurrentDatasourceRequests();var n=this.gridOptionsWrapper.getBlockLoadDebounceMillis();n&&n>0&&(this.checkBlockToLoadDebounce=wr.debounce(this.performCheckBlocksToLoad.bind(this),n))},r.prototype.setBeans=function(n){this.logger=n.create("RowNodeBlockLoader")},r.prototype.addBlock=function(n){this.blocks.push(n),n.addEventListener(dh.EVENT_LOAD_COMPLETE,this.loadComplete.bind(this)),this.checkBlockToLoad()},r.prototype.removeBlock=function(n){wr.removeFromArray(this.blocks,n)},r.prototype.destroy=function(){h.prototype.destroy.call(this),this.active=!1},r.prototype.loadComplete=function(){this.activeBlockLoadsCount--,this.checkBlockToLoad(),0==this.activeBlockLoadsCount&&this.dispatchEvent({type:t.BLOCK_LOADER_FINISHED_EVENT})},r.prototype.checkBlockToLoad=function(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()},r.prototype.performCheckBlocksToLoad=function(){if(this.active){if(this.printCacheStatus(),null!=this.maxConcurrentRequests&&this.activeBlockLoadsCount>=this.maxConcurrentRequests)return void this.logger.log("checkBlockToLoad: max loads exceeded");var n=null;this.blocks.forEach(function(c){c.getState()===dh.STATE_WAITING_TO_LOAD&&(n=c)}),n&&(n.load(),this.activeBlockLoadsCount++,this.printCacheStatus())}},r.prototype.getBlockState=function(){var n={};return this.blocks.forEach(function(c){var f=c.getBlockStateJson();n[f.id]=f.state}),n},r.prototype.printCacheStatus=function(){this.logger.isLogging()&&this.logger.log("printCacheStatus: activePageLoadsCount = "+this.activeBlockLoadsCount+", blocks = "+JSON.stringify(this.getBlockState()))},r.prototype.isLoading=function(){return this.activeBlockLoadsCount>0},r.BLOCK_LOADER_FINISHED_EVENT="blockLoaderFinished",jg([zt],r.prototype,"postConstruct",null),jg([s3(0,Dn("loggerFactory"))],r.prototype,"setBeans",null),t=jg([Kt("rowNodeBlockLoader")],r)}(ct),rf=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},l3=function(){function h(){}return h.prototype.doFullSort=function(r,t){var c=r.map(function(y,T){return{currentPos:T,rowNode:y}});return c.sort(this.compareRowNodes.bind(this,t)),c.map(function(f){return f.rowNode})},h.prototype.compareRowNodes=function(r,t,n){for(var c=t.rowNode,f=n.rowNode,y=0,T=r.length;y<T;y++){var ke,B=r[y],q=B.sort===W.SORT_DESC,de=this.getValue(c,B.column),Se=this.getValue(f,B.column),je=this.getComparator(B,c);if(ke=je?je(de,Se,c,f,q):wr.defaultComparator(de,Se,this.gridOptionsWrapper.isAccentedSort()),!isNaN(ke)&&0!==ke)return B.sort===W.SORT_ASC?ke:-1*ke}return t.currentPos-n.currentPos},h.prototype.getComparator=function(r,t){var n=r.column,c=n.getColDef().comparator;if(null!=c)return c;if(t.rowGroupColumn)return t.rowGroupColumn.getColDef().comparator;if(n.getColDef().showRowGroup){var f=!t.group&&n.getColDef().field;if(f){var y=this.columnModel.getPrimaryColumn(f);if(y)return y.getColDef().comparator}}},h.prototype.getValue=function(r,t){return this.valueService.getValue(t,r,!1,!1)},rf([Ee("gridOptionsWrapper")],h.prototype,"gridOptionsWrapper",void 0),rf([Ee("valueService")],h.prototype,"valueService",void 0),rf([Ee("columnModel")],h.prototype,"columnModel",void 0),rf([Kt("rowNodeSorter")],h)}(),d5=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Yg=function(h){function r(){var t=null!==h&&h.apply(this,arguments)||this;return t.ready=!1,t.readyCallbacks=[],t}return d5(r,h),r.prototype.checkReady=function(){if(this.ready=null!=this.gridCtrl&&null!=this.gridBodyCtrl&&null!=this.centerRowContainerCtrl&&null!=this.leftRowContainerCtrl&&null!=this.rightRowContainerCtrl&&null!=this.bottomCenterRowContainerCtrl&&null!=this.bottomLeftRowContainerCtrl&&null!=this.bottomRightRowContainerCtrl&&null!=this.topCenterRowContainerCtrl&&null!=this.topLeftRowContainerCtrl&&null!=this.topRightRowContainerCtrl&&null!=this.centerHeaderRowContainerCtrl&&null!=this.leftHeaderRowContainerCtrl&&null!=this.rightHeaderRowContainerCtrl&&null!=this.fakeHScrollCtrl&&null!=this.gridHeaderCtrl,this.ready){var t=this.createReadyParams();this.readyCallbacks.forEach(function(n){return n(t)}),this.readyCallbacks.length=0}},r.prototype.whenReady=function(t){this.ready?t(this.createReadyParams()):this.readyCallbacks.push(t)},r.prototype.createReadyParams=function(){return{centerRowContainerCtrl:this.centerRowContainerCtrl,leftRowContainerCtrl:this.leftRowContainerCtrl,rightRowContainerCtrl:this.rightRowContainerCtrl,bottomCenterRowContainerCtrl:this.bottomCenterRowContainerCtrl,bottomLeftRowContainerCtrl:this.bottomLeftRowContainerCtrl,bottomRightRowContainerCtrl:this.bottomRightRowContainerCtrl,topCenterRowContainerCtrl:this.topCenterRowContainerCtrl,topLeftRowContainerCtrl:this.topLeftRowContainerCtrl,topRightRowContainerCtrl:this.topRightRowContainerCtrl,centerHeaderRowContainerCtrl:this.centerHeaderRowContainerCtrl,leftHeaderRowContainerCtrl:this.leftHeaderRowContainerCtrl,rightHeaderRowContainerCtrl:this.rightHeaderRowContainerCtrl,fakeHScrollCtrl:this.fakeHScrollCtrl,gridBodyCtrl:this.gridBodyCtrl,gridCtrl:this.gridCtrl,gridHeaderCtrl:this.gridHeaderCtrl}},r.prototype.registerFakeHScrollCtrl=function(t){this.fakeHScrollCtrl=t,this.checkReady()},r.prototype.registerGridHeaderCtrl=function(t){this.gridHeaderCtrl=t,this.checkReady()},r.prototype.registerCenterRowContainerCtrl=function(t){this.centerRowContainerCtrl=t,this.checkReady()},r.prototype.registerLeftRowContainerCtrl=function(t){this.leftRowContainerCtrl=t,this.checkReady()},r.prototype.registerRightRowContainerCtrl=function(t){this.rightRowContainerCtrl=t,this.checkReady()},r.prototype.registerTopCenterRowContainerCtrl=function(t){this.topCenterRowContainerCtrl=t,this.checkReady()},r.prototype.registerTopLeftRowContainerCon=function(t){this.topLeftRowContainerCtrl=t,this.checkReady()},r.prototype.registerTopRightRowContainerCtrl=function(t){this.topRightRowContainerCtrl=t,this.checkReady()},r.prototype.registerBottomCenterRowContainerCtrl=function(t){this.bottomCenterRowContainerCtrl=t,this.checkReady()},r.prototype.registerBottomLeftRowContainerCtrl=function(t){this.bottomLeftRowContainerCtrl=t,this.checkReady()},r.prototype.registerBottomRightRowContainerCtrl=function(t){this.bottomRightRowContainerCtrl=t,this.checkReady()},r.prototype.registerHeaderContainer=function(t,n){switch(n){case W.PINNED_LEFT:this.leftHeaderRowContainerCtrl=t;break;case W.PINNED_RIGHT:this.rightHeaderRowContainerCtrl=t;break;default:this.centerHeaderRowContainerCtrl=t}this.checkReady()},r.prototype.registerGridBodyCtrl=function(t){this.gridBodyCtrl=t,this.checkReady()},r.prototype.registerGridCtrl=function(t){this.gridCtrl=t,this.checkReady()},r.prototype.getFakeHScrollCtrl=function(){return this.fakeHScrollCtrl},r.prototype.getGridHeaderCtrl=function(){return this.gridHeaderCtrl},r.prototype.getGridCtrl=function(){return this.gridCtrl},r.prototype.getCenterRowContainerCtrl=function(){return this.centerRowContainerCtrl},r.prototype.getTopCenterRowContainerCtrl=function(){return this.topCenterRowContainerCtrl},r.prototype.getBottomCenterRowContainerCtrl=function(){return this.bottomCenterRowContainerCtrl},r.prototype.getGridBodyCtrl=function(){return this.gridBodyCtrl},r.prototype.getHeaderRowContainerCtrls=function(){return[this.leftHeaderRowContainerCtrl,this.rightHeaderRowContainerCtrl,this.centerHeaderRowContainerCtrl]},r.prototype.getHeaderRowContainerCtrl=function(t){switch(t){case W.PINNED_LEFT:return this.leftHeaderRowContainerCtrl;case W.PINNED_RIGHT:return this.rightHeaderRowContainerCtrl;default:return this.centerHeaderRowContainerCtrl}},r=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f}([Kt("ctrlsService")],r),r}(ct),qg=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),h5=function(h){function r(){var t=null!==h&&h.apply(this,arguments)||this;return t.registry={},t}return qg(r,h),r.prototype.register=function(t){this.registry[t.controllerName]=t.controllerClass},r.prototype.getInstance=function(t){var n=this.registry[t];if(null!=n)return new n},r=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f}([Kt("ctrlsFactory")],r),r}(ct),ga=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),ph=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},p5=function(h){function r(){return h.call(this)||this}return ga(r,h),r.prototype.setComp=function(t,n,c,f){this.view=t,this.eViewport=c,this.eContainer=f,this.eGui=n,this.addManagedListener(this.eventService,Ge.EVENT_SCROLL_VISIBILITY_CHANGED,this.onScrollVisibilityChanged.bind(this)),this.onScrollVisibilityChanged();var y=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedListener(this.eventService,Ge.EVENT_DISPLAYED_COLUMNS_CHANGED,y),this.addManagedListener(this.eventService,Ge.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,y),this.addManagedListener(this.gridOptionsWrapper,vr.PROP_DOM_LAYOUT,y),this.setFakeHScrollSpacerWidths(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()),this.ctrlsService.registerFakeHScrollCtrl(this)},r.prototype.addActiveListenerToggles=function(){var t=this;["mouseenter","mousedown","touchstart"].forEach(function(f){return t.addManagedListener(t.eGui,f,function(){return t.view.addOrRemoveCssClass("ag-scrollbar-active",!0)})}),["mouseleave","mouseup","touchend"].forEach(function(f){return t.addManagedListener(t.eGui,f,function(){return t.view.addOrRemoveCssClass("ag-scrollbar-active",!1)})})},r.prototype.postConstruct=function(){this.enableRtl=this.gridOptionsWrapper.isEnableRtl(),this.invisibleScrollbar=Ya()},r.prototype.onScrollVisibilityChanged=function(){this.setScrollVisible(),this.setFakeHScrollSpacerWidths()},r.prototype.hideAndShowInvisibleScrollAsNeeded=function(){var t=this;this.addManagedListener(this.eventService,Ge.EVENT_BODY_SCROLL,function(n){"horizontal"===n.direction&&t.view.addOrRemoveCssClass("ag-scrollbar-scrolling",!0)}),this.addManagedListener(this.eventService,Ge.EVENT_BODY_SCROLL_END,function(){return t.view.addOrRemoveCssClass("ag-scrollbar-scrolling",!1)})},r.prototype.setFakeHScrollSpacerWidths=function(){var t=this.scrollVisibleService.isVerticalScrollShowing(),n=this.columnModel.getDisplayedColumnsRightWidth(),c=!this.enableRtl&&t,f=this.gridOptionsWrapper.getScrollbarWidth();c&&(n+=f),this.view.setRightSpacerFixedWidth(n),this.view.includeRightSpacerScrollerCss("ag-scroller-corner",n<=f);var y=this.columnModel.getDisplayedColumnsLeftWidth();this.enableRtl&&t&&(y+=f),this.view.setLeftSpacerFixedWidth(y),this.view.includeLeftSpacerScrollerCss("ag-scroller-corner",y<=f)},r.prototype.setScrollVisible=function(){var t=this.scrollVisibleService.isHorizontalScrollShowing(),n=this.invisibleScrollbar,c=this.gridOptionsWrapper.isSuppressHorizontalScroll(),f=t&&this.gridOptionsWrapper.getScrollbarWidth()||0,T=c?0:0===f&&n?15:f,B=uo()&&t;this.view.addOrRemoveCssClass("ag-scrollbar-invisible",n),this.view.setHeight(T),this.view.setViewportHeight(T+(B?1:0)),this.view.setContainerHeight(T)},r.prototype.getViewport=function(){return this.eViewport},r.prototype.getContainer=function(){return this.eContainer},ph([Ee("scrollVisibleService")],r.prototype,"scrollVisibleService",void 0),ph([Ee("columnModel")],r.prototype,"columnModel",void 0),ph([Ee("ctrlsService")],r.prototype,"ctrlsService",void 0),ph([zt],r.prototype,"postConstruct",null),r}(ct),Qg=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),fu=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Jg=function(h){function r(){return h.call(this,r.TEMPLATE)||this}return Qg(r,h),r.prototype.postConstruct=function(){var t=this,n={addOrRemoveCssClass:function(y,T){return t.addOrRemoveCssClass(y,T)},setHeight:function(y){return sr(t.getGui(),y)},setContainerHeight:function(y){return sr(t.eContainer,y)},setViewportHeight:function(y){return sr(t.eViewport,y)},setRightSpacerFixedWidth:function(y){return Ta(t.eRightSpacer,y)},setLeftSpacerFixedWidth:function(y){return Ta(t.eLeftSpacer,y)},includeLeftSpacerScrollerCss:function(y,T){return Fr(t.eLeftSpacer,y,T)},includeRightSpacerScrollerCss:function(y,T){return Fr(t.eRightSpacer,y,T)}};this.createManagedBean(new p5).setComp(n,this.getGui(),this.eViewport,this.eContainer),this.createManagedBean(new yd(function(f){return t.eContainer.style.width=f+"px"}))},r.TEMPLATE='<div class="ag-body-horizontal-scroll" aria-hidden="true">\n            <div class="ag-horizontal-left-spacer" ref="eLeftSpacer"></div>\n            <div class="ag-body-horizontal-scroll-viewport" ref="eViewport">\n                <div class="ag-body-horizontal-scroll-container" ref="eContainer"></div>\n            </div>\n            <div class="ag-horizontal-right-spacer" ref="eRightSpacer"></div>\n        </div>',fu([Bt("eLeftSpacer")],r.prototype,"eLeftSpacer",void 0),fu([Bt("eRightSpacer")],r.prototype,"eRightSpacer",void 0),fu([Bt("eViewport")],r.prototype,"eViewport",void 0),fu([Bt("eContainer")],r.prototype,"eContainer",void 0),fu([zt],r.prototype,"postConstruct",null),r}(dn),u3=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Zg=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},$g=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return u3(r,h),r.prototype.postConstruct=function(){var t=this.checkContainerWidths.bind(this);this.addManagedListener(this.eventService,Ge.EVENT_DISPLAYED_COLUMNS_CHANGED,t),this.addManagedListener(this.eventService,Ge.EVENT_DISPLAYED_COLUMNS_WIDTH_CHANGED,t),this.addManagedListener(this.gridOptionsWrapper,vr.PROP_DOM_LAYOUT,t)},r.prototype.checkContainerWidths=function(){var t=this.gridOptionsWrapper.getDomLayout()===W.DOM_LAYOUT_PRINT,n=t?0:this.columnModel.getDisplayedColumnsLeftWidth(),c=t?0:this.columnModel.getDisplayedColumnsRightWidth();n!=this.leftWidth&&(this.leftWidth=n,this.eventService.dispatchEvent({type:Ge.EVENT_LEFT_PINNED_WIDTH_CHANGED})),c!=this.rightWidth&&(this.rightWidth=c,this.eventService.dispatchEvent({type:Ge.EVENT_RIGHT_PINNED_WIDTH_CHANGED}))},r.prototype.getPinnedRightWidth=function(){return this.rightWidth},r.prototype.getPinnedLeftWidth=function(){return this.leftWidth},Zg([Ee("columnModel")],r.prototype,"columnModel",void 0),Zg([zt],r.prototype,"postConstruct",null),Zg([Kt("pinnedWidthService")],r)}(ct),em=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),nf=function(h){function r(t){var n=h.call(this,'<div class="ag-popup-editor" tabindex="-1"/>')||this;return n.params=t,n}return em(r,h),r.prototype.postConstruct=function(){this.gridOptionsWrapper.setDomData(this.getGui(),r.DOM_KEY_POPUP_EDITOR_WRAPPER,!0),this.addKeyDownListener()},r.prototype.addKeyDownListener=function(){var t=this,n=this.getGui(),c=this.params;this.addManagedListener(n,"keydown",function(T){fo(t.gridOptionsWrapper,T,c.node,c.column,!0)||c.onKeyDown(T)})},r.DOM_KEY_POPUP_EDITOR_WRAPPER="popupEditorWrapper",function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);c>3&&f&&Object.defineProperty(r,t,f)}([zt],r.prototype,"postConstruct",null),r}(nl),f3=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),vh=function(){return vh=Object.assign||function(h){for(var r,t=1,n=arguments.length;t<n;t++)for(var c in r=arguments[t])Object.prototype.hasOwnProperty.call(r,c)&&(h[c]=r[c]);return h},vh.apply(this,arguments)},tm=function(h){function r(t,n,c,f,y,T,B){var q=h.call(this)||this;q.scope=null,q.rendererVersion=0,q.editorVersion=0,q.scope=t,q.beans=n,q.column=c.getColumn(),q.rowNode=c.getRowNode(),q.rowCtrl=c.getRowCtrl(),q.autoHeightCell=f,q.eRow=T,q.setTemplate('<div comp-id="'+q.getCompId()+'"/>');var de=q.getGui(),Se=de.style;q.eCellValue=de;var ke=function(rt,_t,Vt){var Ut=Vt||de;null!=_t&&""!=_t?Ut.setAttribute(rt,_t):Ut.removeAttribute(rt)},je={addOrRemoveCssClass:function(rt,_t){return q.addOrRemoveCssClass(rt,_t)},setUserStyles:function(rt){return tl(de,rt)},setAriaSelected:function(rt){return Iu(de,rt)},setAriaExpanded:function(rt){return Y0(de,rt)},getFocusableElement:function(){return q.getFocusableElement()},setLeft:function(rt){return Se.left=rt},setWidth:function(rt){return Se.width=rt},setAriaColIndex:function(rt){return bp(q.getGui(),rt)},setHeight:function(rt){return Se.height=rt},setZIndex:function(rt){return Se.zIndex=rt},setTabIndex:function(rt){return ke("tabindex",rt.toString())},setRole:function(rt){return co(de,rt)},setColId:function(rt){return ke("col-id",rt)},setTitle:function(rt){return ke("title",rt)},setUnselectable:function(rt){return ke("unselectable",rt,q.eCellValue)},setTransition:function(rt){return Se.transition=rt||""},setIncludeSelection:function(rt){return q.includeSelection=rt},setIncludeRowDrag:function(rt){return q.includeRowDrag=rt},setIncludeDndSource:function(rt){return q.includeDndSource=rt},setForceWrapper:function(rt){return q.forceWrapper=rt},setRenderDetails:function(rt,_t,Vt){return q.setRenderDetails(rt,_t,Vt)},setEditDetails:function(rt,_t,Vt){return q.setEditDetails(rt,_t,Vt)},getCellEditor:function(){return q.cellEditor||null},getCellRenderer:function(){return q.cellRenderer||null},getParentOfValue:function(){return q.eCellValue}};return q.cellCtrl=c,c.setComp(je,q.scope,q.getGui(),y,B),q}return f3(r,h),r.prototype.setRenderDetails=function(t,n,c){if(!this.cellEditor||this.cellEditorPopupWrapper){this.firstRender=null==this.firstRender;var y=this.isUsingAngular1Template(),T=this.setupControlsWrapper();t?!c&&!T&&this.refreshCellRenderer(t)||(this.destroyRenderer(),this.createCellRendererInstance(t)):(this.destroyRenderer(),y?this.insertValueUsingAngular1Template():this.insertValueWithoutCellRenderer(n))}},r.prototype.setEditDetails=function(t,n,c){t?this.createCellEditorInstance(t,n,c):this.destroyEditor()},r.prototype.removeControlsWrapper=function(){this.eCellValue=this.getGui(),this.eCellWrapper=null,this.checkboxSelectionComp=this.beans.context.destroyBean(this.checkboxSelectionComp),this.dndSourceComp=this.beans.context.destroyBean(this.dndSourceComp),this.rowDraggingComp=this.beans.context.destroyBean(this.rowDraggingComp)},r.prototype.setupControlsWrapper=function(){var t=this.includeRowDrag||this.includeDndSource||this.includeSelection||this.forceWrapper;return this.addOrRemoveCssClass("ag-cell-value",!t),t&&!this.eCellWrapper?(this.addControlsWrapper(),!0):!(t||!this.eCellWrapper||(this.removeControlsWrapper(),0))},r.prototype.addControlsWrapper=function(){this.getGui().innerHTML='<div ref="eCellWrapper" class="ag-cell-wrapper" role="presentation">\n                <span ref="eCellValue" class="ag-cell-value" role="presentation"></span>\n            </div>',this.eCellValue=this.getRefElement("eCellValue"),this.eCellWrapper=this.getRefElement("eCellWrapper"),this.forceWrapper||this.eCellValue.setAttribute("unselectable","on");var n=this.eCellValue.id="cell-"+this.getCompId(),c=[];this.includeRowDrag&&(this.rowDraggingComp=this.cellCtrl.createRowDragComp(),this.rowDraggingComp&&this.eCellWrapper.insertBefore(this.rowDraggingComp.getGui(),this.eCellValue)),this.includeDndSource&&(this.dndSourceComp=this.cellCtrl.createDndSource(),this.eCellWrapper.insertBefore(this.dndSourceComp.getGui(),this.eCellValue)),this.includeSelection&&(this.checkboxSelectionComp=this.cellCtrl.createSelectionCheckbox(),this.eCellWrapper.insertBefore(this.checkboxSelectionComp.getGui(),this.eCellValue),c.push(this.checkboxSelectionComp.getCheckboxId())),c.push(n),To(this.getGui(),c.join(" "))},r.prototype.createCellEditorInstance=function(t,n,c){var f=this,y=this.editorVersion,T=t.newAgStackInstance();if(T){var B=t.params;T.then(function(de){return f.afterCellEditorCreated(y,de,B,n,c)}),g(this.cellEditor)&&B.cellStartedEdit&&this.cellCtrl.focusCell(!0)}},r.prototype.insertValueWithoutCellRenderer=function(t){var n=null!=t?Oe(t):null;null!=n?this.eCellValue.innerHTML=n:So(this.eCellValue)},r.prototype.insertValueUsingAngular1Template=function(){var y,t=this,n=this.column.getColDef(),c=n.template,f=n.templateUrl;null!=c?y=c:null!=f&&(y=this.beans.templateService.getTemplate(f,function(){return t.cellCtrl.refreshCell({forceRefresh:!0})})),null!=y&&(this.eCellValue.innerHTML=y,this.updateAngular1ScopeAndCompile())},r.prototype.destroyEditorAndRenderer=function(){this.destroyRenderer(),this.destroyEditor()},r.prototype.destroyRenderer=function(){this.cellRenderer=this.beans.context.destroyBean(this.cellRenderer),ji(this.cellRendererGui),this.cellRendererGui=null,this.rendererVersion++},r.prototype.destroyEditor=function(){var t=this.beans.context;this.hideEditorPopup&&this.hideEditorPopup(),this.hideEditorPopup=void 0,this.cellEditor=t.destroyBean(this.cellEditor),this.cellEditorPopupWrapper=t.destroyBean(this.cellEditorPopupWrapper),ji(this.cellEditorGui),this.cellEditorGui=null,this.editorVersion++},r.prototype.refreshCellRenderer=function(t){if(null==this.cellRenderer||null==this.cellRenderer.refresh||this.cellRendererClass!==t.componentClass)return!1;var n=this.cellRenderer.refresh(t.params);return!0===n||void 0===n},r.prototype.createCellRendererInstance=function(t){var n=this,c=this.beans.gridOptionsWrapper.isAngularCompileRows(),f=this.beans.gridOptionsWrapper.isSuppressAnimationFrame(),T=this.rendererVersion,B=t.componentClass,q=function(){if(n.rendererVersion===T&&n.isAlive()){var ke=t.newAgStackInstance(),je=n.afterCellRendererCreated.bind(n,T,B);ke&&ke.then(je)}};c||f||this.autoHeightCell||!this.firstRender?q():this.beans.animationFrameService.createTask(q,this.rowNode.rowIndex,"createTasksP2")},r.prototype.isUsingAngular1Template=function(){var t=this.column.getColDef();return null!=t.template||null!=t.templateUrl},r.prototype.getCtrl=function(){return this.cellCtrl},r.prototype.getRowCtrl=function(){return this.rowCtrl},r.prototype.getCellRenderer=function(){return this.cellRenderer},r.prototype.getCellEditor=function(){return this.cellEditor},r.prototype.afterCellRendererCreated=function(t,n,c){this.isAlive()&&t===this.rendererVersion?(this.cellRenderer=c,this.cellRendererClass=n,this.cellRendererGui=this.cellRenderer.getGui(),null!=this.cellRendererGui&&(So(this.eCellValue),this.eCellValue.appendChild(this.cellRendererGui),this.updateAngular1ScopeAndCompile())):this.beans.context.destroyBean(c)},r.prototype.afterCellEditorCreated=function(t,n,c,f,y){if(t!==this.editorVersion)this.beans.context.destroyBean(n);else{if(n.isCancelBeforeStart&&n.isCancelBeforeStart())return this.beans.context.destroyBean(n),void this.cellCtrl.stopEditing();if(!n.getGui)return console.warn("AG Grid: cellEditor for column "+this.column.getId()+" is missing getGui() method"),void this.beans.context.destroyBean(n);this.cellEditor=n,this.cellEditorGui=n.getGui(),f||void 0!==n.isPopup&&n.isPopup()?(f||this.cellCtrl.hackSayEditingInPopup(),this.addPopupCellEditor(c,y)):this.addInCellEditor(),n.afterGuiAttached&&n.afterGuiAttached()}},r.prototype.addInCellEditor=function(){var t=this.getGui();t.contains(document.activeElement)&&t.focus(),this.destroyRenderer(),this.removeControlsWrapper(),this.clearCellElement(),this.cellEditorGui&&t.appendChild(this.cellEditorGui)},r.prototype.addPopupCellEditor=function(t,n){var c=this;this.beans.gridOptionsWrapper.isFullRowEdit()&&console.warn("AG Grid: popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.");var f=this.cellEditor;this.cellEditorPopupWrapper=this.beans.context.createBean(new nf(t));var y=this.cellEditorPopupWrapper.getGui();this.cellEditorGui&&y.appendChild(this.cellEditorGui);var T=this.beans.popupService,B=this.beans.gridOptionsWrapper.isStopEditingWhenCellsLoseFocus(),de=(null!=n||f.getPopupPosition&&f.getPopupPosition(),{column:this.column,rowNode:this.rowNode,type:"popupCellEditor",eventSource:this.getGui(),ePopup:y,keepWithinBounds:!0}),Se="under"===n?T.positionPopupUnderComponent.bind(T,de):T.positionPopupOverComponent.bind(T,de),ke=this.beans.gridOptionsWrapper.getLocaleTextFunc(),je=T.addPopup({modal:B,eChild:y,closeOnEsc:!0,closedCallback:function(){c.cellCtrl.onPopupEditorClosed()},anchorToElement:this.getGui(),positionCallback:Se,ariaLabel:ke("ariaLabelCellEditor","Cell Editor")});je&&(this.hideEditorPopup=je.hideFunc)},r.prototype.detach=function(){this.eRow.removeChild(this.getGui())},r.prototype.destroy=function(){this.cellCtrl.stopEditing(),this.destroyEditorAndRenderer(),this.removeControlsWrapper(),this.angularCompiledElement&&(this.angularCompiledElement.remove(),this.angularCompiledElement=void 0),h.prototype.destroy.call(this)},r.prototype.clearCellElement=function(){var t=this.getGui();t.contains(document.activeElement)&&!uo()&&t.focus({preventScroll:!0}),So(t)},r.prototype.updateAngular1ScopeAndCompile=function(){this.beans.gridOptionsWrapper.isAngularCompileRows()&&this.scope&&(this.scope.data=vh({},this.rowNode.data),this.angularCompiledElement&&this.angularCompiledElement.remove(),this.angularCompiledElement=this.beans.$compile(this.eCellValue.children)(this.scope),this.beans.ctrlsService.getGridBodyCtrl().requestAngularApply())},r}(dn),d3=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),h3=function(h){function r(t,n,c){var f=h.call(this)||this;f.cellComps={},f.beans=n,f.rowCtrl=t,f.setTemplate('<div comp-id="'+f.getCompId()+'" style="'+f.getInitialStyle()+'"/>');var y=f.getGui(),T=y.style;return t.setComp({setDisplay:function(de){null==de?T.removeProperty("display"):T.setProperty("display","none")},setDomOrder:function(de){return f.domOrder=de},setCellCtrls:function(de){return f.setCellCtrls(de)},showFullWidth:function(de){return f.showFullWidth(de)},getFullWidthCellRenderer:function(){return f.getFullWidthCellRenderer()},addOrRemoveCssClass:function(de,Se){return f.addOrRemoveCssClass(de,Se)},setAriaExpanded:function(de){return Y0(y,de)},setUserStyles:function(de){return tl(y,de)},setAriaSelected:function(de){return Iu(y,de)},setAriaLabel:function(de){Da(y,null==de?"":de)},setHeight:function(de){return T.height=de},setTop:function(de){return T.top=de},setTransform:function(de){return T.transform=de},setRowIndex:function(de){return y.setAttribute("row-index",de)},setRole:function(de){return co(y,de)},setAriaRowIndex:function(de){return xp(f.getGui(),de)},setRowId:function(de){return y.setAttribute("row-id",de)},setRowBusinessKey:function(de){return y.setAttribute("row-business-key",de)},setTabIndex:function(de){return y.setAttribute("tabindex",de.toString())}},f.getGui(),c),f}return d3(r,h),r.prototype.getInitialStyle=function(){var t=this.rowCtrl.getInitialTransform(),n=this.rowCtrl.getInitialRowTop();return t?"transform: "+t:"top: "+n},r.prototype.showFullWidth=function(t){var n=this,f=t.newAgStackInstance(this.rowCtrl.getFullWidthCellRendererType());!f||f.then(function(T){if(n.isAlive()){var B=T.getGui();n.getGui().appendChild(B),n.rowCtrl.getRowType()===Yi.FullWidthDetail&&n.rowCtrl.setupDetailRowAutoHeight(B),n.setFullWidthRowComp(T)}else n.beans.context.destroyBean(T)})},r.prototype.setCellCtrls=function(t){var n=this,c=ut({},this.cellComps);t.forEach(function(y){var T=y.getInstanceId();null==n.cellComps[T]?n.newCellComp(y):c[T]=null});var f=$e(c).filter(function(y){return null!=y});this.destroyCells(f),this.ensureDomOrder(t)},r.prototype.ensureDomOrder=function(t){var n=this;if(this.domOrder){var c=[];t.forEach(function(f){var y=n.cellComps[f.getInstanceId()];y&&c.push(y.getGui())}),bo(this.getGui(),c)}},r.prototype.newCellComp=function(t){var n=new tm(this.rowCtrl.getScope(),this.beans,t,!1,this.rowCtrl.isPrintLayout(),this.getGui(),this.rowCtrl.isEditing());this.cellComps[t.getInstanceId()]=n,this.getGui().appendChild(n.getGui())},r.prototype.destroy=function(){h.prototype.destroy.call(this),this.destroyAllCells()},r.prototype.destroyAllCells=function(){var t=$e(this.cellComps).filter(function(n){return null!=n});this.destroyCells(t)},r.prototype.setFullWidthRowComp=function(t){var n=this;this.fullWidthCellRenderer&&console.error("AG Grid - should not be setting fullWidthRowComponent twice"),this.fullWidthCellRenderer=t,this.addDestroyFunc(function(){n.fullWidthCellRenderer=n.beans.context.destroyBean(n.fullWidthCellRenderer)})},r.prototype.getFullWidthCellRenderer=function(){return this.fullWidthCellRenderer},r.prototype.destroyCells=function(t){var n=this;t.forEach(function(c){if(c){var f=c.getCtrl().getInstanceId();n.cellComps[f]===c&&(c.detach(),c.destroy(),n.cellComps[f]=null)}})},r}(dn),p3=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),du=function(){return du=Object.assign||function(h){for(var r,t=1,n=arguments.length;t<n;t++)for(var c in r=arguments[t])Object.prototype.hasOwnProperty.call(r,c)&&(h[c]=r[c]);return h},du.apply(this,arguments)},ma=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},hu=function(h){function r(){var t=h.call(this,function(){var h=dn.elementGettingCreated.getAttribute("name"),r=nu.getRowContainerCssClasses(h);return h===e.hA6.CENTER?'<div class="'+r.wrapper+'" ref="eWrapper" role="presentation" unselectable="on">\n                <div class="'+r.viewport+'" ref="eViewport" role="presentation">\n                    <div class="'+r.container+'" ref="eContainer" role="rowgroup" unselectable="on"></div>\n                </div>\n            </div>':h===e.hA6.TOP_CENTER||h===e.hA6.BOTTOM_CENTER?'<div class="'+r.viewport+'" ref="eViewport" role="presentation" unselectable="on">\n                <div class="'+r.container+'" ref="eContainer" role="presentation" unselectable="on"></div>\n            </div>':'<div class="'+r.container+'" ref="eContainer" role="presentation" unselectable="on"></div>'}())||this;return t.rowComps={},t.name=dn.elementGettingCreated.getAttribute("name"),t}return p3(r,h),r.prototype.postConstruct=function(){var t=this,n={setViewportHeight:function(y){return t.eViewport.style.height=y},setRowCtrls:function(y){return t.setRowCtrls(y)},setDomOrder:function(y){t.domOrder=y},setContainerWidth:function(y){return t.eContainer.style.width=y}};this.createManagedBean(new nu(this.name)).setComp(n,this.eContainer,this.eViewport,this.eWrapper)},r.prototype.preDestroy=function(){this.setRowCtrls([])},r.prototype.setRowCtrls=function(t){var n=this,c=du({},this.rowComps);this.rowComps={},this.lastPlacedElement=null,t.forEach(function(T){var B=T.getInstanceId(),q=c[B];if(q)n.rowComps[B]=q,delete c[B],n.ensureDomOrder(q.getGui());else{var de=n.newRowComp(T);n.rowComps[B]=de,n.appendRow(de.getGui())}}),$e(c).forEach(function(y){n.eContainer.removeChild(y.getGui()),y.destroy()})},r.prototype.appendRow=function(t){this.domOrder?Lu(this.eContainer,t,this.lastPlacedElement):this.eContainer.appendChild(t),this.lastPlacedElement=t},r.prototype.ensureDomOrder=function(t){this.domOrder&&(Qa(this.eContainer,t,this.lastPlacedElement),this.lastPlacedElement=t)},r.prototype.newRowComp=function(t){var n=nu.getPinned(this.name);return new h3(t,this.beans,n)},ma([Ee("beans")],r.prototype,"beans",void 0),ma([Bt("eViewport")],r.prototype,"eViewport",void 0),ma([Bt("eContainer")],r.prototype,"eContainer",void 0),ma([Bt("eWrapper")],r.prototype,"eWrapper",void 0),ma([zt],r.prototype,"postConstruct",null),ma([Ln],r.prototype,"preDestroy",null),r}(dn),g3=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),of=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},gh=function(h){function r(){var t=null!==h&&h.apply(this,arguments)||this;return t.events=[],t}return g3(r,h),r.prototype.postConstruct=function(){this.rowModel.getType()==W.ROW_MODEL_TYPE_CLIENT_SIDE&&(this.clientSideRowModel=this.rowModel)},r.prototype.dispatchExpanded=function(t){var n=this;this.events.push(t),null==this.dispatchExpandedDebounced&&(this.dispatchExpandedDebounced=this.animationFrameService.debounce(function(){n.clientSideRowModel&&n.clientSideRowModel.onRowGroupOpened(),n.events.forEach(function(c){return n.eventService.dispatchEvent(c)}),n.events=[]})),this.dispatchExpandedDebounced()},of([Ee("animationFrameService")],r.prototype,"animationFrameService",void 0),of([Ee("rowModel")],r.prototype,"rowModel",void 0),of([zt],r.prototype,"postConstruct",null),of([Kt("rowNodeEventThrottle")],r)}(ct),Ua=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),ls=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},Ji=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return Ua(r,h),r.prototype.hideActiveMenu=function(){this.hidePopup&&this.hidePopup()},r.prototype.showMenuAfterMouseEvent=function(t,n){var c=this;this.showPopup(t,function(f){c.popupService.positionPopupUnderMouseEvent({column:t,type:"columnMenu",mouseEvent:n,ePopup:f})},n.target)},r.prototype.showMenuAfterButtonClick=function(t,n,c){var f=this;this.showPopup(t,function(y){f.popupService.positionPopupUnderComponent({type:c,eventSource:n,ePopup:y,keepWithinBounds:!0,column:t})},n)},r.prototype.showPopup=function(t,n,c){var f=this,y=this.filterManager.getOrCreateFilterWrapper(t,"COLUMN_MENU"),T=document.createElement("div");co(T,"presentation"),Er(T,"ag-menu"),this.tabListener=this.addManagedListener(T,"keydown",function(je){return f.trapFocusWithin(je,T)}),y.guiPromise.then(function(je){return T.appendChild(je)});var B,q=c||this.ctrlsService.getGridBodyCtrl().getGui(),Se=this.gridOptionsWrapper.getLocaleTextFunc(),ke=this.popupService.addPopup({modal:!0,eChild:T,closeOnEsc:!0,closedCallback:function(Qe){t.setMenuVisible(!1,"contextMenu");var rt=Qe instanceof KeyboardEvent;if(f.tabListener&&(f.tabListener=f.tabListener()),rt&&c&&Ol(c)){var _t=f.focusService.findTabbableParent(c);_t&&_t.focus()}},positionCallback:function(){return n(T)},anchorToElement:q,ariaLabel:Se("ariaLabelColumnMenu","Column Menu")});ke&&(this.hidePopup=B=ke.hideFunc),y.filterPromise.then(function(je){n(T),je.afterGuiAttached&&je.afterGuiAttached({container:"columnMenu",hidePopup:B})}),t.setMenuVisible(!0,"contextMenu")},r.prototype.trapFocusWithin=function(t,n){t.keyCode!==Yt.TAB||t.defaultPrevented||this.focusService.findNextFocusableElement(n,!1,t.shiftKey)||(t.preventDefault(),this.focusService.focusInto(n,t.shiftKey))},r.prototype.isMenuEnabled=function(t){return t.isFilterAllowed()},ls([Ee("filterManager")],r.prototype,"filterManager",void 0),ls([Ee("popupService")],r.prototype,"popupService",void 0),ls([Ee("focusService")],r.prototype,"focusService",void 0),ls([Ee("ctrlsService")],r.prototype,"ctrlsService",void 0),ls([Kt("menuFactory")],r)}(ct),us=function(){function h(r,t,n){t?(this.gridOptions=t,(new A0).create(r,t,function(c){var f=new d0(r);c.createBean(f)},n)):console.error("AG Grid: no gridOptions provided to the grid")}return h.prototype.destroy=function(){this.gridOptions&&this.gridOptions.api&&this.gridOptions.api.destroy()},h}(),A0=function(){function h(){}return h.prototype.create=function(r,t,n,c){var f=this,y=!!t.debug,T=this.getRegisteredModules(c),B=this.createBeansList(t.rowModelType,T),q=this.createProvidedBeans(r,t,c);if(B){var de={providedBeanInstances:q,beanClasses:B,debug:y},Se=new Ic("AG Grid",function(){return t.debug}),ke=new Ic("Context",function(){return de.debug}),je=new yi(de,ke),Qe=je.getBean("beans");this.registerModuleUserComponents(Qe,T),this.registerStackComponents(Qe,T),this.registerControllers(Qe,T),n(je),Qe.ctrlsService.whenReady(function(){f.setColumnsAndData(Qe),f.dispatchGridReadyEvent(Qe,t);var rt=ne.isRegistered(e.GXE.EnterpriseCoreModule);Se.log("initialised successfully, enterprise = "+rt)})}},h.prototype.registerControllers=function(r,t){t.forEach(function(n){n.controllers&&n.controllers.forEach(function(c){return r.ctrlsFactory.register(c)})})},h.prototype.registerStackComponents=function(r,t){var n=this.createAgStackComponentsList(t);r.agStackComponentsRegistry.setupComponents(n)},h.prototype.getRegisteredModules=function(r){var t=r?r.modules:null,n=ne.getRegisteredModules(),c=[],f={};function y(T,B){var de;f[(de=B).moduleName]||(f[de.moduleName]=!0,c.push(de),ne.register(de,T)),B.dependantModules&&B.dependantModules.forEach(y.bind(null,T))}return t&&t.forEach(y.bind(null,!0)),n&&n.forEach(y.bind(null,!ne.isPackageBased())),c},h.prototype.registerModuleUserComponents=function(r,t){this.extractModuleEntity(t,function(c){return c.userComponents?c.userComponents:[]}).forEach(function(c){r.userComponentRegistry.registerDefaultComponent(c.componentName,c.componentClass)})},h.prototype.createProvidedBeans=function(r,t,n){var c=n?n.frameworkOverrides:null;g(c)&&(c=new L2);var f={gridOptions:t,eGridDiv:r,$scope:n?n.$scope:null,$compile:n?n.$compile:null,globalEventListener:n?n.globalEventListener:null,frameworkOverrides:c};return n&&n.providedBeanInstances&&ut(f,n.providedBeanInstances),f},h.prototype.createAgStackComponentsList=function(r){var t=[{componentName:"AgCheckbox",componentClass:dl},{componentName:"AgRadioButton",componentClass:Wc},{componentName:"AgToggleButton",componentClass:lh},{componentName:"AgInputTextField",componentClass:Pg},{componentName:"AgInputTextArea",componentClass:ah},{componentName:"AgInputNumberField",componentClass:Jc},{componentName:"AgInputRange",componentClass:Zc},{componentName:"AgSelect",componentClass:Bl},{componentName:"AgSlider",componentClass:sh},{componentName:"AgAngleSelect",componentClass:$c},{componentName:"AgColorPicker",componentClass:Ng},{componentName:"AgGridBody",componentClass:Jv},{componentName:"AgHeaderRoot",componentClass:da},{componentName:"AgPagination",componentClass:Y2},{componentName:"AgOverlayWrapper",componentClass:c5},{componentName:"AgGroupComponent",componentClass:Dg},{componentName:"AgPanel",componentClass:w0},{componentName:"AgDialog",componentClass:ih},{componentName:"AgRowContainer",componentClass:hu},{componentName:"AgFakeHorizontalScroll",componentClass:Jg}],n=this.extractModuleEntity(r,function(c){return c.agStackComponents?c.agStackComponents:[]});return t.concat(n)},h.prototype.createBeansList=function(r,t){var n=this.getRowModelClass(r,t);if(n){var c=[n,hd,tf,uh,Ug,V2,Zv,od,qd,Yc,va,sd,j2,ta,Gg,Uc,ba,Zn,vr,tg,Kl,w2,tr,Cv,jd,Jy,Od,br,$v,mg,xg,gg,Rc,rg,Ff,Ld,Ji,ao,av,so,ug,Ro,fg,Vd,k2,N2,sg,Is,hg,bg,zd,Xd,W2,lo,k1,i3,o3,Xg,l3,Yg,$g,gh,h5],f=this.extractModuleEntity(t,function(T){return T.beans?T.beans:[]});c.push.apply(c,f);var y=[];return c.forEach(function(T){y.indexOf(T)<0&&y.push(T)}),y}},h.prototype.extractModuleEntity=function(r,t){return[].concat.apply([],r.map(t))},h.prototype.setColumnsAndData=function(r){var t=r.gridOptionsWrapper.getColumnDefs();r.columnModel.setColumnDefs(t||[],"gridInitializing"),r.rowModel.start()},h.prototype.dispatchGridReadyEvent=function(r,t){r.eventService.dispatchEvent({type:Ge.EVENT_GRID_READY,api:t.api,columnApi:t.columnApi})},h.prototype.getRowModelClass=function(r,t){r||(r=W.ROW_MODEL_TYPE_CLIENT_SIDE);var n={};t.forEach(function(f){ce(f.rowModels,function(y,T){n[y]=T})});var c=n[r];if(v(c))return c;r===W.ROW_MODEL_TYPE_INFINITE&&console.error('AG Grid: Row Model "Infinite" not found. Please ensure the '+e.GXE.InfiniteRowModelModule+" is registered.';"),console.error("AG Grid: could not find matching row model for rowModelType "+r),r===W.ROW_MODEL_TYPE_VIEWPORT&&console.error('AG Grid: Row Model "Viewport" not found. Please ensure the AG Grid Enterprise Module '+e.GXE.ViewportRowModelModule+" is registered.';"),r===W.ROW_MODEL_TYPE_SERVER_SIDE&&console.error('AG Grid: Row Model "Server Side" not found. Please ensure the AG Grid Enterprise Module '+e.GXE.ServerSideRowModelModule+" is registered.';"),r===W.ROW_MODEL_TYPE_CLIENT_SIDE&&console.error('AG Grid: Row Model "Client Side" not found. Please ensure the '+e.GXE.ClientSideRowModelModule+" is registered.';")},h}();var gu=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),cs=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f};!function(h){function r(t){var n=h.call(this,r.getTemplate(t.cssClass))||this;return n.items=[],n.params=t,t.items&&t.items.forEach(function(c){return n.addItem(c)}),n}gu(r,h),r.prototype.postConstruct=function(){this.createManagedBean(new Qo(this.getFocusableElement(),{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this)}))},r.getTemplate=function(t){return'<div class="ag-tabs '+t+'">\n            <div ref="eHeader" role="tablist" class="ag-tabs-header '+(t?t+"-header":"")+'"></div>\n            <div ref="eBody" role="presentation" class="ag-tabs-body '+(t?t+"-body":"")+'"></div>\n        </div>'},r.prototype.handleKeyDown=function(t){switch(t.keyCode){case Yt.RIGHT:case Yt.LEFT:if(!this.eHeader.contains(document.activeElement))return;var n=this.items.indexOf(this.activeItem),c=t.keyCode===Yt.RIGHT?Math.min(n+1,this.items.length-1):Math.max(n-1,0);if(n===c)return;t.preventDefault();var f=this.items[c];this.showItemWrapper(f),f.eHeaderButton.focus();break;case Yt.UP:case Yt.DOWN:t.stopPropagation()}},r.prototype.onTabKeyDown=function(t){if(!t.defaultPrevented){var n=this,c=n.focusService,f=n.eHeader,y=n.eBody,T=n.activeItem,B=document.activeElement;if(t.preventDefault(),f.contains(B))c.focusInto(y,t.shiftKey);else if(c.isFocusUnderManagedComponent(y))T.eHeaderButton.focus();else{var q=c.findNextFocusableElement(y,!1,t.shiftKey);q?q.focus():T.eHeaderButton.focus()}}},r.prototype.setAfterAttachedParams=function(t){this.afterAttachedParams=t},r.prototype.showFirstItem=function(){this.items.length>0&&this.showItemWrapper(this.items[0])},r.prototype.addItem=function(t){var n=document.createElement("span");co(n,"tab"),n.setAttribute("tabIndex","-1"),n.appendChild(t.title),Er(n,"ag-tab"),this.eHeader.appendChild(n),Da(n,t.titleLabel);var c={tabbedItem:t,eHeaderButton:n};this.items.push(c),n.addEventListener("click",this.showItemWrapper.bind(this,c))},r.prototype.showItem=function(t){var n=O(this.items,function(c){return c.tabbedItem===t});n&&this.showItemWrapper(n)},r.prototype.showItemWrapper=function(t){var n=this;this.params.onItemClicked&&this.params.onItemClicked({item:t.tabbedItem}),this.activeItem!==t?(So(this.eBody),t.tabbedItem.bodyPromise.then(function(c){n.eBody.appendChild(c);var f=!n.focusService.isKeyboardMode();n.focusService.focusInto(n.eBody,!1,f),t.tabbedItem.afterAttachedCallback&&t.tabbedItem.afterAttachedCallback(n.afterAttachedParams)}),this.activeItem&&zi(this.activeItem.eHeaderButton,"ag-tab-selected"),Er(t.eHeaderButton,"ag-tab-selected"),this.activeItem=t):cn(this.params.onActiveItemClicked)},cs([Ee("focusService")],r.prototype,"focusService",void 0),cs([Bt("eHeader")],r.prototype,"eHeader",void 0),cs([Bt("eBody")],r.prototype,"eBody",void 0),cs([zt],r.prototype,"postConstruct",null)}(dn);!function(h){h.Applied="Applied",h.StoreNotFound="StoreNotFound",h.StoreLoading="StoreLoading",h.StoreWaitingToLoad="StoreWaitingToLoad",h.StoreLoadingFailed="StoreLoadingFailed",h.StoreWrongType="StoreWrongType",h.Cancelled="Cancelled"}(e.Qk6||(e.Qk6={}));var Cu=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),fs=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},im=(function(h){function r(t,n,c){void 0===t&&(t="default"),void 0===n&&(n="listbox");var f=h.call(this,r.getTemplate(t))||this;return f.cssIdentifier=t,f.ariaRole=n,f.listName=c,f.renderedRows=new Map,f.rowHeight=20,f.isDestroyed=!1,f}Cu(r,h),r.prototype.postConstruct=function(){var t=this;this.addScrollListener(),this.rowHeight=this.getItemHeight(),this.addResizeObserver(),this.initialiseTabGuard({onFocusIn:function(c){return t.onFocusIn(c)},onFocusOut:function(c){return t.onFocusOut(c)},focusInnerElement:function(c){return t.focusInnerElement(c)},onTabKeyDown:function(c){return t.onTabKeyDown(c)},handleKeyDown:function(c){return t.handleKeyDown(c)}}),this.setAriaProperties()},r.prototype.setAriaProperties=function(){var n=this.gridOptionsWrapper.getLocaleTextFunc()("ariaDefaultListName",this.listName||"List"),c=this.eContainer;co(c,this.ariaRole),Da(c,n)},r.prototype.addResizeObserver=function(){var t=this.drawVirtualRows.bind(this),n=this.resizeObserverService.observeResize(this.getGui(),t);this.addDestroyFunc(n)},r.prototype.focusInnerElement=function(t){this.focusRow(t?this.model.getRowCount()-1:0)},r.prototype.onFocusIn=function(t){var n=t.target;return qa(n,"ag-virtual-list-item")&&(this.lastFocusedRowIndex=Yo(n)-1),!1},r.prototype.onFocusOut=function(t){return this.getFocusableElement().contains(t.relatedTarget)||(this.lastFocusedRowIndex=null),!1},r.prototype.handleKeyDown=function(t){switch(t.keyCode){case Yt.UP:case Yt.DOWN:this.navigate(t.keyCode===Yt.UP)&&t.preventDefault()}},r.prototype.onTabKeyDown=function(t){this.navigate(t.shiftKey)?t.preventDefault():this.focusService.focusInto(this.getGui(),!t.shiftKey)},r.prototype.navigate=function(t){if(null==this.lastFocusedRowIndex)return!1;var n=this.lastFocusedRowIndex+(t?-1:1);return!(n<0||n>=this.model.getRowCount()||(this.focusRow(n),0))},r.prototype.getLastFocusedRow=function(){return this.lastFocusedRowIndex},r.prototype.focusRow=function(t){var n=this;this.ensureIndexVisible(t),window.setTimeout(function(){var c=n.renderedRows.get(t);c&&c.eDiv.focus()},10)},r.prototype.getComponentAt=function(t){var n=this.renderedRows.get(t);return n&&n.rowComponent},r.getTemplate=function(t){return'\n            <div class="ag-virtual-list-viewport ag-'+t+'-virtual-list-viewport" role="presentation">\n                <div class="ag-virtual-list-container ag-'+t+'-virtual-list-container" ref="eContainer"></div>\n            </div>'},r.prototype.getItemHeight=function(){return this.gridOptionsWrapper.getListItemHeight()},r.prototype.ensureIndexVisible=function(t){var n=this.model.getRowCount();if("number"!=typeof t||t<0||t>=n)console.warn("invalid row index for ensureIndexVisible: "+t);else{var c=t*this.rowHeight,f=c+this.rowHeight,y=this.getGui(),T=y.scrollTop,B=y.offsetHeight,Se=T+B<f;T>c?y.scrollTop=c:Se&&(y.scrollTop=f-B)}},r.prototype.setComponentCreator=function(t){this.componentCreator=t},r.prototype.getRowHeight=function(){return this.rowHeight},r.prototype.getScrollTop=function(){return this.getGui().scrollTop},r.prototype.setRowHeight=function(t){this.rowHeight=t,this.refresh()},r.prototype.refresh=function(){var t=this;if(null!=this.model&&!this.isDestroyed){var n=this.model.getRowCount();this.eContainer.style.height=n*this.rowHeight+"px",An(function(){return t.eContainer.clientHeight>=n*t.rowHeight},function(){t.isDestroyed||(t.clearVirtualRows(),t.drawVirtualRows())})}},r.prototype.clearVirtualRows=function(){var t=this;this.renderedRows.forEach(function(n,c){return t.removeRow(c)})},r.prototype.drawVirtualRows=function(){var t=this.getGui(),n=t.scrollTop,c=n+t.offsetHeight,f=Math.floor(n/this.rowHeight),y=Math.floor(c/this.rowHeight);this.ensureRowsRendered(f,y)},r.prototype.ensureRowsRendered=function(t,n){var c=this;this.renderedRows.forEach(function(y,T){(T<t||T>n)&&T!==c.lastFocusedRowIndex&&c.removeRow(T)});for(var f=t;f<=n;f++)this.renderedRows.has(f)||f<this.model.getRowCount()&&this.insertRow(f)},r.prototype.insertRow=function(t){var n=this,c=this.model.getRow(t),f=document.createElement("div");if(Er(f,"ag-virtual-list-item"),Er(f,"ag-"+this.cssIdentifier+"-virtual-list-item"),co(f,"tree"===this.ariaRole?"treeitem":"option"),j1(f,this.model.getRowCount()),X1(f,t+1),f.setAttribute("tabindex","-1"),"function"==typeof this.model.isRowSelected){var y=this.model.isRowSelected(t);Iu(f,!!y),$1(f,y)}f.style.height=this.rowHeight+"px",f.style.top=this.rowHeight*t+"px";var T=this.componentCreator(c,f);T.addGuiEventListener("focusin",function(){return n.lastFocusedRowIndex=t}),f.appendChild(T.getGui()),this.renderedRows.has(t-1)?this.renderedRows.get(t-1).eDiv.insertAdjacentElement("afterend",f):this.renderedRows.has(t+1)?this.renderedRows.get(t+1).eDiv.insertAdjacentElement("beforebegin",f):this.eContainer.appendChild(f),this.renderedRows.set(t,{rowComponent:T,eDiv:f})},r.prototype.removeRow=function(t){var n=this.renderedRows.get(t);this.eContainer.removeChild(n.eDiv),this.destroyBean(n.rowComponent),this.renderedRows.delete(t)},r.prototype.addScrollListener=function(){var t=this;this.addGuiEventListener("scroll",function(){return t.drawVirtualRows()})},r.prototype.setModel=function(t){this.model=t},r.prototype.destroy=function(){this.isDestroyed||(this.clearVirtualRows(),this.isDestroyed=!0,h.prototype.destroy.call(this))},fs([Ee("resizeObserverService")],r.prototype,"resizeObserverService",void 0),fs([Ee("focusService")],r.prototype,"focusService",void 0),fs([Bt("eContainer")],r.prototype,"eContainer",void 0),fs([zt],r.prototype,"postConstruct",null)}(og),function(){function h(){}return h.prototype.wrap=function(r,t,n,c,f){var y=this;void 0===n&&(n=[]);var T=this.createWrapper(r,c,f);return t.forEach(function(B){y.createMethod(T,B,!0)}),n.forEach(function(B){y.createMethod(T,B,!1)}),T},h.prototype.unwrap=function(r){return r},h.prototype.createMethod=function(r,t,n){r.addMethod(t,this.createMethodProxy(r,t,n))},h.prototype.createMethodProxy=function(r,t,n){return function(){return r.hasMethod(t)?r.callMethod(t,arguments):(n&&console.warn("AG Grid: Framework component is missing the method "+t+"()"),null)}},h}());!function(h){h.Column="column",h.GroupedColumn="groupedColumn",h.StackedColumn="stackedColumn",h.NormalizedColumn="normalizedColumn",h.Bar="bar",h.GroupedBar="groupedBar",h.StackedBar="stackedBar",h.NormalizedBar="normalizedBar",h.Line="line",h.Scatter="scatter",h.Bubble="bubble",h.Pie="pie",h.Doughnut="doughnut",h.Area="area",h.StackedArea="stackedArea",h.NormalizedArea="normalizedArea",h.Histogram="histogram"}(e.oXM||(e.oXM={}));var yl="undefined"==typeof global?{}:global;yl.HTMLElement="undefined"==typeof HTMLElement?{}:HTMLElement,yl.HTMLButtonElement="undefined"==typeof HTMLButtonElement?{}:HTMLButtonElement,yl.HTMLSelectElement="undefined"==typeof HTMLSelectElement?{}:HTMLSelectElement,yl.HTMLInputElement="undefined"==typeof HTMLInputElement?{}:HTMLInputElement,yl.Node="undefined"==typeof Node?{}:Node,yl.MouseEvent="undefined"==typeof MouseEvent?{}:MouseEvent;var yh=function(){for(var h=0,r=0,t=arguments.length;r<t;r++)h+=arguments[r].length;var n=Array(h),c=0;for(r=0;r<t;r++)for(var f=arguments[r],y=0,T=f.length;y<T;y++,c++)n[c]=f[y];return n},om=function(){function h(r,t,n,c,f,y,T,B){this.nextId=0,this.allNodesMap={},this.rootNode=r,this.gridOptionsWrapper=t,this.eventService=n,this.columnModel=c,this.gridApi=f,this.columnApi=y,this.beans=B,this.selectionService=T,this.rootNode.group=!0,this.rootNode.level=-1,this.rootNode.id=h.ROOT_NODE_ID,this.rootNode.allLeafChildren=[],this.rootNode.childrenAfterGroup=[],this.rootNode.childrenAfterSort=[],this.rootNode.childrenAfterFilter=[],this.postConstruct()}return h.prototype.postConstruct=function(){this.suppressParentsInRowNodes=this.gridOptionsWrapper.isSuppressParentsInRowNodes(),this.isRowMasterFunc=this.gridOptionsWrapper.getIsRowMasterFunc(),this.doingTreeData=this.gridOptionsWrapper.isTreeData(),this.doingMasterDetail=this.gridOptionsWrapper.isMasterDetail()},h.prototype.getCopyOfNodesMap=function(){return wr.cloneObject(this.allNodesMap)},h.prototype.getRowNode=function(r){return this.allNodesMap[r]},h.prototype.setRowData=function(r){var t=this;if("string"!=typeof r){var n=this.rootNode,c=this.rootNode.sibling;n.childrenAfterFilter=null,n.childrenAfterGroup=null,n.childrenAfterSort=null,n.childrenMapped=null,n.updateHasChildren(),this.nextId=0,this.allNodesMap={},r?n.allLeafChildren=r.map(function(f){return t.createNode(f,t.rootNode,h.TOP_LEVEL)}):(n.allLeafChildren=[],n.childrenAfterGroup=[]),c&&(c.childrenAfterFilter=n.childrenAfterFilter,c.childrenAfterGroup=n.childrenAfterGroup,c.childrenAfterSort=n.childrenAfterSort,c.childrenMapped=n.childrenMapped,c.allLeafChildren=n.allLeafChildren)}else console.warn("AG Grid: rowData must be an array, however you passed in a string. If you are loading JSON, make sure you convert the JSON string to JavaScript objects first")},h.prototype.updateRowData=function(r,t){var n={remove:[],update:[],add:[]},c=[];return this.executeRemove(r,n,c),this.executeUpdate(r,n,c),this.executeAdd(r,n),this.updateSelection(c),t&&wr.sortRowNodesByOrder(this.rootNode.allLeafChildren,t),n},h.prototype.updateSelection=function(r){var t=r.length>0;t&&r.forEach(function(c){c.setSelected(!1,!1,!0)}),this.selectionService.updateGroupsFromChildrenSelections(),t&&this.eventService.dispatchEvent({type:Ge.EVENT_SELECTION_CHANGED,api:this.gridApi,columnApi:this.columnApi})},h.prototype.executeAdd=function(r,t){var n=this,c=r.add,f=r.addIndex;if(!wr.missingOrEmpty(c)){var y=c.map(function(Se){return n.createNode(Se,n.rootNode,h.TOP_LEVEL)});if("number"==typeof f&&f>=0){var B=this.rootNode.allLeafChildren,q=B.slice(0,f),de=B.slice(f,B.length);this.rootNode.allLeafChildren=yh(q,y,de)}else this.rootNode.allLeafChildren=yh(this.rootNode.allLeafChildren,y);this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren),t.add=y}},h.prototype.executeRemove=function(r,t,n){var c=this,f=r.remove;if(!wr.missingOrEmpty(f)){var y={};f.forEach(function(T){var B=c.lookupRowNode(T);!B||(B.isSelected()&&n.push(B),B.clearRowTopAndRowIndex(),y[B.id]=!0,delete c.allNodesMap[B.id],t.remove.push(B))}),this.rootNode.allLeafChildren=this.rootNode.allLeafChildren.filter(function(T){return!y[T.id]}),this.rootNode.sibling&&(this.rootNode.sibling.allLeafChildren=this.rootNode.allLeafChildren)}},h.prototype.executeUpdate=function(r,t,n){var c=this,f=r.update;wr.missingOrEmpty(f)||f.forEach(function(y){var T=c.lookupRowNode(y);!T||(T.updateData(y),!T.selectable&&T.isSelected()&&n.push(T),c.setMasterForRow(T,y,h.TOP_LEVEL,!1),t.update.push(T))})},h.prototype.lookupRowNode=function(r){var n,t=this.gridOptionsWrapper.getRowNodeIdFunc();if(wr.exists(t)){var c=t(r);if(!(n=this.allNodesMap[c]))return console.error("AG Grid: could not find row id="+c+", data item was not found for this id"),null}else if(!(n=wr.find(this.rootNode.allLeafChildren,function(f){return f.data===r})))return console.error("AG Grid: could not find data item as object was not found",r),console.error("Consider using getRowNodeId to help the Grid find matching row data"),null;return n},h.prototype.createNode=function(r,t,n){var c=new un(this.beans);return c.group=!1,this.setMasterForRow(c,r,n,!0),t&&!this.suppressParentsInRowNodes&&(c.parent=t),c.level=n,c.setDataAndId(r,this.nextId.toString()),this.allNodesMap[c.id]&&console.warn("ag-grid: duplicate node id '"+c.id+"' detected from getRowNodeId callback, this could cause issues in your grid."),this.allNodesMap[c.id]=c,this.nextId++,c},h.prototype.setMasterForRow=function(r,t,n,c){if(this.doingTreeData)r.setMaster(!1),c&&(r.expanded=!1);else if(r.setMaster(!!this.doingMasterDetail&&(!this.isRowMasterFunc||this.isRowMasterFunc(t))),c){var f=this.columnModel.getRowGroupColumns();r.expanded=!!r.master&&this.isExpanded(n+(f?f.length:0))}},h.prototype.isExpanded=function(r){var t=this.gridOptionsWrapper.getGroupDefaultExpanded();return-1===t||r<t},h.TOP_LEVEL=0,h.ROOT_NODE_ID="ROOT_NODE_ID",h}(),am=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Zi=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},oa=function(){return function(h){h[h.Normal=0]="Normal",h[h.AfterFilter=1]="AfterFilter",h[h.AfterFilterAndSort=2]="AfterFilterAndSort",h[h.PivotNodes=3]="PivotNodes"}(oa||(oa={})),oa}(),m3=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return am(r,h),r.prototype.init=function(){var t=this.refreshModel.bind(this,{step:e.j_r.EVERYTHING}),n=this.refreshModel.bind(this,{step:e.j_r.EVERYTHING,afterColumnsChanged:!0,keepRenderedRows:!0,animate:!0});this.addManagedListener(this.eventService,Ge.EVENT_NEW_COLUMNS_LOADED,n),this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_ROW_GROUP_CHANGED,t),this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_VALUE_CHANGED,this.onValueChanged.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_PIVOT_CHANGED,this.refreshModel.bind(this,{step:e.j_r.PIVOT})),this.addManagedListener(this.eventService,Ge.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_COLUMN_PIVOT_MODE_CHANGED,t);var c=this.refreshModel.bind(this,{step:e.j_r.MAP,keepRenderedRows:!0,animate:!0});this.addManagedListener(this.gridOptionsWrapper,vr.PROP_GROUP_REMOVE_SINGLE_CHILDREN,c),this.addManagedListener(this.gridOptionsWrapper,vr.PROP_GROUP_REMOVE_LOWEST_SINGLE_CHILDREN,c),this.rootNode=new un(this.beans),this.nodeManager=new om(this.rootNode,this.gridOptionsWrapper,this.eventService,this.columnModel,this.gridApi,this.columnApi,this.selectionService,this.beans)},r.prototype.start=function(){var t=this.gridOptionsWrapper.getRowData();t&&this.setRowData(t)},r.prototype.ensureRowHeightsValid=function(t,n,c,f){var y,T=!1;do{y=!1;for(var B=this.getRowIndexAtPixel(t),q=this.getRowIndexAtPixel(n),de=Math.max(B,c),Se=Math.min(q,f),ke=de;ke<=Se;ke++){var je=this.getRow(ke);if(je.rowHeightEstimated){var Qe=this.gridOptionsWrapper.getRowHeightForNode(je);je.setRowHeight(Qe.height),y=!0,T=!0}}y&&this.setRowTopAndRowIndex()}while(y);return T},r.prototype.setRowTopAndRowIndex=function(){for(var t=this.gridOptionsWrapper.getDefaultRowHeight(),n=0,c=new Set,f=this.gridOptionsWrapper.getDomLayout()===W.DOM_LAYOUT_NORMAL,y=0;y<this.rowsToDisplay.length;y++){var T=this.rowsToDisplay[y];if(null!=T.id&&c.add(T.id),null==T.rowHeight){var B=this.gridOptionsWrapper.getRowHeightForNode(T,f,t);T.setRowHeight(B.height,B.estimated)}T.setRowTop(n),T.setRowIndex(y),n+=T.rowHeight}return c},r.prototype.clearRowTopAndRowIndex=function(t,n){var c=t.isActive(),f=function(B){B&&null!=B.id&&!n.has(B.id)&&B.clearRowTopAndRowIndex()};!function T(B){f(B),f(B.detailNode),f(B.sibling),B.hasChildren()&&B.childrenAfterGroup&&(c&&-1!=B.level&&!B.expanded||B.childrenAfterGroup.forEach(T))}(this.rootNode)},r.prototype.ensureRowsAtPixel=function(t,n,c){var f=this;void 0===c&&(c=0);var y=this.getRowIndexAtPixel(n);return this.getRow(y)!==t[0]&&(t.forEach(function(B){wr.removeFromArray(f.rootNode.allLeafChildren,B)}),t.forEach(function(B,q){wr.insertIntoArray(f.rootNode.allLeafChildren,B,Math.max(y+c,0)+q)}),this.refreshModel({step:e.j_r.EVERYTHING,keepRenderedRows:!0,animate:!0,keepEditingRows:!0}),!0)},r.prototype.highlightRowAtPixel=function(t,n){var c=null!=n?this.getRowIndexAtPixel(n):null,f=null!=c?this.getRow(c):null;if(f&&t&&f!==t&&null!=n){var y=this.getHighlightPosition(n,f);this.lastHighlightedRow&&this.lastHighlightedRow!==f&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null),f.setHighlighted(y),this.lastHighlightedRow=f}else this.lastHighlightedRow&&(this.lastHighlightedRow.setHighlighted(null),this.lastHighlightedRow=null)},r.prototype.getHighlightPosition=function(t,n){if(!n){var c=this.getRowIndexAtPixel(t);if(!(n=this.getRow(c||0)))return e.oh5.Below}return t-n.rowTop<n.rowHeight/2?e.oh5.Above:e.oh5.Below},r.prototype.getLastHighlightedRowNode=function(){return this.lastHighlightedRow},r.prototype.isLastRowIndexKnown=function(){return!0},r.prototype.getRowCount=function(){return this.rowsToDisplay?this.rowsToDisplay.length:0},r.prototype.getTopLevelRowCount=function(){return this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode?1:this.rootNode.childrenAfterFilter?this.rootNode.childrenAfterFilter.length:0},r.prototype.getTopLevelRowDisplayedIndex=function(t){if(this.rowsToDisplay&&this.rowsToDisplay[0]===this.rootNode)return t;var c=this.rootNode.childrenAfterSort[t];if(this.gridOptionsWrapper.isGroupHideOpenParents())for(;c.expanded&&c.childrenAfterSort&&c.childrenAfterSort.length>0;)c=c.childrenAfterSort[0];return c.rowIndex},r.prototype.getRowBounds=function(t){if(wr.missing(this.rowsToDisplay))return null;var n=this.rowsToDisplay[t];return n?{rowTop:n.rowTop,rowHeight:n.rowHeight}:null},r.prototype.onRowGroupOpened=function(){var t=this.gridOptionsWrapper.isAnimateRows();this.refreshModel({step:e.j_r.MAP,keepRenderedRows:!0,animate:t})},r.prototype.onFilterChanged=function(t){if(!t.afterDataChange){var n=this.gridOptionsWrapper.isAnimateRows();this.refreshModel({step:e.j_r.FILTER,keepRenderedRows:!0,animate:n})}},r.prototype.onSortChanged=function(){var t=this.gridOptionsWrapper.isAnimateRows();this.refreshModel({step:e.j_r.SORT,keepRenderedRows:!0,animate:t,keepEditingRows:!0})},r.prototype.getType=function(){return W.ROW_MODEL_TYPE_CLIENT_SIDE},r.prototype.onValueChanged=function(){this.columnModel.isPivotActive()?this.refreshModel({step:e.j_r.PIVOT}):this.refreshModel({step:e.j_r.AGGREGATE})},r.prototype.createChangePath=function(t){var n=wr.missingOrEmpty(t),c=new Rr(!1,this.rootNode);return(n||this.gridOptionsWrapper.isTreeData())&&c.setInactive(),c},r.prototype.isSuppressModelUpdateAfterUpdateTransaction=function(t){if(!this.gridOptionsWrapper.isSuppressModelUpdateAfterUpdateTransaction()||null==t.rowNodeTransactions)return!1;var n=wr.filter(t.rowNodeTransactions,function(f){return null!=f.add&&f.add.length>0||null!=f.remove&&f.remove.length>0});return null==n||0==n.length},r.prototype.refreshModel=function(t){var n=this;if(!this.isSuppressModelUpdateAfterUpdateTransaction(t)){var c=this.createChangePath(t.rowNodeTransactions);switch(t.step){case e.j_r.EVERYTHING:this.doRowGrouping(t.groupState,t.rowNodeTransactions,t.rowNodeOrder,c,!!t.afterColumnsChanged);case e.j_r.FILTER:this.doFilter(c);case e.j_r.PIVOT:this.doPivot(c);case e.j_r.AGGREGATE:this.doAggregate(c);case e.j_r.SORT:this.doSort(t.rowNodeTransactions,c);case e.j_r.MAP:this.doRowsToDisplay()}var f=this.setRowTopAndRowIndex();this.clearRowTopAndRowIndex(c,f),this.eventService.dispatchEvent({type:Ge.EVENT_MODEL_UPDATED,api:this.gridApi,columnApi:this.columnApi,animate:t.animate,keepRenderedRows:t.keepRenderedRows,newData:t.newData,newPage:!1}),this.$scope&&window.setTimeout(function(){n.$scope.$apply()},0)}},r.prototype.isEmpty=function(){var t=wr.missing(this.rootNode.allLeafChildren)||0===this.rootNode.allLeafChildren.length;return wr.missing(this.rootNode)||t||!this.columnModel.isReady()},r.prototype.isRowsToRender=function(){return wr.exists(this.rowsToDisplay)&&this.rowsToDisplay.length>0},r.prototype.getNodesInRangeForSelection=function(t,n){var y,c=!n,f=!1,T=[],B=this.gridOptionsWrapper.isGroupSelectsChildren();return this.forEachNodeAfterFilterAndSort(function(q){var de=c&&!f;if(c||(q===n||q===t)&&(c=!0),!q.group||!B){var ke=c&&!f,je=q.isParentOfNode(y);(ke||je)&&T.push(q)}de&&(q===n||q===t)&&(f=!0,y=q===n?n:t)}),T},r.prototype.setDatasource=function(t){console.error("AG Grid: should never call setDatasource on clientSideRowController")},r.prototype.getTopLevelNodes=function(){return this.rootNode?this.rootNode.childrenAfterGroup:null},r.prototype.getRootNode=function(){return this.rootNode},r.prototype.getRow=function(t){return this.rowsToDisplay[t]},r.prototype.isRowPresent=function(t){return this.rowsToDisplay.indexOf(t)>=0},r.prototype.getRowIndexAtPixel=function(t){if(this.isEmpty())return-1;var n=0,c=this.rowsToDisplay.length-1;if(t<=0)return 0;if(wr.last(this.rowsToDisplay).rowTop<=t)return this.rowsToDisplay.length-1;for(;;){var y=Math.floor((n+c)/2),T=this.rowsToDisplay[y];if(this.isRowInPixel(T,t))return y;T.rowTop<t?n=y+1:T.rowTop>t&&(c=y-1)}},r.prototype.isRowInPixel=function(t,n){return t.rowTop<=n&&t.rowTop+t.rowHeight>n},r.prototype.forEachLeafNode=function(t){this.rootNode.allLeafChildren&&this.rootNode.allLeafChildren.forEach(function(n,c){return t(n,c)})},r.prototype.forEachNode=function(t){this.recursivelyWalkNodesAndCallback(this.rootNode.childrenAfterGroup,t,oa.Normal,0)},r.prototype.forEachNodeAfterFilter=function(t){this.recursivelyWalkNodesAndCallback(this.rootNode.childrenAfterFilter,t,oa.AfterFilter,0)},r.prototype.forEachNodeAfterFilterAndSort=function(t){this.recursivelyWalkNodesAndCallback(this.rootNode.childrenAfterSort,t,oa.AfterFilterAndSort,0)},r.prototype.forEachPivotNode=function(t){this.recursivelyWalkNodesAndCallback([this.rootNode],t,oa.PivotNodes,0)},r.prototype.recursivelyWalkNodesAndCallback=function(t,n,c,f){if(!t)return f;for(var y=0;y<t.length;y++){var T=t[y];if(n(T,f++),T.hasChildren()){var B=null;switch(c){case oa.Normal:B=T.childrenAfterGroup;break;case oa.AfterFilter:B=T.childrenAfterFilter;break;case oa.AfterFilterAndSort:B=T.childrenAfterSort;break;case oa.PivotNodes:B=T.leafGroup?null:T.childrenAfterSort}B&&(f=this.recursivelyWalkNodesAndCallback(B,n,c,f))}}return f},r.prototype.doAggregate=function(t){this.aggregationStage&&this.aggregationStage.execute({rowNode:this.rootNode,changedPath:t})},r.prototype.expandOrCollapseAll=function(t){var n=this.gridOptionsWrapper.isTreeData();this.rootNode&&function c(T){!T||T.forEach(function(B){(n?wr.exists(B.childrenAfterGroup):B.group)&&(B.expanded=t,c(B.childrenAfterGroup))})}(this.rootNode.childrenAfterGroup),this.refreshModel({step:e.j_r.MAP}),this.eventService.dispatchEvent({api:this.gridApi,columnApi:this.columnApi,type:Ge.EVENT_EXPAND_COLLAPSE_ALL,source:t?"expandAll":"collapseAll"})},r.prototype.doSort=function(t,n){this.sortStage.execute({rowNode:this.rootNode,rowNodeTransactions:t,changedPath:n})},r.prototype.doRowGrouping=function(t,n,c,f,y){this.groupStage?(n?this.groupStage.execute({rowNode:this.rootNode,rowNodeTransactions:n,rowNodeOrder:c,changedPath:f}):(this.groupStage.execute({rowNode:this.rootNode,changedPath:f,afterColumnsChanged:y}),this.restoreGroupState(t)),this.gridOptionsWrapper.isGroupSelectsChildren()&&this.selectionService.updateGroupsFromChildrenSelections(f)):(this.rootNode.childrenAfterGroup=this.rootNode.allLeafChildren,this.rootNode.sibling&&(this.rootNode.sibling.childrenAfterGroup=this.rootNode.childrenAfterGroup),this.rootNode.updateHasChildren())},r.prototype.restoreGroupState=function(t){!t||wr.traverseNodesWithKey(this.rootNode.childrenAfterGroup,function(n,c){"boolean"==typeof t[c]&&(n.expanded=t[c])})},r.prototype.doFilter=function(t){this.filterStage.execute({rowNode:this.rootNode,changedPath:t})},r.prototype.doPivot=function(t){this.pivotStage&&this.pivotStage.execute({rowNode:this.rootNode,changedPath:t})},r.prototype.getGroupState=function(){if(!this.rootNode.childrenAfterGroup||!this.gridOptionsWrapper.isRememberGroupStateWhenNewData())return null;var t={};return wr.traverseNodesWithKey(this.rootNode.childrenAfterGroup,function(n,c){return t[c]=n.expanded}),t},r.prototype.getCopyOfNodesMap=function(){return this.nodeManager.getCopyOfNodesMap()},r.prototype.getRowNode=function(t){if("string"==typeof t&&0==t.indexOf(un.ID_PREFIX_ROW_GROUP)){var c=void 0;return this.forEachNode(function(f){f.id===t&&(c=f)}),c}return this.nodeManager.getRowNode(t)},r.prototype.setRowData=function(t){var n=this.getGroupState();this.nodeManager.setRowData(t),this.eventService.dispatchEvent({type:Ge.EVENT_ROW_DATA_CHANGED,api:this.gridApi,columnApi:this.columnApi}),this.refreshModel({step:e.j_r.EVERYTHING,groupState:n,newData:!0})},r.prototype.batchUpdateRowData=function(t,n){var c=this;if(null==this.applyAsyncTransactionsTimeout){this.rowDataTransactionBatch=[];var f=this.gridOptionsWrapper.getAsyncTransactionWaitMillis();this.applyAsyncTransactionsTimeout=window.setTimeout(function(){c.executeBatchUpdateRowData()},f)}this.rowDataTransactionBatch.push({rowDataTransaction:t,callback:n})},r.prototype.flushAsyncTransactions=function(){null!=this.applyAsyncTransactionsTimeout&&(clearTimeout(this.applyAsyncTransactionsTimeout),this.executeBatchUpdateRowData())},r.prototype.executeBatchUpdateRowData=function(){var t=this;this.valueCache.onDataChanged();var n=[],c=[],f=!1;if(this.rowDataTransactionBatch&&this.rowDataTransactionBatch.forEach(function(T){var B=t.nodeManager.updateRowData(T.rowDataTransaction,void 0);c.push(B),T.callback&&n.push(T.callback.bind(null,B)),"number"==typeof T.rowDataTransaction.addIndex&&(f=!0)}),this.commonUpdateRowData(c,void 0,f),n.length>0&&window.setTimeout(function(){n.forEach(function(T){return T()})},0),c.length>0){var y={api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi(),type:Ge.EVENT_ASYNC_TRANSACTIONS_FLUSHED,results:c};this.eventService.dispatchEvent(y)}this.rowDataTransactionBatch=null,this.applyAsyncTransactionsTimeout=void 0},r.prototype.updateRowData=function(t,n){this.valueCache.onDataChanged();var c=this.nodeManager.updateRowData(t,n);return this.commonUpdateRowData([c],n,"number"==typeof t.addIndex),c},r.prototype.createRowNodeOrder=function(){if(!this.gridOptionsWrapper.isSuppressMaintainUnsortedOrder()){var n={};if(this.rootNode&&this.rootNode.allLeafChildren)for(var c=0;c<this.rootNode.allLeafChildren.length;c++)n[this.rootNode.allLeafChildren[c].id]=c;return n}},r.prototype.commonUpdateRowData=function(t,n,c){c&&(n=this.createRowNodeOrder()),this.refreshModel({step:e.j_r.EVERYTHING,rowNodeTransactions:t,rowNodeOrder:n,keepRenderedRows:!0,animate:!0,keepEditingRows:!0}),this.eventService.dispatchEvent({type:Ge.EVENT_ROW_DATA_UPDATED,api:this.gridApi,columnApi:this.columnApi})},r.prototype.doRowsToDisplay=function(){this.rowsToDisplay=this.flattenStage.execute({rowNode:this.rootNode})},r.prototype.onRowHeightChanged=function(){this.refreshModel({step:e.j_r.MAP,keepRenderedRows:!0,keepEditingRows:!0})},r.prototype.resetRowHeights=function(){var t=!1;this.forEachNode(function(n){n.setRowHeight(n.rowHeight,!0);var c=n.detailNode;c&&c.setRowHeight(c.rowHeight,!0),t=!0}),t&&this.onRowHeightChanged()},Zi([Ee("columnModel")],r.prototype,"columnModel",void 0),Zi([Ee("$scope")],r.prototype,"$scope",void 0),Zi([Ee("selectionService")],r.prototype,"selectionService",void 0),Zi([Ee("valueCache")],r.prototype,"valueCache",void 0),Zi([Ee("columnApi")],r.prototype,"columnApi",void 0),Zi([Ee("gridApi")],r.prototype,"gridApi",void 0),Zi([Ee("animationFrameService")],r.prototype,"animationFrameService",void 0),Zi([Ee("beans")],r.prototype,"beans",void 0),Zi([Ee("filterStage")],r.prototype,"filterStage",void 0),Zi([Ee("sortStage")],r.prototype,"sortStage",void 0),Zi([Ee("flattenStage")],r.prototype,"flattenStage",void 0),Zi([Nr("groupStage")],r.prototype,"groupStage",void 0),Zi([Nr("aggregationStage")],r.prototype,"aggregationStage",void 0),Zi([Nr("pivotStage")],r.prototype,"pivotStage",void 0),Zi([zt],r.prototype,"init",null),Zi([Kt("rowModel")],r)}(ct),gr=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Ch=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},y3=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return gr(r,h),r.prototype.execute=function(t){var n=t.rowNode;this.filterService.filter(t.changedPath),this.selectableService.updateSelectableAfterFiltering(n)},Ch([Ee("selectableService")],r.prototype,"selectableService",void 0),Ch([Ee("filterService")],r.prototype,"filterService",void 0),Ch([Kt("filterStage")],r)}(ct),sm=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),af=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},C3=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return sm(r,h),r.prototype.execute=function(t){var n=this.sortController.getSortOptions(),c=wr.exists(n)&&n.length>0,f=c&&wr.exists(t.rowNodeTransactions)&&this.gridOptionsWrapper.isDeltaSort(),y=f?this.calculateDirtyNodes(t.rowNodeTransactions):null,T=wr.missingOrEmpty(this.columnModel.getValueColumns()),B=wr.some(n,function(q){return!!q.column.getColDef().showRowGroup});this.sortService.sort(n,c,f,y,t.changedPath,T,B)},r.prototype.calculateDirtyNodes=function(t){var n={},c=function(y){y&&y.forEach(function(T){return n[T.id]=!0})};return t&&t.forEach(function(f){c(f.add),c(f.update),c(f.remove)}),n},af([Ee("sortService")],r.prototype,"sortService",void 0),af([Ee("sortController")],r.prototype,"sortController",void 0),af([Ee("columnModel")],r.prototype,"columnModel",void 0),af([Kt("sortStage")],r)}(ct),lm=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),wh=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},um=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return lm(r,h),r.prototype.execute=function(t){var n=t.rowNode,c=[],f={value:0},y=this.columnModel.isPivotMode(),T=y&&n.leafGroup;return this.recursivelyAddToRowsToDisplay(T?[n]:n.childrenAfterSort,c,f,y,0),!T&&c.length>0&&this.gridOptionsWrapper.isGroupIncludeTotalFooter()&&(this.ensureFooterNodeExists(n),this.addRowNodeToRowsToDisplay(n.sibling,c,f,0)),c},r.prototype.recursivelyAddToRowsToDisplay=function(t,n,c,f,y){if(!wr.missingOrEmpty(t))for(var T=this.gridOptionsWrapper.isGroupHideOpenParents(),B=this.gridOptionsWrapper.isGroupRemoveSingleChildren(),q=!B&&this.gridOptionsWrapper.isGroupRemoveLowestSingleChildren(),de=0;de<t.length;de++){var Se=t[de],ke=Se.hasChildren(),Qe=B&&ke&&1===Se.childrenAfterGroup.length,rt=q&&ke&&Se.leafGroup&&1===Se.childrenAfterGroup.length;if(!(f&&!ke||T&&Se.expanded&&(!f||!Se.leafGroup)||Qe||rt)&&this.addRowNodeToRowsToDisplay(Se,n,c,y),!f||!Se.leafGroup)if(ke){var Rt=Qe||rt;(Se.expanded||Rt)&&(this.recursivelyAddToRowsToDisplay(Se.childrenAfterSort,n,c,f,Rt?y:y+1),this.gridOptionsWrapper.isGroupIncludeFooter()&&(this.ensureFooterNodeExists(Se),this.addRowNodeToRowsToDisplay(Se.sibling,n,c,y)))}else if(Se.master&&Se.expanded){var It=this.createDetailNode(Se);this.addRowNodeToRowsToDisplay(It,n,c,y)}}},r.prototype.addRowNodeToRowsToDisplay=function(t,n,c,f){var y=this.gridOptionsWrapper.isGroupMultiAutoColumn();n.push(t),t.setUiLevel(y?0:f)},r.prototype.ensureFooterNodeExists=function(t){if(!wr.exists(t.sibling)){var n=new un(this.beans);Object.keys(t).forEach(function(c){n[c]=t[c]}),n.footer=!0,n.setRowTop(null),n.setRowIndex(null),n.oldRowTop=null,wr.exists(n.id)&&(n.id="rowGroupFooter_"+n.id),n.sibling=t,t.sibling=n}},r.prototype.createDetailNode=function(t){if(wr.exists(t.detailNode))return t.detailNode;var n=new un(this.beans);return n.detail=!0,n.selectable=!1,n.parent=t,wr.exists(t.id)&&(n.id="detail_"+t.id),n.data=t.data,n.level=t.level+1,t.detailNode=n,n},wh([Ee("columnModel")],r.prototype,"columnModel",void 0),wh([Ee("beans")],r.prototype,"beans",void 0),wh([Kt("flattenStage")],r)}(ct),w3=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),sf=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},v5=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return w3(r,h),r.prototype.init=function(){this.postSortFunc=this.gridOptionsWrapper.getPostSortFunc()},r.prototype.sort=function(t,n,c,f,y,T,B){var q=this,de=this.gridOptionsWrapper.isGroupMaintainOrder(),Se=wr.some(this.columnModel.getAllGridColumns(),function(je){return je.isRowGroupActive()});y&&y.forEachChangedNodeDepthFirst(function(Qe){q.pullDownGroupDataForHideOpenParents(Qe.childrenAfterFilter,!0),Qe.childrenAfterSort=n?de&&Se&&!Qe.leafGroup&&!B?Qe.childrenAfterFilter.slice(0):c?q.doDeltaSort(Qe,t,f,y,T):q.rowNodeSorter.doFullSort(Qe.childrenAfterFilter,t):Qe.childrenAfterFilter.slice(0),Qe.sibling&&(Qe.sibling.childrenAfterSort=Qe.childrenAfterSort),q.updateChildIndexes(Qe),q.postSortFunc&&q.postSortFunc(Qe.childrenAfterSort)}),this.updateGroupDataForHideOpenParents(y)},r.prototype.mapNodeToSortedNode=function(t,n){return{currentPos:n,rowNode:t}},r.prototype.doDeltaSort=function(t,n,c,f,y){var T=t.childrenAfterSort.filter(function(Se){var ke=!c[Se.id],je=y||f&&f.canSkip(Se);return ke&&je}).map(this.mapNodeToSortedNode.bind(this)),B={};T.forEach(function(Se){return B[Se.rowNode.id]=Se.rowNode});var q=t.childrenAfterFilter.filter(function(Se){return!B[Se.id]}).map(this.mapNodeToSortedNode.bind(this));return q.sort(this.rowNodeSorter.compareRowNodes.bind(this,n)),(0===q.length?T:0===T.length?q:this.mergeSortedArrays(n,T,q)).map(function(Se){return Se.rowNode})},r.prototype.mergeSortedArrays=function(t,n,c){for(var f=[],y=0,T=0;y<n.length&&T<c.length;){var B=this.rowNodeSorter.compareRowNodes(t,n[y],c[T]);f.push(B<0?n[y++]:c[T++])}for(;y<n.length;)f.push(n[y++]);for(;T<c.length;)f.push(c[T++]);return f},r.prototype.updateChildIndexes=function(t){if(!wr.missing(t.childrenAfterSort))for(var n=t.childrenAfterSort,c=0;c<n.length;c++){var f=n[c],T=c===t.childrenAfterSort.length-1;f.setFirstChild(0===c),f.setLastChild(T),f.setChildIndex(c)}},r.prototype.updateGroupDataForHideOpenParents=function(t){var n=this;if(this.gridOptionsWrapper.isGroupHideOpenParents()){if(this.gridOptionsWrapper.isTreeData())return wr.doOnce(function(){return console.warn("AG Grid: The property hideOpenParents dose not work with Tree Data. This is because Tree Data has values at the group level, it doesn't make sense to hide them (as opposed to Row Grouping, which only has Aggregated Values at the group level).")},"sortService.hideOpenParentsWithTreeData"),!1;var f=function y(T){n.pullDownGroupDataForHideOpenParents(T.childrenAfterSort,!1),T.childrenAfterSort.forEach(function(B){B.hasChildren()&&y(B)})};t&&t.executeFromRootNode(function(y){return f(y)})}},r.prototype.pullDownGroupDataForHideOpenParents=function(t,n){var c=this;!this.gridOptionsWrapper.isGroupHideOpenParents()||wr.missing(t)||t.forEach(function(f){c.columnModel.getGroupDisplayColumns().forEach(function(T){var B=T.getColDef().showRowGroup;if("string"==typeof B){var de=c.columnModel.getPrimaryColumn(B);if(de!==f.rowGroupColumn)if(n)f.setGroupValue(T.getId(),void 0);else{var ke=f.getFirstChildOfFirstChild(de);ke&&f.setGroupValue(T.getId(),ke.key)}}else console.error("AG Grid: groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup")})})},sf([Ee("columnModel")],r.prototype,"columnModel",void 0),sf([Ee("rowNodeSorter")],r.prototype,"rowNodeSorter",void 0),sf([zt],r.prototype,"init",null),sf([Kt("sortService")],r)}(ct),_3=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),M0=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},_h=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return _3(r,h),r.prototype.postConstruct=function(){this.doingTreeData=this.gridOptionsWrapper.isTreeData()},r.prototype.filter=function(t){var n=this.filterManager.isAnyFilterPresent();this.filterNodes(n,t)},r.prototype.filterNodes=function(t,n){var c=this,f=function(de,Se){de.hasChildren()?(de.childrenAfterFilter=t&&!Se?de.childrenAfterGroup.filter(function(ke){var je=ke.childrenAfterFilter&&ke.childrenAfterFilter.length>0,Qe=ke.data&&c.filterManager.doesRowPassFilter({rowNode:ke});return je||Qe}):de.childrenAfterGroup,c.setAllChildrenCount(de)):(de.childrenAfterFilter=de.childrenAfterGroup,de.setAllChildrenCount(null)),de.sibling&&(de.sibling.childrenAfterFilter=de.childrenAfterFilter)};if(this.doingTreeDataFiltering()){var y=function q(de,Se){if(de.childrenAfterGroup)for(var ke=0;ke<de.childrenAfterGroup.length;ke++){var je=de.childrenAfterGroup[ke],Qe=Se||c.filterManager.doesRowPassFilter({rowNode:je});je.childrenAfterGroup?q(de.childrenAfterGroup[ke],Qe):f(je,Qe)}f(de,Se)};n.executeFromRootNode(function(de){return y(de,!1)})}else n.forEachChangedNodeDepthFirst(function(de){return f(de,!1)},!0)},r.prototype.setAllChildrenCountTreeData=function(t){var n=0;t.childrenAfterFilter.forEach(function(c){n++,n+=c.allChildrenCount}),t.setAllChildrenCount(n)},r.prototype.setAllChildrenCountGridGrouping=function(t){var n=0;t.childrenAfterFilter.forEach(function(c){c.group?n+=c.allChildrenCount:n++}),t.setAllChildrenCount(n)},r.prototype.setAllChildrenCount=function(t){this.doingTreeData?this.setAllChildrenCountTreeData(t):this.setAllChildrenCountGridGrouping(t)},r.prototype.doingTreeDataFiltering=function(){return this.gridOptionsWrapper.isTreeData()&&!this.gridOptionsWrapper.isExcludeChildrenWhenTreeDataFiltering()},M0([Ee("filterManager")],r.prototype,"filterManager",void 0),M0([zt],r.prototype,"postConstruct",null),M0([Kt("filterService")],r)}(ct),S3=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),cm=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},g5=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return S3(r,h),r.prototype.postConstruct=function(){this.rowModel.getType()===W.ROW_MODEL_TYPE_CLIENT_SIDE&&(this.clientSideRowModel=this.rowModel)},r.prototype.createTransactionForRowData=function(t){if(wr.missing(this.clientSideRowModel))console.error("AG Grid: ImmutableService only works with ClientSideRowModel");else{var n=this.gridOptionsWrapper.getRowNodeIdFunc();if(n&&!wr.missing(n)){var c={remove:[],update:[],add:[]},f=this.clientSideRowModel.getCopyOfNodesMap(),T=this.gridOptionsWrapper.isSuppressMaintainUnsortedOrder()?null:{};return wr.exists(t)&&t.forEach(function(B,q){var de=n(B),Se=f[de];T&&(T[de]=q),Se?(Se.data!==B&&c.update.push(B),f[de]=void 0):c.add.push(B)}),wr.iterateObject(f,function(B,q){q&&c.remove.push(q.data)}),[c,T]}console.error("AG Grid: ImmutableService requires getRowNodeId() callback to be implemented, your row data need IDs!")}},cm([Ee("rowModel")],r.prototype,"rowModel",void 0),cm([zt],r.prototype,"postConstruct",null),cm([Kt("immutableService")],r)}(ct),m5={moduleName:e.GXE.ClientSideRowModelModule,beans:[y3,C3,um,v5,_h,g5],rowModels:{clientSide:m3}},x3=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),lf=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},b3=function(h){function r(t,n,c){var f=h.call(this,t)||this;return f.parentCache=n,f.params=c,f.startRow=t*c.blockSize,f.endRow=f.startRow+c.blockSize,f}return x3(r,h),r.prototype.postConstruct=function(){this.createRowNodes()},r.prototype.getBlockStateJson=function(){return{id:""+this.getId(),state:{blockNumber:this.getId(),startRow:this.getStartRow(),endRow:this.getEndRow(),pageStatus:this.getState()}}},r.prototype.setDataAndId=function(t,n,c){!t.id&&t.alreadyRendered&&(t.alreadyRendered=!1),wr.exists(n)?t.setDataAndId(n,c.toString()):t.setDataAndId(void 0,void 0)},r.prototype.loadFromDatasource=function(){var t=this,n=this.createLoadParams();wr.missing(this.params.datasource.getRows)?console.warn("AG Grid: datasource is missing getRows method"):window.setTimeout(function(){t.params.datasource.getRows(n)},0)},r.prototype.processServerFail=function(){},r.prototype.createLoadParams=function(){return{startRow:this.getStartRow(),endRow:this.getEndRow(),successCallback:this.pageLoaded.bind(this,this.getVersion()),failCallback:this.pageLoadFailed.bind(this,this.getVersion()),sortModel:this.params.sortModel,filterModel:this.params.filterModel,context:this.gridOptionsWrapper.getContext()}},r.prototype.forEachNode=function(t,n,c){var f=this;this.rowNodes.forEach(function(y,T){f.startRow+T<c&&t(y,n.next())})},r.prototype.getLastAccessed=function(){return this.lastAccessed},r.prototype.getRow=function(t,n){return void 0===n&&(n=!1),n||(this.lastAccessed=this.params.lastAccessedSequence.next()),this.rowNodes[t-this.startRow]},r.prototype.getStartRow=function(){return this.startRow},r.prototype.getEndRow=function(){return this.endRow},r.prototype.createRowNodes=function(){this.rowNodes=[];for(var t=0;t<this.params.blockSize;t++){var n=this.startRow+t,c=new un(this.beans);c.setRowHeight(this.params.rowHeight),c.uiLevel=0,c.setRowIndex(n),c.setRowTop(this.params.rowHeight*n),this.rowNodes.push(c)}},r.prototype.processServerResult=function(t){var n=this;this.rowNodes.forEach(function(f,y){n.setDataAndId(f,t.rowData?t.rowData[y]:void 0,n.startRow+y)}),this.parentCache.pageLoaded(this,null!=t.rowCount&&t.rowCount>=0?t.rowCount:void 0)},r.prototype.destroyRowNodes=function(){this.rowNodes.forEach(function(t){t.clearRowTopAndRowIndex()})},lf([Ee("beans")],r.prototype,"beans",void 0),lf([zt],r.prototype,"postConstruct",null),lf([Ln],r.prototype,"destroyRowNodes",null),r}(dh),A3=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),ds=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},M3=function(h,r){return function(t,n){r(t,n,h)}},fm=function(h){function r(t){var n=h.call(this)||this;return n.lastRowIndexKnown=!1,n.blocks={},n.blockCount=0,n.rowCount=t.initialRowCount,n.params=t,n}return A3(r,h),r.prototype.setBeans=function(t){this.logger=t.create("InfiniteCache")},r.prototype.getRow=function(t,n){void 0===n&&(n=!1);var c=Math.floor(t/this.params.blockSize),f=this.blocks[c];if(!f){if(n)return;f=this.createBlock(c)}return f.getRow(t)},r.prototype.createBlock=function(t){var n=this.createBean(new b3(t,this,this.params));return this.blocks[n.getId()]=n,this.blockCount++,this.purgeBlocksIfNeeded(n),this.params.rowNodeBlockLoader.addBlock(n),n},r.prototype.refreshCache=function(){0==this.blockCount?this.purgeCache():(this.getBlocksInOrder().forEach(function(n){return n.setStateWaitingToLoad()}),this.params.rowNodeBlockLoader.checkBlockToLoad())},r.prototype.destroyAllBlocks=function(){var t=this;this.getBlocksInOrder().forEach(function(n){return t.destroyBlock(n)})},r.prototype.getRowCount=function(){return this.rowCount},r.prototype.isLastRowIndexKnown=function(){return this.lastRowIndexKnown},r.prototype.pageLoaded=function(t,n){!this.isAlive()||(this.logger.log("onPageLoaded: page = "+t.getId()+", lastRow = "+n),this.checkRowCount(t,n),this.onCacheUpdated())},r.prototype.purgeBlocksIfNeeded=function(t){var n=this,c=this.getBlocksInOrder().filter(function(q){return q!=t});c.sort(function(de,Se){return Se.getLastAccessed()-de.getLastAccessed()});var y=this.params.maxBlocksInCache>0,T=y?this.params.maxBlocksInCache-1:null,B=r.MAX_EMPTY_BLOCKS_TO_KEEP-1;c.forEach(function(q,de){if(q.getState()===b3.STATE_WAITING_TO_LOAD&&de>=B||y&&de>=T){if(n.isBlockCurrentlyDisplayed(q)||n.isBlockFocused(q))return;n.removeBlockFromCache(q)}})},r.prototype.isBlockFocused=function(t){var n=this.focusService.getFocusCellToUseAfterRefresh();if(!n||null!=n.rowPinned)return!1;var c=t.getStartRow(),f=t.getEndRow();return n.rowIndex>=c&&n.rowIndex<f},r.prototype.isBlockCurrentlyDisplayed=function(t){var n=t.getStartRow(),c=t.getEndRow()-1;return this.rowRenderer.isRangeInRenderedViewport(n,c)},r.prototype.removeBlockFromCache=function(t){!t||this.destroyBlock(t)},r.prototype.checkRowCount=function(t,n){if("number"==typeof n&&n>=0)this.rowCount=n,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){var f=(t.getId()+1)*this.params.blockSize+this.params.overflowSize;this.rowCount<f&&(this.rowCount=f)}},r.prototype.setRowCount=function(t,n){this.rowCount=t,wr.exists(n)&&(this.lastRowIndexKnown=n),this.lastRowIndexKnown||this.rowCount%this.params.blockSize==0&&this.rowCount++,this.onCacheUpdated()},r.prototype.forEachNodeDeep=function(t){var n=this,c=new $a;this.getBlocksInOrder().forEach(function(f){return f.forEachNode(t,c,n.rowCount)})},r.prototype.getBlocksInOrder=function(){return wr.getAllValuesInObject(this.blocks).sort(function(f,y){return f.getId()-y.getId()})},r.prototype.destroyBlock=function(t){delete this.blocks[t.getId()],this.destroyBean(t),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(t)},r.prototype.onCacheUpdated=function(){this.isAlive()&&(this.destroyAllBlocksPastVirtualRowCount(),this.eventService.dispatchEvent({type:Ge.EVENT_STORE_UPDATED}))},r.prototype.destroyAllBlocksPastVirtualRowCount=function(){var t=this,n=[];this.getBlocksInOrder().forEach(function(c){c.getId()*t.params.blockSize>=t.rowCount&&n.push(c)}),n.length>0&&n.forEach(function(c){return t.destroyBlock(c)})},r.prototype.purgeCache=function(){var t=this;this.getBlocksInOrder().forEach(function(n){return t.removeBlockFromCache(n)}),this.lastRowIndexKnown=!1,0===this.rowCount&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()},r.prototype.getRowNodesInRange=function(t,n){var c=this,f=[],y=-1,T=!1,B=new $a;wr.missing(t)&&(T=!0);var q=!1;return this.getBlocksInOrder().forEach(function(Se){if(!q){if(T&&y+1!==Se.getId())return void(q=!0);y=Se.getId(),Se.forEachNode(function(ke){var je=ke===t||ke===n;(T||je)&&f.push(ke),je&&(T=!T)},B,c.rowCount)}}),q||T?[]:f},r.MAX_EMPTY_BLOCKS_TO_KEEP=2,ds([Ee("rowRenderer")],r.prototype,"rowRenderer",void 0),ds([Ee("focusService")],r.prototype,"focusService",void 0),ds([M3(0,Dn("loggerFactory"))],r.prototype,"setBeans",null),ds([Ln],r.prototype,"destroyAllBlocks",null),r}(ct),T3=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),ya=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},dm=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return T3(r,h),r.prototype.getRowBounds=function(t){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*t}},r.prototype.ensureRowHeightsValid=function(t,n,c,f){return!1},r.prototype.init=function(){var t=this;!this.gridOptionsWrapper.isRowModelInfinite()||(this.rowHeight=this.gridOptionsWrapper.getRowHeightAsNumber(),this.addEventListeners(),this.addDestroyFunc(function(){return t.destroyCache()}),this.verifyProps())},r.prototype.verifyProps=function(){null!=this.gridOptionsWrapper.getDefaultGroupOrderComparator()&&wr.doOnce(function(){return console.warn("AG Grid: defaultGroupOrderComparator cannot be used with Infinite Row Model. If using Infinite Row Model, then sorting is done on the server side, nothing to do with the client.")},"IRM.DefaultGroupOrderComparator")},r.prototype.start=function(){this.setDatasource(this.gridOptionsWrapper.getDatasource())},r.prototype.destroyDatasource=function(){this.datasource&&(this.getContext().destroyBean(this.datasource),this.rowRenderer.datasourceChanged(),this.datasource=null)},r.prototype.addEventListeners=function(){this.addManagedListener(this.eventService,Ge.EVENT_FILTER_CHANGED,this.onFilterChanged.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_SORT_CHANGED,this.onSortChanged.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_NEW_COLUMNS_LOADED,this.onColumnEverything.bind(this)),this.addManagedListener(this.eventService,Ge.EVENT_STORE_UPDATED,this.onCacheUpdated.bind(this))},r.prototype.onFilterChanged=function(){this.reset()},r.prototype.onSortChanged=function(){this.reset()},r.prototype.onColumnEverything=function(){(!this.cacheParams||this.isSortModelDifferent())&&this.reset()},r.prototype.isSortModelDifferent=function(){return!wr.jsonEquals(this.cacheParams.sortModel,this.sortController.getSortModel())},r.prototype.getType=function(){return W.ROW_MODEL_TYPE_INFINITE},r.prototype.setDatasource=function(t){this.destroyDatasource(),this.datasource=t,t&&this.reset()},r.prototype.isEmpty=function(){return!this.infiniteCache},r.prototype.isRowsToRender=function(){return!!this.infiniteCache},r.prototype.getNodesInRangeForSelection=function(t,n){return this.infiniteCache?this.infiniteCache.getRowNodesInRange(t,n):[]},r.prototype.reset=function(){if(this.datasource){wr.exists(this.gridOptionsWrapper.getRowNodeIdFunc())||this.selectionService.reset(),this.resetCache();var n=this.createModelUpdatedEvent();this.eventService.dispatchEvent(n)}},r.prototype.createModelUpdatedEvent=function(){return{type:Ge.EVENT_MODEL_UPDATED,api:this.gridApi,columnApi:this.columnApi,newPage:!1,newData:!1,keepRenderedRows:!0,animate:!1}},r.prototype.resetCache=function(){this.destroyCache();var t=this.gridOptionsWrapper.getMaxConcurrentDatasourceRequests();this.cacheParams={datasource:this.datasource,filterModel:this.filterManager.getFilterModel(),sortModel:this.sortController.getSortModel(),rowNodeBlockLoader:this.rowNodeBlockLoader,maxConcurrentRequests:this.defaultIfInvalid(t,2),initialRowCount:this.defaultIfInvalid(this.gridOptionsWrapper.getInfiniteInitialRowCount(),1),maxBlocksInCache:this.gridOptionsWrapper.getMaxBlocksInCache(),rowHeight:this.gridOptionsWrapper.getRowHeightAsNumber(),overflowSize:this.defaultIfInvalid(this.gridOptionsWrapper.getCacheOverflowSize(),1),blockSize:this.defaultIfInvalid(this.gridOptionsWrapper.getCacheBlockSize(),100),lastAccessedSequence:new $a},this.infiniteCache=this.createBean(new fm(this.cacheParams))},r.prototype.defaultIfInvalid=function(t,n){return t>0?t:n},r.prototype.destroyCache=function(){this.infiniteCache&&(this.infiniteCache=this.destroyBean(this.infiniteCache))},r.prototype.onCacheUpdated=function(){var t=this.createModelUpdatedEvent();this.eventService.dispatchEvent(t)},r.prototype.getRow=function(t){if(this.infiniteCache&&!(t>=this.infiniteCache.getRowCount()))return this.infiniteCache.getRow(t)},r.prototype.getRowNode=function(t){var n=void 0;return this.forEachNode(function(c){c.id===t&&(n=c)}),n},r.prototype.forEachNode=function(t){this.infiniteCache&&this.infiniteCache.forEachNodeDeep(t)},r.prototype.getTopLevelRowCount=function(){return this.getRowCount()},r.prototype.getTopLevelRowDisplayedIndex=function(t){return t},r.prototype.getRowIndexAtPixel=function(t){if(0!==this.rowHeight){var n=Math.floor(t/this.rowHeight),c=this.getRowCount()-1;return n>c?c:n}return 0},r.prototype.getRowCount=function(){return this.infiniteCache?this.infiniteCache.getRowCount():0},r.prototype.isRowPresent=function(t){return!!this.getRowNode(t.id)},r.prototype.refreshCache=function(){this.infiniteCache&&this.infiniteCache.refreshCache()},r.prototype.purgeCache=function(){this.infiniteCache&&this.infiniteCache.purgeCache()},r.prototype.isLastRowIndexKnown=function(){return!!this.infiniteCache&&this.infiniteCache.isLastRowIndexKnown()},r.prototype.setRowCount=function(t,n){this.infiniteCache&&this.infiniteCache.setRowCount(t,n)},ya([Ee("filterManager")],r.prototype,"filterManager",void 0),ya([Ee("sortController")],r.prototype,"sortController",void 0),ya([Ee("selectionService")],r.prototype,"selectionService",void 0),ya([Ee("gridApi")],r.prototype,"gridApi",void 0),ya([Ee("columnApi")],r.prototype,"columnApi",void 0),ya([Ee("rowRenderer")],r.prototype,"rowRenderer",void 0),ya([Ee("rowNodeBlockLoader")],r.prototype,"rowNodeBlockLoader",void 0),ya([zt],r.prototype,"init",null),ya([Ln],r.prototype,"destroyDatasource",null),ya([Kt("rowModel")],r)}(ct),E3={moduleName:e.GXE.InfiniteRowModelModule,rowModels:{infinite:dm}},Sh=function(){function h(){}return h.prototype.setBeans=function(r){this.beans=r},h.prototype.getFileName=function(r){var t=this.getDefaultFileExtension();return(null==r||!r.length)&&(r=this.getDefaultFileName()),-1===r.indexOf(".")?r+"."+t:r},h.prototype.getMergedParamsAndData=function(r){var t=this.mergeDefaultParams(r);return{mergedParams:t,data:this.beans.gridSerializer.serialize(this.createSerializingSession(t),t)}},h.prototype.mergeDefaultParams=function(r){var t=this.getDefaultExportParams(),n={};return wr.assign(n,t),wr.assign(n,r),n},h}(),hm=function(){function h(r){this.groupColumns=[];var n=r.valueService,c=r.gridOptionsWrapper,f=r.processCellCallback,y=r.processHeaderCallback,T=r.processGroupHeaderCallback,B=r.processRowGroupCallback;this.columnModel=r.columnModel,this.valueService=n,this.gridOptionsWrapper=c,this.processCellCallback=f,this.processHeaderCallback=y,this.processGroupHeaderCallback=T,this.processRowGroupCallback=B}return h.prototype.prepare=function(r){this.groupColumns=wr.filter(r,function(t){return!!t.getColDef().showRowGroup})},h.prototype.extractHeaderValue=function(r){var t=this.getHeaderName(this.processHeaderCallback,r);return null!=t?t:""},h.prototype.extractRowCellValue=function(r,t,n,c,f){var B,y=this.gridOptionsWrapper.isGroupMultiAutoColumn()?f.rowGroupIndex:0;B=f&&f.group&&(t===y&&-1!==this.groupColumns.indexOf(r)||0===t&&this.gridOptionsWrapper.isGroupUseEntireRow(this.columnModel.isPivotMode()))?this.createValueForGroupNode(f):this.valueService.getValue(r,f);var q=this.processCell(n,f,r,B,this.processCellCallback,c);return null!=q?q:""},h.prototype.getHeaderName=function(r,t){return r?r({column:t,api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi(),context:this.gridOptionsWrapper.getContext()}):this.columnModel.getDisplayNameForColumn(t,"csv",!0)},h.prototype.createValueForGroupNode=function(r){if(this.processRowGroupCallback)return this.processRowGroupCallback({node:r,api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi(),context:this.gridOptionsWrapper.getContext()});var t=[r.key];if(!this.gridOptionsWrapper.isGroupMultiAutoColumn())for(;r.parent;)t.push((r=r.parent).key);return t.reverse().join(" -> ")},h.prototype.processCell=function(r,t,n,c,f,y){return f?f({accumulatedRowIndex:r,column:n,node:t,value:c,api:this.gridOptionsWrapper.getApi(),columnApi:this.gridOptionsWrapper.getColumnApi(),context:this.gridOptionsWrapper.getContext(),type:y}):null!=c?c:""},h}(),pm=function(){function h(){}return h.download=function(r,t){var n=document.defaultView||window;if(n)if(n.navigator.msSaveOrOpenBlob)n.navigator.msSaveOrOpenBlob(t,r);else{var c=document.createElement("a"),f=n.URL.createObjectURL(t);c.setAttribute("href",f),c.setAttribute("download",r),c.style.display="none",document.body.appendChild(c),c.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:n})),document.body.removeChild(c),n.setTimeout(function(){n.URL.revokeObjectURL(f)},0)}else console.warn("AG Grid: There is no `window` associated with the current `document`")},h}(),R3=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),O3=function(h){function r(t){var n=h.call(this,t)||this;n.isFirstLine=!0,n.result="";var f=t.columnSeparator;return n.suppressQuotes=t.suppressQuotes,n.columnSeparator=f,n}return R3(r,h),r.prototype.addCustomContent=function(t){var n=this;!t||("string"==typeof t?(/^\s*\n/.test(t)||this.beginNewLine(),t=t.replace(/\r?\n/g,"\r\n"),this.result+=t):t.forEach(function(c){n.beginNewLine(),c.forEach(function(f,y){0!==y&&(n.result+=n.columnSeparator),n.result+=n.putInQuotes(f.data.value||""),f.mergeAcross&&n.appendEmptyCells(f.mergeAcross)})}))},r.prototype.onNewHeaderGroupingRow=function(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}},r.prototype.onNewHeaderGroupingRowColumn=function(t,n,c){0!=n&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(t),this.appendEmptyCells(c)},r.prototype.appendEmptyCells=function(t){for(var n=1;n<=t;n++)this.result+=this.columnSeparator+this.putInQuotes("")},r.prototype.onNewHeaderRow=function(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}},r.prototype.onNewHeaderRowColumn=function(t,n){0!=n&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(t))},r.prototype.onNewBodyRow=function(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}},r.prototype.onNewBodyRowColumn=function(t,n,c){0!=n&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractRowCellValue(t,n,n,W.EXPORT_TYPE_CSV,c))},r.prototype.putInQuotes=function(t){return this.suppressQuotes?t:null==t?'""':("string"==typeof t?n=t:"function"==typeof t.toString?n=t.toString():(console.warn("unknown value type during csv conversion"),n=""),'"'+n.replace(/"/g,'""')+'"');var n},r.prototype.parse=function(){return this.result},r.prototype.beginNewLine=function(){this.isFirstLine||(this.result+="\r\n"),this.isFirstLine=!1},r}(hm),vm=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),wu=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f},xh=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return vm(r,h),r.prototype.postConstruct=function(){this.setBeans({gridSerializer:this.gridSerializer,gridOptionsWrapper:this.gridOptionsWrapper})},r.prototype.getDefaultExportParams=function(){return this.gridOptionsWrapper.getDefaultExportParams("csv")},r.prototype.export=function(t){if(this.isExportSuppressed())return console.warn("ag-grid: Export cancelled. Export is not allowed as per your configuration."),"";var n=this.getMergedParamsAndData(t),c=n.mergedParams,f=n.data,y=new Blob(["\ufeff",f],{type:window.navigator.msSaveOrOpenBlob?this.getMimeType():"octet/stream"});return pm.download(this.getFileName(c.fileName),y),f},r.prototype.exportDataAsCsv=function(t){return this.export(t)},r.prototype.getDataAsCsv=function(t){return this.getMergedParamsAndData(t).data},r.prototype.getMimeType=function(){return"text/csv;charset=utf-8;"},r.prototype.getDefaultFileName=function(){return"export.csv"},r.prototype.getDefaultFileExtension=function(){return"csv"},r.prototype.createSerializingSession=function(t){var n=this;return new O3({columnModel:n.columnModel,valueService:n.valueService,gridOptionsWrapper:n.gridOptionsWrapper,processCellCallback:t.processCellCallback||void 0,processHeaderCallback:t.processHeaderCallback||void 0,processGroupHeaderCallback:t.processGroupHeaderCallback||void 0,processRowGroupCallback:t.processRowGroupCallback||void 0,suppressQuotes:t.suppressQuotes||!1,columnSeparator:t.columnSeparator||","})},r.prototype.isExportSuppressed=function(){return this.gridOptionsWrapper.isSuppressCsvExport()},wu([Ee("columnModel")],r.prototype,"columnModel",void 0),wu([Ee("valueService")],r.prototype,"valueService",void 0),wu([Ee("gridSerializer")],r.prototype,"gridSerializer",void 0),wu([Ee("gridOptionsWrapper")],r.prototype,"gridOptionsWrapper",void 0),wu([zt],r.prototype,"postConstruct",null),wu([Kt("csvCreator")],r)}(Sh),gm=function(){var h=function(t,n){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(c,f){c.__proto__=f}||function(c,f){for(var y in f)f.hasOwnProperty(y)&&(c[y]=f[y])})(t,n)};return function(r,t){function n(){this.constructor=r}h(r,t),r.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),Gs=function(h,r,t,n){var y,c=arguments.length,f=c<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)f=Reflect.decorate(h,r,t,n);else for(var T=h.length-1;T>=0;T--)(y=h[T])&&(f=(c<3?y(f):c>3?y(r,t,f):y(r,t))||f);return c>3&&f&&Object.defineProperty(r,t,f),f};!function(h){h[h.HEADER_GROUPING=0]="HEADER_GROUPING",h[h.HEADER=1]="HEADER",h[h.BODY=2]="BODY"}(e.aCu||(e.aCu={}));var P3=function(h){function r(){return null!==h&&h.apply(this,arguments)||this}return gm(r,h),r.prototype.serialize=function(t,n){void 0===n&&(n={});var c=this.getColumnsToExport(n.allColumns,n.columnKeys);return wr.compose(this.prepareSession(c),this.prependContent(n),this.exportColumnGroups(n,c),this.exportHeaders(n,c),this.processPinnedTopRows(n,c),this.processRows(n,c),this.processPinnedBottomRows(n,c),this.appendContent(n))(t).parse()},r.prototype.processRow=function(t,n,c,f){var y=n.shouldRowBeSkipped||function(){return!1},T=this.gridOptionsWrapper,B=T.getContext(),q=T.getApi(),de=T.getColumnApi(),Se=T.isGroupRemoveSingleChildren(),ke=T.isGroupHideOpenParents(),je=T.isGroupRemoveLowestSingleChildren(),Qe=this.columnModel.isPivotMode()?f.leafGroup:!f.group,Vt=1===f.allChildrenCount&&(Se||je&&f.leafGroup);if((n.skipGroups||n.skipRowGroups)&&n.skipGroups&&wr.doOnce(function(){return console.warn("AG Grid: Since v25.2 `skipGroups` has been renamed to `skipRowGroups`.")},"gridSerializer-skipGroups"),!(!Qe&&(n.skipRowGroups||Vt||ke)||n.onlySelected&&!f.isSelected()||n.skipPinnedTop&&"top"===f.rowPinned||n.skipPinnedBottom&&"bottom"===f.rowPinned)&&(-1!==f.level||f.leafGroup)&&!y({node:f,api:q,context:B})){var qt=t.onNewBodyRow();if(c.forEach(function(on,Br){qt.onColumn(on,Br,f)}),n.getCustomContentBelowRow){var It=n.getCustomContentBelowRow({node:f,api:q,columnApi:de,context:B});It&&t.addCustomContent(It)}}},r.prototype.appendContent=function(t){return function(n){var c=t.customFooter||t.appendContent;return c&&(t.customFooter&&wr.doOnce(function(){return console.warn("AG Grid: Since version 25.2.0 the `customFooter` param has been deprecated. Use `appendContent` instead.")},"gridSerializer-customFooter"),n.addCustomContent(c)),n}},r.prototype.prependContent=function(t){return function(n){var c=t.customHeader||t.prependContent;return c&&(t.customHeader&&wr.doOnce(function(){return console.warn("AG Grid: Since version 25.2.0 the `customHeader` param has been deprecated. Use `prependContent` instead.")},"gridSerializer-customHeader"),n.addCustomContent(c)),n}},r.prototype.prepareSession=function(t){return function(n){return n.prepare(t),n}},r.prototype.exportColumnGroups=function(t,n){var c=this;return function(f){if(t.skipColumnGroupHeaders)t.columnGroups&&wr.doOnce(function(){return console.warn("AG Grid: Since v25.2 the `columnGroups` param has deprecated, and groups are exported by default.")},"gridSerializer-columnGroups");else{var y=new Wr,T=c.displayedGroupCreator.createDisplayedGroups(n,c.columnModel.getGridBalancedTree(),y,null);c.recursivelyAddHeaderGroups(T,f,t.processGroupHeaderCallback)}return f}},r.prototype.exportHeaders=function(t,n){return function(c){if(t.skipHeader||t.skipColumnHeaders)t.skipHeader&&wr.doOnce(function(){return console.warn("AG Grid: Since v25.2 the `skipHeader` param has been renamed to `skipColumnHeaders`.")},"gridSerializer-skipHeader");else{var f=c.onNewHeaderRow();n.forEach(function(y,T){f.onColumn(y,T,void 0)})}return c}},r.prototype.processPinnedTopRows=function(t,n){var c=this;return function(f){var y=c.processRow.bind(c,f,t,n);return c.pinnedRowModel.forEachPinnedTopRow(y),f}},r.prototype.processRows=function(t,n){var c=this;return function(f){var y=c.rowModel,T=y.getType(),B=T===W.ROW_MODEL_TYPE_CLIENT_SIDE,q=T===W.ROW_MODEL_TYPE_SERVER_SIDE,de=!B&&t.onlySelected,Se=c.processRow.bind(c,f,t,n);return c.columnModel.isPivotMode()?B?y.forEachPivotNode(Se):y.forEachNode(Se):t.onlySelectedAllPages||de?c.selectionService.getSelectedNodes().forEach(Se):B||q?y.forEachNodeAfterFilterAndSort(Se):y.forEachNode(Se),f}},r.prototype.processPinnedBottomRows=function(t,n){var c=this;return function(f){var y=c.processRow.bind(c,f,t,n);return c.pinnedRowModel.forEachPinnedBottomRow(y),f}},r.prototype.getColumnsToExport=function(t,n){void 0===t&&(t=!1);var c=this.columnModel.isPivotMode();return n&&n.length?this.columnModel.getGridColumns(n):t&&!c?(this.gridOptionsWrapper.isTreeData()?this.columnModel.getGridColumns([W.GROUP_AUTO_COLUMN_ID]):[]).concat(this.columnModel.getAllPrimaryColumns()||[]):this.columnModel.getAllDisplayedColumns()},r.prototype.recursivelyAddHeaderGroups=function(t,n,c){var f=[];t.forEach(function(y){!y.getChildren||y.getChildren().forEach(function(B){return f.push(B)})}),t.length>0&&t[0]instanceof xt&&this.doAddHeaderHeader(n,t,c),f&&f.length>0&&this.recursivelyAddHeaderGroups(f,n,c)},r.prototype.doAddHeaderHeader=function(t,n,c){var f=this,y=t.onNewHeaderGroupingRow(),T=0;n.forEach(function(B){var de,q=B;de=c?c({columnGroup:q,api:f.gridOptionsWrapper.getApi(),columnApi:f.gridOptionsWrapper.getColumnApi(),context:f.gridOptionsWrapper.getContext()}):f.columnModel.getDisplayNameForColumnGroup(q,"header"),y.onColumn(de||"",T++,q.getLeafColumns().length-1)})},Gs([Ee("displayedGroupCreator")],r.prototype,"displayedGroupCreator",void 0),Gs([Ee("columnModel")],r.prototype,"columnModel",void 0),Gs([Ee("rowModel")],r.prototype,"rowModel",void 0),Gs([Ee("pinnedRowModel")],r.prototype,"pinnedRowModel",void 0),Gs([Ee("selectionService")],r.prototype,"selectionService",void 0),Gs([Kt("gridSerializer")],r)}(ct),F3={moduleName:e.GXE.CsvExportModule,beans:[xh,P3]},dr=(function(){function h(){}h.createHeader=function(r){void 0===r&&(r={});var c=["version"];return r.version||(r.version="1.0"),r.encoding&&c.push("encoding"),r.standalone&&c.push("standalone"),"<?xml "+c.map(function(y){return y+'="'+r[y]+'"'}).join(" ")+" ?>"},h.createXml=function(r,t){var n=this,c="";r.properties&&(r.properties.prefixedAttributes&&r.properties.prefixedAttributes.forEach(function(y){Object.keys(y.map).forEach(function(T){c+=n.returnAttributeIfPopulated(y.prefix+T,y.map[T],t)})}),r.properties.rawMap&&Object.keys(r.properties.rawMap).forEach(function(y){c+=n.returnAttributeIfPopulated(y,r.properties.rawMap[y],t)}));var f="<"+r.name+c;return r.children||null!=r.textNode?null!=r.textNode?f+">"+r.textNode+"</"+r.name+">\r\n":(f+=">\r\n",r.children&&r.children.forEach(function(y){f+=n.createXml(y,t)}),f+"</"+r.name+">\r\n"):f+"/>\r\n"},h.returnAttributeIfPopulated=function(r,t,n){if(!t&&""!==t&&0!==t)return"";var c=t;return"boolean"==typeof t&&n&&(c=n(t))," "+r+'="'+c+'"'}}(),new Uint32Array([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117]));!function(){function h(){}h.addFolders=function(r){r.forEach(this.addFolder.bind(this))},h.addFolder=function(r){this.folders.push({path:r,created:new Date,isBase64:!1})},h.addFile=function(r,t,n){void 0===n&&(n=!1),this.files.push({path:r,created:new Date,content:t,isBase64:n})},h.getContent=function(r){void 0===r&&(r="application/zip");var t=this.buildFileStream(),n=this.buildUint8Array(t);return this.clearStream(),new Blob([n],{type:r})},h.clearStream=function(){this.folders=[],this.files=[]},h.buildFileStream=function(r){void 0===r&&(r="");for(var t=this.folders.concat(this.files),n=t.length,c="",f=0,y=0,T=0,B=t;T<B.length;T++){var de=this.getHeader(B[T],f),Se=de.fileHeader,ke=de.folderHeader,je=de.content;f+=Se.length+je.length,y+=ke.length,r+=Se+je,c+=ke}return r+c+this.buildFolderEnd(n,y,f)},h.getHeader=function(r,t){var n=r.content,c=r.path,f=r.created,y=r.isBase64,B=wr.decToHex,q=(0,wr.utf8_encode)(c),de=q!==c,Se=this.convertTime(f),ke=this.convertDate(f),je="";if(de){var Qe=B(1,1)+B(this.getFromCrc32Table(q),4)+q;je="up"+B(Qe.length,2)+Qe}var rt=n?this.getConvertedContent(n,y):{size:0,content:""},_t=rt.size,Vt=rt.content,Ut="\n\0"+(de?"\0\b":"\0\0")+"\0\0"+B(Se,2)+B(ke,2)+B(_t?this.getFromCrc32Table(Vt):0,4)+B(_t,4)+B(_t,4)+B(q.length,2)+B(je.length,2);return{fileHeader:"PK\x03\x04"+Ut+q+je,folderHeader:"PK\x01\x02\x14\0"+Ut+"\0\0\0\0\0\0"+(n?"\0\0\0\0":"\x10\0\0\0")+B(t,4)+q+je,content:Vt||""}},h.getConvertedContent=function(r,t){return void 0===t&&(t=!1),t&&(r=r.split(";base64,")[1]),{size:(r=t?atob(r):r).length,content:r}},h.buildFolderEnd=function(r,t,n){var c=wr.decToHex;return"PK\x05\x06\0\0\0\0"+c(r,2)+c(r,2)+c(t,4)+c(n,4)+"\0\0"},h.buildUint8Array=function(r){for(var t=new Uint8Array(r.length),n=0;n<t.length;n++)t[n]=r.charCodeAt(n);return t},h.getFromCrc32Table=function(r){if(!r.length)return 0;for(var t=r.length,n=new Uint8Array(t),c=0;c<t;c++)n[c]=r.charCodeAt(c);var f=-1;for(c=0;c<t;c++)f=f>>>8^dr[255&(f^n[c])];return-1^f},h.convertTime=function(r){var t=r.getHours();return t<<=6,t|=r.getMinutes(),(t<<=5)|r.getSeconds()/2},h.convertDate=function(r){var t=r.getFullYear()-1980;return t<<=4,t|=r.getMonth()+1,(t<<=5)|r.getDate()},h.folders=[],h.files=[]}();ne.register(m5,!1),ne.register(E3,!1),ne.register(F3,!1),e.j_S=Di,e.Nk3=im,e.plv=Wo,e.rjZ=us,e.vA3=L2},854:function(s){var e=function(a){"use strict";var g,d=Object.prototype,v=d.hasOwnProperty,C="function"==typeof Symbol?Symbol:{},w=C.iterator||"@@iterator",_=C.asyncIterator||"@@asyncIterator",x=C.toStringTag||"@@toStringTag";function b(fe,ge,$){return Object.defineProperty(fe,ge,{value:$,enumerable:!0,configurable:!0,writable:!0}),fe[ge]}try{b({},"")}catch(fe){b=function($,ue,Y){return $[ue]=Y}}function A(fe,ge,$,ue){var Z=Object.create((ge&&ge.prototype instanceof I?ge:I).prototype),se=new Q(ue||[]);return Z._invoke=function(fe,ge,$){var ue=R;return function(Z,se){if(ue===D)throw new Error("Generator is already running");if(ue===F){if("throw"===Z)throw se;return me()}for($.method=Z,$.arg=se;;){var ve=$.delegate;if(ve){var le=U(ve,$);if(le){if(le===L)continue;return le}}if("next"===$.method)$.sent=$._sent=$.arg;else if("throw"===$.method){if(ue===R)throw ue=F,$.arg;$.dispatchException($.arg)}else"return"===$.method&&$.abrupt("return",$.arg);ue=D;var _e=E(fe,ge,$);if("normal"===_e.type){if(ue=$.done?F:O,_e.arg===L)continue;return{value:_e.arg,done:$.done}}"throw"===_e.type&&(ue=F,$.method="throw",$.arg=_e.arg)}}}(fe,$,se),Z}function E(fe,ge,$){try{return{type:"normal",arg:fe.call(ge,$)}}catch(ue){return{type:"throw",arg:ue}}}a.wrap=A;var R="suspendedStart",O="suspendedYield",D="executing",F="completed",L={};function I(){}function V(){}function z(){}var H={};b(H,w,function(){return this});var X=Object.getPrototypeOf,re=X&&X(X(oe([])));re&&re!==d&&v.call(re,w)&&(H=re);var j=z.prototype=I.prototype=Object.create(H);function te(fe){["next","throw","return"].forEach(function(ge){b(fe,ge,function($){return this._invoke(ge,$)})})}function J(fe,ge){function $(Z,se,ve,le){var _e=E(fe[Z],fe,se);if("throw"!==_e.type){var ae=_e.arg,pe=ae.value;return pe&&"object"==typeof pe&&v.call(pe,"__await")?ge.resolve(pe.__await).then(function(he){$("next",he,ve,le)},function(he){$("throw",he,ve,le)}):ge.resolve(pe).then(function(he){ae.value=he,ve(ae)},function(he){return $("throw",he,ve,le)})}le(_e.arg)}var ue;this._invoke=function(Z,se){function ve(){return new ge(function(le,_e){$(Z,se,le,_e)})}return ue=ue?ue.then(ve,ve):ve()}}function U(fe,ge){var $=fe.iterator[ge.method];if($===g){if(ge.delegate=null,"throw"===ge.method){if(fe.iterator.return&&(ge.method="return",ge.arg=g,U(fe,ge),"throw"===ge.method))return L;ge.method="throw",ge.arg=new TypeError("The iterator does not provide a 'throw' method")}return L}var ue=E($,fe.iterator,ge.arg);if("throw"===ue.type)return ge.method="throw",ge.arg=ue.arg,ge.delegate=null,L;var Y=ue.arg;return Y?Y.done?(ge[fe.resultName]=Y.value,ge.next=fe.nextLoc,"return"!==ge.method&&(ge.method="next",ge.arg=g),ge.delegate=null,L):Y:(ge.method="throw",ge.arg=new TypeError("iterator result is not an object"),ge.delegate=null,L)}function K(fe){var ge={tryLoc:fe[0]};1 in fe&&(ge.catchLoc=fe[1]),2 in fe&&(ge.finallyLoc=fe[2],ge.afterLoc=fe[3]),this.tryEntries.push(ge)}function ee(fe){var ge=fe.completion||{};ge.type="normal",delete ge.arg,fe.completion=ge}function Q(fe){this.tryEntries=[{tryLoc:"root"}],fe.forEach(K,this),this.reset(!0)}function oe(fe){if(fe){var ge=fe[w];if(ge)return ge.call(fe);if("function"==typeof fe.next)return fe;if(!isNaN(fe.length)){var $=-1,ue=function Y(){for(;++$<fe.length;)if(v.call(fe,$))return Y.value=fe[$],Y.done=!1,Y;return Y.value=g,Y.done=!0,Y};return ue.next=ue}}return{next:me}}function me(){return{value:g,done:!0}}return V.prototype=z,b(j,"constructor",z),b(z,"constructor",V),V.displayName=b(z,x,"GeneratorFunction"),a.isGeneratorFunction=function(fe){var ge="function"==typeof fe&&fe.constructor;return!!ge&&(ge===V||"GeneratorFunction"===(ge.displayName||ge.name))},a.mark=function(fe){return Object.setPrototypeOf?Object.setPrototypeOf(fe,z):(fe.__proto__=z,b(fe,x,"GeneratorFunction")),fe.prototype=Object.create(j),fe},a.awrap=function(fe){return{__await:fe}},te(J.prototype),b(J.prototype,_,function(){return this}),a.AsyncIterator=J,a.async=function(fe,ge,$,ue,Y){void 0===Y&&(Y=Promise);var Z=new J(A(fe,ge,$,ue),Y);return a.isGeneratorFunction(ge)?Z:Z.next().then(function(se){return se.done?se.value:Z.next()})},te(j),b(j,x,"Generator"),b(j,w,function(){return this}),b(j,"toString",function(){return"[object Generator]"}),a.keys=function(fe){var ge=[];for(var $ in fe)ge.push($);return ge.reverse(),function ue(){for(;ge.length;){var Y=ge.pop();if(Y in fe)return ue.value=Y,ue.done=!1,ue}return ue.done=!0,ue}},a.values=oe,Q.prototype={constructor:Q,reset:function(ge){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(ee),!ge)for(var $ in this)"t"===$.charAt(0)&&v.call(this,$)&&!isNaN(+$.slice(1))&&(this[$]=g)},stop:function(){this.done=!0;var $=this.tryEntries[0].completion;if("throw"===$.type)throw $.arg;return this.rval},dispatchException:function(ge){if(this.done)throw ge;var $=this;function ue(_e,ae){return se.type="throw",se.arg=ge,$.next=_e,ae&&($.method="next",$.arg=g),!!ae}for(var Y=this.tryEntries.length-1;Y>=0;--Y){var Z=this.tryEntries[Y],se=Z.completion;if("root"===Z.tryLoc)return ue("end");if(Z.tryLoc<=this.prev){var ve=v.call(Z,"catchLoc"),le=v.call(Z,"finallyLoc");if(ve&&le){if(this.prev<Z.catchLoc)return ue(Z.catchLoc,!0);if(this.prev<Z.finallyLoc)return ue(Z.finallyLoc)}else if(ve){if(this.prev<Z.catchLoc)return ue(Z.catchLoc,!0)}else{if(!le)throw new Error("try statement without catch or finally");if(this.prev<Z.finallyLoc)return ue(Z.finallyLoc)}}}},abrupt:function(ge,$){for(var ue=this.tryEntries.length-1;ue>=0;--ue){var Y=this.tryEntries[ue];if(Y.tryLoc<=this.prev&&v.call(Y,"finallyLoc")&&this.prev<Y.finallyLoc){var Z=Y;break}}Z&&("break"===ge||"continue"===ge)&&Z.tryLoc<=$&&$<=Z.finallyLoc&&(Z=null);var se=Z?Z.completion:{};return se.type=ge,se.arg=$,Z?(this.method="next",this.next=Z.finallyLoc,L):this.complete(se)},complete:function(ge,$){if("throw"===ge.type)throw ge.arg;return"break"===ge.type||"continue"===ge.type?this.next=ge.arg:"return"===ge.type?(this.rval=this.arg=ge.arg,this.method="return",this.next="end"):"normal"===ge.type&&$&&(this.next=$),L},finish:function(ge){for(var $=this.tryEntries.length-1;$>=0;--$){var ue=this.tryEntries[$];if(ue.finallyLoc===ge)return this.complete(ue.completion,ue.afterLoc),ee(ue),L}},catch:function(ge){for(var $=this.tryEntries.length-1;$>=0;--$){var ue=this.tryEntries[$];if(ue.tryLoc===ge){var Y=ue.completion;if("throw"===Y.type){var Z=Y.arg;ee(ue)}return Z}}throw new Error("illegal catch attempt")},delegateYield:function(ge,$,ue){return this.delegate={iterator:oe(ge),resultName:$,nextLoc:ue},"next"===this.method&&(this.arg=g),L}},a}(s.exports);try{regeneratorRuntime=e}catch(a){"object"==typeof globalThis?globalThis.regeneratorRuntime=e:Function("r","regeneratorRuntime = r")(e)}},494:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Mig:function(){return AmbientLight},Xcj:function(){return AnimationMixer},ZzF:function(){return Box3},zf8:function(){return CircleGeometry},SUY:function(){return Clock},Ilk:function(){return Color},Ox3:function(){return DirectionalLight},ehD:function(){return DoubleSide},EPV:function(){return GLTFLoader},ZXM:function(){return Geometry},x12:function(){return Line},nls:function(){return LineBasicMaterial},Kj0:function(){return Mesh},vBJ:function(){return MeshBasicMaterial},zxs:function(){return OrbitControls},cPb:function(){return PerspectiveCamera},xsS:function(){return Scene},Pa4:function(){return Vector3},CP7:function(){return WebGLRenderer}}),console.warn("[ThreeFull]: I am glad to annonce since Three release his examples files under JSM folder, this repository should be avoided. The first goal of this repository was to provided an alternative solution during this migration. From now, please consider to use Three.module.js instead even if i maintain this repository for my personal usage. Thanks for all ! Itee..."),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(s){return"number"==typeof s&&isFinite(s)&&Math.floor(s)===s}),void 0===Math.sign&&(Math.sign=function(s){return s<0?-1:s>0?1:+s}),"name"in Function.prototype||Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(s){var e=arguments;if(null==s)throw new TypeError("Cannot convert undefined or null to object");for(var a=Object(s),d=1;d<arguments.length;d++){var v=e[d];if(null!=v)for(var g in v)Object.prototype.hasOwnProperty.call(v,g)&&(a[g]=v[g])}return a});var AnimationUtils={arraySlice:function(e,a,d){return AnimationUtils.isTypedArray(e)?new e.constructor(e.subarray(a,void 0!==d?d:e.length)):e.slice(a,d)},convertArray:function(e,a,d){return!e||!d&&e.constructor===a?e:"number"==typeof a.BYTES_PER_ELEMENT?new a(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var d=e.length,v=new Array(d),g=0;g!==d;++g)v[g]=g;return v.sort(function(C,w){return e[C]-e[w]}),v},sortedArray:function(e,a,d){for(var v=e.length,g=new e.constructor(v),C=0,w=0;w!==v;++C)for(var _=d[C]*a,x=0;x!==a;++x)g[w++]=e[_+x];return g},flattenJSON:function(e,a,d,v){for(var g=1,C=e[0];void 0!==C&&void 0===C[v];)C=e[g++];if(void 0!==C){var w=C[v];if(void 0!==w)if(Array.isArray(w))do{void 0!==(w=C[v])&&(a.push(C.time),d.push.apply(d,w)),C=e[g++]}while(void 0!==C);else if(void 0!==w.toArray)do{void 0!==(w=C[v])&&(a.push(C.time),w.toArray(d,d.length)),C=e[g++]}while(void 0!==C);else do{void 0!==(w=C[v])&&(a.push(C.time),d.push(w)),C=e[g++]}while(void 0!==C)}},subclip:function(e,a,d,v,g){g=g||30;var C=e.clone();C.name=a;for(var w=[],_=0;_<C.tracks.length;++_){for(var x=C.tracks[_],b=x.getValueSize(),A=[],E=[],R=0;R<x.times.length;++R){var O=x.times[R]*g;if(!(O<d||O>=v)){A.push(x.times[R]);for(var D=0;D<b;++D)E.push(x.values[R*b+D])}}0!==A.length&&(x.times=AnimationUtils.convertArray(A,x.times.constructor),x.values=AnimationUtils.convertArray(E,x.values.constructor),w.push(x))}C.tracks=w;var F=1/0;for(_=0;_<C.tracks.length;++_)F>C.tracks[_].times[0]&&(F=C.tracks[_].times[0]);for(_=0;_<C.tracks.length;++_)C.tracks[_].shift(-1*F);return C.resetDuration(),C}},REVISION="113",MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},CullFaceNone=0,CullFaceBack=1,CullFaceFront=2,CullFaceFrontBack=3,FrontFaceDirectionCW=0,FrontFaceDirectionCCW=1,BasicShadowMap=0,PCFShadowMap=1,PCFSoftShadowMap=2,VSMShadowMap=3,FrontSide=0,BackSide=1,DoubleSide=2,FlatShading=1,SmoothShading=2,NoColors=0,FaceColors=1,VertexColors=2,NoBlending=0,NormalBlending=1,AdditiveBlending=2,SubtractiveBlending=3,MultiplyBlending=4,CustomBlending=5,AddEquation=100,SubtractEquation=101,ReverseSubtractEquation=102,MinEquation=103,MaxEquation=104,ZeroFactor=200,OneFactor=201,SrcColorFactor=202,OneMinusSrcColorFactor=203,SrcAlphaFactor=204,OneMinusSrcAlphaFactor=205,DstAlphaFactor=206,OneMinusDstAlphaFactor=207,DstColorFactor=208,OneMinusDstColorFactor=209,SrcAlphaSaturateFactor=210,NeverDepth=0,AlwaysDepth=1,LessDepth=2,LessEqualDepth=3,EqualDepth=4,GreaterEqualDepth=5,GreaterDepth=6,NotEqualDepth=7,MultiplyOperation=0,MixOperation=1,AddOperation=2,NoToneMapping=0,LinearToneMapping=1,ReinhardToneMapping=2,Uncharted2ToneMapping=3,CineonToneMapping=4,ACESFilmicToneMapping=5,UVMapping=300,CubeReflectionMapping=301,CubeRefractionMapping=302,EquirectangularReflectionMapping=303,EquirectangularRefractionMapping=304,SphericalReflectionMapping=305,CubeUVReflectionMapping=306,CubeUVRefractionMapping=307,RepeatWrapping=1e3,ClampToEdgeWrapping=1001,MirroredRepeatWrapping=1002,NearestFilter=1003,NearestMipmapNearestFilter=1004,NearestMipMapNearestFilter=1004,NearestMipmapLinearFilter=1005,NearestMipMapLinearFilter=1005,LinearFilter=1006,LinearMipmapNearestFilter=1007,LinearMipMapNearestFilter=1007,LinearMipmapLinearFilter=1008,LinearMipMapLinearFilter=1008,UnsignedByteType=1009,ByteType=1010,ShortType=1011,UnsignedShortType=1012,IntType=1013,UnsignedIntType=1014,FloatType=1015,HalfFloatType=1016,UnsignedShort4444Type=1017,UnsignedShort5551Type=1018,UnsignedShort565Type=1019,UnsignedInt248Type=1020,AlphaFormat=1021,RGBFormat=1022,RGBAFormat=1023,LuminanceFormat=1024,LuminanceAlphaFormat=1025,RGBEFormat=RGBAFormat,DepthFormat=1026,DepthStencilFormat=1027,RedFormat=1028,RedIntegerFormat=1029,RGFormat=1030,RGIntegerFormat=1031,RGBIntegerFormat=1032,RGBAIntegerFormat=1033,RGB_S3TC_DXT1_Format=33776,RGBA_S3TC_DXT1_Format=33777,RGBA_S3TC_DXT3_Format=33778,RGBA_S3TC_DXT5_Format=33779,RGB_PVRTC_4BPPV1_Format=35840,RGB_PVRTC_2BPPV1_Format=35841,RGBA_PVRTC_4BPPV1_Format=35842,RGBA_PVRTC_2BPPV1_Format=35843,RGB_ETC1_Format=36196,RGBA_ASTC_4x4_Format=37808,RGBA_ASTC_5x4_Format=37809,RGBA_ASTC_5x5_Format=37810,RGBA_ASTC_6x5_Format=37811,RGBA_ASTC_6x6_Format=37812,RGBA_ASTC_8x5_Format=37813,RGBA_ASTC_8x6_Format=37814,RGBA_ASTC_8x8_Format=37815,RGBA_ASTC_10x5_Format=37816,RGBA_ASTC_10x6_Format=37817,RGBA_ASTC_10x8_Format=37818,RGBA_ASTC_10x10_Format=37819,RGBA_ASTC_12x10_Format=37820,RGBA_ASTC_12x12_Format=37821,LoopOnce=2200,LoopRepeat=2201,LoopPingPong=2202,InterpolateDiscrete=2300,InterpolateLinear=2301,InterpolateSmooth=2302,ZeroCurvatureEnding=2400,ZeroSlopeEnding=2401,WrapAroundEnding=2402,TrianglesDrawMode=0,TriangleStripDrawMode=1,TriangleFanDrawMode=2,LinearEncoding=3e3,sRGBEncoding=3001,GammaEncoding=3007,RGBEEncoding=3002,LogLuvEncoding=3003,RGBM7Encoding=3004,RGBM16Encoding=3005,RGBDEncoding=3006,BasicDepthPacking=3200,RGBADepthPacking=3201,TangentSpaceNormalMap=0,ObjectSpaceNormalMap=1,ZeroStencilOp=0,KeepStencilOp=7680,ReplaceStencilOp=7681,IncrementStencilOp=7682,DecrementStencilOp=7683,IncrementWrapStencilOp=34055,DecrementWrapStencilOp=34056,InvertStencilOp=5386,NeverStencilFunc=512,LessStencilFunc=513,EqualStencilFunc=514,LessEqualStencilFunc=515,GreaterStencilFunc=516,NotEqualStencilFunc=517,GreaterEqualStencilFunc=518,AlwaysStencilFunc=519,StaticDrawUsage=35044,DynamicDrawUsage=35048,StreamDrawUsage=35040,StaticReadUsage=35045,DynamicReadUsage=35049,StreamReadUsage=35041,StaticCopyUsage=35046,DynamicCopyUsage=35050,StreamCopyUsage=35042;function Interpolant(s,e,a,d){this.parameterPositions=s,this._cachedIndex=0,this.resultBuffer=void 0!==d?d:new e.constructor(a),this.sampleValues=e,this.valueSize=a}function CubicInterpolant(s,e,a,d){Interpolant.call(this,s,e,a,d),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function LinearInterpolant(s,e,a,d){Interpolant.call(this,s,e,a,d)}function DiscreteInterpolant(s,e,a,d){Interpolant.call(this,s,e,a,d)}function KeyframeTrack(s,e,a,d){if(void 0===s)throw new Error("KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("KeyframeTrack: no keyframes in track named "+s);this.name=s,this.times=AnimationUtils.convertArray(e,this.TimeBufferType),this.values=AnimationUtils.convertArray(a,this.ValueBufferType),this.setInterpolation(d||this.DefaultInterpolation)}function BooleanKeyframeTrack(s,e,a){KeyframeTrack.call(this,s,e,a)}function ColorKeyframeTrack(s,e,a,d){KeyframeTrack.call(this,s,e,a,d)}function NumberKeyframeTrack(s,e,a,d){KeyframeTrack.call(this,s,e,a,d)}Object.assign(Interpolant.prototype,{evaluate:function(e){var a=this.parameterPositions,d=this._cachedIndex,v=a[d],g=a[d-1];e:{t:{var C;r:{n:if(!(e<v)){for(var w=d+2;;){if(void 0===v){if(e<g)break n;return this._cachedIndex=d=a.length,this.afterEnd_(d-1,e,g)}if(d===w)break;if(g=v,e<(v=a[++d]))break t}C=a.length;break r}if(e>=g)break e;var _=a[1];for(e<_&&(d=2,g=_),w=d-2;;){if(void 0===g)return this._cachedIndex=0,this.beforeStart_(0,e,v);if(d===w)break;if(v=g,e>=(g=a[--d-1]))break t}C=d,d=0}for(;d<C;){var x=d+C>>>1;e<a[x]?C=x:d=x+1}if(v=a[d],void 0===(g=a[d-1]))return this._cachedIndex=0,this.beforeStart_(0,e,v);if(void 0===v)return this._cachedIndex=d=a.length,this.afterEnd_(d-1,g,e)}this._cachedIndex=d,this.intervalChanged_(d,g,v)}return this.interpolate_(d,g,e,v)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var a=this.resultBuffer,d=this.sampleValues,v=this.valueSize,g=e*v,C=0;C!==v;++C)a[C]=d[g+C];return a},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Interpolant.prototype,{beforeStart_:Interpolant.prototype.copySampleValue_,afterEnd_:Interpolant.prototype.copySampleValue_}),CubicInterpolant.prototype=Object.assign(Object.create(Interpolant.prototype),{constructor:CubicInterpolant,DefaultSettings_:{endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding},intervalChanged_:function(e,a,d){var v=this.parameterPositions,g=e-2,C=e+1,w=v[g],_=v[C];if(void 0===w)switch(this.getSettings_().endingStart){case ZeroSlopeEnding:g=e,w=2*a-d;break;case WrapAroundEnding:w=a+v[g=v.length-2]-v[g+1];break;default:g=e,w=d}if(void 0===_)switch(this.getSettings_().endingEnd){case ZeroSlopeEnding:C=e,_=2*d-a;break;case WrapAroundEnding:C=1,_=d+v[1]-v[0];break;default:C=e-1,_=a}var x=.5*(d-a),b=this.valueSize;this._weightPrev=x/(a-w),this._weightNext=x/(_-d),this._offsetPrev=g*b,this._offsetNext=C*b},interpolate_:function(e,a,d,v){for(var g=this.resultBuffer,C=this.sampleValues,w=this.valueSize,_=e*w,x=_-w,b=this._offsetPrev,A=this._offsetNext,E=this._weightPrev,R=this._weightNext,O=(d-a)/(v-a),D=O*O,F=D*O,L=-E*F+2*E*D-E*O,I=(1+E)*F+(-1.5-2*E)*D+(-.5+E)*O+1,V=(-1-R)*F+(1.5+R)*D+.5*O,z=R*F-R*D,H=0;H!==w;++H)g[H]=L*C[b+H]+I*C[x+H]+V*C[_+H]+z*C[A+H];return g}}),LinearInterpolant.prototype=Object.assign(Object.create(Interpolant.prototype),{constructor:LinearInterpolant,interpolate_:function(e,a,d,v){for(var g=this.resultBuffer,C=this.sampleValues,w=this.valueSize,_=e*w,x=_-w,b=(d-a)/(v-a),A=1-b,E=0;E!==w;++E)g[E]=C[x+E]*A+C[_+E]*b;return g}}),DiscreteInterpolant.prototype=Object.assign(Object.create(Interpolant.prototype),{constructor:DiscreteInterpolant,interpolate_:function(e){return this.copySampleValue_(e-1)}}),Object.assign(KeyframeTrack,{toJSON:function(e){var d,a=e.constructor;if(void 0!==a.toJSON)d=a.toJSON(e);else{d={name:e.name,times:AnimationUtils.convertArray(e.times,Array),values:AnimationUtils.convertArray(e.values,Array)};var v=e.getInterpolation();v!==e.DefaultInterpolation&&(d.interpolation=v)}return d.type=e.ValueTypeName,d}}),Object.assign(KeyframeTrack.prototype,{constructor:KeyframeTrack,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:InterpolateLinear,InterpolantFactoryMethodDiscrete:function(e){return new DiscreteInterpolant(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new LinearInterpolant(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new CubicInterpolant(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){var a;switch(e){case InterpolateDiscrete:a=this.InterpolantFactoryMethodDiscrete;break;case InterpolateLinear:a=this.InterpolantFactoryMethodLinear;break;case InterpolateSmooth:a=this.InterpolantFactoryMethodSmooth}if(void 0===a){var d="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(d);this.setInterpolation(this.DefaultInterpolation)}return console.warn("KeyframeTrack:",d),this}return this.createInterpolant=a,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return InterpolateDiscrete;case this.InterpolantFactoryMethodLinear:return InterpolateLinear;case this.InterpolantFactoryMethodSmooth:return InterpolateSmooth}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(0!==e)for(var a=this.times,d=0,v=a.length;d!==v;++d)a[d]+=e;return this},scale:function(e){if(1!==e)for(var a=this.times,d=0,v=a.length;d!==v;++d)a[d]*=e;return this},trim:function(e,a){for(var d=this.times,v=d.length,g=0,C=v-1;g!==v&&d[g]<e;)++g;for(;-1!==C&&d[C]>a;)--C;if(++C,0!==g||C!==v){g>=C&&(g=(C=Math.max(C,1))-1);var w=this.getValueSize();this.times=AnimationUtils.arraySlice(d,g,C),this.values=AnimationUtils.arraySlice(this.values,g*w,C*w)}return this},validate:function(){var e=!0,a=this.getValueSize();a-Math.floor(a)!=0&&(console.error("KeyframeTrack: Invalid value size in track.",this),e=!1);var d=this.times,v=this.values,g=d.length;0===g&&(console.error("KeyframeTrack: Track is empty.",this),e=!1);for(var C=null,w=0;w!==g;w++){var _=d[w];if("number"==typeof _&&isNaN(_)){console.error("KeyframeTrack: Time is not a valid number.",this,w,_),e=!1;break}if(null!==C&&C>_){console.error("KeyframeTrack: Out of order keys.",this,w,_,C),e=!1;break}C=_}if(void 0!==v&&AnimationUtils.isTypedArray(v)){w=0;for(var x=v.length;w!==x;++w){var b=v[w];if(isNaN(b)){console.error("KeyframeTrack: Value is not a valid number.",this,w,b),e=!1;break}}}return e},optimize:function(){for(var e=AnimationUtils.arraySlice(this.times),a=AnimationUtils.arraySlice(this.values),d=this.getValueSize(),v=this.getInterpolation()===InterpolateSmooth,g=1,C=e.length-1,w=1;w<C;++w){var _=!1,x=e[w];if(x!==e[w+1]&&(1!==w||x!==x[0]))if(v)_=!0;else for(var A=w*d,E=A-d,R=A+d,O=0;O!==d;++O){var D=a[A+O];if(D!==a[E+O]||D!==a[R+O]){_=!0;break}}if(_){if(w!==g){e[g]=e[w];var F=w*d,L=g*d;for(O=0;O!==d;++O)a[L+O]=a[F+O]}++g}}if(C>0){for(e[g]=e[C],F=C*d,L=g*d,O=0;O!==d;++O)a[L+O]=a[F+O];++g}return g!==e.length?(this.times=AnimationUtils.arraySlice(e,0,g),this.values=AnimationUtils.arraySlice(a,0,g*d)):(this.times=e,this.values=a),this},clone:function(){var e=AnimationUtils.arraySlice(this.times,0),a=AnimationUtils.arraySlice(this.values,0),v=new(0,this.constructor)(this.name,e,a);return v.createInterpolant=this.createInterpolant,v}}),BooleanKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:BooleanKeyframeTrack,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:InterpolateDiscrete,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),ColorKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:ColorKeyframeTrack,ValueTypeName:"color"}),NumberKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:NumberKeyframeTrack,ValueTypeName:"number"});for(var _lut=[],i=0;i<256;i++)_lut[i]=(i<16?"0":"")+i.toString(16);var MathUtils={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=4294967295*Math.random()|0,a=4294967295*Math.random()|0,d=4294967295*Math.random()|0,v=4294967295*Math.random()|0;return(_lut[255&e]+_lut[e>>8&255]+_lut[e>>16&255]+_lut[e>>24&255]+"-"+_lut[255&a]+_lut[a>>8&255]+"-"+_lut[a>>16&15|64]+_lut[a>>24&255]+"-"+_lut[63&d|128]+_lut[d>>8&255]+"-"+_lut[d>>16&255]+_lut[d>>24&255]+_lut[255&v]+_lut[v>>8&255]+_lut[v>>16&255]+_lut[v>>24&255]).toUpperCase()},clamp:function(e,a,d){return Math.max(a,Math.min(d,e))},euclideanModulo:function(e,a){return(e%a+a)%a},mapLinear:function(e,a,d,v,g){return v+(e-a)*(g-v)/(d-a)},lerp:function(e,a,d){return(1-d)*e+d*a},smoothstep:function(e,a,d){return e<=a?0:e>=d?1:(e=(e-a)/(d-a))*e*(3-2*e)},smootherstep:function(e,a,d){return e<=a?0:e>=d?1:(e=(e-a)/(d-a))*e*e*(e*(6*e-15)+10)},randInt:function(e,a){return e+Math.floor(Math.random()*(a-e+1))},randFloat:function(e,a){return e+Math.random()*(a-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*MathUtils.DEG2RAD},radToDeg:function(e){return e*MathUtils.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,a,d,v,g){var C=Math.cos,w=Math.sin,_=C(d/2),x=w(d/2),b=C((a+v)/2),A=w((a+v)/2),E=C((a-v)/2),R=w((a-v)/2),O=C((v-a)/2),D=w((v-a)/2);"XYX"===g?e.set(_*A,x*E,x*R,_*b):"YZY"===g?e.set(x*R,_*A,x*E,_*b):"ZXZ"===g?e.set(x*E,x*R,_*A,_*b):"XZX"===g?e.set(_*A,x*D,x*O,_*b):"YXY"===g?e.set(x*O,_*A,x*D,_*b):"ZYZ"===g?e.set(x*D,x*O,_*A,_*b):console.warn("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}};function Quaternion(s,e,a,d){this._x=s||0,this._y=e||0,this._z=a||0,this._w=void 0!==d?d:1}function QuaternionLinearInterpolant(s,e,a,d){Interpolant.call(this,s,e,a,d)}function QuaternionKeyframeTrack(s,e,a,d){KeyframeTrack.call(this,s,e,a,d)}function StringKeyframeTrack(s,e,a,d){KeyframeTrack.call(this,s,e,a,d)}function VectorKeyframeTrack(s,e,a,d){KeyframeTrack.call(this,s,e,a,d)}function AnimationClip(s,e,a){this.name=s,this.tracks=a,this.duration=void 0!==e?e:-1,this.uuid=MathUtils.generateUUID(),this.duration<0&&this.resetDuration()}function getTrackTypeForValueTypeName(s){switch(s.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return NumberKeyframeTrack;case"vector":case"vector2":case"vector3":case"vector4":return VectorKeyframeTrack;case"color":return ColorKeyframeTrack;case"quaternion":return QuaternionKeyframeTrack;case"bool":case"boolean":return BooleanKeyframeTrack;case"string":return StringKeyframeTrack}throw new Error("KeyframeTrack: Unsupported typeName: "+s)}function parseKeyframeTrack(s){if(void 0===s.type)throw new Error("KeyframeTrack: track type undefined, can not parse");var e=getTrackTypeForValueTypeName(s.type);if(void 0===s.times){var a=[],d=[];AnimationUtils.flattenJSON(s.keys,a,d,"value"),s.times=a,s.values=d}return void 0!==e.parse?e.parse(s):new e(s.name,s.times,s.values,s.interpolation)}Object.assign(Quaternion,{slerp:function(e,a,d,v){return d.copy(e).slerp(a,v)},slerpFlat:function(e,a,d,v,g,C,w){var _=d[v+0],x=d[v+1],b=d[v+2],A=d[v+3],E=g[C+0],R=g[C+1],O=g[C+2],D=g[C+3];if(A!==D||_!==E||x!==R||b!==O){var F=1-w,L=_*E+x*R+b*O+A*D,I=L>=0?1:-1,V=1-L*L;if(V>Number.EPSILON){var z=Math.sqrt(V),H=Math.atan2(z,L*I);F=Math.sin(F*H)/z,w=Math.sin(w*H)/z}var X=w*I;if(_=_*F+E*X,x=x*F+R*X,b=b*F+O*X,A=A*F+D*X,F===1-w){var re=1/Math.sqrt(_*_+x*x+b*b+A*A);_*=re,x*=re,b*=re,A*=re}}e[a]=_,e[a+1]=x,e[a+2]=b,e[a+3]=A}}),Object.defineProperties(Quaternion.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}}}),Object.assign(Quaternion.prototype,{isQuaternion:!0,set:function(e,a,d,v){return this._x=e,this._y=a,this._z=d,this._w=v,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this},setFromEuler:function(e,a){if(!e||!e.isEuler)throw new Error("Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var d=e._x,v=e._y,g=e._z,C=e.order,w=Math.cos,_=Math.sin,x=w(d/2),b=w(v/2),A=w(g/2),E=_(d/2),R=_(v/2),O=_(g/2);return"XYZ"===C?(this._x=E*b*A+x*R*O,this._y=x*R*A-E*b*O,this._z=x*b*O+E*R*A,this._w=x*b*A-E*R*O):"YXZ"===C?(this._x=E*b*A+x*R*O,this._y=x*R*A-E*b*O,this._z=x*b*O-E*R*A,this._w=x*b*A+E*R*O):"ZXY"===C?(this._x=E*b*A-x*R*O,this._y=x*R*A+E*b*O,this._z=x*b*O+E*R*A,this._w=x*b*A-E*R*O):"ZYX"===C?(this._x=E*b*A-x*R*O,this._y=x*R*A+E*b*O,this._z=x*b*O-E*R*A,this._w=x*b*A+E*R*O):"YZX"===C?(this._x=E*b*A+x*R*O,this._y=x*R*A+E*b*O,this._z=x*b*O-E*R*A,this._w=x*b*A-E*R*O):"XZY"===C&&(this._x=E*b*A-x*R*O,this._y=x*R*A-E*b*O,this._z=x*b*O+E*R*A,this._w=x*b*A+E*R*O),!1!==a&&this._onChangeCallback(),this},setFromAxisAngle:function(e,a){var d=a/2,v=Math.sin(d);return this._x=e.x*v,this._y=e.y*v,this._z=e.z*v,this._w=Math.cos(d),this._onChangeCallback(),this},setFromRotationMatrix:function(e){var R,a=e.elements,d=a[0],v=a[4],g=a[8],C=a[1],w=a[5],_=a[9],x=a[2],b=a[6],A=a[10],E=d+w+A;return E>0?(R=.5/Math.sqrt(E+1),this._w=.25/R,this._x=(b-_)*R,this._y=(g-x)*R,this._z=(C-v)*R):d>w&&d>A?(R=2*Math.sqrt(1+d-w-A),this._w=(b-_)/R,this._x=.25*R,this._y=(v+C)/R,this._z=(g+x)/R):w>A?(R=2*Math.sqrt(1+w-d-A),this._w=(g-x)/R,this._x=(v+C)/R,this._y=.25*R,this._z=(_+b)/R):(R=2*Math.sqrt(1+A-d-w),this._w=(C-v)/R,this._x=(g+x)/R,this._y=(_+b)/R,this._z=.25*R),this._onChangeCallback(),this},setFromUnitVectors:function(e,a){var v=e.dot(a)+1;return v<1e-6?(v=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=v):(this._x=0,this._y=-e.z,this._z=e.y,this._w=v)):(this._x=e.y*a.z-e.z*a.y,this._y=e.z*a.x-e.x*a.z,this._z=e.x*a.y-e.y*a.x,this._w=v),this.normalize()},angleTo:function(e){return 2*Math.acos(Math.abs(MathUtils.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,a){var d=this.angleTo(e);if(0===d)return this;var v=Math.min(1,a/d);return this.slerp(e,v),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(this._x=this._x*(e=1/e),this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this},multiply:function(e,a){return void 0!==a?(console.warn("Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,a)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,a){var d=e._x,v=e._y,g=e._z,C=e._w,w=a._x,_=a._y,x=a._z,b=a._w;return this._x=d*b+C*w+v*x-g*_,this._y=v*b+C*_+g*w-d*x,this._z=g*b+C*x+d*_-v*w,this._w=C*b-d*w-v*_-g*x,this._onChangeCallback(),this},slerp:function(e,a){if(0===a)return this;if(1===a)return this.copy(e);var d=this._x,v=this._y,g=this._z,C=this._w,w=C*e._w+d*e._x+v*e._y+g*e._z;if(w<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,w=-w):this.copy(e),w>=1)return this._w=C,this._x=d,this._y=v,this._z=g,this;var _=1-w*w;if(_<=Number.EPSILON){var x=1-a;return this._w=x*C+a*this._w,this._x=x*d+a*this._x,this._y=x*v+a*this._y,this._z=x*g+a*this._z,this.normalize(),this._onChangeCallback(),this}var b=Math.sqrt(_),A=Math.atan2(b,w),E=Math.sin((1-a)*A)/b,R=Math.sin(a*A)/b;return this._w=C*E+this._w*R,this._x=d*E+this._x*R,this._y=v*E+this._y*R,this._z=g*E+this._z*R,this._onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,a){return void 0===a&&(a=0),this._x=e[a],this._y=e[a+1],this._z=e[a+2],this._w=e[a+3],this._onChangeCallback(),this},toArray:function(e,a){return void 0===e&&(e=[]),void 0===a&&(a=0),e[a]=this._x,e[a+1]=this._y,e[a+2]=this._z,e[a+3]=this._w,e},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}}),QuaternionLinearInterpolant.prototype=Object.assign(Object.create(Interpolant.prototype),{constructor:QuaternionLinearInterpolant,interpolate_:function(e,a,d,v){for(var g=this.resultBuffer,C=this.sampleValues,w=this.valueSize,_=e*w,x=(d-a)/(v-a),b=_+w;_!==b;_+=4)Quaternion.slerpFlat(g,0,C,_-w,C,_,x);return g}}),QuaternionKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:QuaternionKeyframeTrack,ValueTypeName:"quaternion",DefaultInterpolation:InterpolateLinear,InterpolantFactoryMethodLinear:function(e){return new QuaternionLinearInterpolant(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),StringKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:StringKeyframeTrack,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:InterpolateDiscrete,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),VectorKeyframeTrack.prototype=Object.assign(Object.create(KeyframeTrack.prototype),{constructor:VectorKeyframeTrack,ValueTypeName:"vector"}),Object.assign(AnimationClip,{parse:function(e){for(var a=[],d=e.tracks,v=1/(e.fps||1),g=0,C=d.length;g!==C;++g)a.push(parseKeyframeTrack(d[g]).scale(v));return new AnimationClip(e.name,e.duration,a)},toJSON:function(e){for(var a=[],d=e.tracks,v={name:e.name,duration:e.duration,tracks:a,uuid:e.uuid},g=0,C=d.length;g!==C;++g)a.push(KeyframeTrack.toJSON(d[g]));return v},CreateFromMorphTargetSequence:function(e,a,d,v){for(var g=a.length,C=[],w=0;w<g;w++){var _=[],x=[];_.push((w+g-1)%g,w,(w+1)%g),x.push(0,1,0);var b=AnimationUtils.getKeyframeOrder(_);_=AnimationUtils.sortedArray(_,1,b),x=AnimationUtils.sortedArray(x,1,b),!v&&0===_[0]&&(_.push(g),x.push(x[0])),C.push(new NumberKeyframeTrack(".morphTargetInfluences["+a[w].name+"]",_,x).scale(1/d))}return new AnimationClip(e,-1,C)},findByName:function(e,a){var d=e;Array.isArray(e)||(d=e.geometry&&e.geometry.animations||e.animations);for(var g=0;g<d.length;g++)if(d[g].name===a)return d[g];return null},CreateClipsFromMorphTargetSequences:function(e,a,d){for(var v={},g=/^([\w-]*?)([\d]+)$/,C=0,w=e.length;C<w;C++){var _=e[C],x=_.name.match(g);if(x&&x.length>1){var A=v[b=x[1]];A||(v[b]=A=[]),A.push(_)}}var E=[];for(var b in v)E.push(AnimationClip.CreateFromMorphTargetSequence(b,v[b],a,d));return E},parseAnimation:function(e,a){if(!e)return console.error("AnimationClip: No animation in JSONLoader data."),null;for(var d=function(H,X,re,j,te){if(0!==re.length){var J=[],k=[];AnimationUtils.flattenJSON(re,J,k,j),0!==J.length&&te.push(new H(X,J,k))}},v=[],g=e.name||"default",C=e.length||-1,w=e.fps||30,_=e.hierarchy||[],x=0;x<_.length;x++){var b=_[x].keys;if(b&&0!==b.length)if(b[0].morphTargets){for(var A={},E=0;E<b.length;E++)if(b[E].morphTargets)for(var R=0;R<b[E].morphTargets.length;R++)A[b[E].morphTargets[R]]=-1;for(var O in A){var D=[],F=[];for(R=0;R!==b[E].morphTargets.length;++R){var L=b[E];D.push(L.time),F.push(L.morphTarget===O?1:0)}v.push(new NumberKeyframeTrack(".morphTargetInfluence["+O+"]",D,F))}C=A.length*(w||1)}else{var I=".bones["+a[x].name+"]";d(VectorKeyframeTrack,I+".position",b,"pos",v),d(QuaternionKeyframeTrack,I+".quaternion",b,"rot",v),d(VectorKeyframeTrack,I+".scale",b,"scl",v)}}return 0===v.length?null:new AnimationClip(g,C,v)}}),Object.assign(AnimationClip.prototype,{resetDuration:function(){for(var a=0,d=0,v=this.tracks.length;d!==v;++d){var g=this.tracks[d];a=Math.max(a,g.times[g.times.length-1])}return this.duration=a,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,a=0;a<this.tracks.length;a++)e=e&&this.tracks[a].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){for(var e=[],a=0;a<this.tracks.length;a++)e.push(this.tracks[a].clone());return new AnimationClip(this.name,this.duration,e)}});var _vector=new Vector3,_quaternion=new Quaternion;function Vector3(s,e,a){this.x=s||0,this.y=e||0,this.z=a||0}Object.assign(Vector3.prototype,{isVector3:!0,set:function(e,a,d){return this.x=e,this.y=a,this.z=d,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,a){switch(e){case 0:this.x=a;break;case 1:this.y=a;break;case 2:this.z=a;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,a){return void 0!==a?(console.warn("Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,a)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,a){return this.x=e.x+a.x,this.y=e.y+a.y,this.z=e.z+a.z,this},addScaledVector:function(e,a){return this.x+=e.x*a,this.y+=e.y*a,this.z+=e.z*a,this},sub:function(e,a){return void 0!==a?(console.warn("Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,a)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,a){return this.x=e.x-a.x,this.y=e.y-a.y,this.z=e.z-a.z,this},multiply:function(e,a){return void 0!==a?(console.warn("Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,a)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,a){return this.x=e.x*a.x,this.y=e.y*a.y,this.z=e.z*a.z,this},applyEuler:function(e){return e&&e.isEuler||console.error("Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(_quaternion.setFromEuler(e))},applyAxisAngle:function(e,a){return this.applyQuaternion(_quaternion.setFromAxisAngle(e,a))},applyMatrix3:function(e){var a=this.x,d=this.y,v=this.z,g=e.elements;return this.x=g[0]*a+g[3]*d+g[6]*v,this.y=g[1]*a+g[4]*d+g[7]*v,this.z=g[2]*a+g[5]*d+g[8]*v,this},applyNormalMatrix:function(e){return this.applyMatrix3(e).normalize()},applyMatrix4:function(e){var a=this.x,d=this.y,v=this.z,g=e.elements,C=1/(g[3]*a+g[7]*d+g[11]*v+g[15]);return this.x=(g[0]*a+g[4]*d+g[8]*v+g[12])*C,this.y=(g[1]*a+g[5]*d+g[9]*v+g[13])*C,this.z=(g[2]*a+g[6]*d+g[10]*v+g[14])*C,this},applyQuaternion:function(e){var a=this.x,d=this.y,v=this.z,g=e.x,C=e.y,w=e.z,_=e.w,x=_*a+C*v-w*d,b=_*d+w*a-g*v,A=_*v+g*d-C*a,E=-g*a-C*d-w*v;return this.x=x*_+E*-g+b*-w-A*-C,this.y=b*_+E*-C+A*-g-x*-w,this.z=A*_+E*-w+x*-C-b*-g,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){var a=this.x,d=this.y,v=this.z,g=e.elements;return this.x=g[0]*a+g[4]*d+g[8]*v,this.y=g[1]*a+g[5]*d+g[9]*v,this.z=g[2]*a+g[6]*d+g[10]*v,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,a){return this.x=Math.max(e.x,Math.min(a.x,this.x)),this.y=Math.max(e.y,Math.min(a.y,this.y)),this.z=Math.max(e.z,Math.min(a.z,this.z)),this},clampScalar:function(e,a){return this.x=Math.max(e,Math.min(a,this.x)),this.y=Math.max(e,Math.min(a,this.y)),this.z=Math.max(e,Math.min(a,this.z)),this},clampLength:function(e,a){var d=this.length();return this.divideScalar(d||1).multiplyScalar(Math.max(e,Math.min(a,d)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,a){return this.x+=(e.x-this.x)*a,this.y+=(e.y-this.y)*a,this.z+=(e.z-this.z)*a,this},lerpVectors:function(e,a,d){return this.subVectors(a,e).multiplyScalar(d).add(e)},cross:function(e,a){return void 0!==a?(console.warn("Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,a)):this.crossVectors(this,e)},crossVectors:function(e,a){var d=e.x,v=e.y,g=e.z,C=a.x,w=a.y,_=a.z;return this.x=v*_-g*w,this.y=g*C-d*_,this.z=d*w-v*C,this},projectOnVector:function(e){var a=e.lengthSq();if(0===a)return this.set(0,0,0);var d=e.dot(this)/a;return this.copy(e).multiplyScalar(d)},projectOnPlane:function(e){return _vector.copy(this).projectOnVector(e),this.sub(_vector)},reflect:function(e){return this.sub(_vector.copy(e).multiplyScalar(2*this.dot(e)))},angleTo:function(e){var a=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===a)return Math.PI/2;var d=this.dot(e)/a;return Math.acos(MathUtils.clamp(d,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var a=this.x-e.x,d=this.y-e.y,v=this.z-e.z;return a*a+d*d+v*v},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,a,d){var v=Math.sin(a)*e;return this.x=v*Math.sin(d),this.y=Math.cos(a)*e,this.z=v*Math.cos(d),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,a,d){return this.x=e*Math.sin(a),this.y=d,this.z=e*Math.cos(a),this},setFromMatrixPosition:function(e){var a=e.elements;return this.x=a[12],this.y=a[13],this.z=a[14],this},setFromMatrixScale:function(e){var a=this.setFromMatrixColumn(e,0).length(),d=this.setFromMatrixColumn(e,1).length(),v=this.setFromMatrixColumn(e,2).length();return this.x=a,this.y=d,this.z=v,this},setFromMatrixColumn:function(e,a){return this.fromArray(e.elements,4*a)},setFromMatrix3Column:function(e,a){return this.fromArray(e.elements,3*a)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,a){return void 0===a&&(a=0),this.x=e[a],this.y=e[a+1],this.z=e[a+2],this},toArray:function(e,a){return void 0===e&&(e=[]),void 0===a&&(a=0),e[a]=this.x,e[a+1]=this.y,e[a+2]=this.z,e},fromBufferAttribute:function(e,a,d){return void 0!==d&&console.warn("Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(a),this.y=e.getY(a),this.z=e.getZ(a),this}});var AnimationClipCreator=function(){};function Vector4(s,e,a,d){this.x=s||0,this.y=e||0,this.z=a||0,this.w=void 0!==d?d:1}function Vector2(s,e){this.x=s||0,this.y=e||0}AnimationClipCreator.CreateRotationAnimation=function(s,e){return new AnimationClip(null,s,[new NumberKeyframeTrack(".rotation["+(e=e||"x")+"]",[0,s],[0,360])])},AnimationClipCreator.CreateScaleAxisAnimation=function(s,e){return new AnimationClip(null,s,[new NumberKeyframeTrack(".scale["+(e=e||"x")+"]",[0,s],[0,1])])},AnimationClipCreator.CreateShakeAnimation=function(s,e){for(var a=[],d=[],v=new Vector3,g=0;g<10*s;g++)a.push(g/10),v.set(2*Math.random()-1,2*Math.random()-1,2*Math.random()-1).multiply(e).toArray(d,d.length);return new AnimationClip(null,s,[new VectorKeyframeTrack(".position",a,d)])},AnimationClipCreator.CreatePulsationAnimation=function(s,e){for(var a=[],d=[],v=new Vector3,g=0;g<10*s;g++){a.push(g/10);var C=Math.random()*e;v.set(C,C,C).toArray(d,d.length)}return new AnimationClip(null,s,[new VectorKeyframeTrack(".scale",a,d)])},AnimationClipCreator.CreateVisibilityAnimation=function(s){return new AnimationClip(null,s,[new BooleanKeyframeTrack(".visible",[0,s/2,s],[!0,!1,!0])])},AnimationClipCreator.CreateMaterialColorAnimation=function(s,e){for(var a=[],d=[],v=s/e.length,g=0;g<=e.length;g++)a.push(g*v),d.push(e[g%e.length]);return new AnimationClip(null,s,[new ColorKeyframeTrack(".material[0].color",a,d)])},Object.defineProperties(Vector4.prototype,{width:{get:function(){return this.z},set:function(e){this.z=e}},height:{get:function(){return this.w},set:function(e){this.w=e}}}),Object.assign(Vector4.prototype,{isVector4:!0,set:function(e,a,d,v){return this.x=e,this.y=a,this.z=d,this.w=v,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,a){switch(e){case 0:this.x=a;break;case 1:this.y=a;break;case 2:this.z=a;break;case 3:this.w=a;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,a){return void 0!==a?(console.warn("Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,a)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,a){return this.x=e.x+a.x,this.y=e.y+a.y,this.z=e.z+a.z,this.w=e.w+a.w,this},addScaledVector:function(e,a){return this.x+=e.x*a,this.y+=e.y*a,this.z+=e.z*a,this.w+=e.w*a,this},sub:function(e,a){return void 0!==a?(console.warn("Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,a)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,a){return this.x=e.x-a.x,this.y=e.y-a.y,this.z=e.z-a.z,this.w=e.w-a.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var a=this.x,d=this.y,v=this.z,g=this.w,C=e.elements;return this.x=C[0]*a+C[4]*d+C[8]*v+C[12]*g,this.y=C[1]*a+C[5]*d+C[9]*v+C[13]*g,this.z=C[2]*a+C[6]*d+C[10]*v+C[14]*g,this.w=C[3]*a+C[7]*d+C[11]*v+C[15]*g,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var a=Math.sqrt(1-e.w*e.w);return a<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/a,this.y=e.y/a,this.z=e.z/a),this},setAxisAngleFromRotationMatrix:function(e){var a,d,v,g,C=.01,w=.1,_=e.elements,x=_[0],b=_[4],A=_[8],E=_[1],R=_[5],O=_[9],D=_[2],F=_[6],L=_[10];if(Math.abs(b-E)<C&&Math.abs(A-D)<C&&Math.abs(O-F)<C){if(Math.abs(b+E)<w&&Math.abs(A+D)<w&&Math.abs(O+F)<w&&Math.abs(x+R+L-3)<w)return this.set(1,0,0,0),this;a=Math.PI;var I=(x+1)/2,V=(R+1)/2,z=(L+1)/2,H=(b+E)/4,X=(A+D)/4,re=(O+F)/4;return I>V&&I>z?I<C?(d=0,v=.707106781,g=.707106781):(v=H/(d=Math.sqrt(I)),g=X/d):V>z?V<C?(d=.707106781,v=0,g=.707106781):(d=H/(v=Math.sqrt(V)),g=re/v):z<C?(d=.707106781,v=.707106781,g=0):(d=X/(g=Math.sqrt(z)),v=re/g),this.set(d,v,g,a),this}var j=Math.sqrt((F-O)*(F-O)+(A-D)*(A-D)+(E-b)*(E-b));return Math.abs(j)<.001&&(j=1),this.x=(F-O)/j,this.y=(A-D)/j,this.z=(E-b)/j,this.w=Math.acos((x+R+L-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,a){return this.x=Math.max(e.x,Math.min(a.x,this.x)),this.y=Math.max(e.y,Math.min(a.y,this.y)),this.z=Math.max(e.z,Math.min(a.z,this.z)),this.w=Math.max(e.w,Math.min(a.w,this.w)),this},clampScalar:function(e,a){return this.x=Math.max(e,Math.min(a,this.x)),this.y=Math.max(e,Math.min(a,this.y)),this.z=Math.max(e,Math.min(a,this.z)),this.w=Math.max(e,Math.min(a,this.w)),this},clampLength:function(e,a){var d=this.length();return this.divideScalar(d||1).multiplyScalar(Math.max(e,Math.min(a,d)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,a){return this.x+=(e.x-this.x)*a,this.y+=(e.y-this.y)*a,this.z+=(e.z-this.z)*a,this.w+=(e.w-this.w)*a,this},lerpVectors:function(e,a,d){return this.subVectors(a,e).multiplyScalar(d).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,a){return void 0===a&&(a=0),this.x=e[a],this.y=e[a+1],this.z=e[a+2],this.w=e[a+3],this},toArray:function(e,a){return void 0===e&&(e=[]),void 0===a&&(a=0),e[a]=this.x,e[a+1]=this.y,e[a+2]=this.z,e[a+3]=this.w,e},fromBufferAttribute:function(e,a,d){return void 0!==d&&console.warn("Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(a),this.y=e.getY(a),this.z=e.getZ(a),this.w=e.getW(a),this}}),Object.defineProperties(Vector2.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(Vector2.prototype,{isVector2:!0,set:function(e,a){return this.x=e,this.y=a,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,a){switch(e){case 0:this.x=a;break;case 1:this.y=a;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,a){return void 0!==a?(console.warn("Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,a)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,a){return this.x=e.x+a.x,this.y=e.y+a.y,this},addScaledVector:function(e,a){return this.x+=e.x*a,this.y+=e.y*a,this},sub:function(e,a){return void 0!==a?(console.warn("Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,a)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,a){return this.x=e.x-a.x,this.y=e.y-a.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var a=this.x,d=this.y,v=e.elements;return this.x=v[0]*a+v[3]*d+v[6],this.y=v[1]*a+v[4]*d+v[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,a){return this.x=Math.max(e.x,Math.min(a.x,this.x)),this.y=Math.max(e.y,Math.min(a.y,this.y)),this},clampScalar:function(e,a){return this.x=Math.max(e,Math.min(a,this.x)),this.y=Math.max(e,Math.min(a,this.y)),this},clampLength:function(e,a){var d=this.length();return this.divideScalar(d||1).multiplyScalar(Math.max(e,Math.min(a,d)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var a=this.x-e.x,d=this.y-e.y;return a*a+d*d},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,a){return this.x+=(e.x-this.x)*a,this.y+=(e.y-this.y)*a,this},lerpVectors:function(e,a,d){return this.subVectors(a,e).multiplyScalar(d).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,a){return void 0===a&&(a=0),this.x=e[a],this.y=e[a+1],this},toArray:function(e,a){return void 0===e&&(e=[]),void 0===a&&(a=0),e[a]=this.x,e[a+1]=this.y,e},fromBufferAttribute:function(e,a,d){return void 0!==d&&console.warn("Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(a),this.y=e.getY(a),this},rotateAround:function(e,a){var d=Math.cos(a),v=Math.sin(a),g=this.x-e.x,C=this.y-e.y;return this.x=g*d-C*v+e.x,this.y=g*v+C*d+e.y,this}});var _colorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},_hslA={h:0,s:0,l:0},_hslB={h:0,s:0,l:0};function Color(s,e,a){return void 0===e&&void 0===a?this.set(s):this.setRGB(s,e,a)}function hue2rgb(s,e,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?s+6*(e-s)*a:a<.5?e:a<2/3?s+6*(e-s)*(2/3-a):s}function SRGBToLinear(s){return s<.04045?.0773993808*s:Math.pow(.9478672986*s+.0521327014,2.4)}function LinearToSRGB(s){return s<.0031308?12.92*s:1.055*Math.pow(s,.41666)-.055}Object.assign(Color.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,a,d){return this.r=e,this.g=a,this.b=d,this},setHSL:function(e,a,d){if(e=MathUtils.euclideanModulo(e,1),a=MathUtils.clamp(a,0,1),d=MathUtils.clamp(d,0,1),0===a)this.r=this.g=this.b=d;else{var v=d<=.5?d*(1+a):d+a-d*a,g=2*d-v;this.r=hue2rgb(g,v,e+1/3),this.g=hue2rgb(g,v,e),this.b=hue2rgb(g,v,e-1/3)}return this},setStyle:function(e){function a(E){void 0!==E&&parseFloat(E)<1&&console.warn("Color: Alpha component of "+e+" will be ignored.")}var d;if(d=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var v,C=d[2];switch(d[1]){case"rgb":case"rgba":if(v=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(C))return this.r=Math.min(255,parseInt(v[1],10))/255,this.g=Math.min(255,parseInt(v[2],10))/255,this.b=Math.min(255,parseInt(v[3],10))/255,a(v[5]),this;if(v=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(C))return this.r=Math.min(100,parseInt(v[1],10))/100,this.g=Math.min(100,parseInt(v[2],10))/100,this.b=Math.min(100,parseInt(v[3],10))/100,a(v[5]),this;break;case"hsl":case"hsla":if(v=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(C)){var w=parseFloat(v[1])/360,_=parseInt(v[2],10)/100,x=parseInt(v[3],10)/100;return a(v[5]),this.setHSL(w,_,x)}}}else if(d=/^\#([A-Fa-f0-9]+)$/.exec(e)){var b=d[1],A=b.length;if(3===A)return this.r=parseInt(b.charAt(0)+b.charAt(0),16)/255,this.g=parseInt(b.charAt(1)+b.charAt(1),16)/255,this.b=parseInt(b.charAt(2)+b.charAt(2),16)/255,this;if(6===A)return this.r=parseInt(b.charAt(0)+b.charAt(1),16)/255,this.g=parseInt(b.charAt(2)+b.charAt(3),16)/255,this.b=parseInt(b.charAt(4)+b.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this},setColorName:function(e){var a=_colorKeywords[e];return void 0!==a?this.setHex(a):console.warn("Color: Unknown color "+e),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,a){return void 0===a&&(a=2),this.r=Math.pow(e.r,a),this.g=Math.pow(e.g,a),this.b=Math.pow(e.b,a),this},copyLinearToGamma:function(e,a){void 0===a&&(a=2);var d=a>0?1/a:1;return this.r=Math.pow(e.r,d),this.g=Math.pow(e.g,d),this.b=Math.pow(e.b,d),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(e){return this.r=SRGBToLinear(e.r),this.g=SRGBToLinear(e.g),this.b=SRGBToLinear(e.b),this},copyLinearToSRGB:function(e){return this.r=LinearToSRGB(e.r),this.g=LinearToSRGB(e.g),this.b=LinearToSRGB(e.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){void 0===e&&(console.warn("Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var w,_,a=this.r,d=this.g,v=this.b,g=Math.max(a,d,v),C=Math.min(a,d,v),x=(C+g)/2;if(C===g)w=0,_=0;else{var b=g-C;switch(_=x<=.5?b/(g+C):b/(2-g-C),g){case a:w=(d-v)/b+(d<v?6:0);break;case d:w=(v-a)/b+2;break;case v:w=(a-d)/b+4}w/=6}return e.h=w,e.s=_,e.l=x,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,a,d){return this.getHSL(_hslA),_hslA.h+=e,_hslA.s+=a,_hslA.l+=d,this.setHSL(_hslA.h,_hslA.s,_hslA.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,a){return this.r=e.r+a.r,this.g=e.g+a.g,this.b=e.b+a.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,a){return this.r+=(e.r-this.r)*a,this.g+=(e.g-this.g)*a,this.b+=(e.b-this.b)*a,this},lerpHSL:function(e,a){this.getHSL(_hslA),e.getHSL(_hslB);var d=MathUtils.lerp(_hslA.h,_hslB.h,a),v=MathUtils.lerp(_hslA.s,_hslB.s,a),g=MathUtils.lerp(_hslA.l,_hslB.l,a);return this.setHSL(d,v,g),this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,a){return void 0===a&&(a=0),this.r=e[a],this.g=e[a+1],this.b=e[a+2],this},toArray:function(e,a){return void 0===e&&(e=[]),void 0===a&&(a=0),e[a]=this.r,e[a+1]=this.g,e[a+2]=this.b,e},toJSON:function(){return this.getHex()}}),Color.NAMES=_colorKeywords;var _vector$1=new Vector3;function BufferAttribute(s,e,a){if(Array.isArray(s))throw new TypeError("BufferAttribute: array should be a Typed Array.");this.name="",this.array=s,this.itemSize=e,this.count=void 0!==s?s.length/e:0,this.normalized=!0===a,this.usage=StaticDrawUsage,this.updateRange={offset:0,count:-1},this.version=0}function Int8BufferAttribute(s,e,a){BufferAttribute.call(this,new Int8Array(s),e,a)}function Uint8BufferAttribute(s,e,a){BufferAttribute.call(this,new Uint8Array(s),e,a)}function Uint8ClampedBufferAttribute(s,e,a){BufferAttribute.call(this,new Uint8ClampedArray(s),e,a)}function Int16BufferAttribute(s,e,a){BufferAttribute.call(this,new Int16Array(s),e,a)}function Uint16BufferAttribute(s,e,a){BufferAttribute.call(this,new Uint16Array(s),e,a)}function Int32BufferAttribute(s,e,a){BufferAttribute.call(this,new Int32Array(s),e,a)}function Uint32BufferAttribute(s,e,a){BufferAttribute.call(this,new Uint32Array(s),e,a)}function Float32BufferAttribute(s,e,a){BufferAttribute.call(this,new Float32Array(s),e,a)}function Float64BufferAttribute(s,e,a){BufferAttribute.call(this,new Float64Array(s),e,a)}Object.defineProperty(BufferAttribute.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(BufferAttribute.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,a,d){e*=this.itemSize,d*=a.itemSize;for(var v=0,g=this.itemSize;v<g;v++)this.array[e+v]=a.array[d+v];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var a=this.array,d=0,v=0,g=e.length;v<g;v++){var C=e[v];void 0===C&&(console.warn("BufferAttribute.copyColorsArray(): color is undefined",v),C=new Color),a[d++]=C.r,a[d++]=C.g,a[d++]=C.b}return this},copyVector2sArray:function(e){for(var a=this.array,d=0,v=0,g=e.length;v<g;v++){var C=e[v];void 0===C&&(console.warn("BufferAttribute.copyVector2sArray(): vector is undefined",v),C=new Vector2),a[d++]=C.x,a[d++]=C.y}return this},copyVector3sArray:function(e){for(var a=this.array,d=0,v=0,g=e.length;v<g;v++){var C=e[v];void 0===C&&(console.warn("BufferAttribute.copyVector3sArray(): vector is undefined",v),C=new Vector3),a[d++]=C.x,a[d++]=C.y,a[d++]=C.z}return this},copyVector4sArray:function(e){for(var a=this.array,d=0,v=0,g=e.length;v<g;v++){var C=e[v];void 0===C&&(console.warn("BufferAttribute.copyVector4sArray(): vector is undefined",v),C=new Vector4),a[d++]=C.x,a[d++]=C.y,a[d++]=C.z,a[d++]=C.w}return this},applyMatrix3:function(e){for(var a=0,d=this.count;a<d;a++)_vector$1.x=this.getX(a),_vector$1.y=this.getY(a),_vector$1.z=this.getZ(a),_vector$1.applyMatrix3(e),this.setXYZ(a,_vector$1.x,_vector$1.y,_vector$1.z);return this},applyMatrix4:function(e){for(var a=0,d=this.count;a<d;a++)_vector$1.x=this.getX(a),_vector$1.y=this.getY(a),_vector$1.z=this.getZ(a),_vector$1.applyMatrix4(e),this.setXYZ(a,_vector$1.x,_vector$1.y,_vector$1.z);return this},applyNormalMatrix:function(e){for(var a=0,d=this.count;a<d;a++)_vector$1.x=this.getX(a),_vector$1.y=this.getY(a),_vector$1.z=this.getZ(a),_vector$1.applyNormalMatrix(e),this.setXYZ(a,_vector$1.x,_vector$1.y,_vector$1.z);return this},transformDirection:function(e){for(var a=0,d=this.count;a<d;a++)_vector$1.x=this.getX(a),_vector$1.y=this.getY(a),_vector$1.z=this.getZ(a),_vector$1.transformDirection(e),this.setXYZ(a,_vector$1.x,_vector$1.y,_vector$1.z);return this},set:function(e,a){return void 0===a&&(a=0),this.array.set(e,a),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,a){return this.array[e*this.itemSize]=a,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,a){return this.array[e*this.itemSize+1]=a,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,a){return this.array[e*this.itemSize+2]=a,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,a){return this.array[e*this.itemSize+3]=a,this},setXY:function(e,a,d){return this.array[0+(e*=this.itemSize)]=a,this.array[e+1]=d,this},setXYZ:function(e,a,d,v){return this.array[0+(e*=this.itemSize)]=a,this.array[e+1]=d,this.array[e+2]=v,this},setXYZW:function(e,a,d,v,g){return this.array[0+(e*=this.itemSize)]=a,this.array[e+1]=d,this.array[e+2]=v,this.array[e+3]=g,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),Int8BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Int8BufferAttribute.prototype.constructor=Int8BufferAttribute,Uint8BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Uint8BufferAttribute.prototype.constructor=Uint8BufferAttribute,Uint8ClampedBufferAttribute.prototype=Object.create(BufferAttribute.prototype),Uint8ClampedBufferAttribute.prototype.constructor=Uint8ClampedBufferAttribute,Int16BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Int16BufferAttribute.prototype.constructor=Int16BufferAttribute,Uint16BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Uint16BufferAttribute.prototype.constructor=Uint16BufferAttribute,Int32BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Int32BufferAttribute.prototype.constructor=Int32BufferAttribute,Uint32BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Uint32BufferAttribute.prototype.constructor=Uint32BufferAttribute,Float32BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Float32BufferAttribute.prototype.constructor=Float32BufferAttribute,Float64BufferAttribute.prototype=Object.create(BufferAttribute.prototype),Float64BufferAttribute.prototype.constructor=Float64BufferAttribute;var _points=[new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3,new Vector3],_vector$2=new Vector3,_box=new Box3,_v0=new Vector3,_v1=new Vector3,_v2=new Vector3,_f0=new Vector3,_f1=new Vector3,_f2=new Vector3,_center=new Vector3,_extents=new Vector3,_triangleNormal=new Vector3,_testAxis=new Vector3;function Box3(s,e){this.min=void 0!==s?s:new Vector3(1/0,1/0,1/0),this.max=void 0!==e?e:new Vector3(-1/0,-1/0,-1/0)}function satForAxes(s,e,a,d,v){var g,C;for(g=0,C=s.length-3;g<=C;g+=3){_testAxis.fromArray(s,g);var w=v.x*Math.abs(_testAxis.x)+v.y*Math.abs(_testAxis.y)+v.z*Math.abs(_testAxis.z),_=e.dot(_testAxis),x=a.dot(_testAxis),b=d.dot(_testAxis);if(Math.max(-Math.max(_,x,b),Math.min(_,x,b))>w)return!1}return!0}function EventDispatcher(){}Object.assign(Box3.prototype,{isBox3:!0,set:function(e,a){return this.min.copy(e),this.max.copy(a),this},setFromArray:function(e){for(var a=1/0,d=1/0,v=1/0,g=-1/0,C=-1/0,w=-1/0,_=0,x=e.length;_<x;_+=3){var b=e[_],A=e[_+1],E=e[_+2];b<a&&(a=b),A<d&&(d=A),E<v&&(v=E),b>g&&(g=b),A>C&&(C=A),E>w&&(w=E)}return this.min.set(a,d,v),this.max.set(g,C,w),this},setFromBufferAttribute:function(e){for(var a=1/0,d=1/0,v=1/0,g=-1/0,C=-1/0,w=-1/0,_=0,x=e.count;_<x;_++){var b=e.getX(_),A=e.getY(_),E=e.getZ(_);b<a&&(a=b),A<d&&(d=A),E<v&&(v=E),b>g&&(g=b),A>C&&(C=A),E>w&&(w=E)}return this.min.set(a,d,v),this.max.set(g,C,w),this},setFromPoints:function(e){this.makeEmpty();for(var a=0,d=e.length;a<d;a++)this.expandByPoint(e[a]);return this},setFromCenterAndSize:function(e,a){var d=_vector$2.copy(a).multiplyScalar(.5);return this.min.copy(e).sub(d),this.max.copy(e).add(d),this},setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return void 0===e&&(console.warn("Box3: .getCenter() target is now required"),e=new Vector3),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("Box3: .getSize() target is now required"),e=new Vector3),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(e){e.updateWorldMatrix(!1,!1);var a=e.geometry;void 0!==a&&(null===a.boundingBox&&a.computeBoundingBox(),_box.copy(a.boundingBox),_box.applyMatrix4(e.matrixWorld),this.expandByPoint(_box.min),this.expandByPoint(_box.max));for(var d=e.children,v=0,g=d.length;v<g;v++)this.expandByObject(d[v]);return this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,a){return void 0===a&&(console.warn("Box3: .getParameter() target is now required"),a=new Vector3),a.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(e){return this.clampPoint(e.center,_vector$2),_vector$2.distanceToSquared(e.center)<=e.radius*e.radius},intersectsPlane:function(e){var a,d;return e.normal.x>0?(a=e.normal.x*this.min.x,d=e.normal.x*this.max.x):(a=e.normal.x*this.max.x,d=e.normal.x*this.min.x),e.normal.y>0?(a+=e.normal.y*this.min.y,d+=e.normal.y*this.max.y):(a+=e.normal.y*this.max.y,d+=e.normal.y*this.min.y),e.normal.z>0?(a+=e.normal.z*this.min.z,d+=e.normal.z*this.max.z):(a+=e.normal.z*this.max.z,d+=e.normal.z*this.min.z),a<=-e.constant&&d>=-e.constant},intersectsTriangle:function(e){if(this.isEmpty())return!1;this.getCenter(_center),_extents.subVectors(this.max,_center),_v0.subVectors(e.a,_center),_v1.subVectors(e.b,_center),_v2.subVectors(e.c,_center),_f0.subVectors(_v1,_v0),_f1.subVectors(_v2,_v1),_f2.subVectors(_v0,_v2);var a=[0,-_f0.z,_f0.y,0,-_f1.z,_f1.y,0,-_f2.z,_f2.y,_f0.z,0,-_f0.x,_f1.z,0,-_f1.x,_f2.z,0,-_f2.x,-_f0.y,_f0.x,0,-_f1.y,_f1.x,0,-_f2.y,_f2.x,0];return!(!satForAxes(a,_v0,_v1,_v2,_extents)||(a=[1,0,0,0,1,0,0,0,1],!satForAxes(a,_v0,_v1,_v2,_extents)))&&(_triangleNormal.crossVectors(_f0,_f1),satForAxes(a=[_triangleNormal.x,_triangleNormal.y,_triangleNormal.z],_v0,_v1,_v2,_extents))},clampPoint:function(e,a){return void 0===a&&(console.warn("Box3: .clampPoint() target is now required"),a=new Vector3),a.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return _vector$2.copy(e).clamp(this.min,this.max).sub(e).length()},getBoundingSphere:function(e){return void 0===e&&console.error("Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(_vector$2).length(),e},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(e){return this.isEmpty()||(_points[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),_points[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),_points[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),_points[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),_points[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),_points[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),_points[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),_points[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(_points)),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}),Object.assign(EventDispatcher.prototype,{addEventListener:function(e,a){void 0===this._listeners&&(this._listeners={});var d=this._listeners;void 0===d[e]&&(d[e]=[]),-1===d[e].indexOf(a)&&d[e].push(a)},hasEventListener:function(e,a){if(void 0===this._listeners)return!1;var d=this._listeners;return void 0!==d[e]&&-1!==d[e].indexOf(a)},removeEventListener:function(e,a){if(void 0!==this._listeners){var v=this._listeners[e];if(void 0!==v){var g=v.indexOf(a);-1!==g&&v.splice(g,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var d=this._listeners[e.type];if(void 0!==d){e.target=this;for(var v=d.slice(0),g=0,C=v.length;g<C;g++)v[g].call(this,e)}}}});var _box$1=new Box3;function Sphere(s,e){this.center=void 0!==s?s:new Vector3,this.radius=void 0!==e?e:0}function DirectGeometry(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}Object.assign(Sphere.prototype,{set:function(e,a){return this.center.copy(e),this.radius=a,this},setFromPoints:function(e,a){var d=this.center;void 0!==a?d.copy(a):_box$1.setFromPoints(e).getCenter(d);for(var v=0,g=0,C=e.length;g<C;g++)v=Math.max(v,d.distanceToSquared(e[g]));return this.radius=Math.sqrt(v),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var a=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=a*a},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,a){var d=this.center.distanceToSquared(e);return void 0===a&&(console.warn("Sphere: .clampPoint() target is now required"),a=new Vector3),a.copy(e),d>this.radius*this.radius&&(a.sub(this.center).normalize(),a.multiplyScalar(this.radius).add(this.center)),a},getBoundingBox:function(e){return void 0===e&&(console.warn("Sphere: .getBoundingBox() target is now required"),e=new Box3),e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}}),Object.assign(DirectGeometry.prototype,{computeGroups:function(e){for(var a,d=[],v=void 0,g=e.faces,C=0;C<g.length;C++){var w=g[C];w.materialIndex!==v&&(v=w.materialIndex,void 0!==a&&(a.count=3*C-a.start,d.push(a)),a={start:3*C,materialIndex:v})}void 0!==a&&(a.count=3*C-a.start,d.push(a)),this.groups=d},fromGeometry:function(e){var x,a=e.faces,d=e.vertices,v=e.faceVertexUvs,g=v[0]&&v[0].length>0,C=v[1]&&v[1].length>0,w=e.morphTargets,_=w.length;if(_>0){x=[];for(var b=0;b<_;b++)x[b]={name:w[b].name,data:[]};this.morphTargets.position=x}var R,A=e.morphNormals,E=A.length;if(E>0){for(R=[],b=0;b<E;b++)R[b]={name:A[b].name,data:[]};this.morphTargets.normal=R}var O=e.skinIndices,D=e.skinWeights,F=O.length===d.length,L=D.length===d.length;for(d.length>0&&0===a.length&&console.error("DirectGeometry: Faceless geometries are not supported."),b=0;b<a.length;b++){var I=a[b];this.vertices.push(d[I.a],d[I.b],d[I.c]);var V=I.vertexNormals;if(3===V.length)this.normals.push(V[0],V[1],V[2]);else{var z=I.normal;this.normals.push(z,z,z)}var re,H=I.vertexColors;if(3===H.length)this.colors.push(H[0],H[1],H[2]);else{var X=I.color;this.colors.push(X,X,X)}!0===g&&(void 0!==(re=v[0][b])?this.uvs.push(re[0],re[1],re[2]):(console.warn("DirectGeometry.fromGeometry(): Undefined vertexUv ",b),this.uvs.push(new Vector2,new Vector2,new Vector2))),!0===C&&(void 0!==(re=v[1][b])?this.uvs2.push(re[0],re[1],re[2]):(console.warn("DirectGeometry.fromGeometry(): Undefined vertexUv2 ",b),this.uvs2.push(new Vector2,new Vector2,new Vector2)));for(var j=0;j<_;j++){var te=w[j].vertices;x[j].data.push(te[I.a],te[I.b],te[I.c])}for(j=0;j<E;j++){var J=A[j].vertexNormals[b];R[j].data.push(J.a,J.b,J.c)}F&&this.skinIndices.push(O[I.a],O[I.b],O[I.c]),L&&this.skinWeights.push(D[I.a],D[I.b],D[I.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this}});var _v1$1=new Vector3,_m1=new Matrix4,_zero=new Vector3(0,0,0),_one=new Vector3(1,1,1),_x=new Vector3,_y=new Vector3,_z=new Vector3;function Matrix4(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(Matrix4.prototype,{isMatrix4:!0,set:function(e,a,d,v,g,C,w,_,x,b,A,E,R,O,D,F){var L=this.elements;return L[0]=e,L[4]=a,L[8]=d,L[12]=v,L[1]=g,L[5]=C,L[9]=w,L[13]=_,L[2]=x,L[6]=b,L[10]=A,L[14]=E,L[3]=R,L[7]=O,L[11]=D,L[15]=F,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Matrix4).fromArray(this.elements)},copy:function(e){var a=this.elements,d=e.elements;return a[0]=d[0],a[1]=d[1],a[2]=d[2],a[3]=d[3],a[4]=d[4],a[5]=d[5],a[6]=d[6],a[7]=d[7],a[8]=d[8],a[9]=d[9],a[10]=d[10],a[11]=d[11],a[12]=d[12],a[13]=d[13],a[14]=d[14],a[15]=d[15],this},copyPosition:function(e){var a=this.elements,d=e.elements;return a[12]=d[12],a[13]=d[13],a[14]=d[14],this},extractBasis:function(e,a,d){return e.setFromMatrixColumn(this,0),a.setFromMatrixColumn(this,1),d.setFromMatrixColumn(this,2),this},makeBasis:function(e,a,d){return this.set(e.x,a.x,d.x,0,e.y,a.y,d.y,0,e.z,a.z,d.z,0,0,0,0,1),this},extractRotation:function(e){var a=this.elements,d=e.elements,v=1/_v1$1.setFromMatrixColumn(e,0).length(),g=1/_v1$1.setFromMatrixColumn(e,1).length(),C=1/_v1$1.setFromMatrixColumn(e,2).length();return a[0]=d[0]*v,a[1]=d[1]*v,a[2]=d[2]*v,a[3]=0,a[4]=d[4]*g,a[5]=d[5]*g,a[6]=d[6]*g,a[7]=0,a[8]=d[8]*C,a[9]=d[9]*C,a[10]=d[10]*C,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,this},makeRotationFromEuler:function(e){e&&e.isEuler||console.error("Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var a=this.elements,d=e.x,v=e.y,g=e.z,C=Math.cos(d),w=Math.sin(d),_=Math.cos(v),x=Math.sin(v),b=Math.cos(g),A=Math.sin(g);if("XYZ"===e.order){var E=C*b,R=C*A,O=w*b,D=w*A;a[0]=_*b,a[4]=-_*A,a[8]=x,a[1]=R+O*x,a[5]=E-D*x,a[9]=-w*_,a[2]=D-E*x,a[6]=O+R*x,a[10]=C*_}else if("YXZ"===e.order){var L=_*A,I=x*b;a[0]=(F=_*b)+(V=x*A)*w,a[4]=I*w-L,a[8]=C*x,a[1]=C*A,a[5]=C*b,a[9]=-w,a[2]=L*w-I,a[6]=V+F*w,a[10]=C*_}else if("ZXY"===e.order){var F,V;L=_*A,I=x*b,a[0]=(F=_*b)-(V=x*A)*w,a[4]=-C*A,a[8]=I+L*w,a[1]=L+I*w,a[5]=C*b,a[9]=V-F*w,a[2]=-C*x,a[6]=w,a[10]=C*_}else if("ZYX"===e.order)E=C*b,R=C*A,O=w*b,D=w*A,a[0]=_*b,a[4]=O*x-R,a[8]=E*x+D,a[1]=_*A,a[5]=D*x+E,a[9]=R*x-O,a[2]=-x,a[6]=w*_,a[10]=C*_;else if("YZX"===e.order){var z=C*_,H=C*x,X=w*_,re=w*x;a[0]=_*b,a[4]=re-z*A,a[8]=X*A+H,a[1]=A,a[5]=C*b,a[9]=-w*b,a[2]=-x*b,a[6]=H*A+X,a[10]=z-re*A}else"XZY"===e.order&&(z=C*_,H=C*x,X=w*_,re=w*x,a[0]=_*b,a[4]=-A,a[8]=x*b,a[1]=z*A+re,a[5]=C*b,a[9]=H*A-X,a[2]=X*A-H,a[6]=w*b,a[10]=re*A+z);return a[3]=0,a[7]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,this},makeRotationFromQuaternion:function(e){return this.compose(_zero,e,_one)},lookAt:function(e,a,d){var v=this.elements;return _z.subVectors(e,a),0===_z.lengthSq()&&(_z.z=1),_z.normalize(),_x.crossVectors(d,_z),0===_x.lengthSq()&&(1===Math.abs(d.z)?_z.x+=1e-4:_z.z+=1e-4,_z.normalize(),_x.crossVectors(d,_z)),_x.normalize(),_y.crossVectors(_z,_x),v[0]=_x.x,v[4]=_y.x,v[8]=_z.x,v[1]=_x.y,v[5]=_y.y,v[9]=_z.y,v[2]=_x.z,v[6]=_y.z,v[10]=_z.z,this},multiply:function(e,a){return void 0!==a?(console.warn("Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,a)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,a){var d=e.elements,v=a.elements,g=this.elements,C=d[0],w=d[4],_=d[8],x=d[12],b=d[1],A=d[5],E=d[9],R=d[13],O=d[2],D=d[6],F=d[10],L=d[14],I=d[3],V=d[7],z=d[11],H=d[15],X=v[0],re=v[4],j=v[8],te=v[12],J=v[1],k=v[5],U=v[9],K=v[13],ee=v[2],Q=v[6],oe=v[10],me=v[14],fe=v[3],ge=v[7],$=v[11],ue=v[15];return g[0]=C*X+w*J+_*ee+x*fe,g[4]=C*re+w*k+_*Q+x*ge,g[8]=C*j+w*U+_*oe+x*$,g[12]=C*te+w*K+_*me+x*ue,g[1]=b*X+A*J+E*ee+R*fe,g[5]=b*re+A*k+E*Q+R*ge,g[9]=b*j+A*U+E*oe+R*$,g[13]=b*te+A*K+E*me+R*ue,g[2]=O*X+D*J+F*ee+L*fe,g[6]=O*re+D*k+F*Q+L*ge,g[10]=O*j+D*U+F*oe+L*$,g[14]=O*te+D*K+F*me+L*ue,g[3]=I*X+V*J+z*ee+H*fe,g[7]=I*re+V*k+z*Q+H*ge,g[11]=I*j+V*U+z*oe+H*$,g[15]=I*te+V*K+z*me+H*ue,this},multiplyScalar:function(e){var a=this.elements;return a[0]*=e,a[4]*=e,a[8]*=e,a[12]*=e,a[1]*=e,a[5]*=e,a[9]*=e,a[13]*=e,a[2]*=e,a[6]*=e,a[10]*=e,a[14]*=e,a[3]*=e,a[7]*=e,a[11]*=e,a[15]*=e,this},determinant:function(){var e=this.elements,a=e[0],d=e[4],v=e[8],g=e[12],C=e[1],w=e[5],_=e[9],x=e[13],b=e[2],A=e[6],E=e[10],R=e[14];return e[3]*(+g*_*A-v*x*A-g*w*E+d*x*E+v*w*R-d*_*R)+e[7]*(+a*_*R-a*x*E+g*C*E-v*C*R+v*x*b-g*_*b)+e[11]*(+a*x*A-a*w*R-g*C*A+d*C*R+g*w*b-d*x*b)+e[15]*(-v*w*b-a*_*A+a*w*E+v*C*A-d*C*E+d*_*b)},transpose:function(){var a,e=this.elements;return a=e[1],e[1]=e[4],e[4]=a,a=e[2],e[2]=e[8],e[8]=a,a=e[6],e[6]=e[9],e[9]=a,a=e[3],e[3]=e[12],e[12]=a,a=e[7],e[7]=e[13],e[13]=a,a=e[11],e[11]=e[14],e[14]=a,this},setPosition:function(e,a,d){var v=this.elements;return e.isVector3?(v[12]=e.x,v[13]=e.y,v[14]=e.z):(v[12]=e,v[13]=a,v[14]=d),this},getInverse:function(e,a){var d=this.elements,v=e.elements,g=v[0],C=v[1],w=v[2],_=v[3],x=v[4],b=v[5],A=v[6],E=v[7],R=v[8],O=v[9],D=v[10],F=v[11],L=v[12],I=v[13],V=v[14],z=v[15],H=O*V*E-I*D*E+I*A*F-b*V*F-O*A*z+b*D*z,X=L*D*E-R*V*E-L*A*F+x*V*F+R*A*z-x*D*z,re=R*I*E-L*O*E+L*b*F-x*I*F-R*b*z+x*O*z,j=L*O*A-R*I*A-L*b*D+x*I*D+R*b*V-x*O*V,te=g*H+C*X+w*re+_*j;if(0===te){var J="Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===a)throw new Error(J);return console.warn(J),this.identity()}var k=1/te;return d[0]=H*k,d[1]=(I*D*_-O*V*_-I*w*F+C*V*F+O*w*z-C*D*z)*k,d[2]=(b*V*_-I*A*_+I*w*E-C*V*E-b*w*z+C*A*z)*k,d[3]=(O*A*_-b*D*_-O*w*E+C*D*E+b*w*F-C*A*F)*k,d[4]=X*k,d[5]=(R*V*_-L*D*_+L*w*F-g*V*F-R*w*z+g*D*z)*k,d[6]=(L*A*_-x*V*_-L*w*E+g*V*E+x*w*z-g*A*z)*k,d[7]=(x*D*_-R*A*_+R*w*E-g*D*E-x*w*F+g*A*F)*k,d[8]=re*k,d[9]=(L*O*_-R*I*_-L*C*F+g*I*F+R*C*z-g*O*z)*k,d[10]=(x*I*_-L*b*_+L*C*E-g*I*E-x*C*z+g*b*z)*k,d[11]=(R*b*_-x*O*_-R*C*E+g*O*E+x*C*F-g*b*F)*k,d[12]=j*k,d[13]=(R*I*w-L*O*w+L*C*D-g*I*D-R*C*V+g*O*V)*k,d[14]=(L*b*w-x*I*w-L*C*A+g*I*A+x*C*V-g*b*V)*k,d[15]=(x*O*w-R*b*w+R*C*A-g*O*A-x*C*D+g*b*D)*k,this},scale:function(e){var a=this.elements,d=e.x,v=e.y,g=e.z;return a[0]*=d,a[4]*=v,a[8]*=g,a[1]*=d,a[5]*=v,a[9]*=g,a[2]*=d,a[6]*=v,a[10]*=g,a[3]*=d,a[7]*=v,a[11]*=g,this},getMaxScaleOnAxis:function(){var e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))},makeTranslation:function(e,a,d){return this.set(1,0,0,e,0,1,0,a,0,0,1,d,0,0,0,1),this},makeRotationX:function(e){var a=Math.cos(e),d=Math.sin(e);return this.set(1,0,0,0,0,a,-d,0,0,d,a,0,0,0,0,1),this},makeRotationY:function(e){var a=Math.cos(e),d=Math.sin(e);return this.set(a,0,d,0,0,1,0,0,-d,0,a,0,0,0,0,1),this},makeRotationZ:function(e){var a=Math.cos(e),d=Math.sin(e);return this.set(a,-d,0,0,d,a,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,a){var d=Math.cos(a),v=Math.sin(a),g=1-d,C=e.x,w=e.y,_=e.z,x=g*C,b=g*w;return this.set(x*C+d,x*w-v*_,x*_+v*w,0,x*w+v*_,b*w+d,b*_-v*C,0,x*_-v*w,b*_+v*C,g*_*_+d,0,0,0,0,1),this},makeScale:function(e,a,d){return this.set(e,0,0,0,0,a,0,0,0,0,d,0,0,0,0,1),this},makeShear:function(e,a,d){return this.set(1,a,d,0,e,1,d,0,e,a,1,0,0,0,0,1),this},compose:function(e,a,d){var v=this.elements,g=a._x,C=a._y,w=a._z,_=a._w,x=g+g,b=C+C,A=w+w,E=g*x,R=g*b,O=g*A,D=C*b,F=C*A,L=w*A,I=_*x,V=_*b,z=_*A,H=d.x,X=d.y,re=d.z;return v[0]=(1-(D+L))*H,v[1]=(R+z)*H,v[2]=(O-V)*H,v[3]=0,v[4]=(R-z)*X,v[5]=(1-(E+L))*X,v[6]=(F+I)*X,v[7]=0,v[8]=(O+V)*re,v[9]=(F-I)*re,v[10]=(1-(E+D))*re,v[11]=0,v[12]=e.x,v[13]=e.y,v[14]=e.z,v[15]=1,this},decompose:function(e,a,d){var v=this.elements,g=_v1$1.set(v[0],v[1],v[2]).length(),C=_v1$1.set(v[4],v[5],v[6]).length(),w=_v1$1.set(v[8],v[9],v[10]).length();this.determinant()<0&&(g=-g),e.x=v[12],e.y=v[13],e.z=v[14],_m1.copy(this);var x=1/g,b=1/C,A=1/w;return _m1.elements[0]*=x,_m1.elements[1]*=x,_m1.elements[2]*=x,_m1.elements[4]*=b,_m1.elements[5]*=b,_m1.elements[6]*=b,_m1.elements[8]*=A,_m1.elements[9]*=A,_m1.elements[10]*=A,a.setFromRotationMatrix(_m1),d.x=g,d.y=C,d.z=w,this},makePerspective:function(e,a,d,v,g,C){void 0===C&&console.warn("Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var w=this.elements,x=2*g/(d-v),b=(a+e)/(a-e),A=(d+v)/(d-v),E=-(C+g)/(C-g),R=-2*C*g/(C-g);return w[0]=2*g/(a-e),w[4]=0,w[8]=b,w[12]=0,w[1]=0,w[5]=x,w[9]=A,w[13]=0,w[2]=0,w[6]=0,w[10]=E,w[14]=R,w[3]=0,w[7]=0,w[11]=-1,w[15]=0,this},makeOrthographic:function(e,a,d,v,g,C){var w=this.elements,_=1/(a-e),x=1/(d-v),b=1/(C-g),A=(a+e)*_,E=(d+v)*x,R=(C+g)*b;return w[0]=2*_,w[4]=0,w[8]=0,w[12]=-A,w[1]=0,w[5]=2*x,w[9]=0,w[13]=-E,w[2]=0,w[6]=0,w[10]=-2*b,w[14]=-R,w[3]=0,w[7]=0,w[11]=0,w[15]=1,this},equals:function(e){for(var a=this.elements,d=e.elements,v=0;v<16;v++)if(a[v]!==d[v])return!1;return!0},fromArray:function(e,a){void 0===a&&(a=0);for(var d=0;d<16;d++)this.elements[d]=e[d+a];return this},toArray:function(e,a){void 0===e&&(e=[]),void 0===a&&(a=0);var d=this.elements;return e[a]=d[0],e[a+1]=d[1],e[a+2]=d[2],e[a+3]=d[3],e[a+4]=d[4],e[a+5]=d[5],e[a+6]=d[6],e[a+7]=d[7],e[a+8]=d[8],e[a+9]=d[9],e[a+10]=d[10],e[a+11]=d[11],e[a+12]=d[12],e[a+13]=d[13],e[a+14]=d[14],e[a+15]=d[15],e}});var _matrix=new Matrix4,_quaternion$1=new Quaternion;function Euler(s,e,a,d){this._x=s||0,this._y=e||0,this._z=a||0,this._order=d||Euler.DefaultOrder}function Layers(){this.mask=1}function Matrix3(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("Matrix3: the constructor no longer reads arguments. use .set() instead.")}Euler.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Euler.DefaultOrder="XYZ",Object.defineProperties(Euler.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}}}),Object.assign(Euler.prototype,{isEuler:!0,set:function(e,a,d,v){return this._x=e,this._y=a,this._z=d,this._order=v||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this},setFromRotationMatrix:function(e,a,d){var v=MathUtils.clamp,g=e.elements,C=g[0],w=g[4],_=g[8],x=g[1],b=g[5],A=g[9],E=g[2],R=g[6],O=g[10];return"XYZ"===(a=a||this._order)?(this._y=Math.asin(v(_,-1,1)),Math.abs(_)<.9999999?(this._x=Math.atan2(-A,O),this._z=Math.atan2(-w,C)):(this._x=Math.atan2(R,b),this._z=0)):"YXZ"===a?(this._x=Math.asin(-v(A,-1,1)),Math.abs(A)<.9999999?(this._y=Math.atan2(_,O),this._z=Math.atan2(x,b)):(this._y=Math.atan2(-E,C),this._z=0)):"ZXY"===a?(this._x=Math.asin(v(R,-1,1)),Math.abs(R)<.9999999?(this._y=Math.atan2(-E,O),this._z=Math.atan2(-w,b)):(this._y=0,this._z=Math.atan2(x,C))):"ZYX"===a?(this._y=Math.asin(-v(E,-1,1)),Math.abs(E)<.9999999?(this._x=Math.atan2(R,O),this._z=Math.atan2(x,C)):(this._x=0,this._z=Math.atan2(-w,b))):"YZX"===a?(this._z=Math.asin(v(x,-1,1)),Math.abs(x)<.9999999?(this._x=Math.atan2(-A,b),this._y=Math.atan2(-E,C)):(this._x=0,this._y=Math.atan2(_,O))):"XZY"===a?(this._z=Math.asin(-v(w,-1,1)),Math.abs(w)<.9999999?(this._x=Math.atan2(R,b),this._y=Math.atan2(_,C)):(this._x=Math.atan2(-A,O),this._y=0)):console.warn("Euler: .setFromRotationMatrix() given unsupported order: "+a),this._order=a,!1!==d&&this._onChangeCallback(),this},setFromQuaternion:function(e,a,d){return _matrix.makeRotationFromQuaternion(e),this.setFromRotationMatrix(_matrix,a,d)},setFromVector3:function(e,a){return this.set(e.x,e.y,e.z,a||this._order)},reorder:function(e){return _quaternion$1.setFromEuler(this),this.setFromQuaternion(_quaternion$1,e)},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this},toArray:function(e,a){return void 0===e&&(e=[]),void 0===a&&(a=0),e[a]=this._x,e[a+1]=this._y,e[a+2]=this._z,e[a+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new Vector3(this._x,this._y,this._z)},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}}),Object.assign(Layers.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},enableAll:function(){this.mask=-1},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},disableAll:function(){this.mask=0},test:function(e){return 0!=(this.mask&e.mask)}}),Object.assign(Matrix3.prototype,{isMatrix3:!0,set:function(e,a,d,v,g,C,w,_,x){var b=this.elements;return b[0]=e,b[1]=v,b[2]=w,b[3]=a,b[4]=g,b[5]=_,b[6]=d,b[7]=C,b[8]=x,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var a=this.elements,d=e.elements;return a[0]=d[0],a[1]=d[1],a[2]=d[2],a[3]=d[3],a[4]=d[4],a[5]=d[5],a[6]=d[6],a[7]=d[7],a[8]=d[8],this},setFromMatrix4:function(e){var a=e.elements;return this.set(a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10]),this},multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,a){var d=e.elements,v=a.elements,g=this.elements,C=d[0],w=d[3],_=d[6],x=d[1],b=d[4],A=d[7],E=d[2],R=d[5],O=d[8],D=v[0],F=v[3],L=v[6],I=v[1],V=v[4],z=v[7],H=v[2],X=v[5],re=v[8];return g[0]=C*D+w*I+_*H,g[3]=C*F+w*V+_*X,g[6]=C*L+w*z+_*re,g[1]=x*D+b*I+A*H,g[4]=x*F+b*V+A*X,g[7]=x*L+b*z+A*re,g[2]=E*D+R*I+O*H,g[5]=E*F+R*V+O*X,g[8]=E*L+R*z+O*re,this},multiplyScalar:function(e){var a=this.elements;return a[0]*=e,a[3]*=e,a[6]*=e,a[1]*=e,a[4]*=e,a[7]*=e,a[2]*=e,a[5]*=e,a[8]*=e,this},determinant:function(){var e=this.elements,a=e[0],d=e[1],v=e[2],g=e[3],C=e[4],w=e[5],_=e[6],x=e[7],b=e[8];return a*C*b-a*w*x-d*g*b+d*w*_+v*g*x-v*C*_},getInverse:function(e,a){e&&e.isMatrix4&&console.error("Matrix3: .getInverse() no longer takes a Matrix4 argument.");var d=e.elements,v=this.elements,g=d[0],C=d[1],w=d[2],_=d[3],x=d[4],b=d[5],A=d[6],E=d[7],R=d[8],O=R*x-b*E,D=b*A-R*_,F=E*_-x*A,L=g*O+C*D+w*F;if(0===L){var I="Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===a)throw new Error(I);return console.warn(I),this.identity()}var V=1/L;return v[0]=O*V,v[1]=(w*E-R*C)*V,v[2]=(b*C-w*x)*V,v[3]=D*V,v[4]=(R*g-w*A)*V,v[5]=(w*_-b*g)*V,v[6]=F*V,v[7]=(C*A-E*g)*V,v[8]=(x*g-C*_)*V,this},transpose:function(){var e,a=this.elements;return e=a[1],a[1]=a[3],a[3]=e,e=a[2],a[2]=a[6],a[6]=e,e=a[5],a[5]=a[7],a[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var a=this.elements;return e[0]=a[0],e[1]=a[3],e[2]=a[6],e[3]=a[1],e[4]=a[4],e[5]=a[7],e[6]=a[2],e[7]=a[5],e[8]=a[8],this},setUvTransform:function(e,a,d,v,g,C,w){var _=Math.cos(g),x=Math.sin(g);this.set(d*_,d*x,-d*(_*C+x*w)+C+e,-v*x,v*_,-v*(-x*C+_*w)+w+a,0,0,1)},scale:function(e,a){var d=this.elements;return d[0]*=e,d[3]*=e,d[6]*=e,d[1]*=a,d[4]*=a,d[7]*=a,this},rotate:function(e){var a=Math.cos(e),d=Math.sin(e),v=this.elements,g=v[0],C=v[3],w=v[6],_=v[1],x=v[4],b=v[7];return v[0]=a*g+d*_,v[3]=a*C+d*x,v[6]=a*w+d*b,v[1]=-d*g+a*_,v[4]=-d*C+a*x,v[7]=-d*w+a*b,this},translate:function(e,a){var d=this.elements;return d[0]+=e*d[2],d[3]+=e*d[5],d[6]+=e*d[8],d[1]+=a*d[2],d[4]+=a*d[5],d[7]+=a*d[8],this},equals:function(e){for(var a=this.elements,d=e.elements,v=0;v<9;v++)if(a[v]!==d[v])return!1;return!0},fromArray:function(e,a){void 0===a&&(a=0);for(var d=0;d<9;d++)this.elements[d]=e[d+a];return this},toArray:function(e,a){void 0===e&&(e=[]),void 0===a&&(a=0);var d=this.elements;return e[a]=d[0],e[a+1]=d[1],e[a+2]=d[2],e[a+3]=d[3],e[a+4]=d[4],e[a+5]=d[5],e[a+6]=d[6],e[a+7]=d[7],e[a+8]=d[8],e}});var _object3DId=0,_v1$2=new Vector3,_q1=new Quaternion,_m1$1=new Matrix4,_target=new Vector3,_position=new Vector3,_scale=new Vector3,_quaternion$2=new Quaternion,_xAxis=new Vector3(1,0,0),_yAxis=new Vector3(0,1,0),_zAxis=new Vector3(0,0,1),_addedEvent={type:"added"},_removedEvent={type:"removed"};function Object3D(){Object.defineProperty(this,"id",{value:_object3DId++}),this.uuid=MathUtils.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Object3D.DefaultUp.clone();var s=new Vector3,e=new Euler,a=new Quaternion,d=new Vector3(1,1,1);e._onChange(function(){a.setFromEuler(e,!1)}),a._onChange(function(){e.setFromQuaternion(a,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:s},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:a},scale:{configurable:!0,enumerable:!0,value:d},modelViewMatrix:{value:new Matrix4},normalMatrix:{value:new Matrix3}}),this.matrix=new Matrix4,this.matrixWorld=new Matrix4,this.matrixAutoUpdate=Object3D.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Layers,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function arrayMin(s){if(0===s.length)return 1/0;for(var e=s[0],a=1,d=s.length;a<d;++a)s[a]<e&&(e=s[a]);return e}function arrayMax(s){if(0===s.length)return-1/0;for(var e=s[0],a=1,d=s.length;a<d;++a)s[a]>e&&(e=s[a]);return e}Object3D.DefaultUp=new Vector3(0,1,0),Object3D.DefaultMatrixAutoUpdate=!0,Object3D.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:Object3D,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,a){this.quaternion.setFromAxisAngle(e,a)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,a){return _q1.setFromAxisAngle(e,a),this.quaternion.multiply(_q1),this},rotateOnWorldAxis:function(e,a){return _q1.setFromAxisAngle(e,a),this.quaternion.premultiply(_q1),this},rotateX:function(e){return this.rotateOnAxis(_xAxis,e)},rotateY:function(e){return this.rotateOnAxis(_yAxis,e)},rotateZ:function(e){return this.rotateOnAxis(_zAxis,e)},translateOnAxis:function(e,a){return _v1$2.copy(e).applyQuaternion(this.quaternion),this.position.add(_v1$2.multiplyScalar(a)),this},translateX:function(e){return this.translateOnAxis(_xAxis,e)},translateY:function(e){return this.translateOnAxis(_yAxis,e)},translateZ:function(e){return this.translateOnAxis(_zAxis,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(_m1$1.getInverse(this.matrixWorld))},lookAt:function(e,a,d){e.isVector3?_target.copy(e):_target.set(e,a,d);var v=this.parent;this.updateWorldMatrix(!0,!1),_position.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?_m1$1.lookAt(_position,_target,this.up):_m1$1.lookAt(_target,_position,this.up),this.quaternion.setFromRotationMatrix(_m1$1),v&&(_m1$1.extractRotation(v.matrixWorld),_q1.setFromRotationMatrix(_m1$1),this.quaternion.premultiply(_q1.inverse()))},add:function(e){var a=arguments;if(arguments.length>1){for(var d=0;d<arguments.length;d++)this.add(a[d]);return this}return e===this?(console.error("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(_addedEvent)):console.error("Object3D.add: object not an instance of Object3D.",e),this)},remove:function(e){var a=arguments;if(arguments.length>1){for(var d=0;d<arguments.length;d++)this.remove(a[d]);return this}var v=this.children.indexOf(e);return-1!==v&&(e.parent=null,this.children.splice(v,1),e.dispatchEvent(_removedEvent)),this},attach:function(e){return this.updateWorldMatrix(!0,!1),_m1$1.getInverse(this.matrixWorld),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),_m1$1.multiply(e.parent.matrixWorld)),e.applyMatrix4(_m1$1),e.updateWorldMatrix(!1,!1),this.add(e),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,a){if(this[e]===a)return this;for(var d=0,v=this.children.length;d<v;d++){var C=this.children[d].getObjectByProperty(e,a);if(void 0!==C)return C}},getWorldPosition:function(e){return void 0===e&&(console.warn("Object3D: .getWorldPosition() target is now required"),e=new Vector3),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return void 0===e&&(console.warn("Object3D: .getWorldQuaternion() target is now required"),e=new Quaternion),this.updateMatrixWorld(!0),this.matrixWorld.decompose(_position,e,_scale),e},getWorldScale:function(e){return void 0===e&&(console.warn("Object3D: .getWorldScale() target is now required"),e=new Vector3),this.updateMatrixWorld(!0),this.matrixWorld.decompose(_position,_quaternion$2,e),e},getWorldDirection:function(e){void 0===e&&(console.warn("Object3D: .getWorldDirection() target is now required"),e=new Vector3),this.updateMatrixWorld(!0);var a=this.matrixWorld.elements;return e.set(a[8],a[9],a[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var a=this.children,d=0,v=a.length;d<v;d++)a[d].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var a=this.children,d=0,v=a.length;d<v;d++)a[d].traverseVisible(e)}},traverseAncestors:function(e){var a=this.parent;null!==a&&(e(a),a.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var a=this.children,d=0,v=a.length;d<v;d++)a[d].updateMatrixWorld(e)},updateWorldMatrix:function(e,a){var d=this.parent;if(!0===e&&null!==d&&d.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===a)for(var v=this.children,g=0,C=v.length;g<C;g++)v[g].updateWorldMatrix(!1,!0)},toJSON:function(e){var a=void 0===e||"string"==typeof e,d={};a&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},d.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var v={};function g(L,I){return void 0===L[I.uuid]&&(L[I.uuid]=I.toJSON(e)),I.uuid}if(v.uuid=this.uuid,v.type=this.type,""!==this.name&&(v.name=this.name),!0===this.castShadow&&(v.castShadow=!0),!0===this.receiveShadow&&(v.receiveShadow=!0),!1===this.visible&&(v.visible=!1),!1===this.frustumCulled&&(v.frustumCulled=!1),0!==this.renderOrder&&(v.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(v.userData=this.userData),v.layers=this.layers.mask,v.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(v.matrixAutoUpdate=!1),this.isInstancedMesh&&(v.type="InstancedMesh",v.count=this.count,v.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){v.geometry=g(e.geometries,this.geometry);var C=this.geometry.parameters;if(void 0!==C&&void 0!==C.shapes){var w=C.shapes;if(Array.isArray(w))for(var _=0,x=w.length;_<x;_++)g(e.shapes,w[_]);else g(e.shapes,w)}}if(void 0!==this.material)if(Array.isArray(this.material)){var A=[];for(_=0,x=this.material.length;_<x;_++)A.push(g(e.materials,this.material[_]));v.material=A}else v.material=g(e.materials,this.material);if(this.children.length>0)for(v.children=[],_=0;_<this.children.length;_++)v.children.push(this.children[_].toJSON(e).object);if(a){var E=F(e.geometries),R=F(e.materials),O=F(e.textures),D=F(e.images);w=F(e.shapes),E.length>0&&(d.geometries=E),R.length>0&&(d.materials=R),O.length>0&&(d.textures=O),D.length>0&&(d.images=D),w.length>0&&(d.shapes=w)}return d.object=v,d;function F(L){var I=[];for(var V in L){var z=L[V];delete z.metadata,I.push(z)}return I}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,a){if(void 0===a&&(a=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===a)for(var d=0;d<e.children.length;d++)this.add(e.children[d].clone());return this}});var _bufferGeometryId=1,_m1$2=new Matrix4,_obj=new Object3D,_offset=new Vector3,_box$2=new Box3,_boxMorphTargets=new Box3,_vector$3=new Vector3;function BufferGeometry(){Object.defineProperty(this,"id",{value:_bufferGeometryId+=2}),this.uuid=MathUtils.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}BufferGeometry.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:BufferGeometry,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){this.index=Array.isArray(e)?new(arrayMax(e)>65535?Uint32BufferAttribute:Uint16BufferAttribute)(e,1):e},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,a){return this.attributes[e]=a,this},deleteAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,a,d){this.groups.push({start:e,count:a,materialIndex:void 0!==d?d:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,a){this.drawRange.start=e,this.drawRange.count=a},applyMatrix4:function(e){var a=this.attributes.position;void 0!==a&&(a.applyMatrix4(e),a.needsUpdate=!0);var d=this.attributes.normal;if(void 0!==d){var v=(new Matrix3).getNormalMatrix(e);d.applyNormalMatrix(v),d.needsUpdate=!0}var g=this.attributes.tangent;return void 0!==g&&(g.transformDirection(e),g.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(e){return _m1$2.makeRotationX(e),this.applyMatrix4(_m1$2),this},rotateY:function(e){return _m1$2.makeRotationY(e),this.applyMatrix4(_m1$2),this},rotateZ:function(e){return _m1$2.makeRotationZ(e),this.applyMatrix4(_m1$2),this},translate:function(e,a,d){return _m1$2.makeTranslation(e,a,d),this.applyMatrix4(_m1$2),this},scale:function(e,a,d){return _m1$2.makeScale(e,a,d),this.applyMatrix4(_m1$2),this},lookAt:function(e){return _obj.lookAt(e),_obj.updateMatrix(),this.applyMatrix4(_obj.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(_offset).negate(),this.translate(_offset.x,_offset.y,_offset.z),this},setFromObject:function(e){var a=e.geometry;if(e.isPoints||e.isLine){var d=new Float32BufferAttribute(3*a.vertices.length,3),v=new Float32BufferAttribute(3*a.colors.length,3);if(this.setAttribute("position",d.copyVector3sArray(a.vertices)),this.setAttribute("color",v.copyColorsArray(a.colors)),a.lineDistances&&a.lineDistances.length===a.vertices.length){var g=new Float32BufferAttribute(a.lineDistances.length,1);this.setAttribute("lineDistance",g.copyArray(a.lineDistances))}null!==a.boundingSphere&&(this.boundingSphere=a.boundingSphere.clone()),null!==a.boundingBox&&(this.boundingBox=a.boundingBox.clone())}else e.isMesh&&a&&a.isGeometry&&this.fromGeometry(a);return this},setFromPoints:function(e){for(var a=[],d=0,v=e.length;d<v;d++){var g=e[d];a.push(g.x,g.y,g.z||0)}return this.setAttribute("position",new Float32BufferAttribute(a,3)),this},updateFromObject:function(e){var v,a=e.geometry;if(e.isMesh){var d=a.__directGeometry;if(!0===a.elementsNeedUpdate&&(d=void 0,a.elementsNeedUpdate=!1),void 0===d)return this.fromGeometry(a);d.verticesNeedUpdate=a.verticesNeedUpdate,d.normalsNeedUpdate=a.normalsNeedUpdate,d.colorsNeedUpdate=a.colorsNeedUpdate,d.uvsNeedUpdate=a.uvsNeedUpdate,d.groupsNeedUpdate=a.groupsNeedUpdate,a.verticesNeedUpdate=!1,a.normalsNeedUpdate=!1,a.colorsNeedUpdate=!1,a.uvsNeedUpdate=!1,a.groupsNeedUpdate=!1,a=d}return!0===a.verticesNeedUpdate&&(void 0!==(v=this.attributes.position)&&(v.copyVector3sArray(a.vertices),v.needsUpdate=!0),a.verticesNeedUpdate=!1),!0===a.normalsNeedUpdate&&(void 0!==(v=this.attributes.normal)&&(v.copyVector3sArray(a.normals),v.needsUpdate=!0),a.normalsNeedUpdate=!1),!0===a.colorsNeedUpdate&&(void 0!==(v=this.attributes.color)&&(v.copyColorsArray(a.colors),v.needsUpdate=!0),a.colorsNeedUpdate=!1),a.uvsNeedUpdate&&(void 0!==(v=this.attributes.uv)&&(v.copyVector2sArray(a.uvs),v.needsUpdate=!0),a.uvsNeedUpdate=!1),a.lineDistancesNeedUpdate&&(void 0!==(v=this.attributes.lineDistance)&&(v.copyArray(a.lineDistances),v.needsUpdate=!0),a.lineDistancesNeedUpdate=!1),a.groupsNeedUpdate&&(a.computeGroups(e.geometry),this.groups=a.groups,a.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new DirectGeometry).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var a=new Float32Array(3*e.vertices.length);if(this.setAttribute("position",new BufferAttribute(a,3).copyVector3sArray(e.vertices)),e.normals.length>0){var d=new Float32Array(3*e.normals.length);this.setAttribute("normal",new BufferAttribute(d,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var v=new Float32Array(3*e.colors.length);this.setAttribute("color",new BufferAttribute(v,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var g=new Float32Array(2*e.uvs.length);this.setAttribute("uv",new BufferAttribute(g,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var C=new Float32Array(2*e.uvs2.length);this.setAttribute("uv2",new BufferAttribute(C,2).copyVector2sArray(e.uvs2))}for(var w in this.groups=e.groups,e.morphTargets){for(var _=[],x=e.morphTargets[w],b=0,A=x.length;b<A;b++){var E=x[b],R=new Float32BufferAttribute(3*E.data.length,3);R.name=E.name,_.push(R.copyVector3sArray(E.data))}this.morphAttributes[w]=_}if(e.skinIndices.length>0){var O=new Float32BufferAttribute(4*e.skinIndices.length,4);this.setAttribute("skinIndex",O.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var D=new Float32BufferAttribute(4*e.skinWeights.length,4);this.setAttribute("skinWeight",D.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Box3);var e=this.attributes.position,a=this.morphAttributes.position;if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),a)for(var d=0,v=a.length;d<v;d++)_box$2.setFromBufferAttribute(a[d]),this.morphTargetsRelative?(_vector$3.addVectors(this.boundingBox.min,_box$2.min),this.boundingBox.expandByPoint(_vector$3),_vector$3.addVectors(this.boundingBox.max,_box$2.max),this.boundingBox.expandByPoint(_vector$3)):(this.boundingBox.expandByPoint(_box$2.min),this.boundingBox.expandByPoint(_box$2.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Sphere);var e=this.attributes.position,a=this.morphAttributes.position;if(e){var d=this.boundingSphere.center;if(_box$2.setFromBufferAttribute(e),a)for(var v=0,g=a.length;v<g;v++)_boxMorphTargets.setFromBufferAttribute(C=a[v]),this.morphTargetsRelative?(_vector$3.addVectors(_box$2.min,_boxMorphTargets.min),_box$2.expandByPoint(_vector$3),_vector$3.addVectors(_box$2.max,_boxMorphTargets.max),_box$2.expandByPoint(_vector$3)):(_box$2.expandByPoint(_boxMorphTargets.min),_box$2.expandByPoint(_boxMorphTargets.max));_box$2.getCenter(d);var w=0;for(v=0,g=e.count;v<g;v++)_vector$3.fromBufferAttribute(e,v),w=Math.max(w,d.distanceToSquared(_vector$3));if(a)for(v=0,g=a.length;v<g;v++)for(var C,_=this.morphTargetsRelative,x=0,b=(C=a[v]).count;x<b;x++)_vector$3.fromBufferAttribute(C,x),_&&(_offset.fromBufferAttribute(e,x),_vector$3.add(_offset)),w=Math.max(w,d.distanceToSquared(_vector$3));this.boundingSphere.radius=Math.sqrt(w),isNaN(this.boundingSphere.radius)&&console.error('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,a=this.attributes;if(a.position){var d=a.position.array;if(void 0===a.normal)this.setAttribute("normal",new BufferAttribute(new Float32Array(d.length),3));else for(var v=a.normal.array,g=0,C=v.length;g<C;g++)v[g]=0;var _,x,b,w=a.normal.array,A=new Vector3,E=new Vector3,R=new Vector3,O=new Vector3,D=new Vector3;if(e){var F=e.array;for(g=0,C=e.count;g<C;g+=3)x=3*F[g+1],b=3*F[g+2],A.fromArray(d,_=3*F[g+0]),E.fromArray(d,x),R.fromArray(d,b),O.subVectors(R,E),D.subVectors(A,E),O.cross(D),w[_]+=O.x,w[_+1]+=O.y,w[_+2]+=O.z,w[x]+=O.x,w[x+1]+=O.y,w[x+2]+=O.z,w[b]+=O.x,w[b+1]+=O.y,w[b+2]+=O.z}else for(g=0,C=d.length;g<C;g+=9)A.fromArray(d,g),E.fromArray(d,g+3),R.fromArray(d,g+6),O.subVectors(R,E),D.subVectors(A,E),O.cross(D),w[g]=O.x,w[g+1]=O.y,w[g+2]=O.z,w[g+3]=O.x,w[g+4]=O.y,w[g+5]=O.z,w[g+6]=O.x,w[g+7]=O.y,w[g+8]=O.z;this.normalizeNormals(),a.normal.needsUpdate=!0}},merge:function(e,a){if(e&&e.isBufferGeometry){void 0===a&&(a=0,console.warn("BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var d=this.attributes;for(var v in d)if(void 0!==e.attributes[v])for(var C=d[v].array,w=e.attributes[v],_=w.array,x=w.itemSize*a,b=Math.min(_.length,C.length-x),A=0,E=x;A<b;A++,E++)C[E]=_[A];return this}console.error("BufferGeometry.merge(): geometry not an instance of BufferGeometry.",e)},normalizeNormals:function(){for(var e=this.attributes.normal,a=0,d=e.count;a<d;a++)_vector$3.x=e.getX(a),_vector$3.y=e.getY(a),_vector$3.z=e.getZ(a),_vector$3.normalize(),e.setXYZ(a,_vector$3.x,_vector$3.y,_vector$3.z)},toNonIndexed:function(){function e(F,L){for(var I=F.array,V=F.itemSize,z=new I.constructor(L.length*V),H=0,X=0,re=0,j=L.length;re<j;re++){H=L[re]*V;for(var te=0;te<V;te++)z[X++]=I[H++]}return new BufferAttribute(z,V)}if(null===this.index)return console.warn("BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var a=new BufferGeometry,d=this.index.array,v=this.attributes;for(var g in v){var w=e(v[g],d);a.setAttribute(g,w)}var _=this.morphAttributes;for(g in _){for(var x=[],b=_[g],A=0,E=b.length;A<E;A++)w=e(b[A],d),x.push(w);a.morphAttributes[g]=x}a.morphTargetsRelative=this.morphTargetsRelative;for(var R=this.groups,O=(A=0,R.length);A<O;A++){var D=R[A];a.addGroup(D.start,D.count,D.materialIndex)}return a},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var a=this.parameters;for(var d in a)void 0!==a[d]&&(e[d]=a[d]);return e}e.data={attributes:{}};var v=this.index;null!==v&&(e.data.index={type:v.array.constructor.name,array:Array.prototype.slice.call(v.array)});var g=this.attributes;for(var d in g){var w=(C=g[d]).toJSON();""!==C.name&&(w.name=C.name),e.data.attributes[d]=w}var _={},x=!1;for(var d in this.morphAttributes){for(var b=this.morphAttributes[d],A=[],E=0,R=b.length;E<R;E++){var C;w=(C=b[E]).toJSON(),""!==C.name&&(w.name=C.name),A.push(w)}A.length>0&&(_[d]=A,x=!0)}x&&(e.data.morphAttributes=_,e.data.morphTargetsRelative=this.morphTargetsRelative);var O=this.groups;O.length>0&&(e.data.groups=JSON.parse(JSON.stringify(O)));var D=this.boundingSphere;return null!==D&&(e.data.boundingSphere={center:D.center.toArray(),radius:D.radius}),e},clone:function(){return(new BufferGeometry).copy(this)},copy:function(e){var a,d,v;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var g=e.index;null!==g&&this.setIndex(g.clone());var C=e.attributes;for(a in C)this.setAttribute(a,C[a].clone());var _=e.morphAttributes;for(a in _){var x=[],b=_[a];for(d=0,v=b.length;d<v;d++)x.push(b[d].clone());this.morphAttributes[a]=x}this.morphTargetsRelative=e.morphTargetsRelative;var A=e.groups;for(d=0,v=A.length;d<v;d++){var E=A[d];this.addGroup(E.start,E.count,E.materialIndex)}var R=e.boundingBox;null!==R&&(this.boundingBox=R.clone());var O=e.boundingSphere;return null!==O&&(this.boundingSphere=O.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var _vector$4=new Vector3,_segCenter=new Vector3,_segDir=new Vector3,_diff=new Vector3,_edge1=new Vector3,_edge2=new Vector3,_normal=new Vector3;function Ray(s,e){this.origin=void 0!==s?s:new Vector3,this.direction=void 0!==e?e:new Vector3(0,0,-1)}Object.assign(Ray.prototype,{set:function(e,a){return this.origin.copy(e),this.direction.copy(a),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,a){return void 0===a&&(console.warn("Ray: .at() target is now required"),a=new Vector3),a.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(e){return this.origin.copy(this.at(e,_vector$4)),this},closestPointToPoint:function(e,a){void 0===a&&(console.warn("Ray: .closestPointToPoint() target is now required"),a=new Vector3),a.subVectors(e,this.origin);var d=a.dot(this.direction);return d<0?a.copy(this.origin):a.copy(this.direction).multiplyScalar(d).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(e){var a=_vector$4.subVectors(e,this.origin).dot(this.direction);return a<0?this.origin.distanceToSquared(e):(_vector$4.copy(this.direction).multiplyScalar(a).add(this.origin),_vector$4.distanceToSquared(e))},distanceSqToSegment:function(e,a,d,v){_segCenter.copy(e).add(a).multiplyScalar(.5),_segDir.copy(a).sub(e).normalize(),_diff.copy(this.origin).sub(_segCenter);var A,E,R,O,g=.5*e.distanceTo(a),C=-this.direction.dot(_segDir),w=_diff.dot(this.direction),_=-_diff.dot(_segDir),x=_diff.lengthSq(),b=Math.abs(1-C*C);if(b>0)if(E=C*w-_,O=g*b,(A=C*_-w)>=0)if(E>=-O)if(E<=O){var D=1/b;R=(A*=D)*(A+C*(E*=D)+2*w)+E*(C*A+E+2*_)+x}else E=g,R=-(A=Math.max(0,-(C*E+w)))*A+E*(E+2*_)+x;else E=-g,R=-(A=Math.max(0,-(C*E+w)))*A+E*(E+2*_)+x;else E<=-O?R=-(A=Math.max(0,-(-C*g+w)))*A+(E=A>0?-g:Math.min(Math.max(-g,-_),g))*(E+2*_)+x:E<=O?(A=0,R=(E=Math.min(Math.max(-g,-_),g))*(E+2*_)+x):R=-(A=Math.max(0,-(C*g+w)))*A+(E=A>0?g:Math.min(Math.max(-g,-_),g))*(E+2*_)+x;else E=C>0?-g:g,R=-(A=Math.max(0,-(C*E+w)))*A+E*(E+2*_)+x;return d&&d.copy(this.direction).multiplyScalar(A).add(this.origin),v&&v.copy(_segDir).multiplyScalar(E).add(_segCenter),R},intersectSphere:function(e,a){_vector$4.subVectors(e.center,this.origin);var d=_vector$4.dot(this.direction),v=_vector$4.dot(_vector$4)-d*d,g=e.radius*e.radius;if(v>g)return null;var C=Math.sqrt(g-v),w=d-C,_=d+C;return w<0&&_<0?null:this.at(w<0?_:w,a)},intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){var a=e.normal.dot(this.direction);if(0===a)return 0===e.distanceToPoint(this.origin)?0:null;var d=-(this.origin.dot(e.normal)+e.constant)/a;return d>=0?d:null},intersectPlane:function(e,a){var d=this.distanceToPlane(e);return null===d?null:this.at(d,a)},intersectsPlane:function(e){var a=e.distanceToPoint(this.origin);return 0===a||e.normal.dot(this.direction)*a<0},intersectBox:function(e,a){var d,v,g,C,w,_,x=1/this.direction.x,b=1/this.direction.y,A=1/this.direction.z,E=this.origin;return x>=0?(d=(e.min.x-E.x)*x,v=(e.max.x-E.x)*x):(d=(e.max.x-E.x)*x,v=(e.min.x-E.x)*x),b>=0?(g=(e.min.y-E.y)*b,C=(e.max.y-E.y)*b):(g=(e.max.y-E.y)*b,C=(e.min.y-E.y)*b),d>C||g>v||((g>d||d!=d)&&(d=g),(C<v||v!=v)&&(v=C),A>=0?(w=(e.min.z-E.z)*A,_=(e.max.z-E.z)*A):(w=(e.max.z-E.z)*A,_=(e.min.z-E.z)*A),d>_||w>v)||((w>d||d!=d)&&(d=w),(_<v||v!=v)&&(v=_),v<0)?null:this.at(d>=0?d:v,a)},intersectsBox:function(e){return null!==this.intersectBox(e,_vector$4)},intersectTriangle:function(e,a,d,v,g){_edge1.subVectors(a,e),_edge2.subVectors(d,e),_normal.crossVectors(_edge1,_edge2);var w,C=this.direction.dot(_normal);if(C>0){if(v)return null;w=1}else{if(!(C<0))return null;w=-1,C=-C}_diff.subVectors(this.origin,e);var _=w*this.direction.dot(_edge2.crossVectors(_diff,_edge2));if(_<0)return null;var x=w*this.direction.dot(_edge1.cross(_diff));if(x<0||_+x>C)return null;var b=-w*_diff.dot(_normal);return b<0?null:this.at(b/C,g)},applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}});var materialId=0;function Material(){Object.defineProperty(this,"id",{value:materialId++}),this.uuid=MathUtils.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=NormalBlending,this.side=FrontSide,this.flatShading=!1,this.vertexTangents=!1,this.vertexColors=NoColors,this.opacity=1,this.transparent=!1,this.blendSrc=SrcAlphaFactor,this.blendDst=OneMinusSrcAlphaFactor,this.blendEquation=AddEquation,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=LessEqualDepth,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=AlwaysStencilFunc,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=KeepStencilOp,this.stencilZFail=KeepStencilOp,this.stencilZPass=KeepStencilOp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function LineBasicMaterial(s){Material.call(this),this.type="LineBasicMaterial",this.color=new Color(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(s)}Material.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:Material,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var a in e){var d=e[a];if(void 0!==d)if("shading"!==a){var v=this[a];void 0!==v?v&&v.isColor?v.set(d):v&&v.isVector3&&d&&d.isVector3?v.copy(d):this[a]=d:console.warn(this.type+": '"+a+"' is not a property of this material.")}else console.warn(this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=d===FlatShading;else console.warn("Material: '"+a+"' parameter is undefined.")}},toJSON:function(e){var a=void 0===e||"string"==typeof e;a&&(e={textures:{},images:{}});var d={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function v(w){var _=[];for(var x in w){var b=w[x];delete b.metadata,_.push(b)}return _}if(d.uuid=this.uuid,d.type=this.type,""!==this.name&&(d.name=this.name),this.color&&this.color.isColor&&(d.color=this.color.getHex()),void 0!==this.roughness&&(d.roughness=this.roughness),void 0!==this.metalness&&(d.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(d.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(d.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(d.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(d.specular=this.specular.getHex()),void 0!==this.shininess&&(d.shininess=this.shininess),void 0!==this.clearcoat&&(d.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(d.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(d.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,d.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(d.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(d.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(d.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(d.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(d.aoMap=this.aoMap.toJSON(e).uuid,d.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(d.bumpMap=this.bumpMap.toJSON(e).uuid,d.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(d.normalMap=this.normalMap.toJSON(e).uuid,d.normalMapType=this.normalMapType,d.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(d.displacementMap=this.displacementMap.toJSON(e).uuid,d.displacementScale=this.displacementScale,d.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(d.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(d.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(d.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(d.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(d.envMap=this.envMap.toJSON(e).uuid,d.reflectivity=this.reflectivity,d.refractionRatio=this.refractionRatio,void 0!==this.combine&&(d.combine=this.combine),void 0!==this.envMapIntensity&&(d.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(d.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(d.size=this.size),void 0!==this.sizeAttenuation&&(d.sizeAttenuation=this.sizeAttenuation),this.blending!==NormalBlending&&(d.blending=this.blending),!0===this.flatShading&&(d.flatShading=this.flatShading),this.side!==FrontSide&&(d.side=this.side),this.vertexColors!==NoColors&&(d.vertexColors=this.vertexColors),this.opacity<1&&(d.opacity=this.opacity),!0===this.transparent&&(d.transparent=this.transparent),d.depthFunc=this.depthFunc,d.depthTest=this.depthTest,d.depthWrite=this.depthWrite,d.stencilWrite=this.stencilWrite,d.stencilWriteMask=this.stencilWriteMask,d.stencilFunc=this.stencilFunc,d.stencilRef=this.stencilRef,d.stencilFuncMask=this.stencilFuncMask,d.stencilFail=this.stencilFail,d.stencilZFail=this.stencilZFail,d.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(d.rotation=this.rotation),!0===this.polygonOffset&&(d.polygonOffset=!0),0!==this.polygonOffsetFactor&&(d.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(d.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(d.linewidth=this.linewidth),void 0!==this.dashSize&&(d.dashSize=this.dashSize),void 0!==this.gapSize&&(d.gapSize=this.gapSize),void 0!==this.scale&&(d.scale=this.scale),!0===this.dithering&&(d.dithering=!0),this.alphaTest>0&&(d.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(d.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(d.wireframe=this.wireframe),this.wireframeLinewidth>1&&(d.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(d.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(d.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(d.morphTargets=!0),!0===this.morphNormals&&(d.morphNormals=!0),!0===this.skinning&&(d.skinning=!0),!1===this.visible&&(d.visible=!1),!1===this.toneMapped&&(d.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(d.userData=this.userData),a){var g=v(e.textures),C=v(e.images);g.length>0&&(d.textures=g),C.length>0&&(d.images=C)}return d},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexTangents=e.vertexTangents,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var a=e.clippingPlanes,d=null;if(null!==a){var v=a.length;d=new Array(v);for(var g=0;g!==v;++g)d[g]=a[g].clone()}return this.clippingPlanes=d,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Material.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),LineBasicMaterial.prototype=Object.create(Material.prototype),LineBasicMaterial.prototype.constructor=LineBasicMaterial,LineBasicMaterial.prototype.isLineBasicMaterial=!0,LineBasicMaterial.prototype.copy=function(s){return Material.prototype.copy.call(this,s),this.color.copy(s.color),this.linewidth=s.linewidth,this.linecap=s.linecap,this.linejoin=s.linejoin,this};var _start=new Vector3,_end=new Vector3,_inverseMatrix=new Matrix4,_ray=new Ray,_sphere=new Sphere;function Line(s,e,a){1===a&&console.error("Line: parameter LinePieces no longer supported. Use LineSegments instead."),Object3D.call(this),this.type="Line",this.geometry=void 0!==s?s:new BufferGeometry,this.material=void 0!==e?e:new LineBasicMaterial}Line.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Line,isLine:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var a=e.attributes.position,d=[0],v=1,g=a.count;v<g;v++)_start.fromBufferAttribute(a,v-1),_end.fromBufferAttribute(a,v),d[v]=d[v-1],d[v]+=_start.distanceTo(_end);e.setAttribute("lineDistance",new Float32BufferAttribute(d,1))}else console.warn("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var C=e.vertices;for((d=e.lineDistances)[0]=0,v=1,g=C.length;v<g;v++)d[v]=d[v-1],d[v]+=C[v-1].distanceTo(C[v])}return this},raycast:function(e,a){var d=e.linePrecision,v=this.geometry,g=this.matrixWorld;if(null===v.boundingSphere&&v.computeBoundingSphere(),_sphere.copy(v.boundingSphere),_sphere.applyMatrix4(g),_sphere.radius+=d,!1!==e.ray.intersectsSphere(_sphere)){_inverseMatrix.getInverse(g),_ray.copy(e.ray).applyMatrix4(_inverseMatrix);var C=d/((this.scale.x+this.scale.y+this.scale.z)/3),w=C*C,_=new Vector3,x=new Vector3,b=new Vector3,A=new Vector3,E=this&&this.isLineSegments?2:1;if(v.isBufferGeometry){var R=v.index,D=v.attributes.position.array;if(null!==R)for(var F=R.array,L=0,I=F.length-1;L<I;L+=E){var z=F[L+1];_.fromArray(D,3*F[L]),x.fromArray(D,3*z),_ray.distanceSqToSegment(_,x,A,b)>w||(A.applyMatrix4(this.matrixWorld),(X=e.ray.origin.distanceTo(A))<e.near||X>e.far||a.push({distance:X,point:b.clone().applyMatrix4(this.matrixWorld),index:L,face:null,faceIndex:null,object:this}))}else for(L=0,I=D.length/3-1;L<I;L+=E)_.fromArray(D,3*L),x.fromArray(D,3*L+3),_ray.distanceSqToSegment(_,x,A,b)>w||(A.applyMatrix4(this.matrixWorld),(X=e.ray.origin.distanceTo(A))<e.near||X>e.far||a.push({distance:X,point:b.clone().applyMatrix4(this.matrixWorld),index:L,face:null,faceIndex:null,object:this}))}else if(v.isGeometry){var re=v.vertices,j=re.length;for(L=0;L<j-1;L+=E){var X;_ray.distanceSqToSegment(re[L],re[L+1],A,b)>w||(A.applyMatrix4(this.matrixWorld),(X=e.ray.origin.distanceTo(A))<e.near||X>e.far||a.push({distance:X,point:b.clone().applyMatrix4(this.matrixWorld),index:L,face:null,faceIndex:null,object:this}))}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var _vector1=new Vector3,_vector2=new Vector3,_normalMatrix=new Matrix3;function Plane(s,e){this.normal=void 0!==s?s:new Vector3(1,0,0),this.constant=void 0!==e?e:0}Object.assign(Plane.prototype,{isPlane:!0,set:function(e,a){return this.normal.copy(e),this.constant=a,this},setComponents:function(e,a,d,v){return this.normal.set(e,a,d),this.constant=v,this},setFromNormalAndCoplanarPoint:function(e,a){return this.normal.copy(e),this.constant=-a.dot(this.normal),this},setFromCoplanarPoints:function(e,a,d){var v=_vector1.subVectors(d,a).cross(_vector2.subVectors(e,a)).normalize();return this.setFromNormalAndCoplanarPoint(v,e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,a){return void 0===a&&(console.warn("Plane: .projectPoint() target is now required"),a=new Vector3),a.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(e,a){void 0===a&&(console.warn("Plane: .intersectLine() target is now required"),a=new Vector3);var d=e.delta(_vector1),v=this.normal.dot(d);if(0===v)return 0===this.distanceToPoint(e.start)?a.copy(e.start):void 0;var g=-(e.start.dot(this.normal)+this.constant)/v;return g<0||g>1?void 0:a.copy(d).multiplyScalar(g).add(e.start)},intersectsLine:function(e){var a=this.distanceToPoint(e.start),d=this.distanceToPoint(e.end);return a<0&&d>0||d<0&&a>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return void 0===e&&(console.warn("Plane: .coplanarPoint() target is now required"),e=new Vector3),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(e,a){var d=a||_normalMatrix.getNormalMatrix(e),v=this.coplanarPoint(_vector1).applyMatrix4(e),g=this.normal.applyMatrix3(d).normalize();return this.constant=-v.dot(g),this},translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}});var _v0$1=new Vector3,_v1$3=new Vector3,_v2$1=new Vector3,_v3=new Vector3,_vab=new Vector3,_vac=new Vector3,_vbc=new Vector3,_vap=new Vector3,_vbp=new Vector3,_vcp=new Vector3;function Triangle(s,e,a){this.a=void 0!==s?s:new Vector3,this.b=void 0!==e?e:new Vector3,this.c=void 0!==a?a:new Vector3}function Face3(s,e,a,d,v,g){this.a=s,this.b=e,this.c=a,this.normal=d&&d.isVector3?d:new Vector3,this.vertexNormals=Array.isArray(d)?d:[],this.color=v&&v.isColor?v:new Color,this.vertexColors=Array.isArray(v)?v:[],this.materialIndex=void 0!==g?g:0}function MeshBasicMaterial(s){Material.call(this),this.type="MeshBasicMaterial",this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(s)}Object.assign(Triangle,{getNormal:function(e,a,d,v){void 0===v&&(console.warn("Triangle: .getNormal() target is now required"),v=new Vector3),v.subVectors(d,a),_v0$1.subVectors(e,a),v.cross(_v0$1);var g=v.lengthSq();return g>0?v.multiplyScalar(1/Math.sqrt(g)):v.set(0,0,0)},getBarycoord:function(e,a,d,v,g){_v0$1.subVectors(v,a),_v1$3.subVectors(d,a),_v2$1.subVectors(e,a);var C=_v0$1.dot(_v0$1),w=_v0$1.dot(_v1$3),_=_v0$1.dot(_v2$1),x=_v1$3.dot(_v1$3),b=_v1$3.dot(_v2$1),A=C*x-w*w;if(void 0===g&&(console.warn("Triangle: .getBarycoord() target is now required"),g=new Vector3),0===A)return g.set(-2,-1,-1);var E=1/A,R=(x*_-w*b)*E,O=(C*b-w*_)*E;return g.set(1-R-O,O,R)},containsPoint:function(e,a,d,v){return Triangle.getBarycoord(e,a,d,v,_v3),_v3.x>=0&&_v3.y>=0&&_v3.x+_v3.y<=1},getUV:function(e,a,d,v,g,C,w,_){return this.getBarycoord(e,a,d,v,_v3),_.set(0,0),_.addScaledVector(g,_v3.x),_.addScaledVector(C,_v3.y),_.addScaledVector(w,_v3.z),_},isFrontFacing:function(e,a,d,v){return _v0$1.subVectors(d,a),_v1$3.subVectors(e,a),_v0$1.cross(_v1$3).dot(v)<0}}),Object.assign(Triangle.prototype,{set:function(e,a,d){return this.a.copy(e),this.b.copy(a),this.c.copy(d),this},setFromPointsAndIndices:function(e,a,d,v){return this.a.copy(e[a]),this.b.copy(e[d]),this.c.copy(e[v]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){return _v0$1.subVectors(this.c,this.b),_v1$3.subVectors(this.a,this.b),.5*_v0$1.cross(_v1$3).length()},getMidpoint:function(e){return void 0===e&&(console.warn("Triangle: .getMidpoint() target is now required"),e=new Vector3),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return Triangle.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return void 0===e&&(console.warn("Triangle: .getPlane() target is now required"),e=new Plane),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,a){return Triangle.getBarycoord(e,this.a,this.b,this.c,a)},getUV:function(e,a,d,v,g){return Triangle.getUV(e,this.a,this.b,this.c,a,d,v,g)},containsPoint:function(e){return Triangle.containsPoint(e,this.a,this.b,this.c)},isFrontFacing:function(e){return Triangle.isFrontFacing(this.a,this.b,this.c,e)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(e,a){void 0===a&&(console.warn("Triangle: .closestPointToPoint() target is now required"),a=new Vector3);var C,w,d=this.a,v=this.b,g=this.c;_vab.subVectors(v,d),_vac.subVectors(g,d),_vap.subVectors(e,d);var _=_vab.dot(_vap),x=_vac.dot(_vap);if(_<=0&&x<=0)return a.copy(d);_vbp.subVectors(e,v);var b=_vab.dot(_vbp),A=_vac.dot(_vbp);if(b>=0&&A<=b)return a.copy(v);var E=_*A-b*x;if(E<=0&&_>=0&&b<=0)return C=_/(_-b),a.copy(d).addScaledVector(_vab,C);_vcp.subVectors(e,g);var R=_vab.dot(_vcp),O=_vac.dot(_vcp);if(O>=0&&R<=O)return a.copy(g);var D=R*x-_*O;if(D<=0&&x>=0&&O<=0)return w=x/(x-O),a.copy(d).addScaledVector(_vac,w);var F=b*O-R*A;if(F<=0&&A-b>=0&&R-O>=0)return _vbc.subVectors(g,v),w=(A-b)/(A-b+(R-O)),a.copy(v).addScaledVector(_vbc,w);var L=1/(F+D+E);return C=D*L,w=E*L,a.copy(d).addScaledVector(_vab,C).addScaledVector(_vac,w)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}),Object.assign(Face3.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var a=0,d=e.vertexNormals.length;a<d;a++)this.vertexNormals[a]=e.vertexNormals[a].clone();for(a=0,d=e.vertexColors.length;a<d;a++)this.vertexColors[a]=e.vertexColors[a].clone();return this}}),MeshBasicMaterial.prototype=Object.create(Material.prototype),MeshBasicMaterial.prototype.constructor=MeshBasicMaterial,MeshBasicMaterial.prototype.isMeshBasicMaterial=!0,MeshBasicMaterial.prototype.copy=function(s){return Material.prototype.copy.call(this,s),this.color.copy(s.color),this.map=s.map,this.lightMap=s.lightMap,this.lightMapIntensity=s.lightMapIntensity,this.aoMap=s.aoMap,this.aoMapIntensity=s.aoMapIntensity,this.specularMap=s.specularMap,this.alphaMap=s.alphaMap,this.envMap=s.envMap,this.combine=s.combine,this.reflectivity=s.reflectivity,this.refractionRatio=s.refractionRatio,this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this.wireframeLinecap=s.wireframeLinecap,this.wireframeLinejoin=s.wireframeLinejoin,this.skinning=s.skinning,this.morphTargets=s.morphTargets,this};var _inverseMatrix$1=new Matrix4,_ray$1=new Ray,_sphere$1=new Sphere,_vA=new Vector3,_vB=new Vector3,_vC=new Vector3,_tempA=new Vector3,_tempB=new Vector3,_tempC=new Vector3,_morphA=new Vector3,_morphB=new Vector3,_morphC=new Vector3,_uvA=new Vector2,_uvB=new Vector2,_uvC=new Vector2,_intersectionPoint=new Vector3,_intersectionPointWorld=new Vector3;function Mesh(s,e){Object3D.call(this),this.type="Mesh",this.geometry=void 0!==s?s:new BufferGeometry,this.material=void 0!==e?e:new MeshBasicMaterial,this.updateMorphTargets()}function checkIntersection(s,e,a,d,v,g,C,w){if(null===(e.side===BackSide?d.intersectTriangle(C,g,v,!0,w):d.intersectTriangle(v,g,C,e.side!==DoubleSide,w)))return null;_intersectionPointWorld.copy(w),_intersectionPointWorld.applyMatrix4(s.matrixWorld);var x=a.ray.origin.distanceTo(_intersectionPointWorld);return x<a.near||x>a.far?null:{distance:x,point:_intersectionPointWorld.clone(),object:s}}function checkBufferGeometryIntersection(s,e,a,d,v,g,C,w,_,x,b,A){_vA.fromBufferAttribute(v,x),_vB.fromBufferAttribute(v,b),_vC.fromBufferAttribute(v,A);var E=s.morphTargetInfluences;if(e.morphTargets&&g&&E){_morphA.set(0,0,0),_morphB.set(0,0,0),_morphC.set(0,0,0);for(var R=0,O=g.length;R<O;R++){var D=E[R],F=g[R];0!==D&&(_tempA.fromBufferAttribute(F,x),_tempB.fromBufferAttribute(F,b),_tempC.fromBufferAttribute(F,A),C?(_morphA.addScaledVector(_tempA,D),_morphB.addScaledVector(_tempB,D),_morphC.addScaledVector(_tempC,D)):(_morphA.addScaledVector(_tempA.sub(_vA),D),_morphB.addScaledVector(_tempB.sub(_vB),D),_morphC.addScaledVector(_tempC.sub(_vC),D)))}_vA.add(_morphA),_vB.add(_morphB),_vC.add(_morphC)}var L=checkIntersection(s,e,a,d,_vA,_vB,_vC,_intersectionPoint);if(L){w&&(_uvA.fromBufferAttribute(w,x),_uvB.fromBufferAttribute(w,b),_uvC.fromBufferAttribute(w,A),L.uv=Triangle.getUV(_intersectionPoint,_vA,_vB,_vC,_uvA,_uvB,_uvC,new Vector2)),_&&(_uvA.fromBufferAttribute(_,x),_uvB.fromBufferAttribute(_,b),_uvC.fromBufferAttribute(_,A),L.uv2=Triangle.getUV(_intersectionPoint,_vA,_vB,_vC,_uvA,_uvB,_uvC,new Vector2));var I=new Face3(x,b,A);Triangle.getNormal(_vA,_vB,_vC,I.normal),L.face=I}return L}Mesh.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Mesh,isMesh:!0,copy:function(e){return Object3D.prototype.copy.call(this,e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var a,d,v,e=this.geometry;if(e.isBufferGeometry){var g=e.morphAttributes,C=Object.keys(g);if(C.length>0){var w=g[C[0]];if(void 0!==w)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},a=0,d=w.length;a<d;a++)v=w[a].name||String(a),this.morphTargetInfluences.push(0),this.morphTargetDictionary[v]=a}}else{var _=e.morphTargets;void 0!==_&&_.length>0&&console.error("Mesh.updateMorphTargets() no longer supports Geometry. Use BufferGeometry instead.")}},raycast:function(e,a){var C,d=this.geometry,v=this.material,g=this.matrixWorld;if(void 0!==v&&(null===d.boundingSphere&&d.computeBoundingSphere(),_sphere$1.copy(d.boundingSphere),_sphere$1.applyMatrix4(g),!1!==e.ray.intersectsSphere(_sphere$1)&&(_inverseMatrix$1.getInverse(g),_ray$1.copy(e.ray).applyMatrix4(_inverseMatrix$1),null===d.boundingBox||!1!==_ray$1.intersectsBox(d.boundingBox))))if(d.isBufferGeometry){var w,_,x,I,V,z,H,X,re,b=d.index,A=d.attributes.position,E=d.morphAttributes.position,R=d.morphTargetsRelative,O=d.attributes.uv,D=d.attributes.uv2,F=d.groups,L=d.drawRange;if(null!==b)if(Array.isArray(v))for(I=0,z=F.length;I<z;I++)for(re=v[(X=F[I]).materialIndex],V=Math.max(X.start,L.start),H=Math.min(X.start+X.count,L.start+L.count);V<H;V+=3)w=b.getX(V),_=b.getX(V+1),x=b.getX(V+2),(C=checkBufferGeometryIntersection(this,re,e,_ray$1,A,E,R,O,D,w,_,x))&&(C.faceIndex=Math.floor(V/3),C.face.materialIndex=X.materialIndex,a.push(C));else for(I=Math.max(0,L.start),z=Math.min(b.count,L.start+L.count);I<z;I+=3)w=b.getX(I),_=b.getX(I+1),x=b.getX(I+2),(C=checkBufferGeometryIntersection(this,v,e,_ray$1,A,E,R,O,D,w,_,x))&&(C.faceIndex=Math.floor(I/3),a.push(C));else if(void 0!==A)if(Array.isArray(v))for(I=0,z=F.length;I<z;I++)for(re=v[(X=F[I]).materialIndex],V=Math.max(X.start,L.start),H=Math.min(X.start+X.count,L.start+L.count);V<H;V+=3)(C=checkBufferGeometryIntersection(this,re,e,_ray$1,A,E,R,O,D,w=V,_=V+1,x=V+2))&&(C.faceIndex=Math.floor(V/3),C.face.materialIndex=X.materialIndex,a.push(C));else for(I=Math.max(0,L.start),z=Math.min(A.count,L.start+L.count);I<z;I+=3)(C=checkBufferGeometryIntersection(this,v,e,_ray$1,A,E,R,O,D,w=I,_=I+1,x=I+2))&&(C.faceIndex=Math.floor(I/3),a.push(C))}else if(d.isGeometry){var J,k,U,oe,K=Array.isArray(v),ee=d.vertices,Q=d.faces,me=d.faceVertexUvs[0];me.length>0&&(oe=me);for(var fe=0,ge=Q.length;fe<ge;fe++){var $=Q[fe],ue=K?v[$.materialIndex]:v;if(void 0!==ue&&(C=checkIntersection(this,ue,e,_ray$1,J=ee[$.a],k=ee[$.b],U=ee[$.c],_intersectionPoint))){if(oe&&oe[fe]){var Y=oe[fe];_uvA.copy(Y[0]),_uvB.copy(Y[1]),_uvC.copy(Y[2]),C.uv=Triangle.getUV(_intersectionPoint,J,k,U,_uvA,_uvB,_uvC,new Vector2)}C.face=$,C.faceIndex=fe,a.push(C)}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var _geometryId=0,_m1$3=new Matrix4,_obj$1=new Object3D,_offset$1=new Vector3;function Geometry(){Object.defineProperty(this,"id",{value:_geometryId+=2}),this.uuid=MathUtils.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function SphereGeometry(s,e,a,d,v,g,C){Geometry.call(this),this.type="SphereGeometry",this.parameters={radius:s,widthSegments:e,heightSegments:a,phiStart:d,phiLength:v,thetaStart:g,thetaLength:C},this.fromBufferGeometry(new SphereBufferGeometry(s,e,a,d,v,g,C)),this.mergeVertices()}function SphereBufferGeometry(s,e,a,d,v,g,C){BufferGeometry.call(this),this.type="SphereBufferGeometry",this.parameters={radius:s,widthSegments:e,heightSegments:a,phiStart:d,phiLength:v,thetaStart:g,thetaLength:C},s=s||1,e=Math.max(3,Math.floor(e)||8),a=Math.max(2,Math.floor(a)||6),d=void 0!==d?d:0,v=void 0!==v?v:2*Math.PI,g=void 0!==g?g:0,C=void 0!==C?C:Math.PI;var _,x,w=Math.min(g+C,Math.PI),b=0,A=[],E=new Vector3,R=new Vector3,O=[],D=[],F=[],L=[];for(x=0;x<=a;x++){var I=[],V=x/a,z=0;for(0==x&&0==g?z=.5/e:x==a&&w==Math.PI&&(z=-.5/e),_=0;_<=e;_++){var H=_/e;E.x=-s*Math.cos(d+H*v)*Math.sin(g+V*C),E.y=s*Math.cos(g+V*C),E.z=s*Math.sin(d+H*v)*Math.sin(g+V*C),D.push(E.x,E.y,E.z),R.copy(E).normalize(),F.push(R.x,R.y,R.z),L.push(H+z,1-V),I.push(b++)}A.push(I)}for(x=0;x<a;x++)for(_=0;_<e;_++){var re=A[x][_],j=A[x+1][_],te=A[x+1][_+1];(0!==x||g>0)&&O.push(A[x][_+1],re,te),(x!==a-1||w<Math.PI)&&O.push(re,j,te)}this.setIndex(O),this.setAttribute("position",new Float32BufferAttribute(D,3)),this.setAttribute("normal",new Float32BufferAttribute(F,3)),this.setAttribute("uv",new Float32BufferAttribute(L,2))}Geometry.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:Geometry,isGeometry:!0,applyMatrix4:function(e){for(var a=(new Matrix3).getNormalMatrix(e),d=0,v=this.vertices.length;d<v;d++)this.vertices[d].applyMatrix4(e);for(d=0,v=this.faces.length;d<v;d++){var C=this.faces[d];C.normal.applyMatrix3(a).normalize();for(var w=0,_=C.vertexNormals.length;w<_;w++)C.vertexNormals[w].applyMatrix3(a).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(e){return _m1$3.makeRotationX(e),this.applyMatrix4(_m1$3),this},rotateY:function(e){return _m1$3.makeRotationY(e),this.applyMatrix4(_m1$3),this},rotateZ:function(e){return _m1$3.makeRotationZ(e),this.applyMatrix4(_m1$3),this},translate:function(e,a,d){return _m1$3.makeTranslation(e,a,d),this.applyMatrix4(_m1$3),this},scale:function(e,a,d){return _m1$3.makeScale(e,a,d),this.applyMatrix4(_m1$3),this},lookAt:function(e){return _obj$1.lookAt(e),_obj$1.updateMatrix(),this.applyMatrix4(_obj$1.matrix),this},fromBufferGeometry:function(e){var a=this,d=null!==e.index?e.index.array:void 0,v=e.attributes;if(void 0===v.position)return console.error("Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var g=v.position.array,C=void 0!==v.normal?v.normal.array:void 0,w=void 0!==v.color?v.color.array:void 0,_=void 0!==v.uv?v.uv.array:void 0,x=void 0!==v.uv2?v.uv2.array:void 0;void 0!==x&&(this.faceVertexUvs[1]=[]);for(var b=0;b<g.length;b+=3)a.vertices.push((new Vector3).fromArray(g,b)),void 0!==w&&a.colors.push((new Color).fromArray(w,b));function A(I,V,z,H){var X=void 0===w?[]:[a.colors[I].clone(),a.colors[V].clone(),a.colors[z].clone()],j=new Face3(I,V,z,void 0===C?[]:[(new Vector3).fromArray(C,3*I),(new Vector3).fromArray(C,3*V),(new Vector3).fromArray(C,3*z)],X,H);a.faces.push(j),void 0!==_&&a.faceVertexUvs[0].push([(new Vector2).fromArray(_,2*I),(new Vector2).fromArray(_,2*V),(new Vector2).fromArray(_,2*z)]),void 0!==x&&a.faceVertexUvs[1].push([(new Vector2).fromArray(x,2*I),(new Vector2).fromArray(x,2*V),(new Vector2).fromArray(x,2*z)])}var E=e.groups;if(E.length>0)for(b=0;b<E.length;b++)for(var R=E[b],O=R.start,F=O,L=O+R.count;F<L;F+=3)void 0!==d?A(d[F],d[F+1],d[F+2],R.materialIndex):A(F,F+1,F+2,R.materialIndex);else if(void 0!==d)for(b=0;b<d.length;b+=3)A(d[b],d[b+1],d[b+2]);else for(b=0;b<g.length/3;b+=3)A(b,b+1,b+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(_offset$1).negate(),this.translate(_offset$1.x,_offset$1.y,_offset$1.z),this},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,a=this.boundingSphere.radius,d=0===a?1:1/a,v=new Matrix4;return v.set(d,0,0,-d*e.x,0,d,0,-d*e.y,0,0,d,-d*e.z,0,0,0,1),this.applyMatrix4(v),this},computeFaceNormals:function(){for(var e=new Vector3,a=new Vector3,d=0,v=this.faces.length;d<v;d++){var g=this.faces[d],C=this.vertices[g.a],w=this.vertices[g.b];e.subVectors(this.vertices[g.c],w),a.subVectors(C,w),e.cross(a),e.normalize(),g.normal.copy(e)}},computeVertexNormals:function(e){var a,d,v,g,C,w;for(void 0===e&&(e=!0),w=new Array(this.vertices.length),a=0,d=this.vertices.length;a<d;a++)w[a]=new Vector3;if(e){var _,x,A=new Vector3,E=new Vector3;for(v=0,g=this.faces.length;v<g;v++)_=this.vertices[(C=this.faces[v]).a],A.subVectors(this.vertices[C.c],x=this.vertices[C.b]),E.subVectors(_,x),A.cross(E),w[C.a].add(A),w[C.b].add(A),w[C.c].add(A)}else for(this.computeFaceNormals(),v=0,g=this.faces.length;v<g;v++)w[(C=this.faces[v]).a].add(C.normal),w[C.b].add(C.normal),w[C.c].add(C.normal);for(a=0,d=this.vertices.length;a<d;a++)w[a].normalize();for(v=0,g=this.faces.length;v<g;v++){var R=(C=this.faces[v]).vertexNormals;3===R.length?(R[0].copy(w[C.a]),R[1].copy(w[C.b]),R[2].copy(w[C.c])):(R[0]=w[C.a].clone(),R[1]=w[C.b].clone(),R[2]=w[C.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,a,d;for(this.computeFaceNormals(),e=0,a=this.faces.length;e<a;e++){var v=(d=this.faces[e]).vertexNormals;3===v.length?(v[0].copy(d.normal),v[1].copy(d.normal),v[2].copy(d.normal)):(v[0]=d.normal.clone(),v[1]=d.normal.clone(),v[2]=d.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,a,d,v,g;for(d=0,v=this.faces.length;d<v;d++)for((g=this.faces[d]).__originalFaceNormal?g.__originalFaceNormal.copy(g.normal):g.__originalFaceNormal=g.normal.clone(),g.__originalVertexNormals||(g.__originalVertexNormals=[]),e=0,a=g.vertexNormals.length;e<a;e++)g.__originalVertexNormals[e]?g.__originalVertexNormals[e].copy(g.vertexNormals[e]):g.__originalVertexNormals[e]=g.vertexNormals[e].clone();var C=new Geometry;for(C.faces=this.faces,e=0,a=this.morphTargets.length;e<a;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var w=this.morphNormals[e].faceNormals,_=this.morphNormals[e].vertexNormals;for(d=0,v=this.faces.length;d<v;d++)b=new Vector3,A={a:new Vector3,b:new Vector3,c:new Vector3},w.push(b),_.push(A)}var b,A,x=this.morphNormals[e];for(C.vertices=this.morphTargets[e].vertices,C.computeFaceNormals(),C.computeVertexNormals(),d=0,v=this.faces.length;d<v;d++)A=x.vertexNormals[d],(b=x.faceNormals[d]).copy((g=this.faces[d]).normal),A.a.copy(g.vertexNormals[0]),A.b.copy(g.vertexNormals[1]),A.c.copy(g.vertexNormals[2])}for(d=0,v=this.faces.length;d<v;d++)(g=this.faces[d]).normal=g.__originalFaceNormal,g.vertexNormals=g.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Box3),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Sphere),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,a,d){if(e&&e.isGeometry){var v,g=this.vertices.length,C=this.vertices,w=e.vertices,_=this.faces,x=e.faces,b=this.colors,A=e.colors;void 0===d&&(d=0),void 0!==a&&(v=(new Matrix3).getNormalMatrix(a));for(var E=0,R=w.length;E<R;E++){var D=w[E].clone();void 0!==a&&D.applyMatrix4(a),C.push(D)}for(E=0,R=A.length;E<R;E++)b.push(A[E].clone());for(E=0,R=x.length;E<R;E++){var L,I,F=x[E],z=F.vertexNormals,H=F.vertexColors;(L=new Face3(F.a+g,F.b+g,F.c+g)).normal.copy(F.normal),void 0!==v&&L.normal.applyMatrix3(v).normalize();for(var X=0,re=z.length;X<re;X++)I=z[X].clone(),void 0!==v&&I.applyMatrix3(v).normalize(),L.vertexNormals.push(I);for(L.color.copy(F.color),X=0,re=H.length;X<re;X++)L.vertexColors.push(H[X].clone());L.materialIndex=F.materialIndex+d,_.push(L)}for(E=0,R=e.faceVertexUvs.length;E<R;E++){var j=e.faceVertexUvs[E];for(void 0===this.faceVertexUvs[E]&&(this.faceVertexUvs[E]=[]),X=0,re=j.length;X<re;X++){for(var te=j[X],J=[],k=0,U=te.length;k<U;k++)J.push(te[k].clone());this.faceVertexUvs[E].push(J)}}}else console.error("Geometry.merge(): geometry not an instance of Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("Geometry.mergeMesh(): mesh not an instance of Mesh.",e)},mergeVertices:function(){var v,g,_,x,b,A,E,R,e={},a=[],d=[],w=Math.pow(10,4);for(_=0,x=this.vertices.length;_<x;_++)v=this.vertices[_],void 0===e[g=Math.round(v.x*w)+"_"+Math.round(v.y*w)+"_"+Math.round(v.z*w)]?(e[g]=_,a.push(this.vertices[_]),d[_]=a.length-1):d[_]=d[e[g]];var O=[];for(_=0,x=this.faces.length;_<x;_++){(b=this.faces[_]).a=d[b.a],b.b=d[b.b],b.c=d[b.c],A=[b.a,b.b,b.c];for(var D=0;D<3;D++)if(A[D]===A[(D+1)%3]){O.push(_);break}}for(_=O.length-1;_>=0;_--){var F=O[_];for(this.faces.splice(F,1),E=0,R=this.faceVertexUvs.length;E<R;E++)this.faceVertexUvs[E].splice(F,1)}var L=this.vertices.length-a.length;return this.vertices=a,L},setFromPoints:function(e){this.vertices=[];for(var a=0,d=e.length;a<d;a++){var v=e[a];this.vertices.push(new Vector3(v.x,v.y,v.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,a=e.length,d=0;d<a;d++)e[d]._id=d;e.sort(function(b,A){return b.materialIndex-A.materialIndex});var w,_,g=this.faceVertexUvs[0],C=this.faceVertexUvs[1];for(g&&g.length===a&&(w=[]),C&&C.length===a&&(_=[]),d=0;d<a;d++){var x=e[d]._id;w&&w.push(g[x]),_&&_.push(C[x])}w&&(this.faceVertexUvs[0]=w),_&&(this.faceVertexUvs[1]=_)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var a=this.parameters;for(var d in a)void 0!==a[d]&&(e[d]=a[d]);return e}for(var v=[],g=0;g<this.vertices.length;g++){var C=this.vertices[g];v.push(C.x,C.y,C.z)}var w=[],_=[],x={},b=[],A={},E=[],R={};for(g=0;g<this.faces.length;g++){var O=this.faces[g],L=void 0!==this.faceVertexUvs[0][g],I=O.normal.length()>0,V=O.vertexNormals.length>0,z=1!==O.color.r||1!==O.color.g||1!==O.color.b,H=O.vertexColors.length>0,X=0;if(X=J(X,0,0),X=J(X,1,!0),X=J(X,2,!1),X=J(X,3,L),X=J(X,4,I),X=J(X,5,V),X=J(X,6,z),X=J(X,7,H),w.push(X),w.push(O.a,O.b,O.c),w.push(O.materialIndex),L){var re=this.faceVertexUvs[0][g];w.push(K(re[0]),K(re[1]),K(re[2]))}if(I&&w.push(k(O.normal)),V){var j=O.vertexNormals;w.push(k(j[0]),k(j[1]),k(j[2]))}if(z&&w.push(U(O.color)),H){var te=O.vertexColors;w.push(U(te[0]),U(te[1]),U(te[2]))}}function J(ee,Q,oe){return oe?ee|1<<Q:ee&~(1<<Q)}function k(ee){var Q=ee.x.toString()+ee.y.toString()+ee.z.toString();return void 0!==x[Q]||(x[Q]=_.length/3,_.push(ee.x,ee.y,ee.z)),x[Q]}function U(ee){var Q=ee.r.toString()+ee.g.toString()+ee.b.toString();return void 0!==A[Q]||(A[Q]=b.length,b.push(ee.getHex())),A[Q]}function K(ee){var Q=ee.x.toString()+ee.y.toString();return void 0!==R[Q]||(R[Q]=E.length/2,E.push(ee.x,ee.y)),R[Q]}return e.data={},e.data.vertices=v,e.data.normals=_,b.length>0&&(e.data.colors=b),E.length>0&&(e.data.uvs=[E]),e.data.faces=w,e},clone:function(){return(new Geometry).copy(this)},copy:function(e){var a,d,v,g,C,w;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var _=e.vertices;for(a=0,d=_.length;a<d;a++)this.vertices.push(_[a].clone());var x=e.colors;for(a=0,d=x.length;a<d;a++)this.colors.push(x[a].clone());var b=e.faces;for(a=0,d=b.length;a<d;a++)this.faces.push(b[a].clone());for(a=0,d=e.faceVertexUvs.length;a<d;a++){var A=e.faceVertexUvs[a];for(void 0===this.faceVertexUvs[a]&&(this.faceVertexUvs[a]=[]),v=0,g=A.length;v<g;v++){var E=A[v],R=[];for(C=0,w=E.length;C<w;C++)R.push(E[C].clone());this.faceVertexUvs[a].push(R)}}var D=e.morphTargets;for(a=0,d=D.length;a<d;a++){var F={};if(F.name=D[a].name,void 0!==D[a].vertices)for(F.vertices=[],v=0,g=D[a].vertices.length;v<g;v++)F.vertices.push(D[a].vertices[v].clone());if(void 0!==D[a].normals)for(F.normals=[],v=0,g=D[a].normals.length;v<g;v++)F.normals.push(D[a].normals[v].clone());this.morphTargets.push(F)}var L=e.morphNormals;for(a=0,d=L.length;a<d;a++){var I={};if(void 0!==L[a].vertexNormals)for(I.vertexNormals=[],v=0,g=L[a].vertexNormals.length;v<g;v++){var V=L[a].vertexNormals[v],z={};z.a=V.a.clone(),z.b=V.b.clone(),z.c=V.c.clone(),I.vertexNormals.push(z)}if(void 0!==L[a].faceNormals)for(I.faceNormals=[],v=0,g=L[a].faceNormals.length;v<g;v++)I.faceNormals.push(L[a].faceNormals[v].clone());this.morphNormals.push(I)}var H=e.skinWeights;for(a=0,d=H.length;a<d;a++)this.skinWeights.push(H[a].clone());var X=e.skinIndices;for(a=0,d=X.length;a<d;a++)this.skinIndices.push(X[a].clone());var re=e.lineDistances;for(a=0,d=re.length;a<d;a++)this.lineDistances.push(re[a]);var j=e.boundingBox;null!==j&&(this.boundingBox=j.clone());var te=e.boundingSphere;return null!==te&&(this.boundingSphere=te.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),SphereGeometry.prototype=Object.create(Geometry.prototype),SphereGeometry.prototype.constructor=SphereGeometry,SphereBufferGeometry.prototype=Object.create(BufferGeometry.prototype),SphereBufferGeometry.prototype.constructor=SphereBufferGeometry;var CCDIKSolver=function(){function s(a,d){this.mesh=a,this.iks=d||[],this._valid()}var a,d,v,g,C,w,_,x,b,A;function e(a,d){Object3D.call(this),this.root=a,this.iks=d||[],this.matrix.copy(a.matrixWorld),this.matrixAutoUpdate=!1,this.sphereGeometry=new SphereBufferGeometry(.25,16,8),this.targetSphereMaterial=new MeshBasicMaterial({color:new Color(16746632),depthTest:!1,depthWrite:!1,transparent:!0}),this.effectorSphereMaterial=new MeshBasicMaterial({color:new Color(8978312),depthTest:!1,depthWrite:!1,transparent:!0}),this.linkSphereMaterial=new MeshBasicMaterial({color:new Color(8947967),depthTest:!1,depthWrite:!1,transparent:!0}),this.lineMaterial=new LineBasicMaterial({color:new Color(16711680),depthTest:!1,depthWrite:!1,transparent:!0}),this._init()}return s.prototype={constructor:s,update:(a=new Quaternion,d=new Vector3,v=new Vector3,g=new Vector3,C=new Vector3,w=new Vector3,_=new Quaternion,x=new Vector3,b=new Vector3,A=new Vector3,function(){for(var R=this.mesh.skeleton.bones,O=this.iks,D=Math,F=0,L=O.length;F<L;F++){var I=O[F],V=R[I.effector];d.setFromMatrixPosition(R[I.target].matrixWorld);for(var H=I.links,X=void 0!==I.iteration?I.iteration:1,re=0;re<X;re++){for(var j=!1,te=0,J=H.length;te<J;te++){var k=R[H[te].index];if(!1===H[te].enabled)break;var U=H[te].limitation,K=H[te].rotationMin,ee=H[te].rotationMax;k.matrixWorld.decompose(w,_,x),_.inverse(),g.setFromMatrixPosition(V.matrixWorld),C.subVectors(g,w),C.applyQuaternion(_),C.normalize(),v.subVectors(d,w),v.applyQuaternion(_),v.normalize();var Q=v.dot(C);if(Q>1?Q=1:Q<-1&&(Q=-1),!((Q=D.acos(Q))<1e-5)){if(void 0!==I.minAngle&&Q<I.minAngle&&(Q=I.minAngle),void 0!==I.maxAngle&&Q>I.maxAngle&&(Q=I.maxAngle),b.crossVectors(C,v),b.normalize(),a.setFromAxisAngle(b,Q),k.quaternion.multiply(a),void 0!==U){var oe=k.quaternion.w;oe>1&&(oe=1);var me=D.sqrt(1-oe*oe);k.quaternion.set(U.x*me,U.y*me,U.z*me,oe)}void 0!==K&&k.rotation.setFromVector3(k.rotation.toVector3(A).max(K)),void 0!==ee&&k.rotation.setFromVector3(k.rotation.toVector3(A).min(ee)),k.updateMatrixWorld(!0),j=!0}}if(!j)break}}return this}),createHelper:function(){return new e(this.mesh,this.mesh.geometry.userData.MMD.iks)},_valid:function(){for(var d=this.iks,v=this.mesh.skeleton.bones,g=0,C=d.length;g<C;g++){var b,A,w=d[g],x=w.links;b=v[w.effector];for(var E=0,R=x.length;E<R;E++)b.parent!==(A=v[x[E].index])&&console.warn("CCDIKSolver: bone "+b.name+" is not the child of bone "+A.name),b=A}}},e.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:e,updateMatrixWorld:function(){var a=new Matrix4,d=new Vector3;function v(C,w){return d.setFromMatrixPosition(C.matrixWorld).applyMatrix4(w)}function g(C,w,_,x){var b=v(_,x);C[3*w+0]=b.x,C[3*w+1]=b.y,C[3*w+2]=b.z}return function(w){var _=this.root;if(this.visible){var x=0,b=this.iks,A=_.skeleton.bones;a.getInverse(_.matrixWorld);for(var E=0,R=b.length;E<R;E++){var O=b[E],D=A[O.target],F=A[O.effector],L=this.children[x++],I=this.children[x++];L.position.copy(v(D,a)),I.position.copy(v(F,a));for(var V=0,z=O.links.length;V<z;V++)this.children[x++].position.copy(v(A[O.links[V].index],a));var j=this.children[x++],te=j.geometry.attributes.position.array;for(g(te,0,D,a),g(te,1,F,a),V=0,z=O.links.length;V<z;V++)g(te,V+2,A[O.links[V].index],a);j.geometry.attributes.position.needsUpdate=!0}}this.matrix.copy(_.matrixWorld),Object3D.prototype.updateMatrixWorld.call(this,w)}}(),_init:function(){var d=this,v=this.iks;for(var b=0,A=v.length;b<A;b++){var E=v[b];this.add(new Mesh(d.sphereGeometry,d.targetSphereMaterial)),this.add(new Mesh(d.sphereGeometry,d.effectorSphereMaterial));for(var R=0,O=E.links.length;R<O;R++)this.add(new Mesh(d.sphereGeometry,d.linkSphereMaterial));this.add(new Line(function(D){var F=new BufferGeometry,L=new Float32Array(3*(2+D.links.length));return F.setAttribute("position",new BufferAttribute(L,3)),F}(E),d.lineMaterial))}}}),s}();function AnimationAction(s,e,a){this._mixer=s,this._clip=e,this._localRoot=a||null;for(var d=e.tracks,v=d.length,g=new Array(v),C={endingStart:ZeroCurvatureEnding,endingEnd:ZeroCurvatureEnding},w=0;w!==v;++w){var _=d[w].createInterpolant(null);g[w]=_,_.settings=C}this._interpolantSettings=C,this._interpolants=g,this._propertyBindings=new Array(v),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=LoopRepeat,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}Object.assign(AnimationAction.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,a){return this.loop=e,this.repetitions=a,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,a,d){if(e.fadeOut(a),this.fadeIn(a),d){var v=this._clip.duration,g=e._clip.duration,w=v/g;e.warp(1,g/v,a),this.warp(w,1,a)}return this},crossFadeTo:function(e,a,d){return e.crossFadeFrom(this,a,d)},stopFading:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,a,d){var v=this._mixer,g=v.time,C=this._timeScaleInterpolant,w=this.timeScale;null===C&&(C=v._lendControlInterpolant(),this._timeScaleInterpolant=C);var _=C.parameterPositions,x=C.sampleValues;return _[0]=g,_[1]=g+d,x[0]=e/w,x[1]=a/w,this},stopWarping:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,a,d,v){if(this.enabled){var g=this._startTime;if(null!==g){var C=(e-g)*d;if(C<0||0===d)return;this._startTime=null,a=d*C}a*=this._updateTimeScale(e);var w=this._updateTime(a),_=this._updateWeight(e);if(_>0)for(var x=this._interpolants,b=this._propertyBindings,A=0,E=x.length;A!==E;++A)x[A].evaluate(w),b[A].accumulate(v,_)}else this._updateWeight(e)},_updateWeight:function(e){var a=0;if(this.enabled){a=this.weight;var d=this._weightInterpolant;if(null!==d){var v=d.evaluate(e)[0];a*=v,e>d.parameterPositions[1]&&(this.stopFading(),0===v&&(this.enabled=!1))}}return this._effectiveWeight=a,a},_updateTimeScale:function(e){var a=0;if(!this.paused){a=this.timeScale;var d=this._timeScaleInterpolant;null!==d&&(a*=d.evaluate(e)[0],e>d.parameterPositions[1]&&(this.stopWarping(),0===a?this.paused=!0:this.timeScale=a))}return this._effectiveTimeScale=a,a},_updateTime:function(e){var a=this.time+e,d=this._clip.duration,v=this.loop,g=this._loopCount,C=v===LoopPingPong;if(0===e)return-1===g?a:C&&1==(1&g)?d-a:a;if(v===LoopOnce){-1===g&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(a>=d)a=d;else{if(!(a<0)){this.time=a;break e}a=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=a,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===g&&(e>=0?(g=0,this._setEndings(!0,0===this.repetitions,C)):this._setEndings(0===this.repetitions,!0,C)),a>=d||a<0){var w=Math.floor(a/d);a-=d*w,g+=Math.abs(w);var _=this.repetitions-g;if(_<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=a=e>0?d:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===_){var x=e<0;this._setEndings(x,!x,C)}else this._setEndings(!1,!1,C);this._loopCount=g,this.time=a,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:w})}}else this.time=a;if(C&&1==(1&g))return d-a}return a},_setEndings:function(e,a,d){var v=this._interpolantSettings;d?(v.endingStart=ZeroSlopeEnding,v.endingEnd=ZeroSlopeEnding):(v.endingStart=e?this.zeroSlopeAtStart?ZeroSlopeEnding:ZeroCurvatureEnding:WrapAroundEnding,v.endingEnd=a?this.zeroSlopeAtEnd?ZeroSlopeEnding:ZeroCurvatureEnding:WrapAroundEnding)},_scheduleFading:function(e,a,d){var v=this._mixer,g=v.time,C=this._weightInterpolant;null===C&&(C=v._lendControlInterpolant(),this._weightInterpolant=C);var w=C.parameterPositions,_=C.sampleValues;return w[0]=g,_[0]=a,w[1]=g+e,_[1]=d,this}});var _RESERVED_CHARS_RE="\\[\\]\\.:\\/",_reservedRe=new RegExp("["+_RESERVED_CHARS_RE+"]","g"),_wordChar="[^"+_RESERVED_CHARS_RE+"]",_wordCharOrDot="[^"+_RESERVED_CHARS_RE.replace("\\.","")+"]",_directoryRe=/((?:WC+[\/:])*)/.source.replace("WC",_wordChar),_nodeRe=/(WCOD+)?/.source.replace("WCOD",_wordCharOrDot),_objectRe=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",_wordChar),_propertyRe=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",_wordChar),_trackRe=new RegExp("^"+_directoryRe+_nodeRe+_objectRe+_propertyRe+"$"),_supportedObjectNames=["material","materials","bones"];function Composite(s,e,a){var d=a||PropertyBinding.parseTrackName(e);this._targetGroup=s,this._bindings=s.subscribe_(e,d)}function PropertyBinding(s,e,a){this.path=e,this.parsedPath=a||PropertyBinding.parseTrackName(e),this.node=PropertyBinding.findNode(s,this.parsedPath.nodeName)||s,this.rootNode=s}function PropertyMixer(s,e,a){this.binding=s,this.valueSize=a;var v,d=Float64Array;switch(e){case"quaternion":v=this._slerp;break;case"string":case"bool":d=Array,v=this._select;break;default:v=this._lerp}this.buffer=new d(4*a),this._mixBufferRegion=v,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function AnimationMixer(s){this._root=s,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function Bone(){Object3D.call(this),this.type="Bone"}Object.assign(Composite.prototype,{getValue:function(e,a){this.bind();var v=this._bindings[this._targetGroup.nCachedObjects_];void 0!==v&&v.getValue(e,a)},setValue:function(e,a){for(var d=this._bindings,v=this._targetGroup.nCachedObjects_,g=d.length;v!==g;++v)d[v].setValue(e,a)},bind:function(){for(var e=this._bindings,a=this._targetGroup.nCachedObjects_,d=e.length;a!==d;++a)e[a].bind()},unbind:function(){for(var e=this._bindings,a=this._targetGroup.nCachedObjects_,d=e.length;a!==d;++a)e[a].unbind()}}),Object.assign(PropertyBinding,{Composite:Composite,create:function(e,a,d){return e&&e.isAnimationObjectGroup?new PropertyBinding.Composite(e,a,d):new PropertyBinding(e,a,d)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(_reservedRe,"")},parseTrackName:function(e){var a=_trackRe.exec(e);if(!a)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var d={nodeName:a[2],objectName:a[3],objectIndex:a[4],propertyName:a[5],propertyIndex:a[6]},v=d.nodeName&&d.nodeName.lastIndexOf(".");if(void 0!==v&&-1!==v){var g=d.nodeName.substring(v+1);-1!==_supportedObjectNames.indexOf(g)&&(d.nodeName=d.nodeName.substring(0,v),d.objectName=g)}if(null===d.propertyName||0===d.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return d},findNode:function(e,a){if(!a||""===a||"root"===a||"."===a||-1===a||a===e.name||a===e.uuid)return e;if(e.skeleton){var d=e.skeleton.getBoneByName(a);if(void 0!==d)return d}if(e.children){var g=function C(w){for(var _=0;_<w.length;_++){var x=w[_];if(x.name===a||x.uuid===a)return x;var b=C(x.children);if(b)return b}return null}(e.children);if(g)return g}return null}}),Object.assign(PropertyBinding.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,a){e[a]=this.node[this.propertyName]},function(e,a){for(var d=this.resolvedProperty,v=0,g=d.length;v!==g;++v)e[a++]=d[v]},function(e,a){e[a]=this.resolvedProperty[this.propertyIndex]},function(e,a){this.resolvedProperty.toArray(e,a)}],SetterByBindingTypeAndVersioning:[[function(e,a){this.targetObject[this.propertyName]=e[a]},function(e,a){this.targetObject[this.propertyName]=e[a],this.targetObject.needsUpdate=!0},function(e,a){this.targetObject[this.propertyName]=e[a],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,a){for(var d=this.resolvedProperty,v=0,g=d.length;v!==g;++v)d[v]=e[a++]},function(e,a){for(var d=this.resolvedProperty,v=0,g=d.length;v!==g;++v)d[v]=e[a++];this.targetObject.needsUpdate=!0},function(e,a){for(var d=this.resolvedProperty,v=0,g=d.length;v!==g;++v)d[v]=e[a++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,a){this.resolvedProperty[this.propertyIndex]=e[a]},function(e,a){this.resolvedProperty[this.propertyIndex]=e[a],this.targetObject.needsUpdate=!0},function(e,a){this.resolvedProperty[this.propertyIndex]=e[a],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,a){this.resolvedProperty.fromArray(e,a)},function(e,a){this.resolvedProperty.fromArray(e,a),this.targetObject.needsUpdate=!0},function(e,a){this.resolvedProperty.fromArray(e,a),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,a){this.bind(),this.getValue(e,a)},setValue:function(e,a){this.bind(),this.setValue(e,a)},bind:function(){var e=this.node,a=this.parsedPath,d=a.objectName,v=a.propertyName,g=a.propertyIndex;if(e||(e=PropertyBinding.findNode(this.rootNode,a.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(d){var C=a.objectIndex;switch(d){case"materials":if(!e.material)return void console.error("PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var w=0;w<e.length;w++)if(e[w].name===C){C=w;break}break;default:if(void 0===e[d])return void console.error("PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[d]}if(void 0!==C){if(void 0===e[C])return void console.error("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[C]}}var _=e[v];if(void 0!==_){var b=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?b=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(b=this.Versioning.MatrixWorldNeedsUpdate);var A=this.BindingType.Direct;if(void 0!==g){if("morphTargetInfluences"===v){if(!e.geometry)return void console.error("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes)return void console.error("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(w=0;w<this.node.geometry.morphAttributes.position.length;w++)if(e.geometry.morphAttributes.position[w].name===g){g=w;break}}else{if(!e.geometry.morphTargets)return void console.error("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(w=0;w<this.node.geometry.morphTargets.length;w++)if(e.geometry.morphTargets[w].name===g){g=w;break}}}A=this.BindingType.ArrayElement,this.resolvedProperty=_,this.propertyIndex=g}else void 0!==_.fromArray&&void 0!==_.toArray?(A=this.BindingType.HasFromToArray,this.resolvedProperty=_):Array.isArray(_)?(A=this.BindingType.EntireArray,this.resolvedProperty=_):this.propertyName=v;this.getValue=this.GetterByBindingType[A],this.setValue=this.SetterByBindingTypeAndVersioning[A][b]}else console.error("PropertyBinding: Trying to update property for track: "+a.nodeName+"."+v+" but it wasn't found.",e)}else console.error("PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(PropertyBinding.prototype,{_getValue_unbound:PropertyBinding.prototype.getValue,_setValue_unbound:PropertyBinding.prototype.setValue}),Object.assign(PropertyMixer.prototype,{accumulate:function(e,a){var d=this.buffer,v=this.valueSize,g=e*v+v,C=this.cumulativeWeight;if(0===C){for(var w=0;w!==v;++w)d[g+w]=d[w];C=a}else this._mixBufferRegion(d,g,0,a/(C+=a),v);this.cumulativeWeight=C},apply:function(e){var a=this.valueSize,d=this.buffer,v=e*a+a,g=this.cumulativeWeight,C=this.binding;this.cumulativeWeight=0,g<1&&this._mixBufferRegion(d,v,3*a,1-g,a);for(var _=a,x=a+a;_!==x;++_)if(d[_]!==d[_+a]){C.setValue(d,v);break}},saveOriginalState:function(){var a=this.buffer,d=this.valueSize,v=3*d;this.binding.getValue(a,v);for(var g=d,C=v;g!==C;++g)a[g]=a[v+g%d];this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_select:function(e,a,d,v,g){if(v>=.5)for(var C=0;C!==g;++C)e[a+C]=e[d+C]},_slerp:function(e,a,d,v){Quaternion.slerpFlat(e,a,e,a,e,d,v)},_lerp:function(e,a,d,v,g){for(var C=1-v,w=0;w!==g;++w){var _=a+w;e[_]=e[_]*C+e[d+w]*v}}}),AnimationMixer.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:AnimationMixer,_bindAction:function(e,a){var d=e._localRoot||this._root,v=e._clip.tracks,g=v.length,C=e._propertyBindings,w=e._interpolants,_=d.uuid,x=this._bindingsByRootAndName,b=x[_];void 0===b&&(x[_]=b={});for(var A=0;A!==g;++A){var E=v[A],R=E.name,O=b[R];if(void 0!==O)C[A]=O;else{if(void 0!==(O=C[A])){null===O._cacheIndex&&(++O.referenceCount,this._addInactiveBinding(O,_,R));continue}++(O=new PropertyMixer(PropertyBinding.create(d,R,a&&a._propertyBindings[A].binding.parsedPath),E.ValueTypeName,E.getValueSize())).referenceCount,this._addInactiveBinding(O,_,R),C[A]=O}w[A].resultBuffer=O.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var a=(e._localRoot||this._root).uuid,d=e._clip.uuid,v=this._actionsByClip[d];this._bindAction(e,v&&v.knownActions[0]),this._addInactiveAction(e,d,a)}for(var g=e._propertyBindings,C=0,w=g.length;C!==w;++C){var _=g[C];0==_.useCount++&&(this._lendBinding(_),_.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var a=e._propertyBindings,d=0,v=a.length;d!==v;++d){var g=a[d];0==--g.useCount&&(g.restoreOriginalState(),this._takeBackBinding(g))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){var a=e._cacheIndex;return null!==a&&a<this._nActiveActions},_addInactiveAction:function(e,a,d){var v=this._actions,g=this._actionsByClip,C=g[a];if(void 0===C)C={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,g[a]=C;else{var w=C.knownActions;e._byClipCacheIndex=w.length,w.push(e)}e._cacheIndex=v.length,v.push(e),C.actionByRoot[d]=e},_removeInactiveAction:function(e){var a=this._actions,d=a[a.length-1],v=e._cacheIndex;d._cacheIndex=v,a[v]=d,a.pop(),e._cacheIndex=null;var g=e._clip.uuid,C=this._actionsByClip,w=C[g],_=w.knownActions,x=_[_.length-1],b=e._byClipCacheIndex;x._byClipCacheIndex=b,_[b]=x,_.pop(),e._byClipCacheIndex=null,delete w.actionByRoot[(e._localRoot||this._root).uuid],0===_.length&&delete C[g],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){for(var a=e._propertyBindings,d=0,v=a.length;d!==v;++d){var g=a[d];0==--g.referenceCount&&this._removeInactiveBinding(g)}},_lendAction:function(e){var a=this._actions,d=e._cacheIndex,v=this._nActiveActions++,g=a[v];e._cacheIndex=v,a[v]=e,g._cacheIndex=d,a[d]=g},_takeBackAction:function(e){var a=this._actions,d=e._cacheIndex,v=--this._nActiveActions,g=a[v];e._cacheIndex=v,a[v]=e,g._cacheIndex=d,a[d]=g},_addInactiveBinding:function(e,a,d){var v=this._bindingsByRootAndName,g=v[a],C=this._bindings;void 0===g&&(v[a]=g={}),g[d]=e,e._cacheIndex=C.length,C.push(e)},_removeInactiveBinding:function(e){var a=this._bindings,d=e.binding,v=d.rootNode.uuid,g=d.path,C=this._bindingsByRootAndName,w=C[v],_=a[a.length-1],x=e._cacheIndex;_._cacheIndex=x,a[x]=_,a.pop(),delete w[g],0===Object.keys(w).length&&delete C[v]},_lendBinding:function(e){var a=this._bindings,d=e._cacheIndex,v=this._nActiveBindings++,g=a[v];e._cacheIndex=v,a[v]=e,g._cacheIndex=d,a[d]=g},_takeBackBinding:function(e){var a=this._bindings,d=e._cacheIndex,v=--this._nActiveBindings,g=a[v];e._cacheIndex=v,a[v]=e,g._cacheIndex=d,a[d]=g},_lendControlInterpolant:function(){var e=this._controlInterpolants,a=this._nActiveControlInterpolants++,d=e[a];return void 0===d&&((d=new LinearInterpolant(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=a,e[a]=d),d},_takeBackControlInterpolant:function(e){var a=this._controlInterpolants,d=e.__cacheIndex,v=--this._nActiveControlInterpolants,g=a[v];e.__cacheIndex=v,a[v]=e,g.__cacheIndex=d,a[d]=g},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,a){var d=a||this._root,v=d.uuid,g="string"==typeof e?AnimationClip.findByName(d,e):e,C=null!==g?g.uuid:e,w=this._actionsByClip[C],_=null;if(void 0!==w){var x=w.actionByRoot[v];if(void 0!==x)return x;_=w.knownActions[0],null===g&&(g=_._clip)}if(null===g)return null;var b=new AnimationAction(this,g,a);return this._bindAction(b,_),this._addInactiveAction(b,C,v),b},existingAction:function(e,a){var d=a||this._root,v=d.uuid,g="string"==typeof e?AnimationClip.findByName(d,e):e,w=this._actionsByClip[g?g.uuid:e];return void 0!==w&&w.actionByRoot[v]||null},stopAllAction:function(){var e=this._actions,a=this._nActiveActions,d=this._bindings,v=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var g=0;g!==a;++g)e[g].reset();for(g=0;g!==v;++g)d[g].useCount=0;return this},update:function(e){for(var a=this._actions,d=this._nActiveActions,v=this.time+=e*=this.timeScale,g=Math.sign(e),C=this._accuIndex^=1,w=0;w!==d;++w)a[w]._update(v,e,g,C);var x=this._bindings,b=this._nActiveBindings;for(w=0;w!==b;++w)x[w].apply(C);return this},setTime:function(e){this.time=0;for(var a=0;a<this._actions.length;a++)this._actions[a].time=0;return this.update(e)},getRoot:function(){return this._root},uncacheClip:function(e){var a=this._actions,d=e.uuid,v=this._actionsByClip,g=v[d];if(void 0!==g){for(var C=g.knownActions,w=0,_=C.length;w!==_;++w){var x=C[w];this._deactivateAction(x);var b=x._cacheIndex,A=a[a.length-1];x._cacheIndex=null,x._byClipCacheIndex=null,A._cacheIndex=b,a[b]=A,a.pop(),this._removeInactiveBindingsForAction(x)}delete v[d]}},uncacheRoot:function(e){var a=e.uuid,d=this._actionsByClip;for(var v in d){var C=d[v].actionByRoot[a];void 0!==C&&(this._deactivateAction(C),this._removeInactiveAction(C))}var _=this._bindingsByRootAndName[a];if(void 0!==_)for(var x in _){var b=_[x];b.restoreOriginalState(),this._removeInactiveBinding(b)}},uncacheAction:function(e,a){var d=this.existingAction(e,a);null!==d&&(this._deactivateAction(d),this._removeInactiveAction(d))}}),Bone.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Bone,isBone:!0});var BoxGeometry=function(s){function e(a,d,v,g,C,w){s.call(this),this.type="BoxGeometry",this.parameters={width:a,height:d,depth:v,widthSegments:g,heightSegments:C,depthSegments:w},this.fromBufferGeometry(new BoxBufferGeometry(a,d,v,g,C,w)),this.mergeVertices()}return s&&(e.__proto__=s),(e.prototype=Object.create(s&&s.prototype)).constructor=e,e}(Geometry),BoxBufferGeometry=function(s){function e(a,d,v,g,C,w){s.call(this),this.type="BoxBufferGeometry",this.parameters={width:a,height:d,depth:v,widthSegments:g,heightSegments:C,depthSegments:w};var _=this;a=a||1,d=d||1,v=v||1,g=Math.floor(g)||1,C=Math.floor(C)||1,w=Math.floor(w)||1;var x=[],b=[],A=[],E=[],R=0,O=0;function D(F,L,I,V,z,H,X,re,j,te,J){var $,ue,k=H/j,U=X/te,K=H/2,ee=X/2,Q=re/2,oe=j+1,me=te+1,fe=0,ge=0,Y=new Vector3;for(ue=0;ue<me;ue++){var Z=ue*U-ee;for($=0;$<oe;$++)Y[F]=($*k-K)*V,Y[L]=Z*z,Y[I]=Q,b.push(Y.x,Y.y,Y.z),Y[F]=0,Y[L]=0,Y[I]=re>0?1:-1,A.push(Y.x,Y.y,Y.z),E.push($/j),E.push(1-ue/te),fe+=1}for(ue=0;ue<te;ue++)for($=0;$<j;$++){var le=R+$+oe*(ue+1),_e=R+($+1)+oe*(ue+1),ae=R+($+1)+oe*ue;x.push(R+$+oe*ue,le,ae),x.push(le,_e,ae),ge+=6}_.addGroup(O,ge,J),O+=ge,R+=fe}D("z","y","x",-1,-1,v,d,a,w,C,0),D("z","y","x",1,-1,v,d,-a,w,C,1),D("x","z","y",1,1,a,v,d,g,w,2),D("x","z","y",1,-1,a,v,-d,g,w,3),D("x","y","z",1,-1,a,d,v,g,C,4),D("x","y","z",-1,-1,a,d,-v,g,C,5),this.setIndex(x),this.setAttribute("position",new Float32BufferAttribute(b,3)),this.setAttribute("normal",new Float32BufferAttribute(A,3)),this.setAttribute("uv",new Float32BufferAttribute(E,2))}return s&&(e.__proto__=s),(e.prototype=Object.create(s&&s.prototype)).constructor=e,e}(BufferGeometry);function CylinderGeometry(s,e,a,d,v,g,C,w){Geometry.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:s,radiusBottom:e,height:a,radialSegments:d,heightSegments:v,openEnded:g,thetaStart:C,thetaLength:w},this.fromBufferGeometry(new CylinderBufferGeometry(s,e,a,d,v,g,C,w)),this.mergeVertices()}function CylinderBufferGeometry(s,e,a,d,v,g,C,w){BufferGeometry.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:s,radiusBottom:e,height:a,radialSegments:d,heightSegments:v,openEnded:g,thetaStart:C,thetaLength:w};var _=this;s=void 0!==s?s:1,e=void 0!==e?e:1,a=a||1,d=Math.floor(d)||8,v=Math.floor(v)||1,g=void 0!==g&&g,C=void 0!==C?C:0,w=void 0!==w?w:2*Math.PI;var x=[],b=[],A=[],E=[],R=0,O=[],D=a/2,F=0;function I(V){var z,H,X,re=new Vector2,j=new Vector3,te=0,J=!0===V?s:e,k=!0===V?1:-1;for(H=R,z=1;z<=d;z++)b.push(0,D*k,0),A.push(0,k,0),E.push(.5,.5),R++;for(X=R,z=0;z<=d;z++){var K=z/d*w+C,ee=Math.cos(K),Q=Math.sin(K);j.x=J*Q,j.y=D*k,j.z=J*ee,b.push(j.x,j.y,j.z),A.push(0,k,0),re.x=.5*ee+.5,re.y=.5*Q*k+.5,E.push(re.x,re.y),R++}for(z=0;z<d;z++){var oe=H+z,me=X+z;!0===V?x.push(me,me+1,oe):x.push(me+1,me,oe),te+=3}_.addGroup(F,te,!0===V?1:2),F+=te}(function(){var V,z,H=new Vector3,X=new Vector3,re=0,j=(e-s)/a;for(z=0;z<=v;z++){var te=[],J=z/v,k=J*(e-s)+s;for(V=0;V<=d;V++){var U=V/d,K=U*w+C,ee=Math.sin(K),Q=Math.cos(K);X.x=k*ee,X.y=-J*a+D,X.z=k*Q,b.push(X.x,X.y,X.z),H.set(ee,j,Q).normalize(),A.push(H.x,H.y,H.z),E.push(U,1-J),te.push(R++)}O.push(te)}for(V=0;V<d;V++)for(z=0;z<v;z++){var me=O[z+1][V],fe=O[z+1][V+1],ge=O[z][V+1];x.push(O[z][V],me,ge),x.push(me,fe,ge),re+=6}_.addGroup(F,re,0),F+=re})(),!1===g&&(s>0&&I(!0),e>0&&I(!1)),this.setIndex(x),this.setAttribute("position",new Float32BufferAttribute(b,3)),this.setAttribute("normal",new Float32BufferAttribute(A,3)),this.setAttribute("uv",new Float32BufferAttribute(E,2))}CylinderGeometry.prototype=Object.create(Geometry.prototype),CylinderGeometry.prototype.constructor=CylinderGeometry,CylinderBufferGeometry.prototype=Object.create(BufferGeometry.prototype),CylinderBufferGeometry.prototype.constructor=CylinderBufferGeometry;var MMDPhysics=function(){function s(g,C,w,_){if("undefined"==typeof Ammo)throw new Error("MMDPhysics: Import ammo.js https://github.com/kripken/ammo.js");w=w||[],_=_||{},this.manager=new e,this.mesh=g,this.unitStep=void 0!==_.unitStep?_.unitStep:1/65,this.maxStepNum=void 0!==_.maxStepNum?_.maxStepNum:3,this.gravity=new Vector3(0,-98,0),void 0!==_.gravity&&this.gravity.copy(_.gravity),this.world=void 0!==_.world?_.world:null,this.bodies=[],this.constraints=[],this._init(g,C,w)}function e(){this.threeVector3s=[],this.threeMatrix4s=[],this.threeQuaternions=[],this.threeEulers=[],this.transforms=[],this.quaternions=[],this.vector3s=[]}function a(g,C,w,_){this.mesh=g,this.world=C,this.params=w,this.manager=_,this.body=null,this.bone=null,this.boneOffsetForm=null,this.boneOffsetFormInverse=null,this._init()}function d(g,C,w,_,x,b){this.mesh=g,this.world=C,this.bodyA=w,this.bodyB=_,this.params=x,this.manager=b,this.constraint=null,this._init()}function v(g,C){Object3D.call(this),this.root=g,this.physics=C,this.matrix.copy(g.matrixWorld),this.matrixAutoUpdate=!1,this.materials=[],this.materials.push(new MeshBasicMaterial({color:new Color(16746632),wireframe:!0,depthTest:!1,depthWrite:!1,opacity:.25,transparent:!0})),this.materials.push(new MeshBasicMaterial({color:new Color(8978312),wireframe:!0,depthTest:!1,depthWrite:!1,opacity:.25,transparent:!0})),this.materials.push(new MeshBasicMaterial({color:new Color(8947967),wireframe:!0,depthTest:!1,depthWrite:!1,opacity:.25,transparent:!0})),this._init()}return s.prototype={constructor:s,update:function(C){var R,w=this.manager,_=this.mesh,x=!1,b=w.allocThreeVector3(),A=w.allocThreeQuaternion(),E=w.allocThreeVector3();return _.matrixWorld.decompose(b,A,E),(1!==E.x||1!==E.y||1!==E.z)&&(x=!0),x&&(null!==(R=_.parent)&&(_.parent=null),E.copy(this.mesh.scale),_.scale.set(1,1,1),_.updateMatrixWorld(!0)),this._updateRigidBodies(),this._stepSimulation(C),this._updateBones(),x&&(null!==R&&(_.parent=R),_.scale.copy(E)),w.freeThreeVector3(E),w.freeThreeQuaternion(A),w.freeThreeVector3(b),this},reset:function(){for(var C=0,w=this.bodies.length;C<w;C++)this.bodies[C].reset();return this},warmup:function(C){for(var w=0;w<C;w++)this.update(1/60);return this},setGravity:function(C){return this.world.setGravity(new Ammo.btVector3(C.x,C.y,C.z)),this.gravity.copy(C),this},createHelper:function(){return new v(this.mesh,this)},_init:function(C,w,_){var x=this.manager,b=C.parent;null!==b&&(b=null);var A=x.allocThreeVector3(),E=x.allocThreeQuaternion(),R=x.allocThreeVector3();A.copy(C.position),E.copy(C.quaternion),R.copy(C.scale),C.position.set(0,0,0),C.quaternion.set(0,0,0,1),C.scale.set(1,1,1),C.updateMatrixWorld(!0),null===this.world&&(this.world=this._createWorld(),this.setGravity(this.gravity)),this._initRigidBodies(w),this._initConstraints(_),null!==b&&(C.parent=b),C.position.copy(A),C.quaternion.copy(E),C.scale.copy(R),C.updateMatrixWorld(!0),this.reset(),x.freeThreeVector3(A),x.freeThreeQuaternion(E),x.freeThreeVector3(R)},_createWorld:function(){var C=new Ammo.btDefaultCollisionConfiguration,w=new Ammo.btCollisionDispatcher(C),_=new Ammo.btDbvtBroadphase,x=new Ammo.btSequentialImpulseConstraintSolver;return new Ammo.btDiscreteDynamicsWorld(w,_,x,C)},_initRigidBodies:function(C){for(var w=0,_=C.length;w<_;w++)this.bodies.push(new a(this.mesh,this.world,C[w],this.manager))},_initConstraints:function(C){for(var w=0,_=C.length;w<_;w++){var x=C[w];this.constraints.push(new d(this.mesh,this.world,this.bodies[x.rigidBodyIndex1],this.bodies[x.rigidBodyIndex2],x,this.manager))}},_stepSimulation:function(C){var w=this.unitStep,_=C,x=1+(C/w|0);_<w&&(_=w,x=1),x>this.maxStepNum&&(x=this.maxStepNum),this.world.stepSimulation(_,x,w)},_updateRigidBodies:function(){for(var C=0,w=this.bodies.length;C<w;C++)this.bodies[C].updateFromBone()},_updateBones:function(){for(var C=0,w=this.bodies.length;C<w;C++)this.bodies[C].updateBone()}},e.prototype={constructor:e,allocThreeVector3:function(){return this.threeVector3s.length>0?this.threeVector3s.pop():new Vector3},freeThreeVector3:function(C){this.threeVector3s.push(C)},allocThreeMatrix4:function(){return this.threeMatrix4s.length>0?this.threeMatrix4s.pop():new Matrix4},freeThreeMatrix4:function(C){this.threeMatrix4s.push(C)},allocThreeQuaternion:function(){return this.threeQuaternions.length>0?this.threeQuaternions.pop():new Quaternion},freeThreeQuaternion:function(C){this.threeQuaternions.push(C)},allocThreeEuler:function(){return this.threeEulers.length>0?this.threeEulers.pop():new Euler},freeThreeEuler:function(C){this.threeEulers.push(C)},allocTransform:function(){return this.transforms.length>0?this.transforms.pop():new Ammo.btTransform},freeTransform:function(C){this.transforms.push(C)},allocQuaternion:function(){return this.quaternions.length>0?this.quaternions.pop():new Ammo.btQuaternion},freeQuaternion:function(C){this.quaternions.push(C)},allocVector3:function(){return this.vector3s.length>0?this.vector3s.pop():new Ammo.btVector3},freeVector3:function(C){this.vector3s.push(C)},setIdentity:function(C){C.setIdentity()},getBasis:function(C){var w=this.allocQuaternion();return C.getBasis().getRotation(w),w},getBasisAsMatrix3:function(C){var w=this.getBasis(C),_=this.quaternionToMatrix3(w);return this.freeQuaternion(w),_},getOrigin:function(C){return C.getOrigin()},setOrigin:function(C,w){C.getOrigin().setValue(w.x(),w.y(),w.z())},copyOrigin:function(C,w){var _=w.getOrigin();this.setOrigin(C,_)},setBasis:function(C,w){C.setRotation(w)},setBasisFromMatrix3:function(C,w){var _=this.matrix3ToQuaternion(w);this.setBasis(C,_),this.freeQuaternion(_)},setOriginFromArray3:function(C,w){C.getOrigin().setValue(w[0],w[1],w[2])},setOriginFromThreeVector3:function(C,w){C.getOrigin().setValue(w.x,w.y,w.z)},setBasisFromArray3:function(C,w){var _=this.allocThreeQuaternion(),x=this.allocThreeEuler();x.set(w[0],w[1],w[2]),this.setBasisFromThreeQuaternion(C,_.setFromEuler(x)),this.freeThreeEuler(x),this.freeThreeQuaternion(_)},setBasisFromThreeQuaternion:function(C,w){var _=this.allocQuaternion();_.setX(w.x),_.setY(w.y),_.setZ(w.z),_.setW(w.w),this.setBasis(C,_),this.freeQuaternion(_)},multiplyTransforms:function(C,w){var _=this.allocTransform();this.setIdentity(_);var x=this.getBasisAsMatrix3(C),b=this.getBasisAsMatrix3(w),A=this.getOrigin(C),E=this.getOrigin(w),R=this.multiplyMatrix3ByVector3(x,E),O=this.addVector3(R,A);this.setOrigin(_,O);var D=this.multiplyMatrices3(x,b);return this.setBasisFromMatrix3(_,D),this.freeVector3(R),this.freeVector3(O),_},inverseTransform:function(C){var w=this.allocTransform(),_=this.getBasisAsMatrix3(C),x=this.getOrigin(C),b=this.transposeMatrix3(_),A=this.negativeVector3(x),E=this.multiplyMatrix3ByVector3(b,A);return this.setOrigin(w,E),this.setBasisFromMatrix3(w,b),this.freeVector3(A),this.freeVector3(E),w},multiplyMatrices3:function(C,w){var _=[],x=this.rowOfMatrix3(C,0),b=this.rowOfMatrix3(C,1),A=this.rowOfMatrix3(C,2),E=this.columnOfMatrix3(w,0),R=this.columnOfMatrix3(w,1),O=this.columnOfMatrix3(w,2);return _[0]=this.dotVectors3(x,E),_[1]=this.dotVectors3(x,R),_[2]=this.dotVectors3(x,O),_[3]=this.dotVectors3(b,E),_[4]=this.dotVectors3(b,R),_[5]=this.dotVectors3(b,O),_[6]=this.dotVectors3(A,E),_[7]=this.dotVectors3(A,R),_[8]=this.dotVectors3(A,O),this.freeVector3(x),this.freeVector3(b),this.freeVector3(A),this.freeVector3(E),this.freeVector3(R),this.freeVector3(O),_},addVector3:function(C,w){var _=this.allocVector3();return _.setValue(C.x()+w.x(),C.y()+w.y(),C.z()+w.z()),_},dotVectors3:function(C,w){return C.x()*w.x()+C.y()*w.y()+C.z()*w.z()},rowOfMatrix3:function(C,w){var _=this.allocVector3();return _.setValue(C[3*w+0],C[3*w+1],C[3*w+2]),_},columnOfMatrix3:function(C,w){var _=this.allocVector3();return _.setValue(C[w+0],C[w+3],C[w+6]),_},negativeVector3:function(C){var w=this.allocVector3();return w.setValue(-C.x(),-C.y(),-C.z()),w},multiplyMatrix3ByVector3:function(C,w){var _=this.allocVector3(),x=this.rowOfMatrix3(C,0),b=this.rowOfMatrix3(C,1),A=this.rowOfMatrix3(C,2),E=this.dotVectors3(x,w),R=this.dotVectors3(b,w),O=this.dotVectors3(A,w);return _.setValue(E,R,O),this.freeVector3(x),this.freeVector3(b),this.freeVector3(A),_},transposeMatrix3:function(C){var w=[];return w[0]=C[0],w[1]=C[3],w[2]=C[6],w[3]=C[1],w[4]=C[4],w[5]=C[7],w[6]=C[2],w[7]=C[5],w[8]=C[8],w},quaternionToMatrix3:function(C){var w=[],_=C.x(),x=C.y(),b=C.z(),A=C.w(),E=_*_,R=x*x,O=b*b,D=_*x,F=x*b,L=b*_,I=_*A,V=x*A,z=b*A;return w[0]=1-2*(R+O),w[1]=2*(D-z),w[2]=2*(L+V),w[3]=2*(D+z),w[4]=1-2*(O+E),w[5]=2*(F-I),w[6]=2*(L-V),w[7]=2*(F+I),w[8]=1-2*(E+R),w},matrix3ToQuaternion:function(C){var _,x,b,A,E,w=C[0]+C[4]+C[8];w>0?(E=.25*(_=2*Math.sqrt(w+1)),x=(C[7]-C[5])/_,b=(C[2]-C[6])/_,A=(C[3]-C[1])/_):C[0]>C[4]&&C[0]>C[8]?(_=2*Math.sqrt(1+C[0]-C[4]-C[8]),E=(C[7]-C[5])/_,x=.25*_,b=(C[1]+C[3])/_,A=(C[2]+C[6])/_):C[4]>C[8]?(_=2*Math.sqrt(1+C[4]-C[0]-C[8]),E=(C[2]-C[6])/_,x=(C[1]+C[3])/_,b=.25*_,A=(C[5]+C[7])/_):(_=2*Math.sqrt(1+C[8]-C[0]-C[4]),E=(C[3]-C[1])/_,x=(C[2]+C[6])/_,b=(C[5]+C[7])/_,A=.25*_);var R=this.allocQuaternion();return R.setX(x),R.setY(b),R.setZ(A),R.setW(E),R}},a.prototype={constructor:s.RigidBody,reset:function(){return this._setTransformFromBone(),this},updateFromBone:function(){return-1!==this.params.boneIndex&&0===this.params.type&&this._setTransformFromBone(),this},updateBone:function(){return 0===this.params.type||-1===this.params.boneIndex||(this._updateBoneRotation(),1===this.params.type&&this._updateBonePosition(),this.bone.updateMatrixWorld(!0),2===this.params.type&&this._setPositionFromBone()),this},_init:function(){var w=this.manager,_=this.params,x=this.mesh.skeleton.bones,b=-1===_.boneIndex?new Bone:x[_.boneIndex],A=function(H){switch(H.shapeType){case 0:return new Ammo.btSphereShape(H.width);case 1:return new Ammo.btBoxShape(new Ammo.btVector3(H.width,H.height,H.depth));case 2:return new Ammo.btCapsuleShape(H.width,H.height);default:throw"unknown shape type "+H.shapeType}}(_),E=0===_.type?0:_.weight,R=w.allocVector3();R.setValue(0,0,0),0!==E&&A.calculateLocalInertia(E,R);var O=w.allocTransform();w.setIdentity(O),w.setOriginFromArray3(O,_.position),w.setBasisFromArray3(O,_.rotation);var D=w.allocThreeVector3(),F=w.allocTransform();w.setIdentity(F),w.setOriginFromThreeVector3(F,b.getWorldPosition(D));var L=w.multiplyTransforms(F,O),I=new Ammo.btDefaultMotionState(L),V=new Ammo.btRigidBodyConstructionInfo(E,I,A,R);V.set_m_friction(_.friction),V.set_m_restitution(_.restitution);var z=new Ammo.btRigidBody(V);0===_.type&&(z.setCollisionFlags(2|z.getCollisionFlags()),z.setActivationState(4)),z.setDamping(_.positionDamping,_.rotationDamping),z.setSleepingThresholds(0,0),this.world.addRigidBody(z,1<<_.groupIndex,_.groupTarget),this.body=z,this.bone=b,this.boneOffsetForm=O,this.boneOffsetFormInverse=w.inverseTransform(O),w.freeVector3(R),w.freeTransform(L),w.freeTransform(F),w.freeThreeVector3(D)},_getBoneTransform:function(){var C=this.manager,w=C.allocThreeVector3(),_=C.allocThreeQuaternion(),x=C.allocThreeVector3();this.bone.matrixWorld.decompose(w,_,x);var b=C.allocTransform();C.setOriginFromThreeVector3(b,w),C.setBasisFromThreeQuaternion(b,_);var A=C.multiplyTransforms(b,this.boneOffsetForm);return C.freeTransform(b),C.freeThreeVector3(x),C.freeThreeQuaternion(_),C.freeThreeVector3(w),A},_getWorldTransformForBone:function(){var C=this.manager,w=this.body.getCenterOfMassTransform();return C.multiplyTransforms(w,this.boneOffsetFormInverse)},_setTransformFromBone:function(){var C=this.manager,w=this._getBoneTransform();this.body.setCenterOfMassTransform(w),this.body.getMotionState().setWorldTransform(w),C.freeTransform(w)},_setPositionFromBone:function(){var C=this.manager,w=this._getBoneTransform(),_=C.allocTransform();this.body.getMotionState().getWorldTransform(_),C.copyOrigin(_,w),this.body.setCenterOfMassTransform(_),this.body.getMotionState().setWorldTransform(_),C.freeTransform(_),C.freeTransform(w)},_updateBoneRotation:function(){var C=this.manager,w=this._getWorldTransformForBone(),_=C.getBasis(w),x=C.allocThreeQuaternion(),b=C.allocThreeQuaternion(),A=C.allocThreeQuaternion();x.set(_.x(),_.y(),_.z(),_.w()),b.setFromRotationMatrix(this.bone.matrixWorld),b.conjugate(),b.multiply(x),A.setFromRotationMatrix(this.bone.matrix),this.bone.quaternion.copy(b.multiply(A).normalize()),C.freeThreeQuaternion(x),C.freeThreeQuaternion(b),C.freeThreeQuaternion(A),C.freeQuaternion(_),C.freeTransform(w)},_updateBonePosition:function(){var C=this.manager,w=this._getWorldTransformForBone(),_=C.allocThreeVector3(),x=C.getOrigin(w);_.set(x.x(),x.y(),x.z()),this.bone.parent&&this.bone.parent.worldToLocal(_),this.bone.position.copy(_),C.freeThreeVector3(_),C.freeTransform(w)}},d.prototype={constructor:d,_init:function(){var C=this.manager,w=this.params,_=this.bodyA,x=this.bodyB,b=C.allocTransform();C.setIdentity(b),C.setOriginFromArray3(b,w.position),C.setBasisFromArray3(b,w.rotation);var A=C.allocTransform(),E=C.allocTransform();_.body.getMotionState().getWorldTransform(A),x.body.getMotionState().getWorldTransform(E);var R=C.inverseTransform(A),O=C.inverseTransform(E),D=C.multiplyTransforms(R,b),F=C.multiplyTransforms(O,b),L=new Ammo.btGeneric6DofSpringConstraint(_.body,x.body,D,F,!0),I=C.allocVector3(),V=C.allocVector3(),z=C.allocVector3(),H=C.allocVector3();I.setValue(w.translationLimitation1[0],w.translationLimitation1[1],w.translationLimitation1[2]),V.setValue(w.translationLimitation2[0],w.translationLimitation2[1],w.translationLimitation2[2]),z.setValue(w.rotationLimitation1[0],w.rotationLimitation1[1],w.rotationLimitation1[2]),H.setValue(w.rotationLimitation2[0],w.rotationLimitation2[1],w.rotationLimitation2[2]),L.setLinearLowerLimit(I),L.setLinearUpperLimit(V),L.setAngularLowerLimit(z),L.setAngularUpperLimit(H);for(var X=0;X<3;X++)0!==w.springPosition[X]&&(L.enableSpring(X,!0),L.setStiffness(X,w.springPosition[X]));for(X=0;X<3;X++)0!==w.springRotation[X]&&(L.enableSpring(X+3,!0),L.setStiffness(X+3,w.springRotation[X]));if(void 0!==L.setParam)for(X=0;X<6;X++)L.setParam(2,.475,X);this.world.addConstraint(L,!0),this.constraint=L,C.freeTransform(b),C.freeTransform(A),C.freeTransform(E),C.freeTransform(R),C.freeTransform(O),C.freeTransform(D),C.freeTransform(F),C.freeVector3(I),C.freeVector3(V),C.freeVector3(z),C.freeVector3(H)}},v.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:v,updateMatrixWorld:(g=new Vector3,C=new Quaternion,w=new Vector3,_=new Matrix4,function(b){var A=this.root;if(this.visible){var E=this.physics.bodies;_.copy(A.matrixWorld).decompose(g,C,w).compose(g,C,w.set(1,1,1)).getInverse(_);for(var R=0,O=E.length;R<O;R++){var F=this.children[R],L=E[R].body.getCenterOfMassTransform(),I=L.getOrigin(),V=L.getRotation();F.position.set(I.x(),I.y(),I.z()).applyMatrix4(_),F.quaternion.setFromRotationMatrix(_).multiply(C.set(V.x(),V.y(),V.z(),V.w()))}}this.matrix.copy(A.matrixWorld).decompose(g,C,w).compose(g,C,w.set(1,1,1)),Object3D.prototype.updateMatrixWorld.call(this,b)}),_init:function(){var C=this.physics.bodies;function w(E){switch(E.shapeType){case 0:return new SphereBufferGeometry(E.width,16,8);case 1:return new BoxBufferGeometry(2*E.width,2*E.height,2*E.depth,8,8,8);case 2:return new _(E.width,E.height,16,8);default:return null}}function _(E,R,O,D){var F=new CylinderBufferGeometry(E,E,R,O,D,!0),L=new Mesh(new SphereBufferGeometry(E,O,D,0,2*Math.PI,0,Math.PI/2)),I=new Mesh(new SphereBufferGeometry(E,O,D,0,2*Math.PI,Math.PI/2,Math.PI/2));return L.position.set(0,R/2,0),I.position.set(0,-R/2,0),L.updateMatrix(),I.updateMatrix(),F.merge(L.geometry,L.matrix),F.merge(I.geometry,I.matrix),F}for(var x=0,b=C.length;x<b;x++){var A=C[x].params;this.add(new Mesh(w(A),this.materials[A.type]))}}}),s;var g,C,w,_}(),MMDAnimationHelper=function(){function s(d){d=d||{},this.meshes=[],this.camera=null,this.cameraTarget=new Object3D,this.cameraTarget.name="target",this.audio=null,this.audioManager=null,this.objects=new WeakMap,this.configuration={sync:void 0===d.sync||d.sync,afterglow:void 0!==d.afterglow?d.afterglow:0,resetPhysicsOnLoop:void 0===d.resetPhysicsOnLoop||d.resetPhysicsOnLoop},this.enabled={animation:!0,ik:!0,grant:!0,physics:!0,cameraAnimation:!0},this.onBeforePhysics=function(){},this.sharedPhysics=!1,this.masterPhysics=null}function e(d,v){v=v||{},this.audio=d,this.elapsedTime=0,this.currentTime=0,this.delayTime=void 0!==v.delayTime?v.delayTime:0,this.audioDuration=this.audio.buffer.duration,this.duration=this.audioDuration+this.delayTime}function a(d,v){this.mesh=d,this.grants=v||[]}return s.prototype={constructor:s,add:function(v,g){if(g=g||{},v.isSkinnedMesh)this._addMesh(v,g);else if(v.isCamera)this._setupCamera(v,g);else{if("Audio"!==v.type)throw new Error("MMDAnimationHelper.add: accepts only SkinnedMesh or Camera or Audio instance.");this._setupAudio(v,g)}return this.configuration.sync&&this._syncDuration(),this},remove:function(v){if(v.isSkinnedMesh)this._removeMesh(v);else if(v.isCamera)this._clearCamera(v);else{if("Audio"!==v.type)throw new Error("MMDAnimationHelper.remove: accepts only SkinnedMesh or Camera or Audio instance.");this._clearAudio(v)}return this.configuration.sync&&this._syncDuration(),this},update:function(v){null!==this.audioManager&&this.audioManager.control(v);for(var g=0;g<this.meshes.length;g++)this._animateMesh(this.meshes[g],v);return this.sharedPhysics&&this._updateSharedPhysics(v),null!==this.camera&&this._animateCamera(this.camera,v),this},pose:function(v,g,C){!1!==(C=C||{}).resetPose&&v.pose();for(var w=v.skeleton.bones,_=g.bones,x={},b=0,A=w.length;b<A;b++)x[w[b].name]=b;var E=new Vector3,R=new Quaternion;for(b=0,A=_.length;b<A;b++){var O=_[b],D=x[O.name];if(void 0!==D){var F=w[D];F.position.add(E.fromArray(O.translation)),F.quaternion.multiply(R.fromArray(O.quaternion))}}return v.updateMatrixWorld(!0),!1!==C.ik&&this._createCCDIKSolver(v).update(C.saveOriginalBonesBeforeIK),!1!==C.grant&&this.createGrantSolver(v).update(),this},enable:function(v,g){if(void 0===this.enabled[v])throw new Error("MMDAnimationHelper.enable: unknown key "+v);if(this.enabled[v]=g,"physics"===v)for(var C=0,w=this.meshes.length;C<w;C++)this._optimizeIK(this.meshes[C],g);return this},createGrantSolver:function(v){return new a(v,v.geometry.userData.MMD.grants)},_addMesh:function(v,g){if(this.meshes.indexOf(v)>=0)throw new Error("MMDAnimationHelper._addMesh: SkinnedMesh '"+v.name+"' has already been added.");return this.meshes.push(v),this.objects.set(v,{looped:!1}),this._setupMeshAnimation(v,g.animation),!1!==g.physics&&this._setupMeshPhysics(v,g),this},_setupCamera:function(v,g){if(this.camera===v)throw new Error("MMDAnimationHelper._setupCamera: Camera '"+v.name+"' has already been set.");return this.camera&&this.clearCamera(this.camera),this.camera=v,v.add(this.cameraTarget),this.objects.set(v,{}),void 0!==g.animation&&this._setupCameraAnimation(v,g.animation),this},_setupAudio:function(v,g){if(this.audio===v)throw new Error("MMDAnimationHelper._setupAudio: Audio '"+v.name+"' has already been set.");return this.audio&&this.clearAudio(this.audio),this.audio=v,this.audioManager=new e(v,g),this.objects.set(this.audioManager,{duration:this.audioManager.duration}),this},_removeMesh:function(v){for(var g=!1,C=0,w=0,_=this.meshes.length;w<_;w++)this.meshes[w]!==v?this.meshes[C++]=this.meshes[w]:(this.objects.delete(v),g=!0);if(!g)throw new Error("MMDAnimationHelper._removeMesh: SkinnedMesh '"+v.name+"' has not been added yet.");return this.meshes.length=C,this},_clearCamera:function(v){if(v!==this.camera)throw new Error("MMDAnimationHelper._clearCamera: Camera '"+v.name+"' has not been set yet.");return this.camera.remove(this.cameraTarget),this.objects.delete(this.camera),this.camera=null,this},_clearAudio:function(v){if(v!==this.audio)throw new Error("MMDAnimationHelper._clearAudio: Audio '"+v.name+"' has not been set yet.");return this.objects.delete(this.audioManager),this.audio=null,this.audioManager=null,this},_setupMeshAnimation:function(v,g){var C=this.objects.get(v);if(void 0!==g){var w=Array.isArray(g)?g:[g];C.mixer=new AnimationMixer(v);for(var _=0,x=w.length;_<x;_++)C.mixer.clipAction(w[_]).play();C.mixer.addEventListener("loop",function(b){var A=b.action._clip.tracks;A.length>0&&".bones"!==A[0].name.slice(0,6)||(C.looped=!0)})}return C.ikSolver=this._createCCDIKSolver(v),C.grantSolver=this.createGrantSolver(v),this},_setupCameraAnimation:function(v,g){var C=Array.isArray(g)?g:[g],w=this.objects.get(v);w.mixer=new AnimationMixer(v);for(var _=0,x=C.length;_<x;_++)w.mixer.clipAction(C[_]).play()},_setupMeshPhysics:function(v,g){var C=this.objects.get(v);if(void 0===g.world&&this.sharedPhysics){var w=this._getMasterPhysics();null!==w&&(world=w.world)}C.physics=this._createMMDPhysics(v,g),C.mixer&&!1!==g.animationWarmup&&(this._animateMesh(v,0),C.physics.reset()),C.physics.warmup(void 0!==g.warmup?g.warmup:60),this._optimizeIK(v,!0)},_animateMesh:function(v,g){var C=this.objects.get(v),w=C.mixer,_=C.ikSolver,x=C.grantSolver,b=C.physics,A=C.looped;w&&this.enabled.animation&&(this._restoreBones(v),w.update(g),this._saveBones(v),_&&this.enabled.ik&&(v.updateMatrixWorld(!0),_.update()),x&&this.enabled.grant&&x.update()),!0===A&&this.enabled.physics&&(b&&this.configuration.resetPhysicsOnLoop&&b.reset(),C.looped=!1),b&&this.enabled.physics&&!this.sharedPhysics&&(this.onBeforePhysics(v),b.update(g))},_animateCamera:function(v,g){var C=this.objects.get(v).mixer;C&&this.enabled.cameraAnimation&&(C.update(g),v.updateProjectionMatrix(),v.up.set(0,1,0),v.up.applyQuaternion(v.quaternion),v.lookAt(this.cameraTarget.position))},_optimizeIK:function(v,g){for(var C=v.geometry.userData.MMD.iks,w=v.geometry.userData.MMD.bones,_=0,x=C.length;_<x;_++)for(var A=C[_].links,E=0,R=A.length;E<R;E++){var O=A[E];O.enabled=!0!==g||!(w[O.index].rigidBodyType>0)}},_createCCDIKSolver:function(v){if(void 0===CCDIKSolver)throw new Error("MMDAnimationHelper: Import CCDIKSolver.");return new CCDIKSolver(v,v.geometry.userData.MMD.iks)},_createMMDPhysics:function(v,g){if(void 0===MMDPhysics)throw new Error("MMDPhysics: Import MMDPhysics.");return new MMDPhysics(v,v.geometry.userData.MMD.rigidBodies,v.geometry.userData.MMD.constraints,g)},_syncDuration:function(){for(var v=0,g=this.objects,C=this.meshes,w=this.camera,_=this.audioManager,x=0,b=C.length;x<b;x++)if(void 0!==(A=this.objects.get(C[x]).mixer))for(var E=0;E<A._actions.length;E++)g.has(R=A._actions[E]._clip)||g.set(R,{duration:R.duration}),v=Math.max(v,g.get(R).duration);if(null!==w&&void 0!==(A=this.objects.get(w).mixer))for(x=0,b=A._actions.length;x<b;x++){var R;g.has(R=A._actions[x]._clip)||g.set(R,{duration:R.duration}),v=Math.max(v,g.get(R).duration)}for(null!==_&&(v=Math.max(v,g.get(_).duration)),v+=this.configuration.afterglow,x=0,b=this.meshes.length;x<b;x++){var A;if(void 0!==(A=this.objects.get(this.meshes[x]).mixer)){E=0;for(var O=A._actions.length;E<O;E++)A._actions[E]._clip.duration=v}}if(null!==w&&void 0!==(A=this.objects.get(w).mixer))for(x=0,b=A._actions.length;x<b;x++)A._actions[x]._clip.duration=v;null!==_&&(_.duration=v)},_updatePropertyMixersBuffer:function(v){for(var g=this.objects.get(v).mixer,C=g._bindings,w=g._accuIndex,_=0,x=C.length;_<x;_++){var b=C[_];b.binding.getValue(b.buffer,(w+1)*b.valueSize)}},_saveBones:function(v){var g=this.objects.get(v),C=v.skeleton.bones,w=g.backupBones;void 0===w&&(w=new Float32Array(7*C.length),g.backupBones=w);for(var _=0,x=C.length;_<x;_++){var b=C[_];b.position.toArray(w,7*_),b.quaternion.toArray(w,7*_+3)}},_restoreBones:function(v){var C=this.objects.get(v).backupBones;if(void 0!==C)for(var w=v.skeleton.bones,_=0,x=w.length;_<x;_++){var b=w[_];b.position.fromArray(C,7*_),b.quaternion.fromArray(C,7*_+3)}},_getMasterPhysics:function(){if(null!==this.masterPhysics)return this.masterPhysics;for(var v=0,g=this.meshes.length;v<g;v++){var C=this.meshes[v].physics;if(null!=C)return this.masterPhysics=C,this.masterPhysics}return null},_updateSharedPhysics:function(v){if(0!==this.meshes.length&&this.enabled.physics&&this.sharedPhysics){var g=this._getMasterPhysics();if(null!==g){for(var C=0,w=this.meshes.length;C<w;C++)null!=(_=this.meshes[C].physics)&&_.updateRigidBodies();for(g.stepSimulation(v),C=0,w=this.meshes.length;C<w;C++){var _;null!=(_=this.meshes[C].physics)&&_.updateBones()}}}}},e.prototype={constructor:e,control:function(v){return this.elapsed+=v,this.currentTime+=v,this._shouldStopAudio()&&this.audio.stop(),this._shouldStartAudio()&&this.audio.play(),this},_shouldStartAudio:function(){if(this.audio.isPlaying)return!1;for(;this.currentTime>=this.duration;)this.currentTime-=this.duration;return!(this.currentTime<this.delayTime||this.currentTime-this.delayTime>this.audioDuration||(this.audio.startTime=this.currentTime-this.delayTime,0))},_shouldStopAudio:function(){return this.audio.isPlaying&&this.currentTime>=this.duration}},a.prototype={constructor:a,update:(d=new Quaternion,function(){for(var v=this.mesh.skeleton.bones,g=this.grants,C=0,w=g.length;C<w;C++){var _=g[C],x=v[_.index],b=v[_.parentIndex];_.isLocal||_.affectRotation&&(d.set(0,0,0,1),d.slerp(b.quaternion,_.ratio),x.quaternion.multiply(d))}return this})},s;var d}(),TimelinerController=function(e,a,d){this._scene=e,this._trackInfo=a,this._onUpdate=d,this._mixer=new AnimationMixer(e),this._clip=null,this._action=null,this._tracks={},this._propRefs={},this._channelNames=[]};function Camera(){Object3D.call(this),this.type="Camera",this.matrixWorldInverse=new Matrix4,this.projectionMatrix=new Matrix4,this.projectionMatrixInverse=new Matrix4}function OrthographicCamera(s,e,a,d,v,g){Camera.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==s?s:-1,this.right=void 0!==e?e:1,this.top=void 0!==a?a:1,this.bottom=void 0!==d?d:-1,this.near=void 0!==v?v:.1,this.far=void 0!==g?g:2e3,this.updateProjectionMatrix()}function PerspectiveCamera(s,e,a,d){Camera.call(this),this.type="PerspectiveCamera",this.fov=void 0!==s?s:50,this.zoom=1,this.near=void 0!==a?a:.1,this.far=void 0!==d?d:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function PlaneGeometry(s,e,a,d){Geometry.call(this),this.type="PlaneGeometry",this.parameters={width:s,height:e,widthSegments:a,heightSegments:d},this.fromBufferGeometry(new PlaneBufferGeometry(s,e,a,d)),this.mergeVertices()}function PlaneBufferGeometry(s,e,a,d){BufferGeometry.call(this),this.type="PlaneBufferGeometry",this.parameters={width:s,height:e,widthSegments:a,heightSegments:d};var E,R,v=(s=s||1)/2,g=(e=e||1)/2,C=Math.floor(a)||1,w=Math.floor(d)||1,_=C+1,x=w+1,b=s/C,A=e/w,O=[],D=[],F=[],L=[];for(R=0;R<x;R++){var I=R*A-g;for(E=0;E<_;E++)D.push(E*b-v,-I,0),F.push(0,0,1),L.push(E/C),L.push(1-R/w)}for(R=0;R<w;R++)for(E=0;E<C;E++){var H=E+_*(R+1),X=E+1+_*(R+1),re=E+1+_*R;O.push(E+_*R,H,re),O.push(H,X,re)}this.setIndex(O),this.setAttribute("position",new Float32BufferAttribute(D,3)),this.setAttribute("normal",new Float32BufferAttribute(F,3)),this.setAttribute("uv",new Float32BufferAttribute(L,2))}function Scene(){Object3D.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function cloneUniforms(s){var e={};for(var a in s)for(var d in e[a]={},s[a]){var v=s[a][d];e[a][d]=v&&(v.isColor||v.isMatrix3||v.isMatrix4||v.isVector2||v.isVector3||v.isVector4||v.isTexture)?v.clone():Array.isArray(v)?v.slice():v}return e}function mergeUniforms(s){for(var e={},a=0;a<s.length;a++){var d=cloneUniforms(s[a]);for(var v in d)e[v]=d[v]}return e}TimelinerController.prototype={constructor:TimelinerController,init:function(){for(var e=[],a=this._trackInfo,d=0,v=a.length;d!==v;++d){var g=a[d];e.push(this._addTrack(g.type,g.propertyPath,g.initialValue,g.interpolation))}this._clip=new AnimationClip("editclip",0,e),this._action=this._mixer.clipAction(this._clip).play()},setDisplayTime:function(e){this._action.time=e,this._mixer.update(0),this._onUpdate()},setDuration:function(e){this._clip.duration=e},getChannelNames:function(){return this._channelNames},getChannelKeyTimes:function(e){return this._tracks[e].times},setKeyframe:function(e,a){var d=this._tracks[e],v=d.times,g=Timeliner.binarySearch(v,a),C=d.values,w=d.getValueSize(),_=g*w;if(g<0){_=(g=~g)*w;for(var b=C.length+w,A=v.length+1-1;A!==g;--A)v[A]=v[A-1];A=b-1;for(var E=_+w-1;A!==E;--A)C[A]=C[A-w]}v[g]=a,this._propRefs[e].getValue(C,_)},delKeyframe:function(e,a){var d=this._tracks[e],v=d.times,g=Timeliner.binarySearch(v,a);if(v.length>1&&g>=0){for(var C=v.length-1,w=d.values,_=d.getValueSize(),x=w.length-_,b=g;b!==C;++b)v[b]=v[b+1];v.pop();for(var A=g*_;A!==x;++A)w[A]=w[A+_];w.length=x}},moveKeyframe:function(e,a,d,v){var g=this._tracks[e],C=g.times,w=Timeliner.binarySearch(C,a);if(w>=0){for(var _=v?C.length:w+1,x=C[w-1]<=a||!v&&a>=C[w+1];w!==_;)C[w++]+=d;x&&this._sort(g)}},serialize:function(){for(var e={duration:this._clip.duration,channels:{}},a=this._channelNames,d=this._tracks,v=e.channels,g=0,C=a.length;g!==C;++g){var w=a[g],_=d[w];v[w]={times:_.times,values:_.values}}return e},deserialize:function(e){var a=this._channelNames,d=this._tracks,v=e.channels;this.setDuration(e.duration);for(var g=0,C=a.length;g!==C;++g){var w=a[g],_=d[w],x=v[w];this._setArray(_.times,x.times),this._setArray(_.values,x.values)}this.setDisplayTime(this._mixer.time)},_sort:function(e){var a=e.times,d=AnimationUtils.getKeyframeOrder(a);this._setArray(a,AnimationUtils.sortedArray(a,1,d));var v=e.values,g=e.getValueSize();this._setArray(v,AnimationUtils.sortedArray(v,g,d))},_setArray:function(e,a){e.length=0,e.push.apply(e,a)},_addTrack:function(e,a,d,v){var g=new e(a,[0],d,v);return g.times=Array.prototype.slice.call(g.times),g.values=Array.prototype.slice.call(g.values),this._channelNames.push(a),this._tracks[a]=g,this._propRefs[a]=new PropertyBinding(this._scene,a),g}},Camera.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Camera,isCamera:!0,copy:function(e,a){return Object3D.prototype.copy.call(this,e,a),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("Camera: .getWorldDirection() target is now required"),e=new Vector3),this.updateMatrixWorld(!0);var a=this.matrixWorld.elements;return e.set(-a[8],-a[9],-a[10]).normalize()},updateMatrixWorld:function(e){Object3D.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(e,a){Object3D.prototype.updateWorldMatrix.call(this,e,a),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),OrthographicCamera.prototype=Object.assign(Object.create(Camera.prototype),{constructor:OrthographicCamera,isOrthographicCamera:!0,copy:function(e,a){return Camera.prototype.copy.call(this,e,a),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,a,d,v,g,C){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=a,this.view.offsetX=d,this.view.offsetY=v,this.view.width=g,this.view.height=C,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),a=(this.top-this.bottom)/(2*this.zoom),d=(this.right+this.left)/2,v=(this.top+this.bottom)/2,g=d-e,C=d+e,w=v+a,_=v-a;if(null!==this.view&&this.view.enabled){var x=(this.right-this.left)/this.view.fullWidth/this.zoom,b=(this.top-this.bottom)/this.view.fullHeight/this.zoom;C=(g+=x*this.view.offsetX)+x*this.view.width,_=(w-=b*this.view.offsetY)-b*this.view.height}this.projectionMatrix.makeOrthographic(g,C,w,_,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var a=Object3D.prototype.toJSON.call(this,e);return a.object.zoom=this.zoom,a.object.left=this.left,a.object.right=this.right,a.object.top=this.top,a.object.bottom=this.bottom,a.object.near=this.near,a.object.far=this.far,null!==this.view&&(a.object.view=Object.assign({},this.view)),a}}),PerspectiveCamera.prototype=Object.assign(Object.create(Camera.prototype),{constructor:PerspectiveCamera,isPerspectiveCamera:!0,copy:function(e,a){return Camera.prototype.copy.call(this,e,a),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var a=.5*this.getFilmHeight()/e;this.fov=2*MathUtils.RAD2DEG*Math.atan(a),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*MathUtils.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*MathUtils.RAD2DEG*Math.atan(Math.tan(.5*MathUtils.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,a,d,v,g,C){this.aspect=e/a,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=a,this.view.offsetX=d,this.view.offsetY=v,this.view.width=g,this.view.height=C,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,a=e*Math.tan(.5*MathUtils.DEG2RAD*this.fov)/this.zoom,d=2*a,v=this.aspect*d,g=-.5*v,C=this.view;if(null!==this.view&&this.view.enabled){var w=C.fullWidth,_=C.fullHeight;g+=C.offsetX*v/w,a-=C.offsetY*d/_,v*=C.width/w,d*=C.height/_}var x=this.filmOffset;0!==x&&(g+=e*x/this.getFilmWidth()),this.projectionMatrix.makePerspective(g,g+v,a,a-d,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var a=Object3D.prototype.toJSON.call(this,e);return a.object.fov=this.fov,a.object.zoom=this.zoom,a.object.near=this.near,a.object.far=this.far,a.object.focus=this.focus,a.object.aspect=this.aspect,null!==this.view&&(a.object.view=Object.assign({},this.view)),a.object.filmGauge=this.filmGauge,a.object.filmOffset=this.filmOffset,a}}),PlaneGeometry.prototype=Object.create(Geometry.prototype),PlaneGeometry.prototype.constructor=PlaneGeometry,PlaneBufferGeometry.prototype=Object.create(BufferGeometry.prototype),PlaneBufferGeometry.prototype.constructor=PlaneBufferGeometry,Scene.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Scene,isScene:!0,copy:function(e,a){return Object3D.prototype.copy.call(this,e,a),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var a=Object3D.prototype.toJSON.call(this,e);return null!==this.background&&(a.object.background=this.background.toJSON(e)),null!==this.environment&&(a.object.environment=this.environment.toJSON(e)),null!==this.fog&&(a.object.fog=this.fog.toJSON()),a},dispose:function(){this.dispatchEvent({type:"dispose"})}});var UniformsUtils={clone:cloneUniforms,merge:mergeUniforms},default_vertex="\nvoid main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",default_fragment="\nvoid main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}\n";function ShaderMaterial(s){Material.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=default_vertex,this.fragmentShader=default_fragment,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==s&&(void 0!==s.attributes&&console.error("ShaderMaterial: attributes should now be defined in BufferGeometry instead."),this.setValues(s))}ShaderMaterial.prototype=Object.create(Material.prototype),ShaderMaterial.prototype.constructor=ShaderMaterial,ShaderMaterial.prototype.isShaderMaterial=!0,ShaderMaterial.prototype.copy=function(s){return Material.prototype.copy.call(this,s),this.fragmentShader=s.fragmentShader,this.vertexShader=s.vertexShader,this.uniforms=cloneUniforms(s.uniforms),this.defines=Object.assign({},s.defines),this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this.lights=s.lights,this.clipping=s.clipping,this.skinning=s.skinning,this.morphTargets=s.morphTargets,this.morphNormals=s.morphNormals,this.extensions=s.extensions,this},ShaderMaterial.prototype.toJSON=function(s){var e=Material.prototype.toJSON.call(this,s);for(var a in e.uniforms={},this.uniforms){var v=this.uniforms[a].value;e.uniforms[a]=v&&v.isTexture?{type:"t",value:v.toJSON(s).uuid}:v&&v.isColor?{type:"c",value:v.getHex()}:v&&v.isVector2?{type:"v2",value:v.toArray()}:v&&v.isVector3?{type:"v3",value:v.toArray()}:v&&v.isVector4?{type:"v4",value:v.toArray()}:v&&v.isMatrix3?{type:"m3",value:v.toArray()}:v&&v.isMatrix4?{type:"m4",value:v.toArray()}:{value:v}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader;var g={};for(var C in this.extensions)!0===this.extensions[C]&&(g[C]=!0);return Object.keys(g).length>0&&(e.extensions=g),e};var _canvas,ImageUtils={getDataURL:function(e){var a;if("undefined"==typeof HTMLCanvasElement)return e.src;if(e instanceof HTMLCanvasElement)a=e;else{void 0===_canvas&&(_canvas=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),_canvas.width=e.width,_canvas.height=e.height;var d=_canvas.getContext("2d");e instanceof ImageData?d.putImageData(e,0,0):d.drawImage(e,0,0,e.width,e.height),a=_canvas}return a.width>2048||a.height>2048?a.toDataURL("image/jpeg",.6):a.toDataURL("image/png")}},textureId=0;function Texture(s,e,a,d,v,g,C,w,_,x){Object.defineProperty(this,"id",{value:textureId++}),this.uuid=MathUtils.generateUUID(),this.name="",this.image=void 0!==s?s:Texture.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:Texture.DEFAULT_MAPPING,this.wrapS=void 0!==a?a:ClampToEdgeWrapping,this.wrapT=void 0!==d?d:ClampToEdgeWrapping,this.magFilter=void 0!==v?v:LinearFilter,this.minFilter=void 0!==g?g:LinearMipmapLinearFilter,this.anisotropy=void 0!==_?_:1,this.format=void 0!==C?C:RGBAFormat,this.internalFormat=null,this.type=void 0!==w?w:UnsignedByteType,this.offset=new Vector2(0,0),this.repeat=new Vector2(1,1),this.center=new Vector2(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Matrix3,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==x?x:LinearEncoding,this.version=0,this.onUpdate=null}function WebGLRenderTarget(s,e,a){this.width=s,this.height=e,this.scissor=new Vector4(0,0,s,e),this.scissorTest=!1,this.viewport=new Vector4(0,0,s,e),this.texture=new Texture(void 0,(a=a||{}).mapping,a.wrapS,a.wrapT,a.magFilter,a.minFilter,a.format,a.type,a.anisotropy,a.encoding),this.texture.image={},this.texture.image.width=s,this.texture.image.height=e,this.texture.generateMipmaps=void 0!==a.generateMipmaps&&a.generateMipmaps,this.texture.minFilter=void 0!==a.minFilter?a.minFilter:LinearFilter,this.depthBuffer=void 0===a.depthBuffer||a.depthBuffer,this.stencilBuffer=void 0===a.stencilBuffer||a.stencilBuffer,this.depthTexture=void 0!==a.depthTexture?a.depthTexture:null}Texture.DEFAULT_IMAGE=void 0,Texture.DEFAULT_MAPPING=UVMapping,Texture.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:Texture,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var a=void 0===e||"string"==typeof e;if(!a&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var d={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var v=this.image;if(void 0===v.uuid&&(v.uuid=MathUtils.generateUUID()),!a&&void 0===e.images[v.uuid]){var g;if(Array.isArray(v)){g=[];for(var C=0,w=v.length;C<w;C++)g.push(ImageUtils.getDataURL(v[C]))}else g=ImageUtils.getDataURL(v);e.images[v.uuid]={uuid:v.uuid,url:g}}d.image=v.uuid}return a||(e.textures[this.uuid]=d),d},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping!==UVMapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case RepeatWrapping:e.x=e.x-Math.floor(e.x);break;case ClampToEdgeWrapping:e.x=e.x<0?0:1;break;case MirroredRepeatWrapping:e.x=1===Math.abs(Math.floor(e.x)%2)?Math.ceil(e.x)-e.x:e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case RepeatWrapping:e.y=e.y-Math.floor(e.y);break;case ClampToEdgeWrapping:e.y=e.y<0?0:1;break;case MirroredRepeatWrapping:e.y=1===Math.abs(Math.floor(e.y)%2)?Math.ceil(e.y)-e.y:e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(Texture.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),WebGLRenderTarget.prototype=Object.assign(Object.create(EventDispatcher.prototype),{constructor:WebGLRenderTarget,isWebGLRenderTarget:!0,setSize:function(e,a){(this.width!==e||this.height!==a)&&(this.width=e,this.height=a,this.texture.image.width=e,this.texture.image.height=a,this.dispose()),this.viewport.set(0,0,e,a),this.scissor.set(0,0,e,a)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var BokehShader={defines:{DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tColor:{value:null},tDepth:{value:null},focus:{value:1},aspect:{value:1},aperture:{value:.025},maxblur:{value:1},nearClip:{value:1},farClip:{value:1e3}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","varying vec2 vUv;","uniform sampler2D tColor;","uniform sampler2D tDepth;","uniform float maxblur;","uniform float aperture;","uniform float nearClip;","uniform float farClip;","uniform float focus;","uniform float aspect;","#include <packing>","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\treturn perspectiveDepthToViewZ( depth, nearClip, farClip );","\t#else","\treturn orthographicDepthToViewZ( depth, nearClip, farClip );","\t#endif","}","void main() {","\tvec2 aspectcorrect = vec2( 1.0, aspect );","\tfloat viewZ = getViewZ( getDepth( vUv ) );","\tfloat factor = ( focus + viewZ );","\tvec2 dofblur = vec2 ( clamp( factor * aperture, -maxblur, maxblur ) );","\tvec2 dofblur9 = dofblur * 0.9;","\tvec2 dofblur7 = dofblur * 0.7;","\tvec2 dofblur4 = dofblur * 0.4;","\tvec4 col = vec4( 0.0 );","\tcol += texture2D( tColor, vUv.xy );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.4,   0.0  ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur4 );","\tgl_FragColor = col / 41.0;","\tgl_FragColor.a = 1.0;","}"].join("\n")},BokehShader2={uniforms:{textureWidth:{value:1},textureHeight:{value:1},focalDepth:{value:1},focalLength:{value:24},fstop:{value:.9},tColor:{value:null},tDepth:{value:null},maxblur:{value:1},showFocus:{value:0},manualdof:{value:0},vignetting:{value:0},depthblur:{value:0},threshold:{value:.5},gain:{value:2},bias:{value:.5},fringe:{value:.7},znear:{value:.1},zfar:{value:100},noise:{value:1},dithering:{value:1e-4},pentagon:{value:0},shaderFocus:{value:1},focusCoords:{value:new Vector2}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","varying vec2 vUv;","uniform sampler2D tColor;","uniform sampler2D tDepth;","uniform float textureWidth;","uniform float textureHeight;","uniform float focalDepth;  //focal distance value in meters, but you may use autofocus option below","uniform float focalLength; //focal length in mm","uniform float fstop; //f-stop value","uniform bool showFocus; //show debug focus point and focal range (red = focal point, green = focal range)","/*","make sure that these two values are the same for your camera, otherwise distances will be wrong.","*/","uniform float znear; // camera clipping start","uniform float zfar; // camera clipping end","//------------------------------------------","//user variables","const int samples = SAMPLES; //samples on the first ring","const int rings = RINGS; //ring count","const int maxringsamples = rings * samples;","uniform bool manualdof; // manual dof calculation","float ndofstart = 1.0; // near dof blur start","float ndofdist = 2.0; // near dof blur falloff distance","float fdofstart = 1.0; // far dof blur start","float fdofdist = 3.0; // far dof blur falloff distance","float CoC = 0.03; //circle of confusion size in mm (35mm film = 0.03mm)","uniform bool vignetting; // use optical lens vignetting","float vignout = 1.3; // vignetting outer border","float vignin = 0.0; // vignetting inner border","float vignfade = 22.0; // f-stops till vignete fades","uniform bool shaderFocus;","// disable if you use external focalDepth value","uniform vec2 focusCoords;","// autofocus point on screen (0.0,0.0 - left lower corner, 1.0,1.0 - upper right)","// if center of screen use vec2(0.5, 0.5);","uniform float maxblur;","//clamp value of max blur (0.0 = no blur, 1.0 default)","uniform float threshold; // highlight threshold;","uniform float gain; // highlight gain;","uniform float bias; // bokeh edge bias","uniform float fringe; // bokeh chromatic aberration / fringing","uniform bool noise; //use noise instead of pattern for sample dithering","uniform float dithering;","uniform bool depthblur; // blur the depth buffer","float dbsize = 1.25; // depth blur size","/*","next part is experimental","not looking good with small sample and ring count","looks okay starting from samples = 4, rings = 4","*/","uniform bool pentagon; //use pentagon as bokeh shape?","float feather = 0.4; //pentagon shape feather","//------------------------------------------","float penta(vec2 coords) {","\t//pentagonal shape","\tfloat scale = float(rings) - 1.3;","\tvec4  HS0 = vec4( 1.0,         0.0,         0.0,  1.0);","\tvec4  HS1 = vec4( 0.309016994, 0.951056516, 0.0,  1.0);","\tvec4  HS2 = vec4(-0.809016994, 0.587785252, 0.0,  1.0);","\tvec4  HS3 = vec4(-0.809016994,-0.587785252, 0.0,  1.0);","\tvec4  HS4 = vec4( 0.309016994,-0.951056516, 0.0,  1.0);","\tvec4  HS5 = vec4( 0.0        ,0.0         , 1.0,  1.0);","\tvec4  one = vec4( 1.0 );","\tvec4 P = vec4((coords),vec2(scale, scale));","\tvec4 dist = vec4(0.0);","\tfloat inorout = -4.0;","\tdist.x = dot( P, HS0 );","\tdist.y = dot( P, HS1 );","\tdist.z = dot( P, HS2 );","\tdist.w = dot( P, HS3 );","\tdist = smoothstep( -feather, feather, dist );","\tinorout += dot( dist, one );","\tdist.x = dot( P, HS4 );","\tdist.y = HS5.w - abs( P.z );","\tdist = smoothstep( -feather, feather, dist );","\tinorout += dist.x;","\treturn clamp( inorout, 0.0, 1.0 );","}","float bdepth(vec2 coords) {","\t// Depth buffer blur","\tfloat d = 0.0;","\tfloat kernel[9];","\tvec2 offset[9];","\tvec2 wh = vec2(1.0/textureWidth,1.0/textureHeight) * dbsize;","\toffset[0] = vec2(-wh.x,-wh.y);","\toffset[1] = vec2( 0.0, -wh.y);","\toffset[2] = vec2( wh.x -wh.y);","\toffset[3] = vec2(-wh.x,  0.0);","\toffset[4] = vec2( 0.0,   0.0);","\toffset[5] = vec2( wh.x,  0.0);","\toffset[6] = vec2(-wh.x, wh.y);","\toffset[7] = vec2( 0.0,  wh.y);","\toffset[8] = vec2( wh.x, wh.y);","\tkernel[0] = 1.0/16.0;   kernel[1] = 2.0/16.0;   kernel[2] = 1.0/16.0;","\tkernel[3] = 2.0/16.0;   kernel[4] = 4.0/16.0;   kernel[5] = 2.0/16.0;","\tkernel[6] = 1.0/16.0;   kernel[7] = 2.0/16.0;   kernel[8] = 1.0/16.0;","\tfor( int i=0; i<9; i++ ) {","\t\tfloat tmp = texture2D(tDepth, coords + offset[i]).r;","\t\td += tmp * kernel[i];","\t}","\treturn d;","}","vec3 color(vec2 coords,float blur) {","\t//processing the sample","\tvec3 col = vec3(0.0);","\tvec2 texel = vec2(1.0/textureWidth,1.0/textureHeight);","\tcol.r = texture2D(tColor,coords + vec2(0.0,1.0)*texel*fringe*blur).r;","\tcol.g = texture2D(tColor,coords + vec2(-0.866,-0.5)*texel*fringe*blur).g;","\tcol.b = texture2D(tColor,coords + vec2(0.866,-0.5)*texel*fringe*blur).b;","\tvec3 lumcoeff = vec3(0.299,0.587,0.114);","\tfloat lum = dot(col.rgb, lumcoeff);","\tfloat thresh = max((lum-threshold)*gain, 0.0);","\treturn col+mix(vec3(0.0),col,thresh*blur);","}","vec3 debugFocus(vec3 col, float blur, float depth) {","\tfloat edge = 0.002*depth; //distance based edge smoothing","\tfloat m = clamp(smoothstep(0.0,edge,blur),0.0,1.0);","\tfloat e = clamp(smoothstep(1.0-edge,1.0,blur),0.0,1.0);","\tcol = mix(col,vec3(1.0,0.5,0.0),(1.0-m)*0.6);","\tcol = mix(col,vec3(0.0,0.5,1.0),((1.0-e)-(1.0-m))*0.2);","\treturn col;","}","float linearize(float depth) {","\treturn -zfar * znear / (depth * (zfar - znear) - zfar);","}","float vignette() {","\tfloat dist = distance(vUv.xy, vec2(0.5,0.5));","\tdist = smoothstep(vignout+(fstop/vignfade), vignin+(fstop/vignfade), dist);","\treturn clamp(dist,0.0,1.0);","}","float gather(float i, float j, int ringsamples, inout vec3 col, float w, float h, float blur) {","\tfloat rings2 = float(rings);","\tfloat step = PI*2.0 / float(ringsamples);","\tfloat pw = cos(j*step)*i;","\tfloat ph = sin(j*step)*i;","\tfloat p = 1.0;","\tif (pentagon) {","\t\tp = penta(vec2(pw,ph));","\t}","\tcol += color(vUv.xy + vec2(pw*w,ph*h), blur) * mix(1.0, i/rings2, bias) * p;","\treturn 1.0 * mix(1.0, i /rings2, bias) * p;","}","void main() {","\t//scene depth calculation","\tfloat depth = linearize(texture2D(tDepth,vUv.xy).x);","\t// Blur depth?","\tif ( depthblur ) {","\t\tdepth = linearize(bdepth(vUv.xy));","\t}","\t//focal plane calculation","\tfloat fDepth = focalDepth;","\tif (shaderFocus) {","\t\tfDepth = linearize(texture2D(tDepth,focusCoords).x);","\t}","\t// dof blur factor calculation","\tfloat blur = 0.0;","\tif (manualdof) {","\t\tfloat a = depth-fDepth; // Focal plane","\t\tfloat b = (a-fdofstart)/fdofdist; // Far DoF","\t\tfloat c = (-a-ndofstart)/ndofdist; // Near Dof","\t\tblur = (a>0.0) ? b : c;","\t} else {","\t\tfloat f = focalLength; // focal length in mm","\t\tfloat d = fDepth*1000.0; // focal plane in mm","\t\tfloat o = depth*1000.0; // depth in mm","\t\tfloat a = (o*f)/(o-f);","\t\tfloat b = (d*f)/(d-f);","\t\tfloat c = (d-f)/(d*fstop*CoC);","\t\tblur = abs(a-b)*c;","\t}","\tblur = clamp(blur,0.0,1.0);","\t// calculation of pattern for dithering","\tvec2 noise = vec2(rand(vUv.xy), rand( vUv.xy + vec2( 0.4, 0.6 ) ) )*dithering*blur;","\t// getting blur x and y step factor","\tfloat w = (1.0/textureWidth)*blur*maxblur+noise.x;","\tfloat h = (1.0/textureHeight)*blur*maxblur+noise.y;","\t// calculation of final color","\tvec3 col = vec3(0.0);","\tif(blur < 0.05) {","\t\t//some optimization thingy","\t\tcol = texture2D(tColor, vUv.xy).rgb;","\t} else {","\t\tcol = texture2D(tColor, vUv.xy).rgb;","\t\tfloat s = 1.0;","\t\tint ringsamples;","\t\tfor (int i = 1; i <= rings; i++) {","\t\t\t/*unboxstart*/","\t\t\tringsamples = i * samples;","\t\t\tfor (int j = 0 ; j < maxringsamples ; j++) {","\t\t\t\tif (j >= ringsamples) break;","\t\t\t\ts += gather(float(i), float(j), ringsamples, col, w, h, blur);","\t\t\t}","\t\t\t/*unboxend*/","\t\t}","\t\tcol /= s; //divide by sample count","\t}","\tif (showFocus) {","\t\tcol = debugFocus(col, blur, depth);","\t}","\tif (vignetting) {","\t\tcol *= vignette();","\t}","\tgl_FragColor.rgb = col;","\tgl_FragColor.a = 1.0;","} "].join("\n")},BokehDepthShader={uniforms:{mNear:{value:1},mFar:{value:1e3}},vertexShader:["varying float vViewZDepth;","void main() {","\t#include <begin_vertex>","\t#include <project_vertex>","\tvViewZDepth = - mvPosition.z;","}"].join("\n"),fragmentShader:["uniform float mNear;","uniform float mFar;","varying float vViewZDepth;","void main() {","\tfloat color = 1.0 - smoothstep( mNear, mFar, vViewZDepth );","\tgl_FragColor = vec4( vec3( color ), 1.0 );","} "].join("\n")},CinematicCamera=function(e,a,d,v){PerspectiveCamera.call(this,e,a,d,v),this.type="CinematicCamera",this.postprocessing={enabled:!0},this.shaderSettings={rings:3,samples:4},this.materialDepth=new ShaderMaterial({uniforms:BokehDepthShader.uniforms,vertexShader:BokehDepthShader.vertexShader,fragmentShader:BokehDepthShader.fragmentShader}),this.materialDepth.uniforms.mNear.value=d,this.materialDepth.uniforms.mFar.value=v,this.setLens(),this.initPostProcessing()};CinematicCamera.prototype=Object.create(PerspectiveCamera.prototype),CinematicCamera.prototype.constructor=CinematicCamera,CinematicCamera.prototype.setLens=function(s,e,a,d){void 0===s&&(s=35),void 0!==e&&(this.filmGauge=e),this.setFocalLength(s),void 0===a&&(a=8),void 0===d&&(d=.019),this.fNumber=a,this.coc=d,this.aperture=s/this.fNumber,this.hyperFocal=s*s/(this.aperture*this.coc)},CinematicCamera.prototype.linearize=function(s){var e=this.far,a=this.near;return-e*a/(s*(e-a)-e)},CinematicCamera.prototype.smoothstep=function(s,e,a){var d=this.saturate((a-s)/(e-s));return d*d*(3-2*d)},CinematicCamera.prototype.saturate=function(s){return Math.max(0,Math.min(1,s))},CinematicCamera.prototype.focusAt=function(s){void 0===s&&(s=20);var e=this.getFocalLength();this.focus=s,this.nearPoint=this.hyperFocal*this.focus/(this.hyperFocal+(this.focus-e)),this.farPoint=this.hyperFocal*this.focus/(this.hyperFocal-(this.focus-e)),this.depthOfField=this.farPoint-this.nearPoint,this.depthOfField<0&&(this.depthOfField=0),this.sdistance=this.smoothstep(this.near,this.far,this.focus),this.ldistance=this.linearize(1-this.sdistance),this.postprocessing.bokeh_uniforms.focalDepth.value=this.ldistance},CinematicCamera.prototype.initPostProcessing=function(){if(this.postprocessing.enabled){this.postprocessing.scene=new Scene,this.postprocessing.camera=new OrthographicCamera(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,-1e4,1e4),this.postprocessing.scene.add(this.postprocessing.camera);var s={minFilter:LinearFilter,magFilter:LinearFilter,format:RGBFormat};this.postprocessing.rtTextureDepth=new WebGLRenderTarget(window.innerWidth,window.innerHeight,s),this.postprocessing.rtTextureColor=new WebGLRenderTarget(window.innerWidth,window.innerHeight,s);var e=BokehShader;this.postprocessing.bokeh_uniforms=UniformsUtils.clone(e.uniforms),this.postprocessing.bokeh_uniforms.tColor.value=this.postprocessing.rtTextureColor.texture,this.postprocessing.bokeh_uniforms.tDepth.value=this.postprocessing.rtTextureDepth.texture,this.postprocessing.bokeh_uniforms.manualdof.value=0,this.postprocessing.bokeh_uniforms.shaderFocus.value=0,this.postprocessing.bokeh_uniforms.fstop.value=2.8,this.postprocessing.bokeh_uniforms.showFocus.value=1,this.postprocessing.bokeh_uniforms.focalDepth.value=.1,this.postprocessing.bokeh_uniforms.znear.value=this.near,this.postprocessing.bokeh_uniforms.zfar.value=this.near,this.postprocessing.bokeh_uniforms.textureWidth.value=window.innerWidth,this.postprocessing.bokeh_uniforms.textureHeight.value=window.innerHeight,this.postprocessing.materialBokeh=new ShaderMaterial({uniforms:this.postprocessing.bokeh_uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,defines:{RINGS:this.shaderSettings.rings,SAMPLES:this.shaderSettings.samples,DEPTH_PACKING:1}}),this.postprocessing.quad=new Mesh(new PlaneBufferGeometry(window.innerWidth,window.innerHeight),this.postprocessing.materialBokeh),this.postprocessing.quad.position.z=-500,this.postprocessing.scene.add(this.postprocessing.quad)}},CinematicCamera.prototype.renderCinematic=function(s,e){if(this.postprocessing.enabled){var a=e.getRenderTarget();e.clear(),s.overrideMaterial=null,e.setRenderTarget(this.postprocessing.rtTextureColor),e.clear(),e.render(s,this),s.overrideMaterial=this.materialDepth,e.setRenderTarget(this.postprocessing.rtTextureDepth),e.clear(),e.render(s,this),e.setRenderTarget(null),e.render(this.postprocessing.scene,this.postprocessing.camera),e.setRenderTarget(a)}};var DeviceOrientationControls=function(e){var a=this;this.object=e,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var C,w,_,x,d=function(w){a.deviceOrientation=w},v=function(){a.screenOrientation=window.orientation||0},g=(C=new Vector3(0,0,1),w=new Euler,_=new Quaternion,x=new Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),function(b,A,E,R,O){w.set(E,A,-R,"YXZ"),b.setFromEuler(w),b.multiply(x),b.multiply(_.setFromAxisAngle(C,-O))});this.connect=function(){v(),void 0!==window.DeviceOrientationEvent&&"function"==typeof window.DeviceOrientationEvent.requestPermission?window.DeviceOrientationEvent.requestPermission().then(function(C){"granted"==C&&(window.addEventListener("orientationchange",v,!1),window.addEventListener("deviceorientation",d,!1))}).catch(function(C){console.error("DeviceOrientationControls: Unable to use DeviceOrientation API:",C)}):(window.addEventListener("orientationchange",v,!1),window.addEventListener("deviceorientation",d,!1)),a.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",v,!1),window.removeEventListener("deviceorientation",d,!1),a.enabled=!1},this.update=function(){if(!1!==a.enabled){var C=a.deviceOrientation;if(C){var w=C.alpha?MathUtils.degToRad(C.alpha)+a.alphaOffset:0,_=C.beta?MathUtils.degToRad(C.beta):0,x=C.gamma?MathUtils.degToRad(C.gamma):0,b=a.screenOrientation?MathUtils.degToRad(a.screenOrientation):0;g(a.object.quaternion,w,_,x,b)}}},this.dispose=function(){a.disconnect()},this.connect()};function Raycaster(s,e,a,d){this.ray=new Ray(s,e),this.near=a||0,this.far=d||1/0,this.camera=null,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function ascSort(s,e){return s.distance-e.distance}function _intersectObject(s,e,a,d){if(!1!==s.visible&&(s.raycast(e,a),!0===d))for(var v=s.children,g=0,C=v.length;g<C;g++)_intersectObject(v[g],e,a,!0)}Object.assign(Raycaster.prototype,{linePrecision:1,set:function(e,a){this.ray.set(e,a)},setFromCamera:function(e,a){a&&a.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(a.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(a).sub(this.ray.origin).normalize(),this.camera=a):a&&a.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(a.near+a.far)/(a.near-a.far)).unproject(a),this.ray.direction.set(0,0,-1).transformDirection(a.matrixWorld),this.camera=a):console.error("Raycaster: Unsupported camera type.")},intersectObject:function(e,a,d){var v=d||[];return _intersectObject(e,this,v,a),v.sort(ascSort),v},intersectObjects:function(e,a,d){var v=d||[];if(!1===Array.isArray(e))return console.warn("Raycaster.intersectObjects: objects is not an Array."),v;for(var g=0,C=e.length;g<C;g++)_intersectObject(e[g],this,v,a);return v.sort(ascSort),v}});var DragControls=function(e,a,d){var v=new Plane,g=new Raycaster,C=new Vector2,w=new Vector3,_=new Vector3,x=new Vector3,b=new Matrix4,A=null,E=null,R=this;function O(){d.addEventListener("mousemove",L,!1),d.addEventListener("mousedown",I,!1),d.addEventListener("mouseup",V,!1),d.addEventListener("mouseleave",V,!1),d.addEventListener("touchmove",z,!1),d.addEventListener("touchstart",H,!1),d.addEventListener("touchend",X,!1)}function D(){d.removeEventListener("mousemove",L,!1),d.removeEventListener("mousedown",I,!1),d.removeEventListener("mouseup",V,!1),d.removeEventListener("mouseleave",V,!1),d.removeEventListener("touchmove",z,!1),d.removeEventListener("touchstart",H,!1),d.removeEventListener("touchend",X,!1)}function L(re){re.preventDefault();var j=d.getBoundingClientRect();if(C.x=(re.clientX-j.left)/j.width*2-1,C.y=-(re.clientY-j.top)/j.height*2+1,g.setFromCamera(C,a),A&&R.enabled)return g.ray.intersectPlane(v,_)&&A.position.copy(_.sub(w).applyMatrix4(b)),void R.dispatchEvent({type:"drag",object:A});g.setFromCamera(C,a);var te=g.intersectObjects(e,!0);if(te.length>0){var J=te[0].object;v.setFromNormalAndCoplanarPoint(a.getWorldDirection(v.normal),x.setFromMatrixPosition(J.matrixWorld)),E!==J&&(R.dispatchEvent({type:"hoveron",object:J}),d.style.cursor="pointer",E=J)}else null!==E&&(R.dispatchEvent({type:"hoveroff",object:E}),d.style.cursor="auto",E=null)}function I(re){re.preventDefault(),g.setFromCamera(C,a);var j=g.intersectObjects(e,!0);j.length>0&&(A=j[0].object,g.ray.intersectPlane(v,_)&&(b.getInverse(A.parent.matrixWorld),w.copy(_).sub(x.setFromMatrixPosition(A.matrixWorld))),d.style.cursor="move",R.dispatchEvent({type:"dragstart",object:A}))}function V(re){re.preventDefault(),A&&(R.dispatchEvent({type:"dragend",object:A}),A=null),d.style.cursor=E?"pointer":"auto"}function z(re){re.preventDefault(),re=re.changedTouches[0];var j=d.getBoundingClientRect();if(C.x=(re.clientX-j.left)/j.width*2-1,C.y=-(re.clientY-j.top)/j.height*2+1,g.setFromCamera(C,a),A&&R.enabled)return g.ray.intersectPlane(v,_)&&A.position.copy(_.sub(w).applyMatrix4(b)),void R.dispatchEvent({type:"drag",object:A})}function H(re){re.preventDefault(),re=re.changedTouches[0];var j=d.getBoundingClientRect();C.x=(re.clientX-j.left)/j.width*2-1,C.y=-(re.clientY-j.top)/j.height*2+1,g.setFromCamera(C,a);var te=g.intersectObjects(e,!0);te.length>0&&(A=te[0].object,v.setFromNormalAndCoplanarPoint(a.getWorldDirection(v.normal),x.setFromMatrixPosition(A.matrixWorld)),g.ray.intersectPlane(v,_)&&(b.getInverse(A.parent.matrixWorld),w.copy(_).sub(x.setFromMatrixPosition(A.matrixWorld))),d.style.cursor="move",R.dispatchEvent({type:"dragstart",object:A}))}function X(re){re.preventDefault(),A&&(R.dispatchEvent({type:"dragend",object:A}),A=null),d.style.cursor="auto"}O(),this.enabled=!0,this.activate=O,this.deactivate=D,this.dispose=function(){D()}};function Spherical(s,e,a){return this.radius=void 0!==s?s:1,this.phi=void 0!==e?e:0,this.theta=void 0!==a?a:0,this}DragControls.prototype=Object.create(EventDispatcher.prototype),DragControls.prototype.constructor=DragControls,Object.assign(Spherical.prototype,{set:function(e,a,d){return this.radius=e,this.phi=a,this.theta=d,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){var e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,a,d){return this.radius=Math.sqrt(e*e+a*a+d*d),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,d),this.phi=Math.acos(MathUtils.clamp(a/this.radius,-1,1))),this}});var FirstPersonControls=function(e,a){void 0===a&&(console.warn('FirstPersonControls: The second parameter "domElement" is now mandatory.'),a=document),this.object=e,this.domElement=a,this.enabled=!0,this.movementSpeed=1,this.lookSpeed=.005,this.lookVertical=!0,this.autoForward=!1,this.activeLook=!0,this.heightSpeed=!1,this.heightCoef=1,this.heightMin=0,this.heightMax=1,this.constrainVertical=!1,this.verticalMin=0,this.verticalMax=Math.PI,this.mouseDragOn=!1,this.autoSpeedFactor=0,this.mouseX=0,this.mouseY=0,this.moveForward=!1,this.moveBackward=!1,this.moveLeft=!1,this.moveRight=!1,this.viewHalfX=0,this.viewHalfY=0;var F,d=0,v=0,g=new Vector3,C=new Spherical,w=new Vector3;function _(F){F.preventDefault()}this.domElement!==document&&this.domElement.setAttribute("tabindex",-1),this.handleResize=function(){this.domElement===document?(this.viewHalfX=window.innerWidth/2,this.viewHalfY=window.innerHeight/2):(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=this.domElement.offsetHeight/2)},this.onMouseDown=function(F){if(this.domElement!==document&&this.domElement.focus(),F.preventDefault(),F.stopPropagation(),this.activeLook)switch(F.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0}this.mouseDragOn=!0},this.onMouseUp=function(F){if(F.preventDefault(),F.stopPropagation(),this.activeLook)switch(F.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1}this.mouseDragOn=!1},this.onMouseMove=function(F){this.domElement===document?(this.mouseX=F.pageX-this.viewHalfX,this.mouseY=F.pageY-this.viewHalfY):(this.mouseX=F.pageX-this.domElement.offsetLeft-this.viewHalfX,this.mouseY=F.pageY-this.domElement.offsetTop-this.viewHalfY)},this.onKeyDown=function(F){switch(F.keyCode){case 38:case 87:this.moveForward=!0;break;case 37:case 65:this.moveLeft=!0;break;case 40:case 83:this.moveBackward=!0;break;case 39:case 68:this.moveRight=!0;break;case 82:this.moveUp=!0;break;case 70:this.moveDown=!0}},this.onKeyUp=function(F){switch(F.keyCode){case 38:case 87:this.moveForward=!1;break;case 37:case 65:this.moveLeft=!1;break;case 40:case 83:this.moveBackward=!1;break;case 39:case 68:this.moveRight=!1;break;case 82:this.moveUp=!1;break;case 70:this.moveDown=!1}},this.lookAt=function(F,L,I){return F.isVector3?w.copy(F):w.set(F,L,I),this.object.lookAt(w),D(this),this},this.update=(F=new Vector3,function(I){if(!1!==this.enabled){if(this.heightSpeed){var V=MathUtils.clamp(this.object.position.y,this.heightMin,this.heightMax);this.autoSpeedFactor=I*((V-this.heightMin)*this.heightCoef)}else this.autoSpeedFactor=0;var H=I*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&this.object.translateZ(-(H+this.autoSpeedFactor)),this.moveBackward&&this.object.translateZ(H),this.moveLeft&&this.object.translateX(-H),this.moveRight&&this.object.translateX(H),this.moveUp&&this.object.translateY(H),this.moveDown&&this.object.translateY(-H);var X=I*this.lookSpeed;this.activeLook||(X=0);var re=1;this.constrainVertical&&(re=Math.PI/(this.verticalMax-this.verticalMin)),v-=this.mouseX*X,this.lookVertical&&(d-=this.mouseY*X*re),d=Math.max(-85,Math.min(85,d));var j=MathUtils.degToRad(90-d),te=MathUtils.degToRad(v);this.constrainVertical&&(j=MathUtils.mapLinear(j,0,Math.PI,this.verticalMin,this.verticalMax));var J=this.object.position;F.setFromSphericalCoords(1,j,te).add(J),this.object.lookAt(F)}}),this.dispose=function(){this.domElement.removeEventListener("contextmenu",_,!1),this.domElement.removeEventListener("mousedown",b,!1),this.domElement.removeEventListener("mousemove",x,!1),this.domElement.removeEventListener("mouseup",A,!1),window.removeEventListener("keydown",E,!1),window.removeEventListener("keyup",R,!1)};var x=O(this,this.onMouseMove),b=O(this,this.onMouseDown),A=O(this,this.onMouseUp),E=O(this,this.onKeyDown),R=O(this,this.onKeyUp);function O(F,L){return function(){L.apply(F,arguments)}}function D(F){var L=F.object.quaternion;g.set(0,0,-1).applyQuaternion(L),C.setFromVector3(g),d=90-MathUtils.radToDeg(C.phi),v=MathUtils.radToDeg(C.theta)}this.domElement.addEventListener("contextmenu",_,!1),this.domElement.addEventListener("mousemove",x,!1),this.domElement.addEventListener("mousedown",b,!1),this.domElement.addEventListener("mouseup",A,!1),window.addEventListener("keydown",E,!1),window.addEventListener("keyup",R,!1),this.handleResize(),D(this)},FlyControls=function(e,a){function d(b,A){return function(){A.apply(b,arguments)}}function v(b){b.preventDefault()}void 0===a&&(console.warn('FlyControls: The second parameter "domElement" is now mandatory.'),a=document),this.object=e,this.domElement=a,a&&this.domElement.setAttribute("tabindex",-1),this.movementSpeed=1,this.rollSpeed=.005,this.dragToLook=!1,this.autoForward=!1,this.tmpQuaternion=new Quaternion,this.mouseStatus=0,this.moveState={up:0,down:0,left:0,right:0,forward:0,back:0,pitchUp:0,pitchDown:0,yawLeft:0,yawRight:0,rollLeft:0,rollRight:0},this.moveVector=new Vector3(0,0,0),this.rotationVector=new Vector3(0,0,0),this.keydown=function(b){if(!b.altKey){switch(b.keyCode){case 16:this.movementSpeedMultiplier=.1;break;case 87:this.moveState.forward=1;break;case 83:this.moveState.back=1;break;case 65:this.moveState.left=1;break;case 68:this.moveState.right=1;break;case 82:this.moveState.up=1;break;case 70:this.moveState.down=1;break;case 38:this.moveState.pitchUp=1;break;case 40:this.moveState.pitchDown=1;break;case 37:this.moveState.yawLeft=1;break;case 39:this.moveState.yawRight=1;break;case 81:this.moveState.rollLeft=1;break;case 69:this.moveState.rollRight=1}this.updateMovementVector(),this.updateRotationVector()}},this.keyup=function(b){switch(b.keyCode){case 16:this.movementSpeedMultiplier=1;break;case 87:this.moveState.forward=0;break;case 83:this.moveState.back=0;break;case 65:this.moveState.left=0;break;case 68:this.moveState.right=0;break;case 82:this.moveState.up=0;break;case 70:this.moveState.down=0;break;case 38:this.moveState.pitchUp=0;break;case 40:this.moveState.pitchDown=0;break;case 37:this.moveState.yawLeft=0;break;case 39:this.moveState.yawRight=0;break;case 81:this.moveState.rollLeft=0;break;case 69:this.moveState.rollRight=0}this.updateMovementVector(),this.updateRotationVector()},this.mousedown=function(b){if(this.domElement!==document&&this.domElement.focus(),b.preventDefault(),b.stopPropagation(),this.dragToLook)this.mouseStatus++;else{switch(b.button){case 0:this.moveState.forward=1;break;case 2:this.moveState.back=1}this.updateMovementVector()}},this.mousemove=function(b){if(!this.dragToLook||this.mouseStatus>0){var A=this.getContainerDimensions(),E=A.size[0]/2,R=A.size[1]/2;this.moveState.yawLeft=-(b.pageX-A.offset[0]-E)/E,this.moveState.pitchDown=(b.pageY-A.offset[1]-R)/R,this.updateRotationVector()}},this.mouseup=function(b){if(b.preventDefault(),b.stopPropagation(),this.dragToLook)this.mouseStatus--,this.moveState.yawLeft=this.moveState.pitchDown=0;else{switch(b.button){case 0:this.moveState.forward=0;break;case 2:this.moveState.back=0}this.updateMovementVector()}this.updateRotationVector()},this.update=function(b){var A=b*this.movementSpeed,E=b*this.rollSpeed;this.object.translateX(this.moveVector.x*A),this.object.translateY(this.moveVector.y*A),this.object.translateZ(this.moveVector.z*A),this.tmpQuaternion.set(this.rotationVector.x*E,this.rotationVector.y*E,this.rotationVector.z*E,1).normalize(),this.object.quaternion.multiply(this.tmpQuaternion),this.object.rotation.setFromQuaternion(this.object.quaternion,this.object.rotation.order)},this.updateMovementVector=function(){var b=this.moveState.forward||this.autoForward&&!this.moveState.back?1:0;this.moveVector.x=-this.moveState.left+this.moveState.right,this.moveVector.y=-this.moveState.down+this.moveState.up,this.moveVector.z=-b+this.moveState.back},this.updateRotationVector=function(){this.rotationVector.x=-this.moveState.pitchDown+this.moveState.pitchUp,this.rotationVector.y=-this.moveState.yawRight+this.moveState.yawLeft,this.rotationVector.z=-this.moveState.rollRight+this.moveState.rollLeft},this.getContainerDimensions=function(){return this.domElement!=document?{size:[this.domElement.offsetWidth,this.domElement.offsetHeight],offset:[this.domElement.offsetLeft,this.domElement.offsetTop]}:{size:[window.innerWidth,window.innerHeight],offset:[0,0]}},this.dispose=function(){this.domElement.removeEventListener("contextmenu",v,!1),this.domElement.removeEventListener("mousedown",C,!1),this.domElement.removeEventListener("mousemove",g,!1),this.domElement.removeEventListener("mouseup",w,!1),window.removeEventListener("keydown",_,!1),window.removeEventListener("keyup",x,!1)};var g=d(this,this.mousemove),C=d(this,this.mousedown),w=d(this,this.mouseup),_=d(this,this.keydown),x=d(this,this.keyup);this.domElement.addEventListener("contextmenu",v,!1),this.domElement.addEventListener("mousemove",g,!1),this.domElement.addEventListener("mousedown",C,!1),this.domElement.addEventListener("mouseup",w,!1),window.addEventListener("keydown",_,!1),window.addEventListener("keyup",x,!1),this.updateMovementVector(),this.updateRotationVector()},OrbitControls=function(e,a){var Xe,Ke,lt,ot,St;void 0===a&&console.warn('OrbitControls: The second parameter "domElement" is now mandatory.'),a===document&&console.error('OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=a,this.enabled=!0,this.target=new Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:MOUSE.ROTATE,MIDDLE:MOUSE.DOLLY,RIGHT:MOUSE.PAN},this.touches={ONE:TOUCH.ROTATE,TWO:TOUCH.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return b.phi},this.getAzimuthalAngle=function(){return b.theta},this.saveState=function(){d.target0.copy(d.target),d.position0.copy(d.object.position),d.zoom0=d.object.zoom},this.reset=function(){d.target.copy(d.target0),d.object.position.copy(d.position0),d.object.zoom=d.zoom0,d.object.updateProjectionMatrix(),d.dispatchEvent(v),d.update(),_=w.NONE},this.update=(Xe=new Vector3,Ke=(new Quaternion).setFromUnitVectors(e.up,new Vector3(0,1,0)),lt=Ke.clone().inverse(),ot=new Vector3,St=new Quaternion,function(){var He=d.object.position;return Xe.copy(He).sub(d.target),Xe.applyQuaternion(Ke),b.setFromVector3(Xe),d.autoRotate&&_===w.NONE&&J(2*Math.PI/60/60*d.autoRotateSpeed),d.enableDamping?(b.theta+=A.theta*d.dampingFactor,b.phi+=A.phi*d.dampingFactor):(b.theta+=A.theta,b.phi+=A.phi),b.theta=Math.max(d.minAzimuthAngle,Math.min(d.maxAzimuthAngle,b.theta)),b.phi=Math.max(d.minPolarAngle,Math.min(d.maxPolarAngle,b.phi)),b.makeSafe(),b.radius*=E,b.radius=Math.max(d.minDistance,Math.min(d.maxDistance,b.radius)),!0===d.enableDamping?d.target.addScaledVector(R,d.dampingFactor):d.target.add(R),Xe.setFromSpherical(b),Xe.applyQuaternion(lt),He.copy(d.target).add(Xe),d.object.lookAt(d.target),!0===d.enableDamping?(A.theta*=1-d.dampingFactor,A.phi*=1-d.dampingFactor,R.multiplyScalar(1-d.dampingFactor)):(A.set(0,0,0),R.set(0,0,0)),E=1,!!(O||ot.distanceToSquared(d.object.position)>x||8*(1-St.dot(d.object.quaternion))>x)&&(d.dispatchEvent(v),ot.copy(d.object.position),St.copy(d.object.quaternion),O=!1,!0)}),this.dispose=function(){d.domElement.removeEventListener("contextmenu",at,!1),d.domElement.removeEventListener("mousedown",we,!1),d.domElement.removeEventListener("wheel",De,!1),d.domElement.removeEventListener("touchstart",$e,!1),d.domElement.removeEventListener("touchend",ut,!1),d.domElement.removeEventListener("touchmove",pt,!1),document.removeEventListener("mousemove",Ne,!1),document.removeEventListener("mouseup",Re,!1),d.domElement.removeEventListener("keydown",Je,!1)};var d=this,v={type:"change"},g={type:"start"},C={type:"end"},w={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},_=w.NONE,x=1e-6,b=new Spherical,A=new Spherical,E=1,R=new Vector3,O=!1,D=new Vector2,F=new Vector2,L=new Vector2,I=new Vector2,V=new Vector2,z=new Vector2,H=new Vector2,X=new Vector2,re=new Vector2;function te(){return Math.pow(.95,d.zoomSpeed)}function J(Xe){A.theta-=Xe}function k(Xe){A.phi-=Xe}var U=function(){var Xe=new Vector3;return function(lt,ot){Xe.setFromMatrixColumn(ot,0),Xe.multiplyScalar(-lt),R.add(Xe)}}(),K=function(){var Xe=new Vector3;return function(lt,ot){!0===d.screenSpacePanning?Xe.setFromMatrixColumn(ot,1):(Xe.setFromMatrixColumn(ot,0),Xe.crossVectors(d.object.up,Xe)),Xe.multiplyScalar(lt),R.add(Xe)}}(),ee=function(){var Xe=new Vector3;return function(lt,ot){var St=d.domElement;if(d.object.isPerspectiveCamera){Xe.copy(d.object.position).sub(d.target);var He=Xe.length();He*=Math.tan(d.object.fov/2*Math.PI/180),U(2*lt*He/St.clientHeight,d.object.matrix),K(2*ot*He/St.clientHeight,d.object.matrix)}else d.object.isOrthographicCamera?(U(lt*(d.object.right-d.object.left)/d.object.zoom/St.clientWidth,d.object.matrix),K(ot*(d.object.top-d.object.bottom)/d.object.zoom/St.clientHeight,d.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),d.enablePan=!1)}}();function Q(Xe){d.object.isPerspectiveCamera?E/=Xe:d.object.isOrthographicCamera?(d.object.zoom=Math.max(d.minZoom,Math.min(d.maxZoom,d.object.zoom*Xe)),d.object.updateProjectionMatrix(),O=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),d.enableZoom=!1)}function oe(Xe){d.object.isPerspectiveCamera?E*=Xe:d.object.isOrthographicCamera?(d.object.zoom=Math.max(d.minZoom,Math.min(d.maxZoom,d.object.zoom/Xe)),d.object.updateProjectionMatrix(),O=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),d.enableZoom=!1)}function me(Xe){D.set(Xe.clientX,Xe.clientY)}function ge(Xe){I.set(Xe.clientX,Xe.clientY)}function ve(Xe){1==Xe.touches.length?D.set(Xe.touches[0].pageX,Xe.touches[0].pageY):D.set(.5*(Xe.touches[0].pageX+Xe.touches[1].pageX),.5*(Xe.touches[0].pageY+Xe.touches[1].pageY))}function le(Xe){1==Xe.touches.length?I.set(Xe.touches[0].pageX,Xe.touches[0].pageY):I.set(.5*(Xe.touches[0].pageX+Xe.touches[1].pageX),.5*(Xe.touches[0].pageY+Xe.touches[1].pageY))}function _e(Xe){var Ke=Xe.touches[0].pageX-Xe.touches[1].pageX,lt=Xe.touches[0].pageY-Xe.touches[1].pageY,ot=Math.sqrt(Ke*Ke+lt*lt);H.set(0,ot)}function he(Xe){1==Xe.touches.length?F.set(Xe.touches[0].pageX,Xe.touches[0].pageY):F.set(.5*(Xe.touches[0].pageX+Xe.touches[1].pageX),.5*(Xe.touches[0].pageY+Xe.touches[1].pageY)),L.subVectors(F,D).multiplyScalar(d.rotateSpeed);var ot=d.domElement;J(2*Math.PI*L.x/ot.clientHeight),k(2*Math.PI*L.y/ot.clientHeight),D.copy(F)}function ce(Xe){1==Xe.touches.length?V.set(Xe.touches[0].pageX,Xe.touches[0].pageY):V.set(.5*(Xe.touches[0].pageX+Xe.touches[1].pageX),.5*(Xe.touches[0].pageY+Xe.touches[1].pageY)),z.subVectors(V,I).multiplyScalar(d.panSpeed),ee(z.x,z.y),I.copy(V)}function Te(Xe){var Ke=Xe.touches[0].pageX-Xe.touches[1].pageX,lt=Xe.touches[0].pageY-Xe.touches[1].pageY,ot=Math.sqrt(Ke*Ke+lt*lt);X.set(0,ot),re.set(0,Math.pow(X.y/H.y,d.zoomSpeed)),Q(re.y),H.copy(X)}function we(Xe){if(!1!==d.enabled){var Ke;switch(Xe.preventDefault(),d.domElement.focus?d.domElement.focus():window.focus(),Xe.button){case 0:Ke=d.mouseButtons.LEFT;break;case 1:Ke=d.mouseButtons.MIDDLE;break;case 2:Ke=d.mouseButtons.RIGHT;break;default:Ke=-1}switch(Ke){case MOUSE.DOLLY:if(!1===d.enableZoom)return;(function(Xe){H.set(Xe.clientX,Xe.clientY)})(Xe),_=w.DOLLY;break;case MOUSE.ROTATE:if(Xe.ctrlKey||Xe.metaKey||Xe.shiftKey){if(!1===d.enablePan)return;ge(Xe),_=w.PAN}else{if(!1===d.enableRotate)return;me(Xe),_=w.ROTATE}break;case MOUSE.PAN:if(Xe.ctrlKey||Xe.metaKey||Xe.shiftKey){if(!1===d.enableRotate)return;me(Xe),_=w.ROTATE}else{if(!1===d.enablePan)return;ge(Xe),_=w.PAN}break;default:_=w.NONE}_!==w.NONE&&(document.addEventListener("mousemove",Ne,!1),document.addEventListener("mouseup",Re,!1),d.dispatchEvent(g))}}function Ne(Xe){if(!1!==d.enabled)switch(Xe.preventDefault(),_){case w.ROTATE:if(!1===d.enableRotate)return;!function(Xe){F.set(Xe.clientX,Xe.clientY),L.subVectors(F,D).multiplyScalar(d.rotateSpeed);var Ke=d.domElement;J(2*Math.PI*L.x/Ke.clientHeight),k(2*Math.PI*L.y/Ke.clientHeight),D.copy(F),d.update()}(Xe);break;case w.DOLLY:if(!1===d.enableZoom)return;!function(Xe){X.set(Xe.clientX,Xe.clientY),re.subVectors(X,H),re.y>0?Q(te()):re.y<0&&oe(te()),H.copy(X),d.update()}(Xe);break;case w.PAN:if(!1===d.enablePan)return;!function(Xe){V.set(Xe.clientX,Xe.clientY),z.subVectors(V,I).multiplyScalar(d.panSpeed),ee(z.x,z.y),I.copy(V),d.update()}(Xe)}}function Re(Xe){!1!==d.enabled&&(document.removeEventListener("mousemove",Ne,!1),document.removeEventListener("mouseup",Re,!1),d.dispatchEvent(C),_=w.NONE)}function De(Xe){!1===d.enabled||!1===d.enableZoom||_!==w.NONE&&_!==w.ROTATE||(Xe.preventDefault(),Xe.stopPropagation(),d.dispatchEvent(g),function(Xe){Xe.deltaY<0?oe(te()):Xe.deltaY>0&&Q(te()),d.update()}(Xe),d.dispatchEvent(C))}function Je(Xe){!1===d.enabled||!1===d.enableKeys||!1===d.enablePan||function(Xe){var Ke=!1;switch(Xe.keyCode){case d.keys.UP:ee(0,d.keyPanSpeed),Ke=!0;break;case d.keys.BOTTOM:ee(0,-d.keyPanSpeed),Ke=!0;break;case d.keys.LEFT:ee(d.keyPanSpeed,0),Ke=!0;break;case d.keys.RIGHT:ee(-d.keyPanSpeed,0),Ke=!0}Ke&&(Xe.preventDefault(),d.update())}(Xe)}function $e(Xe){if(!1!==d.enabled){switch(Xe.preventDefault(),Xe.touches.length){case 1:switch(d.touches.ONE){case TOUCH.ROTATE:if(!1===d.enableRotate)return;ve(Xe),_=w.TOUCH_ROTATE;break;case TOUCH.PAN:if(!1===d.enablePan)return;le(Xe),_=w.TOUCH_PAN;break;default:_=w.NONE}break;case 2:switch(d.touches.TWO){case TOUCH.DOLLY_PAN:if(!1===d.enableZoom&&!1===d.enablePan)return;(function(Xe){d.enableZoom&&_e(Xe),d.enablePan&&le(Xe)})(Xe),_=w.TOUCH_DOLLY_PAN;break;case TOUCH.DOLLY_ROTATE:if(!1===d.enableZoom&&!1===d.enableRotate)return;(function(Xe){d.enableZoom&&_e(Xe),d.enableRotate&&ve(Xe)})(Xe),_=w.TOUCH_DOLLY_ROTATE;break;default:_=w.NONE}break;default:_=w.NONE}_!==w.NONE&&d.dispatchEvent(g)}}function pt(Xe){if(!1!==d.enabled)switch(Xe.preventDefault(),Xe.stopPropagation(),_){case w.TOUCH_ROTATE:if(!1===d.enableRotate)return;he(Xe),d.update();break;case w.TOUCH_PAN:if(!1===d.enablePan)return;ce(Xe),d.update();break;case w.TOUCH_DOLLY_PAN:if(!1===d.enableZoom&&!1===d.enablePan)return;(function(Xe){d.enableZoom&&Te(Xe),d.enablePan&&ce(Xe)})(Xe),d.update();break;case w.TOUCH_DOLLY_ROTATE:if(!1===d.enableZoom&&!1===d.enableRotate)return;(function(Xe){d.enableZoom&&Te(Xe),d.enableRotate&&he(Xe)})(Xe),d.update();break;default:_=w.NONE}}function ut(Xe){!1!==d.enabled&&(d.dispatchEvent(C),_=w.NONE)}function at(Xe){!1!==d.enabled&&Xe.preventDefault()}d.domElement.addEventListener("contextmenu",at,!1),d.domElement.addEventListener("mousedown",we,!1),d.domElement.addEventListener("wheel",De,!1),d.domElement.addEventListener("touchstart",$e,!1),d.domElement.addEventListener("touchend",ut,!1),d.domElement.addEventListener("touchmove",pt,!1),d.domElement.addEventListener("keydown",Je,!1),-1===d.domElement.tabIndex&&(d.domElement.tabIndex=0),this.update()};OrbitControls.prototype=Object.create(EventDispatcher.prototype),OrbitControls.prototype.constructor=OrbitControls;var MapControls=function(e,a){OrbitControls.call(this,e,a),this.mouseButtons.LEFT=MOUSE.PAN,this.mouseButtons.RIGHT=MOUSE.ROTATE,this.touches.ONE=TOUCH.PAN,this.touches.TWO=TOUCH.DOLLY_ROTATE};MapControls.prototype=Object.create(EventDispatcher.prototype),MapControls.prototype.constructor=MapControls;var PointerLockControls=function(e,a){void 0===a&&(console.warn('PointerLockControls: The second parameter "domElement" is now mandatory.'),a=document.body),this.domElement=a,this.isLocked=!1;var R,d=this,v={type:"change"},g={type:"lock"},C={type:"unlock"},w=new Euler(0,0,0,"YXZ"),_=Math.PI/2,x=new Vector3;function b(R){if(!1!==d.isLocked){var O=R.movementX||R.mozMovementX||R.webkitMovementX||0,D=R.movementY||R.mozMovementY||R.webkitMovementY||0;w.setFromQuaternion(e.quaternion),w.y-=.002*O,w.x-=.002*D,w.x=Math.max(-_,Math.min(_,w.x)),e.quaternion.setFromEuler(w),d.dispatchEvent(v)}}function A(){document.pointerLockElement===d.domElement?(d.dispatchEvent(g),d.isLocked=!0):(d.dispatchEvent(C),d.isLocked=!1)}function E(){console.error("PointerLockControls: Unable to use Pointer Lock API")}this.connect=function(){document.addEventListener("mousemove",b,!1),document.addEventListener("pointerlockchange",A,!1),document.addEventListener("pointerlockerror",E,!1)},this.disconnect=function(){document.removeEventListener("mousemove",b,!1),document.removeEventListener("pointerlockchange",A,!1),document.removeEventListener("pointerlockerror",E,!1)},this.dispose=function(){this.disconnect()},this.getObject=function(){return e},this.getDirection=(R=new Vector3(0,0,-1),function(O){return O.copy(R).applyQuaternion(e.quaternion)}),this.moveForward=function(R){x.setFromMatrixColumn(e.matrix,0),x.crossVectors(e.up,x),e.position.addScaledVector(x,R)},this.moveRight=function(R){x.setFromMatrixColumn(e.matrix,0),e.position.addScaledVector(x,R)},this.lock=function(){this.domElement.requestPointerLock()},this.unlock=function(){document.exitPointerLock()},this.connect()};PointerLockControls.prototype=Object.create(EventDispatcher.prototype),PointerLockControls.prototype.constructor=PointerLockControls;var TrackballControls=function(e,a){void 0===a&&console.warn('TrackballControls: The second parameter "domElement" is now mandatory.'),a===document&&console.error('TrackballControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.');var d=this;this.object=e,this.domElement=a,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1.2,this.panSpeed=.3,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.staticMoving=!1,this.dynamicDampingFactor=.2,this.minDistance=0,this.maxDistance=1/0,this.keys=[65,83,68],this.mouseButtons={LEFT:MOUSE.ROTATE,MIDDLE:MOUSE.ZOOM,RIGHT:MOUSE.PAN},this.target=new Vector3;var g=1e-6,C=new Vector3,w=1,_=-1,x=-1,b=new Vector3,A=new Vector2,E=new Vector2,R=new Vector3,O=0,D=new Vector2,F=new Vector2,L=0,I=0,V=new Vector2,z=new Vector2;this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.up0=this.object.up.clone(),this.zoom0=this.object.zoom;var H={type:"change"},X={type:"start"},re={type:"end"};this.handleResize=function(){var $=this.domElement.getBoundingClientRect(),ue=this.domElement.ownerDocument.documentElement;this.screen.left=$.left+window.pageXOffset-ue.clientLeft,this.screen.top=$.top+window.pageYOffset-ue.clientTop,this.screen.width=$.width,this.screen.height=$.height};var $,j=($=new Vector2,function(Y,Z){return $.set((Y-d.screen.left)/d.screen.width,(Z-d.screen.top)/d.screen.height),$}),te=function(){var $=new Vector2;return function(Y,Z){return $.set((Y-.5*d.screen.width-d.screen.left)/(.5*d.screen.width),(d.screen.height+2*(d.screen.top-Z))/d.screen.width),$}}();function J($){!1!==d.enabled&&(window.removeEventListener("keydown",J),-1===x&&($.keyCode!==d.keys[0]||d.noRotate?$.keyCode!==d.keys[1]||d.noZoom?$.keyCode===d.keys[2]&&!d.noPan&&(x=2):x=1:x=0))}function k(){!1!==d.enabled&&(x=-1,window.addEventListener("keydown",J,!1))}function U($){if(!1!==d.enabled){if($.preventDefault(),$.stopPropagation(),-1===_)switch($.button){case d.mouseButtons.LEFT:_=0;break;case d.mouseButtons.MIDDLE:_=1;break;case d.mouseButtons.RIGHT:_=2;break;default:_=-1}var ue=-1!==x?x:_;0!==ue||d.noRotate?1!==ue||d.noZoom?2===ue&&!d.noPan&&(V.copy(j($.pageX,$.pageY)),z.copy(V)):(D.copy(j($.pageX,$.pageY)),F.copy(D)):(E.copy(te($.pageX,$.pageY)),A.copy(E)),document.addEventListener("mousemove",K,!1),document.addEventListener("mouseup",ee,!1),d.dispatchEvent(X)}}function K($){if(!1!==d.enabled){$.preventDefault(),$.stopPropagation();var ue=-1!==x?x:_;0!==ue||d.noRotate?1!==ue||d.noZoom?2===ue&&!d.noPan&&z.copy(j($.pageX,$.pageY)):F.copy(j($.pageX,$.pageY)):(A.copy(E),E.copy(te($.pageX,$.pageY)))}}function ee($){!1!==d.enabled&&($.preventDefault(),$.stopPropagation(),_=-1,document.removeEventListener("mousemove",K),document.removeEventListener("mouseup",ee),d.dispatchEvent(re))}function Q($){if(!1!==d.enabled&&!0!==d.noZoom){switch($.preventDefault(),$.stopPropagation(),$.deltaMode){case 2:D.y-=.025*$.deltaY;break;case 1:D.y-=.01*$.deltaY;break;default:D.y-=25e-5*$.deltaY}d.dispatchEvent(X),d.dispatchEvent(re)}}function oe($){if(!1!==d.enabled){if(1===($.preventDefault(),$.touches.length))_=3,E.copy(te($.touches[0].pageX,$.touches[0].pageY)),A.copy(E);else{_=4;var ue=$.touches[0].pageX-$.touches[1].pageX,Y=$.touches[0].pageY-$.touches[1].pageY;I=L=Math.sqrt(ue*ue+Y*Y),V.copy(j(($.touches[0].pageX+$.touches[1].pageX)/2,($.touches[0].pageY+$.touches[1].pageY)/2)),z.copy(V)}d.dispatchEvent(X)}}function me($){if(!1!==d.enabled)if(1===($.preventDefault(),$.stopPropagation(),$.touches.length))A.copy(E),E.copy(te($.touches[0].pageX,$.touches[0].pageY));else{var ue=$.touches[0].pageX-$.touches[1].pageX,Y=$.touches[0].pageY-$.touches[1].pageY;I=Math.sqrt(ue*ue+Y*Y),z.copy(j(($.touches[0].pageX+$.touches[1].pageX)/2,($.touches[0].pageY+$.touches[1].pageY)/2))}}function fe($){if(!1!==d.enabled){switch($.touches.length){case 0:_=-1;break;case 1:_=3,E.copy(te($.touches[0].pageX,$.touches[0].pageY)),A.copy(E)}d.dispatchEvent(re)}}function ge($){!1!==d.enabled&&$.preventDefault()}this.rotateCamera=function(){var le,$=new Vector3,ue=new Quaternion,Y=new Vector3,Z=new Vector3,se=new Vector3,ve=new Vector3;return function(){ve.set(E.x-A.x,E.y-A.y,0),(le=ve.length())?(b.copy(d.object.position).sub(d.target),Y.copy(b).normalize(),Z.copy(d.object.up).normalize(),se.crossVectors(Z,Y).normalize(),Z.setLength(E.y-A.y),se.setLength(E.x-A.x),ve.copy(Z.add(se)),$.crossVectors(ve,b).normalize(),ue.setFromAxisAngle($,le*=d.rotateSpeed),b.applyQuaternion(ue),d.object.up.applyQuaternion(ue),R.copy($),O=le):!d.staticMoving&&O&&(O*=Math.sqrt(1-d.dynamicDampingFactor),b.copy(d.object.position).sub(d.target),ue.setFromAxisAngle(R,O),b.applyQuaternion(ue),d.object.up.applyQuaternion(ue)),A.copy(E)}}(),this.zoomCamera=function(){var $;4===_?($=L/I,L=I,d.object.isPerspectiveCamera?b.multiplyScalar($):d.object.isOrthographicCamera?(d.object.zoom*=$,d.object.updateProjectionMatrix()):console.warn("TrackballControls: Unsupported camera type")):(1!=($=1+(F.y-D.y)*d.zoomSpeed)&&$>0&&(d.object.isPerspectiveCamera?b.multiplyScalar($):d.object.isOrthographicCamera?(d.object.zoom/=$,d.object.updateProjectionMatrix()):console.warn("TrackballControls: Unsupported camera type")),d.staticMoving?D.copy(F):D.y+=(F.y-D.y)*this.dynamicDampingFactor)},this.panCamera=function(){var $=new Vector2,ue=new Vector3,Y=new Vector3;return function(){if($.copy(z).sub(V),$.lengthSq()){if(d.object.isOrthographicCamera){var ve=(d.object.top-d.object.bottom)/d.object.zoom/d.domElement.clientWidth;$.x*=(d.object.right-d.object.left)/d.object.zoom/d.domElement.clientWidth,$.y*=ve}$.multiplyScalar(b.length()*d.panSpeed),Y.copy(b).cross(d.object.up).setLength($.x),Y.add(ue.copy(d.object.up).setLength($.y)),d.object.position.add(Y),d.target.add(Y),d.staticMoving?V.copy(z):V.add($.subVectors(z,V).multiplyScalar(d.dynamicDampingFactor))}}}(),this.checkDistances=function(){(!d.noZoom||!d.noPan)&&(b.lengthSq()>d.maxDistance*d.maxDistance&&(d.object.position.addVectors(d.target,b.setLength(d.maxDistance)),D.copy(F)),b.lengthSq()<d.minDistance*d.minDistance&&(d.object.position.addVectors(d.target,b.setLength(d.minDistance)),D.copy(F)))},this.update=function(){b.subVectors(d.object.position,d.target),d.noRotate||d.rotateCamera(),d.noZoom||d.zoomCamera(),d.noPan||d.panCamera(),d.object.position.addVectors(d.target,b),d.object.isPerspectiveCamera?(d.checkDistances(),d.object.lookAt(d.target),C.distanceToSquared(d.object.position)>g&&(d.dispatchEvent(H),C.copy(d.object.position))):d.object.isOrthographicCamera?(d.object.lookAt(d.target),(C.distanceToSquared(d.object.position)>g||w!==d.object.zoom)&&(d.dispatchEvent(H),C.copy(d.object.position),w=d.object.zoom)):console.warn("TrackballControls: Unsupported camera type")},this.reset=function(){_=-1,x=-1,d.target.copy(d.target0),d.object.position.copy(d.position0),d.object.up.copy(d.up0),d.object.zoom=d.zoom0,d.object.updateProjectionMatrix(),b.subVectors(d.object.position,d.target),d.object.lookAt(d.target),d.dispatchEvent(H),C.copy(d.object.position),w=d.object.zoom},this.dispose=function(){this.domElement.removeEventListener("contextmenu",ge,!1),this.domElement.removeEventListener("mousedown",U,!1),this.domElement.removeEventListener("wheel",Q,!1),this.domElement.removeEventListener("touchstart",oe,!1),this.domElement.removeEventListener("touchend",fe,!1),this.domElement.removeEventListener("touchmove",me,!1),document.removeEventListener("mousemove",K,!1),document.removeEventListener("mouseup",ee,!1),window.removeEventListener("keydown",J,!1),window.removeEventListener("keyup",k,!1)},this.domElement.addEventListener("contextmenu",ge,!1),this.domElement.addEventListener("mousedown",U,!1),this.domElement.addEventListener("wheel",Q,!1),this.domElement.addEventListener("touchstart",oe,!1),this.domElement.addEventListener("touchend",fe,!1),this.domElement.addEventListener("touchmove",me,!1),window.addEventListener("keydown",J,!1),window.addEventListener("keyup",k,!1),this.handleResize(),this.update()};function PolyhedronGeometry(s,e,a,d){Geometry.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:s,indices:e,radius:a,detail:d},this.fromBufferGeometry(new PolyhedronBufferGeometry(s,e,a,d)),this.mergeVertices()}function PolyhedronBufferGeometry(s,e,a,d){BufferGeometry.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:s,indices:e,radius:a,detail:d},a=a||1;var v=[],g=[];function w(L,I,V,z){var re,j,H=Math.pow(2,z),X=[];for(re=0;re<=H;re++){X[re]=[];var te=L.clone().lerp(V,re/H),J=I.clone().lerp(V,re/H),k=H-re;for(j=0;j<=k;j++)X[re][j]=0===j&&re===H?te:te.clone().lerp(J,j/k)}for(re=0;re<H;re++)for(j=0;j<2*(H-re)-1;j++){var U=Math.floor(j/2);j%2==0?(A(X[re][U+1]),A(X[re+1][U]),A(X[re][U])):(A(X[re][U+1]),A(X[re+1][U+1]),A(X[re+1][U]))}}function A(L){v.push(L.x,L.y,L.z)}function E(L,I){var V=3*L;I.x=s[V+0],I.y=s[V+1],I.z=s[V+2]}function O(L,I,V,z){z<0&&1===L.x&&(g[I]=L.x-1),0===V.x&&0===V.z&&(g[I]=z/2/Math.PI+.5)}function D(L){return Math.atan2(L.z,-L.x)}function F(L){return Math.atan2(-L.y,Math.sqrt(L.x*L.x+L.z*L.z))}(function(L){for(var I=new Vector3,V=new Vector3,z=new Vector3,H=0;H<e.length;H+=3)E(e[H+0],I),E(e[H+1],V),E(e[H+2],z),w(I,V,z,L)})(d=d||0),function(L){for(var I=new Vector3,V=0;V<v.length;V+=3)I.x=v[V+0],I.y=v[V+1],I.z=v[V+2],I.normalize().multiplyScalar(L),v[V+0]=I.x,v[V+1]=I.y,v[V+2]=I.z}(a),function(){for(var L=new Vector3,I=0;I<v.length;I+=3){L.x=v[I+0],L.y=v[I+1],L.z=v[I+2];var V=D(L)/2/Math.PI+.5,z=F(L)/Math.PI+.5;g.push(V,1-z)}(function(){for(var L=new Vector3,I=new Vector3,V=new Vector3,z=new Vector3,H=new Vector2,X=new Vector2,re=new Vector2,j=0,te=0;j<v.length;j+=9,te+=6){L.set(v[j+0],v[j+1],v[j+2]),I.set(v[j+3],v[j+4],v[j+5]),V.set(v[j+6],v[j+7],v[j+8]),H.set(g[te+0],g[te+1]),X.set(g[te+2],g[te+3]),re.set(g[te+4],g[te+5]),z.copy(L).add(I).add(V).divideScalar(3);var J=D(z);O(H,te+0,L,J),O(X,te+2,I,J),O(re,te+4,V,J)}})(),function(){for(var L=0;L<g.length;L+=6){var I=g[L+0],V=g[L+2],z=g[L+4],H=Math.max(I,V,z),X=Math.min(I,V,z);H>.9&&X<.1&&(I<.2&&(g[L+0]+=1),V<.2&&(g[L+2]+=1),z<.2&&(g[L+4]+=1))}}()}(),this.setAttribute("position",new Float32BufferAttribute(v,3)),this.setAttribute("normal",new Float32BufferAttribute(v.slice(),3)),this.setAttribute("uv",new Float32BufferAttribute(g,2)),0===d?this.computeVertexNormals():this.normalizeNormals()}function OctahedronGeometry(s,e){Geometry.call(this),this.type="OctahedronGeometry",this.parameters={radius:s,detail:e},this.fromBufferGeometry(new OctahedronBufferGeometry(s,e)),this.mergeVertices()}function OctahedronBufferGeometry(s,e){PolyhedronBufferGeometry.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],s,e),this.type="OctahedronBufferGeometry",this.parameters={radius:s,detail:e}}function TorusGeometry(s,e,a,d,v){Geometry.call(this),this.type="TorusGeometry",this.parameters={radius:s,tube:e,radialSegments:a,tubularSegments:d,arc:v},this.fromBufferGeometry(new TorusBufferGeometry(s,e,a,d,v)),this.mergeVertices()}function TorusBufferGeometry(s,e,a,d,v){BufferGeometry.call(this),this.type="TorusBufferGeometry",this.parameters={radius:s,tube:e,radialSegments:a,tubularSegments:d,arc:v},s=s||1,e=e||.4,a=Math.floor(a)||8,d=Math.floor(d)||6,v=v||2*Math.PI;var E,R,g=[],C=[],w=[],_=[],x=new Vector3,b=new Vector3,A=new Vector3;for(E=0;E<=a;E++)for(R=0;R<=d;R++){var O=R/d*v,D=E/a*Math.PI*2;b.x=(s+e*Math.cos(D))*Math.cos(O),b.y=(s+e*Math.cos(D))*Math.sin(O),b.z=e*Math.sin(D),C.push(b.x,b.y,b.z),x.x=s*Math.cos(O),x.y=s*Math.sin(O),A.subVectors(b,x).normalize(),w.push(A.x,A.y,A.z),_.push(R/d),_.push(E/a)}for(E=1;E<=a;E++)for(R=1;R<=d;R++){var L=(d+1)*(E-1)+R-1,I=(d+1)*(E-1)+R,V=(d+1)*E+R;g.push((d+1)*E+R-1,L,V),g.push(L,I,V)}this.setIndex(g),this.setAttribute("position",new Float32BufferAttribute(C,3)),this.setAttribute("normal",new Float32BufferAttribute(w,3)),this.setAttribute("uv",new Float32BufferAttribute(_,2))}TrackballControls.prototype=Object.create(EventDispatcher.prototype),TrackballControls.prototype.constructor=TrackballControls,PolyhedronGeometry.prototype=Object.create(Geometry.prototype),PolyhedronGeometry.prototype.constructor=PolyhedronGeometry,PolyhedronBufferGeometry.prototype=Object.create(BufferGeometry.prototype),PolyhedronBufferGeometry.prototype.constructor=PolyhedronBufferGeometry,OctahedronGeometry.prototype=Object.create(Geometry.prototype),OctahedronGeometry.prototype.constructor=OctahedronGeometry,OctahedronBufferGeometry.prototype=Object.create(PolyhedronBufferGeometry.prototype),OctahedronBufferGeometry.prototype.constructor=OctahedronBufferGeometry,TorusGeometry.prototype=Object.create(Geometry.prototype),TorusGeometry.prototype.constructor=TorusGeometry,TorusBufferGeometry.prototype=Object.create(BufferGeometry.prototype),TorusBufferGeometry.prototype.constructor=TorusBufferGeometry;var TransformControls=function(e,a){void 0===a&&(console.warn('TransformControls: The second parameter "domElement" is now mandatory.'),a=document),Object3D.call(this),this.visible=!1,this.domElement=a;var d=new TransformControlsGizmo;this.add(d);var v=new TransformControlsPlane;this.add(v);var g=this;se("camera",e),se("object",void 0),se("enabled",!0),se("axis",null),se("mode","translate"),se("translationSnap",null),se("rotationSnap",null),se("scaleSnap",null),se("space","world"),se("size",1),se("dragging",!1),se("showX",!0),se("showY",!0),se("showZ",!0);var C={type:"change"},w={type:"mouseDown"},_={type:"mouseUp",mode:g.mode},x={type:"objectChange"},b=new Raycaster,A=new Vector3,E=new Vector3,R=new Quaternion,O={X:new Vector3(1,0,0),Y:new Vector3(0,1,0),Z:new Vector3(0,0,1)},D=new Vector3,F=new Vector3,L=new Vector3,I=new Vector3,V=new Vector3,z=new Vector3,H=0,X=new Vector3,re=new Quaternion,j=new Vector3,te=new Vector3,J=new Quaternion,k=new Quaternion,U=new Vector3,K=new Vector3,ee=new Quaternion,Q=new Vector3,oe=new Vector3,me=new Quaternion,fe=new Quaternion,ge=new Vector3,$=new Vector3,ue=new Vector3,Y=new Quaternion,Z=new Vector3;function se(he,ce){var Te=ce;Object.defineProperty(g,he,{get:function(){return void 0!==Te?Te:ce},set:function(xe){Te!==xe&&(Te=xe,v[he]=xe,d[he]=xe,g.dispatchEvent({type:he+"-changed",value:xe}),g.dispatchEvent(C))}}),g[he]=ce,v[he]=ce,d[he]=ce}function ve(he){if(document.pointerLockElement)return{x:0,y:0,button:he.button};var ce=he.changedTouches?he.changedTouches[0]:he,Te=a.getBoundingClientRect();return{x:(ce.clientX-Te.left)/Te.width*2-1,y:-(ce.clientY-Te.top)/Te.height*2+1,button:he.button}}function le(he){!g.enabled||g.pointerHover(ve(he))}function _e(he){!g.enabled||(document.addEventListener("mousemove",ae,!1),g.pointerHover(ve(he)),g.pointerDown(ve(he)))}function ae(he){!g.enabled||g.pointerMove(ve(he))}function pe(he){!g.enabled||(document.removeEventListener("mousemove",ae,!1),g.pointerUp(ve(he)))}se("worldPosition",oe),se("worldPositionStart",K),se("worldQuaternion",me),se("worldQuaternionStart",ee),se("cameraPosition",X),se("cameraQuaternion",re),se("pointStart",D),se("pointEnd",F),se("rotationAxis",I),se("rotationAngle",H),se("eye",$),a.addEventListener("mousedown",_e,!1),a.addEventListener("touchstart",_e,!1),a.addEventListener("mousemove",le,!1),a.addEventListener("touchmove",le,!1),a.addEventListener("touchmove",ae,!1),document.addEventListener("mouseup",pe,!1),a.addEventListener("touchend",pe,!1),a.addEventListener("touchcancel",pe,!1),a.addEventListener("touchleave",pe,!1),this.dispose=function(){a.removeEventListener("mousedown",_e),a.removeEventListener("touchstart",_e),a.removeEventListener("mousemove",le),document.removeEventListener("mousemove",ae),a.removeEventListener("touchmove",le),a.removeEventListener("touchmove",ae),document.removeEventListener("mouseup",pe),a.removeEventListener("touchend",pe),a.removeEventListener("touchcancel",pe),a.removeEventListener("touchleave",pe),this.traverse(function(he){he.geometry&&he.geometry.dispose(),he.material&&he.material.dispose()})},this.attach=function(he){return this.object=he,this.visible=!0,this},this.detach=function(){return this.object=void 0,this.visible=!1,this.axis=null,this},this.updateMatrixWorld=function(){void 0!==this.object&&(this.object.updateMatrixWorld(),this.object.parent.matrixWorld.decompose(te,J,U),this.object.matrixWorld.decompose(oe,me,ge),k.copy(J).inverse(),fe.copy(me).inverse()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(X,re,j),$.copy(X).sub(oe).normalize(),Object3D.prototype.updateMatrixWorld.call(this)},this.pointerHover=function(he){if(void 0!==this.object&&!0!==this.dragging&&(void 0===he.button||0===he.button)){b.setFromCamera(he,this.camera);var ce=b.intersectObjects(d.picker[this.mode].children,!0)[0]||!1;this.axis=ce?ce.object.name:null}},this.pointerDown=function(he){if(!(void 0===this.object||!0===this.dragging||void 0!==he.button&&0!==he.button||0!==he.button&&void 0!==he.button||null===this.axis)){b.setFromCamera(he,this.camera);var ce=b.intersectObjects([v],!0)[0]||!1;if(ce){var Te=this.space;if("scale"===this.mode?Te="local":("E"===this.axis||"XYZE"===this.axis||"XYZ"===this.axis)&&(Te="world"),"local"===Te&&"rotate"===this.mode){var be=this.rotationSnap;"X"===this.axis&&be&&(this.object.rotation.x=Math.round(this.object.rotation.x/be)*be),"Y"===this.axis&&be&&(this.object.rotation.y=Math.round(this.object.rotation.y/be)*be),"Z"===this.axis&&be&&(this.object.rotation.z=Math.round(this.object.rotation.z/be)*be)}this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),ue.copy(this.object.position),Y.copy(this.object.quaternion),Z.copy(this.object.scale),this.object.matrixWorld.decompose(K,ee,Q),D.copy(ce.point).sub(K)}this.dragging=!0,w.mode=this.mode,this.dispatchEvent(w)}},this.pointerMove=function(he){var ce=this.axis,Te=this.mode,be=this.object,xe=this.space;if("scale"===Te?xe="local":("E"===ce||"XYZE"===ce||"XYZ"===ce)&&(xe="world"),void 0!==be&&null!==ce&&!1!==this.dragging&&(void 0===he.button||0===he.button)){b.setFromCamera(he,this.camera);var we=b.intersectObjects([v],!0)[0]||!1;if(!1!==we){if(F.copy(we.point).sub(K),"translate"===Te)L.copy(F).sub(D),"local"===xe&&"XYZ"!==ce&&L.applyQuaternion(fe),-1===ce.indexOf("X")&&(L.x=0),-1===ce.indexOf("Y")&&(L.y=0),-1===ce.indexOf("Z")&&(L.z=0),"local"===xe&&"XYZ"!==ce?L.applyQuaternion(Y).divide(U):L.applyQuaternion(k).divide(U),be.position.copy(L).add(ue),this.translationSnap&&("local"===xe&&(be.position.applyQuaternion(R.copy(Y).inverse()),-1!==ce.search("X")&&(be.position.x=Math.round(be.position.x/this.translationSnap)*this.translationSnap),-1!==ce.search("Y")&&(be.position.y=Math.round(be.position.y/this.translationSnap)*this.translationSnap),-1!==ce.search("Z")&&(be.position.z=Math.round(be.position.z/this.translationSnap)*this.translationSnap),be.position.applyQuaternion(Y)),"world"===xe&&(be.parent&&be.position.add(A.setFromMatrixPosition(be.parent.matrixWorld)),-1!==ce.search("X")&&(be.position.x=Math.round(be.position.x/this.translationSnap)*this.translationSnap),-1!==ce.search("Y")&&(be.position.y=Math.round(be.position.y/this.translationSnap)*this.translationSnap),-1!==ce.search("Z")&&(be.position.z=Math.round(be.position.z/this.translationSnap)*this.translationSnap),be.parent&&be.position.sub(A.setFromMatrixPosition(be.parent.matrixWorld))));else if("scale"===Te){if(-1!==ce.search("XYZ")){var Ne=F.length()/D.length();F.dot(D)<0&&(Ne*=-1),E.set(Ne,Ne,Ne)}else A.copy(D),E.copy(F),A.applyQuaternion(fe),E.applyQuaternion(fe),E.divide(A),-1===ce.search("X")&&(E.x=1),-1===ce.search("Y")&&(E.y=1),-1===ce.search("Z")&&(E.z=1);be.scale.copy(Z).multiply(E),this.scaleSnap&&(-1!==ce.search("X")&&(be.scale.x=Math.round(be.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==ce.search("Y")&&(be.scale.y=Math.round(be.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==ce.search("Z")&&(be.scale.z=Math.round(be.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===Te){L.copy(F).sub(D);var Re=20/oe.distanceTo(A.setFromMatrixPosition(this.camera.matrixWorld));"E"===ce?(I.copy($),H=F.angleTo(D),V.copy(D).normalize(),z.copy(F).normalize(),H*=z.cross(V).dot($)<0?1:-1):"XYZE"===ce?(I.copy(L).cross($).normalize(),H=L.dot(A.copy(I).cross(this.eye))*Re):("X"===ce||"Y"===ce||"Z"===ce)&&(I.copy(O[ce]),A.copy(O[ce]),"local"===xe&&A.applyQuaternion(me),H=L.dot(A.cross($).normalize())*Re),this.rotationSnap&&(H=Math.round(H/this.rotationSnap)*this.rotationSnap),this.rotationAngle=H,"local"===xe&&"E"!==ce&&"XYZE"!==ce?(be.quaternion.copy(Y),be.quaternion.multiply(R.setFromAxisAngle(I,H)).normalize()):(I.applyQuaternion(k),be.quaternion.copy(R.setFromAxisAngle(I,H)),be.quaternion.multiply(Y).normalize())}this.dispatchEvent(C),this.dispatchEvent(x)}}},this.pointerUp=function(he){void 0!==he.button&&0!==he.button||(this.dragging&&null!==this.axis&&(_.mode=this.mode,this.dispatchEvent(_)),this.dragging=!1,void 0===he.button&&(this.axis=null))},this.getMode=function(){return g.mode},this.setMode=function(he){g.mode=he},this.setTranslationSnap=function(he){g.translationSnap=he},this.setRotationSnap=function(he){g.rotationSnap=he},this.setScaleSnap=function(he){g.scaleSnap=he},this.setSize=function(he){g.size=he},this.setSpace=function(he){g.space=he},this.update=function(){console.warn("TransformControls: update function has no more functionality and therefore has been deprecated.")}};TransformControls.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:TransformControls,isTransformControls:!0});var TransformControlsGizmo=function(){Object3D.call(this),this.type="TransformControlsGizmo";var e=new MeshBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,side:DoubleSide,fog:!1}),a=new LineBasicMaterial({depthTest:!1,depthWrite:!1,transparent:!0,linewidth:1,fog:!1}),d=e.clone();d.opacity=.15;var v=e.clone();v.opacity=.33;var g=e.clone();g.color.set(16711680);var C=e.clone();C.color.set(65280);var w=e.clone();w.color.set(255);var _=e.clone();_.opacity=.25;var x=_.clone();x.color.set(16776960);var b=_.clone();b.color.set(65535);var A=_.clone();A.color.set(16711935),e.clone().color.set(16776960);var R=a.clone();R.color.set(16711680);var O=a.clone();O.color.set(65280);var D=a.clone();D.color.set(255);var F=a.clone();F.color.set(65535);var L=a.clone();L.color.set(16711935);var I=a.clone();I.color.set(16776960);var V=a.clone();V.color.set(7895160);var z=I.clone();z.opacity=.25;var H=new CylinderBufferGeometry(0,.05,.2,12,1,!1),X=new BoxBufferGeometry(.125,.125,.125),re=new BufferGeometry;re.setAttribute("position",new Float32BufferAttribute([0,0,0,1,0,0],3));var Te,j=function(Te,be){for(var xe=new BufferGeometry,we=[],Ne=0;Ne<=64*be;++Ne)we.push(0,Math.cos(Ne/32*Math.PI)*Te,Math.sin(Ne/32*Math.PI)*Te);return xe.setAttribute("position",new Float32BufferAttribute(we,3)),xe},J={X:[[new Mesh(H,g),[1,0,0],[0,0,-Math.PI/2],null,"fwd"],[new Mesh(H,g),[1,0,0],[0,0,Math.PI/2],null,"bwd"],[new Line(re,R)]],Y:[[new Mesh(H,C),[0,1,0],null,null,"fwd"],[new Mesh(H,C),[0,1,0],[Math.PI,0,0],null,"bwd"],[new Line(re,O),null,[0,0,Math.PI/2]]],Z:[[new Mesh(H,w),[0,0,1],[Math.PI/2,0,0],null,"fwd"],[new Mesh(H,w),[0,0,1],[-Math.PI/2,0,0],null,"bwd"],[new Line(re,D),null,[0,-Math.PI/2,0]]],XYZ:[[new Mesh(new OctahedronBufferGeometry(.1,0),_.clone()),[0,0,0],[0,0,0]]],XY:[[new Mesh(new PlaneBufferGeometry(.295,.295),x.clone()),[.15,.15,0]],[new Line(re,I),[.18,.3,0],null,[.125,1,1]],[new Line(re,I),[.3,.18,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new Mesh(new PlaneBufferGeometry(.295,.295),b.clone()),[0,.15,.15],[0,Math.PI/2,0]],[new Line(re,F),[0,.18,.3],[0,0,Math.PI/2],[.125,1,1]],[new Line(re,F),[0,.3,.18],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new Mesh(new PlaneBufferGeometry(.295,.295),A.clone()),[.15,0,.15],[-Math.PI/2,0,0]],[new Line(re,L),[.18,0,.3],null,[.125,1,1]],[new Line(re,L),[.3,0,.18],[0,-Math.PI/2,0],[.125,1,1]]]},k={X:[[new Mesh(new CylinderBufferGeometry(.2,0,1,4,1,!1),d),[.6,0,0],[0,0,-Math.PI/2]]],Y:[[new Mesh(new CylinderBufferGeometry(.2,0,1,4,1,!1),d),[0,.6,0]]],Z:[[new Mesh(new CylinderBufferGeometry(.2,0,1,4,1,!1),d),[0,0,.6],[Math.PI/2,0,0]]],XYZ:[[new Mesh(new OctahedronBufferGeometry(.2,0),d)]],XY:[[new Mesh(new PlaneBufferGeometry(.4,.4),d),[.2,.2,0]]],YZ:[[new Mesh(new PlaneBufferGeometry(.4,.4),d),[0,.2,.2],[0,Math.PI/2,0]]],XZ:[[new Mesh(new PlaneBufferGeometry(.4,.4),d),[.2,0,.2],[-Math.PI/2,0,0]]]},U={START:[[new Mesh(new OctahedronBufferGeometry(.01,2),v),null,null,null,"helper"]],END:[[new Mesh(new OctahedronBufferGeometry(.01,2),v),null,null,null,"helper"]],DELTA:[[new Line((Te=new BufferGeometry,Te.setAttribute("position",new Float32BufferAttribute([0,0,0,1,1,1],3)),Te),v),null,null,null,"helper"]],X:[[new Line(re,v.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Line(re,v.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Line(re,v.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},K={X:[[new Line(j(1,.5),R)],[new Mesh(new OctahedronBufferGeometry(.04,0),g),[0,0,.99],null,[1,3,1]]],Y:[[new Line(j(1,.5),O),null,[0,0,-Math.PI/2]],[new Mesh(new OctahedronBufferGeometry(.04,0),C),[0,0,.99],null,[3,1,1]]],Z:[[new Line(j(1,.5),D),null,[0,Math.PI/2,0]],[new Mesh(new OctahedronBufferGeometry(.04,0),w),[.99,0,0],null,[1,3,1]]],E:[[new Line(j(1.25,1),z),null,[0,Math.PI/2,0]],[new Mesh(new CylinderBufferGeometry(.03,0,.15,4,1,!1),z),[1.17,0,0],[0,0,-Math.PI/2],[1,1,.001]],[new Mesh(new CylinderBufferGeometry(.03,0,.15,4,1,!1),z),[-1.17,0,0],[0,0,Math.PI/2],[1,1,.001]],[new Mesh(new CylinderBufferGeometry(.03,0,.15,4,1,!1),z),[0,-1.17,0],[Math.PI,0,0],[1,1,.001]],[new Mesh(new CylinderBufferGeometry(.03,0,.15,4,1,!1),z),[0,1.17,0],[0,0,0],[1,1,.001]]],XYZE:[[new Line(j(1,1),V),null,[0,Math.PI/2,0]]]},ee={AXIS:[[new Line(re,v.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},Q={X:[[new Mesh(new TorusBufferGeometry(1,.1,4,24),d),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new Mesh(new TorusBufferGeometry(1,.1,4,24),d),[0,0,0],[Math.PI/2,0,0]]],Z:[[new Mesh(new TorusBufferGeometry(1,.1,4,24),d),[0,0,0],[0,0,-Math.PI/2]]],E:[[new Mesh(new TorusBufferGeometry(1.25,.1,2,24),d)]],XYZE:[[new Mesh(new SphereBufferGeometry(.7,10,8),d)]]},oe={X:[[new Mesh(X,g),[.8,0,0],[0,0,-Math.PI/2]],[new Line(re,R),null,null,[.8,1,1]]],Y:[[new Mesh(X,C),[0,.8,0]],[new Line(re,O),null,[0,0,Math.PI/2],[.8,1,1]]],Z:[[new Mesh(X,w),[0,0,.8],[Math.PI/2,0,0]],[new Line(re,D),null,[0,-Math.PI/2,0],[.8,1,1]]],XY:[[new Mesh(X,x),[.85,.85,0],null,[2,2,.2]],[new Line(re,I),[.855,.98,0],null,[.125,1,1]],[new Line(re,I),[.98,.855,0],[0,0,Math.PI/2],[.125,1,1]]],YZ:[[new Mesh(X,b),[0,.85,.85],null,[.2,2,2]],[new Line(re,F),[0,.855,.98],[0,0,Math.PI/2],[.125,1,1]],[new Line(re,F),[0,.98,.855],[0,-Math.PI/2,0],[.125,1,1]]],XZ:[[new Mesh(X,A),[.85,0,.85],null,[2,.2,2]],[new Line(re,L),[.855,0,.98],null,[.125,1,1]],[new Line(re,L),[.98,0,.855],[0,-Math.PI/2,0],[.125,1,1]]],XYZX:[[new Mesh(new BoxBufferGeometry(.125,.125,.125),_.clone()),[1.1,0,0]]],XYZY:[[new Mesh(new BoxBufferGeometry(.125,.125,.125),_.clone()),[0,1.1,0]]],XYZZ:[[new Mesh(new BoxBufferGeometry(.125,.125,.125),_.clone()),[0,0,1.1]]]},me={X:[[new Mesh(new CylinderBufferGeometry(.2,0,.8,4,1,!1),d),[.5,0,0],[0,0,-Math.PI/2]]],Y:[[new Mesh(new CylinderBufferGeometry(.2,0,.8,4,1,!1),d),[0,.5,0]]],Z:[[new Mesh(new CylinderBufferGeometry(.2,0,.8,4,1,!1),d),[0,0,.5],[Math.PI/2,0,0]]],XY:[[new Mesh(X,d),[.85,.85,0],null,[3,3,.2]]],YZ:[[new Mesh(X,d),[0,.85,.85],null,[.2,3,3]]],XZ:[[new Mesh(X,d),[.85,0,.85],null,[3,.2,3]]],XYZX:[[new Mesh(new BoxBufferGeometry(.2,.2,.2),d),[1.1,0,0]]],XYZY:[[new Mesh(new BoxBufferGeometry(.2,.2,.2),d),[0,1.1,0]]],XYZZ:[[new Mesh(new BoxBufferGeometry(.2,.2,.2),d),[0,0,1.1]]]},fe={X:[[new Line(re,v.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Line(re,v.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Line(re,v.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},ge=function(Te){var be=new Object3D;for(var xe in Te)for(var we=Te[xe].length;we--;){var Ne=Te[xe][we][0].clone(),Re=Te[xe][we][1],De=Te[xe][we][2],Je=Te[xe][we][3],$e=Te[xe][we][4];Ne.name=xe,Ne.tag=$e,Re&&Ne.position.set(Re[0],Re[1],Re[2]),De&&Ne.rotation.set(De[0],De[1],De[2]),Je&&Ne.scale.set(Je[0],Je[1],Je[2]),Ne.updateMatrix();var pt=Ne.geometry.clone();pt.applyMatrix4(Ne.matrix),Ne.geometry=pt,Ne.renderOrder=1/0,Ne.position.set(0,0,0),Ne.rotation.set(0,0,0),Ne.scale.set(1,1,1),be.add(Ne)}return be},$=new Vector3(0,0,0),ue=new Euler,Y=new Vector3(0,1,0),Z=new Vector3(0,0,0),se=new Matrix4,ve=new Quaternion,le=new Quaternion,_e=new Quaternion,ae=new Vector3(1,0,0),pe=new Vector3(0,1,0),he=new Vector3(0,0,1);this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=ge(J)),this.add(this.gizmo.rotate=ge(K)),this.add(this.gizmo.scale=ge(oe)),this.add(this.picker.translate=ge(k)),this.add(this.picker.rotate=ge(Q)),this.add(this.picker.scale=ge(me)),this.add(this.helper.translate=ge(U)),this.add(this.helper.rotate=ge(ee)),this.add(this.helper.scale=ge(fe)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1,this.updateMatrixWorld=function(){var ce=this.space;"scale"===this.mode&&(ce="local");var Te="local"===ce?this.worldQuaternion:_e;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;var be=[];be=(be=(be=be.concat(this.picker[this.mode].children)).concat(this.gizmo[this.mode].children)).concat(this.helper[this.mode].children);for(var xe=0;xe<be.length;xe++){var we=be[xe];we.visible=!0,we.rotation.set(0,0,0),we.position.copy(this.worldPosition);var Ne=this.worldPosition.distanceTo(this.cameraPosition);we.scale.set(1,1,1).multiplyScalar(Ne*this.size/7),"helper"!==we.tag?(we.quaternion.copy(Te),"translate"===this.mode||"scale"===this.mode?(("X"===we.name||"XYZX"===we.name)&&Math.abs(Y.copy(ae).applyQuaternion(Te).dot(this.eye))>.99&&(we.scale.set(1e-10,1e-10,1e-10),we.visible=!1),("Y"===we.name||"XYZY"===we.name)&&Math.abs(Y.copy(pe).applyQuaternion(Te).dot(this.eye))>.99&&(we.scale.set(1e-10,1e-10,1e-10),we.visible=!1),("Z"===we.name||"XYZZ"===we.name)&&Math.abs(Y.copy(he).applyQuaternion(Te).dot(this.eye))>.99&&(we.scale.set(1e-10,1e-10,1e-10),we.visible=!1),"XY"===we.name&&Math.abs(Y.copy(he).applyQuaternion(Te).dot(this.eye))<.2&&(we.scale.set(1e-10,1e-10,1e-10),we.visible=!1),"YZ"===we.name&&Math.abs(Y.copy(ae).applyQuaternion(Te).dot(this.eye))<.2&&(we.scale.set(1e-10,1e-10,1e-10),we.visible=!1),"XZ"===we.name&&Math.abs(Y.copy(pe).applyQuaternion(Te).dot(this.eye))<.2&&(we.scale.set(1e-10,1e-10,1e-10),we.visible=!1),-1!==we.name.search("X")&&(Y.copy(ae).applyQuaternion(Te).dot(this.eye)<0?"fwd"===we.tag?we.visible=!1:we.scale.x*=-1:"bwd"===we.tag&&(we.visible=!1)),-1!==we.name.search("Y")&&(Y.copy(pe).applyQuaternion(Te).dot(this.eye)<0?"fwd"===we.tag?we.visible=!1:we.scale.y*=-1:"bwd"===we.tag&&(we.visible=!1)),-1!==we.name.search("Z")&&(Y.copy(he).applyQuaternion(Te).dot(this.eye)<0?"fwd"===we.tag?we.visible=!1:we.scale.z*=-1:"bwd"===we.tag&&(we.visible=!1))):"rotate"===this.mode&&(le.copy(Te),Y.copy(this.eye).applyQuaternion(ve.copy(Te).inverse()),-1!==we.name.search("E")&&we.quaternion.setFromRotationMatrix(se.lookAt(this.eye,Z,pe)),"X"===we.name&&(ve.setFromAxisAngle(ae,Math.atan2(-Y.y,Y.z)),ve.multiplyQuaternions(le,ve),we.quaternion.copy(ve)),"Y"===we.name&&(ve.setFromAxisAngle(pe,Math.atan2(Y.x,Y.z)),ve.multiplyQuaternions(le,ve),we.quaternion.copy(ve)),"Z"===we.name&&(ve.setFromAxisAngle(he,Math.atan2(Y.y,Y.x)),ve.multiplyQuaternions(le,ve),we.quaternion.copy(ve))),we.visible=we.visible&&(-1===we.name.indexOf("X")||this.showX),we.visible=we.visible&&(-1===we.name.indexOf("Y")||this.showY),we.visible=we.visible&&(-1===we.name.indexOf("Z")||this.showZ),we.visible=we.visible&&(-1===we.name.indexOf("E")||this.showX&&this.showY&&this.showZ),we.material._opacity=we.material._opacity||we.material.opacity,we.material._color=we.material._color||we.material.color.clone(),we.material.color.copy(we.material._color),we.material.opacity=we.material._opacity,this.enabled?this.axis&&(we.name===this.axis||this.axis.split("").some(function($e){return we.name===$e})?(we.material.opacity=1,we.material.color.lerp(new Color(1,1,1),.5)):(we.material.opacity*=.25,we.material.color.lerp(new Color(1,1,1),.5))):(we.material.opacity*=.5,we.material.color.lerp(new Color(1,1,1),.5))):(we.visible=!1,"AXIS"===we.name?(we.position.copy(this.worldPositionStart),we.visible=!!this.axis,"X"===this.axis&&(ve.setFromEuler(ue.set(0,0,0)),we.quaternion.copy(Te).multiply(ve),Math.abs(Y.copy(ae).applyQuaternion(Te).dot(this.eye))>.9&&(we.visible=!1)),"Y"===this.axis&&(ve.setFromEuler(ue.set(0,0,Math.PI/2)),we.quaternion.copy(Te).multiply(ve),Math.abs(Y.copy(pe).applyQuaternion(Te).dot(this.eye))>.9&&(we.visible=!1)),"Z"===this.axis&&(ve.setFromEuler(ue.set(0,Math.PI/2,0)),we.quaternion.copy(Te).multiply(ve),Math.abs(Y.copy(he).applyQuaternion(Te).dot(this.eye))>.9&&(we.visible=!1)),"XYZE"===this.axis&&(ve.setFromEuler(ue.set(0,Math.PI/2,0)),Y.copy(this.rotationAxis),we.quaternion.setFromRotationMatrix(se.lookAt(Z,Y,pe)),we.quaternion.multiply(ve),we.visible=this.dragging),"E"===this.axis&&(we.visible=!1)):"START"===we.name?(we.position.copy(this.worldPositionStart),we.visible=this.dragging):"END"===we.name?(we.position.copy(this.worldPosition),we.visible=this.dragging):"DELTA"===we.name?(we.position.copy(this.worldPositionStart),we.quaternion.copy(this.worldQuaternionStart),$.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),$.applyQuaternion(this.worldQuaternionStart.clone().inverse()),we.scale.copy($),we.visible=this.dragging):(we.quaternion.copy(Te),we.position.copy(this.dragging?this.worldPositionStart:this.worldPosition),this.axis&&(we.visible=-1!==this.axis.search(we.name))))}Object3D.prototype.updateMatrixWorld.call(this)}};TransformControlsGizmo.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:TransformControlsGizmo,isTransformControlsGizmo:!0});var TransformControlsPlane=function(){Mesh.call(this,new PlaneBufferGeometry(1e5,1e5,2,2),new MeshBasicMaterial({visible:!1,wireframe:!0,side:DoubleSide,transparent:!0,opacity:.1})),this.type="TransformControlsPlane";var e=new Vector3(1,0,0),a=new Vector3(0,1,0),d=new Vector3(0,0,1),v=new Vector3,g=new Vector3,C=new Vector3,w=new Matrix4,_=new Quaternion;this.updateMatrixWorld=function(){var x=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(x="local"),e.set(1,0,0).applyQuaternion("local"===x?this.worldQuaternion:_),a.set(0,1,0).applyQuaternion("local"===x?this.worldQuaternion:_),d.set(0,0,1).applyQuaternion("local"===x?this.worldQuaternion:_),C.copy(a),this.mode){case"translate":case"scale":switch(this.axis){case"X":C.copy(this.eye).cross(e),g.copy(e).cross(C);break;case"Y":C.copy(this.eye).cross(a),g.copy(a).cross(C);break;case"Z":C.copy(this.eye).cross(d),g.copy(d).cross(C);break;case"XY":g.copy(d);break;case"YZ":g.copy(e);break;case"XZ":C.copy(d),g.copy(a);break;case"XYZ":case"E":g.set(0,0,0)}break;default:g.set(0,0,0)}0===g.length()?this.quaternion.copy(this.cameraQuaternion):(w.lookAt(v.set(0,0,0),g,C),this.quaternion.setFromRotationMatrix(w)),Object3D.prototype.updateMatrixWorld.call(this)}};function Curve(){this.type="Curve",this.arcLengthDivisions=200}function GrannyKnot(){Curve.call(this)}function HeartCurve(s){Curve.call(this),this.scale=void 0===s?5:s}function VivianiCurve(s){Curve.call(this),this.scale=void 0===s?70:s}function KnotCurve(){Curve.call(this)}function HelixCurve(){Curve.call(this)}function TrefoilKnot(s){Curve.call(this),this.scale=void 0===s?10:s}function TorusKnot(s){Curve.call(this),this.scale=void 0===s?10:s}function CinquefoilKnot(s){Curve.call(this),this.scale=void 0===s?10:s}function TrefoilPolynomialKnot(s){Curve.call(this),this.scale=void 0===s?10:s}TransformControlsPlane.prototype=Object.assign(Object.create(Mesh.prototype),{constructor:TransformControlsPlane,isTransformControlsPlane:!0}),Object.assign(Curve.prototype,{getPoint:function(){return console.warn("Curve: .getPoint() not implemented."),null},getPointAt:function(e,a){var d=this.getUtoTmapping(e);return this.getPoint(d,a)},getPoints:function(e){void 0===e&&(e=5);for(var a=[],d=0;d<=e;d++)a.push(this.getPoint(d/e));return a},getSpacedPoints:function(e){void 0===e&&(e=5);for(var a=[],d=0;d<=e;d++)a.push(this.getPointAt(d/e));return a},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var d,g,a=[],v=this.getPoint(0),C=0;for(a.push(0),g=1;g<=e;g++)C+=(d=this.getPoint(g/e)).distanceTo(v),a.push(C),v=d;return this.cacheArcLengths=a,a},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,a){var C,d=this.getLengths(),v=0,g=d.length;C=a||e*d[g-1];for(var x,w=0,_=g-1;w<=_;)if((x=d[v=Math.floor(w+(_-w)/2)]-C)<0)w=v+1;else{if(!(x>0)){_=v;break}_=v-1}if(d[v=_]===C)return v/(g-1);var b=d[v];return(v+(C-b)/(d[v+1]-b))/(g-1)},getTangent:function(e){var a=1e-4,d=e-a,v=e+a;d<0&&(d=0),v>1&&(v=1);var g=this.getPoint(d);return this.getPoint(v).clone().sub(g).normalize()},getTangentAt:function(e){var a=this.getUtoTmapping(e);return this.getTangent(a)},computeFrenetFrames:function(e,a){var x,A,d=new Vector3,v=[],g=[],C=[],w=new Vector3,_=new Matrix4;for(x=0;x<=e;x++)v[x]=this.getTangentAt(x/e),v[x].normalize();g[0]=new Vector3,C[0]=new Vector3;var E=Number.MAX_VALUE,R=Math.abs(v[0].x),O=Math.abs(v[0].y),D=Math.abs(v[0].z);for(R<=E&&(E=R,d.set(1,0,0)),O<=E&&(E=O,d.set(0,1,0)),D<=E&&d.set(0,0,1),w.crossVectors(v[0],d).normalize(),g[0].crossVectors(v[0],w),C[0].crossVectors(v[0],g[0]),x=1;x<=e;x++)g[x]=g[x-1].clone(),C[x]=C[x-1].clone(),w.crossVectors(v[x-1],v[x]),w.length()>Number.EPSILON&&(w.normalize(),A=Math.acos(MathUtils.clamp(v[x-1].dot(v[x]),-1,1)),g[x].applyMatrix4(_.makeRotationAxis(w,A))),C[x].crossVectors(v[x],g[x]);if(!0===a)for(A=Math.acos(MathUtils.clamp(g[0].dot(g[e]),-1,1)),A/=e,v[0].dot(w.crossVectors(g[0],g[e]))>0&&(A=-A),x=1;x<=e;x++)g[x].applyMatrix4(_.makeRotationAxis(v[x],A*x)),C[x].crossVectors(v[x],g[x]);return{tangents:v,normals:g,binormals:C}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),GrannyKnot.prototype=Object.create(Curve.prototype),GrannyKnot.prototype.constructor=GrannyKnot,GrannyKnot.prototype.getPoint=function(s,e){var a=e||new Vector3;s=2*Math.PI*s;var d=-.22*Math.cos(s)-1.28*Math.sin(s)-.44*Math.cos(3*s)-.78*Math.sin(3*s),v=-.1*Math.cos(2*s)-.27*Math.sin(2*s)+.38*Math.cos(4*s)+.46*Math.sin(4*s),g=.7*Math.cos(3*s)-.4*Math.sin(3*s);return a.set(d,v,g).multiplyScalar(20)},HeartCurve.prototype=Object.create(Curve.prototype),HeartCurve.prototype.constructor=HeartCurve,HeartCurve.prototype.getPoint=function(s,e){var a=e||new Vector3;s*=2*Math.PI;var d=16*Math.pow(Math.sin(s),3),v=13*Math.cos(s)-5*Math.cos(2*s)-2*Math.cos(3*s)-Math.cos(4*s);return a.set(d,v,0).multiplyScalar(this.scale)},VivianiCurve.prototype=Object.create(Curve.prototype),VivianiCurve.prototype.constructor=VivianiCurve,VivianiCurve.prototype.getPoint=function(s,e){var a=e||new Vector3;s=4*s*Math.PI;var d=this.scale/2,v=d*(1+Math.cos(s)),g=d*Math.sin(s),C=2*d*Math.sin(s/2);return a.set(v,g,C)},KnotCurve.prototype=Object.create(Curve.prototype),KnotCurve.prototype.constructor=KnotCurve,KnotCurve.prototype.getPoint=function(s,e){var a=e||new Vector3;s*=2*Math.PI;var g=50*Math.sin(s),C=Math.cos(s)*(10+50*Math.cos(s)),w=Math.sin(s)*(10+50*Math.cos(s));return a.set(g,C,w)},HelixCurve.prototype=Object.create(Curve.prototype),HelixCurve.prototype.constructor=HelixCurve,HelixCurve.prototype.getPoint=function(s,e){var a=e||new Vector3,g=2*Math.PI*s*150/30,C=30*Math.cos(g),w=30*Math.sin(g);return a.set(C,w,150*s)},TrefoilKnot.prototype=Object.create(Curve.prototype),TrefoilKnot.prototype.constructor=TrefoilKnot,TrefoilKnot.prototype.getPoint=function(s,e){var a=e||new Vector3;s*=2*Math.PI;var d=(2+Math.cos(3*s))*Math.cos(2*s),v=(2+Math.cos(3*s))*Math.sin(2*s),g=Math.sin(3*s);return a.set(d,v,g).multiplyScalar(this.scale)},TorusKnot.prototype=Object.create(Curve.prototype),TorusKnot.prototype.constructor=TorusKnot,TorusKnot.prototype.getPoint=function(s,e){var a=e||new Vector3;s*=2*Math.PI;var g=(2+Math.cos(4*s))*Math.cos(3*s),C=(2+Math.cos(4*s))*Math.sin(3*s),w=Math.sin(4*s);return a.set(g,C,w).multiplyScalar(this.scale)},CinquefoilKnot.prototype=Object.create(Curve.prototype),CinquefoilKnot.prototype.constructor=CinquefoilKnot,CinquefoilKnot.prototype.getPoint=function(s,e){var a=e||new Vector3;s*=2*Math.PI;var g=(2+Math.cos(5*s))*Math.cos(2*s),C=(2+Math.cos(5*s))*Math.sin(2*s),w=Math.sin(5*s);return a.set(g,C,w).multiplyScalar(this.scale)},TrefoilPolynomialKnot.prototype=Object.create(Curve.prototype),TrefoilPolynomialKnot.prototype.constructor=TrefoilPolynomialKnot,TrefoilPolynomialKnot.prototype.getPoint=function(s,e){var a=e||new Vector3;s=4*s-2;var d=Math.pow(s,3)-3*s,v=Math.pow(s,4)-4*s*s,g=.2*Math.pow(s,5)-2*s;return a.set(d,v,g).multiplyScalar(this.scale)};var scaleTo=function(e,a,d){return d*(a-e)+e};function FigureEightPolynomialKnot(s){Curve.call(this),this.scale=void 0===s?1:s}function DecoratedTorusKnot4a(s){Curve.call(this),this.scale=void 0===s?40:s}function DecoratedTorusKnot4b(s){Curve.call(this),this.scale=void 0===s?40:s}function DecoratedTorusKnot5a(s){Curve.call(this),this.scale=void 0===s?40:s}function DecoratedTorusKnot5c(s){Curve.call(this),this.scale=void 0===s?40:s}FigureEightPolynomialKnot.prototype=Object.create(Curve.prototype),FigureEightPolynomialKnot.prototype.constructor=FigureEightPolynomialKnot,FigureEightPolynomialKnot.prototype.getPoint=function(s,e){var a=e||new Vector3,d=.4*(s=scaleTo(-4,4,s))*(s*s-7)*(s*s-10),v=Math.pow(s,4)-13*s*s;return a.set(d,v,.1*s*(s*s-4)*(s*s-9)*(s*s-12)).multiplyScalar(this.scale)},DecoratedTorusKnot4a.prototype=Object.create(Curve.prototype),DecoratedTorusKnot4a.prototype.constructor=DecoratedTorusKnot4a,DecoratedTorusKnot4a.prototype.getPoint=function(s,e){var a=e||new Vector3;s*=2*Math.PI;var d=Math.cos(2*s)*(1+.6*(Math.cos(5*s)+.75*Math.cos(10*s))),v=Math.sin(2*s)*(1+.6*(Math.cos(5*s)+.75*Math.cos(10*s))),g=.35*Math.sin(5*s);return a.set(d,v,g).multiplyScalar(this.scale)},DecoratedTorusKnot4b.prototype=Object.create(Curve.prototype),DecoratedTorusKnot4b.prototype.constructor=DecoratedTorusKnot4b,DecoratedTorusKnot4b.prototype.getPoint=function(s,e){var a=e||new Vector3,d=s*Math.PI*2,v=Math.cos(2*d)*(1+.45*Math.cos(3*d)+.4*Math.cos(9*d)),g=Math.sin(2*d)*(1+.45*Math.cos(3*d)+.4*Math.cos(9*d)),C=.2*Math.sin(9*d);return a.set(v,g,C).multiplyScalar(this.scale)},DecoratedTorusKnot5a.prototype=Object.create(Curve.prototype),DecoratedTorusKnot5a.prototype.constructor=DecoratedTorusKnot5a,DecoratedTorusKnot5a.prototype.getPoint=function(s,e){var a=e||new Vector3,d=s*Math.PI*2,v=Math.cos(3*d)*(1+.3*Math.cos(5*d)+.5*Math.cos(10*d)),g=Math.sin(3*d)*(1+.3*Math.cos(5*d)+.5*Math.cos(10*d)),C=.2*Math.sin(20*d);return a.set(v,g,C).multiplyScalar(this.scale)},DecoratedTorusKnot5c.prototype=Object.create(Curve.prototype),DecoratedTorusKnot5c.prototype.constructor=DecoratedTorusKnot5c,DecoratedTorusKnot5c.prototype.getPoint=function(s,e){var a=e||new Vector3,d=s*Math.PI*2,v=Math.cos(4*d)*(1+.5*(Math.cos(5*d)+.4*Math.cos(20*d))),g=Math.sin(4*d)*(1+.5*(Math.cos(5*d)+.4*Math.cos(20*d))),C=.35*Math.sin(15*d);return a.set(v,g,C).multiplyScalar(this.scale)};var NURBSUtils={findSpan:function(e,a,d){var v=d.length-e-1;if(a>=d[v])return v-1;if(a<=d[e])return e;for(var g=e,C=v,w=Math.floor((g+C)/2);a<d[w]||a>=d[w+1];)a<d[w]?C=w:g=w,w=Math.floor((g+C)/2);return w},calcBasisFunctions:function(e,a,d,v){var g=[],C=[],w=[];g[0]=1;for(var _=1;_<=d;++_){C[_]=a-v[e+1-_],w[_]=v[e+_]-a;for(var x=0,b=0;b<_;++b){var A=w[b+1],E=C[_-b],R=g[b]/(A+E);g[b]=x+A*R,x=E*R}g[_]=x}return g},calcBSplinePoint:function(e,a,d,v){for(var g=this.findSpan(e,v,a),C=this.calcBasisFunctions(g,v,e,a),w=new Vector4(0,0,0,0),_=0;_<=e;++_){var x=d[g-e+_],b=C[_],A=x.w*b;w.x+=x.x*A,w.y+=x.y*A,w.z+=x.z*A,w.w+=x.w*b}return w},calcBasisFunctionDerivatives:function(e,a,d,v,g){for(var C=[],w=0;w<=d;++w)C[w]=0;var _=[];for(w=0;w<=v;++w)_[w]=C.slice(0);var x=[];for(w=0;w<=d;++w)x[w]=C.slice(0);x[0][0]=1;for(var b=C.slice(0),A=C.slice(0),E=1;E<=d;++E){b[E]=a-g[e+1-E],A[E]=g[e+E]-a;for(var R=0,J=0;J<E;++J){var O=A[J+1],D=b[E-J];x[E][J]=O+D;var F=x[J][E-1]/x[E][J];x[J][E]=R+O*F,R=D*F}x[E][E]=R}for(E=0;E<=d;++E)_[0][E]=x[E][d];for(J=0;J<=d;++J){var L=0,I=1,V=[];for(w=0;w<=d;++w)V[w]=C.slice(0);V[0][0]=1;for(var z=1;z<=v;++z){var H=0,X=J-z,re=d-z;J>=z&&(V[I][0]=V[L][0]/x[re+1][X],H=V[I][0]*x[X][re]);var te=J-1<=re?z-1:d-J;for(E=X>=-1?1:-X;E<=te;++E)V[I][E]=(V[L][E]-V[L][E-1])/x[re+1][X+E],H+=V[I][E]*x[X+E][re];J<=re&&(V[I][z]=-V[L][z-1]/x[re+1][J],H+=V[I][z]*x[J][re]),_[z][J]=H,E=L,L=I,I=E}}for(J=d,z=1;z<=v;++z){for(E=0;E<=d;++E)_[z][E]*=J;J*=d-z}return _},calcBSplineDerivatives:function(e,a,d,v,g){for(var C=g<e?g:e,w=[],_=this.findSpan(e,v,a),x=this.calcBasisFunctionDerivatives(_,v,e,C,a),b=[],A=0;A<d.length;++A){var R=(E=d[A].clone()).w;E.x*=R,E.y*=R,E.z*=R,b[A]=E}for(var O=0;O<=C;++O){for(var E=b[_-e].clone().multiplyScalar(x[O][0]),D=1;D<=e;++D)E.add(b[_-e+D].clone().multiplyScalar(x[O][D]));w[O]=E}for(O=C+1;O<=g+1;++O)w[O]=new Vector4(0,0,0);return w},calcKoverI:function(e,a){for(var d=1,v=2;v<=e;++v)d*=v;var g=1;for(v=2;v<=a;++v)g*=v;for(v=2;v<=e-a;++v)g*=v;return d/g},calcRationalCurveDerivatives:function(e){for(var a=e.length,d=[],v=[],g=0;g<a;++g){var C=e[g];d[g]=new Vector3(C.x,C.y,C.z),v[g]=C.w}for(var w=[],_=0;_<a;++_){var x=d[_].clone();for(g=1;g<=_;++g)x.sub(w[_-g].clone().multiplyScalar(this.calcKoverI(_,g)*v[g]));w[_]=x.divideScalar(v[0])}return w},calcNURBSDerivatives:function(e,a,d,v,g){var C=this.calcBSplineDerivatives(e,a,d,v,g);return this.calcRationalCurveDerivatives(C)},calcSurfacePoint:function(e,a,d,v,g,C,w,_){for(var x=this.findSpan(e,C,d),b=this.findSpan(a,w,v),A=this.calcBasisFunctions(x,C,e,d),E=this.calcBasisFunctions(b,w,a,v),R=[],O=0;O<=a;++O){R[O]=new Vector4(0,0,0,0);for(var D=0;D<=e;++D){var F=g[x-e+D][b-a+O].clone(),L=F.w;F.x*=L,F.y*=L,F.z*=L,R[O].add(F.multiplyScalar(A[D]))}}var I=new Vector4(0,0,0,0);for(O=0;O<=a;++O)I.add(R[O].multiplyScalar(E[O]));I.divideScalar(I.w),_.set(I.x,I.y,I.z)}},NURBSCurve=function(e,a,d,v,g){Curve.call(this),this.degree=e,this.knots=a,this.controlPoints=[],this.startKnot=v||0,this.endKnot=g||this.knots.length-1;for(var C=0;C<d.length;++C){var w=d[C];this.controlPoints[C]=new Vector4(w.x,w.y,w.z,w.w)}};NURBSCurve.prototype=Object.create(Curve.prototype),NURBSCurve.prototype.constructor=NURBSCurve,NURBSCurve.prototype.getPoint=function(s){var a=NURBSUtils.calcBSplinePoint(this.degree,this.knots,this.controlPoints,this.knots[this.startKnot]+s*(this.knots[this.endKnot]-this.knots[this.startKnot]));return 1!=a.w&&a.divideScalar(a.w),new Vector3(a.x,a.y,a.z)},NURBSCurve.prototype.getTangent=function(s){var d=NURBSUtils.calcNURBSDerivatives(this.degree,this.knots,this.controlPoints,this.knots[0]+s*(this.knots[this.knots.length-1]-this.knots[0]),1)[1].clone();return d.normalize(),d};var NURBSSurface=function(e,a,d,v,g){this.degree1=e,this.degree2=a,this.knots1=d,this.knots2=v,this.controlPoints=[];for(var C=d.length-e-1,w=v.length-a-1,_=0;_<C;++_){this.controlPoints[_]=[];for(var x=0;x<w;++x){var b=g[_][x];this.controlPoints[_][x]=new Vector4(b.x,b.y,b.z,b.w)}}};NURBSSurface.prototype={constructor:NURBSSurface,getPoint:function(e,a,d){NURBSUtils.calcSurfacePoint(this.degree1,this.degree2,this.knots1,this.knots2,this.controlPoints,this.knots1[0]+e*(this.knots1[this.knots1.length-1]-this.knots1[0]),this.knots2[0]+a*(this.knots2[this.knots2.length-1]-this.knots2[0]),d)}};var _eyeRight=new Matrix4,_eyeLeft=new Matrix4;function StereoCamera(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new PerspectiveCamera,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new PerspectiveCamera,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}Object.assign(StereoCamera.prototype,{update:function(e){var a=this._cache;if(a.focus!==e.focus||a.fov!==e.fov||a.aspect!==e.aspect*this.aspect||a.near!==e.near||a.far!==e.far||a.zoom!==e.zoom||a.eyeSep!==this.eyeSep){a.focus=e.focus,a.fov=e.fov,a.aspect=e.aspect*this.aspect,a.near=e.near,a.far=e.far,a.zoom=e.zoom,a.eyeSep=this.eyeSep;var _,x,v=e.projectionMatrix.clone(),g=a.eyeSep/2,C=g*a.near/a.focus,w=a.near*Math.tan(MathUtils.DEG2RAD*a.fov*.5)/a.zoom;_eyeLeft.elements[12]=-g,_eyeRight.elements[12]=g,v.elements[0]=2*a.near/((x=w*a.aspect+C)-(_=-w*a.aspect+C)),v.elements[8]=(x+_)/(x-_),this.cameraL.projectionMatrix.copy(v),v.elements[0]=2*a.near/((x=w*a.aspect-C)-(_=-w*a.aspect-C)),v.elements[8]=(x+_)/(x-_),this.cameraR.projectionMatrix.copy(v)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(_eyeLeft),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(_eyeRight)}});var AnaglyphEffect=function(e,a,d){this.colorMatrixLeft=(new Matrix3).fromArray([1.0671679973602295,-.0016435992438346148,.0001777536963345483,-.028107794001698494,-.00019593400065787137,-.0002875397040043026,-.04279090091586113,15809757314855233e-21,-.00024287120322696865]),this.colorMatrixRight=(new Matrix3).fromArray([-.0355340838432312,-.06440307199954987,.018319187685847282,-.10269022732973099,.8079727292060852,-.04835830628871918,.0001224992738571018,-.009558862075209618,.567823588848114]);var v=new OrthographicCamera(-1,1,1,-1,0,1),g=new Scene,C=new StereoCamera,w={minFilter:LinearFilter,magFilter:NearestFilter,format:RGBAFormat};void 0===a&&(a=512),void 0===d&&(d=512);var _=new WebGLRenderTarget(a,d,w),x=new WebGLRenderTarget(a,d,w),b=new ShaderMaterial({uniforms:{mapLeft:{value:_.texture},mapRight:{value:x.texture},colorMatrixLeft:{value:this.colorMatrixLeft},colorMatrixRight:{value:this.colorMatrixRight}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = vec2( uv.x, uv.y );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D mapLeft;","uniform sampler2D mapRight;","varying vec2 vUv;","uniform mat3 colorMatrixLeft;","uniform mat3 colorMatrixRight;","float lin( float c ) {","\treturn c <= 0.04045 ? c * 0.0773993808 :","\t\t\tpow( c * 0.9478672986 + 0.0521327014, 2.4 );","}","vec4 lin( vec4 c ) {","\treturn vec4( lin( c.r ), lin( c.g ), lin( c.b ), c.a );","}","float dev( float c ) {","\treturn c <= 0.0031308 ? c * 12.92","\t\t\t: pow( c, 0.41666 ) * 1.055 - 0.055;","}","void main() {","\tvec2 uv = vUv;","\tvec4 colorL = lin( texture2D( mapLeft, uv ) );","\tvec4 colorR = lin( texture2D( mapRight, uv ) );","\tvec3 color = clamp(","\t\t\tcolorMatrixLeft * colorL.rgb +","\t\t\tcolorMatrixRight * colorR.rgb, 0., 1. );","\tgl_FragColor = vec4(","\t\t\tdev( color.r ), dev( color.g ), dev( color.b ),","\t\t\tmax( colorL.a, colorR.a ) );","}"].join("\n")}),A=new Mesh(new PlaneBufferGeometry(2,2),b);g.add(A),this.setSize=function(E,R){e.setSize(E,R);var O=e.getPixelRatio();_.setSize(E*O,R*O),x.setSize(E*O,R*O)},this.render=function(E,R){var O=e.getRenderTarget();E.updateMatrixWorld(),null===R.parent&&R.updateMatrixWorld(),C.update(R),e.setRenderTarget(_),e.clear(),e.render(E,C.cameraL),e.setRenderTarget(x),e.clear(),e.render(E,C.cameraR),e.setRenderTarget(null),e.render(g,v),e.setRenderTarget(O)},this.dispose=function(){_&&_.dispose(),x&&x.dispose(),A&&A.geometry.dispose(),b&&b.dispose()}},AsciiEffect=function(e,a,d){a=void 0===a?" .:-=+*#%@":a,d||(d={});var A,E,v=d.resolution?d.resolution:.15,g=d.scale?d.scale:1,C=!!d.color&&d.color,w=!!d.alpha&&d.alpha,_=!!d.block&&d.block,x=!!d.invert&&d.invert,R=document.createElement("div");R.style.cursor="default";var D,F,L,O=document.createElement("table");R.appendChild(O),this.setSize=function(Q,oe){A=Q,E=oe,e.setSize(Q,oe),function(){D=Math.round(A*J),F=Math.round(E*J),re.width=D,re.height=F,(L=e.domElement).style.backgroundColor&&(O.rows[0].cells[0].style.backgroundColor=L.style.backgroundColor,O.rows[0].cells[0].style.color=L.style.color),O.cellSpacing=0,O.cellPadding=0;var Q=O.style;Q.display="inline",Q.width=Math.round(D/J*g)+"px",Q.height=Math.round(F/J*g)+"px",Q.whiteSpace="pre",Q.margin="0px",Q.padding="0px",Q.letterSpacing=K+"px",Q.fontFamily=H,Q.fontSize=k+"px",Q.lineHeight=U+"px",Q.textAlign="left",Q.textDecoration="none"}()},this.render=function(Q,oe){e.render(Q,oe),function(Q,oe){j.clearRect(0,0,D,F),j.drawImage(X,0,0,D,F);for(var me=j.getImageData(0,0,D,F).data,fe="",ge=0;ge<F;ge+=2){for(var $=0;$<D;$++){var le,_e,ue=4*(ge*D+$),Y=me[ue],Z=me[ue+1],se=me[ue+2],ve=me[ue+3];_e=(.3*Y+.59*Z+.11*se)/255,0==ve&&(_e=1),le=Math.floor((1-_e)*(te.length-1)),x&&(le=te.length-le-1);var ae=te[le];(void 0===ae||" "==ae)&&(ae="&nbsp;"),fe+=C?"<span style='color:rgb("+Y+","+Z+","+se+");"+(_?"background-color:rgb("+Y+","+Z+","+se+");":"")+(w?"opacity:"+ve/255+";":"")+"'>"+ae+"</span>":ae}fe+="<br/>"}oe.innerHTML="<tr><td>"+fe+"</td></tr>"}(0,O)},this.domElement=R;var V=" .,:;i1tfLCG08@".split(""),z=" CGO08@".split(""),H="courier new, monospace",X=e.domElement,re=document.createElement("canvas");if(re.getContext){var j=re.getContext("2d");if(j.getImageData){var te=C?z:V;a&&(te=a);var J=.5;J=.25,v&&(J=v);var k=2/J*g,U=2/J*g,K=0;switch(g){case 1:K=-1;break;case 2:case 3:K=-2.1;break;case 4:K=-3.1;break;case 5:K=-4.15}}}},UniformsLib={common:{diffuse:{value:new Color(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Matrix3},uv2Transform:{value:new Matrix3},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Vector2(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Color(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new Color(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Matrix3}},sprite:{diffuse:{value:new Color(15658734)},opacity:{value:1},center:{value:new Vector2(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Matrix3}}},OutlineEffect=function(e,a){a=a||{},this.enabled=!0;var d=void 0!==a.defaultThickness?a.defaultThickness:.003,v=(new Color).fromArray(void 0!==a.defaultColor?a.defaultColor:[0,0,0]),C=void 0!==a.defaultKeepAlive&&a.defaultKeepAlive,w={},x={},b={},A={outlineThickness:{value:d},outlineColor:{value:v},outlineAlpha:{value:void 0!==a.defaultAlpha?a.defaultAlpha:1}},E=["#include <common>","#include <uv_pars_vertex>","#include <displacementmap_pars_vertex>","#include <fog_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <clipping_planes_pars_vertex>","uniform float outlineThickness;","vec4 calculateOutline( vec4 pos, vec3 normal, vec4 skinned ) {","\tfloat thickness = outlineThickness;","\tconst float ratio = 1.0;","\tvec4 pos2 = projectionMatrix * modelViewMatrix * vec4( skinned.xyz + normal, 1.0 );","\tvec4 norm = normalize( pos - pos2 );","\treturn pos + norm * thickness * pos.w * ratio;","}","void main() {","\t#include <uv_vertex>","\t#include <beginnormal_vertex>","\t#include <morphnormal_vertex>","\t#include <skinbase_vertex>","\t#include <skinnormal_vertex>","\t#include <begin_vertex>","\t#include <morphtarget_vertex>","\t#include <skinning_vertex>","\t#include <displacementmap_vertex>","\t#include <project_vertex>","\tvec3 outlineNormal = - objectNormal;","\tgl_Position = calculateOutline( gl_Position, outlineNormal, vec4( transformed, 1.0 ) );","\t#include <logdepthbuf_vertex>","\t#include <clipping_planes_vertex>","\t#include <fog_vertex>","}"].join("\n"),R=["#include <common>","#include <fog_pars_fragment>","#include <logdepthbuf_pars_fragment>","#include <clipping_planes_pars_fragment>","uniform vec3 outlineColor;","uniform float outlineAlpha;","void main() {","\t#include <clipping_planes_fragment>","\t#include <logdepthbuf_fragment>","\tgl_FragColor = vec4( outlineColor, outlineAlpha );","\t#include <tonemapping_fragment>","\t#include <encodings_fragment>","\t#include <fog_fragment>","\t#include <premultiplied_alpha_fragment>","}"].join("\n");function F(j){var te=function(j){var te=w[j.uuid];return void 0===te&&(te={material:new ShaderMaterial({type:"OutlineEffect",uniforms:UniformsUtils.merge([UniformsLib.fog,UniformsLib.displacementmap,A]),vertexShader:E,fragmentShader:R,side:BackSide}),used:!0,keepAlive:C,count:0},w[j.uuid]=te),te.used=!0,te.material}(j);return x[te.uuid]=j,function(j,te){if("invisible"!==j.name){var J=te.userData.outlineParameters;j.skinning=te.skinning,j.morphTargets=te.morphTargets,j.morphNormals=te.morphNormals,j.fog=te.fog,j.toneMapped=te.toneMapped,j.premultipliedAlpha=te.premultipliedAlpha,j.displacementMap=te.displacementMap,void 0!==J?(j.visible=!1!==te.visible&&(void 0===J.visible||J.visible),j.transparent=void 0!==J.alpha&&J.alpha<1||te.transparent,void 0!==J.keepAlive&&(w[te.uuid].keepAlive=J.keepAlive)):(j.transparent=te.transparent,j.visible=te.visible),(!0===te.wireframe||!1===te.depthTest)&&(j.visible=!1),te.clippingPlanes&&(j.clipping=!0,j.clippingPlanes=te.clippingPlanes,j.clipIntersection=te.clipIntersection,j.clipShadows=te.clipShadows),j.version=te.version}}(te,j),te}function L(j){var te=j.geometry,J=!1;return void 0!==j.geometry&&(J=!te.isBufferGeometry||void 0!==te.attributes.normal),!0===j.isMesh&&void 0!==j.material&&!0===J}function I(j){if(!1!==L(j)){if(Array.isArray(j.material))for(var te=0,J=j.material.length;te<J;te++)j.material[te]=F(j.material[te]);else j.material=F(j.material);b[j.uuid]=j.onBeforeRender,j.onBeforeRender=z}}function V(j){if(!1!==L(j)){if(Array.isArray(j.material))for(var te=0,J=j.material.length;te<J;te++)j.material[te]=x[j.material[te].uuid];else j.material=x[j.material.uuid];j.onBeforeRender=b[j.uuid]}}function z(j,te,J,k,U){var K=x[U.uuid];void 0!==K&&function(j,te){var J=te.userData.outlineParameters;j.uniforms.outlineAlpha.value=te.opacity,void 0!==J&&(void 0!==J.thickness&&(j.uniforms.outlineThickness.value=J.thickness),void 0!==J.color&&j.uniforms.outlineColor.value.fromArray(J.color),void 0!==J.alpha&&(j.uniforms.outlineAlpha.value=J.alpha)),te.displacementMap&&(j.uniforms.displacementMap.value=te.displacementMap,j.uniforms.displacementScale.value=te.displacementScale,j.uniforms.displacementBias.value=te.displacementBias)}(U,K)}this.render=function(j,te){var J,k=!1;if(void 0!==arguments[2]&&(console.warn("OutlineEffect.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),J=arguments[2]),void 0!==arguments[3]&&(console.warn("OutlineEffect.render(): the forceClear argument has been removed. Use .clear() instead."),k=arguments[3]),void 0!==J&&e.setRenderTarget(J),k&&e.clear(),!1!==this.enabled){var U=e.autoClear;e.autoClear=this.autoClear,e.render(j,te),e.autoClear=U,this.renderOutline(j,te)}else e.render(j,te)},this.renderOutline=function(j,te){var J=e.autoClear,k=j.autoUpdate,U=j.background,K=e.shadowMap.enabled;j.autoUpdate=!1,j.background=null,e.autoClear=!1,e.shadowMap.enabled=!1,j.traverse(I),e.render(j,te),j.traverse(V),function(){for(var j,te=0,J=(j=Object.keys(x)).length;te<J;te++)x[j[te]]=void 0;for(te=0,J=(j=Object.keys(b)).length;te<J;te++)b[j[te]]=void 0;for(te=0,J=(j=Object.keys(w)).length;te<J;te++){var k=j[te];!1===w[k].used?(w[k].count++,!1===w[k].keepAlive&&w[k].count>60&&delete w[k]):(w[k].used=!1,w[k].count=0)}}(),j.autoUpdate=k,j.background=U,e.autoClear=J,e.shadowMap.enabled=K},this.autoClear=e.autoClear,this.domElement=e.domElement,this.shadowMap=e.shadowMap,this.clear=function(j,te,J){e.clear(j,te,J)},this.getPixelRatio=function(){return e.getPixelRatio()},this.setPixelRatio=function(j){e.setPixelRatio(j)},this.getSize=function(j){return e.getSize(j)},this.setSize=function(j,te,J){e.setSize(j,te,J)},this.setViewport=function(j,te,J,k){e.setViewport(j,te,J,k)},this.setScissor=function(j,te,J,k){e.setScissor(j,te,J,k)},this.setScissorTest=function(j){e.setScissorTest(j)},this.setRenderTarget=function(j){e.setRenderTarget(j)}},ParallaxBarrierEffect=function(e){var a=new OrthographicCamera(-1,1,1,-1,0,1),d=new Scene,v=new StereoCamera,g={minFilter:LinearFilter,magFilter:NearestFilter,format:RGBAFormat},C=new WebGLRenderTarget(512,512,g),w=new WebGLRenderTarget(512,512,g),_=new ShaderMaterial({uniforms:{mapLeft:{value:C.texture},mapRight:{value:w.texture}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = vec2( uv.x, uv.y );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D mapLeft;","uniform sampler2D mapRight;","varying vec2 vUv;","void main() {","\tvec2 uv = vUv;","\tif ( ( mod( gl_FragCoord.y, 2.0 ) ) > 1.00 ) {","\t\tgl_FragColor = texture2D( mapLeft, uv );","\t} else {","\t\tgl_FragColor = texture2D( mapRight, uv );","\t}","}"].join("\n")}),x=new Mesh(new PlaneBufferGeometry(2,2),_);d.add(x),this.setSize=function(b,A){e.setSize(b,A);var E=e.getPixelRatio();C.setSize(b*E,A*E),w.setSize(b*E,A*E)},this.render=function(b,A){b.updateMatrixWorld(),null===A.parent&&A.updateMatrixWorld(),v.update(A),e.setRenderTarget(C),e.clear(),e.render(b,v.cameraL),e.setRenderTarget(w),e.clear(),e.render(b,v.cameraR),e.setRenderTarget(null),e.render(d,a)}},PeppersGhostEffect=function(e){var a=this;a.cameraDistance=15,a.reflectFromAbove=!1;var d,v,g,C=new PerspectiveCamera,w=new PerspectiveCamera,_=new PerspectiveCamera,x=new PerspectiveCamera,b=new Vector3,A=new Quaternion,E=new Vector3;e.autoClear=!1,this.setSize=function(R,O){d=R/2,R<O?(v=R/3,g=R/3):(v=O/3,g=O/3),e.setSize(R,O)},this.render=function(R,O){R.updateMatrixWorld(),null===O.parent&&O.updateMatrixWorld(),O.matrixWorld.decompose(b,A,E),C.position.copy(b),C.quaternion.copy(A),C.translateZ(a.cameraDistance),C.lookAt(R.position),w.position.copy(b),w.quaternion.copy(A),w.translateZ(-a.cameraDistance),w.lookAt(R.position),w.rotation.z+=Math.PI/180*180,_.position.copy(b),_.quaternion.copy(A),_.translateX(-a.cameraDistance),_.lookAt(R.position),_.rotation.x+=Math.PI/180*90,x.position.copy(b),x.quaternion.copy(A),x.translateX(a.cameraDistance),x.lookAt(R.position),x.rotation.x+=Math.PI/180*90,e.clear(),e.setScissorTest(!0),e.setScissor(d-v/2,2*g,v,g),e.setViewport(d-v/2,2*g,v,g),e.render(R,a.reflectFromAbove?w:C),e.setScissor(d-v/2,0,v,g),e.setViewport(d-v/2,0,v,g),e.render(R,a.reflectFromAbove?C:w),e.setScissor(d-v/2-v,g,v,g),e.setViewport(d-v/2-v,g,v,g),e.render(R,a.reflectFromAbove?x:_),e.setScissor(d+v/2,g,v,g),e.setViewport(d+v/2,g,v,g),e.render(R,a.reflectFromAbove?_:x),e.setScissorTest(!1)}},StereoEffect=function(e){var a=new StereoCamera;a.aspect=.5;var d=new Vector2;this.setEyeSeparation=function(v){a.eyeSep=v},this.setSize=function(v,g){e.setSize(v,g)},this.render=function(v,g){v.updateMatrixWorld(),null===g.parent&&g.updateMatrixWorld(),a.update(g),e.getSize(d),e.autoClear&&e.clear(),e.setScissorTest(!0),e.setScissor(0,0,d.width/2,d.height),e.setViewport(0,0,d.width/2,d.height),e.render(v,a.cameraL),e.setScissor(d.width/2,0,d.width/2,d.height),e.setViewport(d.width/2,0,d.width/2,d.height),e.render(v,a.cameraR),e.setScissorTest(!1)}};function MeshLambertMaterial(s){Material.call(this),this.type="MeshLambertMaterial",this.color=new Color(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(s)}MeshLambertMaterial.prototype=Object.create(Material.prototype),MeshLambertMaterial.prototype.constructor=MeshLambertMaterial,MeshLambertMaterial.prototype.isMeshLambertMaterial=!0,MeshLambertMaterial.prototype.copy=function(s){return Material.prototype.copy.call(this,s),this.color.copy(s.color),this.map=s.map,this.lightMap=s.lightMap,this.lightMapIntensity=s.lightMapIntensity,this.aoMap=s.aoMap,this.aoMapIntensity=s.aoMapIntensity,this.emissive.copy(s.emissive),this.emissiveMap=s.emissiveMap,this.emissiveIntensity=s.emissiveIntensity,this.specularMap=s.specularMap,this.alphaMap=s.alphaMap,this.envMap=s.envMap,this.combine=s.combine,this.reflectivity=s.reflectivity,this.refractionRatio=s.refractionRatio,this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this.wireframeLinecap=s.wireframeLinecap,this.wireframeLinejoin=s.wireframeLinejoin,this.skinning=s.skinning,this.morphTargets=s.morphTargets,this.morphNormals=s.morphNormals,this};var ColladaExporter=function(){};ColladaExporter.prototype={constructor:ColladaExporter,parse:function(e,a,d){d=d||{},""!==(d=Object.assign({version:"1.4.1",author:null,textureDirectory:""},d)).textureDirectory&&(d.textureDirectory=(d.textureDirectory+"/").replace(/\\/g,"/").replace(/\/+/g,"/"));var w,_,v=d.version;if("1.4.1"!==v&&"1.5.0"!==v)return console.warn("ColladaExporter : Version "+v+" not supported for export. Only 1.4.1 and 1.5.0."),null;function x(oe,me){return w=w||document.createElement("canvas"),_=_||w.getContext("2d"),w.width=oe.naturalWidth,w.height=oe.naturalHeight,_.drawImage(oe,0,0),function(oe){for(var me=atob(oe),fe=new Uint8Array(me.length),ge=0,$=fe.length;ge<$;ge++)fe[ge]=me.charCodeAt(ge);return fe}(w.toDataURL("image/"+me,1).replace(/^data:image\/(png|jpg);base64,/,""))}var O,b=["getX","getY","getZ","getW"];function A(oe){if(oe.isInterleavedBufferAttribute){for(var me=new oe.array.constructor(oe.count*oe.itemSize),fe=oe.itemSize,ge=0,$=oe.count;ge<$;ge++)for(var ue=0;ue<fe;ue++)me[ge*fe+ue]=oe[b[ue]](ge);return me}return oe.array}function E(oe,me,fe){return Array.isArray(oe)?oe.slice(me,me+fe):new oe.constructor(oe.buffer,me*oe.BYTES_PER_ELEMENT,fe)}function R(oe,me,fe,ge){var $=A(oe);return'<source id="'+me+'"><float_array id="'+me+'-array" count="'+$.length+'">'+$.join(" ")+'</float_array><technique_common><accessor source="#'+me+'-array" count="'+Math.floor($.length/oe.itemSize)+'" stride="'+oe.itemSize+'">'+fe.map(function(Y){return'<param name="'+Y+'" type="'+ge+'" />'}).join("")+"</accessor></technique_common></source>"}function L(oe){var me=X.get(oe);if(null==me){me="image-"+(j.length+1);var ge=oe.name||me,$='<image id="'+me+'" name="'+ge+'">';$+="1.5.0"===v?"<init_from><ref>"+d.textureDirectory+ge+".png</ref></init_from>":"<init_from>"+d.textureDirectory+ge+".png</init_from>",j.push($+="</image>"),X.set(oe,me),re.push({directory:d.textureDirectory,name:ge,ext:"png",data:x(oe.image,"png"),original:oe})}return me}var z=new WeakMap,H=new WeakMap,X=new WeakMap,re=[],j=[],te=[],J=[],k=[],U=function V(oe){var me='<node name="'+oe.name+'">';if(me+=function(oe){return oe.updateMatrix(),(O=O||new Matrix4).copy(oe.matrix),O.transpose(),"<matrix>"+O.toArray().join(" ")+"</matrix>"}(oe),oe instanceof Mesh&&null!=oe.geometry){var fe=function(oe){var me=z.get(oe);if(!me){var fe=oe;fe instanceof Geometry&&(fe=(new BufferGeometry).fromGeometry(fe));var ge="Mesh"+(te.length+1),$=fe.index?fe.index.count*fe.index.itemSize:fe.attributes.position.count,ue=null!=fe.groups&&0!==fe.groups.length?fe.groups:[{start:0,count:$,materialIndex:0}],Z='<geometry id="'+ge+'"'+(oe.name?' name="'+oe.name+'"':"")+"><mesh>",se=ge+"-position",ve=ge+"-vertices";Z+=R(fe.attributes.position,se,["X","Y","Z"],"float"),Z+='<vertices id="'+ve+'"><input semantic="POSITION" source="#'+se+'" /></vertices>';var le='<input semantic="VERTEX" source="#'+ve+'" offset="0" />';if("normal"in fe.attributes){var _e=ge+"-normal";Z+=R(fe.attributes.normal,_e,["X","Y","Z"],"float"),le+='<input semantic="NORMAL" source="#'+_e+'" offset="0" />'}if("uv"in fe.attributes){var ae=ge+"-texcoord";Z+=R(fe.attributes.uv,ae,["S","T"],"float"),le+='<input semantic="TEXCOORD" source="#'+ae+'" offset="0" set="0" />'}if("color"in fe.attributes){var pe=ge+"-color";Z+=R(fe.attributes.color,pe,["X","Y","Z"],"uint8"),le+='<input semantic="COLOR" source="#'+pe+'" offset="0" />'}var he=null;if(fe.index)he=A(fe.index);else for(var ce=0,Te=(he=new Array($)).length;ce<Te;ce++)he[ce]=ce;for(ce=0,Te=ue.length;ce<Te;ce++){var be=ue[ce],xe=E(he,be.start,be.count);Z+='<triangles material="MESH_MATERIAL_'+be.materialIndex+'" count="'+xe.length/3+'">',Z+=le,Z+="<p>"+xe.join(" ")+"</p>",Z+="</triangles>"}te.push(Z+="</mesh></geometry>"),z.set(oe,me={meshid:ge,bufferGeometry:fe})}return me}(oe.geometry),ge=fe.meshid,$=fe.bufferGeometry,ue=null,Z=oe.material||new MeshBasicMaterial,se=Array.isArray(Z)?Z:[Z];ue=new Array($.groups.length>se.length?$.groups.length:se.length).fill().map(function(ve,le){return function(oe){var me=H.get(oe);if(null==me){me="Mat"+(J.length+1);var fe="phong";oe instanceof MeshLambertMaterial?fe="lambert":oe instanceof MeshBasicMaterial&&(fe="constant",null!==oe.map&&console.warn("ColladaExporter: Texture maps not supported with MeshBasicMaterial."));var ge=oe.emissive?oe.emissive:new Color(0,0,0),$=oe.color?oe.color:new Color(0,0,0),ue=oe.specular?oe.specular:new Color(1,1,1),se="";!0===oe.transparent&&(se+="<transparent>"+(oe.map?'<texture texture="diffuse-sampler"></texture>':"<float>1</float>")+"</transparent>",oe.opacity<1&&(se+="<transparency><float>"+oe.opacity+"</float></transparency>"));var ve='<technique sid="common"><'+fe+"><emission>"+(oe.emissiveMap?'<texture texture="emissive-sampler" texcoord="TEXCOORD" />':'<color sid="emission">'+ge.r+" "+ge.g+" "+ge.b+" 1</color>")+"</emission>"+("constant"!==fe?"<diffuse>"+(oe.map?'<texture texture="diffuse-sampler" texcoord="TEXCOORD" />':'<color sid="diffuse">'+$.r+" "+$.g+" "+$.b+" 1</color>")+"</diffuse>":"")+("phong"===fe?'<specular><color sid="specular">'+ue.r+" "+ue.g+" "+ue.b+" 1</color></specular><shininess>"+(oe.specularMap?'<texture texture="specular-sampler" texcoord="TEXCOORD" />':'<float sid="shininess">'+(oe.shininess||0)+"</float>")+"</shininess>":"")+"<reflective><color>"+$.r+" "+$.g+" "+$.b+" 1</color></reflective><reflectivity><float>"+(oe.reflectivity||0)+"</float></reflectivity>"+se+"</"+fe+"></technique>",le='<effect id="'+me+'-effect"><profile_COMMON>'+(oe.map?'<newparam sid="diffuse-surface"><surface type="2D"><init_from>'+L(oe.map)+'</init_from></surface></newparam><newparam sid="diffuse-sampler"><sampler2D><source>diffuse-surface</source></sampler2D></newparam>':"")+(oe.specularMap?'<newparam sid="specular-surface"><surface type="2D"><init_from>'+L(oe.specularMap)+'</init_from></surface></newparam><newparam sid="specular-sampler"><sampler2D><source>specular-surface</source></sampler2D></newparam>':"")+(oe.emissiveMap?'<newparam sid="emissive-surface"><surface type="2D"><init_from>'+L(oe.emissiveMap)+'</init_from></surface></newparam><newparam sid="emissive-sampler"><sampler2D><source>emissive-surface</source></sampler2D></newparam>':"")+ve+(oe.side===DoubleSide?'<extra><technique profile="THREEJS"><double_sided sid="double_sided" type="int">1</double_sided></technique></extra>':"")+"</profile_COMMON></effect>";k.push('<material id="'+me+'"'+(oe.name?' name="'+oe.name+'"':"")+'><instance_effect url="#'+me+'-effect" /></material>'),J.push(le),H.set(oe,me)}return me}(se[le%se.length])}),me+='<instance_geometry url="#'+ge+'">'+(null!=ue?"<bind_material><technique_common>"+ue.map(function(ve,le){return'<instance_material symbol="MESH_MATERIAL_'+le+'" target="#'+ve+'" ><bind_vertex_input semantic="TEXCOORD" input_semantic="TEXCOORD" input_set="0" /></instance_material>'}).join("")+"</technique_common></bind_material>":"")+"</instance_geometry>"}return oe.children.forEach(function(ve){return me+=V(ve)}),me+="</node>"}(e),ee='<?xml version="1.0" encoding="UTF-8" standalone="no" ?><COLLADA xmlns="'+("1.4.1"===v?"http://www.collada.org/2005/11/COLLADASchema":"https://www.khronos.org/collada/")+'" version="'+v+'"><asset><contributor><authoring_tool>three.js Collada Exporter</authoring_tool>'+(null!==d.author?"<author>"+d.author+"</author>":"")+"</contributor><created>"+(new Date).toISOString()+"</created><modified>"+(new Date).toISOString()+"</modified><up_axis>Y_UP</up_axis></asset>";ee+="<library_images>"+j.join("")+"</library_images>",ee+="<library_effects>"+J.join("")+"</library_effects>",ee+="<library_materials>"+k.join("")+"</library_materials>",ee+="<library_geometries>"+te.join("")+"</library_geometries>",ee+='<library_visual_scenes><visual_scene id="Scene" name="scene">'+U+"</visual_scene></library_visual_scenes>",ee+='<scene><instance_visual_scene url="#Scene"/></scene>';var oe,me,fe,ge,$,ue,Q={data:(oe=ee+="</COLLADA>",me=/^<\//,fe=/(\?>$)|(\/>$)/,ge=/<[^>]+>[^<]*<\/[^<]+>/,$=function Y(Z,se){return se>0?Z+Y(Z,se-1):""},ue=0,oe.match(/(<[^>]+>[^<]+<\/[^<]+>)|(<[^>]+>)/g).map(function(Y){!ge.test(Y)&&!fe.test(Y)&&me.test(Y)&&ue--;var Z=""+$("  ",ue)+Y;return!ge.test(Y)&&!fe.test(Y)&&!me.test(Y)&&ue++,Z}).join("\n")),textures:re};return"function"==typeof a&&requestAnimationFrame(function(){return a(Q)}),Q}};var DRACOExporter=function(){};DRACOExporter.prototype={constructor:DRACOExporter,parse:function(e,a){if(void 0===DracoEncoderModule)throw new Error("DRACOExporter: required the draco_decoder to work.");void 0===a&&(a={decodeSpeed:5,encodeSpeed:5,encoderMethod:DRACOExporter.MESH_EDGEBREAKER_ENCODING,quantization:[16,8,8,8,8],exportUvs:!0,exportNormals:!0,exportColor:!1});var d=DracoEncoderModule(),v=new d.Encoder,g=new d.MeshBuilder,C=new d.Mesh;if(!0===e.isGeometry){var w=new BufferGeometry;w.fromGeometry(e),e=w}if(!0!==e.isBufferGeometry)throw new Error("DRACOExporter.parse(geometry, options): geometry is not a Geometry or BufferGeometry instance.");var _=e.getAttribute("position");if(g.AddFloatAttributeToMesh(C,d.POSITION,_.count,_.itemSize,_.array),null!==(x=e.getIndex()))g.AddFacesToMesh(C,x.count,x.array);else{for(var x=new(_.count>65535?Uint32Array:Uint16Array)(_.count),b=0;b<x.length;b++)x[b]=b;g.AddFacesToMesh(C,_.count,x)}if(!0===a.exportNormals){var A=e.getAttribute("normal");void 0!==A&&g.AddFloatAttributeToMesh(C,d.NORMAL,A.count,A.itemSize,A.array)}if(!0===a.exportUvs){var E=e.getAttribute("uv");void 0!==E&&g.AddFloatAttributeToMesh(C,d.TEX_COORD,E.count,E.itemSize,E.array)}if(!0===a.exportColor){var R=e.getAttribute("color");void 0!==R&&g.AddFloatAttributeToMesh(C,d.COLOR,R.count,R.itemSize,R.array)}var O=new d.DracoInt8Array;if(v.SetSpeedOptions(a.encodeSpeed||5,a.decodeSpeed||5),void 0!==a.encoderMethod&&v.SetEncodingMethod(a.encoderMethod),void 0!==a.quantization)for(b=0;b<5;b++)void 0!==a.quantization[b]&&v.SetAttributeQuantization(b,a.quantization[b]);var D=v.EncodeMeshToDracoBuffer(C,O);if(d.destroy(C),0===D)throw new Error("DRACOExporter: Draco encoding failed.");var F=new Int8Array(new ArrayBuffer(D));for(b=0;b<D;b++)F[b]=O.GetValue(b);return d.destroy(O),d.destroy(v),d.destroy(g),F}},DRACOExporter.MESH_EDGEBREAKER_ENCODING=1,DRACOExporter.MESH_SEQUENTIAL_ENCODING=0,DRACOExporter.POINT_CLOUD=0,DRACOExporter.TRIANGULAR_MESH=1,DRACOExporter.INVALID=-1,DRACOExporter.POSITION=0,DRACOExporter.NORMAL=1,DRACOExporter.COLOR=2,DRACOExporter.TEX_COORD=3,DRACOExporter.GENERIC=4;var WEBGL_CONSTANTS={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,FLOAT:5126,UNSIGNED_INT:5125,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},THREE_TO_WEBGL={};THREE_TO_WEBGL[NearestFilter]=WEBGL_CONSTANTS.NEAREST,THREE_TO_WEBGL[NearestMipmapNearestFilter]=WEBGL_CONSTANTS.NEAREST_MIPMAP_NEAREST,THREE_TO_WEBGL[NearestMipmapLinearFilter]=WEBGL_CONSTANTS.NEAREST_MIPMAP_LINEAR,THREE_TO_WEBGL[LinearFilter]=WEBGL_CONSTANTS.LINEAR,THREE_TO_WEBGL[LinearMipmapNearestFilter]=WEBGL_CONSTANTS.LINEAR_MIPMAP_NEAREST,THREE_TO_WEBGL[LinearMipmapLinearFilter]=WEBGL_CONSTANTS.LINEAR_MIPMAP_LINEAR,THREE_TO_WEBGL[ClampToEdgeWrapping]=WEBGL_CONSTANTS.CLAMP_TO_EDGE,THREE_TO_WEBGL[RepeatWrapping]=WEBGL_CONSTANTS.REPEAT,THREE_TO_WEBGL[MirroredRepeatWrapping]=WEBGL_CONSTANTS.MIRRORED_REPEAT;var PATH_PROPERTIES={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},GLTFExporter=function(){};GLTFExporter.prototype={constructor:GLTFExporter,parse:function(e,a,d){(d=Object.assign({},{binary:!1,trs:!1,onlyVisible:!0,truncateDrawRange:!0,embedImages:!0,maxTextureSize:1/0,animations:[],forceIndices:!1,forcePowerOfTwoTextures:!1,includeCustomExtensions:!1},d)).animations.length>0&&(d.trs=!0);var R,g={asset:{version:"2.0",generator:"GLTFExporter"}},C=0,w=[],_=[],x=new Map,b=[],A={},E={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map},O=new Map,D=0;function F(ae){return O.has(ae)||O.set(ae,D++),O.get(ae)}function L(ae,pe){return ae.length===pe.length&&ae.every(function(he,ce){return he===pe[ce]})}function re(ae){return 4*Math.ceil(ae/4)}function j(ae,pe){pe=pe||0;var he=re(ae.byteLength);if(he!==ae.byteLength){var ce=new Uint8Array(he);if(ce.set(new Uint8Array(ae)),0!==pe)for(var Te=ae.byteLength;Te<he;Te++)ce[Te]=pe;return ce.buffer}return ae}function te(ae,pe){if(0!==Object.keys(ae.userData).length)try{var he=JSON.parse(JSON.stringify(ae.userData));if(d.includeCustomExtensions&&he.gltfExtensions){for(var ce in void 0===pe.extensions&&(pe.extensions={}),he.gltfExtensions)pe.extensions[ce]=he.gltfExtensions[ce],A[ce]=!0;delete he.gltfExtensions}Object.keys(he).length>0&&(pe.extras=he)}catch(Te){console.warn("GLTFExporter: userData of '"+ae.name+"' won't be serialized because of JSON.stringify error - "+Te.message)}}function J(ae,pe){var he=!1,ce={};(0!==pe.offset.x||0!==pe.offset.y)&&(ce.offset=pe.offset.toArray(),he=!0),0!==pe.rotation&&(ce.rotation=pe.rotation,he=!0),(1!==pe.repeat.x||1!==pe.repeat.y)&&(ce.scale=pe.repeat.toArray(),he=!0),he&&(ae.extensions=ae.extensions||{},ae.extensions.KHR_texture_transform=ce,A.KHR_texture_transform=!0)}function k(ae){return g.buffers||(g.buffers=[{byteLength:0}]),w.push(ae),0}function ee(ae,pe,he,ce){var be;if(ae.array.constructor===Float32Array)be=WEBGL_CONSTANTS.FLOAT;else if(ae.array.constructor===Uint32Array)be=WEBGL_CONSTANTS.UNSIGNED_INT;else if(ae.array.constructor===Uint16Array)be=WEBGL_CONSTANTS.UNSIGNED_SHORT;else{if(ae.array.constructor!==Uint8Array)throw new Error("GLTFExporter: Unsupported bufferAttribute component type.");be=WEBGL_CONSTANTS.UNSIGNED_BYTE}if(void 0===he&&(he=0),void 0===ce&&(ce=ae.count),d.truncateDrawRange&&void 0!==pe&&null===pe.index){var xe=he+ce,we=pe.drawRange.count===1/0?ae.count:pe.drawRange.start+pe.drawRange.count;he=Math.max(he,pe.drawRange.start),(ce=Math.min(xe,we)-he)<0&&(ce=0)}if(0===ce)return null;var Re,Ne=function(ae,pe,he){for(var ce={min:new Array(ae.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(ae.itemSize).fill(Number.NEGATIVE_INFINITY)},Te=pe;Te<pe+he;Te++)for(var be=0;be<ae.itemSize;be++){var xe=ae.array[Te*ae.itemSize+be];ce.min[be]=Math.min(ce.min[be],xe),ce.max[be]=Math.max(ce.max[be],xe)}return ce}(ae,he,ce);void 0!==pe&&(Re=ae===pe.index?WEBGL_CONSTANTS.ELEMENT_ARRAY_BUFFER:WEBGL_CONSTANTS.ARRAY_BUFFER);var De=function(ae,pe,he,ce,Te){var be;g.bufferViews||(g.bufferViews=[]);for(var xe=re(ce*ae.itemSize*(be=pe===WEBGL_CONSTANTS.UNSIGNED_BYTE?1:pe===WEBGL_CONSTANTS.UNSIGNED_SHORT?2:4)),we=new DataView(new ArrayBuffer(xe)),Ne=0,Re=he;Re<he+ce;Re++)for(var De=0;De<ae.itemSize;De++){var Je=ae.array[Re*ae.itemSize+De];pe===WEBGL_CONSTANTS.FLOAT?we.setFloat32(Ne,Je,!0):pe===WEBGL_CONSTANTS.UNSIGNED_INT?we.setUint32(Ne,Je,!0):pe===WEBGL_CONSTANTS.UNSIGNED_SHORT?we.setUint16(Ne,Je,!0):pe===WEBGL_CONSTANTS.UNSIGNED_BYTE&&we.setUint8(Ne,Je),Ne+=be}var $e={buffer:k(we.buffer),byteOffset:C,byteLength:xe};return void 0!==Te&&($e.target=Te),Te===WEBGL_CONSTANTS.ARRAY_BUFFER&&($e.byteStride=ae.itemSize*be),C+=xe,g.bufferViews.push($e),{id:g.bufferViews.length-1,byteLength:0}}(ae,be,he,ce,Re),Je={bufferView:De.id,byteOffset:De.byteOffset,componentType:be,count:ce,max:Ne.max,min:Ne.min,type:{1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",16:"MAT4"}[ae.itemSize]};return g.accessors||(g.accessors=[]),g.accessors.push(Je),g.accessors.length-1}function Q(ae,pe,he){E.images.has(ae)||E.images.set(ae,{});var ce=E.images.get(ae),Te=pe===RGBAFormat?"image/png":"image/jpeg",be=Te+":flipY/"+he.toString();if(void 0!==ce[be])return ce[be];g.images||(g.images=[]);var xe={mimeType:Te};if(d.embedImages){var we=R=R||document.createElement("canvas");we.width=Math.min(ae.width,d.maxTextureSize),we.height=Math.min(ae.height,d.maxTextureSize),d.forcePowerOfTwoTextures&&!function(ae){return MathUtils.isPowerOfTwo(ae.width)&&MathUtils.isPowerOfTwo(ae.height)}(we)&&(console.warn("GLTFExporter: Resized non-power-of-two image.",ae),we.width=MathUtils.floorPowerOfTwo(we.width),we.height=MathUtils.floorPowerOfTwo(we.height));var Ne=we.getContext("2d");!0===he&&(Ne.translate(0,we.height),Ne.scale(1,-1)),Ne.drawImage(ae,0,0,we.width,we.height),!0===d.binary?_.push(new Promise(function(De){we.toBlob(function(Je){(function(ae){return g.bufferViews||(g.bufferViews=[]),new Promise(function(pe){var he=new window.FileReader;he.readAsArrayBuffer(ae),he.onloadend=function(){var ce=j(he.result),Te={buffer:k(ce),byteOffset:C,byteLength:ce.byteLength};C+=ce.byteLength,g.bufferViews.push(Te),pe(g.bufferViews.length-1)}})})(Je).then(function($e){xe.bufferView=$e,De()})},Te)})):xe.uri=we.toDataURL(Te)}else xe.uri=ae.src;g.images.push(xe);var Re=g.images.length-1;return ce[be]=Re,Re}function oe(ae){return g.samplers||(g.samplers=[]),g.samplers.push({magFilter:THREE_TO_WEBGL[ae.magFilter],minFilter:THREE_TO_WEBGL[ae.minFilter],wrapS:THREE_TO_WEBGL[ae.wrapS],wrapT:THREE_TO_WEBGL[ae.wrapT]}),g.samplers.length-1}function me(ae){if(E.textures.has(ae))return E.textures.get(ae);g.textures||(g.textures=[]);var pe={sampler:oe(ae),source:Q(ae.image,ae.format,ae.flipY)};ae.name&&(pe.name=ae.name),g.textures.push(pe);var he=g.textures.length-1;return E.textures.set(ae,he),he}function fe(ae){if(E.materials.has(ae))return E.materials.get(ae);if(g.materials||(g.materials=[]),ae.isShaderMaterial&&!ae.isGLTFSpecularGlossinessMaterial)return console.warn("GLTFExporter: ShaderMaterial not supported."),null;var pe={pbrMetallicRoughness:{}};ae.isMeshBasicMaterial?(pe.extensions={KHR_materials_unlit:{}},A.KHR_materials_unlit=!0):ae.isGLTFSpecularGlossinessMaterial?(pe.extensions={KHR_materials_pbrSpecularGlossiness:{}},A.KHR_materials_pbrSpecularGlossiness=!0):ae.isMeshStandardMaterial||console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");var he=ae.color.toArray().concat([ae.opacity]);if(L(he,[1,1,1,1])||(pe.pbrMetallicRoughness.baseColorFactor=he),ae.isMeshStandardMaterial?(pe.pbrMetallicRoughness.metallicFactor=ae.metalness,pe.pbrMetallicRoughness.roughnessFactor=ae.roughness):ae.isMeshBasicMaterial?(pe.pbrMetallicRoughness.metallicFactor=0,pe.pbrMetallicRoughness.roughnessFactor=.9):(pe.pbrMetallicRoughness.metallicFactor=.5,pe.pbrMetallicRoughness.roughnessFactor=.5),ae.isGLTFSpecularGlossinessMaterial){pe.pbrMetallicRoughness.baseColorFactor&&(pe.extensions.KHR_materials_pbrSpecularGlossiness.diffuseFactor=pe.pbrMetallicRoughness.baseColorFactor);var ce=[1,1,1];ae.specular.toArray(ce,0),pe.extensions.KHR_materials_pbrSpecularGlossiness.specularFactor=ce,pe.extensions.KHR_materials_pbrSpecularGlossiness.glossinessFactor=ae.glossiness}if(ae.metalnessMap||ae.roughnessMap)if(ae.metalnessMap===ae.roughnessMap){var Te={index:me(ae.metalnessMap)};J(Te,ae.metalnessMap),pe.pbrMetallicRoughness.metallicRoughnessTexture=Te}else console.warn("GLTFExporter: Ignoring metalnessMap and roughnessMap because they are not the same Texture.");if(ae.map){var be={index:me(ae.map)};J(be,ae.map),ae.isGLTFSpecularGlossinessMaterial&&(pe.extensions.KHR_materials_pbrSpecularGlossiness.diffuseTexture=be),pe.pbrMetallicRoughness.baseColorTexture=be}if(ae.isGLTFSpecularGlossinessMaterial&&ae.specularMap){var xe={index:me(ae.specularMap)};J(xe,ae.specularMap),pe.extensions.KHR_materials_pbrSpecularGlossiness.specularGlossinessTexture=xe}if(ae.emissive){var we=ae.emissive.clone().multiplyScalar(ae.emissiveIntensity).toArray();if(L(we,[0,0,0])||(pe.emissiveFactor=we),ae.emissiveMap){var Ne={index:me(ae.emissiveMap)};J(Ne,ae.emissiveMap),pe.emissiveTexture=Ne}}if(ae.normalMap){var Re={index:me(ae.normalMap)};ae.normalScale&&-1!==ae.normalScale.x&&(ae.normalScale.x!==ae.normalScale.y&&console.warn("GLTFExporter: Normal scale components are different, ignoring Y and exporting X."),Re.scale=ae.normalScale.x),J(Re,ae.normalMap),pe.normalTexture=Re}if(ae.aoMap){var De={index:me(ae.aoMap),texCoord:1};1!==ae.aoMapIntensity&&(De.strength=ae.aoMapIntensity),J(De,ae.aoMap),pe.occlusionTexture=De}ae.transparent?pe.alphaMode="BLEND":ae.alphaTest>0&&(pe.alphaMode="MASK",pe.alphaCutoff=ae.alphaTest),ae.side===DoubleSide&&(pe.doubleSided=!0),""!==ae.name&&(pe.name=ae.name),te(ae,pe),g.materials.push(pe);var Je=g.materials.length-1;return E.materials.set(ae,Je),Je}function ue(ae,pe){g.animations||(g.animations=[]);for(var he=(ae=GLTFExporter.Utils.mergeMorphTargetTracks(ae.clone(),pe)).tracks,ce=[],Te=[],be=0;be<he.length;++be){var xe=he[be],we=PropertyBinding.parseTrackName(xe.name),Ne=PropertyBinding.findNode(pe,we.nodeName),Re=PATH_PROPERTIES[we.propertyName];if("bones"===we.objectName&&(Ne=!0===Ne.isSkinnedMesh?Ne.skeleton.getBoneByName(we.objectIndex):void 0),!Ne||!Re)return console.warn('GLTFExporter: Could not export animation track "%s".',xe.name),null;var $e,Je=xe.values.length/xe.times.length;Re===PATH_PROPERTIES.morphTargetInfluences&&(Je/=Ne.morphTargetInfluences.length),!0===xe.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline?($e="CUBICSPLINE",Je/=3):$e=xe.getInterpolation()===InterpolateDiscrete?"STEP":"LINEAR",Te.push({input:ee(new BufferAttribute(xe.times,1)),output:ee(new BufferAttribute(xe.values,Je)),interpolation:$e}),ce.push({sampler:Te.length-1,target:{node:x.get(Ne),path:Re}})}return g.animations.push({name:ae.name||"clip_"+g.animations.length,samplers:Te,channels:ce}),g.animations.length-1}function Y(ae){var pe=g.nodes[x.get(ae)],he=ae.skeleton;if(void 0===he)return null;var ce=ae.skeleton.bones[0];if(void 0===ce)return null;for(var Te=[],be=new Float32Array(16*he.bones.length),xe=0;xe<he.bones.length;++xe)Te.push(x.get(he.bones[xe])),he.boneInverses[xe].toArray(be,16*xe);return void 0===g.skins&&(g.skins=[]),g.skins.push({inverseBindMatrices:ee(new BufferAttribute(be,16)),joints:Te,skeleton:x.get(ce)}),pe.skin=g.skins.length-1}function Z(ae){var pe={};ae.name&&(pe.name=ae.name),pe.color=ae.color.toArray(),pe.intensity=ae.intensity,ae.isDirectionalLight?pe.type="directional":ae.isPointLight?(pe.type="point",ae.distance>0&&(pe.range=ae.distance)):ae.isSpotLight&&(pe.type="spot",ae.distance>0&&(pe.range=ae.distance),pe.spot={},pe.spot.innerConeAngle=(ae.penumbra-1)*ae.angle*-1,pe.spot.outerConeAngle=ae.angle),void 0!==ae.decay&&2!==ae.decay&&console.warn("GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),ae.target&&(ae.target.parent!==ae||0!==ae.target.position.x||0!==ae.target.position.y||-1!==ae.target.position.z)&&console.warn("GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1.");var he=g.extensions.KHR_lights_punctual.lights;return he.push(pe),he.length-1}function se(ae){g.nodes||(g.nodes=[]);var pe={};if(d.trs){var he=ae.quaternion.toArray(),ce=ae.position.toArray(),Te=ae.scale.toArray();L(he,[0,0,0,1])||(pe.rotation=he),L(ce,[0,0,0])||(pe.translation=ce),L(Te,[1,1,1])||(pe.scale=Te)}else ae.matrixAutoUpdate&&ae.updateMatrix(),L(ae.matrix.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])||(pe.matrix=ae.matrix.elements);if(""!==ae.name&&(pe.name=String(ae.name)),te(ae,pe),ae.isMesh||ae.isLine||ae.isPoints){var be=function(ae){if(E.meshes.has(pe=ae.geometry.uuid+":"+ae.material.uuid))return E.meshes.get(pe);var ce,he=ae.geometry;if(ae.isLineSegments)ce=WEBGL_CONSTANTS.LINES;else if(ae.isLineLoop)ce=WEBGL_CONSTANTS.LINE_LOOP;else if(ae.isLine)ce=WEBGL_CONSTANTS.LINE_STRIP;else if(ae.isPoints)ce=WEBGL_CONSTANTS.POINTS;else{if(!he.isBufferGeometry){console.warn("GLTFExporter: Exporting Geometry will increase file size. Use BufferGeometry instead.");var Te=new BufferGeometry;Te.fromGeometry(he),he=Te}ce=ae.material.wireframe?WEBGL_CONSTANTS.LINES:WEBGL_CONSTANTS.TRIANGLES}var be={},xe={},we=[],Ne=[],Re={uv:"TEXCOORD_0",uv2:"TEXCOORD_1",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},De=he.getAttribute("normal");void 0!==De&&!function(ae){if(E.attributesNormalized.has(ae))return!1;for(var pe=new Vector3,he=0,ce=ae.count;he<ce;he++)if(Math.abs(pe.fromArray(ae.array,3*he).length()-1)>5e-4)return!1;return!0}(De)&&(console.warn("GLTFExporter: Creating normalized normal attribute from the non-normalized one."),he.setAttribute("normal",function(ae){if(E.attributesNormalized.has(ae))return E.attributesNormalized.get(ae);for(var pe=ae.clone(),he=new Vector3,ce=0,Te=pe.count;ce<Te;ce++)he.fromArray(pe.array,3*ce),0===he.x&&0===he.y&&0===he.z?he.setX(1):he.normalize(),he.toArray(pe.array,3*ce);return E.attributesNormalized.set(ae,pe),pe}(De)));var Je=null;for(var $e in he.attributes)if("morph"!==$e.substr(0,5)){var pt=he.attributes[$e];if($e=Re[$e]||$e.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test($e)||($e="_"+$e),E.attributes.has(F(pt))){xe[$e]=E.attributes.get(F(pt));continue}Je=null;var at=pt.array;"JOINTS_0"===$e&&!(at instanceof Uint16Array)&&!(at instanceof Uint8Array)&&(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),Je=new BufferAttribute(new Uint16Array(at),pt.itemSize,pt.normalized));var Xe=ee(Je||pt,he);null!==Xe&&(xe[$e]=Xe,E.attributes.set(F(pt),Xe))}if(void 0!==De&&he.setAttribute("normal",De),0===Object.keys(xe).length)return null;if(void 0!==ae.morphTargetInfluences&&ae.morphTargetInfluences.length>0){var Ke=[],lt=[],ot={};if(void 0!==ae.morphTargetDictionary)for(var St in ae.morphTargetDictionary)ot[ae.morphTargetDictionary[St]]=St;for(var ft=0;ft<ae.morphTargetInfluences.length;++ft){var He={},gt=!1;for(var $e in he.morphAttributes)if("position"===$e||"normal"===$e){pt=he.morphAttributes[$e][ft];var vt=$e.toUpperCase(),Gt=he.attributes[$e];if(E.attributes.has(F(pt)))He[vt]=E.attributes.get(F(pt));else{var Lt=pt.clone();if(!he.morphTargetsRelative)for(var yt=0,xr=pt.count;yt<xr;yt++)Lt.setXYZ(yt,pt.getX(yt)-Gt.getX(yt),pt.getY(yt)-Gt.getY(yt),pt.getZ(yt)-Gt.getZ(yt));He[vt]=ee(Lt,he),E.attributes.set(F(Gt),He[vt])}}else gt||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),gt=!0);Ne.push(He),Ke.push(ae.morphTargetInfluences[ft]),void 0!==ae.morphTargetDictionary&&lt.push(ot[ft])}be.weights=Ke,lt.length>0&&(be.extras={},be.extras.targetNames=lt)}var Dr=d.forceIndices,Ur=Array.isArray(ae.material);if(Ur&&0===he.groups.length)return null;!Dr&&null===he.index&&Ur&&(console.warn("GLTFExporter: Creating index for non-indexed multi-material mesh."),Dr=!0);var qr=!1;if(null===he.index&&Dr){for(var Ar=[],hn=(ft=0,he.attributes.position.count);ft<hn;ft++)Ar[ft]=ft;he.setIndex(Ar),qr=!0}var Sn=Ur?ae.material:[ae.material],Sr=Ur?he.groups:[{materialIndex:0,start:void 0,count:void 0}];for(ft=0,hn=Sr.length;ft<hn;ft++){var An={mode:ce,attributes:xe};if(te(he,An),Ne.length>0&&(An.targets=Ne),null!==he.index){var pe=F(he.index);(void 0!==Sr[ft].start||void 0!==Sr[ft].count)&&(pe+=":"+Sr[ft].start+":"+Sr[ft].count),E.attributes.has(pe)?An.indices=E.attributes.get(pe):(An.indices=ee(he.index,he,Sr[ft].start,Sr[ft].count),E.attributes.set(pe,An.indices)),null===An.indices&&delete An.indices}var jr=fe(Sn[Sr[ft].materialIndex]);null!==jr&&(An.material=jr),we.push(An)}qr&&he.setIndex(null),be.primitives=we,g.meshes||(g.meshes=[]),g.meshes.push(be);var cn=g.meshes.length-1;return E.meshes.set(pe,cn),cn}(ae);null!==be&&(pe.mesh=be)}else if(ae.isCamera)pe.camera=function(ae){g.cameras||(g.cameras=[]);var pe=ae.isOrthographicCamera,he={type:pe?"orthographic":"perspective"};return pe?he.orthographic={xmag:2*ae.right,ymag:2*ae.top,zfar:ae.far<=0?.001:ae.far,znear:ae.near<0?0:ae.near}:he.perspective={aspectRatio:ae.aspect,yfov:MathUtils.degToRad(ae.fov),zfar:ae.far<=0?.001:ae.far,znear:ae.near<0?0:ae.near},""!==ae.name&&(he.name=ae.type),g.cameras.push(he),g.cameras.length-1}(ae);else if(ae.isDirectionalLight||ae.isPointLight||ae.isSpotLight)A.KHR_lights_punctual||(g.extensions=g.extensions||{},g.extensions.KHR_lights_punctual={lights:[]},A.KHR_lights_punctual=!0),pe.extensions=pe.extensions||{},pe.extensions.KHR_lights_punctual={light:Z(ae)};else if(ae.isLight)return console.warn("GLTFExporter: Only directional, point, and spot lights are supported.",ae),null;if(ae.isSkinnedMesh&&b.push(ae),ae.children.length>0){for(var xe=[],we=0,Ne=ae.children.length;we<Ne;we++){var Re=ae.children[we];if(Re.visible||!1===d.onlyVisible){var De=se(Re);null!==De&&xe.push(De)}}xe.length>0&&(pe.children=xe)}g.nodes.push(pe);var Je=g.nodes.length-1;return x.set(ae,Je),Je}function ve(ae){g.scenes||(g.scenes=[],g.scene=0);var pe={nodes:[]};""!==ae.name&&(pe.name=ae.name),ae.userData&&Object.keys(ae.userData).length>0&&(pe.extras=te(ae)),g.scenes.push(pe);for(var he=[],ce=0,Te=ae.children.length;ce<Te;ce++){var be=ae.children[ce];if(be.visible||!1===d.onlyVisible){var xe=se(be);null!==xe&&he.push(xe)}}he.length>0&&(pe.nodes=he),te(ae,pe)}(function(ae){ae=ae instanceof Array?ae:[ae];for(var pe=[],he=0;he<ae.length;he++)ae[he]instanceof Scene?ve(ae[he]):pe.push(ae[he]);for(pe.length>0&&function(ae){var pe=new Scene;pe.name="AuxScene";for(var he=0;he<ae.length;he++)pe.children.push(ae[he]);ve(pe)}(pe),he=0;he<b.length;++he)Y(b[he]);for(he=0;he<d.animations.length;++he)ue(d.animations[he],ae[0])})(e),Promise.all(_).then(function(){var ae=new Blob(w,{type:"application/octet-stream"}),pe=Object.keys(A);if(pe.length>0&&(g.extensionsUsed=pe),g.buffers&&g.buffers.length>0){g.buffers[0].byteLength=ae.size;var he=new window.FileReader;!0===d.binary?(he.readAsArrayBuffer(ae),he.onloadend=function(){var Re=j(he.result),De=new DataView(new ArrayBuffer(8));De.setUint32(0,Re.byteLength,!0),De.setUint32(4,5130562,!0);var Je=j(function(ae){if(void 0!==window.TextEncoder)return(new TextEncoder).encode(ae).buffer;for(var pe=new Uint8Array(new ArrayBuffer(ae.length)),he=0,ce=ae.length;he<ce;he++){var Te=ae.charCodeAt(he);pe[he]=Te>255?32:Te}return pe.buffer}(JSON.stringify(g)),32),$e=new DataView(new ArrayBuffer(8));$e.setUint32(0,Je.byteLength,!0),$e.setUint32(4,1313821514,!0);var pt=new ArrayBuffer(12),ut=new DataView(pt);ut.setUint32(0,1179937895,!0),ut.setUint32(4,2,!0),ut.setUint32(8,12+$e.byteLength+Je.byteLength+De.byteLength+Re.byteLength,!0);var Xe=new Blob([pt,$e,Je,De,Re],{type:"application/octet-stream"}),Ke=new window.FileReader;Ke.readAsArrayBuffer(Xe),Ke.onloadend=function(){a(Ke.result)}}):(he.readAsDataURL(ae),he.onloadend=function(){g.buffers[0].uri=he.result,a(g)})}else a(g)})}},GLTFExporter.Utils={insertKeyframe:function(e,a){var _,d=.001,v=e.getValueSize(),g=new e.TimeBufferType(e.times.length+1),C=new e.ValueBufferType(e.values.length+v),w=e.createInterpolant(new e.ValueBufferType(v));if(0===e.times.length){g[0]=a;for(var x=0;x<v;x++)C[x]=0;_=0}else if(a<e.times[0]){if(Math.abs(e.times[0]-a)<d)return 0;g[0]=a,g.set(e.times,1),C.set(w.evaluate(a),0),C.set(e.values,v),_=0}else if(a>e.times[e.times.length-1]){if(Math.abs(e.times[e.times.length-1]-a)<d)return e.times.length-1;g[g.length-1]=a,g.set(e.times,0),C.set(e.values,0),C.set(w.evaluate(a),e.values.length),_=g.length-1}else for(x=0;x<e.times.length;x++){if(Math.abs(e.times[x]-a)<d)return x;if(e.times[x]<a&&e.times[x+1]>a){g.set(e.times.slice(0,x+1),0),g[x+1]=a,g.set(e.times.slice(x+1),x+2),C.set(e.values.slice(0,(x+1)*v),0),C.set(w.evaluate(a),(x+1)*v),C.set(e.values.slice((x+1)*v),(x+2)*v),_=x+1;break}}return e.times=g,e.values=C,_},mergeMorphTargetTracks:function(e,a){for(var d=[],v={},g=e.tracks,C=0;C<g.length;++C){var w=g[C],_=PropertyBinding.parseTrackName(w.name),x=PropertyBinding.findNode(a,_.nodeName);if("morphTargetInfluences"===_.propertyName&&void 0!==_.propertyIndex){if(w.createInterpolant!==w.InterpolantFactoryMethodDiscrete&&w.createInterpolant!==w.InterpolantFactoryMethodLinear){if(w.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),(w=w.clone()).setInterpolation(InterpolateLinear)}var E,b=x.morphTargetInfluences.length,A=x.morphTargetDictionary[_.propertyIndex];if(void 0===A)throw new Error("GLTFExporter: Morph target name not found: "+_.propertyIndex);if(void 0!==v[x.uuid]){var D=w.createInterpolant(new w.ValueBufferType(1));for(E=v[x.uuid],O=0;O<E.times.length;O++)E.values[O*b+A]=D.evaluate(E.times[O]);for(O=0;O<w.times.length;O++){var F=this.insertKeyframe(E,w.times[O]);E.values[F*b+A]=w.values[O]}}else{for(var R=new((E=w.clone()).ValueBufferType)(b*E.times.length),O=0;O<E.times.length;O++)R[O*b+A]=E.values[O];E.name=".morphTargetInfluences",E.values=R,v[x.uuid]=E,d.push(E)}}else d.push(w)}return e.tracks=d,e}};var MMDExporter=function(){var e;this.parseVpd=function(v,g,C){if(!0!==v.isSkinnedMesh)return console.warn("MMDExporter: parseVpd() requires SkinnedMesh instance."),null;function w(re){Math.abs(re)<1e-6&&(re=0);var j=re.toString();-1===j.indexOf(".")&&(j+=".");var te=(j+="000000").indexOf(".");return j.slice(0,te)+"."+j.slice(te+1,te+7)}function _(re){for(var j=[],te=0,J=re.length;te<J;te++)j.push(w(re[te]));return j.join(",")}v.updateMatrixWorld(!0);var x=v.skeleton.bones,b=function(v){var g=v.clone();return g.pose(),g.skeleton.bones}(v),A=new Vector3,E=new Quaternion,R=new Quaternion,O=new Matrix4,D=[];D.push("Vocaloid Pose Data file"),D.push(""),D.push((""!==v.name?v.name.replace(/\s/g,"_"):"skin")+".osm;"),D.push(x.length+";"),D.push("");for(var F=0,L=x.length;F<L;F++){var I=x[F],V=b[F];!0===C&&void 0!==I.userData.ik&&void 0!==I.userData.ik.originalMatrix?O.fromArray(I.userData.ik.originalMatrix):O.copy(I.matrix),A.setFromMatrixPosition(O),E.setFromRotationMatrix(O);var z=A.sub(V.position).toArray(),H=R.copy(V.quaternion).conjugate().multiply(E).toArray();z[2]=-z[2],H[0]=-H[0],H[1]=-H[1],D.push("Bone"+F+"{"+I.name),D.push("  "+_(z)+";"),D.push("  "+_(H)+";"),D.push("}"),D.push("")}D.push("");var X=D.join("\n");return!0===g?function(v){if(void 0===e){var C=(new MMDParser.CharsetEncoder).s2uTable;e={};for(var w=Object.keys(C),_=0,x=w.length;_<x;_++){var b=w[_],A=C[b];b=parseInt(b),e[A]=b}}var E=[];for(_=0,x=v.length;_<x;_++){var R=v.charCodeAt(_);if(void 0===(A=e[R]))throw"cannot convert charcode 0x"+R.toString(16);A>255&&E.push(A>>8&255),E.push(255&A)}return new Uint8Array(E)}(X):X}},OBJExporter=function(){};OBJExporter.prototype={constructor:OBJExporter,parse:function(e){var x,b,A,E,R,a="",d=0,v=0,g=0,C=new Vector3,w=new Vector3,_=new Vector2,O=[];return e.traverse(function(L){L instanceof Mesh&&function(I){var V=0,z=0,H=0,X=I.geometry,re=new Matrix3;if(X instanceof Geometry&&(X=(new BufferGeometry).setFromObject(I)),X instanceof BufferGeometry){var j=X.getAttribute("position"),te=X.getAttribute("normal"),J=X.getAttribute("uv"),k=X.getIndex();if(a+="o "+I.name+"\n",I.material&&I.material.name&&(a+="usemtl "+I.material.name+"\n"),void 0!==j)for(x=0,E=j.count;x<E;x++,V++)C.x=j.getX(x),C.y=j.getY(x),C.z=j.getZ(x),C.applyMatrix4(I.matrixWorld),a+="v "+C.x+" "+C.y+" "+C.z+"\n";if(void 0!==J)for(x=0,E=J.count;x<E;x++,H++)_.x=J.getX(x),_.y=J.getY(x),a+="vt "+_.x+" "+_.y+"\n";if(void 0!==te)for(re.getNormalMatrix(I.matrixWorld),x=0,E=te.count;x<E;x++,z++)w.x=te.getX(x),w.y=te.getY(x),w.z=te.getZ(x),w.applyMatrix3(re).normalize(),a+="vn "+w.x+" "+w.y+" "+w.z+"\n";if(null!==k)for(x=0,E=k.count;x<E;x+=3){for(R=0;R<3;R++)b=k.getX(x+R)+1,O[R]=d+b+(te||J?"/"+(J?v+b:"")+(te?"/"+(g+b):""):"");a+="f "+O.join(" ")+"\n"}else for(x=0,E=j.count;x<E;x+=3){for(R=0;R<3;R++)O[R]=d+(b=x+R+1)+(te||J?"/"+(J?v+b:"")+(te?"/"+(g+b):""):"");a+="f "+O.join(" ")+"\n"}}else console.warn("OBJExporter.parseMesh(): geometry type unsupported",X);d+=V,v+=H,g+=z}(L),L instanceof Line&&function(I){var V=0,z=I.geometry,H=I.type;if(z instanceof Geometry&&(z=(new BufferGeometry).setFromObject(I)),z instanceof BufferGeometry){var X=z.getAttribute("position");if(a+="o "+I.name+"\n",void 0!==X)for(x=0,E=X.count;x<E;x++,V++)C.x=X.getX(x),C.y=X.getY(x),C.z=X.getZ(x),C.applyMatrix4(I.matrixWorld),a+="v "+C.x+" "+C.y+" "+C.z+"\n";if("Line"===H){for(a+="l ",b=1,E=X.count;b<=E;b++)a+=d+b+" ";a+="\n"}if("LineSegments"===H)for(A=1+(b=1),E=X.count;b<E;A=(b+=2)+1)a+="l "+(d+b)+" "+(d+A)+"\n"}else console.warn("OBJExporter.parseLine(): geometry type unsupported",z);d+=V}(L)}),a}};var PLYExporter=function(){};PLYExporter.prototype={constructor:PLYExporter,parse:function(e,a,d){function v(U){e.traverse(function(K){if(!0===K.isMesh){var ee=K,Q=ee.geometry;!0===Q.isGeometry&&(Q=w.get(Q)),!0===Q.isBufferGeometry&&void 0!==Q.getAttribute("position")&&U(ee,Q)}})}a&&"object"==typeof a&&(console.warn('PLYExporter: The options parameter is now the third argument to the "parse" function. See the documentation for the new API.'),d=a,a=void 0);var C=(d=Object.assign({binary:!1,excludeAttributes:[]},d)).excludeAttributes,w=new WeakMap,_=!1,x=!1,b=!1,A=0,E=0;e.traverse(function(U){if(!0===U.isMesh){var K=U,ee=K.geometry;if(!0===ee.isGeometry){var Q=w.get(ee)||(new BufferGeometry).setFromObject(K);w.set(ee,Q),ee=Q}if(!0===ee.isBufferGeometry){var oe=ee.getAttribute("position"),me=ee.getAttribute("normal"),fe=ee.getAttribute("uv"),ge=ee.getAttribute("color"),$=ee.getIndex();if(void 0===oe)return;A+=oe.count,E+=$?$.count/3:oe.count/3,void 0!==me&&(_=!0),void 0!==fe&&(b=!0),void 0!==ge&&(x=!0)}}});var R=-1===C.indexOf("index");if(_=_&&-1===C.indexOf("normal"),x=x&&-1===C.indexOf("color"),b=b&&-1===C.indexOf("uv"),R&&E!==Math.floor(E))return console.error("PLYExporter: Failed to generate a valid PLY file with triangle indices because the number of indices is not divisible by 3."),null;var D="ply\nformat "+(d.binary?"binary_big_endian":"ascii")+" 1.0\nelement vertex "+A+"\nproperty float x\nproperty float y\nproperty float z\n";!0===_&&(D+="property float nx\nproperty float ny\nproperty float nz\n"),!0===b&&(D+="property float s\nproperty float t\n"),!0===x&&(D+="property uchar red\nproperty uchar green\nproperty uchar blue\n"),!0===R&&(D+="element face "+E+"\nproperty list uchar int vertex_index\n"),D+="end_header\n";var F=new Vector3,L=new Matrix3,I=null;if(!0===d.binary){var V=(new TextEncoder).encode(D),z=A*(12+(_?12:0)+(x?3:0)+(b?8:0)),X=new DataView(new ArrayBuffer(V.length+z+(R?13*E:0)));new Uint8Array(X.buffer).set(V,0);var re=V.length,j=V.length+z,te=0;v(function(U,K){var ee=K.getAttribute("position"),Q=K.getAttribute("normal"),oe=K.getAttribute("uv"),me=K.getAttribute("color"),fe=K.getIndex();L.getNormalMatrix(U.matrixWorld);for(var ge=0,$=ee.count;ge<$;ge++)F.x=ee.getX(ge),F.y=ee.getY(ge),F.z=ee.getZ(ge),F.applyMatrix4(U.matrixWorld),X.setFloat32(re,F.x),X.setFloat32(re+=4,F.y),X.setFloat32(re+=4,F.z),re+=4,!0===_&&(null!=Q?(F.x=Q.getX(ge),F.y=Q.getY(ge),F.z=Q.getZ(ge),F.applyMatrix3(L).normalize(),X.setFloat32(re,F.x),X.setFloat32(re+=4,F.y),X.setFloat32(re+=4,F.z),re+=4):(X.setFloat32(re,0),X.setFloat32(re+=4,0),X.setFloat32(re+=4,0),re+=4)),!0===b&&(null!=oe?(X.setFloat32(re,oe.getX(ge)),X.setFloat32(re+=4,oe.getY(ge)),re+=4):!1!==b&&(X.setFloat32(re,0),X.setFloat32(re+=4,0),re+=4)),!0===x&&(null!=me?(X.setUint8(re,Math.floor(255*me.getX(ge))),X.setUint8(re+=1,Math.floor(255*me.getY(ge))),X.setUint8(re+=1,Math.floor(255*me.getZ(ge))),re+=1):(X.setUint8(re,255),X.setUint8(re+=1,255),X.setUint8(re+=1,255),re+=1));if(!0===R)if(null!==fe)for(ge=0,$=fe.count;ge<$;ge+=3)X.setUint8(j,3),X.setUint32(j+=1,fe.getX(ge+0)+te),X.setUint32(j+=4,fe.getX(ge+1)+te),X.setUint32(j+=4,fe.getX(ge+2)+te),j+=4;else for(ge=0,$=ee.count;ge<$;ge+=3)X.setUint8(j,3),X.setUint32(j+=1,te+ge),X.setUint32(j+=4,te+ge+1),X.setUint32(j+=4,te+ge+2),j+=4;te+=ee.count}),I=X.buffer}else{te=0;var J="",k="";v(function(K,ee){var Q=ee.getAttribute("position"),oe=ee.getAttribute("normal"),me=ee.getAttribute("uv"),fe=ee.getAttribute("color"),ge=ee.getIndex();L.getNormalMatrix(K.matrixWorld);for(var $=0,ue=Q.count;$<ue;$++){F.x=Q.getX($),F.y=Q.getY($),F.z=Q.getZ($),F.applyMatrix4(K.matrixWorld);var Y=F.x+" "+F.y+" "+F.z;!0===_&&(null!=oe?(F.x=oe.getX($),F.y=oe.getY($),F.z=oe.getZ($),F.applyMatrix3(L).normalize(),Y+=" "+F.x+" "+F.y+" "+F.z):Y+=" 0 0 0"),!0===b&&(null!=me?Y+=" "+me.getX($)+" "+me.getY($):!1!==b&&(Y+=" 0 0")),!0===x&&(Y+=null!=fe?" "+Math.floor(255*fe.getX($))+" "+Math.floor(255*fe.getY($))+" "+Math.floor(255*fe.getZ($)):" 255 255 255"),J+=Y+"\n"}if(!0===R){if(null!==ge)for($=0,ue=ge.count;$<ue;$+=3)k+="3 "+(ge.getX($+0)+te),k+=" "+(ge.getX($+1)+te),k+=" "+(ge.getX($+2)+te)+"\n";else for($=0,ue=Q.count;$<ue;$+=3)k+="3 "+(te+$)+" "+(te+$+1)+" "+(te+$+2)+"\n";E+=ge?ge.count/3:Q.count/3}te+=Q.count}),I=""+D+J+(R?k+"\n":"\n")}return"function"==typeof a&&requestAnimationFrame(function(){return a(I)}),I}};var STLExporter=function(){},s,e;STLExporter.prototype={constructor:STLExporter,parse:(s=new Vector3,e=new Matrix3,function(d,v){void 0===v&&(v={});var g=void 0!==v.binary&&v.binary,C=[],w=0;if(d.traverse(function(re){if(re.isMesh){var j=re.geometry;j.isBufferGeometry&&(j=(new Geometry).fromBufferGeometry(j)),j.isGeometry&&(w+=j.faces.length,C.push({geometry:j,matrixWorld:re.matrixWorld}))}}),g){var _=80,b=new ArrayBuffer(2*w+3*w*4*4+80+4);(A=new DataView(b)).setUint32(_,w,!0),_+=4;for(var E=0,R=C.length;E<R;E++){var D=(O=C[E]).geometry.vertices,F=O.geometry.faces;e.getNormalMatrix(L=O.matrixWorld);for(var I=0,V=F.length;I<V;I++){s.copy((z=F[I]).normal).applyMatrix3(e).normalize(),A.setFloat32(_,s.x,!0),A.setFloat32(_+=4,s.y,!0),A.setFloat32(_+=4,s.z,!0),_+=4;for(var H=[z.a,z.b,z.c],X=0;X<3;X++)s.copy(D[H[X]]).applyMatrix4(L),A.setFloat32(_,s.x,!0),A.setFloat32(_+=4,s.y,!0),A.setFloat32(_+=4,s.z,!0),_+=4;A.setUint16(_,0,!0),_+=2}}return A}var A="";for(A+="solid exported\n",E=0,R=C.length;E<R;E++){var O,L;for(D=(O=C[E]).geometry.vertices,F=O.geometry.faces,e.getNormalMatrix(L=O.matrixWorld),I=0,V=F.length;I<V;I++){var z;for(s.copy((z=F[I]).normal).applyMatrix3(e).normalize(),A+="\tfacet normal "+s.x+" "+s.y+" "+s.z+"\n",A+="\t\touter loop\n",H=[z.a,z.b,z.c],X=0;X<3;X++)s.copy(D[H[X]]).applyMatrix4(L),A+="\t\t\tvertex "+s.x+" "+s.y+" "+s.z+"\n";A+="\t\tendloop\n",A+="\tendfacet\n"}}return A+"endsolid exported\n"})};var TypedGeometryExporter=function(){};TypedGeometryExporter.prototype={constructor:TypedGeometryExporter,parse:function(e){var a={metadata:{version:4,type:"TypedGeometry",generator:"TypedGeometryExporter"}},d=["vertices","normals","uvs"];for(var v in d){for(var g=d[v],C=e[g],w=[],_=0,x=C.length;_<x;_++)w[_]=C[_];a[g]=w}var b=e.boundingSphere;return null!==b&&(a.boundingSphere={center:b.center.toArray(),radius:b.radius}),a}};var BoxLineGeometry=function(e,a,d,v,g,C){BufferGeometry.call(this);for(var w=(e=e||1)/2,_=(a=a||1)/2,x=(d=d||1)/2,b=e/(v=Math.floor(v)||1),A=a/(g=Math.floor(g)||1),E=d/(C=Math.floor(C)||1),R=[],O=-w,D=-_,F=-x,L=0;L<=v;L++)R.push(O,-_,-x,O,_,-x),R.push(O,_,-x,O,_,x),R.push(O,_,x,O,-_,x),R.push(O,-_,x,O,-_,-x),O+=b;for(L=0;L<=g;L++)R.push(-w,D,-x,w,D,-x),R.push(w,D,-x,w,D,x),R.push(w,D,x,-w,D,x),R.push(-w,D,x,-w,D,-x),D+=A;for(L=0;L<=C;L++)R.push(-w,-_,F,-w,_,F),R.push(-w,_,F,w,_,F),R.push(w,_,F,w,-_,F),R.push(w,-_,F,-w,-_,F),F+=E;this.setAttribute("position",new Float32BufferAttribute(R,3))};BoxLineGeometry.prototype=Object.create(BufferGeometry.prototype),BoxLineGeometry.prototype.constructor=BoxLineGeometry;var _startP=new Vector3,_startEnd=new Vector3;function Line3(s,e){this.start=void 0!==s?s:new Vector3,this.end=void 0!==e?e:new Vector3}Object.assign(Line3.prototype,{set:function(e,a){return this.start.copy(e),this.end.copy(a),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return void 0===e&&(console.warn("Line3: .getCenter() target is now required"),e=new Vector3),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return void 0===e&&(console.warn("Line3: .delta() target is now required"),e=new Vector3),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,a){return void 0===a&&(console.warn("Line3: .at() target is now required"),a=new Vector3),this.delta(a).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(e,a){_startP.subVectors(e,this.start),_startEnd.subVectors(this.end,this.start);var d=_startEnd.dot(_startEnd),g=_startEnd.dot(_startP)/d;return a&&(g=MathUtils.clamp(g,0,1)),g},closestPointToPoint:function(e,a,d){var v=this.closestPointToPointParameter(e,a);return void 0===d&&(console.warn("Line3: .closestPointToPoint() target is now required"),d=new Vector3),this.delta(d).multiplyScalar(v).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}});var ConvexHull=function(){var _,x,b,a=new Vector3;function d(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new w,this.unassigned=new w,this.vertices=[]}function v(){this.normal=new Vector3,this.midpoint=new Vector3,this.area=0,this.constant=0,this.outside=null,this.mark=0,this.edge=null}function g(_,x){this.vertex=_,this.prev=null,this.next=null,this.twin=null,this.face=x}function C(_){this.point=_,this.prev=null,this.next=null,this.face=null}function w(){this.head=null,this.tail=null}return Object.assign(d.prototype,{setFromPoints:function(x){!0!==Array.isArray(x)&&console.error("ConvexHull: Points parameter is not an array."),x.length<4&&console.error("ConvexHull: The algorithm needs at least four points."),this.makeEmpty();for(var b=0,A=x.length;b<A;b++)this.vertices.push(new C(x[b]));return this.compute(),this},setFromObject:function(x){var b=[];return x.updateMatrixWorld(!0),x.traverse(function(A){var E,R,O,D=A.geometry;if(void 0!==D)if(D.isGeometry){var F=D.vertices;for(E=0,R=F.length;E<R;E++)(O=F[E].clone()).applyMatrix4(A.matrixWorld),b.push(O)}else if(D.isBufferGeometry){var L=D.attributes.position;if(void 0!==L)for(E=0,R=L.count;E<R;E++)(O=new Vector3).fromBufferAttribute(L,E).applyMatrix4(A.matrixWorld),b.push(O)}}),this.setFromPoints(b)},containsPoint:function(x){for(var b=this.faces,A=0,E=b.length;A<E;A++)if(b[A].distanceToPoint(x)>this.tolerance)return!1;return!0},intersectRay:function(x,b){for(var A=this.faces,E=-1/0,R=1/0,O=0,D=A.length;O<D;O++){var F=A[O],L=F.distanceToPoint(x.origin),I=F.normal.dot(x.direction);if(L>0&&I>=0)return null;var V=0!==I?-L/I:0;if(!(V<=0)&&(I>0?R=Math.min(V,R):E=Math.max(V,E),E>R))return null}return x.at(E!==-1/0?E:R,b),b},intersectsRay:function(x){return null!==this.intersectRay(x,a)},makeEmpty:function(){return this.faces=[],this.vertices=[],this},addVertexToFace:function(x,b){return x.face=b,null===b.outside?this.assigned.append(x):this.assigned.insertBefore(b.outside,x),b.outside=x,this},removeVertexFromFace:function(x,b){return x===b.outside&&(b.outside=null!==x.next&&x.next.face===b?x.next:null),this.assigned.remove(x),this},removeAllVerticesFromFace:function(x){if(null!==x.outside){for(var b=x.outside,A=x.outside;null!==A.next&&A.next.face===x;)A=A.next;return this.assigned.removeSubList(b,A),b.prev=A.next=null,x.outside=null,b}},deleteFaceVertices:function(x,b){var A=this.removeAllVerticesFromFace(x);if(void 0!==A)if(void 0===b)this.unassigned.appendChain(A);else{var E=A;do{var R=E.next;b.distanceToPoint(E.point)>this.tolerance?this.addVertexToFace(E,b):this.unassigned.append(E),E=R}while(null!==E)}return this},resolveUnassignedPoints:function(x){if(!1===this.unassigned.isEmpty()){var b=this.unassigned.first();do{for(var A=b.next,E=this.tolerance,R=null,O=0;O<x.length;O++){var D=x[O];if(0===D.mark){var F=D.distanceToPoint(b.point);if(F>E&&(E=F,R=D),E>1e3*this.tolerance)break}}null!==R&&this.addVertexToFace(b,R),b=A}while(null!==b)}return this},computeExtremes:function(){var R,O,D,x=new Vector3,b=new Vector3,A=[],E=[];for(R=0;R<3;R++)A[R]=E[R]=this.vertices[0];for(x.copy(this.vertices[0].point),b.copy(this.vertices[0].point),R=0,O=this.vertices.length;R<O;R++){var F=this.vertices[R],L=F.point;for(D=0;D<3;D++)L.getComponent(D)<x.getComponent(D)&&(x.setComponent(D,L.getComponent(D)),A[D]=F);for(D=0;D<3;D++)L.getComponent(D)>b.getComponent(D)&&(b.setComponent(D,L.getComponent(D)),E[D]=F)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(x.x),Math.abs(b.x))+Math.max(Math.abs(x.y),Math.abs(b.y))+Math.max(Math.abs(x.z),Math.abs(b.z))),{min:A,max:E}},computeInitialHull:function(){void 0===_&&(_=new Line3,x=new Plane,b=new Vector3);var E,L,I,V,z,H,X,re,j,R=this.vertices,O=this.computeExtremes(),D=O.min,F=O.max,te=0,J=0;for(H=0;H<3;H++)(j=F[H].point.getComponent(H)-D[H].point.getComponent(H))>te&&(te=j,J=H);for(te=0,_.set((L=D[J]).point,(I=F[J]).point),H=0,X=this.vertices.length;H<X;H++)(E=R[H])!==L&&E!==I&&(_.closestPointToPoint(E.point,!0,b),(j=b.distanceToSquared(E.point))>te&&(te=j,V=E));for(te=-1,x.setFromCoplanarPoints(L.point,I.point,V.point),H=0,X=this.vertices.length;H<X;H++)(E=R[H])!==L&&E!==I&&E!==V&&(j=Math.abs(x.distanceToPoint(E.point)))>te&&(te=j,z=E);var k=[];if(x.distanceToPoint(z.point)<0)for(k.push(v.create(L,I,V),v.create(z,I,L),v.create(z,V,I),v.create(z,L,V)),H=0;H<3;H++)re=(H+1)%3,k[H+1].getEdge(2).setTwin(k[0].getEdge(re)),k[H+1].getEdge(1).setTwin(k[re+1].getEdge(0));else for(k.push(v.create(L,V,I),v.create(z,L,I),v.create(z,I,V),v.create(z,V,L)),H=0;H<3;H++)re=(H+1)%3,k[H+1].getEdge(2).setTwin(k[0].getEdge((3-H)%3)),k[H+1].getEdge(0).setTwin(k[re+1].getEdge(1));for(H=0;H<4;H++)this.faces.push(k[H]);for(H=0,X=R.length;H<X;H++)if((E=R[H])!==L&&E!==I&&E!==V&&E!==z){te=this.tolerance;var U=null;for(re=0;re<4;re++)(j=this.faces[re].distanceToPoint(E.point))>te&&(te=j,U=this.faces[re]);null!==U&&this.addVertexToFace(E,U)}return this},reindexFaces:function(){for(var x=[],b=0;b<this.faces.length;b++){var A=this.faces[b];0===A.mark&&x.push(A)}return this.faces=x,this},nextVertexToAdd:function(){if(!1===this.assigned.isEmpty()){var x,b=0,A=this.assigned.first().face,E=A.outside;do{var R=A.distanceToPoint(E.point);R>b&&(b=R,x=E),E=E.next}while(null!==E&&E.face===A);return x}},computeHorizon:function(x,b,A,E){var R;this.deleteFaceVertices(A),A.mark=1,R=null===b?b=A.getEdge(0):b.next;do{var O=R.twin,D=O.face;0===D.mark&&(D.distanceToPoint(x)>this.tolerance?this.computeHorizon(x,O,D,E):E.push(R)),R=R.next}while(R!==b);return this},addAdjoiningFace:function(x,b){var A=v.create(x,b.tail(),b.head());return this.faces.push(A),A.getEdge(-1).setTwin(b.twin),A.getEdge(0)},addNewFaces:function(x,b){this.newFaces=[];for(var A=null,E=null,R=0;R<b.length;R++){var D=this.addAdjoiningFace(x,b[R]);null===A?A=D:D.next.setTwin(E),this.newFaces.push(D.face),E=D}return A.next.setTwin(E),this},addVertexToHull:function(x){var b=[];return this.unassigned.clear(),this.removeVertexFromFace(x,x.face),this.computeHorizon(x.point,null,x.face,b),this.addNewFaces(x,b),this.resolveUnassignedPoints(this.newFaces),this},cleanup:function(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this},compute:function(){var x;for(this.computeInitialHull();void 0!==(x=this.nextVertexToAdd());)this.addVertexToHull(x);return this.reindexFaces(),this.cleanup(),this}}),Object.assign(v,{create:function(x,b,A){var E=new v,R=new g(x,E),O=new g(b,E),D=new g(A,E);return R.next=D.prev=O,O.next=R.prev=D,D.next=O.prev=R,E.edge=R,E.compute()}}),Object.assign(v.prototype,{getEdge:function(x){for(var b=this.edge;x>0;)b=b.next,x--;for(;x<0;)b=b.prev,x++;return b},compute:function(){var _;return function(){void 0===_&&(_=new Triangle);var b=this.edge.tail(),A=this.edge.head(),E=this.edge.next.head();return _.set(b.point,A.point,E.point),_.getNormal(this.normal),_.getMidpoint(this.midpoint),this.area=_.getArea(),this.constant=this.normal.dot(this.midpoint),this}}(),distanceToPoint:function(x){return this.normal.dot(x)-this.constant}}),Object.assign(g.prototype,{head:function(){return this.vertex},tail:function(){return this.prev?this.prev.vertex:null},length:function(){var x=this.head(),b=this.tail();return null!==b?b.point.distanceTo(x.point):-1},lengthSquared:function(){var x=this.head(),b=this.tail();return null!==b?b.point.distanceToSquared(x.point):-1},setTwin:function(x){return this.twin=x,x.twin=this,this}}),Object.assign(w.prototype,{first:function(){return this.head},last:function(){return this.tail},clear:function(){return this.head=this.tail=null,this},insertBefore:function(x,b){return b.prev=x.prev,b.next=x,null===b.prev?this.head=b:b.prev.next=b,x.prev=b,this},insertAfter:function(x,b){return b.prev=x,b.next=x.next,null===b.next?this.tail=b:b.next.prev=b,x.next=b,this},append:function(x){return null===this.head?this.head=x:this.tail.next=x,x.prev=this.tail,x.next=null,this.tail=x,this},appendChain:function(x){for(null===this.head?this.head=x:this.tail.next=x,x.prev=this.tail;null!==x.next;)x=x.next;return this.tail=x,this},remove:function(x){return null===x.prev?this.head=x.next:x.prev.next=x.next,null===x.next?this.tail=x.prev:x.next.prev=x.prev,this},removeSubList:function(x,b){return null===x.prev?this.head=b.next:x.prev.next=b.next,null===b.next?this.tail=x.prev:b.next.prev=x.prev,this},isEmpty:function(){return null===this.head}}),d}(),ConvexGeometry=function(e){Geometry.call(this),this.fromBufferGeometry(new ConvexBufferGeometry(e)),this.mergeVertices()};ConvexGeometry.prototype=Object.create(Geometry.prototype),ConvexGeometry.prototype.constructor=ConvexGeometry;var ConvexBufferGeometry=function(e){BufferGeometry.call(this);var a=[],d=[];void 0===ConvexHull&&console.error("ConvexBufferGeometry: ConvexBufferGeometry relies on ConvexHull");for(var g=(new ConvexHull).setFromPoints(e).faces,C=0;C<g.length;C++){var w=g[C],_=w.edge;do{var x=_.head().point;a.push(x.x,x.y,x.z),d.push(w.normal.x,w.normal.y,w.normal.z),_=_.next}while(_!==w.edge)}this.setAttribute("position",new Float32BufferAttribute(a,3)),this.setAttribute("normal",new Float32BufferAttribute(d,3))};ConvexBufferGeometry.prototype=Object.create(BufferGeometry.prototype),ConvexBufferGeometry.prototype.constructor=ConvexBufferGeometry;var DecalGeometry=function(e,a,d,v){BufferGeometry.call(this);var g=[],C=[],w=[],_=new Vector3,x=new Matrix4;x.makeRotationFromEuler(d),x.setPosition(a);var b=(new Matrix4).getInverse(x);function E(D,F,L){F.applyMatrix4(e.matrixWorld),F.applyMatrix4(b),L.transformDirection(e.matrixWorld),D.push(new DecalVertex(F.clone(),L.clone()))}function R(D,F){for(var L=[],I=.5*Math.abs(v.dot(F)),V=0;V<D.length;V+=3){var z,H,X,j,te,J,k;switch(((z=D[V+0].position.dot(F)-I>0)?1:0)+((H=D[V+1].position.dot(F)-I>0)?1:0)+((X=D[V+2].position.dot(F)-I>0)?1:0)){case 0:L.push(D[V]),L.push(D[V+1]),L.push(D[V+2]);break;case 1:if(z&&(te=D[V+2],J=O(D[V],j=D[V+1],F,I),k=O(D[V],te,F,I)),H){te=D[V+2],J=O(D[V+1],j=D[V],F,I),k=O(D[V+1],te,F,I),L.push(J),L.push(te.clone()),L.push(j.clone()),L.push(te.clone()),L.push(J.clone()),L.push(k);break}X&&(te=D[V+1],J=O(D[V+2],j=D[V],F,I),k=O(D[V+2],te,F,I)),L.push(j.clone()),L.push(te.clone()),L.push(J),L.push(k),L.push(J.clone()),L.push(te.clone());break;case 2:z||(te=O(j=D[V].clone(),D[V+1],F,I),J=O(j,D[V+2],F,I),L.push(j),L.push(te),L.push(J)),H||(te=O(j=D[V+1].clone(),D[V+2],F,I),J=O(j,D[V],F,I),L.push(j),L.push(te),L.push(J)),X||(te=O(j=D[V+2].clone(),D[V],F,I),J=O(j,D[V+1],F,I),L.push(j),L.push(te),L.push(J))}}return L}function O(D,F,L,I){var V=D.position.dot(L)-I,H=V/(V-(F.position.dot(L)-I));return new DecalVertex(new Vector3(D.position.x+H*(F.position.x-D.position.x),D.position.y+H*(F.position.y-D.position.y),D.position.z+H*(F.position.z-D.position.z)),new Vector3(D.normal.x+H*(F.normal.x-D.normal.x),D.normal.y+H*(F.normal.y-D.normal.y),D.normal.z+H*(F.normal.z-D.normal.z)))}(function(){var D,F=new BufferGeometry,L=[],I=new Vector3,V=new Vector3;e.geometry.isGeometry?F.fromGeometry(e.geometry):F.copy(e.geometry);var z=F.attributes.position,H=F.attributes.normal;if(null!==F.index){var X=F.index;for(D=0;D<X.count;D++)I.fromBufferAttribute(z,X.getX(D)),V.fromBufferAttribute(H,X.getX(D)),E(L,I,V)}else for(D=0;D<z.count;D++)I.fromBufferAttribute(z,D),V.fromBufferAttribute(H,D),E(L,I,V);for(L=R(L,_.set(1,0,0)),L=R(L,_.set(-1,0,0)),L=R(L,_.set(0,1,0)),L=R(L,_.set(0,-1,0)),L=R(L,_.set(0,0,1)),L=R(L,_.set(0,0,-1)),D=0;D<L.length;D++){var re=L[D];w.push(.5+re.position.x/v.x,.5+re.position.y/v.y),re.position.applyMatrix4(x),g.push(re.position.x,re.position.y,re.position.z),C.push(re.normal.x,re.normal.y,re.normal.z)}})(),this.setAttribute("position",new Float32BufferAttribute(g,3)),this.setAttribute("normal",new Float32BufferAttribute(C,3)),this.setAttribute("uv",new Float32BufferAttribute(w,2))};DecalGeometry.prototype=Object.create(BufferGeometry.prototype),DecalGeometry.prototype.constructor=DecalGeometry;var DecalVertex=function(e,a){this.position=e,this.normal=a};DecalVertex.prototype.clone=function(){return new this.constructor(this.position.clone(),this.normal.clone())};var SimplexNoise=function(e){null==e&&(e=Math),this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(var a=0;a<256;a++)this.p[a]=Math.floor(256*e.random());for(this.perm=[],a=0;a<512;a++)this.perm[a]=this.p[255&a];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]};SimplexNoise.prototype.dot=function(s,e,a){return s[0]*e+s[1]*a},SimplexNoise.prototype.dot3=function(s,e,a,d){return s[0]*e+s[1]*a+s[2]*d},SimplexNoise.prototype.dot4=function(s,e,a,d,v){return s[0]*e+s[1]*a+s[2]*d+s[3]*v},SimplexNoise.prototype.noise=function(s,e){var D,F,C=(s+e)*(.5*(Math.sqrt(3)-1)),w=Math.floor(s+C),_=Math.floor(e+C),x=(3-Math.sqrt(3))/6,b=(w+_)*x,R=s-(w-b),O=e-(_-b);R>O?(D=1,F=0):(D=0,F=1);var L=R-D+x,I=O-F+x,V=R-1+2*x,z=O-1+2*x,H=255&w,X=255&_,j=this.perm[H+D+this.perm[X+F]]%12,te=this.perm[H+1+this.perm[X+1]]%12,J=.5-R*R-O*O,k=.5-L*L-I*I,U=.5-V*V-z*z;return 70*((J<0?0:(J*=J)*J*this.dot(this.grad3[this.perm[H+this.perm[X]]%12],R,O))+(k<0?0:(k*=k)*k*this.dot(this.grad3[j],L,I))+(U<0?0:(U*=U)*U*this.dot(this.grad3[te],V,z)))},SimplexNoise.prototype.noise3d=function(s,e,a){var z,H,X,re,j,te,_=(s+e+a)*(1/3),x=Math.floor(s+_),b=Math.floor(e+_),A=Math.floor(a+_),E=1/6,R=(x+b+A)*E,L=s-(x-R),I=e-(b-R),V=a-(A-R);L>=I?I>=V?(z=1,H=0,X=0,re=1,j=1,te=0):L>=V?(z=1,H=0,X=0,re=1,j=0,te=1):(z=0,H=0,X=1,re=1,j=0,te=1):I<V?(z=0,H=0,X=1,re=0,j=1,te=1):L<V?(z=0,H=1,X=0,re=0,j=1,te=1):(z=0,H=1,X=0,re=1,j=1,te=0);var J=L-z+E,k=I-H+E,U=V-X+E,K=L-re+2*E,ee=I-j+2*E,Q=V-te+2*E,oe=L-1+.5,me=I-1+.5,fe=V-1+.5,ge=255&x,$=255&b,ue=255&A,Z=this.perm[ge+z+this.perm[$+H+this.perm[ue+X]]]%12,se=this.perm[ge+re+this.perm[$+j+this.perm[ue+te]]]%12,ve=this.perm[ge+1+this.perm[$+1+this.perm[ue+1]]]%12,le=.6-L*L-I*I-V*V,_e=.6-J*J-k*k-U*U,ae=.6-K*K-ee*ee-Q*Q,pe=.6-oe*oe-me*me-fe*fe;return 32*((le<0?0:(le*=le)*le*this.dot3(this.grad3[this.perm[ge+this.perm[$+this.perm[ue]]]%12],L,I,V))+(_e<0?0:(_e*=_e)*_e*this.dot3(this.grad3[Z],J,k,U))+(ae<0?0:(ae*=ae)*ae*this.dot3(this.grad3[se],K,ee,Q))+(pe<0?0:(pe*=pe)*pe*this.dot3(this.grad3[ve],oe,me,fe)))},SimplexNoise.prototype.noise4d=function(s,e,a,d){var ge,$,ue,Y,Z,se,ve,le,_e,ae,pe,he,v=this.grad4,g=this.simplex,C=this.perm,w=(Math.sqrt(5)-1)/4,_=(5-Math.sqrt(5))/20,O=(s+e+a+d)*w,D=Math.floor(s+O),F=Math.floor(e+O),L=Math.floor(a+O),I=Math.floor(d+O),V=(D+F+L+I)*_,j=s-(D-V),te=e-(F-V),J=a-(L-V),k=d-(I-V),fe=(j>te?32:0)+(j>J?16:0)+(te>J?8:0)+(j>k?4:0)+(te>k?2:0)+(J>k?1:0),ce=j-(ge=g[fe][0]>=3?1:0)+_,Te=te-($=g[fe][1]>=3?1:0)+_,be=J-(ue=g[fe][2]>=3?1:0)+_,xe=k-(Y=g[fe][3]>=3?1:0)+_,we=j-(Z=g[fe][0]>=2?1:0)+2*_,Ne=te-(se=g[fe][1]>=2?1:0)+2*_,Re=J-(ve=g[fe][2]>=2?1:0)+2*_,De=k-(le=g[fe][3]>=2?1:0)+2*_,Je=j-(_e=g[fe][0]>=1?1:0)+3*_,$e=te-(ae=g[fe][1]>=1?1:0)+3*_,pt=J-(pe=g[fe][2]>=1?1:0)+3*_,ut=k-(he=g[fe][3]>=1?1:0)+3*_,at=j-1+4*_,Xe=te-1+4*_,Ke=J-1+4*_,lt=k-1+4*_,ot=255&D,St=255&F,ft=255&L,He=255&I,vt=C[ot+ge+C[St+$+C[ft+ue+C[He+Y]]]]%32,Gt=C[ot+Z+C[St+se+C[ft+ve+C[He+le]]]]%32,Lt=C[ot+_e+C[St+ae+C[ft+pe+C[He+he]]]]%32,yt=C[ot+1+C[St+1+C[ft+1+C[He+1]]]]%32,xr=.6-j*j-te*te-J*J-k*k,Dr=.6-ce*ce-Te*Te-be*be-xe*xe,Ur=.6-we*we-Ne*Ne-Re*Re-De*De,qr=.6-Je*Je-$e*$e-pt*pt-ut*ut,Ar=.6-at*at-Xe*Xe-Ke*Ke-lt*lt;return 27*((xr<0?0:(xr*=xr)*xr*this.dot4(v[C[ot+C[St+C[ft+C[He]]]]%32],j,te,J,k))+(Dr<0?0:(Dr*=Dr)*Dr*this.dot4(v[vt],ce,Te,be,xe))+(Ur<0?0:(Ur*=Ur)*Ur*this.dot4(v[Gt],we,Ne,Re,De))+(qr<0?0:(qr*=qr)*qr*this.dot4(v[Lt],Je,$e,pt,ut))+(Ar<0?0:(Ar*=Ar)*Ar*this.dot4(v[yt],at,Xe,Ke,lt)))};var LightningStrike=function s(e){BufferGeometry.call(this),this.type="LightningStrike",this.init(s.copyParameters(e=e||{},e)),this.createMesh()};LightningStrike.prototype=Object.create(BufferGeometry.prototype),LightningStrike.prototype.constructor=LightningStrike,LightningStrike.prototype.isLightningStrike=!0,LightningStrike.RAY_INITIALIZED=0,LightningStrike.RAY_UNBORN=1,LightningStrike.RAY_PROPAGATING=2,LightningStrike.RAY_STEADY=3,LightningStrike.RAY_VANISHING=4,LightningStrike.RAY_EXTINGUISHED=5,LightningStrike.COS30DEG=Math.cos(30*Math.PI/180),LightningStrike.SIN30DEG=Math.sin(30*Math.PI/180),LightningStrike.createRandomGenerator=function(){for(var s=2053,e=[],a=0;a<s;a++)e.push(Math.random());var d={currentSeed:0,random:function(){var g=e[d.currentSeed];return d.currentSeed=(d.currentSeed+1)%s,g},getSeed:function(){return d.currentSeed/s},setSeed:function(g){d.currentSeed=Math.floor(g*s)%s}};return d},LightningStrike.copyParameters=function(s,e){var a=function(v){return e===s?v:v.clone()};return(s=s||{}).sourceOffset=void 0!==(e=e||{}).sourceOffset?a(e.sourceOffset):new Vector3(0,100,0),s.destOffset=void 0!==e.destOffset?a(e.destOffset):new Vector3(0,0,0),s.timeScale=void 0!==e.timeScale?e.timeScale:1,s.roughness=void 0!==e.roughness?e.roughness:.9,s.straightness=void 0!==e.straightness?e.straightness:.7,s.up0=void 0!==e.up0?a(e.up0):new Vector3(0,0,1),s.up1=void 0!==e.up1?a(e.up1):new Vector3(0,0,1),s.radius0=void 0!==e.radius0?e.radius0:1,s.radius1=void 0!==e.radius1?e.radius1:1,s.radius0Factor=void 0!==e.radius0Factor?e.radius0Factor:.5,s.radius1Factor=void 0!==e.radius1Factor?e.radius1Factor:.2,s.minRadius=void 0!==e.minRadius?e.minRadius:.2,s.isEternal=void 0!==e.isEternal?e.isEternal:void 0===e.birthTime||void 0===e.deathTime,s.birthTime=e.birthTime,s.deathTime=e.deathTime,s.propagationTimeFactor=void 0!==e.propagationTimeFactor?e.propagationTimeFactor:.1,s.vanishingTimeFactor=void 0!==e.vanishingTimeFactor?e.vanishingTimeFactor:.9,s.subrayPeriod=void 0!==e.subrayPeriod?e.subrayPeriod:4,s.subrayDutyCycle=void 0!==e.subrayDutyCycle?e.subrayDutyCycle:.6,s.maxIterations=void 0!==e.maxIterations?e.maxIterations:9,s.isStatic=void 0!==e.isStatic&&e.isStatic,s.ramification=void 0!==e.ramification?e.ramification:5,s.maxSubrayRecursion=void 0!==e.maxSubrayRecursion?e.maxSubrayRecursion:3,s.recursionProbability=void 0!==e.recursionProbability?e.recursionProbability:.6,s.generateUVs=void 0!==e.generateUVs&&e.generateUVs,s.randomGenerator=e.randomGenerator,s.noiseSeed=e.noiseSeed,s.onDecideSubrayCreation=e.onDecideSubrayCreation,s.onSubrayCreation=e.onSubrayCreation,s},LightningStrike.prototype.update=function(s){this.isStatic||(this.rayParameters.isEternal||this.rayParameters.birthTime<=s&&s<=this.rayParameters.deathTime?(this.updateMesh(s),this.state=s<this.subrays[0].endPropagationTime?LightningStrike.RAY_PROPAGATING:s>this.subrays[0].beginVanishingTime?LightningStrike.RAY_VANISHING:LightningStrike.RAY_STEADY,this.visible=!0):(this.visible=!1,this.state=s<this.rayParameters.birthTime?LightningStrike.RAY_UNBORN:LightningStrike.RAY_EXTINGUISHED))},LightningStrike.prototype.init=function(s){this.rayParameters=s,this.maxIterations=void 0!==s.maxIterations?Math.floor(s.maxIterations):9,s.maxIterations=this.maxIterations,this.isStatic=void 0!==s.isStatic&&s.isStatic,s.isStatic=this.isStatic,this.ramification=void 0!==s.ramification?Math.floor(s.ramification):5,s.ramification=this.ramification,this.maxSubrayRecursion=void 0!==s.maxSubrayRecursion?Math.floor(s.maxSubrayRecursion):3,s.maxSubrayRecursion=this.maxSubrayRecursion,this.recursionProbability=void 0!==s.recursionProbability?s.recursionProbability:.6,s.recursionProbability=this.recursionProbability,this.generateUVs=void 0!==s.generateUVs&&s.generateUVs,s.generateUVs=this.generateUVs,void 0!==s.randomGenerator?(this.randomGenerator=s.randomGenerator,this.seedGenerator=s.randomGenerator,void 0!==s.noiseSeed&&this.seedGenerator.setSeed(s.noiseSeed)):(this.randomGenerator=LightningStrike.createRandomGenerator(),this.seedGenerator=Math),void 0!==s.onDecideSubrayCreation?this.onDecideSubrayCreation=s.onDecideSubrayCreation:(this.createDefaultSubrayCreationCallbacks(),void 0!==s.onSubrayCreation&&(this.onSubrayCreation=s.onSubrayCreation)),this.state=LightningStrike.RAY_INITIALIZED,this.maxSubrays=Math.ceil(1+Math.pow(this.ramification,Math.max(0,this.maxSubrayRecursion-1))),s.maxSubrays=this.maxSubrays,this.maxRaySegments=2*(1<<this.maxIterations),this.subrays=[];for(var e=0;e<this.maxSubrays;e++)this.subrays.push(this.createSubray());for(this.raySegments=[],e=0;e<this.maxRaySegments;e++)this.raySegments.push(this.createSegment());this.time=0,this.timeFraction=0,this.currentSegmentCallback=null,this.currentCreateTriangleVertices=this.generateUVs?this.createTriangleVerticesWithUVs:this.createTriangleVerticesWithoutUVs,this.numSubrays=0,this.currentSubray=null,this.currentSegmentIndex=0,this.isInitialSegment=!1,this.subrayProbability=0,this.currentVertex=0,this.currentIndex=0,this.currentCoordinate=0,this.currentUVCoordinate=0,this.vertices=null,this.uvs=null,this.indices=null,this.positionAttribute=null,this.uvsAttribute=null,this.simplexX=new SimplexNoise(this.seedGenerator),this.simplexY=new SimplexNoise(this.seedGenerator),this.simplexZ=new SimplexNoise(this.seedGenerator),this.forwards=new Vector3,this.forwardsFill=new Vector3,this.side=new Vector3,this.down=new Vector3,this.middlePos=new Vector3,this.middleLinPos=new Vector3,this.newPos=new Vector3,this.vPos=new Vector3,this.cross1=new Vector3},LightningStrike.prototype.createMesh=function(){var s=1<<this.maxIterations,e=3*(s+1)*this.maxSubrays,a=18*s*this.maxSubrays;this.vertices=new Float32Array(3*e),this.indices=new Uint32Array(a),this.generateUVs&&(this.uvs=new Float32Array(2*e)),this.fillMesh(0),this.setIndex(new Uint32BufferAttribute(this.indices,1)),this.positionAttribute=new Float32BufferAttribute(this.vertices,3),this.setAttribute("position",this.positionAttribute),this.generateUVs&&(this.uvsAttribute=new Float32BufferAttribute(new Float32Array(this.uvs),2),this.setAttribute("uv",this.uvsAttribute)),this.isStatic||(this.index.usage=DynamicDrawUsage,this.positionAttribute.usage=DynamicDrawUsage,this.generateUVs&&(this.uvsAttribute.usage=DynamicDrawUsage)),this.vertices=this.positionAttribute.array,this.indices=this.index.array,this.generateUVs&&(this.uvs=this.uvsAttribute.array)},LightningStrike.prototype.updateMesh=function(s){this.fillMesh(s),this.drawRange.count=this.currentIndex,this.index.needsUpdate=!0,this.positionAttribute.needsUpdate=!0,this.generateUVs&&(this.uvsAttribute.needsUpdate=!0)},LightningStrike.prototype.fillMesh=function(s){var e=this;this.currentVertex=0,this.currentIndex=0,this.currentCoordinate=0,this.currentUVCoordinate=0,this.fractalRay(s,function(d){var v=e.currentSubray;s<v.birthTime||(this.rayParameters.isEternal&&0==e.currentSubray.recursion?(e.createPrism(d),e.onDecideSubrayCreation(d,e)):s<v.endPropagationTime?e.timeFraction>=d.fraction0*v.propagationTimeFactor&&(e.createPrism(d),e.onDecideSubrayCreation(d,e)):s<v.beginVanishingTime?(e.createPrism(d),e.onDecideSubrayCreation(d,e)):(e.timeFraction<=v.vanishingTimeFactor+d.fraction1*(1-v.vanishingTimeFactor)&&e.createPrism(d),e.onDecideSubrayCreation(d,e)))})},LightningStrike.prototype.addNewSubray=function(){return this.subrays[this.numSubrays++]},LightningStrike.prototype.initSubray=function(s,e){s.pos0.copy(e.sourceOffset),s.pos1.copy(e.destOffset),s.up0.copy(e.up0),s.up1.copy(e.up1),s.radius0=e.radius0,s.radius1=e.radius1,s.birthTime=e.birthTime,s.deathTime=e.deathTime,s.timeScale=e.timeScale,s.roughness=e.roughness,s.straightness=e.straightness,s.propagationTimeFactor=e.propagationTimeFactor,s.vanishingTimeFactor=e.vanishingTimeFactor,s.maxIterations=this.maxIterations,s.seed=void 0!==e.noiseSeed?e.noiseSeed:0,s.recursion=0},LightningStrike.prototype.fractalRay=function(s,e){this.time=s,this.currentSegmentCallback=e,this.numSubrays=0,this.initSubray(this.addNewSubray(),this.rayParameters);for(var a=0;a<this.numSubrays;a++){var d=this.subrays[a];this.currentSubray=d,this.randomGenerator.setSeed(d.seed),d.endPropagationTime=MathUtils.lerp(d.birthTime,d.deathTime,d.propagationTimeFactor),d.beginVanishingTime=MathUtils.lerp(d.deathTime,d.birthTime,1-d.vanishingTimeFactor);var v=this.randomGenerator.random;d.linPos0.set(v(),v(),v()).multiplyScalar(1e3),d.linPos1.set(v(),v(),v()).multiplyScalar(1e3),this.timeFraction=(s-d.birthTime)/(d.deathTime-d.birthTime),this.currentSegmentIndex=0,this.isInitialSegment=!0;var g=this.getNewSegment();g.iteration=0,g.pos0.copy(d.pos0),g.pos1.copy(d.pos1),g.linPos0.copy(d.linPos0),g.linPos1.copy(d.linPos1),g.up0.copy(d.up0),g.up1.copy(d.up1),g.radius0=d.radius0,g.radius1=d.radius1,g.fraction0=0,g.fraction1=1,g.positionVariationFactor=1-d.straightness,this.subrayProbability=this.ramification*Math.pow(this.recursionProbability,d.recursion)/(1<<d.maxIterations),this.fractalRayRecursive(g)}this.currentSegmentCallback=null,this.currentSubray=null},LightningStrike.prototype.fractalRayRecursive=function(s){if(s.iteration>=this.currentSubray.maxIterations)this.currentSegmentCallback(s);else{this.forwards.subVectors(s.pos1,s.pos0);var e=this.forwards.length();e<1e-6&&(this.forwards.set(0,0,.01),e=this.forwards.length());var a=.5*(s.radius0+s.radius1),d=.5*(s.fraction0+s.fraction1),v=this.time*this.currentSubray.timeScale*Math.pow(2,s.iteration);this.middlePos.lerpVectors(s.pos0,s.pos1,.5),this.middleLinPos.lerpVectors(s.linPos0,s.linPos1,.5);var g=this.middleLinPos;this.newPos.set(this.simplexX.noise4d(g.x,g.y,g.z,v),this.simplexY.noise4d(g.x,g.y,g.z,v),this.simplexZ.noise4d(g.x,g.y,g.z,v)),this.newPos.multiplyScalar(s.positionVariationFactor*e),this.newPos.add(this.middlePos);var C=this.getNewSegment();C.pos0.copy(s.pos0),C.pos1.copy(this.newPos),C.linPos0.copy(s.linPos0),C.linPos1.copy(this.middleLinPos),C.up0.copy(s.up0),C.up1.copy(s.up1),C.radius0=s.radius0,C.radius1=a,C.fraction0=s.fraction0,C.fraction1=d,C.positionVariationFactor=s.positionVariationFactor*this.currentSubray.roughness,C.iteration=s.iteration+1;var w=this.getNewSegment();w.pos0.copy(this.newPos),w.pos1.copy(s.pos1),w.linPos0.copy(this.middleLinPos),w.linPos1.copy(s.linPos1),this.cross1.crossVectors(s.up0,this.forwards.normalize()),w.up0.crossVectors(this.forwards,this.cross1).normalize(),w.up1.copy(s.up1),w.radius0=a,w.radius1=s.radius1,w.fraction0=d,w.fraction1=s.fraction1,w.positionVariationFactor=s.positionVariationFactor*this.currentSubray.roughness,w.iteration=s.iteration+1,this.fractalRayRecursive(C),this.fractalRayRecursive(w)}},LightningStrike.prototype.createPrism=function(s){this.forwardsFill.subVectors(s.pos1,s.pos0).normalize(),this.isInitialSegment&&(this.currentCreateTriangleVertices(s.pos0,s.up0,this.forwardsFill,s.radius0,0),this.isInitialSegment=!1),this.currentCreateTriangleVertices(s.pos1,s.up0,this.forwardsFill,s.radius1,s.fraction1),this.createPrismFaces()},LightningStrike.prototype.createTriangleVerticesWithoutUVs=function(s,e,a,d){this.side.crossVectors(e,a).multiplyScalar(d*LightningStrike.COS30DEG),this.down.copy(e).multiplyScalar(-d*LightningStrike.SIN30DEG);var v=this.vPos,g=this.vertices;v.copy(s).sub(this.side).add(this.down),g[this.currentCoordinate++]=v.x,g[this.currentCoordinate++]=v.y,g[this.currentCoordinate++]=v.z,v.copy(s).add(this.side).add(this.down),g[this.currentCoordinate++]=v.x,g[this.currentCoordinate++]=v.y,g[this.currentCoordinate++]=v.z,v.copy(e).multiplyScalar(d).add(s),g[this.currentCoordinate++]=v.x,g[this.currentCoordinate++]=v.y,g[this.currentCoordinate++]=v.z,this.currentVertex+=3},LightningStrike.prototype.createTriangleVerticesWithUVs=function(s,e,a,d,v){this.side.crossVectors(e,a).multiplyScalar(d*LightningStrike.COS30DEG),this.down.copy(e).multiplyScalar(-d*LightningStrike.SIN30DEG);var g=this.vPos,C=this.vertices,w=this.uvs;g.copy(s).sub(this.side).add(this.down),C[this.currentCoordinate++]=g.x,C[this.currentCoordinate++]=g.y,C[this.currentCoordinate++]=g.z,w[this.currentUVCoordinate++]=v,w[this.currentUVCoordinate++]=0,g.copy(s).add(this.side).add(this.down),C[this.currentCoordinate++]=g.x,C[this.currentCoordinate++]=g.y,C[this.currentCoordinate++]=g.z,w[this.currentUVCoordinate++]=v,w[this.currentUVCoordinate++]=.5,g.copy(e).multiplyScalar(d).add(s),C[this.currentCoordinate++]=g.x,C[this.currentCoordinate++]=g.y,C[this.currentCoordinate++]=g.z,w[this.currentUVCoordinate++]=v,w[this.currentUVCoordinate++]=1,this.currentVertex+=3},LightningStrike.prototype.createPrismFaces=function(s){var e=this.indices;s=this.currentVertex-6,e[this.currentIndex++]=s+1,e[this.currentIndex++]=s+2,e[this.currentIndex++]=s+5,e[this.currentIndex++]=s+1,e[this.currentIndex++]=s+5,e[this.currentIndex++]=s+4,e[this.currentIndex++]=s+0,e[this.currentIndex++]=s+1,e[this.currentIndex++]=s+4,e[this.currentIndex++]=s+0,e[this.currentIndex++]=s+4,e[this.currentIndex++]=s+3,e[this.currentIndex++]=s+2,e[this.currentIndex++]=s+0,e[this.currentIndex++]=s+3,e[this.currentIndex++]=s+2,e[this.currentIndex++]=s+3,e[this.currentIndex++]=s+5},LightningStrike.prototype.createDefaultSubrayCreationCallbacks=function(){var s=this.randomGenerator.random;this.onDecideSubrayCreation=function(g,C){var w=C.currentSubray,_=C.rayParameters.subrayPeriod,x=C.rayParameters.subrayDutyCycle,b=C.rayParameters.isEternal&&0==w.recursion?-s()*_:MathUtils.lerp(w.birthTime,w.endPropagationTime,g.fraction0)-s()*_,A=C.time-b,E=Math.floor(A/_),R=s()*(E+1),D=0;if(A%_<=x*_&&(D=C.subrayProbability),w.recursion<C.maxSubrayRecursion&&C.numSubrays<C.maxSubrays&&s()<D){var F=C.addNewSubray(),L=C.randomGenerator.getSeed();F.seed=R,C.randomGenerator.setSeed(R),F.recursion=w.recursion+1,F.maxIterations=Math.max(1,w.maxIterations-1),F.linPos0.set(s(),s(),s()).multiplyScalar(1e3),F.linPos1.set(s(),s(),s()).multiplyScalar(1e3),F.up0.copy(w.up0),F.up1.copy(w.up1),F.radius0=g.radius0*C.rayParameters.radius0Factor,F.radius1=Math.min(C.rayParameters.minRadius,g.radius1*C.rayParameters.radius1Factor),F.birthTime=b+E*_,F.deathTime=F.birthTime+_*x,!C.rayParameters.isEternal&&0==w.recursion&&(F.birthTime=Math.max(F.birthTime,w.birthTime),F.deathTime=Math.min(F.deathTime,w.deathTime)),F.timeScale=2*w.timeScale,F.roughness=w.roughness,F.straightness=w.straightness,F.propagationTimeFactor=w.propagationTimeFactor,F.vanishingTimeFactor=w.vanishingTimeFactor,C.onSubrayCreation(g,w,F,C),C.randomGenerator.setSeed(L)}};var e=new Vector3,a=new Vector3,d=new Vector3,v=new Vector3;this.onSubrayCreation=function(g,C,w,_){_.subrayCylinderPosition(g,C,w,.5,.6,.2)},this.subrayConePosition=function(g,C,w,_,x,b){w.pos0.copy(g.pos0),e.subVectors(C.pos1,C.pos0),a.copy(e).normalize(),e.multiplyScalar(g.fraction0+(1-g.fraction0)*(s()*_));var A=e.length();d.crossVectors(C.up0,a);var E=2*Math.PI*s();d.multiplyScalar(Math.cos(E)),v.copy(C.up0).multiplyScalar(Math.sin(E)),w.pos1.copy(d).add(v).multiplyScalar(A*x*(b+s()*(1-b))).add(e).add(C.pos0)},this.subrayCylinderPosition=function(g,C,w,_,x,b){w.pos0.copy(g.pos0),e.subVectors(C.pos1,C.pos0),a.copy(e).normalize(),e.multiplyScalar(g.fraction0+(1-g.fraction0)*((2*s()-1)*_));var A=e.length();d.crossVectors(C.up0,a);var E=2*Math.PI*s();d.multiplyScalar(Math.cos(E)),v.copy(C.up0).multiplyScalar(Math.sin(E)),w.pos1.copy(d).add(v).multiplyScalar(A*x*(b+s()*(1-b))).add(e).add(C.pos0)}},LightningStrike.prototype.createSubray=function(){return{seed:0,maxIterations:0,recursion:0,pos0:new Vector3,pos1:new Vector3,linPos0:new Vector3,linPos1:new Vector3,up0:new Vector3,up1:new Vector3,radius0:0,radius1:0,birthTime:0,deathTime:0,timeScale:0,roughness:0,straightness:0,propagationTimeFactor:0,vanishingTimeFactor:0,endPropagationTime:0,beginVanishingTime:0}},LightningStrike.prototype.createSegment=function(){return{iteration:0,pos0:new Vector3,pos1:new Vector3,linPos0:new Vector3,linPos1:new Vector3,up0:new Vector3,up1:new Vector3,radius0:0,radius1:0,fraction0:0,fraction1:0,positionVariationFactor:0}},LightningStrike.prototype.getNewSegment=function(){return this.raySegments[this.currentSegmentIndex++]},LightningStrike.prototype.copy=function(s){return BufferGeometry.prototype.copy.call(this,s),this.init(LightningStrike.copyParameters({},s.rayParameters)),this},LightningStrike.prototype.clone=function(){return new this.constructor(LightningStrike.copyParameters({},this.rayParameters))};var _axis=new Vector3,_lineGeometry,_coneGeometry;function ArrowHelper(s,e,a,d,v,g){Object3D.call(this),void 0===s&&(s=new Vector3(0,0,1)),void 0===e&&(e=new Vector3(0,0,0)),void 0===a&&(a=1),void 0===d&&(d=16776960),void 0===v&&(v=.2*a),void 0===g&&(g=.2*v),void 0===_lineGeometry&&((_lineGeometry=new BufferGeometry).setAttribute("position",new Float32BufferAttribute([0,0,0,0,1,0],3)),(_coneGeometry=new CylinderBufferGeometry(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(e),this.line=new Line(_lineGeometry,new LineBasicMaterial({color:d})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Mesh(_coneGeometry,new MeshBasicMaterial({color:d})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(s),this.setLength(a,v,g)}function ParametricGeometry(s,e,a){Geometry.call(this),this.type="ParametricGeometry",this.parameters={func:s,slices:e,stacks:a},this.fromBufferGeometry(new ParametricBufferGeometry(s,e,a)),this.mergeVertices()}function ParametricBufferGeometry(s,e,a){BufferGeometry.call(this),this.type="ParametricBufferGeometry",this.parameters={func:s,slices:e,stacks:a};var R,O,d=[],v=[],g=[],C=[],w=1e-5,_=new Vector3,x=new Vector3,b=new Vector3,A=new Vector3,E=new Vector3;s.length<3&&console.error("ParametricGeometry: Function must now modify a Vector3 as third parameter.");var D=e+1;for(R=0;R<=a;R++){var F=R/a;for(O=0;O<=e;O++){var L=O/e;s(L,F,x),v.push(x.x,x.y,x.z),L-w>=0?(s(L-w,F,b),A.subVectors(x,b)):(s(L+w,F,b),A.subVectors(b,x)),F-w>=0?(s(L,F-w,b),E.subVectors(x,b)):(s(L,F+w,b),E.subVectors(b,x)),_.crossVectors(A,E).normalize(),g.push(_.x,_.y,_.z),C.push(L,F)}}for(R=0;R<a;R++)for(O=0;O<e;O++){var V=R*D+O+1,z=(R+1)*D+O+1,H=(R+1)*D+O;d.push(R*D+O,V,H),d.push(V,z,H)}this.setIndex(d),this.setAttribute("position",new Float32BufferAttribute(v,3)),this.setAttribute("normal",new Float32BufferAttribute(g,3)),this.setAttribute("uv",new Float32BufferAttribute(C,2))}ArrowHelper.prototype=Object.create(Object3D.prototype),ArrowHelper.prototype.constructor=ArrowHelper,ArrowHelper.prototype.setDirection=function(s){if(s.y>.99999)this.quaternion.set(0,0,0,1);else if(s.y<-.99999)this.quaternion.set(1,0,0,0);else{_axis.set(s.z,0,-s.x).normalize();var e=Math.acos(s.y);this.quaternion.setFromAxisAngle(_axis,e)}},ArrowHelper.prototype.setLength=function(s,e,a){void 0===e&&(e=.2*s),void 0===a&&(a=.2*e),this.line.scale.set(1,Math.max(1e-4,s-e),1),this.line.updateMatrix(),this.cone.scale.set(a,e,a),this.cone.position.y=s,this.cone.updateMatrix()},ArrowHelper.prototype.setColor=function(s){this.line.material.color.set(s),this.cone.material.color.set(s)},ArrowHelper.prototype.copy=function(s){return Object3D.prototype.copy.call(this,s,!1),this.line.copy(s.line),this.cone.copy(s.cone),this},ArrowHelper.prototype.clone=function(){return(new this.constructor).copy(this)},ParametricGeometry.prototype=Object.create(Geometry.prototype),ParametricGeometry.prototype.constructor=ParametricGeometry,ParametricBufferGeometry.prototype=Object.create(BufferGeometry.prototype),ParametricBufferGeometry.prototype.constructor=ParametricBufferGeometry;var ParametricGeometries={klein:function(e,a,d){var v,g,C;a*=Math.PI,e*=2*Math.PI,(a*=2)<Math.PI?(v=3*Math.cos(a)*(1+Math.sin(a))+2*(1-Math.cos(a)/2)*Math.cos(a)*Math.cos(e),C=-8*Math.sin(a)-2*(1-Math.cos(a)/2)*Math.sin(a)*Math.cos(e)):(v=3*Math.cos(a)*(1+Math.sin(a))+2*(1-Math.cos(a)/2)*Math.cos(e+Math.PI),C=-8*Math.sin(a)),g=-2*(1-Math.cos(a)/2)*Math.sin(e),d.set(v,g,C)},plane:function(e,a){return function(d,v,g){g.set(d*e,0,v*a)}},mobius:function(e,a,d){e-=.5;var g,C,w,v=2*Math.PI*a;g=Math.cos(v)*(2+e*Math.cos(v/2)),C=Math.sin(v)*(2+e*Math.cos(v/2)),w=e*Math.sin(v/2),d.set(g,C,w)},mobius3d:function(e,a,d){e*=Math.PI,a*=2*Math.PI;var _,x,b,v=(e*=2)/2;_=.125*Math.cos(a)*Math.cos(v)-.65*Math.sin(a)*Math.sin(v),b=.125*Math.cos(a)*Math.sin(v)+.65*Math.sin(a)*Math.cos(v),x=(2.25+_)*Math.sin(e),_=(2.25+_)*Math.cos(e),d.set(_,x,b)},TubeGeometry:function(s,e,a,d,v,g){this.path=s,this.segments=e||64,this.radius=a||1,this.segmentsRadius=d||8,this.closed=v||!1,g&&(this.debug=new Object3D);var C=this,w=this.segments+1,_=s.computeFrenetFrames(e,v),x=_.tangents,b=_.normals,A=_.binormals;this.tangents=x,this.normals=b,this.binormals=A,ParametricGeometry.call(this,function(O,D,F){D*=2*Math.PI;var L=O*(w-1);L=Math.floor(L);var I=s.getPointAt(O),z=b[L],H=A[L];C.debug&&(C.debug.add(new ArrowHelper(x[L],I,a,255)),C.debug.add(new ArrowHelper(z,I,a,16711680)),C.debug.add(new ArrowHelper(H,I,a,65280)));var X=-C.radius*Math.cos(D),re=C.radius*Math.sin(D);I.x+=X*z.x+re*H.x,I.y+=X*z.y+re*H.y,I.z+=X*z.z+re*H.z,F.copy(I)},e,d)}};ParametricGeometries.TubeGeometry.prototype=Object.create(Geometry.prototype),ParametricGeometries.TubeGeometry.prototype.constructor=ParametricGeometries.TubeGeometry,ParametricGeometries.TorusKnotGeometry=function(s,e,a,d,v,g){function C(){Curve.call(this)}this.radius=s||200,this.tube=e||40,this.segmentsT=a||64,this.segmentsR=d||8,this.p=v||2,this.q=g||3,(C.prototype=Object.create(Curve.prototype)).constructor=C,C.prototype.getPoint=function(b,A){var E=A||new Vector3;b*=2*Math.PI;var O=(1+.5*Math.cos(g*b))*Math.cos(v*b),D=(1+.5*Math.cos(g*b))*Math.sin(v*b),F=.5*Math.sin(g*b);return E.set(O,D,F).multiplyScalar(s)};var w=a,_=d,x=new C;ParametricGeometries.TubeGeometry.call(this,x,w,e,_,!0,!1)},ParametricGeometries.TorusKnotGeometry.prototype=Object.create(Geometry.prototype),ParametricGeometries.TorusKnotGeometry.prototype.constructor=ParametricGeometries.TorusKnotGeometry,ParametricGeometries.SphereGeometry=function(s,e,a){ParametricGeometry.call(this,function(v,g,C){v*=Math.PI,g*=2*Math.PI;var w=s*Math.sin(v)*Math.cos(g),_=s*Math.sin(v)*Math.sin(g),x=s*Math.cos(v);C.set(w,_,x)},e,a)},ParametricGeometries.SphereGeometry.prototype=Object.create(Geometry.prototype),ParametricGeometries.SphereGeometry.prototype.constructor=ParametricGeometries.SphereGeometry,ParametricGeometries.PlaneGeometry=function(s,e,a,d){ParametricGeometry.call(this,function(g,C,w){w.set(g*s,0,C*e)},a,d)},ParametricGeometries.PlaneGeometry.prototype=Object.create(Geometry.prototype),ParametricGeometries.PlaneGeometry.prototype.constructor=ParametricGeometries.PlaneGeometry;var TeapotBufferGeometry=function(e,a,d,v,g,C,w){var _=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,3,16,17,18,7,19,20,21,11,22,23,24,15,25,26,27,18,28,29,30,21,31,32,33,24,34,35,36,27,37,38,39,30,40,41,0,33,42,43,4,36,44,45,8,39,46,47,12,12,13,14,15,48,49,50,51,52,53,54,55,56,57,58,59,15,25,26,27,51,60,61,62,55,63,64,65,59,66,67,68,27,37,38,39,62,69,70,71,65,72,73,74,68,75,76,77,39,46,47,12,71,78,79,48,74,80,81,52,77,82,83,56,56,57,58,59,84,85,86,87,88,89,90,91,92,93,94,95,59,66,67,68,87,96,97,98,91,99,100,101,95,102,103,104,68,75,76,77,98,105,106,107,101,108,109,110,104,111,112,113,77,82,83,56,107,114,115,84,110,116,117,88,113,118,119,92,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,123,136,137,120,127,138,139,124,131,140,141,128,135,142,143,132,132,133,134,135,144,145,146,147,148,149,150,151,68,152,153,154,135,142,143,132,147,155,156,144,151,157,158,148,154,159,160,68,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,164,177,178,161,168,179,180,165,172,181,182,169,176,183,184,173,173,174,175,176,185,186,187,188,189,190,191,192,193,194,195,196,176,183,184,173,188,197,198,185,192,199,200,189,196,201,202,193,203,203,203,203,204,205,206,207,208,208,208,208,209,210,211,212,203,203,203,203,207,213,214,215,208,208,208,208,212,216,217,218,203,203,203,203,215,219,220,221,208,208,208,208,218,222,223,224,203,203,203,203,221,225,226,204,208,208,208,208,224,227,228,209,209,210,211,212,229,230,231,232,233,234,235,236,237,238,239,240,212,216,217,218,232,241,242,243,236,244,245,246,240,247,248,249,218,222,223,224,243,250,251,252,246,253,254,255,249,256,257,258,224,227,228,209,252,259,260,229,255,261,262,233,258,263,264,237,265,265,265,265,266,267,268,269,270,271,272,273,92,119,118,113,265,265,265,265,269,274,275,276,273,277,278,279,113,112,111,104,265,265,265,265,276,280,281,282,279,283,284,285,104,103,102,95,265,265,265,265,282,286,287,266,285,288,289,270,95,94,93,92],x=[1.4,0,2.4,1.4,-.784,2.4,.784,-1.4,2.4,0,-1.4,2.4,1.3375,0,2.53125,1.3375,-.749,2.53125,.749,-1.3375,2.53125,0,-1.3375,2.53125,1.4375,0,2.53125,1.4375,-.805,2.53125,.805,-1.4375,2.53125,0,-1.4375,2.53125,1.5,0,2.4,1.5,-.84,2.4,.84,-1.5,2.4,0,-1.5,2.4,-.784,-1.4,2.4,-1.4,-.784,2.4,-1.4,0,2.4,-.749,-1.3375,2.53125,-1.3375,-.749,2.53125,-1.3375,0,2.53125,-.805,-1.4375,2.53125,-1.4375,-.805,2.53125,-1.4375,0,2.53125,-.84,-1.5,2.4,-1.5,-.84,2.4,-1.5,0,2.4,-1.4,.784,2.4,-.784,1.4,2.4,0,1.4,2.4,-1.3375,.749,2.53125,-.749,1.3375,2.53125,0,1.3375,2.53125,-1.4375,.805,2.53125,-.805,1.4375,2.53125,0,1.4375,2.53125,-1.5,.84,2.4,-.84,1.5,2.4,0,1.5,2.4,.784,1.4,2.4,1.4,.784,2.4,.749,1.3375,2.53125,1.3375,.749,2.53125,.805,1.4375,2.53125,1.4375,.805,2.53125,.84,1.5,2.4,1.5,.84,2.4,1.75,0,1.875,1.75,-.98,1.875,.98,-1.75,1.875,0,-1.75,1.875,2,0,1.35,2,-1.12,1.35,1.12,-2,1.35,0,-2,1.35,2,0,.9,2,-1.12,.9,1.12,-2,.9,0,-2,.9,-.98,-1.75,1.875,-1.75,-.98,1.875,-1.75,0,1.875,-1.12,-2,1.35,-2,-1.12,1.35,-2,0,1.35,-1.12,-2,.9,-2,-1.12,.9,-2,0,.9,-1.75,.98,1.875,-.98,1.75,1.875,0,1.75,1.875,-2,1.12,1.35,-1.12,2,1.35,0,2,1.35,-2,1.12,.9,-1.12,2,.9,0,2,.9,.98,1.75,1.875,1.75,.98,1.875,1.12,2,1.35,2,1.12,1.35,1.12,2,.9,2,1.12,.9,2,0,.45,2,-1.12,.45,1.12,-2,.45,0,-2,.45,1.5,0,.225,1.5,-.84,.225,.84,-1.5,.225,0,-1.5,.225,1.5,0,.15,1.5,-.84,.15,.84,-1.5,.15,0,-1.5,.15,-1.12,-2,.45,-2,-1.12,.45,-2,0,.45,-.84,-1.5,.225,-1.5,-.84,.225,-1.5,0,.225,-.84,-1.5,.15,-1.5,-.84,.15,-1.5,0,.15,-2,1.12,.45,-1.12,2,.45,0,2,.45,-1.5,.84,.225,-.84,1.5,.225,0,1.5,.225,-1.5,.84,.15,-.84,1.5,.15,0,1.5,.15,1.12,2,.45,2,1.12,.45,.84,1.5,.225,1.5,.84,.225,.84,1.5,.15,1.5,.84,.15,-1.6,0,2.025,-1.6,-.3,2.025,-1.5,-.3,2.25,-1.5,0,2.25,-2.3,0,2.025,-2.3,-.3,2.025,-2.5,-.3,2.25,-2.5,0,2.25,-2.7,0,2.025,-2.7,-.3,2.025,-3,-.3,2.25,-3,0,2.25,-2.7,0,1.8,-2.7,-.3,1.8,-3,-.3,1.8,-3,0,1.8,-1.5,.3,2.25,-1.6,.3,2.025,-2.5,.3,2.25,-2.3,.3,2.025,-3,.3,2.25,-2.7,.3,2.025,-3,.3,1.8,-2.7,.3,1.8,-2.7,0,1.575,-2.7,-.3,1.575,-3,-.3,1.35,-3,0,1.35,-2.5,0,1.125,-2.5,-.3,1.125,-2.65,-.3,.9375,-2.65,0,.9375,-2,-.3,.9,-1.9,-.3,.6,-1.9,0,.6,-3,.3,1.35,-2.7,.3,1.575,-2.65,.3,.9375,-2.5,.3,1.125,-1.9,.3,.6,-2,.3,.9,1.7,0,1.425,1.7,-.66,1.425,1.7,-.66,.6,1.7,0,.6,2.6,0,1.425,2.6,-.66,1.425,3.1,-.66,.825,3.1,0,.825,2.3,0,2.1,2.3,-.25,2.1,2.4,-.25,2.025,2.4,0,2.025,2.7,0,2.4,2.7,-.25,2.4,3.3,-.25,2.4,3.3,0,2.4,1.7,.66,.6,1.7,.66,1.425,3.1,.66,.825,2.6,.66,1.425,2.4,.25,2.025,2.3,.25,2.1,3.3,.25,2.4,2.7,.25,2.4,2.8,0,2.475,2.8,-.25,2.475,3.525,-.25,2.49375,3.525,0,2.49375,2.9,0,2.475,2.9,-.15,2.475,3.45,-.15,2.5125,3.45,0,2.5125,2.8,0,2.4,2.8,-.15,2.4,3.2,-.15,2.4,3.2,0,2.4,3.525,.25,2.49375,2.8,.25,2.475,3.45,.15,2.5125,2.9,.15,2.475,3.2,.15,2.4,2.8,.15,2.4,0,0,3.15,.8,0,3.15,.8,-.45,3.15,.45,-.8,3.15,0,-.8,3.15,0,0,2.85,.2,0,2.7,.2,-.112,2.7,.112,-.2,2.7,0,-.2,2.7,-.45,-.8,3.15,-.8,-.45,3.15,-.8,0,3.15,-.112,-.2,2.7,-.2,-.112,2.7,-.2,0,2.7,-.8,.45,3.15,-.45,.8,3.15,0,.8,3.15,-.2,.112,2.7,-.112,.2,2.7,0,.2,2.7,.45,.8,3.15,.8,.45,3.15,.112,.2,2.7,.2,.112,2.7,.4,0,2.55,.4,-.224,2.55,.224,-.4,2.55,0,-.4,2.55,1.3,0,2.55,1.3,-.728,2.55,.728,-1.3,2.55,0,-1.3,2.55,1.3,0,2.4,1.3,-.728,2.4,.728,-1.3,2.4,0,-1.3,2.4,-.224,-.4,2.55,-.4,-.224,2.55,-.4,0,2.55,-.728,-1.3,2.55,-1.3,-.728,2.55,-1.3,0,2.55,-.728,-1.3,2.4,-1.3,-.728,2.4,-1.3,0,2.4,-.4,.224,2.55,-.224,.4,2.55,0,.4,2.55,-1.3,.728,2.55,-.728,1.3,2.55,0,1.3,2.55,-1.3,.728,2.4,-.728,1.3,2.4,0,1.3,2.4,.224,.4,2.55,.4,.224,2.55,.728,1.3,2.55,1.3,.728,2.55,.728,1.3,2.4,1.3,.728,2.4,0,0,0,1.425,0,0,1.425,.798,0,.798,1.425,0,0,1.425,0,1.5,0,.075,1.5,.84,.075,.84,1.5,.075,0,1.5,.075,-.798,1.425,0,-1.425,.798,0,-1.425,0,0,-.84,1.5,.075,-1.5,.84,.075,-1.5,0,.075,-1.425,-.798,0,-.798,-1.425,0,0,-1.425,0,-1.5,-.84,.075,-.84,-1.5,.075,0,-1.5,.075,.798,-1.425,0,1.425,-.798,0,.84,-1.5,.075,1.5,-.84,.075];BufferGeometry.call(this),e=e||50,a=void 0!==a?Math.max(2,Math.floor(a)||10):10,C=void 0===C||C;var E=3.15*((w=void 0===w||w)?1:1.3)/2,R=e/E,O=(d=void 0===d||d)?(8*a-4)*a:0;O+=(v=void 0===v||v)?(16*a-4)*a:0,O+=(g=void 0===g||g)?40*a*a:0;var D=new Uint32Array(3*O),F=d?4:0;F+=v?8:0,F+=g?20:0,F*=(a+1)*(a+1);var L=new Float32Array(3*F),I=new Float32Array(3*F),V=new Float32Array(2*F),z=new Matrix4;z.set(-1,3,-3,1,3,-6,3,0,-3,3,0,0,1,0,0,0);var X,re,j,fe,ge,$,ue,Y,Z,se,ve,le,he,ce,Te,be,H=[],te=[],J=[],k=[],U=[],K=[],ee=[],Q=[],oe=[],me=new Vector3,_e=0,ae=0,pe=new Vector3,xe=new Matrix4,we=new Matrix4,Ne=new Vector4,Re=new Vector4,De=new Vector4,Je=new Vector4,$e=new Vector3,pt=new Vector3,ut=z.clone();ut.transpose();var at=function(Gt,Lt,yt){return!(L[3*Gt]===L[3*Lt]&&L[3*Gt+1]===L[3*Lt+1]&&L[3*Gt+2]===L[3*Lt+2]||L[3*Gt]===L[3*yt]&&L[3*Gt+1]===L[3*yt+1]&&L[3*Gt+2]===L[3*yt+2]||L[3*Lt]===L[3*yt]&&L[3*Lt+1]===L[3*yt+1]&&L[3*Lt+2]===L[3*yt+2])};for(X=0;X<3;X++)K[X]=new Matrix4;var Ke=d?32:28;ue=a+1;for(var lt=0,ot=0,St=0,ft=0,He=0,gt=g?0:20;gt<Ke;gt++)if(v||gt<20||gt>=28){for(X=0;X<3;X++){for(re=0;re<4;re++)for(j=0;j<4;j++)H[4*j+re]=x[3*_[16*gt+4*re+j]+X],C&&gt>=20&&gt<28&&2!==X&&(H[4*j+re]*=1.077),!w&&2===X&&(H[4*j+re]*=1.3);xe.set(H[0],H[1],H[2],H[3],H[4],H[5],H[6],H[7],H[8],H[9],H[10],H[11],H[12],H[13],H[14],H[15]),we.multiplyMatrices(xe,z),K[X].multiplyMatrices(ut,we)}for(ge=0;ge<=a;ge++)for(Y=ge/a,$=0;$<=a;$++){for(Z=$/a,le=4,se=ve=1;le--;)te[le]=se,J[le]=ve,se*=Y,ve*=Z,3===le?(k[le]=U[le]=0,_e=ae=1):(k[le]=_e*(3-le),U[le]=ae*(3-le),_e*=Y,ae*=Z);for(Ne.fromArray(te),Re.fromArray(J),De.fromArray(k),Je.fromArray(U),X=0;X<3;X++)(fe=Ne.clone()).applyMatrix4(K[X]),ee[X]=fe.dot(Re),(fe=De.clone()).applyMatrix4(K[X]),Q[X]=fe.dot(Re),(fe=Ne.clone()).applyMatrix4(K[X]),oe[X]=fe.dot(Je);$e.fromArray(Q),pt.fromArray(oe),me.crossVectors(pt,$e),me.normalize(),0===ee[0]&&0===ee[1]?pe.set(0,ee[2]>E?1:-1,0):pe.set(me.x,me.z,-me.y),L[ot++]=R*ee[0],L[ot++]=R*(ee[2]-E),L[ot++]=-R*ee[1],I[St++]=pe.x,I[St++]=pe.y,I[St++]=pe.z,V[ft++]=1-Z,V[ft++]=1-Y}for(ge=0;ge<a;ge++)for($=0;$<a;$++)be=(he=lt*ue*ue+ge*ue+$)+ue,at(he,ce=he+1,Te=ce+ue)&&(D[He++]=he,D[He++]=ce,D[He++]=Te),at(he,Te,be)&&(D[He++]=he,D[He++]=Te,D[He++]=be);lt++}this.setIndex(new BufferAttribute(D,1)),this.setAttribute("position",new BufferAttribute(L,3)),this.setAttribute("normal",new BufferAttribute(I,3)),this.setAttribute("uv",new BufferAttribute(V,2)),this.computeBoundingSphere()};TeapotBufferGeometry.prototype=Object.create(BufferGeometry.prototype),TeapotBufferGeometry.prototype.constructor=TeapotBufferGeometry;var _start$1=new Vector3,_end$1=new Vector3;function LineSegments(s,e){Line.call(this,s,e),this.type="LineSegments"}LineSegments.prototype=Object.assign(Object.create(Line.prototype),{constructor:LineSegments,isLineSegments:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var a=e.attributes.position,d=[],v=0,g=a.count;v<g;v+=2)_start$1.fromBufferAttribute(a,v),_end$1.fromBufferAttribute(a,v+1),d[v]=0===v?0:d[v-1],d[v+1]=d[v]+_start$1.distanceTo(_end$1);e.setAttribute("lineDistance",new Float32BufferAttribute(d,1))}else console.warn("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry){var C=e.vertices;for(d=e.lineDistances,v=0,g=C.length;v<g;v+=2)_start$1.copy(C[v]),_end$1.copy(C[v+1]),d[v]=0===v?0:d[v-1],d[v+1]=d[v]+_start$1.distanceTo(_end$1)}return this}});var _v1$4=new Vector3,_v2$2=new Vector3,_normalMatrix$1=new Matrix3;function FaceNormalsHelper(s,e,a,d){this.object=s,this.size=void 0!==e?e:1;var v=void 0!==a?a:16776960,g=void 0!==d?d:1,C=0,w=this.object.geometry;w&&w.isGeometry?C=w.faces.length:console.warn("FaceNormalsHelper: only Geometry is supported. Use VertexNormalsHelper, instead.");var _=new BufferGeometry,x=new Float32BufferAttribute(2*C*3,3);_.setAttribute("position",x),LineSegments.call(this,_,new LineBasicMaterial({color:v,linewidth:g})),this.matrixAutoUpdate=!1,this.update()}function LightProbeHelper(s,e){this.lightProbe=s,this.size=e;var a=new ShaderMaterial({type:"LightProbeHelperMaterial",uniforms:{sh:{value:this.lightProbe.sh.coefficients},intensity:{value:this.lightProbe.intensity}},vertexShader:["varying vec3 vNormal;","void main() {","\tvNormal = normalize( normalMatrix * normal );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define RECIPROCAL_PI 0.318309886","vec3 inverseTransformDirection( in vec3 normal, in mat4 matrix ) {","\t// matrix is assumed to be orthogonal","\treturn normalize( ( vec4( normal, 0.0 ) * matrix ).xyz );","}","// source: https://graphics.stanford.edu/papers/envmap/envmap.pdf","vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {","\t// normal is assumed to have unit length","\tfloat x = normal.x, y = normal.y, z = normal.z;","\t// band 0","\tvec3 result = shCoefficients[ 0 ] * 0.886227;","\t// band 1","\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;","\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;","\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;","\t// band 2","\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;","\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;","\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );","\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;","\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );","\treturn result;","}","uniform vec3 sh[ 9 ]; // sh coefficients","uniform float intensity; // light probe intensity","varying vec3 vNormal;","void main() {","\tvec3 normal = normalize( vNormal );","\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );","\tvec3 irradiance = shGetIrradianceAt( worldNormal, sh );","\tvec3 outgoingLight = RECIPROCAL_PI * irradiance * intensity;","\tgl_FragColor = linearToOutputTexel( vec4( outgoingLight, 1.0 ) );","}"].join("\n")}),d=new SphereBufferGeometry(1,32,16);Mesh.call(this,d,a),this.onBeforeRender()}function PositionalAudioHelper(s,e,a,d){this.audio=s,this.range=e||1,this.divisionsInnerAngle=a||16,this.divisionsOuterAngle=d||2;var v=new BufferGeometry,C=new Float32Array(3*(3*(this.divisionsInnerAngle+2*this.divisionsOuterAngle)+3));v.setAttribute("position",new BufferAttribute(C,3));var w=new LineBasicMaterial({color:65280}),_=new LineBasicMaterial({color:16776960});Line.call(this,v,[_,w]),this.update()}function RectAreaLightHelper(s,e){this.type="RectAreaLightHelper",this.light=s,this.color=e;var d=new BufferGeometry;d.setAttribute("position",new Float32BufferAttribute([1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),d.computeBoundingSphere();var v=new LineBasicMaterial({fog:!1});Line.call(this,d,v);var C=new BufferGeometry;C.setAttribute("position",new Float32BufferAttribute([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),C.computeBoundingSphere(),this.add(new Mesh(C,new MeshBasicMaterial({side:BackSide,fog:!1}))),this.update()}FaceNormalsHelper.prototype=Object.create(LineSegments.prototype),FaceNormalsHelper.prototype.constructor=FaceNormalsHelper,FaceNormalsHelper.prototype.update=function(){this.object.updateMatrixWorld(!0),_normalMatrix$1.getNormalMatrix(this.object.matrixWorld);for(var s=this.object.matrixWorld,e=this.geometry.attributes.position,a=this.object.geometry,d=a.vertices,v=a.faces,g=0,C=0,w=v.length;C<w;C++){var _=v[C],x=_.normal;_v1$4.copy(d[_.a]).add(d[_.b]).add(d[_.c]).divideScalar(3).applyMatrix4(s),_v2$2.copy(x).applyMatrix3(_normalMatrix$1).normalize().multiplyScalar(this.size).add(_v1$4),e.setXYZ(g,_v1$4.x,_v1$4.y,_v1$4.z),e.setXYZ(g+=1,_v2$2.x,_v2$2.y,_v2$2.z),g+=1}e.needsUpdate=!0},LightProbeHelper.prototype=Object.create(Mesh.prototype),LightProbeHelper.prototype.constructor=LightProbeHelper,LightProbeHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},LightProbeHelper.prototype.onBeforeRender=function(){this.position.copy(this.lightProbe.position),this.scale.set(1,1,1).multiplyScalar(this.size),this.material.uniforms.intensity.value=this.lightProbe.intensity},PositionalAudioHelper.prototype=Object.create(Line.prototype),PositionalAudioHelper.prototype.constructor=PositionalAudioHelper,PositionalAudioHelper.prototype.update=function(){var b,A,s=this.audio,e=this.range,a=this.divisionsInnerAngle,d=this.divisionsOuterAngle,v=MathUtils.degToRad(s.panner.coneInnerAngle),g=MathUtils.degToRad(s.panner.coneOuterAngle),C=v/2,w=g/2,_=0,x=0,E=this.geometry,R=E.attributes.position;function O(D,F,L,I){var V=(F-D)/L;for(R.setXYZ(_,0,0,0),x++,b=D;b<F;b+=V)R.setXYZ(A=_+x,Math.sin(b)*e,0,Math.cos(b)*e),R.setXYZ(A+1,Math.sin(Math.min(b+V,F))*e,0,Math.cos(Math.min(b+V,F))*e),R.setXYZ(A+2,0,0,0),x+=3;E.addGroup(_,x,I),_+=x,x=0}E.clearGroups(),O(-w,-C,d,0),O(-C,C,a,1),O(C,w,d,0),R.needsUpdate=!0,v===g&&(this.material[0].visible=!1)},PositionalAudioHelper.prototype.dispose=function(){this.geometry.dispose(),this.material[0].dispose(),this.material[1].dispose()},RectAreaLightHelper.prototype=Object.create(Line.prototype),RectAreaLightHelper.prototype.constructor=RectAreaLightHelper,RectAreaLightHelper.prototype.update=function(){if(this.scale.set(.5*this.light.width,.5*this.light.height,1),void 0!==this.color)this.material.color.set(this.color),this.children[0].material.color.set(this.color);else{this.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);var s=this.material.color,e=Math.max(s.r,s.g,s.b);e>1&&s.multiplyScalar(1/e),this.children[0].material.color.copy(this.material.color)}},RectAreaLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()};var _v1$5=new Vector3,_v2$3=new Vector3,_normalMatrix$2=new Matrix3,_keys=["a","b","c"];function VertexNormalsHelper(s,e,a,d){this.object=s,this.size=void 0!==e?e:1;var v=void 0!==a?a:16711680,g=void 0!==d?d:1,C=0,w=this.object.geometry;w&&w.isGeometry?C=3*w.faces.length:w&&w.isBufferGeometry&&(C=w.attributes.normal.count);var _=new BufferGeometry,x=new Float32BufferAttribute(2*C*3,3);_.setAttribute("position",x),LineSegments.call(this,_,new LineBasicMaterial({color:v,linewidth:g})),this.matrixAutoUpdate=!1,this.update()}VertexNormalsHelper.prototype=Object.create(LineSegments.prototype),VertexNormalsHelper.prototype.constructor=VertexNormalsHelper,VertexNormalsHelper.prototype.update=function(){this.object.updateMatrixWorld(!0),_normalMatrix$2.getNormalMatrix(this.object.matrixWorld);var s=this.object.matrixWorld,e=this.geometry.attributes.position,a=this.object.geometry;if(a&&a.isGeometry)for(var d=a.vertices,v=a.faces,g=0,C=0,w=v.length;C<w;C++)for(var _=v[C],x=0,b=_.vertexNormals.length;x<b;x++){var E=_.vertexNormals[x];_v1$5.copy(d[_[_keys[x]]]).applyMatrix4(s),_v2$3.copy(E).applyMatrix3(_normalMatrix$2).normalize().multiplyScalar(this.size).add(_v1$5),e.setXYZ(g,_v1$5.x,_v1$5.y,_v1$5.z),e.setXYZ(g+=1,_v2$3.x,_v2$3.y,_v2$3.z),g+=1}else if(a&&a.isBufferGeometry){var R=a.attributes.position,O=a.attributes.normal;for(g=0,x=0,b=R.count;x<b;x++)_v1$5.set(R.getX(x),R.getY(x),R.getZ(x)).applyMatrix4(s),_v2$3.set(O.getX(x),O.getY(x),O.getZ(x)),_v2$3.applyMatrix3(_normalMatrix$2).normalize().multiplyScalar(this.size).add(_v1$5),e.setXYZ(g,_v1$5.x,_v1$5.y,_v1$5.z),e.setXYZ(g+=1,_v2$3.x,_v2$3.y,_v2$3.z),g+=1}e.needsUpdate=!0};var _v1$6=new Vector3,_v2$4=new Vector3;function VertexTangentsHelper(s,e,a,d){this.object=s,this.size=void 0!==e?e:1;var v=void 0!==a?a:65535,g=void 0!==d?d:1,C=this.object.geometry;if(C&&C.isBufferGeometry){var w=C.attributes.tangent.count,_=new BufferGeometry,x=new Float32BufferAttribute(2*w*3,3);_.setAttribute("position",x),LineSegments.call(this,_,new LineBasicMaterial({color:v,linewidth:g})),this.matrixAutoUpdate=!1,this.update()}else console.error("VertexTangentsHelper: geometry not an instance of BufferGeometry.",C)}VertexTangentsHelper.prototype=Object.create(LineSegments.prototype),VertexTangentsHelper.prototype.constructor=VertexTangentsHelper,VertexTangentsHelper.prototype.update=function(){this.object.updateMatrixWorld(!0);for(var s=this.object.matrixWorld,e=this.geometry.attributes.position,a=this.object.geometry,d=a.attributes.position,v=a.attributes.tangent,g=0,C=0,w=d.count;C<w;C++)_v1$6.set(d.getX(C),d.getY(C),d.getZ(C)).applyMatrix4(s),_v2$4.set(v.getX(C),v.getY(C),v.getZ(C)),_v2$4.transformDirection(s).multiplyScalar(this.size).add(_v1$6),e.setXYZ(g,_v1$6.x,_v1$6.y,_v1$6.z),e.setXYZ(g+=1,_v2$4.x,_v2$4.y,_v2$4.z),g+=1;e.needsUpdate=!0};var _sphere$2=new Sphere,_vector$5=new Vector3;function Frustum(s,e,a,d,v,g){this.planes=[void 0!==s?s:new Plane,void 0!==e?e:new Plane,void 0!==a?a:new Plane,void 0!==d?d:new Plane,void 0!==v?v:new Plane,void 0!==g?g:new Plane]}Object.assign(Frustum.prototype,{set:function(e,a,d,v,g,C){var w=this.planes;return w[0].copy(e),w[1].copy(a),w[2].copy(d),w[3].copy(v),w[4].copy(g),w[5].copy(C),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var a=this.planes,d=0;d<6;d++)a[d].copy(e.planes[d]);return this},setFromProjectionMatrix:function(e){var a=this.planes,d=e.elements,v=d[0],g=d[1],C=d[2],w=d[3],_=d[4],x=d[5],b=d[6],A=d[7],E=d[8],R=d[9],O=d[10],D=d[11],F=d[12],L=d[13],I=d[14],V=d[15];return a[0].setComponents(w-v,A-_,D-E,V-F).normalize(),a[1].setComponents(w+v,A+_,D+E,V+F).normalize(),a[2].setComponents(w+g,A+x,D+R,V+L).normalize(),a[3].setComponents(w-g,A-x,D-R,V-L).normalize(),a[4].setComponents(w-C,A-b,D-O,V-I).normalize(),a[5].setComponents(w+C,A+b,D+O,V+I).normalize(),this},intersectsObject:function(e){var a=e.geometry;return null===a.boundingSphere&&a.computeBoundingSphere(),_sphere$2.copy(a.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(_sphere$2)},intersectsSprite:function(e){return _sphere$2.center.set(0,0,0),_sphere$2.radius=.7071067811865476,_sphere$2.applyMatrix4(e.matrixWorld),this.intersectsSphere(_sphere$2)},intersectsSphere:function(e){for(var a=this.planes,d=e.center,v=-e.radius,g=0;g<6;g++)if(a[g].distanceToPoint(d)<v)return!1;return!0},intersectsBox:function(e){for(var a=this.planes,d=0;d<6;d++){var v=a[d];if(_vector$5.x=v.normal.x>0?e.max.x:e.min.x,_vector$5.y=v.normal.y>0?e.max.y:e.min.y,_vector$5.z=v.normal.z>0?e.max.z:e.min.z,v.distanceToPoint(_vector$5)<0)return!1}return!0},containsPoint:function(e){for(var a=this.planes,d=0;d<6;d++)if(a[d].distanceToPoint(e)<0)return!1;return!0}});var SelectionBox=function(){var s=new Frustum,e=new Vector3,a=new Vector3,d=new Vector3,v=new Vector3,g=new Vector3,C=new Vector3,w=new Vector3,_=new Vector3,x=new Vector3,b=new Vector3;function A(E,R,O){this.camera=E,this.scene=R,this.startPoint=new Vector3,this.endPoint=new Vector3,this.collection=[],this.deep=O||Number.MAX_VALUE}return A.prototype.select=function(E,R){return this.startPoint=E||this.startPoint,this.endPoint=R||this.endPoint,this.collection=[],this.updateFrustum(this.startPoint,this.endPoint),this.searchChildInFrustum(s,this.scene),this.collection},A.prototype.updateFrustum=function(E,R){E=E||this.startPoint,R=R||this.endPoint,this.camera.updateProjectionMatrix(),this.camera.updateMatrixWorld(),a.copy(E),a.x=Math.min(E.x,R.x),a.y=Math.max(E.y,R.y),R.x=Math.max(E.x,R.x),R.y=Math.min(E.y,R.y),d.copy(this.camera.position),v.copy(a),g.set(R.x,a.y,0),C.copy(R),w.set(a.x,R.y,0),v.unproject(this.camera),g.unproject(this.camera),C.unproject(this.camera),w.unproject(this.camera),_.copy(v).sub(d),x.copy(g).sub(d),b.copy(C).sub(d),_.normalize(),x.normalize(),b.normalize(),_.multiplyScalar(this.deep),x.multiplyScalar(this.deep),b.multiplyScalar(this.deep),_.add(d),x.add(d),b.add(d);var O=s.planes;O[0].setFromCoplanarPoints(d,v,g),O[1].setFromCoplanarPoints(d,g,C),O[2].setFromCoplanarPoints(C,w,d),O[3].setFromCoplanarPoints(w,v,d),O[4].setFromCoplanarPoints(g,C,w),O[5].setFromCoplanarPoints(b,x,_),O[5].normal.multiplyScalar(-1)},A.prototype.searchChildInFrustum=function(E,R){if(R.isMesh&&void 0!==R.material&&(R.geometry.computeBoundingSphere(),e.copy(R.geometry.boundingSphere.center),e.applyMatrix4(R.matrixWorld),E.containsPoint(e)&&this.collection.push(R)),R.children.length>0)for(var O=0;O<R.children.length;O++)this.searchChildInFrustum(E,R.children[O])},A}(),SelectionHelper=function(){function s(e,a,d){this.element=document.createElement("div"),this.element.classList.add(d),this.element.style.pointerEvents="none",this.renderer=a,this.startPoint=new Vector2,this.pointTopLeft=new Vector2,this.pointBottomRight=new Vector2,this.isDown=!1,this.renderer.domElement.addEventListener("mousedown",function(v){this.isDown=!0,this.onSelectStart(v)}.bind(this),!1),this.renderer.domElement.addEventListener("mousemove",function(v){this.isDown&&this.onSelectMove(v)}.bind(this),!1),this.renderer.domElement.addEventListener("mouseup",function(v){this.isDown=!1,this.onSelectOver(v)}.bind(this),!1)}return s.prototype.onSelectStart=function(e){this.renderer.domElement.parentElement.appendChild(this.element),this.element.style.left=e.clientX+"px",this.element.style.top=e.clientY+"px",this.element.style.width="0px",this.element.style.height="0px",this.startPoint.x=e.clientX,this.startPoint.y=e.clientY},s.prototype.onSelectMove=function(e){this.pointBottomRight.x=Math.max(this.startPoint.x,e.clientX),this.pointBottomRight.y=Math.max(this.startPoint.y,e.clientY),this.pointTopLeft.x=Math.min(this.startPoint.x,e.clientX),this.pointTopLeft.y=Math.min(this.startPoint.y,e.clientY),this.element.style.left=this.pointTopLeft.x+"px",this.element.style.top=this.pointTopLeft.y+"px",this.element.style.width=this.pointBottomRight.x-this.pointTopLeft.x+"px",this.element.style.height=this.pointBottomRight.y-this.pointTopLeft.y+"px"},s.prototype.onSelectOver=function(){this.element.parentElement.removeChild(this.element)},s}();function SphericalHarmonics3(){this.coefficients=[];for(var s=0;s<9;s++)this.coefficients.push(new Vector3)}function Light(s,e){Object3D.call(this),this.type="Light",this.color=new Color(s),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function LightProbe(s,e){Light.call(this,void 0,e),this.sh=void 0!==s?s:new SphericalHarmonics3}Object.assign(SphericalHarmonics3.prototype,{isSphericalHarmonics3:!0,set:function(e){for(var a=0;a<9;a++)this.coefficients[a].copy(e[a]);return this},zero:function(){for(var e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this},getAt:function(e,a){var d=e.x,v=e.y,g=e.z,C=this.coefficients;return a.copy(C[0]).multiplyScalar(.282095),a.addScale(C[1],.488603*v),a.addScale(C[2],.488603*g),a.addScale(C[3],.488603*d),a.addScale(C[4],d*v*1.092548),a.addScale(C[5],v*g*1.092548),a.addScale(C[6],.315392*(3*g*g-1)),a.addScale(C[7],d*g*1.092548),a.addScale(C[8],.546274*(d*d-v*v)),a},getIrradianceAt:function(e,a){var d=e.x,v=e.y,g=e.z,C=this.coefficients;return a.copy(C[0]).multiplyScalar(.886227),a.addScale(C[1],1.023328*v),a.addScale(C[2],1.023328*g),a.addScale(C[3],1.023328*d),a.addScale(C[4],.858086*d*v),a.addScale(C[5],.858086*v*g),a.addScale(C[6],.743125*g*g-.247708),a.addScale(C[7],.858086*d*g),a.addScale(C[8],.429043*(d*d-v*v)),a},add:function(e){for(var a=0;a<9;a++)this.coefficients[a].add(e.coefficients[a]);return this},scale:function(e){for(var a=0;a<9;a++)this.coefficients[a].multiplyScalar(e);return this},lerp:function(e,a){for(var d=0;d<9;d++)this.coefficients[d].lerp(e.coefficients[d],a);return this},equals:function(e){for(var a=0;a<9;a++)if(!this.coefficients[a].equals(e.coefficients[a]))return!1;return!0},copy:function(e){return this.set(e.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(e,a){void 0===a&&(a=0);for(var d=this.coefficients,v=0;v<9;v++)d[v].fromArray(e,a+3*v);return this},toArray:function(e,a){void 0===e&&(e=[]),void 0===a&&(a=0);for(var d=this.coefficients,v=0;v<9;v++)d[v].toArray(e,a+3*v);return e}}),Object.assign(SphericalHarmonics3,{getBasisAt:function(e,a){var d=e.x,v=e.y,g=e.z;a[0]=.282095,a[1]=.488603*v,a[2]=.488603*g,a[3]=.488603*d,a[4]=1.092548*d*v,a[5]=1.092548*v*g,a[6]=.315392*(3*g*g-1),a[7]=1.092548*d*g,a[8]=.546274*(d*d-v*v)}}),Light.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Light,isLight:!0,copy:function(e){return Object3D.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){var a=Object3D.prototype.toJSON.call(this,e);return a.object.color=this.color.getHex(),a.object.intensity=this.intensity,void 0!==this.groundColor&&(a.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(a.object.distance=this.distance),void 0!==this.angle&&(a.object.angle=this.angle),void 0!==this.decay&&(a.object.decay=this.decay),void 0!==this.penumbra&&(a.object.penumbra=this.penumbra),void 0!==this.shadow&&(a.object.shadow=this.shadow.toJSON()),a}}),LightProbe.prototype=Object.assign(Object.create(Light.prototype),{constructor:LightProbe,isLightProbe:!0,copy:function(e){return Light.prototype.copy.call(this,e),this.sh.copy(e.sh),this.intensity=e.intensity,this},toJSON:function(e){return Light.prototype.toJSON.call(this,e)}});var LightProbeGenerator={fromCubeTexture:function(e){for(var a,d,v,g=0,C=new Vector3,w=new Vector3,_=new Color,x=[0,0,0,0,0,0,0,0,0],b=new SphericalHarmonics3,A=b.coefficients,E=0;E<6;E++){var R=e.image[E],O=R.width,D=R.height,F=document.createElement("canvas");F.width=O,F.height=D;var L=F.getContext("2d");L.drawImage(R,0,0,O,D);for(var I=L.getImageData(0,0,O,D),V=I.data,z=I.width,H=2/z,X=0,re=V.length;X<re;X+=4){_.setRGB(V[X]/255,V[X+1]/255,V[X+2]/255),convertColorToLinear(_,e.encoding);var j=X/4,te=(j%z+.5)*H-1,J=1-(Math.floor(j/z)+.5)*H;switch(E){case 0:C.set(-1,J,-te);break;case 1:C.set(1,J,te);break;case 2:C.set(-te,1,-J);break;case 3:C.set(-te,-1,J);break;case 4:C.set(-te,J,1);break;case 5:C.set(te,J,-1)}d=C.lengthSq(),g+=v=4/(Math.sqrt(d)*d),w.copy(C).normalize(),SphericalHarmonics3.getBasisAt(w,x);for(var k=0;k<9;k++)A[k].x+=x[k]*_.r*v,A[k].y+=x[k]*_.g*v,A[k].z+=x[k]*_.b*v}}for(a=4*Math.PI/g,k=0;k<9;k++)A[k].x*=a,A[k].y*=a,A[k].z*=a;return new LightProbe(b)},fromCubeRenderTarget:function(e,a){for(var d,v,g,C=0,w=new Vector3,_=new Vector3,x=new Color,b=[0,0,0,0,0,0,0,0,0],A=new SphericalHarmonics3,E=A.coefficients,R=0;R<6;R++){var O=a.width,D=new Uint8Array(O*O*4);e.readRenderTargetPixels(a,0,0,O,O,D,R);for(var F=2/O,L=0,I=D.length;L<I;L+=4){x.setRGB(D[L]/255,D[L+1]/255,D[L+2]/255),convertColorToLinear(x,a.texture.encoding);var V=L/4,z=(V%O+.5)*F-1,H=1-(Math.floor(V/O)+.5)*F;switch(R){case 0:w.set(1,H,-z);break;case 1:w.set(-1,H,z);break;case 2:w.set(z,1,-H);break;case 3:w.set(z,-1,H);break;case 4:w.set(z,H,1);break;case 5:w.set(-z,H,-1)}v=w.lengthSq(),C+=g=4/(Math.sqrt(v)*v),_.copy(w).normalize(),SphericalHarmonics3.getBasisAt(_,b);for(var X=0;X<9;X++)E[X].x+=b[X]*x.r*g,E[X].y+=b[X]*x.g*g,E[X].z+=b[X]*x.b*g}}for(d=4*Math.PI/C,X=0;X<9;X++)E[X].x*=d,E[X].y*=d,E[X].z*=d;return new LightProbe(A)}},convertColorToLinear=function(e,a){switch(a){case sRGBEncoding:e.convertSRGBToLinear();break;case LinearEncoding:break;default:console.warn("WARNING: LightProbeGenerator convertColorToLinear() encountered an unsupported encoding.")}return e};function DataTexture(s,e,a,d,v,g,C,w,_,x,b,A){Texture.call(this,null,g,C,w,_,x,d,v,b,A),this.image={data:s||null,width:e||1,height:a||1},this.magFilter=void 0!==_?_:NearestFilter,this.minFilter=void 0!==x?x:NearestFilter,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}DataTexture.prototype=Object.create(Texture.prototype),DataTexture.prototype.constructor=DataTexture,DataTexture.prototype.isDataTexture=!0;var alphamap_fragment="\n#ifdef USE_ALPHAMAP\n\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n\n#endif\n",alphamap_pars_fragment="\n#ifdef USE_ALPHAMAP\n\n\tuniform sampler2D alphaMap;\n\n#endif\n",alphatest_fragment="\n#ifdef ALPHATEST\n\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n\n#endif\n",aomap_fragment="\n#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\n\t#endif\n\n#endif\n",aomap_pars_fragment="\n#ifdef USE_AOMAP\n\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n\n#endif\n",begin_vertex="\nvec3 transformed = vec3( position );\n",beginnormal_vertex="\nvec3 objectNormal = vec3( normal );\n\n#ifdef USE_TANGENT\n\n\tvec3 objectTangent = vec3( tangent.xyz );\n\n#endif\n",bsdfs="\nvec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\n\tvec4 r = roughness * c0 + c1;\n\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n\n}\n\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\n\tif( cutoffDistance > 0.0 ) {\n\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\n\t}\n\n\treturn distanceFalloff;\n\n#else\n\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\n\t}\n\n\treturn 1.0;\n\n#endif\n\n}\n\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\n\treturn RECIPROCAL_PI * diffuseColor;\n\n} \n\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n\n} \n\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\n\treturn Fr * fresnel + F0;\n\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\n\treturn 1.0 / ( gl * gv );\n\n} \nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\n\treturn 0.5 / max( gv + gl, EPSILON );\n\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\n\tfloat a2 = pow2( alpha );\n\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0; \n\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\n\tfloat alpha = pow2( roughness ); \n\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\n\tfloat D = D_GGX( alpha, dotNH );\n\n\treturn F * ( G * D );\n\n} \nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\n\treturn uv;\n\n}\n\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n\n}\n\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\n\tfloat x = dot( v1, v2 );\n\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\n\treturn cross( v1, v2 ) * theta_sintheta;\n\n}\n\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 ); \n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\n\treturn specularColor * brdf.x + brdf.y;\n\n} \nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619; \n\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n\n}\n\nfloat G_BlinnPhong_Implicit(  ) {\n\treturn 0.25;\n\n}\n\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n\n}\n\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\n\tfloat G = G_BlinnPhong_Implicit(  );\n\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\n\treturn F * ( G * D );\n\n} \nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\n\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\t\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125); \n\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\t\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\n\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n\n}\n\n#endif\n",bumpmap_pars_fragment="\n#ifdef USE_BUMPMAP\n\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n\t\treturn vec2( dBx, dBy );\n\n\t}\n\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\t\t\n\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\n\t}\n\n#endif\n",clipping_planes_fragment="\n#if NUM_CLIPPING_PLANES > 0\n\n\tvec4 plane;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\n\t}\n\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\n\t\tbool clipped = true;\n\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\n\t\t}\n\n\t\tif ( clipped ) discard;\n\n\t#endif\n\n#endif\n",clipping_planes_pars_fragment="\n#if NUM_CLIPPING_PLANES > 0\n\n\t#if ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n\n#endif\n",clipping_planes_pars_vertex="\n#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex="\n#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment="\n#ifdef USE_COLOR\n\n\tdiffuseColor.rgb *= vColor;\n\n#endif\n",color_pars_fragment="\n#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif\n",color_pars_vertex="\n#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif\n",color_vertex="\n#ifdef USE_COLOR\n\n\tvColor.xyz = color.xyz;\n\n#endif\n",common="\n#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n\n#ifndef saturate\n\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\n\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\n\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\n\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\n\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n}\n\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n\n}\n\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\n\treturn - distance * planeNormal + point;\n\n}\n\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n\n}\n\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n\n}\n\nmat3 transposeMat3( const in mat3 m ) {\n\n\tmat3 tmp;\n\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\n\treturn tmp;\n\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\n\treturn dot( weights, color.rgb );\n\n}\n\nbool isPerspectiveMatrix( mat4 m ) {\n\n  return m[ 2 ][ 3 ] == - 1.0;\n\n}\n",cube_uv_reflection_fragment="\n#ifdef ENVMAP_TYPE_CUBE_UV\n\n#define cubeUV_maxMipLevel 8.0\n#define cubeUV_minMipLevel 4.0\n#define cubeUV_maxTileSize 256.0\n#define cubeUV_minTileSize 16.0\nfloat getFace(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    float face = -1.0;\n    if (absDirection.x > absDirection.z) {\n      if (absDirection.x > absDirection.y)\n        face = direction.x > 0.0 ? 0.0 : 3.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    } else {\n      if (absDirection.z > absDirection.y)\n        face = direction.z > 0.0 ? 2.0 : 5.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    }\n    return face;\n}\n\nvec2 getUV(vec3 direction, float face) {\n    vec2 uv;\n    if (face == 0.0) {\n      uv = vec2(-direction.z, direction.y) / abs(direction.x);\n    } else if (face == 1.0) {\n      uv = vec2(direction.x, -direction.z) / abs(direction.y);\n    } else if (face == 2.0) {\n      uv = direction.xy / abs(direction.z);\n    } else if (face == 3.0) {\n      uv = vec2(direction.z, direction.y) / abs(direction.x);\n    } else if (face == 4.0) {\n      uv = direction.xz / abs(direction.y);\n    } else {\n      uv = vec2(-direction.x, direction.y) / abs(direction.z);\n    }\n    return 0.5 * (uv + 1.0);\n}\n\nvec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n  float face = getFace(direction);\n  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n  mipInt = max(mipInt, cubeUV_minMipLevel);\n  float faceSize = exp2(mipInt);\n\n  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n\n  vec2 uv = getUV(direction, face) * (faceSize - 1.0);\n  vec2 f = fract(uv);\n  uv += 0.5 - f;\n  if (face > 2.0) {\n    uv.y += faceSize;\n    face -= 3.0;\n  }\n  uv.x += face * faceSize;\n  if(mipInt < cubeUV_maxMipLevel){\n    uv.y += 2.0 * cubeUV_maxTileSize;\n  }\n  uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n  uv *= texelSize;\n\n  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x += texelSize;\n  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.y += texelSize;\n  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x -= texelSize;\n  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  vec3 tm = mix(tl, tr, f.x);\n  vec3 bm = mix(bl, br, f.x);\n  return mix(tm, bm, f.y);\n}\n#define r0 1.0\n#define v0 0.339\n#define m0 -2.0\n#define r1 0.8\n#define v1 0.276\n#define m1 -1.0\n#define r4 0.4\n#define v4 0.046\n#define m4 2.0\n#define r5 0.305\n#define v5 0.016\n#define m5 3.0\n#define r6 0.21\n#define v6 0.0038\n#define m6 4.0\n\nfloat roughnessToMip(float roughness) {\n  float mip = 0.0;\n  if (roughness >= r1) {\n    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n  } else if (roughness >= r4) {\n    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n  } else if (roughness >= r5) {\n    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n  } else if (roughness >= r6) {\n    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n  } else {\n    mip = -2.0 * log2(1.16 * roughness);\n  }\n  return mip;\n}\n\nvec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {\n  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);\n  float mipF = fract(mip);\n  float mipInt = floor(mip);\n\n  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);\n  if (mipF == 0.0) {\n    return vec4(color0, 1.0);\n  } else {\n    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);\n    return vec4(mix(color0, color1, mipF), 1.0);\n  }\n}\n#endif\n",defaultnormal_vertex="\nvec3 transformedNormal = objectNormal;\n\n#ifdef USE_INSTANCING\n\n\ttransformedNormal = mat3( instanceMatrix ) * transformedNormal;\n\n#endif\n\ntransformedNormal = normalMatrix * transformedNormal;\n\n#ifdef FLIP_SIDED\n\n\ttransformedNormal = - transformedNormal;\n\n#endif\n\n#ifdef USE_TANGENT\n\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\n\t#ifdef FLIP_SIDED\n\n\t\ttransformedTangent = - transformedTangent;\n\n\t#endif\n\n#endif\n",displacementmap_pars_vertex="\n#ifdef USE_DISPLACEMENTMAP\n\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n\n#endif\n",displacementmap_vertex="\n#ifdef USE_DISPLACEMENTMAP\n\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n\n#endif\n",emissivemap_fragment="\n#ifdef USE_EMISSIVEMAP\n\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n\n#endif\n",emissivemap_pars_fragment="\n#ifdef USE_EMISSIVEMAP\n\n\tuniform sampler2D emissiveMap;\n\n#endif\n",encodings_fragment="\ngl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment="\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\n\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\n\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\n\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\n\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\n\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\n\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\n\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\n\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}\n",envmap_fragment="\n#ifdef USE_ENVMAP\n\n\t#ifdef ENV_WORLDPOS\n\n\t\tvec3 cameraToFrag;\n\t\t\n\t\tif ( isOrthographic ) {\n\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\n\t\t}  else {\n\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\n\t\t#else\n\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\n\t\t#endif\n\n\t#else\n\n\t\tvec3 reflectVec = vReflect;\n\n\t#endif\n\n\t#ifdef ENVMAP_TYPE_CUBE\n\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\n\t\tvec2 sampleUV;\n\n\t\treflectVec = normalize( reflectVec );\n\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\n\t\treflectVec = normalize( reflectVec );\n\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\n\t#else\n\n\t\tvec4 envColor = vec4( 0.0 );\n\n\t#endif\n\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\n\t\tenvColor = envMapTexelToLinear( envColor );\n\n\t#endif\n\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\n\t#endif\n\n#endif\n",envmap_common_pars_fragment="\n#ifdef USE_ENVMAP\n\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif\n",envmap_pars_fragment="\n#ifdef USE_ENVMAP\n\n\tuniform float reflectivity;\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\t#define ENV_WORLDPOS\n\n\t#endif\n\n\t#ifdef ENV_WORLDPOS\n\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n\n#endif\n",envmap_pars_vertex="\n#ifdef USE_ENVMAP\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\n\t\t#define ENV_WORLDPOS\n\n\t#endif\n\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\n\t#else\n\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\n\t#endif\n\n#endif\n",envmap_vertex="\n#ifdef USE_ENVMAP\n\n\t#ifdef ENV_WORLDPOS\n\n\t\tvWorldPosition = worldPosition.xyz;\n\n\t#else\n\n\t\tvec3 cameraToVertex;\n\n\t\tif ( isOrthographic ) { \n\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\n\t\t} else {\n\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\n\t\t}\n\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\n\t\t#else\n\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t\t#endif\n\n\t#endif\n\n#endif\n",fog_vertex="\n#ifdef USE_FOG\n\n\tfogDepth = -mvPosition.z;\n\n#endif\n",fog_pars_vertex="\n#ifdef USE_FOG\n\n\tvarying float fogDepth;\n\n#endif\n",fog_fragment="\n#ifdef USE_FOG\n\n\t#ifdef FOG_EXP2\n\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\n\t#else\n\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\n\t#endif\n\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n\n#endif\n",fog_pars_fragment="\n#ifdef USE_FOG\n\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\n\t#ifdef FOG_EXP2\n\n\t\tuniform float fogDensity;\n\n\t#else\n\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\n\t#endif\n\n#endif\n",gradientmap_pars_fragment="\n\n#ifdef USE_GRADIENTMAP\n\n\tuniform sampler2D gradientMap;\n\n#endif\n\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\n\t#ifdef USE_GRADIENTMAP\n\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\n\t#else\n\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\n\t#endif\n\n}\n\n",lightmap_fragment="\n#ifdef USE_LIGHTMAP\n\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity; \n\n#endif\n",lightmap_pars_fragment="\n#ifdef USE_LIGHTMAP\n\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n\n#endif\n",lights_lambert_vertex="\nvec3 diffuse = vec3( 1.0 );\n\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\n\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\n\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\n\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n\n#if NUM_POINT_LIGHTS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\n\t\t#endif\n\n\t}\n\n#endif\n\n#if NUM_SPOT_LIGHTS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\n\t\t#endif\n\t}\n\n#endif\n#if NUM_DIR_LIGHTS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\n\t\t#endif\n\n\t}\n\n#endif\n\n#if NUM_HEMI_LIGHTS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\n\t\t#endif\n\n\t}\n\n#endif\n",lights_pars_begin="\nuniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\n\treturn result;\n\n}\n\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\n\treturn irradiance;\n\n}\n\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\n\tvec3 irradiance = ambientLightColor;\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *= PI;\n\n\t#endif\n\n\treturn irradiance;\n\n}\n\n#if NUM_DIR_LIGHTS > 0\n\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\n\t}\n\n#endif\n#if NUM_POINT_LIGHTS > 0\n\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\n\t\tfloat lightDistance = length( lVector );\n\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\n\t}\n\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\n\t\tif ( angleCos > spotLight.coneCos ) {\n\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\n\t\t} else {\n\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\n\t\t}\n\t}\n\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1; \n\tuniform sampler2D ltc_2; \n\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\t\tirradiance *= PI;\n\n\t\t#endif\n\n\t\treturn irradiance;\n\n\t}\n\n#endif\n",envmap_physical_pars_fragment="\n#if defined( USE_ENVMAP )\n\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\n\tvec3 getLightProbeIndirectIrradiance(  const in GeometricContext geometry, const in int maxMIPLevel ) {\n\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\n\t\t#else\n\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\n\t\t#endif\n\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\n\t}\n\n\tvec3 getLightProbeIndirectRadiance(  const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\n\t\t#else\n\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\n\t\t#endif\n\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\n\t\t\t#else\n\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\n\t\t\t#else\n\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\n\t\t\t#else\n\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#endif\n\n\t\treturn envMapColor.rgb * envMapIntensity;\n\n\t}\n\n#endif\n",lights_toon_fragment="\nToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_toon_pars_fragment="\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\nstruct ToonMaterial {\n\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n\n};\n\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *= PI; \n\n\t#endif\n\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n\n}\n\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n}\n\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n\n#define Material_LightProbeLOD( material )\t(0)\n",lights_phong_fragment="\nBlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment="\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\nstruct BlinnPhongMaterial {\n\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n\n};\n\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *= PI; \n\n\t#endif\n\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n\n}\n\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n}\n\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment="\nPhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\n\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\n\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );\nmaterial.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n\n#ifdef REFLECTIVITY\n\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\n#else\n\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n\n#endif\n\n#ifdef CLEARCOAT\n\n\tmaterial.clearcoat = saturate( clearcoat ); \n\tmaterial.clearcoatRoughness = max( clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n\n#endif\n#ifdef USE_SHEEN\n\n\tmaterial.sheenColor = sheen;\n\n#endif\n",lights_physical_pars_fragment="\nstruct PhysicalMaterial {\n\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n\n};\n\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n\n}\n\n#if NUM_RECT_AREA_LIGHTS > 0\n\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight; \n\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\n\t}\n\n#endif\n\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\n\tvec3 irradiance = dotNL * directLight.color;\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *= PI; \n\n\t#endif\n\n\t#ifdef CLEARCOAT\n\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\t\tccIrradiance *= PI; \n\n\t\t#endif\n\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\n\t#else\n\n\t\tfloat clearcoatDHR = 0.0;\n\n\t#endif\n\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n}\n\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\n\t#ifdef CLEARCOAT\n\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\n\t#else\n\n\t\tfloat clearcoatDHR = 0.0;\n\n\t#endif\n\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n\n}\n\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n\n}\n",lights_fragment_begin="\nGeometricContext geometry;\n\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n\n#ifdef CLEARCOAT\n\n\tgeometry.clearcoatNormal = clearcoatNormal;\n\n#endif\n\nIncidentLight directLight;\n\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tPointLight pointLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tpointLight = pointLights[ i ];\n\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tdirectLight.color *= all( bvec3( pointLight.shadow, directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\n#endif\n\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tSpotLight spotLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tspotLight = spotLights[ i ];\n\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tdirectLight.color *= all( bvec3( spotLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\n#endif\n\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tDirectionalLight directionalLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tdirectionalLight = directionalLights[ i ];\n\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectLight.color *= all( bvec3( directionalLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\n#endif\n\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\n\tRectAreaLight rectAreaLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\n\t}\n\n#endif\n\n#if defined( RE_IndirectDiffuse )\n\n\tvec3 iblIrradiance = vec3( 0.0 );\n\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\n\t\t}\n\n\t#endif\n\n#endif\n\n#if defined( RE_IndirectSpecular )\n\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n\n#endif\n",lights_fragment_maps="\n#if defined( RE_IndirectDiffuse )\n\n\t#ifdef USE_LIGHTMAP\n\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\t\tlightMapIrradiance *= PI; \n\n\t\t#endif\n\n\t\tirradiance += lightMapIrradiance;\n\n\t#endif\n\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\tiblIrradiance += getLightProbeIndirectIrradiance(  geometry, maxMipLevel );\n\n\t#endif\n\n#endif\n\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\n\tradiance += getLightProbeIndirectRadiance(  geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\n\t#ifdef CLEARCOAT\n\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance(  geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\n\t#endif\n\n#endif\n",lights_fragment_end="\n#if defined( RE_IndirectDiffuse )\n\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n\n#endif\n\n#if defined( RE_IndirectSpecular )\n\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n\n#endif\n",logdepthbuf_fragment="\n#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n\n#endif\n",logdepthbuf_pars_fragment="\n#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n\n#endif\n",logdepthbuf_pars_vertex="\n#ifdef USE_LOGDEPTHBUF\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\n\t#else\n\n\t\tuniform float logDepthBufFC;\n\n\t#endif\n\n#endif\n",logdepthbuf_vertex="\n#ifdef USE_LOGDEPTHBUF\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\n\t#else\n\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\n\t\t\tgl_Position.z *= gl_Position.w;\n\n\t\t}\n\n\t#endif\n\n#endif\n",map_fragment="\n#ifdef USE_MAP\n\n\tvec4 texelColor = texture2D( map, vUv );\n\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n\n#endif\n",map_pars_fragment="\n#ifdef USE_MAP\n\n\tuniform sampler2D map;\n\n#endif\n",map_particle_fragment="\n#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\n#endif\n\n#ifdef USE_MAP\n\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n\n#endif\n\n#ifdef USE_ALPHAMAP\n\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n\n#endif\n",map_particle_pars_fragment="\n#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\n\tuniform mat3 uvTransform;\n\n#endif\n\n#ifdef USE_MAP\n\n\tuniform sampler2D map;\n\n#endif\n\n#ifdef USE_ALPHAMAP\n\n\tuniform sampler2D alphaMap;\n\n#endif\n",metalnessmap_fragment="\nfloat metalnessFactor = metalness;\n\n#ifdef USE_METALNESSMAP\n\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n\n#endif\n",metalnessmap_pars_fragment="\n#ifdef USE_METALNESSMAP\n\n\tuniform sampler2D metalnessMap;\n\n#endif\n",morphnormal_vertex="\n#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\n#endif\n",morphtarget_pars_vertex="\n#ifdef USE_MORPHTARGETS\n\n\tuniform float morphTargetBaseInfluence;\n\n\t#ifndef USE_MORPHNORMALS\n\n\tuniform float morphTargetInfluences[ 8 ];\n\n\t#else\n\n\tuniform float morphTargetInfluences[ 4 ];\n\n\t#endif\n\n#endif\n",morphtarget_vertex="\n#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\n\t#ifndef USE_MORPHNORMALS\n\n\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\n\t#endif\n\n#endif\n",normal_fragment_begin="\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n\n#else\n\n\tvec3 normal = normalize( vNormal );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t#endif\n\n\t#ifdef USE_TANGENT\n\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t\t#endif\n\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\n\t\t#endif\n\n\t#endif\n\n#endif\nvec3 geometryNormal = normal;\n\n",normal_fragment_maps="\n\n#ifdef OBJECTSPACE_NORMALMAP\n\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0; \n\n\t#ifdef FLIP_SIDED\n\n\t\tnormal = - normal;\n\n\t#endif\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t#endif\n\n\tnormal = normalize( normalMatrix * normal );\n\n#elif defined( TANGENTSPACE_NORMALMAP )\n\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\n\t#ifdef USE_TANGENT\n\n\t\tnormal = normalize( vTBN * mapN );\n\n\t#else\n\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\n\t#endif\n\n#elif defined( USE_BUMPMAP )\n\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n\n#endif\n",normalmap_pars_fragment="\n#ifdef USE_NORMALMAP\n\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\n#endif\n\n#ifdef OBJECTSPACE_NORMALMAP\n\n\tuniform mat3 normalMatrix;\n\n#endif\n\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s ); \n\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\n\t\tmat3 tsn = mat3( S, T, N );\n\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t\treturn normalize( tsn * mapN );\n\n\t}\n\n#endif\n",clearcoat_normal_fragment_begin="\n#ifdef CLEARCOAT\n\n\tvec3 clearcoatNormal = geometryNormal;\n\n#endif\n",clearcoat_normal_fragment_maps="\n#ifdef USE_CLEARCOAT_NORMALMAP\n\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\n\t#ifdef USE_TANGENT\n\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\n\t#else\n\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\n\t#endif\n\n#endif\n",clearcoat_normalmap_pars_fragment="\n#ifdef USE_CLEARCOAT_NORMALMAP\n\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n\n#endif\n",packing="\nvec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\n\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\n\nconst float PackUpscale = 256. / 255.; \nconst float UnpackDownscale = 255. / 256.; \n\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\n\nconst float ShiftRight8 = 1. / 256.;\n\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8; \n\treturn r * PackUpscale;\n}\n\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\n\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\n\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment="\n#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n\n#endif\n",project_vertex="\nvec4 mvPosition = vec4( transformed, 1.0 );\n\n#ifdef USE_INSTANCING\n\n\tmvPosition = instanceMatrix * mvPosition;\n\n#endif\n\nmvPosition = modelViewMatrix * mvPosition;\n\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment="\n#ifdef DITHERING\n\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n\n#endif\n",dithering_pars_fragment="\n#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\t\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n\n#endif\n",roughnessmap_fragment="\nfloat roughnessFactor = roughness;\n\n#ifdef USE_ROUGHNESSMAP\n\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n\n#endif\n",roughnessmap_pars_fragment="\n#ifdef USE_ROUGHNESSMAP\n\n\tuniform sampler2D roughnessMap;\n\n#endif\n",shadowmap_pars_fragment="\n#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\n\t}\n\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\n\t}\n\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\n\t\tfloat occlusion = 1.0;\n\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\n\t\tfloat hard_shadow = step( compare , distribution.x ); \n\n\t\tif (hard_shadow != 1.0 ) {\n\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance ); \n\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); \n\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\n\t\t}\n\t\treturn occlusion;\n\n\t}\n\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\n\t\tfloat shadow = 1.0;\n\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n\t\tbool frustumTest = all( frustumTestVec );\n\n\t\tif ( frustumTest ) {\n\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\n\t\t#else \n\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\n\t\t#endif\n\n\t\t}\n\n\t\treturn shadow;\n\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\n\t\tif ( absV.z >= almostOne ) {\n\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\n\t\t} else if ( absV.x >= almostOne ) {\n\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\n\t\t} else if ( absV.y >= almostOne ) {\n\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\n\t}\n\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); \n\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\n\t\t#else \n\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\n\t\t#endif\n\n\t}\n\n#endif\n",shadowmap_pars_vertex="\n#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\n\t#endif\n#endif\n",shadowmap_vertex="\n#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\n\t}\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\n\t}\n\n\t#endif\n\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\n\t}\n\n\t#endif\n#endif\n",shadowmask_pars_fragment="\nfloat getShadowMask() {\n\n\tfloat shadow = 1.0;\n\n\t#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\n\tDirectionalLight directionalLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= all( bvec2( directionalLight.shadow, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\n\t}\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\n\tSpotLight spotLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= all( bvec2( spotLight.shadow, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\n\t}\n\n\t#endif\n\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\n\tPointLight pointLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= all( bvec2( pointLight.shadow, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\n\t}\n\n\t#endif\n\t#endif\n\n\treturn shadow;\n\n}\n",skinbase_vertex="\n#ifdef USE_SKINNING\n\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n\n#endif\n",skinning_pars_vertex="\n#ifdef USE_SKINNING\n\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\n\t#ifdef BONE_TEXTURE\n\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\n\t\t\ty = dy * ( y + 0.5 );\n\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\n\t\t\treturn bone;\n\n\t\t}\n\n\t#else\n\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\n\t\t}\n\n\t#endif\n\n#endif\n",skinning_vertex="\n#ifdef USE_SKINNING\n\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n\n#endif\n",skinnormal_vertex="\n#ifdef USE_SKINNING\n\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\n\t#ifdef USE_TANGENT\n\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\n\t#endif\n\n#endif\n",specularmap_fragment="\nfloat specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n\n#else\n\n\tspecularStrength = 1.0;\n\n#endif\n",specularmap_pars_fragment="\n#ifdef USE_SPECULARMAP\n\n\tuniform sampler2D specularMap;\n\n#endif\n",tonemapping_fragment="\n#if defined( TONE_MAPPING )\n\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n\n#endif\n",tonemapping_pars_fragment="\n#ifndef saturate\n\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\n\treturn toneMappingExposure * color;\n\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n\n}\n",uv_pars_fragment="\n#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\n\tvarying vec2 vUv;\n\n#endif\n",uv_pars_vertex="\n#ifdef USE_UV\n\n\t#ifdef UVS_VERTEX_ONLY\n\n\t\tvec2 vUv;\n\n\t#else\n\n\t\tvarying vec2 vUv;\n\n\t#endif\n\n\tuniform mat3 uvTransform;\n\n#endif\n",uv_vertex="\n#ifdef USE_UV\n\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\n#endif\n",uv2_pars_fragment="\n#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tvarying vec2 vUv2;\n\n#endif\n",uv2_pars_vertex="\n#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\n\tuniform mat3 uv2Transform;\n\n#endif\n",uv2_vertex="\n#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n\n#endif\n",worldpos_vertex="\n#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\n\t#ifdef USE_INSTANCING\n\n\t\tworldPosition = instanceMatrix * worldPosition;\n\n\t#endif\n\n\tworldPosition = modelMatrix * worldPosition;\n\n#endif\n",background_frag="\nuniform sampler2D t2D;\n\nvarying vec2 vUv;\n\nvoid main() {\n\n\tvec4 texColor = texture2D( t2D, vUv );\n\n\tgl_FragColor = mapTexelToLinear( texColor );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\n}\n",background_vert="\nvarying vec2 vUv;\nuniform mat3 uvTransform;\n\nvoid main() {\n\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n\n}\n",cube_frag="\n\n#include <envmap_common_pars_fragment>\nuniform float opacity;\n\nvarying vec3 vWorldDirection;\n\n#include <cube_uv_reflection_fragment>\n\nvoid main() {\n\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\n}\n",cube_vert="\nvarying vec3 vWorldDirection;\n\n#include <common>\n\nvoid main() {\n\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\n\tgl_Position.z = gl_Position.w; \n\n}\n",depth_frag="\n#if DEPTH_PACKING == 3200\n\n\tuniform float opacity;\n\n#endif\n\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( 1.0 );\n\n\t#if DEPTH_PACKING == 3200\n\n\t\tdiffuseColor.a = opacity;\n\n\t#endif\n\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\t#include <logdepthbuf_fragment>\n\n\t#if DEPTH_PACKING == 3200\n\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\n\t#elif DEPTH_PACKING == 3201\n\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\n\t#endif\n\n}\n",depth_vert="\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_DISPLACEMENTMAP\n\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n}\n",distanceRGBA_frag="\n#define DISTANCE\n\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main () {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( 1.0 );\n\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist ); \n\n\tgl_FragColor = packDepthToRGBA( dist );\n\n}\n",distanceRGBA_vert="\n#define DISTANCE\n\nvarying vec3 vWorldPosition;\n\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_DISPLACEMENTMAP\n\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvWorldPosition = worldPosition.xyz;\n\n}\n",equirect_frag="\nuniform sampler2D tEquirect;\n\nvarying vec3 vWorldDirection;\n\n#include <common>\n\nvoid main() {\n\n\tvec3 direction = normalize( vWorldDirection );\n\n\tvec2 sampleUV;\n\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\n\tgl_FragColor = mapTexelToLinear( texColor );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\n}\n",equirect_vert="\nvarying vec3 vWorldDirection;\n\n#include <common>\n\nvoid main() {\n\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\n}\n",linedashed_frag="\nuniform vec3 diffuse;\nuniform float opacity;\n\nuniform float dashSize;\nuniform float totalSize;\n\nvarying float vLineDistance;\n\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\n\t\tdiscard;\n\n\t}\n\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\n\toutgoingLight = diffuseColor.rgb; \n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\n}\n",linedashed_vert="\nuniform float scale;\nattribute float lineDistance;\n\nvarying float vLineDistance;\n\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <color_vertex>\n\n\tvLineDistance = scale * lineDistance;\n\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\n}\n",meshbasic_frag="\nuniform vec3 diffuse;\nuniform float opacity;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\n\t#else\n\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\n\t#endif\n\t#include <aomap_fragment>\n\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\n}\n",meshbasic_vert="\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_ENVMAP\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n\n}\n",meshlambert_frag="\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\n\t#else\n\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\n\t#endif\n\n\t#include <lightmap_fragment>\n\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\n\t#else\n\n\t\treflectedLight.directDiffuse = vLightFront;\n\n\t#endif\n\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert="\n#define LAMBERT\n\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshmatcap_frag="\n#define MATCAP\n\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; \n\n\t#ifdef USE_MATCAP\n\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\n\t#else\n\n\t\tvec4 matcapColor = vec4( 1.0 );\n\n\t#endif\n\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\n}\n",meshmatcap_vert="\n#define MATCAP\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#ifndef FLAT_SHADED \n\n\t\tvNormal = normalize( transformedNormal );\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n}\n",meshtoon_frag="\n#define TOON\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n",meshtoon_vert="\n#define TOON\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED \n\n\tvNormal = normalize( transformedNormal );\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n",meshphong_frag="\n#define PHONG\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n",meshphong_vert="\n#define PHONG\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED \n\n\tvNormal = normalize( transformedNormal );\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n",meshphysical_frag="\n#define STANDARD\n\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSPARENCY\n#endif\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n\n#ifdef TRANSPARENCY\n\tuniform float transparency;\n#endif\n\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSPARENCY\n\t\tdiffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n",meshphysical_vert="\n#define STANDARD\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED \n\n\tvNormal = normalize( transformedNormal );\n\n\t#ifdef USE_TANGENT\n\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\n\t#endif\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n",normal_frag="\n#define NORMAL\n\nuniform float opacity;\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\n\tvarying vec3 vViewPosition;\n\n#endif\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\n}\n",normal_vert="\n#define NORMAL\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\n\tvarying vec3 vViewPosition;\n\n#endif\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED \n\n\tvNormal = normalize( transformedNormal );\n\n\t#ifdef USE_TANGENT\n\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\n\t#endif\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\n\tvViewPosition = - mvPosition.xyz;\n\n#endif\n\n}\n",points_frag="\nuniform vec3 diffuse;\nuniform float opacity;\n\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\n\toutgoingLight = diffuseColor.rgb;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\n}\n",points_vert="\nuniform float size;\nuniform float scale;\n\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\n\tgl_PointSize = size;\n\n\t#ifdef USE_SIZEATTENUATION\n\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\n\t#endif\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n\n}\n",shadow_frag="\nuniform vec3 color;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n\nvoid main() {\n\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\n}\n",shadow_vert="\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n\nvoid main() {\n\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n",sprite_frag="\nuniform vec3 diffuse;\nuniform float opacity;\n\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\toutgoingLight = diffuseColor.rgb;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\n}\n",sprite_vert="\nuniform float rotation;\nuniform vec2 center;\n\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\n\t#ifndef USE_SIZEATTENUATION\n\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\n\t#endif\n\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\n\tmvPosition.xy += rotatedPosition;\n\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\n}\n",ShaderChunk={alphamap_fragment:alphamap_fragment,alphamap_pars_fragment:alphamap_pars_fragment,alphatest_fragment:alphatest_fragment,aomap_fragment:aomap_fragment,aomap_pars_fragment:aomap_pars_fragment,begin_vertex:begin_vertex,beginnormal_vertex:beginnormal_vertex,bsdfs:bsdfs,bumpmap_pars_fragment:bumpmap_pars_fragment,clipping_planes_fragment:clipping_planes_fragment,clipping_planes_pars_fragment:clipping_planes_pars_fragment,clipping_planes_pars_vertex:clipping_planes_pars_vertex,clipping_planes_vertex:clipping_planes_vertex,color_fragment:color_fragment,color_pars_fragment:color_pars_fragment,color_pars_vertex:color_pars_vertex,color_vertex:color_vertex,common:common,cube_uv_reflection_fragment:cube_uv_reflection_fragment,defaultnormal_vertex:defaultnormal_vertex,displacementmap_pars_vertex:displacementmap_pars_vertex,displacementmap_vertex:displacementmap_vertex,emissivemap_fragment:emissivemap_fragment,emissivemap_pars_fragment:emissivemap_pars_fragment,encodings_fragment:encodings_fragment,encodings_pars_fragment:encodings_pars_fragment,envmap_fragment:envmap_fragment,envmap_common_pars_fragment:envmap_common_pars_fragment,envmap_pars_fragment:envmap_pars_fragment,envmap_pars_vertex:envmap_pars_vertex,envmap_physical_pars_fragment:envmap_physical_pars_fragment,envmap_vertex:envmap_vertex,fog_vertex:fog_vertex,fog_pars_vertex:fog_pars_vertex,fog_fragment:fog_fragment,fog_pars_fragment:fog_pars_fragment,gradientmap_pars_fragment:gradientmap_pars_fragment,lightmap_fragment:lightmap_fragment,lightmap_pars_fragment:lightmap_pars_fragment,lights_lambert_vertex:lights_lambert_vertex,lights_pars_begin:lights_pars_begin,lights_toon_fragment:lights_toon_fragment,lights_toon_pars_fragment:lights_toon_pars_fragment,lights_phong_fragment:lights_phong_fragment,lights_phong_pars_fragment:lights_phong_pars_fragment,lights_physical_fragment:lights_physical_fragment,lights_physical_pars_fragment:lights_physical_pars_fragment,lights_fragment_begin:lights_fragment_begin,lights_fragment_maps:lights_fragment_maps,lights_fragment_end:lights_fragment_end,logdepthbuf_fragment:logdepthbuf_fragment,logdepthbuf_pars_fragment:logdepthbuf_pars_fragment,logdepthbuf_pars_vertex:logdepthbuf_pars_vertex,logdepthbuf_vertex:logdepthbuf_vertex,map_fragment:map_fragment,map_pars_fragment:map_pars_fragment,map_particle_fragment:map_particle_fragment,map_particle_pars_fragment:map_particle_pars_fragment,metalnessmap_fragment:metalnessmap_fragment,metalnessmap_pars_fragment:metalnessmap_pars_fragment,morphnormal_vertex:morphnormal_vertex,morphtarget_pars_vertex:morphtarget_pars_vertex,morphtarget_vertex:morphtarget_vertex,normal_fragment_begin:normal_fragment_begin,normal_fragment_maps:normal_fragment_maps,normalmap_pars_fragment:normalmap_pars_fragment,clearcoat_normal_fragment_begin:clearcoat_normal_fragment_begin,clearcoat_normal_fragment_maps:clearcoat_normal_fragment_maps,clearcoat_normalmap_pars_fragment:clearcoat_normalmap_pars_fragment,packing:packing,premultiplied_alpha_fragment:premultiplied_alpha_fragment,project_vertex:project_vertex,dithering_fragment:dithering_fragment,dithering_pars_fragment:dithering_pars_fragment,roughnessmap_fragment:roughnessmap_fragment,roughnessmap_pars_fragment:roughnessmap_pars_fragment,shadowmap_pars_fragment:shadowmap_pars_fragment,shadowmap_pars_vertex:shadowmap_pars_vertex,shadowmap_vertex:shadowmap_vertex,shadowmask_pars_fragment:shadowmask_pars_fragment,skinbase_vertex:skinbase_vertex,skinning_pars_vertex:skinning_pars_vertex,skinning_vertex:skinning_vertex,skinnormal_vertex:skinnormal_vertex,specularmap_fragment:specularmap_fragment,specularmap_pars_fragment:specularmap_pars_fragment,tonemapping_fragment:tonemapping_fragment,tonemapping_pars_fragment:tonemapping_pars_fragment,uv_pars_fragment:uv_pars_fragment,uv_pars_vertex:uv_pars_vertex,uv_vertex:uv_vertex,uv2_pars_fragment:uv2_pars_fragment,uv2_pars_vertex:uv2_pars_vertex,uv2_vertex:uv2_vertex,worldpos_vertex:worldpos_vertex,background_frag:background_frag,background_vert:background_vert,cube_frag:cube_frag,cube_vert:cube_vert,depth_frag:depth_frag,depth_vert:depth_vert,distanceRGBA_frag:distanceRGBA_frag,distanceRGBA_vert:distanceRGBA_vert,equirect_frag:equirect_frag,equirect_vert:equirect_vert,linedashed_frag:linedashed_frag,linedashed_vert:linedashed_vert,meshbasic_frag:meshbasic_frag,meshbasic_vert:meshbasic_vert,meshlambert_frag:meshlambert_frag,meshlambert_vert:meshlambert_vert,meshmatcap_frag:meshmatcap_frag,meshmatcap_vert:meshmatcap_vert,meshtoon_frag:meshtoon_frag,meshtoon_vert:meshtoon_vert,meshphong_frag:meshphong_frag,meshphong_vert:meshphong_vert,meshphysical_frag:meshphysical_frag,meshphysical_vert:meshphysical_vert,normal_frag:normal_frag,normal_vert:normal_vert,points_frag:points_frag,points_vert:points_vert,shadow_frag:shadow_frag,shadow_vert:shadow_vert,sprite_frag:sprite_frag,sprite_vert:sprite_vert},ShaderLib={basic:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.fog]),vertexShader:ShaderChunk.meshbasic_vert,fragmentShader:ShaderChunk.meshbasic_frag},lambert:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)}}]),vertexShader:ShaderChunk.meshlambert_vert,fragmentShader:ShaderChunk.meshlambert_frag},phong:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)},specular:{value:new Color(1118481)},shininess:{value:30}}]),vertexShader:ShaderChunk.meshphong_vert,fragmentShader:ShaderChunk.meshphong_frag},standard:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.envmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.roughnessmap,UniformsLib.metalnessmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag},toon:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.specularmap,UniformsLib.aomap,UniformsLib.lightmap,UniformsLib.emissivemap,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.gradientmap,UniformsLib.fog,UniformsLib.lights,{emissive:{value:new Color(0)},specular:{value:new Color(1118481)},shininess:{value:30}}]),vertexShader:ShaderChunk.meshtoon_vert,fragmentShader:ShaderChunk.meshtoon_frag},matcap:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,UniformsLib.fog,{matcap:{value:null}}]),vertexShader:ShaderChunk.meshmatcap_vert,fragmentShader:ShaderChunk.meshmatcap_frag},points:{uniforms:mergeUniforms([UniformsLib.points,UniformsLib.fog]),vertexShader:ShaderChunk.points_vert,fragmentShader:ShaderChunk.points_frag},dashed:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ShaderChunk.linedashed_vert,fragmentShader:ShaderChunk.linedashed_frag},depth:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap]),vertexShader:ShaderChunk.depth_vert,fragmentShader:ShaderChunk.depth_frag},normal:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.bumpmap,UniformsLib.normalmap,UniformsLib.displacementmap,{opacity:{value:1}}]),vertexShader:ShaderChunk.normal_vert,fragmentShader:ShaderChunk.normal_frag},sprite:{uniforms:mergeUniforms([UniformsLib.sprite,UniformsLib.fog]),vertexShader:ShaderChunk.sprite_vert,fragmentShader:ShaderChunk.sprite_frag},background:{uniforms:{uvTransform:{value:new Matrix3},t2D:{value:null}},vertexShader:ShaderChunk.background_vert,fragmentShader:ShaderChunk.background_frag},cube:{uniforms:mergeUniforms([UniformsLib.envmap,{opacity:{value:1}}]),vertexShader:ShaderChunk.cube_vert,fragmentShader:ShaderChunk.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ShaderChunk.equirect_vert,fragmentShader:ShaderChunk.equirect_frag},distanceRGBA:{uniforms:mergeUniforms([UniformsLib.common,UniformsLib.displacementmap,{referencePosition:{value:new Vector3},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ShaderChunk.distanceRGBA_vert,fragmentShader:ShaderChunk.distanceRGBA_frag},shadow:{uniforms:mergeUniforms([UniformsLib.lights,UniformsLib.fog,{color:{value:new Color(0)},opacity:{value:1}}]),vertexShader:ShaderChunk.shadow_vert,fragmentShader:ShaderChunk.shadow_frag}};ShaderLib.physical={uniforms:mergeUniforms([ShaderLib.standard.uniforms,{transparency:{value:0},clearcoat:{value:0},clearcoatRoughness:{value:0},sheen:{value:new Color(0)},clearcoatNormalScale:{value:new Vector2(1,1)},clearcoatNormalMap:{value:null}}]),vertexShader:ShaderChunk.meshphysical_vert,fragmentShader:ShaderChunk.meshphysical_frag};var RectAreaLightUniformsLib={init:function(){var d=new DataTexture(new Float32Array([1,0,0,2e-5,1,0,0,503905e-9,1,0,0,.00201562,1,0,0,.00453516,1,0,0,.00806253,1,0,0,.0125978,1,0,0,.018141,1,0,0,.0246924,1,0,0,.0322525,1,0,0,.0408213,1,0,0,.0503999,1,0,0,.0609894,1,0,0,.0725906,1,0,0,.0852058,1,0,0,.0988363,1,0,0,.113484,1,0,0,.129153,1,0,0,.145839,1,0,0,.163548,1,0,0,.182266,1,0,0,.201942,1,0,0,.222314,1,0,0,.241906,1,0,0,.262314,1,0,0,.285754,1,0,0,.310159,1,0,0,.335426,1,0,0,.361341,1,0,0,.387445,1,0,0,.412784,1,0,0,.438197,1,0,0,.466966,1,0,0,.49559,1,0,0,.523448,1,0,0,.549938,1,0,0,.57979,1,0,0,.608746,1,0,0,.636185,1,0,0,.664748,1,0,0,.69313,1,0,0,.71966,1,0,0,.747662,1,0,0,.774023,1,0,0,.799775,1,0,0,.825274,1,0,0,.849156,1,0,0,.873248,1,0,0,.89532,1,0,0,.917565,1,0,0,.937863,1,0,0,.958139,1,0,0,.976563,1,0,0,.994658,1,0,0,1.0112,1,0,0,1.02712,1,0,0,1.04189,1,0,0,1.05568,1,0,0,1.06877,1,0,0,1.08058,1,0,0,1.09194,1,0,0,1.10191,1,0,0,1.11161,1,0,0,1.1199,1,0,0,1.12813,.999547,-4.48815e-7,.0224417,199902e-10,.999495,-113079e-10,.0224406,503651e-9,.999496,-452317e-10,.0224406,.00201461,.999496,-101772e-9,.0224406,.00453287,.999495,-180928e-9,.0224406,.00805845,.999497,-282702e-9,.0224406,.0125914,.999496,-407096e-9,.0224406,.0181319,.999498,-554114e-9,.0224406,.02468,.999499,-723768e-9,.0224406,.0322363,.999495,-916058e-9,.0224405,.0408009,.999499,-.00113101,.0224408,.050375,.999494,-.00136863,.0224405,.0609586,.999489,-.00162896,.0224401,.0725537,.999489,-.00191201,.0224414,.0851619,.999498,-.00221787,.0224413,.0987867,.999492,-.00254642,.0224409,.113426,.999507,-.00289779,.0224417,.129088,.999494,-.0032716,.0224386,.145767,.999546,-.0036673,.0224424,.163472,.999543,-.00408166,.0224387,.182182,.999499,-.00450056,.0224338,.201843,.999503,-.00483661,.0224203,.222198,.999546,-.00452928,.022315,.241714,.999508,-.00587403,.0224329,.262184,.999509,-.00638806,.0224271,.285609,.999501,-.00691028,.0224166,.309998,.999539,-.00741979,.0223989,.335262,.999454,-.00786282,.0223675,.361154,.999529,-.00811928,.0222828,.387224,.999503,-.00799941,.0221063,.41252,.999561,-.00952753,.0223057,.438006,.999557,-.0099134,.0222065,.466735,.999541,-.0100935,.0220402,.495332,.999562,-.00996821,.0218067,.523197,.999556,-.0105031,.0217096,.550223,.999561,-.0114191,.0217215,.579498,.999588,-.0111818,.0213357,.608416,.999633,-.0107725,.0208689,.635965,.999527,-.0121671,.0210149,.664476,.999508,-.0116005,.020431,.692786,.999568,-.0115604,.0199791,.719709,.999671,-.0121117,.0197415,.74737,.999688,-.0110769,.0188846,.773692,.99962,-.0122368,.0188452,.799534,.999823,-.0110325,.0178001,.825046,.999599,-.0114923,.0174221,.849075,.999619,-.0105923,.0164345,.872999,.999613,-.0105988,.0158227,.895371,.99964,-.00979861,.0148131,.917364,.99977,-.00967238,.0140721,.938002,.999726,-.00869175,.0129543,.957917,.99973,-.00866872,.0122329,.976557,.999773,-.00731956,.0108958,.994459,.999811,-.00756027,.0102715,1.01118,.999862,-.00583732,.00878781,1.02701,.999835,-.00631438,.00827529,1.04186,.999871,-.00450785,.00674583,1.05569,.999867,-.00486079,.00621041,1.06861,.999939,-.00322072,.00478301,1.08064,.999918,-.00318199,.00406395,1.09181,1.00003,-.00193348,.00280682,1.10207,.999928,-.00153729,.00198741,1.11152,.999933,-623666e-9,917714e-9,1.12009,1,-102387e-11,9.07581e-7,1.12813,.997866,-8.96716e-7,.0448334,199584e-10,.997987,-225945e-10,.0448389,502891e-9,.997987,-903781e-10,.0448388,.00201156,.997985,-203351e-9,.0448388,.00452602,.997986,-361514e-9,.0448388,.00804629,.997987,-56487e-8,.0448389,.0125724,.997988,-813423e-9,.0448389,.0181045,.997984,-.00110718,.0448387,.0246427,.997985,-.00144616,.0448388,.0321875,.997987,-.00183038,.044839,.0407392,.997983,-.00225987,.0448387,.0502986,.997991,-.00273467,.0448389,.0608667,.997984,-.00325481,.0448384,.0724444,.998002,-.00382043,.044839,.0850348,.997997,-.00443145,.0448396,.0986372,.998007,-.00508796,.0448397,.113255,.998008,-.00578985,.04484,.128891,.998003,-.00653683,.0448384,.145548,.997983,-.00732713,.0448358,.163221,.997985,-.00815454,.0448358,.181899,.998005,-.00898985,.0448286,.201533,.998026,-.00964404,.0447934,.221821,.998055,-.00922677,.044611,.241282,.99804,-.0117361,.0448245,.261791,.998048,-.0127628,.0448159,.285181,.998088,-.0138055,.0447996,.30954,.998058,-.0148206,.0447669,.334751,.998099,-.0156998,.044697,.36061,.998116,-.0161976,.0445122,.386603,.998195,-.015945,.0441711,.411844,.998168,-.0183947,.0444255,.43773,.998184,-.0197913,.0443809,.466009,.998251,-.0201426,.0440689,.494574,.998305,-.0198847,.0435632,.522405,.998273,-.0210577,.043414,.549967,.998254,-.0227901,.0433943,.578655,.998349,-.0223108,.0426529,.60758,.99843,-.0223088,.042,.635524,.998373,-.0241141,.0418987,.663621,.998425,-.0231446,.0408118,.691906,.998504,-.0233684,.0400565,.719339,.998443,-.0241652,.0394634,.74643,.99848,-.0228715,.0380002,.773086,.998569,-.023519,.0372322,.798988,.998619,-.0223108,.0356468,.824249,.998594,-.0223105,.034523,.848808,.998622,-.0213426,.0328887,.87227,.998669,-.0207912,.0314374,.895157,.998705,-.0198416,.0296925,.916769,.998786,-.0189168,.0279634,.937773,.998888,-.0178811,.0261597,.957431,.99906,-.0166845,.0242159,.976495,.999038,-.0155464,.0222638,.994169,.999237,-.0141349,.0201967,1.01112,.999378,-.0129324,.0181744,1.02692,.999433,-.0113192,.0159898,1.04174,.999439,-.0101244,.0140385,1.05559,.999614,-.00837456,.0117826,1.06852,.999722,-.00721769,.00983745,1.08069,.999817,-.00554067,.00769002,1.09176,.99983,-.00426961,.005782,1.10211,.999964,-.00273904,.00374503,1.11152,1.00001,-.00136739,.00187176,1.12031,.999946,393227e-10,-28919e-9,1.12804,.995847,-13435e-10,.0671785,19916e-9,.995464,-338387e-10,.0671527,501622e-9,.99547,-135355e-9,.0671531,.00200649,.995471,-30455e-8,.0671532,.00451461,.99547,-541423e-9,.0671531,.008026,.995471,-84598e-8,.0671531,.0125407,.99547,-.00121823,.0671531,.0180589,.99547,-.00165817,.0671531,.0245806,.995463,-.00216583,.0671526,.0321062,.995468,-.00274127,.0671527,.0406366,.995474,-.00338447,.0671534,.0501717,.995473,-.00409554,.0671533,.0607131,.995478,-.00487451,.0671531,.0722618,.995476,-.00572148,.0671532,.0848191,.995477,-.00663658,.0671539,.0983882,.995498,-.00761986,.0671541,.112972,.995509,-.00867094,.0671542,.128568,.995509,-.00978951,.0671531,.145183,.995503,-.0109725,.0671491,.162808,.995501,-.012211,.0671465,.181441,.99553,-.0134565,.0671371,.201015,.99555,-.014391,.0670831,.221206,.99558,-.014351,.0668883,.240813,.995577,-.0173997,.0671055,.261257,.995602,-.0191111,.0671178,.284467,.995623,-.0206705,.0670946,.308765,.995658,-.022184,.0670472,.333905,.995705,-.0234832,.0669417,.359677,.995719,-.0241933,.0666714,.385554,.995786,-.0243539,.066266,.410951,.995887,-.0271866,.0664367,.437163,.995944,-.0296012,.0664931,.464842,.996004,-.0301045,.0660105,.49332,.996128,-.0298311,.0652694,.521131,.996253,-.0316426,.0650739,.549167,.996244,-.0339043,.0649433,.57737,.996309,-.033329,.0638926,.606073,.996417,-.0338935,.0630849,.634527,.996372,-.0353104,.0625083,.66256,.996542,-.0348942,.0611986,.690516,.996568,-.0351614,.060069,.718317,.996711,-.0354317,.0588522,.74528,.996671,-.0349513,.0571902,.772061,.996865,-.0345622,.0555321,.798089,.996802,-.0342566,.0537816,.823178,.996992,-.0330862,.0516095,.847949,.996944,-.0324666,.0495537,.871431,.997146,-.0309544,.0470302,.894357,.997189,-.0299372,.0446043,.916142,.997471,-.0281389,.0418812,.937193,.997515,-.0268702,.0391823,.957,.997812,-.0247166,.0361338,.975936,.998027,-.0233525,.0333945,.99391,.998233,-.0209839,.0301917,1.01075,.998481,-.0194309,.027271,1.02669,.998859,-.0169728,.0240162,1.04173,.99894,-.0152322,.0210517,1.05551,.999132,-.0127497,.0178632,1.06856,.999369,-.0108282,.014787,1.08054,.999549,-.00845886,.0116185,1.09185,.999805,-.0063937,.00867209,1.10207,.99985,-.00414582,.00566823,1.1117,.999912,-.00207443,.00277562,1.12022,1.00001,870226e-10,-53766e-9,1.12832,.991943,-178672e-11,.0893382,198384e-10,.991952,-450183e-10,.089339,499849e-9,.991956,-180074e-9,.0893394,.0019994,.991955,-405167e-9,.0893393,.00449867,.991953,-720298e-9,.0893391,.00799764,.991955,-.00112548,.0893393,.0124964,.991957,-.0016207,.0893395,.0179951,.991958,-.00220601,.0893396,.0244939,.991947,-.00288137,.0893385,.0319929,.991962,-.00364693,.0893399,.0404933,.991965,-.00450264,.0893399,.049995,.99198,-.00544862,.0893411,.0604995,.99197,-.00648491,.0893397,.0720074,.991976,-.00761164,.089341,.0845207,.99198,-.00882891,.0893405,.0980413,.991982,-.0101367,.0893396,.112571,.992008,-.011535,.0893415,.128115,.992026,-.0130228,.0893414,.144672,.992064,-.0145966,.0893418,.162241,.992041,-.0162421,.0893359,.180801,.992086,-.0178888,.0893214,.200302,.992157,-.0190368,.0892401,.220332,.992181,-.0195584,.0890525,.240144,.992175,-.0227257,.0892153,.260728,.99221,-.0254195,.089304,.283473,.99222,-.0274883,.0892703,.307673,.992317,-.0294905,.0892027,.332729,.992374,-.0311861,.0890577,.358387,.992505,-.0320656,.0886994,.384102,.992568,-.0329715,.0883198,.409767,.992675,-.036006,.0883602,.436145,.992746,-.0392897,.0884591,.463217,.992873,-.0399337,.0878287,.491557,.992934,-.040231,.0870108,.519516,.993091,-.0422013,.0865857,.547741,.993259,-.0443503,.0861937,.575792,.993455,-.0446368,.0851187,.604233,.993497,-.0454299,.0840576,.632925,.993694,-.0463296,.0829671,.660985,.993718,-.0470619,.0817185,.688714,.993973,-.0468838,.0800294,.716743,.994207,-.046705,.0781286,.74377,.994168,-.0469698,.0763337,.77042,.9945,-.0456816,.0738184,.796659,.994356,-.0455518,.0715545,.821868,.994747,-.0439488,.0686085,.846572,.994937,-.0430056,.065869,.870435,.995142,-.0413414,.0626446,.893272,.995451,-.0396521,.05929,.915376,.995445,-.0378453,.0558503,.936196,.995967,-.0355219,.0520949,.956376,.996094,-.0335146,.048377,.975327,.996622,-.030682,.0442575,.993471,.996938,-.0285504,.0404693,1.01052,.997383,-.0253399,.0360903,1.02637,.997714,-.0231651,.0322176,1.04139,.998249,-.0198138,.0278433,1.05542,.998596,-.0174337,.0238759,1.06846,.998946,-.0141349,.0195944,1.08056,.99928,-.0115603,.0156279,1.09181,.999507,-.00839065,.0114607,1.10213,.999697,-.005666,.00763325,1.11169,.999869,-.00269902,.00364946,1.12042,1.00001,623836e-10,-319288e-10,1.12832,.987221,-222675e-11,.111332,197456e-10,.98739,-561116e-10,.111351,497563e-9,.987448,-224453e-9,.111357,.00199031,.987441,-505019e-9,.111357,.0044782,.987442,-897816e-9,.111357,.00796129,.987442,-.00140284,.111357,.0124396,.987444,-.00202012,.111357,.0179132,.987442,-.00274964,.111357,.0243824,.987446,-.00359147,.111357,.0318474,.987435,-.00454562,.111356,.0403086,.987461,-.00561225,.111358,.0497678,.987458,-.00679125,.111358,.0602239,.987443,-.0080828,.111356,.0716792,.987476,-.0094872,.111358,.0841364,.98749,-.0110044,.111361,.097597,.987508,-.0126344,.111362,.112062,.987494,-.0143767,.111357,.127533,.987526,-.0162307,.111359,.144015,.987558,-.0181912,.111361,.161502,.987602,-.0202393,.111355,.179979,.987692,-.022273,.111346,.199386,.987702,-.0235306,.111215,.219183,.987789,-.0247628,.111061,.239202,.987776,-.0280668,.111171,.259957,.987856,-.0316751,.111327,.282198,.987912,-.0342468,.111282,.306294,.988,-.0367205,.111198,.331219,.988055,-.0387766,.110994,.356708,.988241,-.0397722,.110547,.382234,.988399,-.0416076,.110198,.408227,.988539,-.0448192,.110137,.434662,.988661,-.0483793,.110143,.461442,.988967,-.0495895,.109453,.489318,.989073,-.0506797,.108628,.517516,.989274,-.0526953,.108003,.545844,.989528,-.054578,.107255,.573823,.989709,-.0561503,.106294,.601944,.989991,-.056866,.104896,.630855,.990392,-.0572914,.103336,.658925,.990374,-.0586224,.10189,.686661,.990747,-.0584764,.099783,.714548,.991041,-.0582662,.0974309,.74186,.991236,-.0584118,.0951678,.768422,.991585,-.0573055,.0921581,.794817,.991984,-.0564241,.0891167,.820336,.9921,-.0553608,.085805,.84493,.992749,-.0533816,.0820354,.868961,.99288,-.0518661,.0782181,.891931,.993511,-.0492492,.0738935,.914186,.993617,-.0471956,.0696402,.93532,.99411,-.044216,.0649659,.95543,.994595,-.0416654,.0603177,.974685,.994976,-.0384314,.0553493,.992807,.995579,-.0353491,.0503942,1.00996,.996069,-.0319787,.0452123,1.02606,.996718,-.028472,.0400112,1.04114,.997173,-.0250789,.0349456,1.05517,.997818,-.0213326,.029653,1.0683,.998318,-.0178509,.024549,1.0805,.998853,-.0141118,.0194197,1.09177,.999218,-.0105914,.0143869,1.1022,.999594,-.00693474,.00943517,1.11175,.99975,-.00340478,.00464051,1.12056,1.00001,109172e-9,-112821e-9,1.12853,.983383,-266524e-11,.133358,196534e-10,.981942,-671009e-10,.133162,494804e-9,.981946,-268405e-9,.133163,.00197923,.981944,-603912e-9,.133163,.00445326,.981941,-.00107362,.133162,.00791693,.981946,-.00167755,.133163,.0123703,.981944,-.00241569,.133162,.0178135,.981945,-.00328807,.133163,.0242466,.981945,-.00429472,.133162,.03167,.981955,-.00543573,.133164,.0400846,.981951,-.00671105,.133163,.0494901,.981968,-.00812092,.133165,.0598886,.981979,-.00966541,.133166,.0712811,.981996,-.0113446,.133168,.083669,.982014,-.0131585,.133169,.0970533,.982011,-.0151073,.133167,.111438,.982062,-.0171906,.133172,.126826,.9821,-.0194067,.133175,.143215,.982149,-.0217502,.133176,.160609,.982163,-.0241945,.133173,.178981,.982247,-.0265907,.133148,.198249,.982291,-.027916,.132974,.217795,.982396,-.0299663,.132868,.238042,.982456,-.0334544,.132934,.258901,.982499,-.0378636,.133137,.280639,.982617,-.0409274,.133085,.304604,.98274,-.0438523,.132985,.329376,.982944,-.0462288,.132728,.354697,.98308,-.0475995,.132228,.380102,.983391,-.0501901,.131924,.406256,.983514,-.0535899,.131737,.432735,.98373,-.0571858,.131567,.459359,.984056,-.0592353,.130932,.486637,.984234,-.0610488,.130092,.51509,.984748,-.0630758,.12923,.543461,.985073,-.0647398,.128174,.571376,.985195,-.0671941,.127133,.599414,.985734,-.0681345,.125576,.628134,.986241,-.0686089,.123639,.656399,.986356,-.0698511,.121834,.684258,.986894,-.0700931,.119454,.711818,.987382,-.0698321,.116718,.739511,.988109,-.0693975,.113699,.766267,.988363,-.0689584,.110454,.792456,.989112,-.0672353,.106602,.81813,.989241,-.0662034,.10267,.842889,.990333,-.0638938,.0981381,.867204,.990591,-.0618534,.0935388,.89038,.991106,-.0593117,.088553,.912576,.991919,-.0562676,.0832187,.934118,.992111,-.0534085,.0778302,.954254,.992997,-.0495459,.0720453,.973722,.993317,-.0463707,.0663458,.991949,.994133,-.0421245,.0601883,1.00936,.994705,-.0384977,.0542501,1.02559,.995495,-.0340956,.0479862,1.04083,.996206,-.030105,.041887,1.05497,.996971,-.0256095,.0355355,1.06824,.997796,-.0213932,.0293655,1.08056,.998272,-.0169612,.0232926,1.09182,.998857,-.0126756,.0172786,1.10219,.99939,-.00832486,.0113156,1.11192,.999752,-.00410826,.00557892,1.12075,1,150957e-9,-119101e-9,1.12885,.975169,-309397e-11,.154669,195073e-10,.975439,-779608e-10,.154712,491534e-9,.975464,-311847e-9,.154716,.00196617,.975464,-701656e-9,.154716,.00442387,.975462,-.0012474,.154715,.0078647,.975461,-.00194906,.154715,.0122886,.975464,-.00280667,.154715,.0176959,.975468,-.00382025,.154716,.0240867,.975471,-.00498985,.154716,.0314612,.975472,-.00631541,.154717,.0398199,.975486,-.00779719,.154718,.0491639,.975489,-.00943505,.154718,.0594932,.975509,-.0112295,.154721,.0708113,.97554,-.0131802,.154724,.0831176,.975557,-.0152876,.154726,.096415,.975585,-.0175512,.154728,.110705,.975605,-.0199713,.154729,.125992,.975645,-.0225447,.154729,.142272,.975711,-.0252649,.154735,.159549,.975788,-.0280986,.154736,.177805,.975872,-.0308232,.154704,.196911,.975968,-.0324841,.154525,.216324,.976063,-.0351281,.154432,.236628,.976157,-.0388618,.15446,.257539,.976204,-.0437704,.154665,.278975,.976358,-.047514,.154652,.302606,.976571,-.0508638,.154535,.327204,.976725,-.0534995,.154221,.352276,.977013,-.0555547,.153737,.377696,.977294,-.0586728,.153403,.403855,.977602,-.0622715,.15312,.430333,.977932,-.0658166,.152755,.456855,.978241,-.0689877,.152233,.483668,.978602,-.0712805,.15132,.512097,.979234,-.0732775,.150235,.540455,.97977,-.075163,.148978,.568486,.979995,-.0778026,.147755,.596524,.98078,-.0791854,.146019,.624825,.981628,-.0799666,.143906,.653403,.982067,-.0808532,.141561,.681445,.98271,-.0816024,.139025,.708918,.983734,-.0812511,.135764,.736594,.98431,-.0806201,.132152,.763576,.985071,-.0801605,.12846,.789797,.98618,-.0784208,.124084,.815804,.986886,-.0766643,.1193,.840869,.987485,-.0747744,.114236,.864952,.988431,-.0716701,.108654,.888431,.988886,-.0691609,.102994,.910963,.990024,-.0654048,.0967278,.932629,.990401,-.0619765,.090384,.95313,.991093,-.0579296,.0837885,.972587,.992018,-.0536576,.0770171,.991184,.992536,-.0493719,.0701486,1.00863,.993421,-.0444813,.062953,1.02494,.993928,-.040008,.0560455,1.04017,.994994,-.0347982,.04856,1.05463,.995866,-.0301017,.0416152,1.06807,.996916,-.0248225,.0342597,1.08039,.997766,-.0199229,.0271668,1.09177,.998479,-.0147422,.0201387,1.10235,.99921,-.00980173,.0131944,1.11206,.999652,-.0047426,.00640712,1.12104,.999998,891673e-10,-10379e-8,1.12906,.967868,-351885e-11,.175947,193569e-10,.968001,-886733e-10,.175972,487782e-9,.96801,-354697e-9,.175973,.00195115,.968012,-798063e-9,.175974,.00439006,.968011,-.00141879,.175973,.00780461,.968011,-.00221686,.175973,.0121948,.968016,-.00319231,.175974,.0175607,.968019,-.00434515,.175974,.0239027,.968018,-.00567538,.175974,.0312208,.968033,-.00718308,.175977,.0395158,.968049,-.00886836,.175979,.0487885,.968047,-.0107312,.175978,.0590394,.968072,-.0127719,.175981,.0702705,.968108,-.0149905,.175986,.0824836,.968112,-.0173866,.175985,.0956783,.968173,-.0199611,.175993,.109862,.96827,-.0227128,.176008,.125033,.968292,-.025639,.17601,.141193,.968339,-.0287299,.176007,.158336,.968389,-.0319399,.176001,.176441,.968501,-.034941,.175962,.195359,.968646,-.0370812,.175793,.214686,.968789,-.0402329,.175708,.234973,.96886,-.0442601,.1757,.255871,.969013,-.049398,.175876,.277238,.969242,-.0539932,.17594,.300326,.969419,-.0577299,.175781,.324702,.969763,-.0605643,.175432,.349527,.970093,-.0634488,.174992,.374976,.970361,-.0670589,.174611,.401097,.970825,-.0708246,.174226,.427496,.971214,-.0742871,.173684,.453858,.971622,-.0782608,.173186,.480637,.972175,-.0813151,.172288,.508655,.972944,-.0832678,.170979,.536973,.973595,-.0855964,.169573,.565138,.974345,-.0882163,.168152,.593222,.975233,-.0901671,.166314,.621201,.976239,-.0912111,.163931,.649919,.977289,-.0916959,.161106,.678011,.978076,-.0927061,.158272,.705717,.979533,-.0925562,.15475,.733228,.980335,-.0918159,.150638,.760454,.981808,-.0908508,.146201,.786918,.983061,-.0896172,.141386,.812953,.984148,-.0871588,.135837,.838281,.985047,-.0850624,.130135,.862594,.986219,-.0818541,.123882,.88633,.987043,-.0784523,.117126,.908952,.988107,-.0749601,.110341,.930744,.988955,-.0703548,.102885,.951728,.989426,-.0662798,.0954167,.971166,.990421,-.0610834,.0876331,.989984,.991032,-.0562936,.0797785,1.00765,.992041,-.0508154,.0718166,1.02434,.992794,-.0454045,.0637125,1.03976,.993691,-.0398194,.0555338,1.05418,.994778,-.0341482,.0473388,1.06772,.995915,-.028428,.0391016,1.08028,.997109,-.022642,.0309953,1.09185,.998095,-.0168738,.0230288,1.10247,.998985,-.0111274,.0150722,1.11229,.999581,-.00543881,.00740605,1.12131,1.00003,162239e-9,-105549e-9,1.12946,.959505,-393734e-11,.196876,191893e-10,.959599,-992157e-10,.196895,483544e-9,.959641,-396868e-9,.196903,.0019342,.959599,-892948e-9,.196895,.00435193,.959603,-.00158747,.196896,.0077368,.959604,-.00248042,.196896,.0120888,.959605,-.00357184,.196896,.0174082,.959605,-.00486169,.196896,.0236949,.959613,-.00635008,.196897,.0309497,.959619,-.00803696,.196898,.0391725,.959636,-.00992255,.196901,.0483649,.959634,-.0120067,.1969,.0585266,.959675,-.0142898,.196906,.0696609,.959712,-.0167717,.196911,.0817678,.959752,-.0194524,.196918,.0948494,.959807,-.0223321,.196925,.10891,.959828,-.0254091,.196924,.123947,.959906,-.0286815,.196934,.139968,.960005,-.0321371,.196944,.156968,.960071,-.0357114,.196936,.17491,.960237,-.0389064,.196882,.193597,.960367,-.041623,.196731,.21285,.960562,-.0452655,.196654,.233075,.960735,-.0496207,.196643,.253941,.960913,-.0549379,.196774,.275278,.961121,-.0603414,.196893,.297733,.96139,-.0644244,.196717,.321877,.961818,-.067556,.196314,.346476,.962175,-.0712709,.195917,.371907,.96255,-.0752848,.1955,.397916,.963164,-.0792073,.195026,.424229,.963782,-.0828225,.194424,.450637,.964306,-.0873119,.193831,.477288,.964923,-.0911051,.192973,.504716,.966048,-.093251,.19151,.533053,.967024,-.0958983,.190013,.561366,.968038,-.09835,.188253,.589464,.969152,-.100754,.186257,.617433,.970557,-.102239,.183775,.645801,.972104,-.102767,.180645,.674278,.973203,-.103492,.177242,.702004,.975123,-.103793,.17345,.729529,.97641,-.102839,.168886,.756712,.978313,-.101687,.163892,.783801,.980036,-.100314,.158439,.809671,.981339,-.097836,.152211,.835402,.982794,-.0950006,.145679,.860081,.984123,-.0920994,.138949,.883757,.984918,-.0878641,.131283,.90685,.985999,-.083939,.123464,.928786,.987151,-.0791234,.115324,.94983,.987827,-.0739332,.106854,.96962,.988806,-.0688088,.0982691,.98861,.989588,-.0628962,.0893456,1.00667,.990438,-.0573146,.0805392,1.02344,.991506,-.0509433,.0713725,1.03933,.992492,-.0448724,.0623732,1.05378,.993663,-.0383497,.0530838,1.06747,.994956,-.0319593,.0439512,1.08007,.99634,-.025401,.0347803,1.09182,.99761,-.0189687,.0257954,1.1025,.99863,-.0124441,.0169893,1.11247,.99947,-.00614003,.00829498,1.12151,1.00008,216624e-9,-146107e-9,1.12993,.950129,-434955e-11,.217413,190081e-10,.950264,-10957e-8,.217444,47884e-8,.9503,-438299e-9,.217451,.00191543,.950246,-986124e-9,.21744,.00430951,.950246,-.00175311,.21744,.00766137,.950245,-.00273923,.21744,.011971,.950253,-.00394453,.217441,.0172385,.950258,-.00536897,.217442,.0234641,.950267,-.00701262,.217444,.030648,.950277,-.00887551,.217446,.038791,.950284,-.0109576,.217446,.0478931,.950312,-.0132591,.217451,.0579568,.950334,-.01578,.217454,.0689821,.950378,-.0185204,.217462,.0809714,.950417,-.0214803,.217467,.0939265,.950488,-.0246594,.217479,.10785,.950534,-.0280565,.217483,.122743,.950633,-.0316685,.217498,.138611,.950698,-.0354787,.217499,.155442,.950844,-.0394003,.217507,.173208,.950999,-.0426812,.217419,.191605,.951221,-.0461302,.217317,.21084,.951412,-.0502131,.217238,.230945,.951623,-.0549183,.21722,.251745,.951867,-.0604493,.217306,.273001,.952069,-.0665189,.217466,.294874,.952459,-.0709179,.217266,.318732,.952996,-.0746112,.216891,.34318,.953425,-.0789252,.216503,.36849,.953885,-.0833293,.216042,.394373,.954617,-.087371,.215469,.420505,.955429,-.0914054,.214802,.446907,.956068,-.0961671,.214146,.473522,.957094,-.10048,.213286,.50052,.958372,-.103248,.211796,.528715,.959654,-.106033,.21016,.557065,.961305,-.108384,.208149,.585286,.962785,-.111122,.206024,.613334,.964848,-.112981,.203442,.641334,.966498,-.113717,.19996,.669955,.968678,-.114121,.196105,.698094,.970489,-.114524,.191906,.725643,.972903,-.113792,.186963,.752856,.974701,-.112406,.181343,.780013,.976718,-.110685,.175185,.806268,.978905,-.108468,.168535,.832073,.980267,-.105061,.161106,.857149,.981967,-.101675,.153387,.881145,.983063,-.0974492,.145199,.904255,.984432,-.0925815,.136527,.926686,.985734,-.0877983,.127584,.947901,.986228,-.081884,.118125,.968111,.98719,-.0761208,.108594,.98719,.988228,-.0698196,.0989996,1.00559,.989046,-.0632739,.0890074,1.02246,.990242,-.056522,.0790832,1.03841,.991252,-.0495272,.0689182,1.05347,.992542,-.0425373,.0588592,1.06724,.994096,-.0353198,.0486833,1.08009,.995593,-.028235,.0385977,1.09177,.99711,-.0209511,.0286457,1.10274,.998263,-.0139289,.0188497,1.11262,.999254,-.0067359,.009208,1.12191,.999967,141846e-9,-657764e-10,1.13024,.935608,-474692e-11,.236466,187817e-10,.93996,-11971e-8,.237568,473646e-9,.939959,-478845e-9,.237567,.0018946,.939954,-.0010774,.237566,.00426284,.939956,-.00191538,.237566,.00757842,.939954,-.00299277,.237566,.0118413,.93996,-.00430961,.237567,.0170518,.939969,-.00586589,.237569,.02321,.939982,-.00766166,.237572,.0303164,.939987,-.00969686,.237572,.0383711,.939997,-.0119715,.237574,.0473751,.940031,-.0144858,.237581,.0573298,.940073,-.0172399,.237589,.0682366,.94012,-.0202335,.237598,.080097,.940162,-.0234663,.237604,.0929116,.940237,-.0269387,.237615,.106686,.940328,-.0306489,.237632,.121421,.940419,-.0345917,.237645,.137115,.940522,-.0387481,.237654,.153766,.940702,-.0429906,.237661,.17133,.940871,-.0465089,.237561,.189502,.941103,-.050531,.23748,.208616,.941369,-.0550657,.237423,.228595,.941641,-.0601337,.237399,.249287,.941903,-.0658804,.237443,.270467,.942224,-.0722674,.237597,.292024,.942633,-.0771788,.237419,.315272,.943172,-.0815623,.237068,.339579,.943691,-.0863973,.236682,.364717,.944382,-.0911536,.236213,.390435,.945392,-.0952967,.235562,.416425,.946185,-.0998948,.234832,.442772,.947212,-.104796,.234114,.469347,.948778,-.10928,.233222,.496162,.950149,-.113081,.231845,.523978,.951989,-.115893,.230005,.552295,.953921,-.11846,.227862,.580569,.955624,-.12115,.225439,.608698,.958234,-.123373,.222635,.636696,.960593,-.124519,.219093,.665208,.963201,-.124736,.214749,.693557,.965642,-.125012,.210059,.721334,.968765,-.124661,.204935,.748613,.971753,-.122996,.198661,.776224,.973751,-.120998,.191823,.802461,.976709,-.118583,.184359,.828399,.977956,-.115102,.176437,.853693,.979672,-.111077,.167681,.877962,.981816,-.10688,.158872,.901564,.98238,-.101469,.149398,.924057,.983964,-.0960013,.139436,.945751,.984933,-.0899626,.12943,.966272,.985694,-.0832973,.11894,.985741,.986822,-.0767082,.108349,1.00407,.987725,-.0693614,.0976026,1.02154,.98877,-.06211,.086652,1.03757,.990129,-.0544143,.0756182,1.05296,.991337,-.046744,.0645753,1.06683,.992978,-.0387931,.0534683,1.0798,.994676,-.030973,.0424137,1.09181,.99645,-.0230311,.0314035,1.10286,.997967,-.0152065,.0206869,1.11291,.99922,-.00744837,.010155,1.12237,1.00002,240209e-9,-752767e-10,1.13089,.922948,-515351e-11,.255626,186069e-10,.928785,-129623e-9,.257244,468009e-9,.928761,-51849e-8,.257237,.00187202,.928751,-.0011666,.257235,.00421204,.928751,-.00207395,.257234,.0074881,.928754,-.00324055,.257235,.0117002,.92876,-.00466639,.257236,.0168486,.928763,-.00635149,.257237,.0229334,.928774,-.00829584,.257239,.029955,.928791,-.0104995,.257243,.0379139,.928804,-.0129623,.257245,.0468108,.928847,-.0156846,.257255,.0566473,.92889,-.0186661,.257263,.0674246,.928924,-.0219067,.257268,.0791433,.928989,-.0254066,.257282,.0918076,.92909,-.0291651,.257301,.105419,.92918,-.0331801,.257316,.119978,.92929,-.0374469,.257332,.135491,.929453,-.041939,.257357,.151948,.929586,-.0464612,.257347,.169275,.929858,-.0503426,.257269,.187257,.930125,-.0548409,.257199,.206204,.930403,-.0598063,.257149,.22601,.930726,-.0652437,.257122,.246561,.931098,-.0712376,.257153,.267618,.931396,-.0777506,.257237,.288993,.931947,-.0832374,.257124,.311527,.932579,-.0883955,.25683,.335697,.933194,-.0937037,.256444,.360634,.934013,-.0987292,.255939,.386126,.935307,-.103215,.255282,.412018,.936374,-.108234,.254538,.438292,.93776,-.113234,.253728,.464805,.939599,-.118013,.25275,.491464,.941036,-.122661,.251404,.518751,.94337,-.125477,.249435,.547133,.945318,-.128374,.247113,.575456,.947995,-.130996,.244441,.60372,.950818,-.133438,.241352,.63174,.954378,-.135004,.237849,.659971,.957151,-.135313,.233188,.688478,.960743,-.13521,.228001,.716767,.964352,-.135007,.222249,.744349,.967273,-.133523,.21542,.771786,.969767,-.131155,.208039,.798639,.973195,-.128492,.200076,.824774,.975557,-.125094,.191451,.850222,.977692,-.120578,.18184,.874761,.98026,-.115882,.172102,.898497,.981394,-.110372,.161859,.921636,.982386,-.10415,.15108,.943467,.983783,-.0978128,.140407,.964045,.98422,-.0906171,.129058,.98398,.985447,-.0832921,.117614,1.00276,.986682,-.0754412,.10585,1.02047,.987326,-.0673885,.0940943,1.03678,.988707,-.0592565,.0822093,1.05218,.990185,-.050717,.070192,1.06652,.991866,-.0423486,.0582081,1.07965,.993897,-.0336118,.0460985,1.09188,.995841,-.0252178,.0342737,1.10307,.997605,-.0164893,.0224829,1.11324,.999037,-.00817112,.0110647,1.12262,1.00003,291686e-9,-168673e-9,1.13139,.915304,-552675e-11,.275999,183285e-10,.91668,-139285e-9,.276414,461914e-9,.916664,-55713e-8,.276409,.00184763,.916653,-.00125354,.276406,.00415715,.916651,-.00222851,.276405,.00739053,.916655,-.00348205,.276406,.0115478,.916653,-.00501414,.276405,.0166291,.916667,-.00682478,.276409,.0226346,.91668,-.00891398,.276412,.0295648,.91669,-.0112817,.276413,.0374199,.916727,-.013928,.276422,.0462016,.916759,-.0168528,.276429,.0559101,.916793,-.0200558,.276436,.0665466,.916849,-.0235373,.276448,.0781139,.916964,-.0272973,.276474,.0906156,.917047,-.0313344,.276491,.104051,.917152,-.0356465,.276511,.118424,.917286,-.0402271,.276533,.133736,.917469,-.0450408,.276564,.149978,.917686,-.0497872,.276563,.167057,.917953,-.0540937,.276493,.184846,.918228,-.0590709,.276437,.203614,.918572,-.0644277,.276398,.223212,.918918,-.0702326,.276362,.243584,.919356,-.076484,.276383,.264465,.919842,-.0830808,.276434,.285701,.920451,-.0892972,.276407,.307559,.921113,-.095016,.276128,.331501,.921881,-.100771,.275754,.356207,.923027,-.106029,.275254,.381477,.924364,-.111029,.274595,.40722,.925818,-.116345,.273841,.433385,.92746,-.121424,.272913,.459848,.929167,-.12657,.271837,.486493,.931426,-.131581,.270575,.513432,.934001,-.135038,.268512,.541502,.936296,-.138039,.266135,.569658,.939985,-.140687,.263271,.598375,.943516,-.143247,.260058,.626563,.94782,-.145135,.256138,.654711,.951023,-.145733,.251154,.683285,.955338,-.145554,.245562,.711831,.959629,-.145008,.239265,.739573,.963123,-.144003,.232064,.767027,.966742,-.141289,.224036,.794359,.969991,-.138247,.215305,.820361,.973403,-.134786,.206051,.846548,.975317,-.129966,.195914,.871541,.977647,-.12471,.185184,.895313,.980137,-.119086,.174161,.918398,.981031,-.112297,.162792,.940679,.982037,-.105372,.150952,.961991,.983164,-.097821,.138921,.981913,.983757,-.0897245,.126611,1.00109,.985036,-.0815974,.114228,1.01902,.986289,-.0727725,.101389,1.03604,.987329,-.0639323,.0886476,1.05149,.989193,-.0548109,.0756837,1.06619,.990716,-.045687,.0627581,1.07948,.992769,-.0364315,.0498337,1.09172,.99524,-.0271761,.0370305,1.1033,.997154,-.0179609,.0243959,1.11353,.998845,-.00878063,.0119567,1.12319,1.00002,259038e-9,-108146e-9,1.13177,.903945,-591681e-11,.295126,181226e-10,.903668,-148672e-9,.295037,455367e-9,.903677,-594683e-9,.29504,.00182145,.903673,-.00133805,.295039,.00409831,.903666,-.00237872,.295036,.00728584,.903668,-.00371676,.295037,.0113842,.903679,-.00535212,.29504,.0163936,.903684,-.00728479,.295041,.0223141,.903698,-.00951473,.295044,.0291462,.903718,-.0120419,.295049,.0368904,.903754,-.0148664,.295058,.0455477,.903801,-.017988,.29507,.0551194,.903851,-.0214064,.295082,.0656058,.903921,-.0251219,.295097,.0770109,.904002,-.0291337,.295116,.0893354,.904111,-.033441,.29514,.102583,.904246,-.0380415,.295169,.116755,.904408,-.0429258,.295202,.131853,.904637,-.0480468,.295245,.147869,.904821,-.0529208,.295214,.164658,.905163,-.0577748,.295185,.182274,.905469,-.0631763,.295143,.200828,.905851,-.068917,.295112,.2202,.906322,-.0750861,.295104,.240372,.906761,-.0815855,.295086,.261082,.90735,-.0882138,.295095,.282123,.908087,-.095082,.295139,.303563,.908826,-.101488,.29492,.327028,.909832,-.107577,.294577,.351464,.911393,-.113033,.294115,.376497,.912804,-.118629,.293446,.402115,.914081,-.124232,.292581,.428111,.91637,-.129399,.29166,.454442,.91814,-.134892,.290422,.481024,.921179,-.140069,.289194,.507924,.924544,-.144431,.287421,.535557,.927995,-.147498,.284867,.563984,.931556,-.150197,.281722,.5923,.935777,-.152711,.278207,.620832,.940869,-.154836,.274148,.649069,.945994,-.155912,.269057,.677746,.949634,-.155641,.262799,.706293,.955032,-.154809,.256097,.734278,.95917,-.153678,.248618,.761751,.962931,-.151253,.239794,.789032,.966045,-.147625,.230281,.815422,.96971,-.143964,.220382,.841787,.972747,-.139464,.209846,.867446,.975545,-.133459,.198189,.892004,.978381,-.127424,.186362,.915458,.979935,-.120506,.173964,.937948,.980948,-.11282,.161429,.959732,.982234,-.104941,.148557,.980118,.982767,-.0962905,.135508,.999463,.983544,-.0873625,.122338,1.01756,.984965,-.0783447,.108669,1.03492,.986233,-.0684798,.0949911,1.05087,.987796,-.0590867,.0811386,1.0656,.989885,-.0489145,.0673099,1.0794,.991821,-.0391,.0535665,1.09174,.99448,-.029087,.0397529,1.10341,.996769,-.019114,.0261463,1.11383,.998641,-.00947007,.0128731,1.1237,.999978,446316e-9,-169093e-9,1.13253,.888362,-627064e-11,.312578,178215e-10,.889988,-157791e-9,.313148,448451e-9,.889825,-631076e-9,.313092,.00179356,.88984,-.00141994,.313097,.00403554,.889828,-.0025243,.313092,.00717429,.889831,-.00394421,.313093,.0112099,.889831,-.00567962,.313093,.0161425,.889844,-.00773051,.313096,.0219724,.889858,-.0100968,.3131,.0286999,.889882,-.0127786,.313106,.0363256,.889918,-.0157757,.313116,.0448509,.889967,-.0190878,.313129,.0542758,.89003,-.022715,.313145,.0646032,.890108,-.0266566,.313165,.0758339,.890218,-.0309131,.313193,.0879729,.890351,-.0354819,.313226,.101019,.89051,-.0403613,.313263,.114979,.890672,-.0455385,.313294,.129848,.890882,-.0509444,.313333,.145616,.891189,-.0559657,.313324,.162122,.891457,-.0613123,.313281,.179524,.891856,-.0671488,.313281,.197855,.892312,-.0732732,.313268,.216991,.892819,-.0797865,.313263,.236924,.893369,-.0865269,.313247,.257433,.894045,-.0931592,.313205,.278215,.894884,-.100532,.313276,.299467,.895832,-.107716,.313205,.322276,.897043,-.114099,.312873,.34642,.898515,-.119941,.312331,.371187,.900191,-.126044,.311731,.396656,.90188,-.131808,.310859,.422488,.904359,-.137289,.309857,.448744,.906923,-.142991,.308714,.475239,.910634,-.148253,.307465,.501983,.914502,-.153332,.305774,.529254,.919046,-.156646,.303156,.557709,.923194,-.159612,.299928,.586267,.928858,-.162027,.296245,.614925,.934464,-.164203,.291832,.643187,.939824,-.165602,.286565,.671601,.944582,-.165383,.280073,.700213,.949257,-.164439,.272891,.728432,.954389,-.162953,.264771,.756082,.958595,-.161007,.255927,.78369,.962138,-.157243,.245769,.810769,.966979,-.152872,.235127,.836999,.969566,-.148209,.22347,.862684,.972372,-.142211,.211147,.887847,.975916,-.135458,.198606,.911843,.978026,-.128398,.185498,.934795,.979686,-.120313,.17171,.956787,.980748,-.11166,.158159,.978046,.981622,-.103035,.144399,.997693,.982356,-.0930328,.13001,1.01642,.983308,-.0834627,.115778,1.03366,.985037,-.0732249,.101327,1.05014,.986493,-.0628145,.086554,1.06507,.988484,-.0526556,.0720413,1.07907,.991051,-.0415744,.0571151,1.09189,.993523,-.0314275,.0426643,1.10369,.99628,-.0203603,.0279325,1.11423,.998344,-.0102446,.0138182,1.12421,.999997,42612e-8,-193628e-9,1.1333,.871555,-660007e-11,.329176,174749e-10,.875255,-166579e-9,.330571,441051e-9,.875644,-666394e-9,.330718,.00176441,.875159,-.00149903,.330536,.00396899,.87516,-.00266493,.330536,.007056,.875158,-.00416393,.330535,.0110251,.87516,-.00599598,.330535,.0158764,.875163,-.00816108,.330536,.0216101,.875174,-.0106591,.330538,.0282266,.875199,-.0134899,.330545,.0357266,.875257,-.0166538,.330563,.0441117,.875304,-.0201501,.330575,.0533821,.875373,-.0239785,.330595,.0635395,.875464,-.0281389,.330619,.0745872,.875565,-.0326301,.330645,.0865255,.875691,-.0374516,.330676,.0993599,.875897,-.0425993,.330733,.113093,.876091,-.0480576,.330776,.127722,.876353,-.0537216,.330826,.143227,.876649,-.0589807,.330809,.159462,.877034,-.0647865,.330819,.176642,.877443,-.0709789,.330817,.194702,.877956,-.0774782,.330832,.213577,.878499,-.0843175,.330822,.233246,.879144,-.0912714,.330804,.253512,.879982,-.0980824,.330766,.274137,.88097,-.105823,.330864,.295209,.882051,-.113671,.330896,.317226,.883397,-.120303,.330545,.341068,.884987,-.12667,.330068,.365613,.886789,-.133118,.329418,.390807,.889311,-.139024,.328683,.416494,.891995,-.144971,.327729,.442618,.895106,-.150747,.326521,.469131,.899527,-.156283,.325229,.495921,.90504,-.161707,.32378,.523162,.909875,-.165661,.32122,.55092,.91561,-.168755,.317942,.579928,.921225,-.171193,.313983,.608539,.927308,-.17319,.309636,.636854,.933077,-.174819,.304262,.66523,.938766,-.175002,.297563,.693609,.943667,-.173946,.289613,.722157,.949033,-.172221,.281227,.750021,.953765,-.169869,.271545,.777466,.95804,-.166578,.261034,.804853,.962302,-.161761,.249434,.831569,.966544,-.156636,.237484,.857779,.969372,-.150784,.224395,.883051,.972486,-.143672,.210786,.907864,.975853,-.135772,.196556,.931223,.977975,-.127942,.182307,.954061,.979122,-.118347,.167607,.97531,.980719,-.109112,.152739,.995666,.981223,-.0991789,.137932,1.01475,.98216,-.0883553,.122692,1.03253,.983379,-.0780825,.107493,1.04917,.985434,-.0665646,.0917791,1.06464,.987332,-.0557714,.0764949,1.07896,.990004,-.0442805,.060721,1.09199,.992975,-.0331676,.0452284,1.10393,.995811,-.0219547,.0297934,1.11476,.9982,-.0107613,.0146415,1.12484,1.00002,248678e-9,-14555e-8,1.13413,.859519,-693595e-11,.347264,171673e-10,.859843,-17503e-8,.347394,433219e-9,.859656,-700076e-9,.347319,.00173277,.859671,-.00157517,.347325,.00389875,.859669,-.00280028,.347324,.00693112,.85967,-.0043754,.347324,.01083,.859665,-.00630049,.347321,.0155954,.859685,-.0085755,.347328,.0212278,.859694,-.0112003,.347329,.0277273,.859718,-.0141747,.347336,.0350946,.85976,-.0174988,.347348,.0433314,.85982,-.0211722,.347366,.0524384,.859892,-.0251941,.347387,.0624168,.860006,-.0295649,.347422,.0732708,.860122,-.0342825,.347453,.0849999,.860282,-.0393462,.347499,.0976102,.860482,-.0447513,.347554,.111104,.860719,-.0504775,.347614,.125479,.860998,-.0563577,.347666,.140703,.861322,-.0619473,.347662,.156681,.861724,-.0681277,.347684,.173597,.862198,-.0746567,.347709,.191371,.862733,-.0815234,.347727,.209976,.863371,-.0886643,.347744,.229351,.86414,-.0957908,.347734,.24934,.865138,-.102912,.34772,.269797,.866182,-.110924,.3478,.290654,.867436,-.119223,.347911,.312074,.869087,-.126197,.347649,.335438,.870859,-.133145,.347222,.359732,.872997,-.139869,.346645,.38467,.875939,-.146089,.345935,.41019,.879012,-.152334,.345012,.436218,.883353,-.15821,.343924,.462641,.888362,-.164097,.342636,.489449,.895026,-.169528,.341351,.516629,.900753,-.174408,.339115,.544109,.906814,-.17751,.335809,.572857,.912855,-.180101,.331597,.601554,.919438,-.182116,.32698,.630198,.925962,-.183494,.321449,.658404,.931734,-.184159,.314595,.686625,.93762,-.18304,.306462,.71531,.943858,-.181323,.297514,.744272,.948662,-.178683,.287447,.771462,.953299,-.175379,.276166,.798593,.957346,-.170395,.263758,.8256,.962565,-.165042,.251019,.852575,.966075,-.158655,.237011,.878316,.969048,-.151707,.222518,.90329,.972423,-.143271,.207848,.927745,.975833,-.134824,.192463,.950859,.977629,-.125444,.1768,.972947,.978995,-.114949,.161033,.993263,.980533,-.104936,.145523,1.01337,.980745,-.0935577,.129799,1.03128,.981814,-.0822956,.113486,1.04825,.983943,-.0710082,.0972925,1.06405,.986141,-.0587931,.0808138,1.0785,.988878,-.0472755,.0644915,1.09204,.992132,-.0349128,.0478128,1.10413,.9953,-.0232407,.031621,1.11527,.998117,-.0112713,.0154935,1.12551,1.00003,339743e-9,-195763e-9,1.13504,.845441,-729126e-11,.364305,169208e-10,.843588,-183164e-9,.363506,425067e-9,.843412,-73253e-8,.36343,.00169999,.843401,-.00164818,.363426,.00382495,.843399,-.00293008,.363425,.00679993,.843401,-.00457822,.363425,.010625,.843394,-.00659249,.363421,.0153002,.843398,-.00897282,.363421,.0208258,.843415,-.0117191,.363426,.0272024,.843438,-.0148312,.363432,.0344305,.843483,-.018309,.363447,.0425116,.84356,-.0221521,.363472,.0514471,.843646,-.0263597,.363499,.061238,.843743,-.0309315,.363527,.0718873,.84388,-.0358658,.363569,.0833969,.844079,-.0411624,.363631,.0957742,.844279,-.0468128,.363688,.109015,.844549,-.0527923,.363761,.123124,.844858,-.0588204,.363817,.138044,.84522,-.0647573,.36383,.153755,.845669,-.0713181,.363879,.170394,.846155,-.0781697,.363908,.187861,.846789,-.0853913,.363969,.206176,.847502,-.0928086,.363999,.225244,.8484,-.10005,.363997,.244926,.849461,-.107615,.364008,.265188,.850562,-.115814,.364055,.28587,.851962,-.124334,.364179,.306926,.854326,-.131995,.364233,.329605,.856295,-.139338,.363856,.35359,.858857,-.146346,.363347,.37831,.862428,-.152994,.362807,.403722,.866203,-.159463,.361963,.429537,.871629,-.165623,.36112,.456,.877365,-.171649,.359917,.482773,.883744,-.177151,.35848,.509705,.890693,-.182381,.356523,.537215,.897278,-.186076,.3533,.565493,.903958,-.188602,.349095,.594293,.910908,-.190755,.344215,.623165,.918117,-.192063,.338606,.651573,.924644,-.192758,.331544,.679869,.931054,-.192238,.323163,.708668,.937303,-.190035,.313529,.737201,.943387,-.187162,.303152,.764977,.948494,-.183876,.29146,.792683,.952546,-.178901,.277917,.819228,.958077,-.173173,.264753,.846559,.962462,-.16645,.25002,.872962,.966569,-.159452,.234873,.898729,.969108,-.15074,.218752,.923126,.973072,-.141523,.202673,.947278,.975452,-.132075,.186326,.969938,.977784,-.121257,.169396,.991325,.97899,-.110182,.153044,1.01123,.979777,-.0989634,.136485,1.0299,.980865,-.0865894,.119343,1.04727,.982432,-.0746115,.102452,1.06341,.984935,-.0621822,.0852423,1.07834,.987776,-.0495694,.0678546,1.092,.99103,-.0372386,.0506917,1.1043,.99474,-.0244353,.0333316,1.11576,.997768,-.0121448,.0164348,1.12617,1.00003,31774e-8,-169504e-9,1.13598,.825551,-756799e-11,.378425,165099e-10,.82664,-190922e-9,.378923,416504e-9,.826323,-763495e-9,.378779,.0016656,.826359,-.00171789,.378795,.00374768,.82636,-.00305402,.378795,.00666259,.826368,-.00477185,.378798,.0104104,.826364,-.00687131,.378795,.0149912,.826368,-.00935232,.378795,.0204054,.826376,-.0122146,.378797,.0266532,.826399,-.0154581,.378803,.0337355,.82646,-.0190825,.378824,.0416537,.826525,-.0230873,.378846,.0504091,.826614,-.0274719,.378876,.0600032,.82674,-.0322355,.378917,.0704393,.826888,-.0373766,.378964,.0817195,.827078,-.0428936,.379024,.0938492,.827318,-.0487778,.379099,.106828,.82764,-.0549935,.379199,.120659,.827926,-.0611058,.379227,.13526,.828325,-.0675054,.379275,.150713,.828801,-.0743455,.379332,.167034,.8294,-.0815523,.379415,.184209,.830094,-.0890779,.379495,.202203,.8309,-.096736,.379555,.220945,.831943,-.104135,.379577,.240306,.833037,-.112106,.379604,.260317,.834278,-.120554,.379668,.2808,.836192,-.129128,.3799,.301654,.838671,-.137541,.380109,.323502,.840939,-.14523,.379809,.347176,.844575,-.15248,.379593,.371706,.848379,-.159607,.37909,.39688,.853616,-.166267,.378617,.422702,.858921,-.172698,.377746,.448919,.865324,-.178823,.376749,.475661,.872207,-.184542,.375363,.502599,.880018,-.189836,.373657,.529914,.88694,-.194294,.370673,.557683,.894779,-.197022,.36662,.586848,.902242,-.199108,.36138,.615831,.909914,-.200398,.355434,.644478,.917088,-.20094,.348173,.672905,.923888,-.200671,.339482,.701327,.930495,-.198773,.32956,.730101,.937247,-.195394,.318363,.758383,.943108,-.191956,.306323,.786539,.948296,-.187227,.292576,.813637,.953472,-.181165,.278234,.840793,.958485,-.174119,.263054,.867712,.962714,-.166564,.246756,.893635,.966185,-.158181,.229945,.919028,.970146,-.148275,.212633,.943413,.973491,-.138157,.195229,.966627,.975741,-.127574,.178048,.988817,.977238,-.11554,.160312,1.00924,.978411,-.10364,.142857,1.02845,.979811,-.0913122,.125317,1.04648,.98116,-.0782558,.107627,1.06284,.983543,-.0655957,.0895862,1.07798,.986789,-.0520411,.0713756,1.092,.990292,-.0389727,.053228,1.10484,.994187,-.025808,.0351945,1.11642,.997499,-.0126071,.0173198,1.12703,.999999,275604e-9,-148602e-9,1.13674,.81075,-78735e-10,.394456,161829e-10,.808692,-198293e-9,.393453,407564e-9,.80846,-792877e-9,.39334,.00162965,.808595,-.00178416,.393407,.00366711,.808597,-.00317182,.393408,.00651934,.808598,-.00495589,.393408,.0101866,.808591,-.00713627,.393403,.0146689,.808592,-.00971285,.393402,.0199667,.80861,-.0126855,.393407,.0260803,.808633,-.0160538,.393413,.0330107,.80868,-.0198175,.393429,.0407589,.808748,-.0239758,.393453,.0493264,.808854,-.0285286,.39349,.0587161,.808992,-.0334748,.39354,.0689304,.809141,-.0388116,.393588,.0799707,.809352,-.0445375,.39366,.0918432,.809608,-.0506427,.393742,.104549,.809915,-.0570708,.393834,.118085,.810253,-.0633526,.393885,.132377,.810687,-.0700966,.393953,.147537,.811233,-.0772274,.394047,.163543,.811865,-.0847629,.394148,.180394,.812648,-.0925663,.394265,.198051,.813583,-.100416,.394363,.216443,.814683,-.108119,.394402,.235502,.815948,-.11644,.394489,.255242,.817278,-.125036,.394542,.275441,.819605,-.133655,.39486,.296094,.822256,-.142682,.395248,.317309,.825349,-.150756,.395241,.340516,.829605,-.158392,.395285,.364819,.83391,-.165801,.394922,.389736,.839808,-.172677,.394691,.415409,.845708,-.179448,.394006,.441546,.853025,-.185746,.393279,.46832,.859666,-.191684,.391655,.495302,.86789,-.197146,.390068,.52262,.875845,-.201904,.38727,.550336,.882634,-.205023,.382688,.578825,.891076,-.207098,.377543,.608103,.900589,-.208474,.371752,.63723,.90791,-.209068,.364016,.665769,.915971,-.208655,.355593,.694428,.923455,-.20729,.345439,.723224,.931514,-.203821,.334099,.751925,.937885,-.19986,.321069,.780249,.943136,-.194993,.306571,.8077,.948818,-.189132,.291556,.83497,.954433,-.181617,.275745,.86188,.959078,-.173595,.258695,.888562,.962705,-.164855,.240825,.914008,.966753,-.155129,.22268,.939145,.970704,-.144241,.204542,.963393,.973367,-.133188,.185927,.985983,.975984,-.121146,.167743,1.00704,.976994,-.108366,.149218,1.02715,.978485,-.0956746,.13131,1.0455,.980074,-.0820733,.112513,1.06221,.98225,-.0684061,.0938323,1.07782,.98553,-.0549503,.0749508,1.09199,.989529,-.0407857,.055848,1.10508,.993536,-.0271978,.0368581,1.11684,.997247,-.0132716,.0181845,1.12789,1,431817e-9,-198809e-9,1.13792,.785886,-812608e-11,.405036,157669e-10,.790388,-205278e-9,.407355,398297e-9,.790145,-820824e-9,.407231,.00159263,.790135,-.00184681,.407226,.00358336,.790119,-.00328316,.407218,.00637039,.790126,-.00512988,.40722,.0099539,.79013,-.00738684,.407221,.0143339,.790135,-.0100538,.407221,.0195107,.790134,-.0131306,.407217,.0254848,.79016,-.0166169,.407224,.0322572,.790197,-.020512,.407236,.0398284,.790273,-.0248157,.407263,.0482014,.790381,-.029527,.407304,.0573777,.790521,-.0346446,.407355,.0673602,.790704,-.0401665,.40742,.0781522,.790925,-.0460896,.407499,.0897582,.791195,-.0524017,.407589,.10218,.791522,-.0590121,.407691,.11541,.791878,-.0654876,.407748,.12939,.792361,-.0725207,.407849,.144237,.792942,-.0799844,.407963,.159924,.79362,-.0877896,.408087,.176425,.794529,-.0958451,.408259,.193733,.795521,-.103827,.408362,.211756,.796778,-.111937,.408482,.230524,.798027,-.120521,.408547,.249967,.799813,-.129242,.408721,.269926,.802387,-.138048,.409148,.290338,.805279,-.147301,.409641,.311193,.809251,-.155895,.410154,.333611,.813733,-.163942,.410297,.357615,.819081,-.171666,.410373,.382339,.825427,-.178905,.410348,.407828,.83172,-.185812,.409486,.434034,.83877,-.192318,.408776,.460493,.845817,-.198249,.407176,.487346,.854664,-.204034,.405719,.514832,.863495,-.208908,.403282,.542401,.871883,-.212765,.399293,.570683,.88065,-.214911,.393803,.599947,.89004,-.216214,.387536,.62932,.898476,-.216745,.379846,.658319,.906738,-.216387,.370625,.687138,.914844,-.215053,.360139,.71601,.923877,-.212007,.348849,.745124,.931925,-.207481,.335639,.773366,.938054,-.202418,.320798,.801636,.943895,-.196507,.304772,.829055,.949468,-.189009,.288033,.856097,.955152,-.180539,.270532,.88301,.959403,-.171437,.251639,.909296,.963309,-.161661,.232563,.934868,.967399,-.150425,.213231,.959662,.972009,-.138659,.194247,.98302,.97433,-.126595,.174718,1.00517,.975823,-.113205,.155518,1.02566,.976371,-.0996096,.136709,1.04418,.978705,-.0860754,.117571,1.06146,.981477,-.0714438,.0980046,1.07777,.984263,-.0572304,.0782181,1.09214,.988423,-.0428875,.0584052,1.10553,.993,-.0282442,.038522,1.11758,.99704,-.0140183,.0190148,1.12864,.999913,369494e-9,-145203e-9,1.13901,.777662,-84153e-10,.423844,154403e-10,.770458,-211714e-9,.419915,38845e-8,.770716,-846888e-9,.420055,.00155386,.770982,-.00190567,.420202,.00349653,.770981,-.00338782,.420201,.00621606,.77098,-.00529338,.4202,.00971274,.770983,-.00762223,.4202,.0139867,.770985,-.0103741,.420198,.0190381,.770996,-.0135489,.4202,.0248677,.771029,-.0171461,.420212,.0314764,.771052,-.0211647,.420215,.0388648,.771131,-.0256048,.420245,.047036,.771235,-.0304647,.420284,.0559911,.771383,-.0357436,.420341,.0657346,.771591,-.0414392,.420423,.0762694,.771819,-.0475462,.420506,.0875984,.772123,-.0540506,.420617,.099727,.772464,-.060797,.42072,.112637,.772855,-.0675393,.420799,.126313,.773317,-.0748323,.420893,.140824,.773981,-.0825681,.421058,.15617,.774746,-.0906307,.421226,.172322,.77566,-.0988982,.421397,.189253,.776837,-.106994,.421569,.206912,.778097,-.115528,.421704,.225359,.779588,-.124317,.421849,.24447,.781574,-.133139,.422097,.264156,.784451,-.142179,.422615,.284318,.787682,-.15165,.423269,.304902,.792433,-.160771,.424396,.3265,.797359,-.169166,.424772,.35014,.803986,-.177149,.425475,.374768,.809504,-.184745,.424996,.399928,.815885,-.19173,.424247,.425796,.823513,-.198525,.423515,.452287,.832549,-.204709,.422787,.479321,.841653,-.210447,.421187,.506718,.850401,-.215501,.418519,.53432,.859854,-.219752,.414715,.56242,.869364,-.222305,.409462,.591558,.878837,-.223744,.402926,.621074,.888636,-.224065,.395043,.650538,.898132,-.223742,.38564,.679538,.907181,-.222308,.375378,.708674,.915621,-.219837,.363212,.737714,.9239,-.215233,.349313,.767014,.931644,-.209592,.334162,.795133,.938887,-.203644,.317943,.823228,.945282,-.196349,.300581,.850822,.950758,-.18742,.282195,.877594,.956146,-.177879,.262481,.904564,.960355,-.167643,.242487,.930741,.965256,-.156671,.222668,.955868,.968029,-.144123,.201907,.979869,.97251,-.131305,.18202,1.00291,.974925,-.118335,.161909,1.02392,.975402,-.103714,.142129,1.0433,.976987,-.089415,.122447,1.06089,.979677,-.0748858,.102248,1.07713,.983184,-.0596086,.0814851,1.09218,.987466,-.0447671,.0609484,1.10585,.992348,-.0295217,.0401835,1.11829,.996674,-.0143917,.0198163,1.12966,1.00003,321364e-9,-149983e-9,1.1402,.757901,-869074e-11,.436176,151011e-10,.751195,-217848e-9,.432317,378533e-9,.751178,-871373e-9,.432307,.0015141,.751195,-.00196061,.432317,.0034068,.751198,-.00348552,.432318,.00605659,.751195,-.00544599,.432315,.00946353,.751207,-.00784203,.43232,.013628,.751213,-.0106732,.43232,.0185499,.751221,-.0139393,.432319,.0242302,.751244,-.0176398,.432325,.0306694,.7513,-.0217743,.432348,.0378698,.751358,-.0263412,.432367,.0458321,.751458,-.0313396,.432404,.0545587,.751608,-.0367682,.432464,.0640543,.7518,-.0426246,.43254,.0743222,.752065,-.0489031,.432645,.0853668,.752376,-.0555828,.432762,.0971911,.752715,-.0623861,.432859,.109768,.753137,-.069415,.432958,.123126,.753676,-.0770039,.433099,.137308,.754345,-.084971,.433272,.15229,.755235,-.0932681,.433504,.168075,.756186,-.10171,.433693,.184625,.757363,-.110019,.433857,.201897,.75884,-.11887,.434102,.220014,.760467,-.127881,.434306,.238778,.762969,-.136766,.434751,.258172,.765823,-.14612,.43529,.278062,.769676,-.15566,.436236,.298437,.774909,-.165177,.437754,.319532,.77994,-.17402,.438343,.342505,.785757,-.182201,.438609,.366693,.792487,-.190104,.438762,.391668,.80038,-.197438,.438795,.417494,.808494,-.204365,.438226,.443933,.817695,-.210714,.437283,.470929,.828111,-.216651,.436087,.498569,.837901,-.221804,.433717,.526165,.847813,-.226318,.430133,.554155,.858314,-.229297,.425213,.582822,.868891,-.230999,.418576,.612847,.878941,-.231155,.410405,.642445,.888809,-.230935,.400544,.672024,.898089,-.229343,.389613,.701366,.908081,-.226886,.377197,.730763,.916819,-.222676,.363397,.759642,.924968,-.216835,.347437,.788775,.932906,-.210245,.32995,.817135,.940025,-.202992,.312262,.844912,.946101,-.19436,.293313,.872164,.952835,-.184125,.273638,.899443,.957347,-.173657,.252385,.926389,.961434,-.162204,.231038,.951947,.965522,-.14979,.209834,.976751,.969412,-.136307,.188821,1.00022,.973902,-.122527,.168013,1.02229,.974045,-.108213,.147634,1.04199,.975775,-.0927397,.12705,1.06019,.978383,-.0778212,.106309,1.07711,.98211,-.0621216,.0849279,1.09245,.986517,-.0463847,.0633519,1.10651,.991696,-.0309353,.0419698,1.11903,.996349,-.0150914,.0206272,1.13073,1.00003,442449e-9,-231396e-9,1.14146,.727498,-885074e-11,.441528,145832e-10,.730897,-223525e-9,.443589,368298e-9,.730796,-893996e-9,.443528,.00147303,.730805,-.00201149,.443533,.00331433,.730814,-.00357596,.443538,.00589222,.730815,-.00558734,.443538,.00920678,.730822,-.00804544,.44354,.0132582,.730836,-.0109501,.443545,.0180468,.730848,-.0143008,.443546,.0235732,.730871,-.0180969,.443552,.0298382,.730915,-.022338,.443567,.0368438,.730982,-.0270225,.443591,.044591,.731076,-.0321491,.443627,.0530831,.731245,-.0377166,.443699,.0623243,.73144,-.0437216,.443777,.0723181,.7317,-.0501576,.443881,.0830691,.732034,-.0569942,.444014,.0945809,.732388,-.0638756,.444113,.106825,.732853,-.071203,.444247,.119859,.733473,-.0790076,.444442,.13369,.734195,-.0871937,.444645,.148304,.735069,-.095696,.444877,.163702,.736169,-.10426,.445133,.179861,.73747,-.112853,.44537,.196778,.738991,-.12199,.445651,.214496,.740865,-.131153,.445958,.232913,.743637,-.140245,.446548,.251977,.746797,-.149722,.447246,.271551,.751517,-.159341,.448656,.291774,.756156,-.169106,.449866,.312455,.761519,-.178436,.450919,.334552,.768295,-.186904,.451776,.358491,.776613,-.195117,.452832,.383446,.783966,-.202695,.45249,.408945,.793542,-.20985,.452587,.435364,.803192,-.216403,.451852,.462336,.813892,-.22251,.450708,.48987,.824968,-.227676,.4486,.517697,.835859,-.232443,.445156,.545975,.846825,-.235775,.440351,.574483,.858085,-.237897,.433641,.604246,.868825,-.238074,.425354,.634101,.879638,-.237661,.415383,.664201,.889966,-.236186,.404136,.693918,.899479,-.233599,.390917,.723481,.908769,-.229737,.376352,.75258,.917966,-.223836,.360372,.781764,.926304,-.217067,.342551,.811139,.934626,-.209309,.324238,.839585,.941841,-.20071,.304484,.867044,.94789,-.190602,.283607,.894579,.954196,-.179253,.262205,.921743,.958383,-.167646,.239847,.948026,.963119,-.155073,.218078,.973296,.966941,-.141426,.195899,.998135,.970836,-.126849,.174121,1.02021,.973301,-.112296,.153052,1.04085,.97448,-.0964965,.131733,1.05946,.977045,-.080489,.10997,1.07693,.980751,-.064844,.0881657,1.09254,.985475,-.0481938,.0657987,1.10697,.991089,-.0319185,.0435215,1.12004,.996122,-.0158088,.0214779,1.13173,1.00001,372455e-9,-200295e-9,1.14291,.708622,-907597e-11,.45304,141962e-10,.711162,-228911e-9,.454662,358052e-9,.709812,-914446e-9,.453797,.00143034,.709865,-.00205819,.453834,.00321935,.709864,-.00365894,.453833,.00572331,.709855,-.00571692,.453826,.00894278,.709862,-.00823201,.453828,.012878,.709875,-.011204,.453832,.0175295,.709896,-.0146323,.453839,.0228978,.709925,-.0185163,.453847,.0289839,.709974,-.0228551,.453866,.0357894,.710045,-.0276473,.453892,.0433161,.710133,-.032891,.453924,.0515665,.710292,-.0385851,.453992,.0605458,.710485,-.0447254,.45407,.0702574,.710769,-.0513051,.454192,.0807077,.711106,-.0582733,.454329,.091896,.711516,-.0652866,.45446,.103814,.712071,-.0728426,.454653,.116508,.712676,-.0808307,.45484,.129968,.713476,-.0892216,.455096,.144206,.714377,-.0979047,.455346,.159212,.715579,-.106531,.455647,.174973,.716977,-.115492,.455961,.191504,.71862,-.124821,.456315,.208835,.72084,-.134079,.4568,.226869,.723786,-.143427,.457521,.245582,.727464,-.153061,.458475,.264957,.732771,-.162768,.460239,.284948,.736515,-.172627,.460899,.30522,.743519,-.182487,.463225,.326717,.750041,-.191295,.464027,.350113,.758589,-.199746,.465227,.374782,.767703,-.207584,.465877,.400226,.777484,-.214973,.465996,.426442,.788792,-.221796,.466019,.453688,.800194,-.228038,.465083,.481246,.811234,-.233346,.462506,.509086,.822859,-.238073,.459257,.537338,.835082,-.241764,.454863,.566108,.846332,-.244241,.448163,.595126,.858355,-.244736,.439709,.625574,.87034,-.244278,.429837,.65617,.881027,-.24255,.418002,.686029,.891007,-.239912,.404325,.716039,.900874,-.236133,.389222,.745518,.911072,-.230672,.373269,.775026,.920359,-.22356,.355083,.804521,.928604,-.215591,.335533,.834045,.937175,-.206503,.315278,.861612,.942825,-.196684,.293653,.889131,.949805,-.185116,.271503,.916853,.955535,-.172703,.248821,.943541,.959843,-.159978,.225591,.970132,.964393,-.146375,.202719,.994709,.968008,-.131269,.179928,1.0186,.971013,-.11569,.158007,1.03928,.973334,-.1003,.13624,1.05887,.975775,-.0833352,.1138,1.07652,.979579,-.0668981,.0913141,1.09297,.984323,-.0500902,.0683051,1.10734,.990351,-.0332377,.0451771,1.12084,.995823,-.0161491,.0221705,1.13296,1.0001,234083e-9,-108712e-9,1.14441,.683895,-924677e-11,.46015,137429e-10,.68833,-233383e-9,.463134,346865e-9,.688368,-933547e-9,.463159,.00138748,.688367,-.00210049,.463159,.00312187,.688369,-.00373415,.463159,.00555004,.688377,-.00583449,.463163,.00867216,.688386,-.00840128,.463166,.0124884,.688398,-.0114343,.463169,.0169993,.688418,-.0149329,.463175,.0222054,.688453,-.0188964,.463188,.028108,.688515,-.0233239,.463214,.0347085,.68857,-.0282136,.463231,.0420091,.688679,-.033564,.463276,.0500132,.688854,-.0393733,.463356,.0587255,.689038,-.0456354,.46343,.0681476,.689321,-.0523433,.463553,.0782897,.689662,-.059412,.463693,.0891501,.690188,-.0665736,.4639,.100735,.690755,-.0743106,.464107,.113074,.691405,-.0824722,.464329,.126161,.692198,-.0910484,.464585,.140007,.693196,-.0998778,.464893,.154612,.69454,-.108651,.465285,.169984,.695921,-.117855,.465596,.186106,.697749,-.12734,.466056,.203034,.700375,-.136714,.466771,.220703,.703395,-.146386,.467579,.239062,.707904,-.156096,.469067,.258188,.711673,-.165904,.469851,.277759,.717489,-.175812,.471815,.297935,.724051,-.185931,.47389,.318916,.731965,-.195238,.47587,.341591,.741151,-.204021,.477523,.366062,.751416,-.212113,.478881,.391396,.761848,-.21979,.479226,.417599,.771886,-.2267,.478495,.444401,.783998,-.232991,.477622,.472084,.796523,-.238645,.475833,.500193,.808851,-.243396,.472568,.52865,.821191,-.247226,.467857,.557362,.834261,-.250102,.461871,.586768,.846762,-.251056,.453543,.617085,.859867,-.250604,.443494,.647659,.871948,-.248783,.431711,.678119,.882967,-.245855,.417911,.708399,.892826,-.242168,.401993,.738256,.90332,-.237062,.385371,.767999,.913633,-.22997,.366837,.798191,.922774,-.221687,.346372,.827756,.931371,-.212345,.325682,.856425,.938929,-.20206,.303665,.884299,.944821,-.190981,.280786,.912023,.951792,-.178065,.2573,.939669,.957712,-.164634,.233448,.96655,.961912,-.150863,.209504,.992366,.966382,-.13577,.18597,1.01633,.969588,-.119593,.162905,1.03843,.971777,-.103203,.14053,1.05841,.97433,-.0865888,.117909,1.07632,.978686,-.0690829,.0944101,1.09326,.983281,-.0516568,.0705671,1.10796,.989562,-.034558,.0468592,1.12182,.995465,-.0167808,.0229846,1.1342,.999991,373016e-9,-235606e-9,1.1459,.662251,-939016e-11,.468575,132714e-10,.666634,-237624e-9,.471675,335842e-9,.666411,-950385e-9,.471516,.00134321,.666399,-.00213833,.471509,.00302221,.666386,-.0038014,.471499,.00537283,.666405,-.00593958,.471511,.00839533,.666406,-.00855253,.471508,.0120898,.666428,-.0116401,.471519,.0164569,.666444,-.0152015,.471522,.0214971,.66649,-.0192362,.471543,.027212,.666537,-.0237428,.471558,.033603,.666617,-.0287198,.471591,.0406728,.666718,-.0341647,.471631,.0484238,.666889,-.0400759,.47171,.0568621,.667104,-.0464479,.471805,.0659915,.667374,-.0532677,.471923,.0758178,.667772,-.0603805,.472098,.0863425,.668371,-.0677392,.472363,.0975917,.668971,-.0756028,.472596,.109567,.669696,-.0839293,.472869,.122272,.670481,-.0926683,.473126,.135718,.6715,-.1016,.473442,.149914,.672911,-.110566,.47389,.164882,.674512,-.119984,.474354,.180602,.67651,-.129574,.474922,.19711,.679292,-.139106,.475764,.214371,.682798,-.148993,.476886,.232405,.686955,-.158737,.478179,.251153,.691406,-.168754,.479432,.270436,.697438,-.178703,.481481,.290374,.704761,-.188955,.484143,.311044,.713599,-.198814,.487007,.333003,.723194,-.207869,.488962,.357144,.732601,-.216189,.489815,.382169,.744193,-.22398,.490888,.408227,.754907,-.231156,.490355,.434928,.767403,-.23747,.489548,.462599,.78107,-.243503,.488274,.490908,.793893,-.248114,.484843,.519421,.807296,-.25222,.4803,.548561,.820529,-.255265,.474097,.577772,.833716,-.256741,.466041,.607782,.848403,-.25637,.456547,.638807,.860755,-.254804,.443946,.670058,.874012,-.251834,.430852,.700749,.885619,-.247867,.414903,.731446,.896069,-.242634,.397276,.761191,.906266,-.236093,.378535,.791053,.916759,-.227543,.358038,.821298,.92523,-.21783,.335705,.850747,.93436,-.207534,.313797,.879258,.941631,-.195983,.289671,.907734,.947564,-.183567,.265319,.935206,.953681,-.169345,.240815,.962739,.960008,-.154909,.216119,.989227,.964145,-.140161,.192096,1.01465,.968171,-.123411,.167855,1.03737,.969859,-.106525,.144817,1.05767,.972666,-.0891023,.12149,1.0761,.977055,-.0718094,.0975306,1.09336,.982527,-.0534213,.0730217,1.10878,.989001,-.0355579,.0483366,1.12285,.99512,-.0176383,.023938,1.13548,1.00007,368831e-9,-211581e-9,1.14744,.651047,-960845e-11,.484101,12922e-9,.644145,-241347e-9,.478968,324578e-9,.64396,-965142e-9,.478831,.00129798,.64396,-.00217154,.47883,.00292046,.643968,-.00386049,.478835,.00519202,.643974,-.00603186,.478838,.0081128,.643977,-.0086854,.478836,.011683,.643982,-.0118207,.478834,.0159031,.644024,-.0154374,.478856,.0207743,.644059,-.0195343,.478868,.0262975,.644122,-.0241103,.478896,.0324747,.644207,-.0291638,.478933,.039309,.64432,-.0346919,.478981,.0468029,.644481,-.0406919,.479053,.0549614,.644722,-.047159,.479169,.0637909,.645013,-.0540748,.479302,.0732974,.645503,-.0612001,.479541,.0834898,.646117,-.0687303,.479829,.0943873,.646707,-.0767846,.480061,.105991,.647431,-.0852465,.480343,.11831,.64831,-.0940719,.48066,.131348,.649486,-.103056,.481083,.14514,.650864,-.112261,.481528,.159676,.652604,-.121852,.482102,.174979,.654825,-.131505,.482813,.191079,.657876,-.141189,.483876,.207927,.661339,-.151239,.48499,.225586,.665463,-.161091,.486279,.243947,.670542,-.171235,.487968,.262957,.677361,-.181347,.49053,.282781,.685672,-.191679,.493862,.303311,.694551,-.201781,.49699,.324607,.703753,-.211164,.498884,.347916,.713703,-.219675,.500086,.372628,.725911,-.227836,.501554,.398694,.73862,-.23533,.502193,.425529,.752118,-.241786,.501811,.453209,.76579,-.247865,.500185,.481381,.779568,-.252696,.497159,.51011,.793991,-.256802,.492765,.539322,.808182,-.259942,.486827,.569078,.821698,-.261703,.478386,.598818,.836009,-.262006,.468772,.629762,.849824,-.260333,.456352,.661366,.863888,-.257398,.442533,.69295,.876585,-.253264,.426573,.723608,.888665,-.248026,.408964,.754378,.899537,-.241487,.389677,.784761,.9094,-.233463,.368516,.814688,.920166,-.223397,.346624,.845009,.928899,-.21255,.322717,.874431,.937156,-.200869,.298698,.902922,.943861,-.188387,.273491,.931356,.949557,-.174341,.247866,.958854,.955862,-.158994,.222496,.986098,.961721,-.143664,.197522,1.01229,.965976,-.127412,.17302,1.03571,.968652,-.109798,.148954,1.05699,.971084,-.0916787,.125044,1.07587,.975584,-.0739634,.100577,1.09372,.98122,-.055322,.0753666,1.10948,.988253,-.0366825,.0498899,1.12394,.99482,-.0180389,.024611,1.13694,1.00001,229839e-9,-188283e-9,1.14919,.613867,-964198e-11,.479449,123452e-10,.621485,-244534e-9,.485399,313091e-9,.621429,-978202e-9,.485353,.00125245,.62112,-.00220004,.485114,.00281687,.621119,-.0039111,.485112,.00500783,.621122,-.00611091,.485112,.00782498,.621133,-.00879922,.485117,.0112687,.621152,-.0119756,.485125,.0153394,.621183,-.0156396,.485139,.0200382,.621227,-.0197898,.485158,.0253663,.621298,-.0244253,.485192,.0313261,.621388,-.0295441,.485233,.0379204,.621507,-.0351432,.485286,.0451523,.621693,-.0412198,.485378,.0530277,.621933,-.0477673,.485495,.0615522,.622232,-.0547574,.485635,.0707316,.622809,-.0619417,.485943,.0805883,.623407,-.069625,.486232,.0911267,.62406,-.077796,.486516,.102354,.624835,-.0863731,.486838,.114279,.625758,-.095251,.487188,.126902,.627043,-.104299,.487695,.140285,.628438,-.113724,.488163,.154397,.630325,-.123417,.488858,.169267,.632801,-.133137,.489754,.184941,.635784,-.143052,.490815,.20136,.639406,-.153132,.492048,.218643,.643872,-.163143,.49363,.236615,.6499,-.17333,.496009,.255449,.657201,-.183622,.498994,.275006,.666221,-.194019,.502888,.295354,.674419,-.204192,.505459,.316244,.683729,-.21406,.507771,.33849,.695584,-.222854,.510245,.363166,.708583,-.231315,.512293,.389071,.721233,-.238911,.512747,.415737,.735134,-.245657,.512482,.443331,.750179,-.251879,.511526,.471891,.765073,-.256911,.508935,.500892,.779794,-.261144,.504341,.530294,.794801,-.264316,.498515,.560144,.810339,-.266276,.491015,.590213,.824818,-.266981,.481126,.620865,.839375,-.265778,.468685,.652687,.853043,-.262748,.453925,.684759,.867335,-.258474,.437912,.716209,.88037,-.253187,.419648,.747508,.891711,-.246476,.39982,.77797,.902896,-.238735,.37879,.808586,.913601,-.22885,.355891,.838843,.923019,-.217656,.331773,.869014,.933432,-.205539,.307356,.898512,.939691,-.192595,.281321,.9269,.946938,-.178945,.255441,.955297,.952372,-.163587,.229013,.983231,.95909,-.147214,.203179,1.00971,.963675,-.13064,.17792,1.03438,.968247,-.113121,.152898,1.05625,.97001,-.0945824,.128712,1.07598,.974458,-.0755648,.103349,1.094,.980168,-.0571998,.0776731,1.1104,.987295,-.0377994,.0514445,1.12491,.994432,-.0186417,.025429,1.13851,.999975,542714e-9,-282356e-9,1.15108,.592656,-980249e-11,.486018,119532e-10,.598467,-247275e-9,.490781,301531e-9,.597934,-988317e-9,.490343,.00120517,.597903,-.00222366,.490319,.0027116,.597913,-.00395315,.490327,.00482077,.597919,-.00617653,.490329,.00753264,.597936,-.00889375,.490339,.0108478,.597956,-.0121043,.490347,.0147668,.597992,-.0158073,.490365,.0192905,.598032,-.0200017,.490382,.0244204,.598109,-.0246865,.49042,.0301593,.598215,-.0298594,.490474,.03651,.59833,-.0355167,.490524,.0434757,.598525,-.0416559,.490624,.0510629,.598778,-.0482692,.490753,.0592781,.599135,-.0553114,.49094,.0681304,.599802,-.062542,.491328,.0776467,.600361,-.0703638,.491598,.0878184,.60101,-.0786256,.491882,.0986573,.601811,-.0872962,.492232,.11018,.602861,-.0962284,.492684,.1224,.604167,-.10538,.493213,.135354,.605693,-.114896,.493799,.149034,.607682,-.124654,.494576,.163469,.610672,-.13456,.4959,.178747,.613313,-.144581,.496713,.194723,.617603,-.154703,.498499,.211617,.622174,-.16489,.500188,.229183,.628855,-.175164,.503072,.247786,.636963,-.185565,.506798,.267116,.644866,-.195911,.509719,.28702,.653741,-.206104,.512776,.307763,.664942,-.216447,.516812,.329631,.67633,-.22552,.519181,.353515,.690012,-.234316,.521681,.379226,.704243,-.242032,.523129,.405901,.719396,-.249172,.523768,.433585,.734471,-.255543,.522541,.462085,.750539,-.260697,.520217,.491233,.766365,-.26501,.516293,.521094,.781677,-.268409,.509708,.551014,.797132,-.270399,.501944,.581463,.812655,-.271247,.492025,.612402,.828592,-.270708,.480424,.643798,.844044,-.268085,.465955,.67682,.857305,-.263459,.448425,.708496,.87114,-.258151,.430243,.74046,.884936,-.251171,.410578,.771583,.895772,-.243305,.38862,.802234,.906961,-.234037,.365214,.833179,.917775,-.222714,.34116,.86353,.927883,-.210175,.31572,.893557,.936617,-.196925,.289159,.922976,.943384,-.182788,.261996,.951606,.949713,-.167965,.235324,.979958,.955818,-.151109,.208408,1.00765,.961344,-.133834,.182591,1.03329,.965469,-.115987,.156958,1.0557,.968693,-.09746,.132239,1.07583,.973165,-.0778514,.106195,1.09451,.979387,-.0585067,.0797669,1.11137,.98671,-.0390409,.0530263,1.12643,.994093,-.019408,.0263163,1.14016,1.00002,540029e-9,-194487e-9,1.15299,.574483,-989066e-11,.494533,114896e-10,.574478,-249127e-9,.494528,289403e-9,.574607,-996811e-9,.494637,.00115797,.574396,-.00224241,.494458,.00260498,.574377,-.00398632,.49444,.00463102,.574386,-.00622836,.494445,.00723623,.574401,-.0089683,.494453,.010421,.574419,-.0122056,.49446,.0141859,.574459,-.0159396,.494481,.0185322,.574525,-.0201692,.49452,.0234617,.574587,-.0248924,.494547,.0289762,.574697,-.0301074,.494604,.0350797,.574853,-.0358114,.494688,.0417767,.575027,-.041999,.494772,.0490718,.575294,-.0486618,.494915,.0569728,.575733,-.0557148,.495173,.0654955,.576356,-.0630489,.495537,.0746612,.576944,-.0709285,.495836,.0844615,.57765,-.0792723,.496177,.0949142,.578491,-.0880167,.496563,.10603,.579639,-.0969462,.497096,.117841,.580989,-.10622,.497684,.130367,.582587,-.115861,.498337,.143609,.584951,-.125605,.499414,.157625,.587602,-.135608,.500518,.172413,.59076,-.145742,.501767,.187999,.594992,-.155934,.503542,.20445,.600656,-.166303,.506135,.221764,.607816,-.176681,.509542,.24002,.61522,-.187071,.51263,.258992,.623702,-.197465,.516021,.278773,.634192,-.207816,.520422,.299377,.644936,-.218183,.524073,.320802,.657888,-.2278,.528049,.34384,.670666,-.236747,.52986,.36916,.685626,-.24484,.531892,.395867,.701304,-.252071,.532727,.423488,.717727,-.258714,.532146,.452201,.733914,-.264211,.529883,.481579,.750529,-.26859,.5259,.511558,.76747,-.272046,.51999,.542042,.785189,-.274225,.513083,.572799,.800954,-.275189,.502936,.603816,.816962,-.274946,.490921,.635461,.83336,-.272695,.47684,.6676,.848143,-.268223,.459405,.70051,.861818,-.262768,.440319,.732902,.876828,-.255872,.420123,.765084,.889312,-.247703,.398379,.796391,.900412,-.238381,.374496,.827333,.912251,-.227783,.349874,.858385,.921792,-.214832,.323181,.888652,.931273,-.200949,.296624,.917763,.940295,-.186537,.269211,.947878,.946812,-.171538,.241447,.977016,.953588,-.155254,.213829,1.00501,.958841,-.137156,.186807,1.03179,.963746,-.118699,.160706,1.05502,.966468,-.0998358,.135504,1.07568,.971178,-.0805186,.109131,1.09479,.97831,-.0599348,.0818293,1.1123,.985886,-.0399661,.0545872,1.12771,.994021,-.0198682,.0269405,1.14186,1.00009,271022e-9,-12989e-8,1.15514,.538716,-990918e-11,.486732,109675e-10,.550656,-250642e-9,.497518,277412e-9,.55057,-.00100265,.497441,.00110974,.550903,-.00225672,.497733,.00249779,.550568,-.00401046,.497438,.00443906,.550574,-.00626613,.49744,.00693637,.550591,-.0090226,.497449,.00998921,.550623,-.0122795,.497469,.0135984,.550667,-.0160361,.497495,.0177654,.550724,-.0202908,.497526,.0224915,.550792,-.0250421,.497557,.0277795,.550918,-.0302878,.49763,.0336334,.551058,-.0360241,.497701,.0400573,.551276,-.0422473,.497824,.0470585,.551551,-.0489441,.497977,.0546433,.552074,-.0559596,.498312,.0628367,.552681,-.0633978,.498679,.071646,.553324,-.0713176,.499031,.0810746,.554011,-.0797268,.499365,.091129,.55488,-.0885238,.499779,.101837,.556171,-.0974417,.500444,.113239,.557498,-.106841,.501025,.125316,.559299,-.116533,.501864,.138128,.561647,-.126298,.502967,.151695,.564347,-.136388,.504129,.16604,.567863,-.146576,.505713,.181207,.572569,-.156832,.507953,.197259,.578919,-.167323,.511186,.214258,.585387,-.177712,.514042,.232038,.593134,-.188184,.517484,.250733,.603295,-.198717,.522345,.270454,.613854,-.209177,.526751,.290807,.626092,-.219644,.531595,.312202,.637868,-.229494,.534721,.334435,.652458,-.238718,.538304,.359184,.666985,-.247061,.539875,.385637,.683301,-.254652,.541042,.41328,.69998,-.261376,.540735,.441903,.717824,-.267085,.539139,.471609,.734617,-.271465,.534958,.501446,.753663,-.27528,.53032,.532571,.770512,-.277617,.522134,.563641,.787356,-.278525,.51206,.595067,.806252,-.278512,.50119,.627226,.822061,-.277023,.486791,.659402,.838959,-.273175,.470467,.692874,.85379,-.267238,.450688,.725702,.868268,-.260327,.429741,.75832,.881994,-.251946,.407223,.790189,.893885,-.242432,.383214,.821625,.905118,-.231904,.357297,.853011,.916045,-.219545,.330733,.883773,.927614,-.205378,.303916,.914435,.936005,-.190388,.275941,.944502,.944533,-.1749,.247493,.974439,.950758,-.158588,.218996,1.00286,.957078,-.141027,.191559,1.0304,.962448,-.121507,.164457,1.05466,.964993,-.102068,.138636,1.0761,.970017,-.0822598,.111861,1.09541,.97661,-.062033,.0843438,1.11317,.985073,-.0409832,.0558496,1.12911,.993515,-.020146,.0275331,1.1438,1.00006,27329e-8,-107883e-9,1.15736,.525324,-999341e-11,.498153,105385e-10,.526513,-251605e-9,.499277,265329e-9,.526517,-.00100641,.499282,.0010613,.526588,-.00226466,.499337,.00238823,.526539,-.0040255,.499302,.00424535,.526547,-.00628954,.499306,.00663364,.526561,-.00905628,.499313,.00955337,.526593,-.0123253,.499334,.0130054,.526642,-.0160957,.499365,.0169911,.5267,-.0203661,.499396,.0215122,.526792,-.0251347,.499451,.0265718,.526904,-.0303985,.499511,.0321732,.527079,-.0361554,.499617,.0383231,.527285,-.0423982,.499731,.045026,.527602,-.0491121,.499924,.0522936,.528166,-.0561127,.500306,.0601528,.52879,-.0635988,.5007,.0686059,.529421,-.071581,.501048,.0776518,.530144,-.0799854,.501421,.0873148,.531062,-.0888032,.501884,.0976084,.532374,-.0977643,.50259,.108588,.533828,-.107197,.50329,.120234,.53581,-.116887,.504312,.132602,.538063,-.126755,.505365,.145721,.5409,-.136819,.506668,.159617,.544882,-.147117,.508731,.174369,.550238,-.157446,.511601,.190028,.556038,-.167988,.514431,.206587,.563031,-.178364,.517808,.224046,.571543,-.189007,.521937,.242503,.582255,-.199546,.527415,.261977,.59272,-.210084,.531682,.282162,.605648,-.220448,.537123,.303426,.61785,-.230593,.540664,.325323,.632223,-.240238,.544467,.348993,.648819,-.24887,.547594,.375462,.665825,-.256657,.54912,.403024,.683389,-.263711,.549294,.431773,.701495,-.269666,.547649,.461494,.719197,-.274169,.543786,.491623,.737906,-.278124,.538644,.522994,.756652,-.280632,.531057,.554775,.775279,-.281741,.521972,.586441,.792688,-.281652,.509613,.618596,.811894,-.280345,.496497,.651462,.827938,-.277128,.47968,.684023,.844837,-.271646,.460688,.718024,.859239,-.264397,.438872,.751207,.874088,-.256144,.41577,.784232,.887693,-.246311,.391369,.816191,.899402,-.235497,.365872,.847828,.910973,-.223631,.338618,.87934,.92204,-.209874,.310803,.910325,.930987,-.194265,.281802,.940695,.94,-.178125,.252836,.970958,.948018,-.161479,.224239,1.00078,.955141,-.144038,.195857,1.0288,.960513,-.124915,.168487,1.05371,.963964,-.104284,.141495,1.07596,.968713,-.0838732,.114437,1.09628,.975524,-.0635579,.0863105,1.11448,.98431,-.042291,.0574774,1.13069,.992916,-.0209131,.0284343,1.14568,.999926,743097e-9,-379265e-9,1.15955,.501042,-998428e-11,.498726,100306e-10,.502992,-252112e-9,.500665,253283e-9,.502417,-.00100791,.500092,.00101259,.502965,-.00226919,.500621,.00227978,.502318,-.00403109,.499994,.00405011,.502333,-.00629832,.500005,.00632868,.502362,-.00906907,.500027,.00911446,.502369,-.0123423,.500023,.0124078,.50243,-.0161178,.500066,.016211,.502493,-.0203937,.500103,.0205256,.502592,-.0251684,.500166,.0253548,.502707,-.0304389,.50023,.0307029,.502881,-.0362015,.500335,.0365753,.503124,-.0424507,.500488,.0429798,.503443,-.0491582,.500686,.0499268,.504083,-.0561476,.501155,.0574541,.504668,-.0636846,.501524,.0655408,.505319,-.0716834,.501904,.0742072,.50609,-.0800925,.502321,.0834699,.507122,-.0888425,.502896,.0933603,.508414,-.097855,.503603,.10391,.509955,-.107304,.504416,.115113,.512061,-.116921,.505565,.127054,.514419,-.12689,.506732,.139709,.517529,-.136934,.508338,.153173,.522085,-.147327,.510987,.167528,.526986,-.157612,.513527,.182708,.533122,-.168213,.516717,.198881,.540807,-.178688,.520832,.215986,.550687,-.189511,.52632,.234335,.560567,-.199998,.531009,.253375,.571698,-.210652,.535839,.273499,.584364,-.220917,.541091,.294355,.599066,-.23137,.546875,.316525,.614148,-.241206,.551306,.339671,.631157,-.250379,.555187,.36531,.647919,-.258397,.556595,.392767,.666112,-.265528,.556949,.421397,.686158,-.271827,.556617,.451433,.704838,-.27674,.552975,.482131,.723957,-.280733,.547814,.513458,.74262,-.283359,.53997,.545446,.762009,-.284541,.530422,.57775,.781314,-.284507,.518546,.610434,.799116,-.283309,.504178,.643178,.817604,-.280378,.48843,.676248,.83459,-.275619,.469457,.709698,.850974,-.26856,.447698,.744245,.866747,-.260094,.424791,.777695,.881412,-.249929,.399913,.810392,.8936,-.239137,.37308,.842872,.905943,-.226818,.345705,.874677,.916408,-.213699,.31706,.906257,.927215,-.198428,.288444,.936881,.935625,-.181643,.258329,.96795,.944076,-.164386,.228488,.998216,.951229,-.146339,.199763,1.02689,.958793,-.127709,.172153,1.0535,.963219,-.107244,.144989,1.07646,.967562,-.0857764,.11685,1.09675,.974866,-.0645377,.0880571,1.11576,.983353,-.0431732,.0587352,1.13227,.992503,-.0218356,.0294181,1.1478,1.00003,605203e-9,-231013e-9,1.16207,.482935,-101177e-10,.504695,968142e-11,.477554,-251521e-9,.499071,240676e-9,.477904,-.00100683,.499436,96342e-8,.478368,-.00226636,.499899,.0021687,.477977,-.00402719,.499513,.00385384,.477993,-.00629226,.499525,.0060221,.478011,-.00906011,.499536,.00867289,.478051,-.0123305,.499566,.0118074,.478089,-.016102,.499587,.0154269,.478171,-.0203736,.499645,.0195341,.478254,-.025143,.499692,.0241318,.47839,-.0304071,.499779,.0292247,.478588,-.0361631,.499911,.0348196,.478812,-.0424023,.500046,.0409231,.479208,-.0490724,.500326,.047552,.479841,-.0560722,.500805,.0547377,.480392,-.0636125,.501152,.0624607,.481068,-.0716134,.501561,.0707473,.481898,-.0800062,.502054,.0796118,.483022,-.0886568,.502728,.0890974,.484332,-.0977553,.503479,.0992099,.486126,-.107173,.504546,.10999,.488066,-.11677,.50557,.121476,.490521,-.126725,.506849,.133672,.494232,-.136793,.50911,.146731,.498302,-.147116,.511345,.160577,.503565,-.157446,.514344,.175335,.510902,-.168121,.518824,.191207,.519263,-.178799,.523666,.208058,.528204,-.189407,.528296,.225875,.538854,-.200145,.533724,.244782,.551278,-.210701,.539833,.264753,.565222,-.221303,.546131,.285745,.579403,-.231688,.551496,.307592,.595469,-.241718,.556809,.330582,.610929,-.250992,.559641,.354995,.629433,-.259602,.562379,.382471,.648504,-.267038,.563676,.411126,.66756,-.273388,.562092,.440924,.689143,-.278788,.560807,.472118,.709056,-.282783,.555701,.503774,.729855,-.285836,.548698,.536364,.748954,-.287078,.538544,.56895,.768373,-.287133,.526711,.601991,.78827,-.285839,.512511,.635403,.807465,-.283238,.496323,.668797,.825194,-.27906,.477638,.702584,.842203,-.272286,.456253,.736393,.857749,-.263854,.432412,.77096,.874799,-.253943,.407806,.80489,.887497,-.24237,.38033,.83771,.89966,-.230278,.352446,.870376,.911753,-.21646,.323268,.902256,.923011,-.202071,.294314,.933306,.932375,-.185519,.264104,.965177,.940537,-.167604,.234035,.996303,.948904,-.149068,.20412,1.0261,.955263,-.129539,.175431,1.05304,.960303,-.109932,.148116,1.07617,.965512,-.0880572,.119693,1.09742,.973466,-.0660548,.0901619,1.11721,.98284,-.0439228,.0599875,1.13436,.992216,-.0219588,.0298975,1.15006,.999946,119402e-9,-208547e-10,1.16471,.447827,-100414e-10,.491543,914833e-11,.454778,-251257e-9,.499172,22891e-8,.453519,-.00100342,.497787,914184e-9,.45357,-.00225776,.497847,.00205701,.453578,-.00401371,.497855,.00365705,.45357,-.00627107,.497841,.00571453,.453598,-.00902968,.497864,.00823019,.453627,-.0122888,.497882,.0112049,.453684,-.0160475,.497923,.0146405,.453764,-.0203044,.49798,.0185394,.453866,-.0250576,.498049,.0229054,.453996,-.0303028,.49813,.0277424,.454196,-.0360379,.498267,.0330587,.454457,-.0422521,.498445,.0388613,.454926,-.0488393,.498812,.0451767,.455525,-.0558653,.499272,.0520153,.456074,-.0633772,.499625,.0593754,.456752,-.0713606,.500049,.0672751,.457648,-.07971,.500615,.0757447,.458849,-.0883032,.501399,.0848231,.46029,-.0974095,.502293,.0945135,.462,-.106729,.503301,.104848,.464121,-.116354,.504533,.115884,.466889,-.126214,.506172,.127652,.470744,-.136324,.508667,.14024,.47488,-.146595,.510995,.153673,.480845,-.157027,.514832,.168053,.488262,-.167658,.519506,.183508,.496547,-.178343,.524347,.199948,.506254,-.188916,.52983,.217503,.517961,-.199975,.536357,.236272,.531484,-.210624,.543641,.256096,.545496,-.221227,.550048,.277085,.559497,-.231568,.555076,.298615,.575752,-.241698,.560541,.321547,.591999,-.251172,.564156,.345602,.610654,-.260178,.567607,.371851,.630484,-.268094,.56923,.40076,.651807,-.274661,.569779,.430801,.67239,-.280331,.566791,.461939,.693024,-.284501,.562007,.493854,.715473,-.287852,.555791,.526992,.736323,-.28929,.546345,.560102,.755771,-.289405,.534,.593543,.775424,-.2881,.519114,.627256,.795447,-.285562,.502543,.661464,.815319,-.281416,.484773,.695206,.831769,-.275523,.463445,.729044,.849464,-.267516,.440269,.764069,.866775,-.257584,.415049,.799089,.881252,-.245817,.388049,.831948,.894209,-.233127,.35889,.865526,.906922,-.219579,.329915,.89818,.919686,-.204491,.300441,.930013,.929044,-.188962,.269445,.962061,.938393,-.171079,.238402,.994214,.94661,-.15199,.208204,1.02533,.953095,-.131953,.178653,1.0529,.958644,-.111233,.150684,1.0771,.963925,-.0903098,.122359,1.09855,.971995,-.0680505,.0923342,1.11874,.981658,-.0448512,.0614195,1.13635,.991649,-.0221931,.0303582,1.15238,.999985,393403e-9,-111086e-9,1.16772,.396806,-971563e-11,.457671,842355e-11,.429186,-249421e-9,.495017,21625e-8,.429324,-998052e-9,.495173,865322e-9,.429175,-.00224487,.494999,.00194637,.429129,-.00399041,.494952,.00346004,.429153,-.00623476,.494974,.00540684,.429168,-.0089773,.494983,.00778714,.429207,-.0122175,.495012,.0106022,.429257,-.0159542,.495047,.0138535,.429338,-.0201864,.495106,.0175443,.429431,-.0249104,.495165,.0216774,.429587,-.0301252,.495279,.0262594,.429796,-.0358249,.495432,.0312968,.430065,-.0419972,.495621,.0367985,.430588,-.0485144,.496061,.042798,.43113,-.0555028,.496472,.0492914,.431743,-.0629852,.496904,.0562907,.432448,-.0709256,.497369,.0638056,.433414,-.0791942,.498032,.071885,.434638,-.0877346,.498854,.0805517,.43611,-.0968056,.499812,.0898047,.437859,-.106002,.500891,.0997142,.440017,-.115648,.502198,.110289,.443236,-.125427,.504389,.121644,.44697,-.135492,.506809,.133769,.451689,-.145746,.509858,.146787,.45811,-.156219,.514247,.160793,.465305,-.166834,.518816,.175791,.474085,-.177546,.524331,.191906,.484808,-.188262,.53104,.209199,.49732,-.199346,.538511,.227825,.509693,-.209951,.544554,.247269,.524367,-.220533,.551616,.267978,.539228,-.231082,.557368,.289672,.55644,-.241342,.563782,.31268,.574204,-.250964,.568851,.33651,.593388,-.260306,.57312,.362219,.613358,-.268667,.574916,.390322,.634512,-.275591,.575053,.420478,.65563,-.281328,.572404,.451614,.678265,-.285948,.568893,.484112,.70011,-.289408,.561878,.517348,.723005,-.291328,.55359,.551355,.743744,-.291418,.541099,.585109,.763949,-.290252,.526489,.619487,.784186,-.287648,.509496,.65404,.804304,-.283782,.491484,.688649,.823629,-.278067,.470517,.723133,.84094,-.270588,.44705,.757163,.857852,-.261188,.421252,.792816,.874934,-.249313,.394191,.827248,.888709,-.236492,.365359,.861074,.902589,-.222185,.336016,.894417,.914201,-.207314,.30527,.926825,.925978,-.191146,.274532,.9595,.93512,-.174135,.243393,.991583,.943656,-.155231,.212414,1.02356,.951719,-.134403,.182005,1.05239,.957164,-.113023,.153043,1.07754,.962656,-.0914493,.124186,1.09984,.970695,-.0694179,.0941654,1.12,.980749,-.0466199,.0629671,1.13849,.991205,-.0227032,.0311146,1.15494,.999884,632388e-9,-254483e-9,1.1706,.379821,-957289e-11,.460637,789337e-11,.405188,-247483e-9,.491396,204064e-9,.404796,-989434e-9,.490914,815853e-9,.40483,-.00222607,.490949,.00183559,.40473,-.00395723,.49084,.00326332,.404731,-.00618287,.490836,.00509945,.404768,-.00890258,.490871,.00734463,.404791,-.0121156,.490883,.00999992,.404857,-.0158214,.490938,.0130676,.404943,-.0200178,.491004,.0165503,.405059,-.0247027,.491093,.0204521,.405213,-.0298729,.491205,.0247788,.405399,-.0355226,.491333,.0295373,.405731,-.0416352,.491604,.034741,.406303,-.0480807,.492116,.0404255,.406814,-.0550458,.492506,.0465732,.407404,-.0624652,.492926,.0532058,.408149,-.0702958,.493442,.0603442,.409128,-.0784623,.494136,.0680297,.410408,-.087007,.495054,.0762786,.411813,-.0959639,.495962,.0851046,.413735,-.105075,.497257,.0945878,.416137,-.114646,.498882,.104725,.41934,-.124394,.501132,.11563,.423326,-.134328,.503883,.127325,.428419,-.14458,.50747,.139911,.43484,-.154979,.511964,.153481,.442641,-.165628,.517328,.168114,.452511,-.176365,.524258,.183995,.463473,-.187298,.531248,.200953,.475564,-.198244,.538367,.219176,.488664,-.208938,.545175,.238514,.504073,-.219599,.553227,.259129,.520832,-.230378,.560653,.280997,.538455,-.240703,.567523,.303821,.55709,-.250548,.573287,.327948,.576646,-.259964,.577795,.353362,.596705,-.268721,.580077,.380336,.618053,-.276054,.58018,.4101,.640303,-.282176,.578747,.44161,.662365,-.286931,.574294,.474106,.684542,-.290521,.567035,.507549,.707984,-.292672,.558687,.541853,.730913,-.293189,.547606,.576581,.752948,-.292199,.533471,.61172,.773452,-.289508,.516395,.646339,.794715,-.285716,.497873,.682131,.814251,-.280051,.476845,.716396,.833057,-.272873,.453449,.751503,.84959,-.263982,.427857,.786085,.867022,-.252745,.400335,.821355,.882277,-.239655,.371304,.85646,.895375,-.225386,.340397,.890828,.909347,-.209587,.310005,.923532,.921885,-.193433,.2796,.956419,.932127,-.176135,.247276,.989445,.941869,-.157872,.216186,1.02221,.949735,-.137577,.185602,1.05195,.956617,-.115285,.155767,1.07822,.961974,-.0928418,.126103,1.10149,.96972,-.0700592,.0956758,1.12207,.98012,-.0474671,.0643269,1.1408,.990825,-.0238113,.0320863,1.1577,.999876,381574e-9,-812203e-10,1.17403,.367636,-961342e-11,.469176,753287e-11,.380377,-244772e-9,.485434,191797e-9,.380416,-978857e-9,.485475,767015e-9,.380376,-.00220165,.485435,.00172522,.380419,-.00391408,.485487,.00306734,.380438,-.00611549,.485505,.00479332,.380462,-.00880558,.485525,.00690391,.380496,-.0119837,.485551,.00940039,.38056,-.0156487,.485605,.0122848,.38064,-.0197988,.485666,.0155601,.380767,-.0244324,.48577,.0192313,.380909,-.0295444,.485871,.0233032,.381142,-.0351321,.48606,.0277861,.381472,-.0411535,.486336,.0326939,.382015,-.0475408,.486833,.0380565,.382523,-.0544395,.487231,.0438615,.383129,-.061784,.487683,.0501332,.383952,-.0695085,.488313,.0568996,.38498,-.0775819,.489077,.0641952,.386331,-.0860443,.490113,.0720324,.387788,-.0948406,.491099,.0804379,.389808,-.103899,.492566,.0894899,.39252,-.113313,.494601,.0992098,.395493,-.123007,.496619,.109641,.399826,-.132859,.499912,.120919,.405341,-.143077,.504061,.133107,.411932,-.153465,.508905,.146263,.420591,-.164108,.515482,.160544,.43101,-.174893,.523191,.176123,.441881,-.185839,.53026,.192757,.453919,-.196633,.537295,.210535,.468715,-.207611,.546156,.229886,.485182,-.218517,.555173,.250543,.501926,-.229249,.562728,.27221,.51785,-.239481,.567494,.294892,.536947,-.249395,.573889,.318987,.557115,-.259,.578831,.344348,.577966,-.268075,.582055,.371223,.599489,-.276115,.583307,.399834,.62479,-.282523,.583902,.431415,.647504,-.287663,.57953,.464301,.670601,-.291538,.573103,.498123,.693539,-.293842,.563731,.532662,.717385,-.294681,.553169,.567925,.741533,-.293717,.539908,.603502,.762142,-.291156,.521902,.639074,.783014,-.28719,.502815,.674439,.805158,-.281773,.482598,.710497,.823646,-.274682,.458949,.7456,.841879,-.266184,.433129,.781085,.859515,-.255682,.406064,.816,.875335,-.242849,.376509,.851074,.890147,-.228329,.345502,.886473,.903144,-.212491,.31428,.920751,.916618,-.195695,.282994,.954606,.927953,-.178267,.251091,.988402,.937414,-.159549,.219107,1.02141,.946823,-.140022,.18896,1.05167,.954651,-.118154,.158667,1.07819,.959955,-.0946636,.128808,1.1025,.96858,-.0711792,.0973787,1.12391,.97938,-.0475046,.0650965,1.14322,.990498,-.024059,.0326267,1.16077,.999844,-512408e-10,112444e-9,1.17727,.316912,-934977e-11,.425996,695559e-11,.356423,-241372e-9,.479108,179562e-9,.356272,-965292e-9,.478897,71811e-8,.356262,-.00217182,.478894,.00161574,.356265,-.00386092,.478895,.00287261,.356278,-.0060324,.478905,.00448907,.356293,-.00868565,.478914,.00646572,.356346,-.0118207,.478965,.00880438,.356395,-.0154355,.479001,.0115066,.356484,-.019529,.479075,.0145762,.356609,-.0240991,.47918,.018018,.356766,-.0291413,.479305,.0218379,.357009,-.0346498,.479512,.0260454,.357424,-.0405462,.479909,.0306657,.357899,-.0468825,.480337,.0357054,.358424,-.0536887,.480771,.0411728,.359041,-.0609416,.481242,.0470841,.359903,-.0685239,.481943,.0534831,.360932,-.0764883,.482741,.0603795,.362196,-.0848364,.483688,.0678028,.363847,-.0935002,.484947,.0758086,.365972,-.102471,.486588,.0844173,.368741,-.111751,.488787,.0937199,.372146,-.121334,.491405,.103732,.377114,-.131147,.495604,.114608,.38226,-.141213,.499436,.126345,.389609,-.151632,.505334,.139116,.397925,-.162073,.51168,.152995,.407824,-.172819,.518876,.168071,.420014,-.183929,.527639,.184495,.434266,-.195032,.537588,.20232,.447352,-.205792,.544379,.221189,.463726,-.216704,.553422,.241616,.481406,-.227531,.562074,.263298,.498707,-.238017,.568227,.286116,.518039,-.247936,.574473,.3101,.538277,-.257437,.579191,.335401,.561166,-.266829,.584807,.362246,.583189,-.275329,.586476,.390609,.606024,-.28234,.585578,.420998,.632419,-.287924,.584496,.454357,.656128,-.291972,.577766,.488233,.679953,-.29456,.56875,.523248,.704654,-.295816,.558388,.559168,.729016,-.295157,.544826,.595326,.752062,-.292779,.528273,.631864,.773138,-.288681,.508482,.667793,.794869,-.283358,.487341,.704035,.815101,-.27608,.46354,.739925,.834212,-.26767,.438672,.775539,.852368,-.257397,.411239,.810895,.870207,-.245689,.3829,.846472,.884063,-.231452,.351496,.881788,.898284,-.215561,.31895,.917438,.912964,-.198208,.287367,.952422,.924666,-.180426,.254487,.987551,.934429,-.161525,.222226,1.02142,.943485,-.141197,.191143,1.05218,.9521,-.120085,.161112,1.07937,.957876,-.0975881,.130982,1.10403,.966943,-.0726842,.0990553,1.12616,.978313,-.0483705,.0662818,1.14619,.990048,-.0239072,.0329243,1.16413,.999984,461885e-9,-772859e-10,1.18099,.321287,-935049e-11,.455413,659662e-11,.332595,-237513e-9,.471437,167562e-9,.332729,-949964e-9,.471618,670192e-9,.332305,-.00213618,.471028,.00150712,.332326,-.00379765,.471055,.00267959,.332344,-.00593353,.471072,.00418751,.332356,-.00854349,.471077,.00603172,.332403,-.0116268,.471121,.00821362,.332461,-.0151824,.47117,.0107357,.332552,-.0192088,.471251,.0136014,.332657,-.0237024,.47133,.0168152,.332835,-.0286615,.471487,.0203853,.333083,-.0340765,.471708,.0243212,.333547,-.0398563,.47219,.0286518,.333989,-.0460916,.472587,.0333763,.334532,-.0527897,.473054,.0385084,.335167,-.0599284,.473568,.0440638,.33608,-.0673514,.474362,.0500962,.337146,-.0752237,.475231,.0566022,.338462,-.083418,.476282,.0636272,.34014,-.0919382,.477615,.0712153,.342341,-.100741,.479404,.079417,.345088,-.109905,.481618,.0882631,.349049,-.119369,.485081,.0978851,.353939,-.129033,.489317,.108336,.359893,-.139038,.494309,.119698,.366945,-.149411,.499983,.132024,.375814,-.159843,.507185,.145558,.387112,-.170664,.516392,.160433,.40023,-.181897,.526519,.176648,.412555,-.192785,.53423,.193922,.427023,-.203663,.542741,.212662,.443685,-.214695,.552066,.232944,.461499,-.225561,.560762,.254495,.480975,-.236257,.569421,.277531,.501,-.24639,.576101,.301724,.521691,-.256101,.581493,.327112,.543478,-.265289,.585221,.353917,.566094,-.273938,.587614,.381941,.589578,-.281679,.587991,.41172,.614583,-.287655,.585928,.444148,.641813,-.292228,.582092,.478617,.666189,-.295172,.57398,.51397,.690475,-.29648,.561676,.550118,.715543,-.296203,.548758,.586933,.740405,-.293999,.532792,.62384,.762183,-.28998,.512735,.660723,.786069,-.28478,.492402,.69807,.806812,-.277568,.469058,.734422,.826987,-.268951,.443017,.770946,.844588,-.259049,.415501,.80699,.863725,-.2471,.387328,.842107,.879137,-.234157,.356108,.878078,.894634,-.218719,.324315,.914058,.909162,-.201293,.291813,.949922,.92072,-.18267,.258474,.985337,.93158,-.163212,.225593,1.0205,.941238,-.142771,.193986,1.05273,.949293,-.120956,.163392,1.08075,.956226,-.0985743,.132934,1.10559,.96546,-.075118,.101255,1.12823,.977403,-.0497921,.0675441,1.149,.989648,-.0241574,.0334681,1.16765,1.00001,5762e-7,-184807e-9,1.18519,.303474,-916603e-11,.4542,61243e-10,.308894,-232869e-9,.462306,155592e-9,.309426,-931661e-9,.463093,622499e-9,.308643,-.0020949,.461933,.00139979,.308651,-.0037242,.461941,.00248874,.308662,-.00581873,.46195,.00388933,.308687,-.00837818,.461974,.00560247,.308728,-.0114016,.462011,.00762948,.308789,-.0148884,.462067,.00997326,.308882,-.0188369,.462151,.0126375,.309007,-.0232436,.462263,.0156271,.30918,-.0281054,.462417,.0189498,.309442,-.0334065,.462667,.0226167,.309901,-.0390589,.463162,.0266614,.310331,-.0452042,.463555,.0310715,.310858,-.0517735,.464019,.0358698,.311576,-.0587359,.464669,.0410848,.312436,-.0660383,.465406,.0467453,.313526,-.0737266,.466339,.0528718,.314903,-.0817574,.467504,.0595039,.316814,-.090167,.469226,.0666888,.318965,-.0987555,.470981,.0744658,.322077,-.107792,.473814,.082912,.325947,-.117098,.477241,.0920846,.331008,-.126602,.48184,.102137,.337893,-.136619,.488334,.113135,.345106,-.146838,.494415,.12511,.355111,-.157357,.503275,.138356,.365095,-.167955,.510966,.152686,.378344,-.179157,.521508,.16856,.391599,-.190143,.530455,.18561,.407786,-.20123,.541275,.204308,.425294,-.212456,.551784,.224623,.444021,-.223568,.561493,.246172,.463418,-.234154,.569886,.268979,.484077,-.244546,.577116,.293411,.505513,-.254301,.582914,.318936,.527672,-.263564,.587208,.345856,.550565,-.272332,.589277,.374054,.573656,-.280011,.588426,.403276,.59827,-.286924,.587504,.43474,.624731,-.291994,.583401,.468767,.652396,-.295159,.576997,.504411,.67732,-.296954,.565863,.54114,.703147,-.296877,.552316,.57816,.728715,-.295147,.536773,.616124,.752448,-.291275,.51771,.653885,.775169,-.285905,.496087,.691537,.799307,-.279064,.474232,.729251,.819482,-.270294,.447676,.766267,.837659,-.260032,.419656,.802616,.856903,-.248497,.391328,.838583,.873325,-.235252,.360285,.874711,.889788,-.221126,.329215,.91077,.904486,-.204304,.296392,.94653,.917711,-.185562,.262159,.983828,.928969,-.165635,.229142,1.01955,.939707,-.14442,.19673,1.05317,.948167,-.122147,.165095,1.0823,.955222,-.099098,.13451,1.10791,.964401,-.0755332,.102476,1.1312,.976605,-.0513817,.0689667,1.15218,.989085,-.0258499,.034506,1.17129,.999908,617773e-9,-271268e-9,1.18961,.285803,-905752e-11,.452348,572272e-11,.284689,-22732e-8,.450581,143626e-9,.285263,-910214e-9,.451482,575099e-9,.285302,-.00204784,.451553,.00129395,.285318,-.00364057,.451574,.0023006,.28533,-.00568813,.451585,.00359547,.285361,-.00819001,.451618,.00517934,.285397,-.0111458,.45165,.007054,.285447,-.0145536,.451688,.00922167,.285527,-.0184127,.451758,.0116869,.285688,-.0227207,.451929,.0144555,.28584,-.0274712,.452055,.0175341,.286136,-.0326278,.452369,.0209406,.286574,-.0381792,.452853,.0246965,.287012,-.0441879,.453272,.0287996,.287542,-.0506096,.453752,.033268,.288299,-.0573634,.454488,.0381504,.289186,-.0645458,.455294,.0434447,.290302,-.0720405,.456301,.0491973,.291776,-.0799046,.457648,.0554453,.29372,-.088117,.459483,.0622311,.296052,-.0965328,.461571,.0695992,.299563,-.105409,.465085,.077658,.30335,-.114553,.468506,.0864176,.309167,-.123917,.474423,.0961078,.31529,-.13381,.47995,.106643,.324163,-.144021,.488592,.118322,.333272,-.154382,.496461,.131133,.344224,-.165015,.50562,.145208,.357733,-.176168,.516719,.16073,.373046,-.187468,.528513,.177807,.38788,-.198488,.537713,.196072,.405133,-.209545,.547999,.21605,.423845,-.220724,.55759,.237484,.443777,-.231518,.566246,.26039,.464824,-.242035,.574326,.284835,.486635,-.251898,.58037,.310518,.51012,-.261304,.58568,.337678,.535301,-.270384,.590197,.366242,.559193,-.27841,.590569,.395873,.583544,-.285325,.588161,.426857,.608834,-.291113,.584249,.459477,.635753,-.294882,.57763,.494734,.664367,-.297088,.569479,.532023,.689688,-.297364,.555064,.569629,.715732,-.295949,.539522,.608124,.741307,-.292259,.521613,.646231,.764949,-.287063,.49969,.684938,.788599,-.28012,.476747,.723548,.81048,-.27153,.45116,.761135,.831372,-.261289,.424101,.798916,.850092,-.249559,.39443,.835952,.867777,-.236348,.363849,.871606,.884632,-.221569,.332477,.907843,.90047,-.20618,.300667,.944187,.914524,-.188771,.266552,.981371,.926892,-.168362,.232349,1.01841,.937951,-.146761,.199359,1.05308,.947236,-.123813,.1675,1.0839,.954367,-.099984,.136166,1.11047,.963907,-.0759278,.103808,1.13414,.976218,-.0511367,.0697061,1.15575,.988772,-.0267415,.0352529,1.17531,.999888,-520778e-9,289926e-9,1.19389,.263546,-883274e-11,.441896,526783e-11,.262352,-221849e-9,.439889,132311e-9,.262325,-886683e-9,.439848,528824e-9,.26228,-.00199476,.439765,.00118975,.262372,-.00354671,.439922,.00211568,.26239,-.00554141,.439941,.00330652,.262412,-.00797888,.439961,.00476346,.262453,-.0108584,.440002,.00648818,.262528,-.0141788,.440085,.0084835,.262615,-.017938,.440166,.0107533,.262744,-.0221346,.440291,.0133044,.262939,-.026762,.440493,.0161445,.263277,-.0317573,.440889,.0192974,.26368,-.0371832,.441338,.0227699,.264106,-.0430371,.441753,.0265698,.264624,-.0493035,.442227,.0307178,.265378,-.0558669,.442985,.0352616,.266253,-.0628718,.443795,.0401968,.267478,-.0701569,.445008,.04559,.269062,-.077845,.446599,.0514539,.270926,-.0857941,.448349,.0578382,.273693,-.0940773,.451221,.0648363,.276746,-.102704,.454097,.0724389,.281693,-.111735,.459517,.0808744,.287335,-.121004,.46531,.0901551,.29448,-.130734,.472605,.100371,.30257,-.140777,.480251,.111644,.312465,-.15111,.489444,.124111,.324856,-.16189,.500919,.137979,.33774,-.172946,.511317,.153163,.35255,-.184152,.522684,.169817,.367786,-.19522,.53248,.187886,.385474,-.20632,.543326,.207634,.404976,-.217744,.554109,.229165,.425203,-.228691,.563395,.252068,.446704,-.239299,.571565,.276471,.468951,-.249348,.577935,.302323,.493487,-.258933,.584309,.329882,.517861,-.268009,.58773,.358525,.543309,-.276238,.589612,.388585,.569704,-.28356,.589294,.419787,.594871,-.289497,.585137,.452114,.622555,-.294452,.580356,.486466,.651167,-.296918,.57185,.523079,.677332,-.297647,.558428,.5611,.703718,-.296321,.542232,.599592,.730262,-.293339,.524541,.639138,.754304,-.288036,.502691,.677978,.778051,-.281018,.479212,.716537,.801557,-.272414,.454071,.75586,.822559,-.262419,.425952,.794477,.843051,-.250702,.397313,.832664,.86232,-.237264,.366534,.869876,.879044,-.222716,.334816,.906973,.896362,-.206827,.303143,.943558,.910342,-.189659,.269699,.979759,.924119,-.171108,.236411,1.01718,.935374,-.149579,.202224,1.05289,.944295,-.126295,.16989,1.08496,.952227,-.101511,.138089,1.11256,.962041,-.0766392,.105053,1.1375,.97528,-.0511967,.070329,1.15983,.988476,-.025463,.0351268,1.17987,.999962,286808e-10,145564e-10,1.19901,.227089,-841413e-11,.404216,472707e-11,.239725,-215083e-9,.426708,120833e-9,.239904,-860718e-9,.427028,483555e-9,.239911,-.00193661,.427039,.00108806,.239914,-.00344276,.42704,.00193457,.239933,-.00537907,.427064,.00302363,.239944,-.00774482,.427065,.00435604,.239993,-.01054,.427122,.00593398,.240052,-.0137626,.427179,.00775987,.240148,-.0174115,.427279,.00983854,.240278,-.021484,.42741,.0121763,.240472,-.0259729,.427618,.0147827,.240839,-.0308131,.428086,.0176837,.241201,-.0360893,.428482,.0208775,.241626,-.0417723,.428907,.0243821,.242207,-.0478337,.42952,.0282228,.24298,-.0542199,.430332,.0324333,.243881,-.0610015,.431222,.0370252,.245123,-.0680874,.432512,.0420535,.24667,-.0755482,.434088,.0475414,.248779,-.0832873,.436323,.0535542,.251665,-.0913546,.439509,.0601716,.255305,-.0998489,.443478,.0674282,.260049,-.108576,.448713,.0754673,.266192,-.117754,.455524,.084339,.273158,-.127294,.4627,.0941683,.282131,-.137311,.472068,.10515,.293332,-.147736,.483565,.117402,.304667,-.158357,.493702,.130824,.317785,-.169274,.504708,.145724,.333245,-.180595,.517107,.16215,.349843,-.191892,.528849,.180149,.367944,-.203168,.540301,.199746,.387579,-.214443,.551514,.221047,.408247,-.225624,.560906,.243981,.43014,-.236422,.56959,.268513,.452669,-.24654,.576098,.294409,.476196,-.256157,.580925,.322002,.501157,-.265289,.584839,.351052,.527632,-.273671,.587614,.3812,.555754,-.281254,.589119,.412994,.581682,-.287448,.585204,.445498,.608196,-.292614,.579006,.479505,.635661,-.296068,.571297,.514643,.664999,-.297395,.560855,.552213,.691039,-.296645,.544525,.591365,.7179,-.293785,.526535,.630883,.744059,-.289089,.50545,.670932,.76863,-.282239,.482514,.710904,.793273,-.273688,.457246,.750259,.814731,-.26328,.428872,.78948,.835603,-.251526,.399384,.828597,.85489,-.238339,.368811,.866892,.872828,-.223607,.336617,.90563,.889462,-.207538,.303997,.943538,.904929,-.190297,.270812,.980591,.919101,-.172034,.237453,1.01935,.930536,-.152058,.204431,1.05498,.941223,-.129515,.172495,1.08717,.94982,-.104263,.140175,1.11551,.960592,-.0781944,.106465,1.14098,.974629,-.051688,.0711592,1.16418,.98811,-.0253929,.0354432,1.18465,1.00004,804378e-9,-330876e-9,1.20462,.214668,-821282e-11,.406619,433582e-11,.218053,-208144e-9,.413025,109887e-9,.217987,-832212e-9,.412901,439362e-9,.217971,-.00187246,.412876,988623e-9,.217968,-.00332855,.41286,.00175772,.217985,-.00520055,.412882,.00274729,.218014,-.00748814,.412916,.00395842,.218054,-.0101901,.412957,.00539274,.218106,-.0133057,.413005,.00705348,.218217,-.0168342,.413139,.00894581,.218338,-.0207707,.413258,.0110754,.21855,-.0251001,.413509,.0134551,.218913,-.0297861,.413992,.0161081,.219265,-.0348956,.414383,.0190307,.219696,-.0403909,.414839,.0222458,.220329,-.0462003,.415567,.025792,.220989,-.0524208,.41621,.0296637,.222027,-.058948,.417385,.0339323,.223301,-.0658208,.418779,.0386055,.224988,-.0730347,.420665,.0437355,.227211,-.0805274,.423198,.0493844,.230131,-.088395,.426566,.0556135,.233908,-.0966208,.43091,.0624829,.239092,-.105223,.437148,.0701636,.245315,-.11424,.444302,.0786949,.253166,-.12368,.453262,.0882382,.262374,-.133569,.463211,.0988682,.273145,-.143836,.474271,.110727,.285512,-.154577,.4863,.123945,.299512,-.165501,.498817,.138581,.314287,-.176698,.510341,.154676,.331083,-.188066,.522583,.172459,.349615,-.199597,.534879,.191979,.369318,-.210843,.546083,.21309,.390377,-.222068,.5562,.235998,.412411,-.233059,.564704,.260518,.435715,-.24357,.572314,.286795,.461196,-.253356,.579395,.314559,.485587,-.262362,.581985,.343581,.511908,-.270895,.584347,.374367,.539798,-.278452,.58505,.406015,.567974,-.284877,.583344,.439168,.594303,-.290124,.577348,.473005,.622951,-.294183,.570751,.508534,.652404,-.296389,.561541,.544764,.679291,-.296605,.546426,.582927,.706437,-.294095,.528599,.622681,.734485,-.28978,.508676,.663567,.758841,-.283363,.484768,.704092,.78537,-.275015,.460434,.745101,.807315,-.264689,.432166,.784712,.8271,-.252597,.401807,.824241,.849191,-.239154,.371458,.863803,.867046,-.224451,.338873,.903063,.8852,-.208342,.306175,.942763,.901771,-.190684,.272759,.981559,.915958,-.172105,.239306,1.02048,.928046,-.152214,.206071,1.05765,.939961,-.130247,.17367,1.08999,.948711,-.10672,.142201,1.11829,.959305,-.0808688,.108454,1.14467,.973009,-.0539145,.0728109,1.16839,.987631,-.0262947,.0360625,1.19004,.999978,.00132758,-559424e-9,1.21058,.193925,-793421e-11,.391974,392537e-11,.196746,-200315e-9,.397675,991033e-10,.19667,-801099e-9,.397521,396342e-9,.196633,-.00180246,.397445,891829e-9,.196654,-.00320443,.397482,.00158582,.196659,-.00500647,.39748,.00247867,.196683,-.0072086,.397506,.00357167,.196728,-.00981001,.397562,.00486675,.196792,-.0128096,.397633,.00636707,.19689,-.0162055,.397746,.00807752,.197017,-.0199943,.397884,.0100052,.19729,-.024139,.39827,.0121691,.197583,-.0286671,.398639,.0145755,.197927,-.0335858,.399034,.0172355,.198383,-.0388806,.399554,.0201718,.199002,-.0444736,.400289,.0234194,.199739,-.0504583,.401111,.026984,.200784,-.056729,.402349,.0309217,.202075,-.0633643,.403841,.0352496,.203898,-.0703247,.406076,.0400313,.206199,-.0775565,.408841,.0453282,.209252,-.085184,.41259,.0511794,.213638,-.0931994,.418288,.0577459,.21881,-.101617,.424681,.0650508,.225642,-.11052,.433429,.0732759,.233717,-.119772,.442897,.0824683,.242823,-.129505,.452888,.0927484,.254772,-.139906,.466407,.104417,.266603,-.150402,.477413,.117211,.28073,-.161395,.490519,.131598,.295399,-.172465,.50201,.147407,.312705,-.183982,.515311,.165031,.331335,-.195532,.52786,.184336,.351037,-.206971,.5392,.205361,.372175,-.218117,.54941,.228043,.394548,-.229327,.558642,.25267,.419598,-.240052,.567861,.279071,.443922,-.249937,.573332,.306882,.471495,-.259407,.58013,.33661,.496769,-.267749,.580564,.367328,.524951,-.275524,.581696,.399753,.55318,-.282148,.579885,.433134,.581577,-.287533,.575471,.467534,.609231,-.291612,.567445,.502943,.637478,-.293911,.557657,.53871,.667795,-.295096,.546535,.576568,.694272,-.294073,.529561,.614929,.722937,-.290386,.510561,.655909,.749682,-.284481,.487846,.697663,.774754,-.276188,.462487,.738515,.799301,-.266215,.43481,.779802,.820762,-.254116,.404879,.820045,.843231,-.240393,.374559,.860294,.861857,-.225503,.341582,.900965,.880815,-.209382,.308778,.941727,.89766,-.19155,.275232,.980916,.912926,-.172346,.240938,1.02162,.926391,-.151799,.207223,1.0597,.938429,-.129968,.17484,1.09291,.947834,-.10651,.142984,1.12248,.958432,-.0824098,.109902,1.149,.972402,-.0565242,.0744454,1.1733,.987191,-.028427,.0373794,1.19538,.999975,385685e-10,-4203e-8,1.21676,.178114,-766075e-11,.385418,354027e-11,.176074,-191966e-9,.381002,887135e-10,.17601,-767549e-9,.380861,354715e-9,.17598,-.00172696,.380798,798168e-9,.175994,-.00307012,.380824,.00141928,.176017,-.00479684,.380858,.00221859,.176019,-.00690648,.380839,.00319714,.176072,-.00939888,.380913,.0043572,.176131,-.0122726,.380979,.005702,.176239,-.0155264,.38112,.00723689,.176371,-.0191551,.381272,.00896907,.176638,-.023117,.381669,.0109194,.176912,-.0274633,.382015,.0130903,.177279,-.032173,.382476,.0154949,.17774,-.0372219,.383041,.0181669,.178344,-.0426132,.38378,.0211209,.179153,-.0483309,.384773,.0243899,.180197,-.0543447,.386076,.0280062,.181581,-.0607122,.387809,.032004,.18344,-.0673855,.390205,.036453,.186139,-.0743989,.393944,.0414162,.189432,-.0817731,.39832,.0469394,.193795,-.0895464,.404188,.0531442,.199641,-.0978264,.4121,.0601374,.206679,-.106499,.421425,.0680078,.214865,-.115654,.431504,.076919,.224406,-.125268,.442526,.0868835,.235876,-.135475,.455465,.0981875,.248335,-.146023,.4681,.110759,.262868,-.157016,.482069,.124885,.278962,-.168245,.496182,.140645,.295082,-.17958,.507401,.157838,.313738,-.191227,.520252,.17695,.333573,-.202718,.531708,.197817,.356433,-.214424,.544509,.220785,.378853,-.225492,.55373,.245306,.402717,-.236236,.561348,.271593,.428375,-.246568,.568538,.299776,.454724,-.255941,.573462,.329433,.482291,-.264511,.576356,.360598,.509706,-.272129,.576446,.393204,.538805,-.278979,.575298,.427227,.568919,-.284528,.572154,.462157,.596804,-.288801,.564691,.497997,.625987,-.291334,.555134,.534467,.656414,-.292722,.545051,.571736,.683916,-.292185,.528813,.610158,.711809,-.290043,.51106,.649061,.739547,-.285246,.490103,.690081,.766914,-.277647,.465523,.732554,.791375,-.267603,.437718,.773982,.814772,-.256109,.40882,.81609,.836691,-.242281,.377823,.856849,.856984,-.227155,.34496,.898363,.876332,-.210395,.311335,.939471,.894988,-.192612,.277703,.980799,.911113,-.173236,.243019,1.02215,.924092,-.152258,.209037,1.06139,.936828,-.129575,.175909,1.09635,.946869,-.10594,.143852,1.12707,.958284,-.081318,.110289,1.15419,.972325,-.0556133,.0747232,1.17909,.986878,-.0297899,.0383149,1.20163,.999936,-.00197169,912402e-9,1.22338,.151174,-720365e-11,.351531,309789e-11,.155594,-18279e-8,.361806,78608e-9,.156099,-731569e-9,.362982,314615e-9,.156053,-.00164578,.362869,707845e-9,.156093,-.0029261,.362961,.00125884,.156099,-.00457155,.362959,.00196783,.15612,-.00658224,.362982,.00283622,.156168,-.00895774,.363048,.00386625,.156221,-.0116962,.363101,.00506109,.156324,-.0147973,.363241,.00642675,.156476,-.0182503,.363448,.00797175,.156731,-.0220266,.36384,.00971484,.156994,-.026176,.364179,.0116575,.157341,-.0306701,.36462,.0138207,.157867,-.0354591,.365364,.0162356,.15846,-.0406141,.366111,.0189092,.159308,-.0460519,.367248,.021885,.160426,-.0518096,.368767,.0252004,.161877,-.0578906,.370745,.0288825,.163995,-.0642812,.373831,.0330139,.16655,-.0710067,.377366,.0376283,.170237,-.0781522,.382799,.0428493,.175096,-.0857172,.389915,.0487324,.181069,-.0938025,.398487,.0554214,.188487,-.102363,.408799,.0630189,.197029,-.111343,.419991,.071634,.206684,-.120812,.431455,.0812797,.218698,-.131033,.445746,.0923651,.230726,-.141373,.457471,.104545,.245516,-.152387,.472388,.118449,.261551,-.163628,.486671,.133923,.277437,-.174814,.49762,.150849,.296662,-.186713,.51162,.169924,.31795,-.198513,.525435,.190848,.339422,-.210119,.536267,.213504,.362143,-.221354,.545982,.237947,.387198,-.23224,.555364,.264427,.412349,-.24257,.561489,.292519,.439274,-.252284,.566903,.322561,.466779,-.261023,.569614,.353952,.496011,-.26899,.571589,.387278,.524964,-.275498,.570325,.421356,.556518,-.281449,.568792,.457314,.584363,-.285526,.560268,.493199,.614214,-.28844,.55205,.530276,.645684,-.289777,.541906,.56855,.673446,-.289722,.526464,.606927,.701924,-.287792,.509872,.645945,.73037,-.284315,.490649,.685564,.757405,-.278804,.467964,.726511,.784025,-.269543,.441468,.768601,.808255,-.258117,.41216,.811321,.830739,-.244728,.380606,.853496,.851914,-.229428,.348111,.895374,.872586,-.212508,.314732,.937674,.891581,-.194025,.280338,.979869,.907641,-.174711,.245203,1.02253,.922233,-.153509,.21077,1.06371,.935878,-.130418,.177399,1.09972,.946338,-.105558,.144507,1.13124,.957265,-.080059,.110508,1.15973,.971668,-.0539766,.0742311,1.18515,.9866,-.0277101,.0375224,1.20858,1.00021,-515531e-9,135226e-9,1.23135,.137468,-686011e-11,.345041,273315e-11,.13703,-173378e-9,.343936,690761e-10,.136986,-693048e-9,.34383,276126e-9,.136964,-.00155931,.343761,621337e-9,.137003,-.00277211,.343863,.00110494,.137012,-.00433103,.343868,.00172744,.137043,-.00623606,.343916,.00249022,.13709,-.0084868,.343986,.00339559,.137145,-.0110814,.344045,.00444687,.137242,-.0140187,.344177,.00565007,.137431,-.0172713,.344491,.00701868,.137644,-.0208605,.344805,.00856042,.13791,-.024792,.345172,.0102863,.138295,-.0290461,.345734,.0122185,.138764,-.0335957,.346371,.0143771,.139415,-.038467,.347298,.0167894,.140272,-.0436176,.348527,.0194895,.141457,-.0491016,.350276,.0225043,.14303,-.0548764,.352646,.0258962,.145289,-.0610096,.356206,.0297168,.148502,-.0674777,.361488,.0340562,.152188,-.074345,.367103,.0389534,.157359,-.0817442,.375247,.0445541,.16379,-.0896334,.385064,.0509535,.171376,-.098005,.396082,.0582611,.179901,-.106817,.407418,.06654,.189892,-.116239,.420031,.075994,.201838,-.12627,.434321,.0867239,.214311,-.136701,.447631,.0987517,.228902,-.147616,.462046,.112353,.245107,-.158871,.476942,.127605,.262292,-.170261,.490285,.144469,.281215,-.182017,.503783,.163282,.301058,-.193729,.515505,.183873,.322752,-.205512,.52682,.206466,.347547,-.217214,.539473,.231194,.370969,-.227966,.546625,.257288,.397533,-.238555,.55472,.285789,.42398,-.248278,.559468,.315746,.452928,-.257422,.564095,.347724,.482121,-.265306,.565426,.380922,.510438,-.272043,.563205,.415639,.541188,-.277614,.561087,.451702,.571667,-.281927,.554922,.48845,.602432,-.285015,.546838,.526442,.634126,-.286512,.537415,.564896,.662816,-.286388,.522906,.604037,.692411,-.284734,.507003,.643795,.720946,-.281297,.488398,.68298,.748293,-.276262,.466353,.723466,.776931,-.269978,.443573,.764565,.801065,-.260305,.415279,.805838,.825843,-.247426,.384773,.849985,.84807,-.232437,.352555,.893174,.869122,-.215806,.318642,.936564,.888963,-.197307,.28381,.980253,.905547,-.177203,.247888,1.02463,.918554,-.155542,.212904,1.06714,.931395,-.131948,.1787,1.10451,.941749,-.106723,.145902,1.13694,.954551,-.0804939,.111193,1.1666,.970279,-.0534239,.0744697,1.19249,.986117,-.0257452,.0368788,1.21665,.999938,.00190634,-.0010291,1.23981,.118493,-647439e-11,.32272,23772e-10,.118765,-163023e-9,.323456,598573e-10,.118772,-65212e-8,.323477,239447e-9,.118843,-.00146741,.323657,538881e-9,.118804,-.00260846,.323553,95826e-8,.118826,-.00407576,.323595,.00149845,.118846,-.00586826,.323617,.00216047,.118886,-.00798578,.32367,.00294679,.118947,-.0104273,.323753,.00386124,.119055,-.0131909,.323922,.00490999,.119241,-.0162444,.324251,.00610804,.11944,-.0196339,.324544,.00745805,.119739,-.0233378,.325026,.00897805,.12011,-.0273179,.325586,.0106895,.120571,-.0316143,.326231,.0126073,.12124,-.0361939,.327264,.0147654,.122162,-.0410511,.328733,.0172001,.123378,-.0462233,.330659,.0199375,.125183,-.0517109,.333754,.0230498,.127832,-.0575652,.338507,.026597,.130909,-.0637441,.343666,.0306345,.135221,-.0704302,.351063,.035273,.14082,-.0776364,.360604,.0406137,.146781,-.0852293,.369638,.0466788,.155121,-.0935351,.3827,.0537628,.16398,-.102234,.39522,.0617985,.173926,-.111465,.40793,.07097,.185137,-.121296,.42105,.0813426,.19826,-.13169,.435735,.0931596,.212938,-.142614,.450932,.106547,.229046,-.153884,.465726,.121575,.246246,-.165382,.479461,.138286,.264637,-.176806,.492106,.15666,.284959,-.188793,.504774,.17728,.308157,-.200763,.518805,.19988,.330951,-.21239,.528231,.224293,.3549,-.223521,.536376,.250541,.381502,-.234169,.544846,.278902,.409529,-.244077,.551717,.309227,.437523,-.253363,.55517,.341426,.467624,-.261659,.557772,.37518,.497268,-.268498,.556442,.41007,.528294,-.274018,.553915,.446445,.559053,-.278169,.549153,.483779,.589329,-.281229,.539878,.522249,.622503,-.282902,.53162,.561754,.652382,-.282815,.518119,.601544,.681847,-.281247,.502187,.641574,.712285,-.277986,.484824,.682633,.740094,-.273017,.463483,.723426,.768478,-.266692,.441299,.763747,.794556,-.258358,.415238,.805565,.819408,-.248807,.386912,.847254,.843411,-.236214,.356165,.891091,.862397,-.219794,.320562,.936174,.883113,-.201768,.285322,.982562,.90023,-.181672,.249713,1.02862,.915192,-.159279,.214546,1.07163,.928458,-.134725,.180285,1.10995,.94069,-.10913,.147119,1.14354,.953409,-.0821315,.112492,1.17372,.969537,-.0542677,.0752014,1.20043,.985612,-.0259096,.0370361,1.22528,.999835,.00298198,-.00151801,1.24959,.10097,-602574e-11,.300277,202619e-11,.101577,-152164e-9,.302077,511662e-10,.101572,-608889e-9,.302066,204751e-9,.101566,-.00136997,.302047,460753e-9,.101592,-.00243557,.302114,819497e-9,.101608,-.0038053,.30214,.00128154,.101627,-.00547906,.30216,.0018483,.101669,-.00745647,.302224,.00252223,.101732,-.00973615,.302318,.00330716,.101844,-.0123097,.302513,.00421061,.102025,-.0151681,.30285,.00524481,.102224,-.0183334,.303166,.0064154,.102515,-.0217819,.303654,.00774063,.102886,-.0255067,.304243,.0092398,.103395,-.029514,.305089,.0109339,.104109,-.0337912,.306301,.0128561,.105074,-.0383565,.30798,.0150338,.10654,-.0432132,.310726,.0175228,.108478,-.0484244,.314351,.0203648,.111015,-.0539339,.319032,.0236325,.114682,-.0598885,.32605,.0274188,.11911,-.0663375,.334109,.0317905,.124736,-.0733011,.344013,.0368502,.131479,-.0807744,.355358,.0427104,.139283,-.0888204,.367614,.0494788,.148054,-.0973394,.380072,.0572367,.159037,-.10665,.395678,.0662704,.169794,-.116221,.40795,.0763192,.18314,-.126632,.423546,.087956,.197515,-.137383,.438213,.101042,.213514,-.148641,.453248,.115827,.23065,-.160117,.46688,.132283,.249148,-.171807,.479962,.150644,.270219,-.183695,.494618,.171073,.292338,-.195574,.506937,.193378,.314999,-.207205,.516463,.217585,.340991,-.218955,.528123,.24428,.367982,-.229917,.537025,.272784,.39432,-.239737,.541627,.302742,.423364,-.249048,.546466,.335112,.453751,-.257329,.549466,.369032,.48416,-.264623,.549503,.404577,.515262,-.270411,.547008,.441337,.547036,-.274581,.542249,.479162,.576614,-.277266,.533015,.517904,.611143,-.279144,.525512,.558508,.640989,-.279001,.51154,.598995,.671182,-.277324,.495641,.639935,.700848,-.273908,.477526,.681017,.729862,-.269063,.457955,.722764,.758273,-.262282,.434846,.764349,.784121,-.254281,.409203,.806206,.809798,-.24505,.382694,.848617,.834953,-.233861,.354034,.892445,.856817,-.221308,.321764,.936263,.877609,-.205996,.288118,.982401,.897489,-.186702,.253277,1.02975,.913792,-.164618,.217963,1.07488,.92785,-.140023,.183221,1.11487,.940378,-.11328,.149385,1.14947,.95273,-.0853958,.114152,1.1807,.969059,-.0568698,.0769845,1.20912,.985574,-.0276502,.0381186,1.23498,.999943,.00239052,-.00126861,1.25987,.0852715,-560067e-11,.279021,171162e-11,.0854143,-140871e-9,.279483,430516e-10,.0854191,-563385e-9,.2795,172184e-9,.0854188,-.00126753,.279493,387464e-9,.0854229,-.00225337,.279501,68918e-8,.0854443,-.00352086,.279549,.00107803,.0854697,-.00506962,.279591,.00155536,.0855093,-.00689873,.279652,.00212354,.0855724,-.00900821,.279752,.00278703,.0856991,-.0113799,.280011,.0035551,.085855,-.0140314,.280297,.00443449,.0860682,-.016963,.280682,.00543636,.086344,-.0201438,.281159,.0065788,.0867426,-.0235999,.281886,.00787977,.087239,-.0273069,.282745,.0093606,.0879815,-.031269,.284139,.011056,.0891258,-.035531,.28647,.0130065,.0906909,-.0400947,.289708,.0152495,.0927624,-.0449638,.293904,.0178454,.0958376,-.0502427,.300471,.0208915,.0995827,-.0559514,.30806,.0244247,.104526,-.0622152,.317874,.0285721,.110532,-.0690046,.329332,.0334227,.117385,-.0763068,.341217,.0390466,.12522,-.084184,.353968,.0455786,.134037,-.0925248,.366797,.0530773,.144014,-.101487,.380209,.0617424,.156013,-.111273,.395956,.071777,.168872,-.121431,.41053,.0830905,.183089,-.132105,.425073,.0959341,.198763,-.143286,.439833,.110448,.216159,-.154841,.454507,.126769,.234859,-.166588,.468368,.14495,.255879,-.178626,.482846,.165233,.27677,-.190218,.493489,.187217,.301184,-.202227,.506549,.211659,.325852,-.213764,.5158,.237922,.352824,-.22487,.525442,.26632,.380882,-.235246,.532487,.296691,.410137,-.244847,.537703,.329179,.439787,-.253122,.540361,.363135,.472291,-.260517,.542734,.399222,.501856,-.266519,.538826,.436352,.534816,-.270905,.535152,.474505,.565069,-.273826,.525979,.513988,.597154,-.275333,.516394,.554852,.630473,-.275314,.506206,.596592,.660574,-.273323,.489769,.638117,.692015,-.270008,.472578,.680457,.720647,-.265001,.452134,.723008,.750528,-.258311,.430344,.765954,.777568,-.250046,.405624,.809012,.80387,-.240114,.378339,.852425,.828439,-.228737,.349877,.895346,.851472,-.216632,.318968,.940695,.873906,-.202782,.287489,.987235,.89467,-.187059,.254394,1.03348,.912281,-.168818,.221294,1.07812,.927358,-.146494,.18675,1.11928,.940385,-.120009,.152322,1.15609,.952672,-.0917183,.117514,1.18875,.968496,-.0620321,.0797405,1.21821,.985236,-.0314945,.0402383,1.24523,.99998,-575153e-9,110644e-9,1.27133,.0702429,-512222e-11,.255273,140947e-11,.0702981,-128826e-9,.255469,354488e-10,.0703691,-515562e-9,.255727,141874e-9,.0703805,-.00116,.255754,31929e-8,.0703961,-.00206224,.255813,567999e-9,.0704102,-.00322223,.255839,88871e-8,.0704298,-.00463928,.255863,.00128272,.0704759,-.00631375,.255953,.00175283,.0705434,-.00824317,.256079,.00230342,.0706693,-.010412,.25636,.0029443,.0708189,-.0128439,.256647,.00368031,.0710364,-.0155177,.257084,.00452614,.0713223,-.0184374,.257637,.00549706,.0717182,-.0216002,.258416,.00661246,.072321,-.0249966,.259699,.00790147,.0731446,-.0286566,.261475,.0093884,.0743352,-.0325888,.264132,.0111186,.0760676,-.036843,.26815,.013145,.078454,-.0414292,.273636,.0155251,.0818618,-.0464634,.281653,.0183525,.0857382,-.0519478,.289992,.0216642,.0908131,-.0579836,.30066,.0255956,.0967512,-.0645124,.312204,.0301954,.103717,-.0716505,.325001,.0356017,.111596,-.0793232,.338129,.041896,.120933,-.087645,.352853,.0492447,.130787,-.096492,.366192,.0576749,.142311,-.105973,.380864,.0673969,.155344,-.116182,.396575,.0785899,.169535,-.126815,.411443,.0912377,.185173,-.138015,.426256,.105607,.201755,-.149325,.439607,.121551,.221334,-.161207,.455467,.139608,.241461,-.173162,.469096,.159591,.26294,-.18504,.481014,.18156,.286776,-.196881,.493291,.205781,.311596,-.208311,.503556,.231819,.338667,-.219671,.513268,.260274,.366021,-.230451,.519414,.290862,.395875,-.240131,.526766,.323196,.425564,-.248566,.52905,.357071,.457094,-.256195,.530796,.393262,.488286,-.262331,.528703,.430797,.522291,-.267141,.52727,.470231,.554172,-.270411,.519848,.510477,.586427,-.271986,.510307,.551594,.619638,-.27192,.499158,.593849,.650656,-.269817,.483852,.636314,.68284,-.266267,.467515,.679679,.714356,-.26113,.44931,.723884,.742717,-.254067,.425789,.767245,.770894,-.245652,.401144,.811819,.797358,-.235554,.374224,.856315,.823377,-.223896,.346167,.901077,.847456,-.210865,.316056,.946502,.870697,-.196574,.284503,.993711,.891068,-.180814,.251628,1.04134,.909267,-.163314,.219065,1.08609,.925653,-.143304,.186446,1.12702,.940017,-.121322,.153416,1.16371,.952398,-.0973872,.120334,1.19712,.967568,-.0698785,.08352,1.22791,.984772,-.0390031,.0439209,1.25672,1.00026,-.0070087,.00315668,1.28428,.0556653,-459654e-11,.227325,112556e-11,.0565238,-116382e-9,.230826,284985e-10,.0565717,-465666e-9,.231026,114036e-9,.0565859,-.00104773,.231079,256656e-9,.0565761,-.00186255,.231025,45663e-8,.0565913,-.00291002,.231058,714664e-9,.0566108,-.00418998,.231085,.00103224,.0566532,-.00570206,.231169,.00141202,.0567473,-.00743666,.231417,.00186018,.0568567,-.00940298,.231661,.00238264,.0569859,-.0115991,.231895,.00298699,.0572221,-.0140096,.232456,.00368957,.057519,-.0166508,.233096,.00450303,.0579534,-.01951,.234094,.00544945,.0585922,-.0225991,.235629,.00655564,.0595647,-.0259416,.238106,.00785724,.0609109,-.0295661,.241557,.00939127,.0628751,-.0335126,.246652,.0112198,.0656908,-.0378604,.254091,.0134168,.0691347,-.0426543,.262666,.0160374,.0732165,-.0478967,.272029,.0191514,.0782863,-.0536716,.283007,.0228597,.0843973,-.0600683,.295732,.0272829,.0913598,-.0670095,.308779,.032484,.0994407,-.0745516,.322886,.0385886,.108189,-.082712,.336408,.0457133,.118574,-.0914927,.351692,.0539832,.129989,-.100854,.366502,.0635162,.142722,-.110837,.381675,.0744386,.156654,-.121353,.3963,.0868483,.172151,-.132414,.411477,.100963,.188712,-.143809,.42508,.116795,.208093,-.155765,.441328,.134715,.227936,-.167608,.454328,.154396,.249495,-.179579,.467235,.176179,.27362,-.191488,.480248,.200193,.296371,-.202618,.487886,.225775,.324234,-.214133,.499632,.25441,.353049,-.225212,.509532,.285077,.381785,-.234875,.514265,.317047,.414038,-.244205,.521282,.351874,.445251,-.252145,.522931,.388279,.476819,-.258433,.520947,.425825,.509209,-.263411,.517669,.465104,.542759,-.266732,.512841,.505741,.574822,-.268263,.503317,.547611,.609324,-.268489,.493035,.590953,.641772,-.266941,.478816,.63488,.674049,-.263297,.462863,.679072,.705071,-.257618,.442931,.723487,.734709,-.250625,.421299,.768708,.763704,-.24179,.397085,.814375,.791818,-.231115,.370577,.859907,.817439,-.21922,.34232,.906715,.843202,-.205658,.312627,.953943,.866639,-.190563,.280933,1.00185,.888129,-.173978,.248393,1.05105,.907239,-.155485,.216007,1.09704,.923893,-.134782,.183233,1.13857,.938882,-.11249,.150376,1.17539,.952464,-.0890706,.117177,1.20924,.968529,-.0646523,.0813095,1.24055,.984763,-.038606,.0439378,1.27018,1.00053,-.01238,.00598668,1.29873,.0437928,-409594e-11,.204012,8.79224e-7,.0440166,-103395e-9,.205049,221946e-10,.0440529,-413633e-9,.205225,887981e-10,.0440493,-930594e-9,.2052,199858e-9,.0439884,-.00165352,.204901,355495e-9,.0440716,-.0025849,.205255,556983e-9,.0440968,-.00372222,.205311,805326e-9,.0441359,-.00506478,.205391,.00110333,.0442231,-.00660384,.205638,.00145768,.0443254,-.00835246,.205877,.00187275,.0444832,-.0102992,.20627,.00235938,.0447001,-.0124449,.206796,.0029299,.0450168,-.0147935,.207593,.0036005,.0454816,-.017336,.208819,.00439246,.0462446,-.0201156,.211036,.00533864,.0473694,-.0231568,.214388,.00646984,.0490191,-.0264941,.219357,.00783856,.0512776,-.030184,.226061,.00950182,.0541279,-.0342661,.234094,.0115156,.0578989,-.0388539,.244297,.0139687,.0620835,-.0438735,.254457,.0169015,.0673497,-.04951,.266706,.0204554,.0731759,-.0556263,.278753,.0246606,.0803937,-.0624585,.29309,.0297126,.0879287,-.0697556,.305856,.0355868,.0970669,-.0778795,.321059,.0425768,.106508,-.0863541,.333873,.05056,.11776,-.0955935,.349008,.0598972,.130081,-.105438,.363776,.0706314,.144454,-.115899,.380112,.0828822,.1596,-.126827,.394843,.0967611,.176097,-.138161,.409033,.112381,.194726,-.149904,.424257,.129952,.213944,-.161675,.436945,.149333,.235516,-.173659,.450176,.170892,.260564,-.185963,.466305,.194984,.285183,-.197582,.477328,.220805,.311095,-.208697,.486566,.248694,.338924,-.219519,.494811,.279015,.369757,-.229766,.504065,.311725,.3996,-.238879,.507909,.345844,.430484,-.246802,.509805,.381749,.46413,-.253924,.511436,.420251,.497077,-.259319,.508787,.459957,.530434,-.263297,.50394,.501356,.565725,-.265619,.49804,.544252,.599254,-.265842,.487346,.587856,.631251,-.263978,.472975,.631969,.663972,-.26043,.457135,.677471,.697724,-.255358,.439844,.723744,.727725,-.248308,.417872,.770653,.756417,-.239181,.39273,.817357,.785419,-.22814,.367839,.864221,.81266,-.215681,.339449,.912701,.839391,-.201623,.309279,.962419,.86366,-.185624,.278029,1.0122,.885028,-.16797,.245294,1.06186,.904639,-.148336,.212689,1.10934,.922048,-.12637,.179616,1.15063,.936952,-.102928,.146749,1.18885,.951895,-.0785268,.112733,1.22352,.967198,-.0530153,.0760056,1.25681,.984405,-.02649,.0383183,1.28762,1.00021,70019e-8,-20039e-8,1.31656,.0325964,-355447e-11,.176706,6.55682e-7,.0329333,-899174e-10,.178527,165869e-10,.0329181,-359637e-9,.178453,663498e-10,.0329085,-808991e-9,.178383,149332e-9,.0329181,-.00143826,.178394,265873e-9,.0329425,-.00224678,.178517,416597e-9,.0329511,-.00323575,.17849,603299e-9,.033011,-.00439875,.178695,829422e-9,.0330733,-.00574059,.178843,.00109908,.0331857,-.00725896,.179176,.00141933,.0333445,-.00895289,.179618,.0017999,.0335674,-.0108219,.180238,.00225316,.033939,-.0128687,.181417,.00279765,.0345239,-.015114,.183395,.0034564,.0354458,-.017596,.186616,.00425864,.0368313,-.0203524,.191547,.00524936,.0386115,-.0234105,.197508,.00647033,.0410303,-.0268509,.205395,.00798121,.0442245,-.0307481,.215365,.0098557,.0478659,-.0350863,.225595,.0121417,.0522416,-.0399506,.236946,.0149385,.0574513,-.045357,.249442,.0183189,.0631208,-.0512863,.261222,.0223644,.0701124,-.0579273,.275418,.0272418,.0777331,-.0650652,.288989,.0329458,.0862709,-.0728813,.302546,.0396819,.096103,-.081363,.317164,.04757,.106976,-.0904463,.331733,.0567012,.119175,-.100105,.34661,.067202,.132919,-.110375,.362249,.0792588,.147727,-.121115,.376978,.0928672,.163618,-.132299,.390681,.108228,.182234,-.143887,.406571,.125502,.201809,-.155827,.42042,.144836,.225041,-.168357,.438411,.166706,.247621,-.18004,.450368,.189909,.27097,-.191536,.460083,.215251,.296658,-.203024,.469765,.243164,.325892,-.214056,.481837,.273388,.35406,-.224104,.487474,.305344,.384372,-.233489,.492773,.339741,.41749,-.241874,.498451,.376287,.45013,-.248834,.499632,.414195,.481285,-.254658,.495233,.454077,.519183,-.259367,.496401,.496352,.551544,-.261818,.487686,.538798,.587349,-.262964,.479453,.583626,.621679,-.262128,.467709,.629451,.654991,-.258998,.452123,.67566,.686873,-.254119,.433495,.723248,.719801,-.246946,.413657,.771156,.750355,-.237709,.390366,.81989,.780033,-.226549,.364947,.868601,.809254,-.214186,.337256,.920034,.836576,-.199639,.307395,.971706,.861774,-.183169,.275431,1.02479,.885707,-.165111,.243431,1.07837,.904742,-.144363,.210921,1.12783,.915604,-.121305,.17647,1.17254,.930959,-.0962119,.143106,1.21012,.948404,-.069969,.108112,1.24474,.967012,-.0427586,.0708478,1.27718,.984183,-.0147043,.032335,1.3083,.999577,.0142165,-.00726867,1.3382,.0229227,-299799e-11,.148623,4.62391e-7,.0232194,-758796e-10,.15054,117033e-10,.0232315,-303636e-9,.15063,468397e-10,.0232354,-683189e-9,.150624,105472e-9,.0232092,-.0012136,.150445,187744e-9,.0232523,-.00189765,.150679,294847e-9,.0232828,-.00273247,.150789,428013e-9,.0233371,-.00371287,.150995,591134e-9,.0234015,-.00484794,.15118,787642e-9,.023514,-.00612877,.151562,.00102547,.023679,-.00756125,.152116,.00131351,.0239559,-.00914651,.153162,.00166594,.0244334,-.010904,.155133,.00210182,.025139,-.0128615,.158035,.00264406,.0262598,-.0150628,.162751,.00332923,.0277875,-.0175532,.168944,.00419773,.0298472,-.0203981,.176835,.00530034,.0325444,-.023655,.186686,.00669777,.0355581,-.0272982,.196248,.00842661,.0392841,-.0314457,.207352,.0105854,.0436815,-.0361157,.219279,.0132458,.0485272,-.0412932,.230728,.0164736,.0541574,-.0470337,.242994,.0203715,.0609479,-.0535002,.257042,.0250953,.0685228,-.0605409,.27102,.0306856,.0768042,-.0680553,.28406,.037193,.0864844,-.0765011,.299186,.0449795,.0969415,-.0852674,.3132,.0538316,.108478,-.0947333,.327138,.0641149,.121705,-.10481,.342345,.0759185,.136743,-.115474,.358472,.0894116,.152986,-.126536,.374067,.104562,.170397,-.138061,.388267,.121632,.191392,-.150203,.406467,.140996,.211566,-.161751,.418641,.161696,.233567,-.173407,.430418,.184557,.257769,-.185397,.44277,.210092,.28531,-.197048,.457191,.237827,.311726,-.20784,.464712,.267253,.340537,-.218345,.472539,.299332,.372921,-.228306,.482331,.333988,.402924,-.236665,.484378,.369722,.434475,-.244097,.484717,.407836,.469736,-.250547,.487093,.448465,.505045,-.25511,.485575,.490263,.540262,-.258444,.481225,.534495,.576347,-.259903,.473481,.579451,.608656,-.259572,.4603,.625604,.646679,-.257908,.450341,.674511,.679902,-.253663,.431561,.723269,.714159,-.247419,.412684,.773263,.745345,-.239122,.389388,.824182,.778248,-.228837,.365361,.876634,.807208,-.216197,.337667,.92945,.835019,-.201772,.307197,.985261,.860261,-.185291,.274205,1.04299,.877601,-.165809,.240178,1.09816,.898211,-.143897,.207571,1.14694,.915789,-.119513,.174904,1.19008,.931831,-.0932919,.141423,1.2297,.949244,-.0656528,.105603,1.26553,.967527,-.0370262,.0679551,1.29986,.984139,-.00730117,.0283133,1.33252,.999713,.0234648,-.0121785,1.36397,.0152135,-245447e-11,.122795,3.04092e-7,.0151652,-615778e-10,.122399,76292e-10,.0151181,-245948e-9,.122023,304802e-10,.0151203,-553394e-9,.12203,686634e-10,.015125,-983841e-9,.122037,122463e-9,.0151427,-.00153774,.12214,192706e-9,.0151708,-.0022103,.122237,281219e-9,.0152115,-.00300741,.12238,390804e-9,.0152877,-.00392494,.1227,526317e-9,.015412,-.00496597,.123244,69443e-8,.0156201,-.00613314,.124228,90547e-8,.0159658,-.00744113,.125945,.0011732,.0165674,-.00892546,.129098,.00151888,.017487,-.010627,.133865,.00197007,.018839,-.0126043,.140682,.0025637,.020554,-.0148814,.148534,.00333637,.0226727,-.0175123,.157381,.00433738,.0251879,-.0205266,.166685,.00561664,.0283635,-.0240319,.177796,.00725563,.0318694,-.0279432,.188251,.00928811,.0361044,-.0324313,.200038,.011835,.0406656,-.0373527,.210685,.0149146,.0463846,-.0430132,.224182,.0187254,.0525696,-.0491013,.23634,.0232283,.0598083,-.0559175,.250013,.0286521,.0679437,-.0633657,.263981,.0350634,.0771181,-.0714602,.278072,.0425882,.0881273,-.0803502,.29511,.0514487,.0996628,-.0896903,.309976,.0615766,.112702,-.099644,.325611,.0732139,.126488,-.109829,.339321,.0862324,.142625,-.120859,.35574,.101275,.15953,-.131956,.369845,.117892,.176991,-.143145,.38146,.136205,.199715,-.155292,.40052,.157252,.220787,-.167066,.412055,.179966,.243697,-.178396,.423133,.204418,.272106,-.190433,.439524,.232141,.297637,-.201265,.447041,.261109,.325273,-.211834,.454488,.292627,.357219,-.221889,.465004,.326669,.387362,-.230729,.468527,.362426,.423131,-.23924,.475836,.401533,.45543,-.246067,.475017,.441902,.493393,-.251557,.478017,.484239,.526253,-.255571,.4709,.528586,.560554,-.257752,.463167,.574346,.599306,-.258076,.456452,.621655,.634541,-.256471,.443725,.670492,.668907,-.253283,.428719,.721943,.705619,-.247562,.411348,.772477,.739034,-.240626,.388939,.8264,.771408,-.231493,.36425,.881702,.803312,-.220125,.337321,.9385,.828457,-.206645,.305364,.997437,.854819,-.190664,.273715,1.05693,.878666,-.171429,.242218,1.11251,.898404,-.149235,.209556,1.16398,.917416,-.12435,.176863,1.21014,.933133,-.0972703,.142775,1.25178,.95066,-.0683607,.106735,1.29028,.968589,-.0378724,.0681609,1.32703,.984776,-.00605712,.0273966,1.36158,.99994,.0263276,-.0138124,1.3943,.00867437,-186005e-11,.0928979,1.73682e-7,.00864003,-466389e-10,.0925237,435505e-11,.00864593,-186594e-9,.0925806,174322e-10,.00864095,-419639e-9,.0924903,392862e-10,.00863851,-746272e-9,.0924589,702598e-10,.00868531,-.00116456,.0929,111188e-9,.00869667,-.00167711,.0928529,163867e-9,.00874332,-.00228051,.0930914,23104e-8,.00882709,-.00297864,.0935679,31741e-8,.00898874,-.00377557,.0946165,430186e-9,.00929346,-.00469247,.0967406,580383e-9,.00978271,-.00575491,.100084,783529e-9,.0105746,-.00701514,.105447,.00106304,.0116949,-.00851797,.112494,.00144685,.0130419,-.0102757,.119876,.00196439,.0148375,-.012381,.129034,.00266433,.0168725,-.01482,.137812,.00358364,.0193689,-.0176563,.147696,.00478132,.0222691,-.0209211,.157795,.00631721,.0256891,-.0246655,.168431,.00826346,.0294686,-.0288597,.178587,.0106714,.0340412,-.0336441,.190251,.0136629,.0393918,-.039033,.202999,.0173272,.0453947,-.0450087,.215655,.0217448,.0521936,-.0515461,.228686,.0269941,.0600279,-.058817,.242838,.033272,.0692398,-.0667228,.258145,.0406457,.0793832,-.0752401,.273565,.0492239,.0902297,-.0841851,.287735,.0590105,.102014,-.0936479,.301161,.0702021,.116054,-.103967,.317438,.0832001,.13191,-.114622,.334166,.0977951,.148239,-.125452,.348192,.113985,.165809,-.136453,.361094,.131928,.184616,-.147648,.373534,.151811,.207491,-.159607,.39101,.174476,.230106,-.171119,.402504,.198798,.257036,-.182906,.418032,.225796,.281172,-.193605,.425468,.254027,.312034,-.204771,.440379,.285713,.340402,-.214988,.445406,.319196,.370231,-.224711,.44968,.35537,.407105,-.233516,.460747,.393838,.439037,-.240801,.460624,.433747,.47781,-.24762,.465957,.477234,.510655,-.251823,.460054,.52044,.550584,-.255552,.459172,.567853,.585872,-.257036,.450311,.615943,.620466,-.257535,.437763,.667693,.660496,-.255248,.426639,.718988,.695578,-.251141,.409185,.772503,.732176,-.244718,.39015,.827023,.760782,-.236782,.362594,.885651,.79422,-.225923,.33711,.943756,.824521,-.213855,.308272,1.00874,.854964,-.197723,.278529,1.06764,.878065,-.179209,.246208,1.12836,.899834,-.157569,.21329,1.18318,.918815,-.133206,.181038,1.23161,.934934,-.106545,.146993,1.27644,.952115,-.0780574,.111175,1.31842,.96906,-.0478279,.0728553,1.35839,.985178,-.0160014,.032579,1.39697,1.00039,.0173126,-.0095256,1.43312,.00384146,-124311e-11,.0613583,7.78271e-8,.00390023,-314043e-10,.0622919,196626e-11,.00389971,-125622e-9,.0622632,787379e-11,.00389491,-282352e-9,.0620659,1778e-8,.00391618,-502512e-9,.0624687,320918e-10,.00392662,-784458e-9,.0625113,515573e-10,.00396053,-.00112907,.0628175,778668e-10,.00401911,-.00153821,.0633286,113811e-9,.00414994,-.0020208,.0646443,16445e-8,.00441223,-.00260007,.0673886,237734e-9,.00484427,-.0033097,.0716528,345929e-9,.00549109,-.00418966,.0774998,505987e-9,.00636293,-.00527331,.0844758,739208e-9,.00746566,-.00660428,.0921325,.00107347,.00876625,-.00818826,.0997067,.00153691,.0103125,-.0100811,.107433,.00217153,.0123309,-.0123643,.117088,.00303427,.0146274,-.0150007,.126438,.00416018,.0172295,-.0180531,.135672,.00561513,.0204248,-.0215962,.146244,.007478,.0241597,-.0256234,.157481,.00981046,.0284693,-.0302209,.169125,.0127148,.033445,-.0353333,.181659,.0162453,.0391251,-.0410845,.1944,.0205417,.0454721,-.0473451,.207082,.0256333,.0530983,-.0542858,.221656,.0317036,.0615356,-.0618384,.236036,.0388319,.0703363,-.0697631,.248398,.046974,.0810391,-.0784757,.263611,.0565246,.0920144,-.0873488,.275857,.0671724,.105584,-.0973652,.292555,.0798105,.119506,-.107271,.306333,.0935945,.134434,-.117608,.318888,.109106,.153399,-.128938,.337552,.127074,.171258,-.139944,.349955,.14643,.191059,-.151288,.361545,.168,.215069,-.163018,.378421,.192082,.237838,-.174226,.38879,.217838,.266965,-.186063,.405857,.246931,.292827,-.196909,.414146,.277505,.324352,-.207473,.426955,.310711,.354427,-.217713,.433429,.346794,.389854,-.227183,.443966,.385237,.420749,-.235131,.44471,.424955,.459597,-.242786,.451729,.468446,.495316,-.248767,.45072,.513422,.534903,-.253351,.450924,.560618,.572369,-.256277,.445266,.609677,.612383,-.2576,.438798,.660995,.644037,-.256931,.421693,.713807,.686749,-.254036,.4109,.767616,.719814,-.249785,.390151,.82533,.754719,-.244283,.367847,.888311,.792022,-.235076,.345013,.948177,.822404,-.225061,.316193,1.01661,.853084,-.211113,.287013,1.08075,.879871,-.19449,.255424,1.14501,.901655,-.174023,.222879,1.20203,.919957,-.1509,.18989,1.25698,.938412,-.124923,.15606,1.30588,.953471,-.0968139,.120512,1.3529,.970451,-.066734,.0828515,1.3986,.985522,-.034734,.0424458,1.44148,1.00099,-.00102222,678929e-9,1.48398,965494e-9,-6.27338e-7,.0306409,1.97672e-8,99168e-8,-158573e-10,.0314638,4.99803e-7,991068e-9,-634012e-10,.031363,200682e-11,974567e-9,-14144e-8,.03036,457312e-11,998079e-9,-252812e-9,.031496,860131e-11,.00102243,-396506e-9,.0319955,148288e-10,.00107877,-577593e-9,.0331376,249141e-10,.00121622,-816816e-9,.0359396,423011e-10,.0014455,-.00113761,.0399652,724613e-10,.00178791,-.00156959,.0450556,123929e-9,.00225668,-.00214064,.0508025,208531e-9,.00285627,-.00287655,.0568443,341969e-9,.0035991,-.00380271,.0630892,544158e-9,.00455524,-.00496264,.0702204,842423e-9,.00569143,-.0063793,.0773426,.00126704,.00716928,-.00813531,.0860839,.00186642,.00885307,-.0101946,.0944079,.00267014,.0109316,-.0126386,.103951,.00374033,.0133704,-.0154876,.113786,.0051304,.0161525,-.0187317,.123477,.00688858,.0194267,-.0224652,.133986,.00910557,.0230967,-.0265976,.143979,.0118074,.0273627,-.0312848,.154645,.0151266,.0323898,-.0365949,.166765,.0191791,.0379225,-.0422914,.177932,.0239236,.0447501,-.0487469,.19167,.0296568,.0519391,-.0556398,.203224,.0362924,.0599464,-.0631646,.215652,.0440585,.0702427,-.0714308,.232089,.0531619,.0806902,-.0800605,.245258,.0634564,.0923194,-.0892815,.258609,.0752481,.106938,-.09931,.276654,.0888914,.121238,-.109575,.289847,.104055,.138817,-.120461,.307566,.121266,.15595,-.131209,.320117,.139944,.178418,-.143049,.339677,.161591,.197875,-.154074,.349886,.184303,.224368,-.166307,.369352,.210669,.252213,-.178051,.386242,.238895,.277321,-.189335,.395294,.269182,.310332,-.200683,.412148,.302508,.338809,-.210856,.418266,.337264,.372678,-.220655,.428723,.374881,.405632,-.230053,.433887,.415656,.442293,-.237993,.439911,.457982,.477256,-.244897,.440175,.502831,.515592,-.250657,.441079,.550277,.550969,-.255459,.435219,.601102,.592883,-.257696,.432882,.651785,.629092,-.259894,.421054,.708961,.672033,-.258592,.41177,.763806,.709147,-.256525,.395267,.824249,.745367,-.254677,.375013,.8951,.784715,-.247892,.353906,.959317,.818107,-.240162,.327801,1.03153,.847895,-.229741,.298821,1.10601,.879603,-.213084,.269115,1.164,.902605,-.195242,.236606,1.22854,.922788,-.174505,.203442,1.29017,.944831,-.150169,.169594,1.34157,.959656,-.124099,.135909,1.3956,.972399,-.0960626,.0990563,1.45128,.986549,-.0657097,.0602348,1.50312,1.00013,-.0333558,.0186694,1.55364,619747e-11,-1e-7,.00778326,796756e-16,2.37499e-8,-9.99999e-8,282592e-10,1.14596e-10,100292e-11,-166369e-11,250354e-9,6.77492e-9,350752e-11,-637769e-11,357289e-9,6.31655e-8,826445e-11,-174689e-10,516179e-9,3.1851e-7,242481e-10,-450868e-10,.0010223,130577e-11,455631e-10,-89044e-9,.00144302,374587e-11,971222e-10,-178311e-9,.00241912,102584e-10,171403e-9,-313976e-9,.00354938,236481e-10,292747e-9,-520026e-9,.00513765,496014e-10,789827e-9,-.00118187,.0238621,139056e-9,.00114093,-.00171827,.0286691,244093e-9,.00176119,-.00249667,.0368565,420623e-9,.0022233,-.00333742,.0400469,65673e-8,.00343382,-.00481976,.0535751,.00109323,.00427602,-.00600755,.057099,.00155268,.00461435,-.00737637,.0551084,.00215031,.00695698,-.00971401,.0715767,.00316529,.00867619,-.0120943,.0793314,.00436995,.0106694,-.0148202,.0869391,.0058959,.0140351,-.0183501,.101572,.00798757,.0168939,-.022006,.11018,.0104233,.020197,-.0261568,.119041,.0134167,.0254702,-.0312778,.135404,.0173009,.0298384,-.0362469,.1437,.0215428,.035159,-.042237,.15512,.0268882,.0427685,-.0488711,.17128,.033235,.0494848,-.0557997,.181813,.0404443,.0592394,-.0635578,.198745,.0490043,.0681463,-.071838,.210497,.0588239,.0804753,-.0809297,.228864,.0702835,.0942205,-.0906488,.247008,.0834012,.106777,-.100216,.258812,.0975952,.124471,-.110827,.278617,.114162,.138389,-.121193,.287049,.131983,.159543,-.13253,.307151,.152541,.176432,-.143611,.31564,.174673,.201723,-.15548,.33538,.199842,.229721,-.167166,.355256,.227097,.250206,-.178238,.360047,.256014,.282118,-.189905,.378761,.28855,.312821,-.201033,.39181,.323348,.341482,-.211584,.397716,.360564,.377368,-.221314,.410141,.400004,.418229,-.230474,.423485,.442371,.444881,-.239443,.418874,.488796,.488899,-.245987,.427545,.535012,.520317,-.253948,.422147,.589678,.568566,-.256616,.42719,.637683,.599607,-.26376,.415114,.703363,.64222,-.268687,.408715,.771363,.685698,-.2694,.399722,.83574,.732327,-.266642,.388651,.897764,.769873,-.267712,.369198,.983312,.806733,-.263479,.346802,1.06222,.843466,-.254575,.321368,1.13477,.873008,-.242749,.29211,1.20712,.908438,-.22725,.262143,1.27465,.936321,-.207621,.228876,1.33203,.950353,-.187932,.19484,1.40439,.96442,-.165154,.163178,1.4732,.979856,-.139302,.127531,1.53574,.982561,-.11134,.0903457,1.59982,.996389,-.0808124,.0489007,1.6577]),64,64,RGBAFormat,FloatType,UVMapping,ClampToEdgeWrapping,ClampToEdgeWrapping,LinearFilter,NearestFilter,1),v=new DataTexture(new Float32Array([1,0,0,0,1,791421e-36,0,0,1,104392e-29,0,0,1,349405e-26,0,0,1,109923e-23,0,0,1,947414e-22,0,0,1,359627e-20,0,0,1,772053e-19,0,0,1,108799e-17,0,0,1,110655e-16,0,0,1,865818e-16,0,0,.999998,5.45037e-10,0,0,.999994,2.85095e-9,0,0,.999989,1.26931e-8,0,0,.999973,4.89938e-8,0,0,.999947,1.66347e-7,0,0,.999894,5.02694e-7,0,0,.999798,136532e-11,0,0,.999617,335898e-11,0,0,.999234,752126e-11,0,0,.998258,152586e-10,0,0,.99504,266207e-10,0,0,.980816,236802e-10,0,0,.967553,207684e-11,0,0,.966877,403733e-11,0,0,.965752,741174e-11,0,0,.96382,127746e-10,0,0,.960306,202792e-10,0,0,.953619,280232e-10,0,0,.941103,278816e-10,0,0,.926619,160221e-10,0,0,.920983,235164e-10,0,0,.912293,311924e-10,0,.0158731,.899277,348118e-10,0,.0476191,.880884,26041e-9,0,.0793651,.870399,338726e-10,0,.111111,.856138,392906e-10,0,.142857,.837436,372874e-10,0,.174603,.820973,392558e-10,0,.206349,.803583,434658e-10,0,.238095,.782168,40256e-9,0,.269841,.764107,448159e-10,0,.301587,.743092,457627e-10,0,.333333,.721626,455314e-10,0,.365079,.700375,477335e-10,0,.396825,.677334,461072e-10,0,.428571,.655702,484393e-10,0,.460317,.632059,464583e-10,0,.492064,.610125,483923e-10,0,.52381,.58653,464342e-10,0,.555556,.564508,477033e-10,0,.587302,.541405,459263e-10,0,.619048,.519556,46412e-9,0,.650794,.497292,448913e-10,0,.68254,.475898,445789e-10,0,.714286,.454722,433496e-10,0,.746032,.434042,423054e-10,0,.777778,.414126,413737e-10,0,.809524,.394387,397265e-10,0,.84127,.375841,390709e-10,0,.873016,.357219,369938e-10,0,.904762,.340084,365618e-10,0,.936508,.322714,342533e-10,0,.968254,.306974,339596e-10,0,1,1,101524e-23,0,0,1,10292e-22,0,0,1,130908e-23,0,0,1,473331e-23,0,0,1,625319e-22,0,0,1,107932e-20,0,0,1,163779e-19,0,0,1,203198e-18,0,0,1,204717e-17,0,0,.999999,168995e-16,0,0,.999998,1.15855e-10,0,0,.999996,6.6947e-10,0,0,.999991,3.30863e-9,0,0,.999983,1.41737e-8,0,0,.999968,5.32626e-8,0,0,.99994,1.77431e-7,0,0,.999891,5.28835e-7,0,0,.999797,142169e-11,0,0,.999617,347057e-11,0,0,.999227,77231e-10,0,0,.998239,155753e-10,0,0,.994937,268495e-10,0,0,.980225,213742e-10,0,0,.967549,21631e-10,0,0,.966865,417989e-11,0,0,.965739,763341e-11,0,0,.963794,130892e-10,0,0,.960244,206456e-10,0,0,.953495,282016e-10,0,148105e-9,.940876,271581e-10,0,.002454,.926569,164159e-10,0,.00867491,.920905,239521e-10,0,.01956,.912169,315127e-10,0,.035433,.899095,346626e-10,0,.056294,.882209,290223e-10,0,.0818191,.870272,342992e-10,0,.111259,.855977,394164e-10,0,.142857,.837431,372343e-10,0,.174603,.820826,396691e-10,0,.206349,.803408,435395e-10,0,.238095,.782838,419579e-10,0,.269841,.763941,450953e-10,0,.301587,.742904,455847e-10,0,.333333,.721463,458833e-10,0,.365079,.700197,477159e-10,0,.396825,.677501,470641e-10,0,.428571,.655527,484732e-10,0,.460317,.6324,476834e-10,0,.492064,.609964,484213e-10,0,.52381,.586839,475541e-10,0,.555556,.564353,476951e-10,0,.587302,.541589,467611e-10,0,.619048,.519413,463493e-10,0,.650794,.497337,453994e-10,0,.68254,.475797,445308e-10,0,.714286,.454659,435787e-10,0,.746032,.434065,424839e-10,0,.777778,.414018,41436e-9,0,.809524,.39455,401902e-10,0,.84127,.375742,390813e-10,0,.873016,.357501,377116e-10,0,.904762,.339996,36535e-9,0,.936508,.323069,351265e-10,0,.968254,.306897,339112e-10,0,1,1,10396e-19,0,0,1,104326e-20,0,0,1,110153e-20,0,0,1,144668e-20,0,0,1,34528e-19,0,0,1,175958e-19,0,0,1,12627e-17,0,0,1,936074e-18,0,0,1,645742e-17,0,0,.999998,401228e-16,0,0,.999997,2.22338e-10,0,0,.999995,1.0967e-9,0,0,.999991,4.82132e-9,0,0,.999981,1.89434e-8,0,0,.999967,6.67716e-8,0,0,.999938,2.12066e-7,0,0,.999886,6.0977e-7,0,0,.999792,159504e-11,0,0,.999608,381191e-11,0,0,.999209,833727e-11,0,0,.998179,165288e-10,0,0,.994605,274387e-10,0,0,.979468,167316e-10,0,0,.967529,242877e-11,0,0,.966836,461696e-11,0,0,.96569,830977e-11,0,0,.963706,140427e-10,0,244659e-11,.960063,217353e-10,0,760774e-9,.953113,286606e-10,0,.00367261,.940192,247691e-10,0,.00940263,.927731,195814e-10,0,.018333,.920669,252531e-10,0,.0306825,.911799,324277e-10,0,.0465556,.89857,340982e-10,0,.0659521,.883283,319622e-10,0,.0887677,.86989,35548e-9,0,.114784,.855483,397143e-10,0,.143618,.837987,391665e-10,0,.174606,.820546,411306e-10,0,.206349,.802878,436753e-10,0,.238095,.783402,444e-7,0,.269841,.763439,458726e-10,0,.301587,.742925,467097e-10,0,.333333,.721633,478887e-10,0,.365079,.69985,481251e-10,0,.396825,.67783,491811e-10,0,.428571,.655126,488199e-10,0,.460318,.632697,496025e-10,0,.492064,.609613,48829e-9,0,.52381,.587098,492754e-10,0,.555556,.564119,482625e-10,0,.587302,.541813,482807e-10,0,.619048,.519342,471552e-10,0,.650794,.497514,466765e-10,0,.68254,.475879,455582e-10,0,.714286,.454789,446007e-10,0,.746032,.434217,435382e-10,0,.777778,.414086,421753e-10,0,.809524,.394744,412093e-10,0,.84127,.375782,396634e-10,0,.873016,.357707,386419e-10,0,.904762,.340038,370345e-10,0,.936508,.323284,359725e-10,0,.968254,.306954,3436e-8,0,1,1,599567e-19,0,0,1,600497e-19,0,0,1,614839e-19,0,0,1,686641e-19,0,0,1,972658e-19,0,0,1,221271e-18,0,0,1,833195e-18,0,0,1,403601e-17,0,0,.999999,206001e-16,0,0,.999998,1.01739e-10,0,0,.999997,4.70132e-10,0,0,.999993,2.00436e-9,0,0,.999988,7.83682e-9,0,0,.999979,2.80338e-8,0,0,.999962,9.17033e-8,0,0,.999933,2.74514e-7,0,0,.999881,7.53201e-7,0,0,.999783,189826e-11,0,0,.999594,440279e-11,0,0,.999178,93898e-10,0,0,.998073,181265e-10,0,0,.993993,280487e-10,0,0,.979982,149422e-10,0,0,.968145,378481e-11,0,0,.966786,53771e-10,0,0,.965611,947508e-11,0,388934e-10,.963557,156616e-10,0,9693e-7,.959752,235144e-10,0,.00370329,.952461,291568e-10,0,.00868428,.940193,240102e-10,0,.0161889,.929042,231235e-10,0,.0263948,.920266,273968e-10,0,.0394088,.911178,337915e-10,0,.0552818,.897873,333629e-10,0,.0740138,.884053,351405e-10,0,.0955539,.869455,378034e-10,0,.119795,.854655,399378e-10,0,.14656,.838347,419108e-10,0,.175573,.820693,440831e-10,0,.206388,.802277,445599e-10,0,.238095,.783634,472691e-10,0,.269841,.763159,476984e-10,0,.301587,.742914,491487e-10,0,.333333,.721662,502312e-10,0,.365079,.699668,502817e-10,0,.396825,.677839,51406e-9,0,.428571,.655091,511095e-10,0,.460317,.632665,516067e-10,0,.492064,.609734,512255e-10,0,.52381,.587043,510263e-10,0,.555556,.564298,50565e-9,0,.587302,.541769,497951e-10,0,.619048,.519529,492698e-10,0,.650794,.497574,482066e-10,0,.68254,.476028,473689e-10,0,.714286,.454961,461941e-10,0,.746032,.434341,450618e-10,0,.777778,.414364,438355e-10,0,.809524,.394832,424196e-10,0,.84127,.376109,412563e-10,0,.873016,.35779,396226e-10,0,.904762,.340379,384886e-10,0,.936508,.323385,368214e-10,0,.968254,.307295,356636e-10,0,1,1,106465e-17,0,0,1,106555e-17,0,0,1,107966e-17,0,0,1,114601e-17,0,0,1,137123e-17,0,0,1,21243e-16,0,0,.999999,489653e-17,0,0,.999999,160283e-16,0,0,.999998,62269e-15,0,0,.999997,2.51859e-10,0,0,.999996,9.96192e-10,0,0,.999992,3.74531e-9,0,0,.999986,1.32022e-8,0,0,.999975,4.33315e-8,0,0,.999959,1.31956e-7,0,0,.999927,3.72249e-7,0,0,.999871,9.72461e-7,0,0,.999771,235343e-11,0,0,.999572,52768e-10,0,0,.999133,109237e-10,0,0,.997912,203675e-10,0,0,.993008,279396e-10,0,0,.980645,139604e-10,0,0,.970057,646596e-11,0,0,.966717,65089e-10,0,474145e-10,.965497,111863e-10,0,89544e-8,.96334,179857e-10,0,.0032647,.959294,259045e-10,0,.0075144,.951519,292327e-10,0,.0138734,.940517,249769e-10,0,.0224952,.93014,26803e-9,0,.0334828,.91972,303656e-10,0,.0468973,.910294,353323e-10,0,.0627703,.897701,351002e-10,0,.0811019,.884522,388104e-10,0,.10186,.869489,412932e-10,0,.124985,.853983,415781e-10,0,.150372,.838425,454066e-10,0,.177868,.820656,471624e-10,0,.207245,.801875,475243e-10,0,.238143,.783521,505621e-10,0,.269841,.763131,50721e-9,0,.301587,.74261,523293e-10,0,.333333,.72148,528699e-10,0,.365079,.699696,538677e-10,0,.396825,.677592,539255e-10,0,.428571,.65525,546367e-10,0,.460317,.632452,541348e-10,0,.492064,.609903,544976e-10,0,.52381,.586928,536201e-10,0,.555556,.564464,535185e-10,0,.587302,.541801,524949e-10,0,.619048,.519681,51812e-9,0,.650794,.497685,507687e-10,0,.68254,.47622,496243e-10,0,.714286,.455135,485714e-10,0,.746032,.4346,471847e-10,0,.777778,.414564,459294e-10,0,.809524,.395165,444705e-10,0,.84127,.376333,430772e-10,0,.873016,.358197,416229e-10,0,.904762,.34064,401019e-10,0,.936508,.323816,386623e-10,0,.968254,.307581,370933e-10,0,1,1,991541e-17,0,0,1,992077e-17,0,0,1,100041e-16,0,0,1,10385e-15,0,0,1,115777e-16,0,0,1,150215e-16,0,0,.999999,254738e-16,0,0,.999999,598822e-16,0,0,.999998,1.79597e-10,0,0,.999997,6.02367e-10,0,0,.999994,2.06835e-9,0,0,.99999,6.94952e-9,0,0,.999984,2.23363e-8,0,0,.999972,6.78578e-8,0,0,.999952,1.93571e-7,0,0,.999919,5.16594e-7,0,0,.99986,128739e-11,0,0,.999753,299298e-11,0,0,.999546,648258e-11,0,0,.999074,129985e-10,0,0,.997671,232176e-10,0,0,.991504,256701e-10,0,0,.981148,131141e-10,0,0,.971965,869048e-11,0,280182e-10,.966624,808301e-11,0,695475e-9,.965344,135235e-10,0,.00265522,.963048,210592e-10,0,.00622975,.958673,287473e-10,0,.0116234,.950262,281379e-10,0,.018976,.940836,271089e-10,0,.0283844,.930996,30926e-9,0,.0399151,.919848,348359e-10,0,.0536063,.909136,366092e-10,0,.0694793,.897554,384162e-10,0,.0875342,.884691,430971e-10,0,.107749,.869414,447803e-10,0,.130087,.853462,452858e-10,0,.154481,.838187,495769e-10,0,.180833,.820381,502709e-10,0,.209005,.801844,522713e-10,0,.238791,.783061,541505e-10,0,.269869,.763205,553712e-10,0,.301587,.742362,564909e-10,0,.333333,.721393,572646e-10,0,.365079,.699676,581012e-10,0,.396825,.677395,58096e-9,0,.428571,.655208,585766e-10,0,.460317,.632451,583602e-10,0,.492064,.609839,580234e-10,0,.52381,.587093,577161e-10,0,.555556,.564467,568447e-10,0,.587302,.542043,563166e-10,0,.619048,.519826,55156e-9,0,.650794,.497952,541682e-10,0,.68254,.476477,528971e-10,0,.714286,.455412,514952e-10,0,.746032,.434926,502222e-10,0,.777778,.4149,485779e-10,0,.809524,.395552,472242e-10,0,.84127,.376712,454891e-10,0,.873016,.358622,440924e-10,0,.904762,.341048,422984e-10,0,.936508,.324262,408582e-10,0,.968254,.308013,390839e-10,0,1,1,613913e-16,0,0,1,614145e-16,0,0,1,617708e-16,0,0,1,633717e-16,0,0,1,681648e-16,0,0,1,808291e-16,0,0,1,1.14608e-10,0,0,.999998,2.10507e-10,0,0,.999997,4.99595e-10,0,0,.999995,1.39897e-9,0,0,.999994,4.19818e-9,0,0,.999988,1.27042e-8,0,0,.999979,3.75153e-8,0,0,.999965,1.06206e-7,0,0,.999945,2.85381e-7,0,0,.999908,7.23611e-7,0,0,.999846,17255e-10,0,0,.999733,386104e-11,0,0,.999511,808493e-11,0,0,.998993,156884e-10,0,0,.997326,265538e-10,0,0,.989706,206466e-10,0,0,.981713,130756e-10,0,70005e-10,.973636,106473e-10,0,464797e-9,.966509,10194e-9,0,.00201743,.965149,165881e-10,0,.00497549,.962669,249147e-10,0,.00953262,.95786,317449e-10,0,.0158211,.949334,281045e-10,0,.0239343,.941041,303263e-10,0,.0339372,.931575,356754e-10,0,.0458738,.920102,397075e-10,0,.059772,.908002,384886e-10,0,.075645,.897269,43027e-9,0,.0934929,.884559,479925e-10,0,.113302,.869161,48246e-9,0,.135045,.853342,509505e-10,0,.158678,.837633,542846e-10,0,.184136,.820252,554139e-10,0,.211325,.801872,581412e-10,0,.240113,.782418,585535e-10,0,.270306,.7631,610923e-10,0,.301594,.742183,613678e-10,0,.333333,.721098,627275e-10,0,.365079,.699512,629413e-10,0,.396825,.677372,636351e-10,0,.428571,.655059,633555e-10,0,.460317,.632567,636513e-10,0,.492064,.609784,628965e-10,0,.52381,.587237,625546e-10,0,.555556,.564525,615825e-10,0,.587302,.542181,605048e-10,0,.619048,.520017,596329e-10,0,.650794,.498204,581516e-10,0,.68254,.476742,569186e-10,0,.714286,.455803,553833e-10,0,.746032,.435251,537807e-10,0,.777778,.415374,522025e-10,0,.809524,.395921,503421e-10,0,.84127,.377253,488211e-10,0,.873016,.359021,468234e-10,0,.904762,.341637,453269e-10,0,.936508,.3247,433014e-10,0,.968254,.308625,418007e-10,0,1,1,2.86798e-10,0,0,1,2.86877e-10,0,0,1,2.88094e-10,0,0,1,2.93506e-10,0,0,1,3.09262e-10,0,0,.999999,3.48593e-10,0,0,.999999,4.44582e-10,0,0,.999998,6.88591e-10,0,0,.999996,1.34391e-9,0,0,.999993,3.17438e-9,0,0,.999989,8.35609e-9,0,0,.999983,2.28677e-8,0,0,.999974,6.23361e-8,0,0,.999959,1.65225e-7,0,0,.999936,4.19983e-7,0,0,.999896,101546e-11,0,0,.99983,232376e-11,0,0,.999709,50156e-10,0,0,.999469,10167e-9,0,0,.998886,190775e-10,0,0,.996819,300511e-10,0,0,.988837,185092e-10,0,1.68222e-7,.982178,134622e-10,0,259622e-9,.975017,125961e-10,0,.00142595,.967101,13507e-9,0,.00382273,.964905,205003e-10,0,.00764164,.96218,29546e-9,0,.0130121,.956821,343738e-10,0,.0200253,.948829,305063e-10,0,.0287452,.941092,346487e-10,0,.039218,.931883,412061e-10,0,.0514748,.920211,444651e-10,0,.0655351,.907307,431252e-10,0,.0814082,.89684,490382e-10,0,.0990939,.884119,53334e-9,0,.118583,.869148,54114e-9,0,.139856,.853377,578536e-10,0,.162882,.836753,592285e-10,0,.187615,.820063,622787e-10,0,.213991,.801694,645492e-10,0,.241918,.782116,65353e-9,0,.271267,.762673,674344e-10,0,.301847,.742133,682788e-10,0,.333333,.720779,691959e-10,0,.365079,.699386,696817e-10,0,.396826,.67732,699583e-10,0,.428572,.654888,698447e-10,0,.460318,.632499,694063e-10,0,.492064,.609825,691612e-10,0,.52381,.587287,681576e-10,0,.555556,.564743,674138e-10,0,.587302,.542409,661617e-10,0,.619048,.520282,647785e-10,0,.650794,.498506,633836e-10,0,.68254,.477102,615905e-10,0,.714286,.456167,601013e-10,0,.746032,.435728,581457e-10,0,.777778,.415809,564215e-10,0,.809524,.396517,544997e-10,0,.84127,.377737,525061e-10,0,.873016,.359698,506831e-10,0,.904762,.342164,48568e-9,0,.936508,.325417,467826e-10,0,.968254,.309186,446736e-10,0,1,1,1.09018e-9,0,0,1,1.0904e-9,0,0,1,1.09393e-9,0,0,1,1.1095e-9,0,0,1,1.154e-9,0,0,1,1.26089e-9,0,0,.999999,1.5059e-9,0,0,.999997,2.07899e-9,0,0,.999994,3.48164e-9,0,0,.999993,7.05728e-9,0,0,.999987,1.63692e-8,0,0,.999981,4.06033e-8,0,0,.999969,1.0245e-7,0,0,.999953,2.55023e-7,0,0,.999925,6.1511e-7,0,0,.999881,142218e-11,0,0,.99981,313086e-11,0,0,.99968,653119e-11,0,0,.999418,12832e-9,0,0,.998748,232497e-10,0,0,.996066,329522e-10,0,0,.988379,179613e-10,0,108799e-9,.982567,143715e-10,0,921302e-9,.976097,148096e-10,0,.00280738,.968475,178905e-10,0,.00596622,.964606,253921e-10,0,.0105284,.961564,348623e-10,0,.0165848,.955517,357612e-10,0,.0242,.948381,343493e-10,0,.03342,.941095,405849e-10,0,.0442777,.931923,475394e-10,0,.0567958,.91996,484328e-10,0,.0709879,.907419,502146e-10,0,.086861,.89618,561654e-10,0,.104415,.88337,587612e-10,0,.123643,.869046,618057e-10,0,.144531,.853278,657392e-10,0,.167057,.836091,66303e-9,0,.191188,.819644,704445e-10,0,.216878,.801246,714071e-10,0,.244062,.782031,740093e-10,0,.272649,.762066,74685e-9,0,.302509,.741964,766647e-10,0,.333442,.720554,766328e-10,0,.365079,.699098,777857e-10,0,.396826,.677189,774633e-10,0,.428572,.65484,776235e-10,0,.460318,.632496,770316e-10,0,.492064,.609908,762669e-10,0,.52381,.587312,753972e-10,0,.555556,.564938,739994e-10,0,.587302,.542577,728382e-10,0,.619048,.52062,71112e-9,0,.650794,.498819,694004e-10,0,.68254,.477555,675575e-10,0,.714286,.456568,653449e-10,0,.746032,.436278,636068e-10,0,.777778,.41637,613466e-10,0,.809524,.397144,594177e-10,0,.84127,.378412,570987e-10,0,.873016,.360376,550419e-10,0,.904762,.342906,527422e-10,0,.936508,.326136,506544e-10,0,.968254,.30997,484307e-10,0,1,1,3.54014e-9,0,0,1,3.54073e-9,0,0,1,3.54972e-9,0,0,1,3.58929e-9,0,0,1,3.70093e-9,0,0,.999999,3.96194e-9,0,0,.999998,4.53352e-9,0,0,.999997,5.78828e-9,0,0,.999994,8.63812e-9,0,0,.999991,1.53622e-8,0,0,.999985,3.16356e-8,0,0,.999977,7.12781e-8,0,0,.999964,1.66725e-7,0,0,.999945,3.90501e-7,0,0,.999912,8.95622e-7,0,0,.999866,198428e-11,0,0,.999786,421038e-11,0,0,.999647,850239e-11,0,0,.999356,162059e-10,0,0,.998563,282652e-10,0,0,.994928,336309e-10,0,244244e-10,.987999,178458e-10,0,523891e-9,.982893,159162e-10,0,.00194729,.977044,178056e-10,0,.00451099,.969972,230624e-10,0,.00835132,.964237,313922e-10,0,.013561,.960791,406145e-10,0,.0202056,.954292,372796e-10,0,.0283321,.948052,403199e-10,0,.0379739,.940938,479537e-10,0,.0491551,.931689,545292e-10,0,.0618918,.91987,54038e-9,0,.0761941,.907665,589909e-10,0,.0920672,.895281,642651e-10,0,.109511,.882621,659707e-10,0,.12852,.86873,709973e-10,0,.149085,.853008,742221e-10,0,.171189,.835944,761754e-10,0,.194809,.818949,797052e-10,0,.21991,.800951,812434e-10,0,.246447,.781847,838075e-10,0,.274352,.761649,84501e-9,0,.303535,.74152,860258e-10,0,.333857,.720495,866233e-10,0,.365104,.698742,868326e-10,0,.396826,.677096,87133e-9,0,.428572,.654782,863497e-10,0,.460318,.632335,860206e-10,0,.492064,.610031,849337e-10,0,.52381,.587457,838279e-10,0,.555556,.56513,82309e-9,0,.587302,.542877,803542e-10,0,.619048,.5209,786928e-10,0,.650794,.499291,765171e-10,0,.68254,.477971,744753e-10,0,.714286,.457221,72209e-9,0,.746032,.436803,697448e-10,0,.777778,.417083,675333e-10,0,.809524,.397749,648058e-10,0,.84127,.379177,625759e-10,0,.873016,.361061,598584e-10,0,.904762,.343713,575797e-10,0,.936508,.326894,549999e-10,0,.968254,.310816,527482e-10,0,1,1,1.0153e-8,0,0,1,1.01544e-8,0,0,1,1.01751e-8,0,0,1,1.02662e-8,0,0,1,1.0521e-8,0,0,.999999,1.11049e-8,0,0,.999999,1.23408e-8,0,0,.999996,1.4924e-8,0,0,.999992,2.04471e-8,0,0,.999989,3.26539e-8,0,0,.99998,6.03559e-8,0,0,.999971,1.23936e-7,0,0,.999955,2.69058e-7,0,0,.999933,5.93604e-7,0,0,.999901,129633e-11,0,0,.999847,275621e-11,0,0,.999761,564494e-11,0,0,.999607,110485e-10,0,0,.999282,204388e-10,0,0,.99831,341084e-10,0,2.2038e-7,.993288,294949e-10,0,242388e-9,.987855,192736e-10,0,.0012503,.983167,182383e-10,0,.0032745,.977908,218633e-10,0,.00646321,.971194,290662e-10,0,.0109133,.963867,386401e-10,0,.0166927,.95982,462827e-10,0,.0238494,.953497,420705e-10,0,.0324178,.947621,477743e-10,0,.0424225,.940611,568258e-10,0,.0538808,.931174,618061e-10,0,.0668047,.919919,627098e-10,0,.0812014,.907856,694714e-10,0,.0970745,.894509,735008e-10,0,.114424,.881954,763369e-10,0,.133246,.868309,821896e-10,0,.153534,.852511,83769e-9,0,.175275,.835821,881615e-10,0,.198453,.817981,896368e-10,0,.223042,.800504,930906e-10,0,.249009,.78141,945056e-10,0,.276304,.761427,963605e-10,0,.304862,.74094,968088e-10,0,.334584,.720233,981481e-10,0,.365322,.698592,979122e-10,0,.396826,.676763,981057e-10,0,.428571,.654808,973956e-10,0,.460318,.632326,962619e-10,0,.492064,.610049,952996e-10,0,.52381,.58763,933334e-10,0,.555556,.565261,917573e-10,0,.587302,.543244,896636e-10,0,.619048,.521273,873304e-10,0,.650794,.499818,852648e-10,0,.68254,.478536,823961e-10,0,.714286,.457826,79939e-9,0,.746032,.437549,77126e-9,0,.777778,.41776,743043e-10,0,.809524,.39863,716426e-10,0,.84127,.379954,686456e-10,0,.873016,.362025,660514e-10,0,.904762,.344581,630755e-10,0,.936508,.327909,605439e-10,0,.968254,.311736,576345e-10,0,1,1,2.63344e-8,0,0,1,2.63373e-8,0,0,1,2.63815e-8,0,0,1,2.65753e-8,0,0,1,2.71132e-8,0,0,.999999,2.83279e-8,0,0,.999997,3.0833e-8,0,0,.999995,3.58711e-8,0,0,.999992,4.61266e-8,0,0,.999985,6.7574e-8,0,0,.999977,1.1358e-7,0,0,.999966,2.13657e-7,0,0,.999948,4.31151e-7,0,0,.999923,8.96656e-7,0,0,.999884,186603e-11,0,0,.999826,381115e-11,0,0,.999732,754184e-11,0,0,.999561,143192e-10,0,0,.999191,257061e-10,0,0,.997955,405724e-10,0,744132e-10,.992228,276537e-10,0,716477e-9,.987638,208885e-10,0,.0022524,.983395,215226e-10,0,.00484816,.978614,270795e-10,0,.00860962,.972389,365282e-10,0,.0136083,.964392,474747e-10,0,.0198941,.95861,509141e-10,0,.0275023,.952806,48963e-9,0,.0364584,.94712,571119e-10,0,.04678,.940104,671704e-10,0,.0584799,.930398,687586e-10,0,.0715665,.919866,738161e-10,0,.086045,.907853,813235e-10,0,.101918,.894078,834582e-10,0,.119186,.881177,892093e-10,0,.137845,.867575,944548e-10,0,.157891,.852107,969607e-10,0,.179316,.835502,101456e-9,0,.202106,.81756,103256e-9,0,.226243,.79984,106954e-9,0,.251704,.780998,108066e-9,0,.278451,.761132,110111e-9,0,.306436,.740429,110459e-9,0,.335586,.719836,111219e-9,0,.365796,.698467,11145e-8,0,.3969,.676446,110393e-9,0,.428571,.654635,110035e-9,0,.460318,.632411,108548e-9,0,.492064,.609986,106963e-9,0,.52381,.587872,105238e-9,0,.555556,.565528,102665e-9,0,.587302,.543563,100543e-9,0,.619048,.52176,976182e-10,0,.650794,.500188,947099e-10,0,.68254,.479204,919929e-10,0,.714286,.458413,886139e-10,0,.746032,.438314,857839e-10,0,.777778,.418573,82411e-9,0,.809524,.39947,792211e-10,0,.84127,.380892,759546e-10,0,.873016,.362953,727571e-10,0,.904762,.345601,695738e-10,0,.936508,.328895,664907e-10,0,.968254,.312808,634277e-10,0,1,1,6.28647e-8,0,0,1,6.28705e-8,0,0,1,6.29587e-8,0,0,1,6.33441e-8,0,0,.999999,6.44087e-8,0,0,.999998,6.67856e-8,0,0,.999997,7.15889e-8,0,0,.999995,8.09577e-8,0,0,.999989,9.92764e-8,0,0,.999983,1.35834e-7,0,0,.999974,2.10482e-7,0,0,.999959,3.65215e-7,0,0,.999939,6.86693e-7,0,0,.999911,13472e-10,0,0,.999868,26731e-10,0,0,.999804,524756e-11,0,0,.9997,100403e-10,0,0,.99951,185019e-10,0,0,.999078,322036e-10,0,620676e-11,.997428,470002e-10,0,341552e-9,.99162,287123e-10,0,.00143727,.987479,234706e-10,0,.00349201,.983582,260083e-10,0,.0066242,.979186,337927e-10,0,.0109113,.97325,454689e-10,0,.0164064,.965221,573759e-10,0,.0231463,.957262,544114e-10,0,.0311571,.952211,587006e-10,0,.0404572,.946631,692256e-10,0,.0510592,.939391,787819e-10,0,.0629723,.929795,792368e-10,0,.0762025,.91965,875075e-10,0,.090753,.907737,950903e-10,0,.106626,.893899,972963e-10,0,.123822,.880239,10459e-8,0,.142337,.866562,107689e-9,0,.16217,.85164,113081e-9,0,.183314,.835021,116636e-9,0,.20576,.817311,120074e-9,0,.229496,.798845,121921e-9,0,.254502,.780479,12475e-8,0,.280753,.760694,125255e-9,0,.308212,.740142,126719e-9,0,.336825,.719248,12636e-8,0,.366517,.698209,126712e-9,0,.397167,.676398,125769e-9,0,.428578,.654378,124432e-9,0,.460318,.632484,123272e-9,0,.492064,.610113,12085e-8,0,.52381,.587931,118411e-9,0,.555556,.565872,11569e-8,0,.587302,.543814,112521e-9,0,.619048,.522265,109737e-9,0,.650794,.500835,106228e-9,0,.68254,.479818,102591e-9,0,.714286,.459258,991288e-10,0,.746032,.439061,952325e-10,0,.777778,.419552,91895e-9,0,.809524,.400399,879051e-10,0,.84127,.381976,844775e-10,0,.873016,.364009,806316e-10,0,.904762,.346761,771848e-10,0,.936508,.330049,735429e-10,0,.968254,.314018,702103e-10,0,1,1,1.39968e-7,0,0,1,1.39979e-7,0,0,1,1.40145e-7,0,0,1,1.4087e-7,0,0,.999999,1.42865e-7,0,0,.999998,1.47279e-7,0,0,.999997,1.56057e-7,0,0,.999992,1.7276e-7,0,0,.999989,2.04352e-7,0,0,.99998,2.6494e-7,0,0,.999969,3.83435e-7,0,0,.999953,6.18641e-7,0,0,.999929,108755e-11,0,0,.999898,201497e-11,0,0,.999849,381346e-11,0,0,.999778,719815e-11,0,0,.999661,133215e-10,0,0,.999451,238313e-10,0,0,.998936,401343e-10,0,113724e-9,.99662,517346e-10,0,820171e-9,.991094,304323e-10,0,.00238143,.987487,281757e-10,0,.00493527,.983731,320048e-10,0,.00856859,.979647,423905e-10,0,.0133393,.973837,562935e-10,0,.0192863,.96584,677442e-10,0,.0264369,.956309,623073e-10,0,.03481,.951523,704131e-10,0,.0444184,.946003,836594e-10,0,.0552713,.938454,911736e-10,0,.0673749,.929279,938264e-10,0,.0807329,.919239,103754e-9,0,.0953479,.907293,109928e-9,0,.111221,.893936,115257e-9,0,.128352,.879674,122265e-9,0,.14674,.865668,125733e-9,0,.166382,.850998,132305e-9,0,.187276,.834498,134844e-9,0,.209413,.816903,139276e-9,0,.232786,.798235,140984e-9,0,.257382,.779724,14378e-8,0,.283181,.760251,144623e-9,0,.310156,.739808,145228e-9,0,.338269,.718762,14539e-8,0,.367461,.697815,144432e-9,0,.397646,.67631,143893e-9,0,.428685,.654278,141846e-9,0,.460318,.632347,13935e-8,0,.492064,.610296,137138e-9,0,.52381,.588039,133806e-9,0,.555556,.566218,130755e-9,0,.587302,.544346,127128e-9,0,.619048,.522701,123002e-9,0,.650794,.501542,119443e-9,0,.68254,.480508,115055e-9,0,.714286,.460092,111032e-9,0,.746032,.440021,106635e-9,0,.777778,.420446,102162e-9,0,.809524,.401512,98184e-9,0,.84127,.38299,936497e-10,0,.873016,.365232,89813e-9,0,.904762,.347865,853073e-10,0,.936508,.331342,817068e-10,0,.968254,.315202,773818e-10,0,1,1,2.9368e-7,0,0,1,2.937e-7,0,0,1,2.93998e-7,0,0,1,2.95298e-7,0,0,.999999,2.98865e-7,0,0,.999998,3.067e-7,0,0,.999995,3.22082e-7,0,0,.999992,3.50767e-7,0,0,.999986,4.03538e-7,0,0,.999976,5.01372e-7,0,0,.999964,6.8562e-7,0,0,.999945,10374e-10,0,0,.999919,171269e-11,0,0,.999882,300175e-11,0,0,.999829,542144e-11,0,0,.999749,984182e-11,0,0,.99962,176213e-10,0,0,.999382,305995e-10,0,138418e-10,.998751,496686e-10,0,389844e-9,.995344,510733e-10,0,.00150343,.990768,345829e-10,0,.00352451,.987464,342841e-10,0,.00655379,.983846,399072e-10,0,.0106554,.980007,533219e-10,0,.0158723,.974494,696992e-10,0,.0222333,.96622,776754e-10,0,.029758,.956273,747718e-10,0,.0384596,.950952,864611e-10,0,.0483473,.945215,100464e-9,0,.0594266,.937287,103729e-9,0,.0717019,.928649,111665e-9,0,.0851752,.918791,12353e-8,0,.0998479,.906685,127115e-9,0,.115721,.893706,13628e-8,0,.132794,.879248,142427e-9,0,.151067,.864685,148091e-9,0,.170538,.850032,153517e-9,0,.191204,.833853,157322e-9,0,.213063,.816353,161086e-9,0,.236107,.797834,164111e-9,0,.260329,.778831,165446e-9,0,.285714,.759756,167492e-9,0,.312243,.739419,166928e-9,0,.339887,.718491,167e-6,0,.368604,.697392,165674e-9,0,.398329,.676102,163815e-9,0,.428961,.654243,162003e-9,0,.460331,.632176,158831e-9,0,.492064,.610407,155463e-9,0,.52381,.588394,152062e-9,0,.555556,.56645,147665e-9,0,.587302,.5449,14375e-8,0,.619048,.523276,138905e-9,0,.650794,.502179,134189e-9,0,.68254,.481359,129392e-9,0,.714286,.46092,124556e-9,0,.746032,.441084,11957e-8,0,.777778,.421517,114652e-9,0,.809524,.402721,109688e-9,0,.84127,.384222,104667e-9,0,.873016,.366534,999633e-10,0,.904762,.349205,950177e-10,0,.936508,.332702,907301e-10,0,.968254,.316599,859769e-10,0,1,1,5.85473e-7,0,0,1,5.85507e-7,0,0,1,5.8602e-7,0,0,.999999,5.88259e-7,0,0,.999999,5.94381e-7,0,0,.999998,6.07754e-7,0,0,.999995,6.33729e-7,0,0,.99999,6.8137e-7,0,0,.999984,7.67003e-7,0,0,.999973,9.21212e-7,0,0,.999959,120218e-11,0,0,.999936,172024e-11,0,0,.999907,268088e-11,0,0,.999866,445512e-11,0,0,.999806,768481e-11,0,0,.999716,1342e-8,0,0,.999576,232473e-10,0,0,.9993,391694e-10,0,129917e-9,.998498,608429e-10,0,845035e-9,.994132,489743e-10,0,.00237616,.99031,384644e-10,0,.00484456,.987409,421768e-10,0,.00832472,.983981,504854e-10,0,.0128643,.980268,671028e-10,0,.0184947,.974875,852749e-10,0,.025237,.966063,85531e-9,0,.0331046,.956779,900588e-10,0,.0421067,.950259,10577e-8,0,.0522487,.944239,119458e-9,0,.0635343,.936341,122164e-9,0,.0759654,.928047,134929e-9,0,.0895434,.918065,145544e-9,0,.104269,.906267,150531e-9,0,.120142,.893419,161652e-9,0,.137163,.878758,16593e-8,0,.15533,.863699,174014e-9,0,.174645,.848876,177877e-9,0,.195106,.833032,184049e-9,0,.21671,.815557,186088e-9,0,.239454,.797323,19054e-8,0,.263332,.778124,191765e-9,0,.288336,.758929,192535e-9,0,.314451,.738979,192688e-9,0,.341658,.718213,191522e-9,0,.369924,.696947,190491e-9,0,.399202,.675807,187913e-9,0,.429416,.654147,184451e-9,0,.460447,.63229,181442e-9,0,.492064,.610499,177139e-9,0,.523809,.588747,172596e-9,0,.555555,.566783,167457e-9,0,.587301,.545359,162518e-9,0,.619048,.523984,156818e-9,0,.650794,.502917,151884e-9,0,.68254,.482294,145514e-9,0,.714286,.461945,140199e-9,0,.746032,.442133,134101e-9,0,.777778,.422705,128374e-9,0,.809524,.403916,122996e-9,0,.84127,.38554,116808e-9,0,.873016,.367909,111973e-9,0,.904762,.350651,105938e-9,0,.936508,.334208,101355e-9,0,.968254,.318123,957629e-10,0,1,1,111633e-11,0,0,1,111639e-11,0,0,1,111725e-11,0,0,1,112096e-11,0,0,.999999,11311e-10,0,0,.999997,115315e-11,0,0,.999995,11956e-10,0,0,.999989,127239e-11,0,0,.999981,140772e-11,0,0,.999969,164541e-11,0,0,.999952,206607e-11,0,0,.999928,281783e-11,0,0,.999895,416835e-11,0,0,.999848,658728e-11,0,0,.999781,108648e-10,0,0,.999682,182579e-10,0,0,.999523,306003e-10,0,159122e-10,.999205,499862e-10,0,391184e-9,.998131,73306e-9,0,.00147534,.993334,513229e-10,0,.0034227,.99016,467783e-10,0,.00632232,.987321,523413e-10,0,.0102295,.984099,64267e-9,0,.0151794,.980432,843042e-10,0,.0211947,.974976,102819e-9,0,.0282899,.966429,996234e-10,0,.0364739,.957633,111074e-9,0,.0457522,.949422,128644e-9,0,.0561278,.943045,140076e-9,0,.0676023,.935448,146349e-9,0,.0801762,.927225,161854e-9,0,.0938499,.917033,169135e-9,0,.108623,.905762,179987e-9,0,.124496,.892879,189832e-9,0,.141469,.878435,195881e-9,0,.159541,.863114,20466e-8,0,.178713,.84776,209473e-9,0,.198985,.832084,214861e-9,0,.220355,.814915,217695e-9,0,.242823,.796711,220313e-9,0,.266385,.777603,22313e-8,0,.291036,.757991,222471e-9,0,.316767,.738371,222869e-9,0,.343563,.717872,221243e-9,0,.371402,.696619,218089e-9,0,.400248,.675379,21562e-8,0,.430047,.65411,21169e-8,0,.460709,.63241,206947e-9,0,.492079,.61046,201709e-9,0,.52381,.58903,196753e-9,0,.555556,.567267,189637e-9,0,.587302,.545886,184735e-9,0,.619048,.524714,177257e-9,0,.650794,.503789,171424e-9,0,.68254,.483204,164688e-9,0,.714286,.462976,157172e-9,0,.746032,.443294,151341e-9,0,.777778,.423988,143737e-9,0,.809524,.405325,138098e-9,0,.84127,.386981,130698e-9,0,.873016,.369436,125276e-9,0,.904762,.35219,118349e-9,0,.936508,.335804,11312e-8,0,.968254,.319749,106687e-9,0,1,1,204685e-11,0,0,1,204694e-11,0,0,1,204831e-11,0,0,.999999,205428e-11,0,0,.999999,207056e-11,0,0,.999997,210581e-11,0,0,.999993,21732e-10,0,0,.999987,229365e-11,0,0,.999979,250243e-11,0,0,.999965,286127e-11,0,0,.999947,348028e-11,0,0,.999918,455588e-11,0,0,.999881,643303e-11,0,0,.999828,970064e-11,0,0,.999753,153233e-10,0,0,.999642,24793e-9,0,0,.999464,402032e-10,0,122947e-9,.999089,635852e-10,0,807414e-9,.997567,857026e-10,0,.00227206,.992903,594912e-10,0,.00462812,.990011,578515e-10,0,.00794162,.987192,65399e-9,0,.0122534,.98418,819675e-10,0,.0175888,.980491,105514e-9,0,.0239635,.974779,121532e-9,0,.031387,.96675,119144e-9,0,.0398644,.958248,136125e-9,0,.0493982,.948884,155408e-9,0,.0599896,.941673,162281e-9,0,.0716382,.934521,176754e-9,0,.0843437,.926205,192873e-9,0,.0981056,.916089,200038e-9,0,.112923,.904963,213624e-9,0,.128796,.892089,221834e-9,0,.145725,.878028,232619e-9,0,.163709,.86249,238632e-9,0,.182749,.846587,247002e-9,0,.202847,.830988,250702e-9,0,.224001,.814165,255562e-9,0,.246214,.796135,257505e-9,0,.269482,.777052,258625e-9,0,.293805,.757201,258398e-9,0,.319176,.737655,256714e-9,0,.345587,.717477,255187e-9,0,.373021,.696433,251792e-9,0,.401454,.675084,247223e-9,0,.430844,.653907,242213e-9,0,.461125,.632561,237397e-9,0,.492187,.610658,229313e-9,0,.52381,.589322,224402e-9,0,.555556,.567857,216116e-9,0,.587302,.54652,209124e-9,0,.619048,.525433,201601e-9,0,.650794,.504679,192957e-9,0,.68254,.484203,186052e-9,0,.714286,.464203,177672e-9,0,.746032,.444549,170005e-9,0,.777778,.425346,162401e-9,0,.809524,.406706,1544e-7,0,.84127,.388576,147437e-9,0,.873016,.37094,139493e-9,0,.904762,.353996,133219e-9,0,.936508,.337391,125573e-9,0,.968254,.321648,119867e-9,0,1,1,362511e-11,0,0,1,362525e-11,0,0,1,362739e-11,0,0,.999999,363673e-11,0,0,.999998,366214e-11,0,0,.999996,371698e-11,0,0,.999992,382116e-11,0,0,.999986,400554e-11,0,0,.999976,432058e-11,0,0,.999961,485194e-11,0,0,.999938,574808e-11,0,0,.999908,726643e-11,0,0,.999865,984707e-11,0,0,.999807,142217e-10,0,0,.999723,215581e-10,0,0,.999602,336114e-10,0,119113e-10,.999398,527353e-10,0,355813e-9,.998946,805809e-10,0,.00137768,.996647,942908e-10,0,.00322469,.992298,668733e-10,0,.00597897,.989802,716564e-10,0,.00968903,.987019,821355e-10,0,.0143845,.984219,104555e-9,0,.0200831,.980425,131245e-9,0,.0267948,.974241,139613e-9,0,.034525,.967006,145931e-9,0,.0432757,.95893,167153e-9,0,.0530471,.949157,188146e-9,0,.0638386,.94062,194625e-9,0,.0756487,.933509,213721e-9,0,.0884762,.925088,229616e-9,0,.10232,.915178,239638e-9,0,.117178,.904093,254814e-9,0,.133051,.891337,263685e-9,0,.149939,.877326,274789e-9,0,.167841,.861794,280534e-9,0,.18676,.845758,289534e-9,0,.206696,.829792,294446e-9,0,.22765,.813037,296877e-9,0,.249625,.795285,300217e-9,0,.27262,.776323,299826e-9,0,.296636,.756673,299787e-9,0,.321671,.736856,297867e-9,0,.347718,.716883,294052e-9,0,.374768,.696089,289462e-9,0,.402804,.67505,285212e-9,0,.431796,.653509,27653e-8,0,.461695,.63258,271759e-9,0,.49242,.61104,262811e-9,0,.523822,.589567,255151e-9,0,.555556,.568322,246434e-9,0,.587302,.547235,237061e-9,0,.619048,.52616,228343e-9,0,.650794,.505716,219236e-9,0,.68254,.485274,209595e-9,0,.714286,.465411,201011e-9,0,.746032,.445854,19109e-8,0,.777778,.426911,182897e-9,0,.809524,.408222,173569e-9,0,.84127,.390307,165496e-9,0,.873016,.372624,156799e-9,0,.904762,.355804,14917e-8,0,.936508,.33924,140907e-9,0,.968254,.323534,134062e-9,0,1,1,622487e-11,0,0,1,62251e-10,0,0,1,622837e-11,0,0,.999999,624259e-11,0,0,.999998,628127e-11,0,0,.999996,636451e-11,0,0,.999991,65218e-10,0,0,.999984,679782e-11,0,0,.999973,726361e-11,0,0,.999955,803644e-11,0,0,.999931,931397e-11,0,0,.999896,114299e-10,0,0,.999847,149402e-10,0,0,.999784,207461e-10,0,0,.999692,302493e-10,0,0,.999554,454957e-10,0,997275e-10,.999326,690762e-10,0,724813e-9,.998757,101605e-9,0,.0020972,.995367,958745e-10,0,.00432324,.99209,832808e-10,0,.00746347,.989517,887601e-10,0,.0115534,.987008,10564e-8,0,.0166134,.98421,133179e-9,0,.0226552,.98021,161746e-9,0,.0296838,.973676,161821e-9,0,.0377016,.967052,178635e-9,0,.0467079,.959385,206765e-9,0,.0567013,.949461,22476e-8,0,.0676796,.939578,23574e-8,0,.0796403,.932416,25893e-8,0,.0925812,.923759,271228e-9,0,.106501,.914223,289165e-9,0,.121397,.902942,301156e-9,0,.13727,.890419,313852e-9,0,.15412,.876639,324408e-9,0,.171946,.861316,33249e-8,0,.190751,.84496,338497e-9,0,.210537,.828427,345861e-9,0,.231305,.811871,347863e-9,0,.253057,.794397,350225e-9,0,.275797,.775726,349915e-9,0,.299525,.75617,347297e-9,0,.324242,.736091,344232e-9,0,.349947,.716213,340835e-9,0,.376633,.695736,332369e-9,0,.404289,.674961,327943e-9,0,.432895,.653518,318533e-9,0,.462415,.632574,310391e-9,0,.492788,.61134,300755e-9,0,.523909,.590017,290506e-9,0,.555556,.568752,280446e-9,0,.587302,.548061,269902e-9,0,.619048,.52711,258815e-9,0,.650794,.506682,248481e-9,0,.68254,.486524,237141e-9,0,.714286,.466812,226872e-9,0,.746032,.44732,216037e-9,0,.777778,.428473,205629e-9,0,.809524,.409921,195691e-9,0,.84127,.392028,185457e-9,0,.873016,.374606,176436e-9,0,.904762,.357601,166508e-9,0,.936508,.341348,158385e-9,0,.968254,.32542,149203e-9,0,1,1,103967e-10,0,0,1,10397e-9,0,0,1,104019e-10,0,0,.999999,104231e-10,0,0,.999998,104806e-10,0,0,.999995,106042e-10,0,0,.999991,108366e-10,0,0,.999982,112415e-10,0,0,.999968,119174e-10,0,0,.99995,130227e-10,0,0,.999922,148176e-10,0,0,.999884,177303e-10,0,0,.99983,224564e-10,0,0,.999758,300966e-10,0,0,.999654,423193e-10,0,549083e-11,.999503,614848e-10,0,296087e-9,.999237,903576e-10,0,.00123144,.998491,1271e-7,0,.00295954,.994594,107754e-9,0,.00555829,.99178,103025e-9,0,.00907209,.989265,11154e-8,0,.0135257,.986998,136296e-9,0,.0189327,.984137,169154e-9,0,.0252993,.979798,196671e-9,0,.0326272,.97337,196678e-9,0,.0409157,.967239,223121e-9,0,.0501623,.959543,253809e-9,0,.0603638,.949466,265972e-9,0,.0715171,.939074,288372e-9,0,.0836187,.931118,310983e-9,0,.0966657,.922525,325561e-9,0,.110656,.912983,345725e-9,0,.125588,.901617,3556e-7,0,.141461,.889487,374012e-9,0,.158275,.875787,383445e-9,0,.176031,.860654,393972e-9,0,.19473,.844417,400311e-9,0,.214374,.82741,405004e-9,0,.234967,.810545,407378e-9,0,.256512,.793312,407351e-9,0,.279011,.774847,406563e-9,0,.302468,.755621,404903e-9,0,.326887,.735511,397486e-9,0,.352266,.715435,39357e-8,0,.378605,.695403,384739e-9,0,.405897,.674681,376108e-9,0,.43413,.65359,365997e-9,0,.463277,.632471,354957e-9,0,.493295,.61151,343593e-9,0,.524106,.59064,331841e-9,0,.555561,.569386,318891e-9,0,.587302,.548785,3072e-7,0,.619048,.528146,29361e-8,0,.650794,.507872,281709e-9,0,.68254,.487805,268627e-9,0,.714286,.468196,255887e-9,0,.746032,.448922,243997e-9,0,.777778,.430093,231662e-9,0,.809524,.411845,220339e-9,0,.84127,.393808,208694e-9,0,.873016,.376615,198045e-9,0,.904762,.359655,187375e-9,0,.936508,.343452,177371e-9,0,.968254,.32765,167525e-9,0,1,1,169351e-10,0,0,1,169356e-10,0,0,1,169427e-10,0,0,.999999,169736e-10,0,0,.999998,170575e-10,0,0,.999995,172372e-10,0,0,.99999,175739e-10,0,0,.999979,181568e-10,0,0,.999966,191206e-10,0,0,.999944,20677e-9,0,0,.999912,231644e-10,0,0,.999869,271268e-10,0,0,.999811,334272e-10,0,0,.99973,433979e-10,0,0,.999617,590083e-10,0,680315e-10,.999445,829497e-10,0,612796e-9,.999138,118019e-9,0,.00187408,.998095,156712e-9,0,.00395791,.993919,125054e-9,0,.00692144,.991333,126091e-9,0,.0107962,.989226,144912e-9,0,.0155986,.986954,175737e-9,0,.0213364,.983982,213883e-9,0,.0280114,.979128,234526e-9,0,.0356226,.973327,243725e-9,0,.0441668,.967416,2773e-7,0,.0536399,.959729,308799e-9,0,.0640376,.949758,322447e-9,0,.0753554,.939173,350021e-9,0,.0875893,.9296,370089e-9,0,.100736,.921181,391365e-9,0,.114793,.91164,413636e-9,0,.129759,.900435,427068e-9,0,.145632,.888183,441046e-9,0,.162412,.874772,454968e-9,0,.180101,.859566,461882e-9,0,.1987,.843579,471556e-9,0,.218213,.826453,474335e-9,0,.238641,.809164,477078e-9,0,.259989,.792179,47755e-8,0,.282262,.773866,472573e-9,0,.305464,.754944,469765e-9,0,.329599,.735133,462371e-9,0,.35467,.714858,453674e-9,0,.380678,.694829,443888e-9,0,.407622,.674453,432052e-9,0,.435493,.653685,420315e-9,0,.464275,.632666,406829e-9,0,.493938,.611676,392234e-9,0,.524422,.591193,379208e-9,0,.555624,.570145,36319e-8,0,.587302,.549566,349111e-9,0,.619048,.529278,334166e-9,0,.650794,.509026,318456e-9,0,.68254,.489186,30449e-8,0,.714286,.469662,289051e-9,0,.746032,.450691,275494e-9,0,.777778,.431841,261437e-9,0,.809524,.413752,247846e-9,0,.84127,.395951,235085e-9,0,.873016,.378633,222245e-9,0,.904762,.36194,210533e-9,0,.936508,.345599,198494e-9,0,.968254,.329999,188133e-9,0,1,1,269663e-10,0,0,1,26967e-9,0,0,1,269772e-10,0,0,.999999,270214e-10,0,0,.999998,271415e-10,0,0,.999994,27398e-9,0,0,.999988,278771e-10,0,0,.999977,287019e-10,0,0,.999961,300544e-10,0,0,.999937,322138e-10,0,0,.999904,356163e-10,0,0,.999854,409465e-10,0,0,.99979,492651e-10,0,0,.999699,621722e-10,0,8.8288e-7,.999572,819715e-10,0,223369e-9,.999381,111689e-9,0,.00105414,.999016,153862e-9,0,.0026493,.997437,187667e-9,0,.00508608,.993545,155672e-9,0,.00840554,.991135,161455e-9,0,.012629,.989157,188241e-9,0,.0177661,.986874,226229e-9,0,.0238198,.983714,268668e-9,0,.0307887,.978301,277109e-9,0,.0386688,.973227,303446e-9,0,.0474554,.967317,341851e-9,0,.0571428,.959477,370885e-9,0,.0677256,.950012,392753e-9,0,.0791988,.939484,42781e-8,0,.0915576,.928135,443866e-9,0,.104798,.919819,472959e-9,0,.118918,.910049,491551e-9,0,.133915,.899181,512616e-9,0,.149788,.886881,523563e-9,0,.166537,.87359,540183e-9,0,.184164,.858613,547386e-9,0,.202669,.842809,554809e-9,0,.222056,.825727,558316e-9,0,.242329,.808086,557824e-9,0,.263492,.790728,556346e-9,0,.285551,.772987,552672e-9,0,.30851,.7541,543738e-9,0,.332376,.734669,536107e-9,0,.357153,.714411,523342e-9,0,.382845,.694196,512238e-9,0,.409454,.674252,497465e-9,0,.436977,.65357,481096e-9,0,.465404,.632999,467054e-9,0,.494713,.611994,448771e-9,0,.524864,.591604,431889e-9,0,.555779,.571134,415238e-9,0,.587302,.550528,396369e-9,0,.619048,.530292,379477e-9,0,.650794,.510364,361488e-9,0,.68254,.490749,343787e-9,0,.714286,.471266,327822e-9,0,.746032,.452462,310626e-9,0,.777778,.433907,295352e-9,0,.809524,.415659,279179e-9,0,.84127,.398138,264685e-9,0,.873016,.380833,249905e-9,0,.904762,.364247,236282e-9,0,.936508,.348041,222905e-9,0,.968254,.332389,210522e-9,0,1,1,420604e-10,0,0,1,420614e-10,0,0,1,420757e-10,0,0,.999999,42138e-9,0,0,.999997,423067e-10,0,0,.999993,426668e-10,0,0,.999986,433372e-10,0,0,.999974,444857e-10,0,0,.999956,463554e-10,0,0,.99993,493105e-10,0,0,.999892,539077e-10,0,0,.999838,610005e-10,0,0,.999767,718822e-10,0,0,.999666,884581e-10,0,365471e-10,.999525,113398e-9,0,485623e-9,.999311,150043e-9,0,.00162096,.998865,200063e-9,0,.00355319,.996278,211014e-9,0,.00633818,.992956,189672e-9,0,.0100043,.991017,210262e-9,0,.0145648,.989055,244292e-9,0,.0200237,.986741,290481e-9,0,.0263798,.983288,334303e-9,0,.033629,.977784,340307e-9,0,.0417652,.973037,377864e-9,0,.0507821,.967181,4239e-7,0,.060673,.958971,443854e-9,0,.0714314,.950093,483039e-9,0,.0830518,.939552,517934e-9,0,.0955288,.927678,539449e-9,0,.108859,.918278,568604e-9,0,.123038,.908449,588505e-9,0,.138065,.897713,612473e-9,0,.153938,.885533,625575e-9,0,.170657,.872131,63854e-8,0,.188224,.857517,647034e-9,0,.20664,.841796,65209e-8,0,.225909,.824726,6544e-7,0,.246035,.807297,655744e-9,0,.267022,.789058,646716e-9,0,.288878,.77189,643898e-9,0,.311607,.753082,629973e-9,0,.335216,.7341,621564e-9,0,.359713,.714094,605171e-9,0,.385103,.693839,588752e-9,0,.41139,.673891,573294e-9,0,.438576,.653565,552682e-9,0,.466656,.633326,533446e-9,0,.495617,.612582,514635e-9,0,.525431,.59205,49303e-8,0,.556041,.571918,471842e-9,0,.587338,.551572,451713e-9,0,.619048,.531553,430049e-9,0,.650794,.51175,410445e-9,0,.68254,.49238,390098e-9,0,.714286,.473143,370033e-9,0,.746032,.45423,351205e-9,0,.777778,.435963,332049e-9,0,.809524,.41787,315021e-9,0,.84127,.400387,297315e-9,0,.873016,.383332,281385e-9,0,.904762,.366665,265397e-9,0,.936508,.350633,250601e-9,0,.968254,.334964,23589e-8,0,1,1,643736e-10,0,0,1,64375e-9,0,0,1,643947e-10,0,0,.999999,64481e-9,0,0,.999997,647143e-10,0,0,.999994,652119e-10,0,0,.999985,661359e-10,0,0,.999972,677116e-10,0,0,.999952,702599e-10,0,0,.999922,742517e-10,0,0,.99988,803906e-10,0,0,.99982,897315e-10,0,0,.999741,103838e-9,0,0,.999629,12496e-8,0,149024e-9,.999474,156161e-9,0,861027e-9,.999229,201034e-9,0,.00231198,.998662,259069e-9,0,.00458147,.995299,245439e-9,0,.00770895,.992732,24498e-8,0,.0117126,.990847,273211e-9,0,.0165989,.988911,316492e-9,0,.0223674,.98654,37161e-8,0,.0290135,.982636,410352e-9,0,.0365309,.977346,421756e-9,0,.0449117,.972909,475578e-9,0,.0541481,.966821,522482e-9,0,.0642326,.958686,545008e-9,0,.075158,.949754,589286e-9,0,.0869181,.939184,619995e-9,0,.0995074,.927505,654266e-9,0,.112922,.916606,682362e-9,0,.127157,.906707,704286e-9,0,.142212,.895937,725909e-9,0,.158085,.883913,743939e-9,0,.174776,.870642,755157e-9,0,.192287,.856241,764387e-9,0,.210619,.84069,771032e-9,0,.229775,.823728,765906e-9,0,.249761,.806481,767604e-9,0,.270582,.787924,754385e-9,0,.292243,.770588,749668e-9,0,.314753,.751991,731613e-9,0,.338118,.733407,717655e-9,0,.362347,.713688,700604e-9,0,.387447,.693595,678765e-9,0,.413424,.673426,657042e-9,0,.440284,.65359,635892e-9,0,.468027,.633576,611569e-9,0,.496645,.613144,586011e-9,0,.526122,.592711,563111e-9,0,.556417,.572722,537699e-9,0,.587451,.552762,512556e-9,0,.619048,.532985,489757e-9,0,.650794,.513219,464139e-9,0,.68254,.493992,442193e-9,0,.714286,.47509,418629e-9,0,.746032,.456287,397045e-9,0,.777778,.438152,375504e-9,0,.809524,.420294,35492e-8,0,.84127,.402749,335327e-9,0,.873016,.385879,316422e-9,0,.904762,.369352,298333e-9,0,.936508,.353301,281417e-9,0,.968254,.337781,265203e-9,0,1,1,968267e-10,0,0,1,968284e-10,0,0,1,968556e-10,0,0,.999999,969733e-10,0,0,.999997,972913e-10,0,0,.999993,979688e-10,0,0,.999984,992239e-10,0,0,.999969,101356e-9,0,0,.999946,104784e-9,0,0,.999913,110111e-9,0,0,.999868,118217e-9,0,0,.999801,130396e-9,0,0,.999712,148523e-9,0,124907e-10,.999589,175233e-9,0,355405e-9,.999416,213999e-9,0,.0013528,.999136,268529e-9,0,.00312557,.998367,333088e-9,0,.00573045,.994701,304757e-9,0,.00919397,.992497,318031e-9,0,.0135261,.990608,353863e-9,0,.0187278,.988715,409044e-9,0,.0247947,.986241,472967e-9,0,.0317196,.981696,495104e-9,0,.039494,.977097,532873e-9,0,.0481087,.972583,594447e-9,0,.0575549,.966142,636867e-9,0,.0678242,.95823,669899e-9,0,.0789089,.949677,719499e-9,0,.0908023,.939226,750584e-9,0,.103499,.927501,793183e-9,0,.116993,.915199,81995e-8,0,.131282,.90498,847654e-9,0,.146364,.894243,868929e-9,0,.162237,.882154,884278e-9,0,.178902,.869161,898108e-9,0,.196358,.854751,901254e-9,0,.21461,.839368,90679e-8,0,.23366,.822874,901541e-9,0,.253512,.805514,897297e-9,0,.274174,.78716,881856e-9,0,.29565,.769061,870032e-9,0,.31795,.751,851719e-9,0,.341081,.732614,830671e-9,0,.365053,.713171,806569e-9,0,.389874,.693472,78338e-8,0,.415553,.673528,756404e-9,0,.442098,.653397,726872e-9,0,.469512,.633781,700494e-9,0,.497794,.613877,67105e-8,0,.526935,.593506,640361e-9,0,.556908,.573667,613502e-9,0,.587657,.553932,583177e-9,0,.61906,.534345,554375e-9,0,.650794,.515042,527811e-9,0,.68254,.495674,499367e-9,0,.714286,.477132,47429e-8,0,.746032,.458609,447726e-9,0,.777778,.440354,424205e-9,0,.809524,.422765,399549e-9,0,.84127,.405472,378315e-9,0,.873016,.388482,355327e-9,0,.904762,.372191,336122e-9,0,.936508,.356099,315247e-9,0,.968254,.340737,29794e-8,0,1,1,143327e-9,0,0,1,14333e-8,0,0,1,143366e-9,0,0,.999999,143524e-9,0,0,.999996,143952e-9,0,0,.999991,144862e-9,0,0,.999981,146544e-9,0,0,.999966,149391e-9,0,0,.999941,153946e-9,0,0,.999905,160971e-9,0,0,.999852,171562e-9,0,0,.99978,18729e-8,0,0,.999681,210386e-9,0,826239e-10,.999546,243906e-9,0,664807e-9,.999352,291739e-9,0,.00196192,.999027,357419e-9,0,.00405941,.997886,422349e-9,0,.00699664,.99419,385008e-9,0,.0107896,.99214,409775e-9,0,.0154415,.990274,456418e-9,0,.0209488,.988455,527008e-9,0,.0273037,.985804,597685e-9,0,.0344969,.98103,613124e-9,0,.0425183,.976674,668321e-9,0,.0513575,.972021,736985e-9,0,.0610046,.965274,773789e-9,0,.0714508,.958046,830852e-9,0,.0826877,.949333,875766e-9,0,.0947085,.939135,917088e-9,0,.107507,.927119,952244e-9,0,.121078,.91469,990626e-9,0,.135419,.903006,.00101304,0,.150526,.892368,.00103834,0,.166399,.880231,.00105002,0,.183038,.867432,.00106331,0,.200443,.853208,.00106783,0,.218618,.837956,.00106458,0,.237566,.821772,.00105945,0,.257291,.804328,.00104685,0,.2778,.786465,.00103178,0,.2991,.768004,.00101077,0,.321199,.74972,985504e-9,0,.344106,.731682,962893e-9,0,.36783,.712813,932146e-9,0,.392383,.693139,89871e-8,0,.417774,.673566,869678e-9,0,.444013,.653483,835525e-9,0,.471107,.633891,799853e-9,0,.49906,.614433,766838e-9,0,.527869,.594586,732227e-9,0,.557517,.574769,696442e-9,0,.587966,.555149,663935e-9,0,.61913,.535898,629826e-9,0,.650794,.516753,596486e-9,0,.68254,.497816,567078e-9,0,.714286,.479034,534399e-9,0,.746032,.460975,507013e-9,0,.777778,.442935,477421e-9,0,.809524,.425263,451101e-9,0,.84127,.408248,424964e-9,0,.873016,.391339,39993e-8,0,.904762,.37513,377619e-9,0,.936508,.359172,354418e-9,0,.968254,.343876,334823e-9,0,1,1,209042e-9,0,0,1,209045e-9,0,0,1,209093e-9,0,0,.999999,209304e-9,0,0,.999996,209871e-9,0,0,.999991,211078e-9,0,0,.999979,213304e-9,0,0,.999963,217061e-9,0,0,.999933,223042e-9,0,0,.999894,232206e-9,0,0,.999837,245901e-9,0,0,.999756,266023e-9,0,102927e-11,.999648,295204e-9,0,233468e-9,.999499,336958e-9,0,.00108237,.999283,395563e-9,0,.00268832,.998896,473785e-9,0,.00511138,.997006,520008e-9,0,.00837705,.993819,497261e-9,0,.0124928,.991632,523722e-9,0,.0174561,.989875,587258e-9,0,.0232596,.988109,676329e-9,0,.0298932,.985155,747701e-9,0,.0373453,.980479,768803e-9,0,.0456045,.976271,841054e-9,0,.0546593,.971347,911469e-9,0,.0644994,.964528,953057e-9,0,.0751152,.957632,.00102221,0,.0864981,.948681,.00106122,0,.0986407,.938716,.00111857,0,.111537,.926629,.00114762,0,.125182,.914025,.00118995,0,.139571,.901026,.00121228,0,.154703,.890358,.00123946,0,.170576,.878283,.0012527,0,.18719,.865459,.00125536,0,.204547,.851407,.00126134,0,.222648,.836276,.00124759,0,.241498,.820436,.00124443,0,.261101,.803253,.00122071,0,.281465,.785562,.00120107,0,.302595,.76718,.00117762,0,.324501,.748551,.00114289,0,.347192,.730564,.00110872,0,.370679,.712253,.00107636,0,.394973,.692867,.00103646,0,.420085,.673695,996793e-9,0,.446027,.653912,95675e-8,0,.47281,.634129,916739e-9,0,.500441,.615004,874401e-9,0,.528921,.595587,833411e-9,0,.558244,.575965,794556e-9,0,.588384,.5566,75196e-8,0,.619281,.537428,716381e-9,0,.650795,.518623,676558e-9,0,.68254,.499964,64074e-8,0,.714286,.481356,605984e-9,0,.746032,.463279,570256e-9,0,.777778,.445673,540138e-9,0,.809524,.428032,507299e-9,0,.84127,.411112,479553e-9,0,.873016,.394444,450737e-9,0,.904762,.378247,424269e-9,0,.936508,.362415,399111e-9,0,.968254,.347103,375274e-9,0,1,1,300729e-9,0,0,1,300733e-9,0,0,1,300797e-9,0,0,.999998,301072e-9,0,0,.999996,301817e-9,0,0,.999989,303398e-9,0,0,.999977,306309e-9,0,0,.999958,311209e-9,0,0,.999927,318975e-9,0,0,.999884,330804e-9,0,0,.99982,34834e-8,0,0,.999733,373854e-9,0,326995e-10,.999613,410424e-9,0,477174e-9,.999447,462047e-9,0,.00161099,.999204,533322e-9,0,.00353153,.998725,624964e-9,0,.00627965,.995871,631786e-9,0,.0098693,.993194,632017e-9,0,.0143011,.991541,68923e-8,0,.019568,.989773,766892e-9,0,.0256593,.987647,863668e-9,0,.0325625,.984193,922089e-9,0,.0402647,.980016,970749e-9,0,.0487532,.975859,.00106027,0,.058016,.970514,.00112239,0,.0680419,.963625,.00117212,0,.0788208,.956959,.00125211,0,.0903439,.947956,.00129411,0,.102604,.93809,.00135879,0,.115594,.92659,.00139309,0,.129309,.913829,.00143253,0,.143745,.90005,.00145809,0,.158901,.888129,.0014748,0,.174774,.87607,.00148756,0,.191365,.863461,.00148714,0,.208674,.849594,.00148892,0,.226705,.834531,.00146496,0,.245461,.81903,.0014579,0,.264947,.802122,.00143039,0,.28517,.78445,.00139717,0,.306137,.766434,.00136312,0,.327857,.747816,.00132597,0,.350341,.729519,.00128323,0,.373598,.711454,.00123803,0,.397642,.692699,.00119097,0,.422485,.673723,.00114565,0,.448139,.654386,.00109552,0,.474619,.634673,.00104553,0,.501933,.615554,99985e-8,0,.530089,.596462,948207e-9,0,.559087,.577385,902299e-9,0,.588913,.558257,856448e-9,0,.619525,.5392,810395e-9,0,.650826,.520543,768558e-9,0,.68254,.502206,7239e-7,0,.714286,.48402,685794e-9,0,.746032,.465779,64471e-8,0,.777778,.448455,609583e-9,0,.809524,.431091,57227e-8,0,.84127,.414147,54042e-8,0,.873016,.39765,506545e-9,0,.904762,.381576,477635e-9,0,.936508,.365881,448446e-9,0,.968254,.350582,421424e-9,0,1,1,427144e-9,0,0,1,427151e-9,0,0,1,427232e-9,0,0,.999998,42759e-8,0,0,.999995,428555e-9,0,0,.999988,430603e-9,0,0,.999976,434368e-9,0,0,.999952,440688e-9,0,0,.999919,450667e-9,0,0,.999871,46578e-8,0,0,.999801,488024e-9,0,0,.999704,520092e-9,0,129791e-9,.999572,565553e-9,0,821056e-9,.999389,628906e-9,0,.00225241,.999114,714911e-9,0,.00449109,.998488,819218e-9,0,.00756249,.995234,80415e-8,0,.0114716,.993021,830181e-9,0,.0162131,.991407,902645e-9,0,.021776,.989625,996934e-9,0,.0281471,.987064,.00109707,0,.0353118,.983265,.00114353,0,.0432562,.979535,.0012272,0,.0519665,.975224,.00132642,0,.0614298,.969574,.00138092,0,.0716348,.963021,.00145896,0,.0825709,.956046,.00152834,0,.094229,.947136,.00158217,0,.106602,.937313,.0016347,0,.119682,.926073,.00168383,0,.133465,.913121,.00171627,0,.147947,.899165,.00174229,0,.163125,.885891,.00176137,0,.178998,.873783,.00176406,0,.195566,.861331,.00176156,0,.21283,.847569,.00175346,0,.230793,.832785,.00172753,0,.249459,.817442,.00170204,0,.268832,.800613,.00166576,0,.28892,.783597,.00162909,0,.30973,.76571,.0015826,0,.331271,.747021,.00153106,0,.353554,.728593,.00148036,0,.37659,.710661,.00142808,0,.400391,.692426,.00136906,0,.424973,.673623,.00131066,0,.450347,.65494,.00125569,0,.476531,.635448,.00119517,0,.503535,.616221,.00113828,0,.531372,.597531,.0010816,0,.560047,.578795,.00102673,0,.589554,.559892,970985e-9,0,.619869,.541307,919773e-9,0,.650923,.522608,868479e-9,0,.68254,.504484,82137e-8,0,.714286,.486603,772916e-9,0,.746032,.468802,730353e-9,0,.777778,.451172,684955e-9,0,.809524,.434348,647565e-9,0,.84127,.417445,605863e-9,0,.873016,.401077,571885e-9,0,.904762,.385039,536034e-9,0,.936508,.369483,504227e-9,0,.968254,.354272,473165e-9,0,1,1,599525e-9,0,0,1,599533e-9,0,0,1,599639e-9,0,0,.999998,600097e-9,0,0,.999994,601336e-9,0,0,.999987,603958e-9,0,0,.999972,608775e-9,0,0,.999949,616842e-9,0,0,.999912,629534e-9,0,0,.999857,648658e-9,0,0,.999781,676615e-9,0,538873e-11,.999674,716574e-9,0,308602e-9,.999528,772641e-9,0,.00127003,.999326,849806e-9,0,.00300783,.999009,952682e-9,0,.00556637,.998112,.00106394,0,.00895889,.994496,.00102228,0,.0131827,.992806,.00108586,0,.0182277,.991211,.0011759,0,.0240795,.989415,.00128955,0,.030723,.986499,.00139038,0,.0381418,.982679,.00144539,0,.046321,.978839,.00153954,0,.0552459,.974295,.00164417,0,.0649034,.968784,.00171517,0,.0752814,.962324,.00180282,0,.0863693,.954956,.00186387,0,.0981578,.94624,.00193817,0,.110639,.936517,.00198156,0,.123806,.925186,.00203042,0,.137655,.91252,.0020664,0,.15218,.898441,.00207822,0,.16738,.884394,.0020992,0,.183253,.871273,.00208748,0,.199799,.859057,.00208686,0,.21702,.845243,.00205519,0,.234918,.830723,.00202868,0,.253496,.815801,.00199501,0,.272761,.79914,.00194193,0,.292719,.782372,.00188824,0,.313377,.76482,.00183695,0,.334745,.746586,.00177418,0,.356833,.7281,.00170628,0,.379654,.709842,.00164063,0,.403221,.692019,.00157355,0,.427548,.67364,.00150262,0,.452651,.655277,.00143473,0,.478545,.636438,.00136371,0,.505246,.617364,.00129911,0,.532768,.598603,.00123014,0,.561122,.580195,.00116587,0,.590309,.561786,.00110398,0,.620318,.543377,.00104148,0,.651102,.525093,983984e-9,0,.682545,.506791,92667e-8,0,.714286,.489291,874326e-9,0,.746032,.471811,821734e-9,0,.777778,.454435,774698e-9,0,.809524,.437493,727302e-9,0,.84127,.420977,684039e-9,0,.873016,.404729,64373e-8,0,.904762,.388756,60285e-8,0,.936508,.373344,56765e-8,0,.968254,.358191,531929e-9,0,1,1,832169e-9,0,0,1,832178e-9,0,0,1,83231e-8,0,0,.999998,832893e-9,0,0,.999995,834465e-9,0,0,.999985,837791e-9,0,0,.999969,843893e-9,0,0,.999944,854086e-9,0,0,.999903,870071e-9,0,0,.999843,894042e-9,0,0,.999759,928865e-9,0,531805e-10,.999643,978242e-9,0,579365e-9,.99948,.00104684,0,.00182774,.999255,.00114012,0,.00387804,.998885,.00126188,0,.00675709,.997405,.00135888,0,.010468,.99424,.00133626,0,.0150018,.992458,.00140905,0,.0203443,.990929,.00152305,0,.0264786,.989116,.00165882,0,.0333875,.985624,.00174128,0,.0410536,.982003,.00182108,0,.0494609,.978336,.00194498,0,.0585941,.973184,.00202708,0,.0684396,.9678,.00212166,0,.0789851,.961348,.00221366,0,.0902199,.953841,.00228219,0,.102134,.94534,.00235662,0,.114721,.935552,.00240572,0,.127972,.924064,.00244405,0,.141884,.911827,.00247557,0,.156451,.897731,.00248374,0,.171672,.883409,.00249863,0,.187545,.868625,.00246688,0,.20407,.856529,.00246523,0,.221249,.842999,.00242368,0,.239083,.828505,.00237354,0,.257578,.813825,.00232588,0,.276738,.797813,.00226731,0,.296569,.781097,.00219704,0,.31708,.764038,.00212394,0,.338281,.746067,.00204786,0,.360181,.727687,.00196728,0,.382794,.709571,.00188779,0,.406133,.691503,.00180532,0,.430213,.673673,.00171849,0,.45505,.655732,.00164147,0,.480662,.637399,.00155858,0,.507065,.618616,.00147641,0,.534278,.60005,.00140125,0,.562313,.581713,.00132441,0,.59118,.563546,.00125014,0,.620875,.545605,.00118249,0,.651373,.527559,.0011116,0,.682593,.509764,.00104979,0,.714286,.49193,985977e-9,0,.746032,.475011,928592e-9,0,.777778,.457878,873466e-9,0,.809524,.440979,819585e-9,0,.84127,.424613,772365e-9,0,.873016,.408549,722195e-9,0,.904762,.392771,680014e-9,0,.936508,.377317,636797e-9,0,.968254,.362352,598318e-9,0,1,1,.00114313,0,0,1,.00114314,0,0,.999999,.00114331,0,0,.999998,.00114404,0,0,.999994,.00114601,0,0,.999984,.00115019,0,0,.999967,.00115784,0,0,.999937,.0011706,0,0,.999894,.00119054,0,0,.999828,.00122031,0,0,.999735,.00126331,0,169263e-9,.999606,.00132382,0,949167e-9,.999426,.0014071,0,.00249668,.999173,.00151895,0,.00486392,.99873,.00166102,0,.00806323,.996243,.0017023,0,.0120895,.993779,.00172782,0,.0169288,.9919,.0018108,0,.0225633,.990524,.00196028,0,.028974,.98868,.00212014,0,.036142,.984663,.00217598,0,.044049,.981457,.00230563,0,.0526781,.977608,.00243966,0,.0620137,.972215,.00251336,0,.0720418,.966798,.0026285,0,.0827499,.960241,.00271409,0,.0941271,.952489,.00278381,0,.106164,.944127,.00285399,0,.118852,.934282,.00290994,0,.132185,.923271,.00294558,0,.146157,.910803,.00296269,0,.160766,.896705,.00296803,0,.176007,.88238,.00296637,0,.19188,.867116,.00293163,0,.208385,.853636,.00289418,0,.225523,.840469,.00284663,0,.243296,.82639,.00278594,0,.261709,.811759,.00271618,0,.280767,.796113,.00263187,0,.300476,.779518,.00254589,0,.320845,.763142,.00246003,0,.341883,.745464,.00236529,0,.363601,.727491,.00226536,0,.386011,.709414,.00216375,0,.409128,.691396,.00207127,0,.432967,.67368,.00197106,0,.457545,.656049,.00187022,0,.482881,.638188,.00177605,0,.508992,.620177,.00168482,0,.535899,.601506,.00158909,0,.563619,.58362,.00150583,0,.592165,.565496,.00141791,0,.621544,.54789,.00133693,0,.651743,.530323,.00126038,0,.682709,.512795,.00118556,0,.714286,.495199,.00111527,0,.746032,.478101,.0010489,0,.777778,.461511,984264e-9,0,.809524,.444879,92591e-8,0,.84127,.428424,866582e-9,0,.873016,.412495,814463e-9,0,.904762,.396975,764498e-9,0,.936508,.381614,715967e-9,0,.968254,.366732,672483e-9,0,1,1,.00155501,0,0,1,.00155503,0,0,1,.00155524,0,0,.999998,.00155615,0,0,.999994,.0015586,0,0,.999983,.00156379,0,0,.999963,.0015733,0,0,.999932,.00158911,0,0,.999882,.00161376,0,0,.99981,.00165041,0,100875e-10,.999708,.00170304,0,367658e-9,.999565,.00177658,0,.0014234,.999368,.00187688,0,.00327939,.999081,.00200989,0,.00596629,.99852,.00217177,0,.0094852,.99549,.0021745,0,.013824,.993252,.00222357,0,.0189642,.991727,.00235022,0,.0248856,.989951,.00250561,0,.0315669,.988029,.00268829,0,.0389882,.984029,.0027496,0,.0471302,.980683,.00289793,0,.0559754,.976554,.00303315,0,.0655081,.97139,.00313257,0,.0757138,.965544,.00323656,0,.08658,.95912,.00333432,0,.0980954,.951183,.0034039,0,.110251,.942974,.00347515,0,.123038,.932642,.00350381,0,.13645,.922158,.00354519,0,.150482,.909404,.00353851,0,.165129,.896071,.0035435,0,.18039,.881206,.00349936,0,.196263,.866077,.00347256,0,.212748,.85093,.003415,0,.229847,.837703,.00333367,0,.247561,.823878,.003249,0,.265895,.809449,.00316347,0,.284854,.794379,.00306351,0,.304445,.778138,.0029499,0,.324675,.761997,.00284099,0,.345555,.744938,.00272104,0,.367095,.727212,.00260715,0,.389309,.709549,.00248855,0,.41221,.691704,.00236783,0,.435814,.673689,.00225178,0,.460138,.656453,.00213765,0,.485203,.639128,.00202178,0,.511028,.621512,.00191443,0,.537634,.603598,.00180977,0,.565041,.58559,.00170456,0,.593268,.567852,.00160927,0,.622327,.5503,.00151395,0,.652217,.533033,.00142499,0,.682907,.515942,.00133955,0,.714296,.498814,.0012602,0,.746032,.481595,.00118188,0,.777778,.465117,.00111171,0,.809524,.448865,.00104091,0,.84127,.432711,976618e-9,0,.873016,.416822,91859e-8,0,.904762,.401272,857704e-9,0,.936508,.386226,807172e-9,0,.968254,.371321,75464e-8,0,1,1,.00209596,0,0,1,.00209598,0,0,1,.00209624,0,0,.999997,.00209736,0,0,.999991,.00210039,0,0,.999979,.00210678,0,0,.999959,.00211847,0,0,.999925,.0021379,0,0,.99987,.00216809,0,0,.999791,.00221281,0,681487e-10,.999677,.00227669,0,658161e-9,.999521,.00236533,0,.00200635,.999301,.00248514,0,.0041779,.998977,.00264185,0,.00718648,.998191,.00281695,0,.0110239,.994801,.00278518,0,.015672,.993091,.00288774,0,.0211091,.991571,.00303931,0,.0273123,.9897,.00321643,0,.034259,.987023,.00337332,0,.0419282,.983289,.00346146,0,.0502998,.979892,.00363704,0,.0593562,.975111,.00373601,0,.069081,.970351,.0038842,0,.0794598,.964131,.00397053,0,.0904798,.957747,.00408078,0,.10213,.949536,.00413533,0,.1144,.941372,.00420305,0,.127284,.931049,.00422815,0,.140772,.920647,.00425048,0,.154862,.908033,.0042281,0,.169548,.895028,.00422026,0,.184828,.879968,.00415042,0,.200701,.864875,.00408821,0,.217167,.84918,.00400909,0,.234227,.834934,.00391178,0,.251884,.821397,.00380066,0,.270141,.807135,.00367974,0,.289004,.792363,.00355172,0,.308479,.776661,.003411,0,.328575,.760705,.00328123,0,.349301,.744408,.00314003,0,.370668,.726994,.0029906,0,.392689,.709598,.00285034,0,.415379,.692112,.00271179,0,.438754,.674435,.00257185,0,.46283,.65676,.00243425,0,.48763,.639982,.00230351,0,.513173,.622983,.0021777,0,.539482,.605471,.00204991,0,.566579,.58796,.00193759,0,.594488,.570463,.00181976,0,.623226,.553058,.00171497,0,.6528,.535894,.00161109,0,.683198,.519089,.00151394,0,.714354,.502454,.00142122,0,.746032,.485681,.00133488,0,.777778,.468935,.00124975,0,.809524,.452951,.00117309,0,.84127,.437139,.00110155,0,.873016,.421446,.00103124,0,.904762,.405951,966387e-9,0,.936508,.391003,908119e-9,0,.968254,.376198,848057e-9,0,1,1,.00280076,0,0,1,.00280078,0,0,.999999,.00280109,0,0,.999997,.00280246,0,0,.999992,.00280616,0,0,.999979,.00281396,0,0,.999956,.00282822,0,0,.999916,.00285186,0,0,.999857,.0028885,0,0,.999768,.00294259,0,196026e-9,.999645,.00301946,0,.00104842,.99947,.00312541,0,.00270199,.999229,.00326733,0,.00519449,.998852,.00344992,0,.00852602,.997558,.00361052,0,.0126804,.994417,.0035898,0,.017635,.992824,.00372393,0,.023365,.991344,.00390695,0,.0298456,.989337,.00410392,0,.0370529,.985811,.00420987,0,.0449651,.982772,.00437488,0,.0535615,.979001,.00455069,0,.0628243,.974102,.00464462,0,.0727368,.969197,.00480577,0,.0832844,.962759,.00487818,0,.0944545,.956207,.00498176,0,.106236,.947909,.00503392,0,.118619,.939596,.00507474,0,.131595,.929642,.00509798,0,.145159,.918807,.00508476,0,.159305,.906921,.00505634,0,.174028,.893312,.00498845,0,.189327,.878933,.0049133,0,.2052,.863986,.0048259,0,.221647,.847936,.00470848,0,.23867,.832253,.00456889,0,.25627,.818619,.00442726,0,.274453,.804788,.00427677,0,.293222,.790241,.00411906,0,.312585,.775162,.00394833,0,.33255,.759463,.00377366,0,.353126,.743598,.00361026,0,.374324,.72697,.00343627,0,.396158,.709646,.00326422,0,.418641,.69277,.00309717,0,.44179,.675371,.0029356,0,.465624,.657863,.00277712,0,.490163,.640772,.00261738,0,.515429,.624441,.0024737,0,.541445,.607497,.00233125,0,.568236,.590438,.00218994,0,.595828,.573224,.0020664,0,.624242,.556168,.00193526,0,.653496,.539232,.00182463,0,.683588,.522352,.00170735,0,.714482,.506172,.00160555,0,.746032,.489842,.00150451,0,.777778,.473463,.00140938,0,.809524,.457266,.00132568,0,.84127,.441609,.0012376,0,.873016,.426348,.00116265,0,.904762,.411002,.00108935,0,.936508,.396045,.00101946,0,.968254,.381448,955665e-9,0,1,1,.0037121,0,0,1,.00371213,0,0,1,.00371251,0,0,.999997,.00371417,0,0,.99999,.00371863,0,0,.999977,.00372807,0,0,.99995,.00374529,0,0,.999908,.0037738,0,0,.999843,.00381789,0,123596e-10,.999745,.00388273,0,407442e-9,.999608,.00397443,0,.0015447,.999415,.00409998,0,.00351385,.999143,.00426662,0,.0063316,.9987,.00447625,0,.00998679,.996363,.00455323,0,.0144569,.994021,.00461052,0,.0197151,.992372,.00476359,0,.0257344,.991007,.00499101,0,.0324882,.988767,.0051972,0,.0399517,.984872,.00528407,0,.0481022,.982004,.00548926,0,.0569191,.977714,.00564385,0,.0663839,.973076,.0057693,0,.0764801,.967565,.0058924,0,.0871928,.961384,.00599629,0,.0985095,.954435,.00605998,0,.110419,.946303,.0061133,0,.122912,.937662,.00612028,0,.13598,.927867,.00612209,0,.149617,.916475,.00604813,0,.163817,.90541,.00603088,0,.178577,.891591,.00592218,0,.193894,.877573,.00578854,0,.209767,.862511,.00566648,0,.226196,.846861,.00551481,0,.243182,.83068,.00533754,0,.260728,.815725,.00515487,0,.278837,.802321,.0049655,0,.297515,.787826,.00475421,0,.316768,.773454,.00456002,0,.336605,.758224,.00434727,0,.357034,.74265,.00414444,0,.378067,.726729,.00393738,0,.399717,.710155,.00373575,0,.421998,.693312,.00353736,0,.444928,.67653,.00334368,0,.468523,.659444,.00315981,0,.492806,.642051,.00297809,0,.517798,.625758,.00280592,0,.543525,.609615,.00264254,0,.570012,.592919,.00248459,0,.597288,.576298,.00233327,0,.625379,.559489,.00219519,0,.654307,.542891,.00205441,0,.684084,.526255,.00193385,0,.714693,.509853,.00180745,0,.746044,.494131,.00169817,0,.777778,.478114,.0015913,0,.809524,.462274,.00148981,0,.84127,.446412,.00139537,0,.873016,.431274,.00130984,0,.904762,.41635,.00122403,0,.936508,.401476,.00114809,0,.968254,.386993,.00107563,0,1,1,.00488216,0,0,1,.0048822,0,0,1,.00488265,0,0,.999997,.00488463,0,0,.999988,.00488999,0,0,.999974,.00490129,0,0,.999946,.00492191,0,0,.999897,.00495598,0,0,.999825,.00500855,0,744791e-10,.999718,.00508559,0,712744e-9,.999565,.005194,0,.00215249,.999352,.00534147,0,.00444576,.999046,.00553523,0,.00759218,.998492,.00577016,0,.0115714,.995564,.00578487,0,.0163557,.993339,.00586414,0,.021915,.991834,.00606002,0,.0282201,.990496,.00633312,0,.0352433,.987826,.00651941,0,.042959,.98383,.00660842,0,.0513439,.98109,.00685523,0,.0603772,.976131,.00695778,0,.0700402,.971922,.00714236,0,.0803163,.965901,.00721437,0,.0911908,.959606,.00732017,0,.102651,.952504,.00735788,0,.114686,.944365,.00738493,0,.127286,.935652,.00737969,0,.140443,.925813,.00733612,0,.154151,.914397,.00723094,0,.168405,.903257,.00714002,0,.183201,.890015,.00700149,0,.198536,.876014,.00682813,0,.214409,.861436,.00665567,0,.23082,.845752,.00644526,0,.24777,.829169,.00621635,0,.265263,.813435,.00597789,0,.283301,.799701,.00575694,0,.301889,.785726,.00549866,0,.321035,.77152,.0052503,0,.340746,.75683,.00499619,0,.361032,.741951,.0047543,0,.381904,.726367,.0045084,0,.403374,.710537,.00426784,0,.425457,.693965,.00403487,0,.448169,.677724,.0038075,0,.47153,.66117,.00359431,0,.495561,.644274,.00338354,0,.520284,.627449,.00318163,0,.545725,.611645,.00299672,0,.571911,.595614,.00281016,0,.598873,.579426,.00264252,0,.62664,.563016,.00247509,0,.655239,.546728,.00232647,0,.684692,.530539,.00217803,0,.714999,.514164,.00204216,0,.746106,.498344,.00191403,0,.777778,.482957,.00179203,0,.809524,.467336,.00167695,0,.84127,.451994,.00157567,0,.873016,.436514,.00147113,0,.904762,.42178,.00138034,0,.936508,.407271,.00129219,0,.968254,.392822,.0012098,0,1,1,.00637427,0,0,1,.00637431,0,0,.999999,.00637485,0,0,.999996,.00637721,0,0,.999987,.00638357,0,0,.999971,.006397,0,0,.999939,.00642142,0,0,.999888,.00646177,0,0,.999807,.00652387,0,207916e-9,.999689,.00661454,0,.00112051,.99952,.00674155,0,.00287719,.999283,.00691313,0,.00550145,.998936,.00713598,0,.00897928,.998165,.00738501,0,.0132829,.994847,.00734388,0,.01838,.993182,.00749991,0,.0242381,.991665,.0077246,0,.030826,.989708,.00797579,0,.0381152,.986663,.00813011,0,.0460794,.983288,.00830365,0,.0546951,.980104,.00853496,0,.0639411,.974855,.00861045,0,.0737988,.97045,.00879133,0,.0842516,.964509,.00886377,0,.0952848,.957594,.00890346,0,.106886,.950546,.00893289,0,.119044,.942225,.00890074,0,.131749,.933365,.00886826,0,.144994,.923202,.0087316,0,.158772,.912605,.00863082,0,.173078,.901099,.00847403,0,.187908,.888177,.00825838,0,.203261,.873955,.00801834,0,.219134,.860091,.00779026,0,.235527,.84434,.00752478,0,.252443,.828517,.00724074,0,.269883,.81239,.00693769,0,.287851,.79721,.00664817,0,.306352,.783489,.00634763,0,.325393,.769514,.00604221,0,.344981,.755419,.00573568,0,.365126,.741083,.00544359,0,.385839,.726059,.00515515,0,.407132,.710809,.00487139,0,.42902,.695052,.00459846,0,.45152,.678886,.00433412,0,.474651,.663042,.00407981,0,.498433,.646634,.00384264,0,.52289,.630117,.00360897,0,.548048,.613804,.00338863,0,.573936,.598338,.00318486,0,.600584,.582687,.00298377,0,.628027,.566809,.00280082,0,.656295,.550817,.00262255,0,.685417,.534937,.00245835,0,.715406,.519151,.00230574,0,.74624,.503118,.0021549,0,.777778,.487723,.00202008,0,.809524,.472725,.00189355,0,.84127,.457599,.00177108,0,.873016,.442558,.00165843,0,.904762,.427624,.00155494,0,.936508,.413171,.00145273,0,.968254,.399122,.00136454,0,1,1,.00826496,0,0,1,.00826499,0,0,1,.00826564,0,0,.999996,.00826842,0,0,.999987,.00827589,0,0,.999967,.00829167,0,0,.999933,.00832037,0,0,.999876,.00836768,0,109338e-10,.999786,.00844031,0,427145e-9,.999655,.00854603,0,.0016384,.999468,.00869337,0,.00372392,.999203,.008891,0,.00668513,.998803,.00914387,0,.0104968,.99748,.00935838,0,.015125,.994446,.00933309,0,.0205338,.99292,.00953084,0,.0266884,.991414,.0097893,0,.0335565,.989049,.0100228,0,.0411086,.98582,.0101664,0,.0493181,.982441,.0103582,0,.0581613,.978595,.0105292,0,.0676169,.973495,.0106274,0,.0776661,.968405,.0107261,0,.0882926,.962717,.0108234,0,.0994817,.955478,.0108102,0,.111221,.948275,.0107914,0,.123499,.940006,.0107161,0,.136308,.930831,.0106309,0,.149639,.920648,.0104083,0,.163485,.910205,.0102312,0,.177843,.898445,.0100051,0,.192707,.885986,.00971928,0,.208077,.872204,.00940747,0,.22395,.858436,.0091085,0,.240326,.843454,.00876595,0,.257208,.827437,.00839794,0,.274596,.811488,.00803692,0,.292496,.796039,.00767352,0,.310911,.781083,.0073097,0,.329849,.767642,.00694032,0,.349316,.753901,.00657476,0,.369323,.740131,.00622699,0,.38988,.725845,.0058838,0,.410999,.710991,.00555586,0,.432696,.696002,.00523089,0,.454987,.680461,.00492494,0,.47789,.664875,.00463464,0,.501426,.649273,.00435422,0,.52562,.63302,.0040875,0,.550498,.61705,.00384075,0,.576089,.601154,.00359557,0,.602427,.586008,.00337636,0,.629544,.570699,.00316019,0,.657479,.555166,.00296033,0,.686264,.539645,.00277552,0,.715924,.524159,.00259499,0,.746459,.508682,.00243257,0,.777789,.493163,.00227851,0,.809524,.478004,.00213083,0,.84127,.46347,.00199502,0,.873016,.448778,.00186967,0,.904762,.434105,.00174732,0,.936508,.419576,.00163861,0,.968254,.405541,.00153341,0,1,1,.0106462,0,0,1,.0106462,0,0,.999999,.010647,0,0,.999995,.0106502,0,0,.999985,.0106589,0,0,.999964,.0106773,0,0,.999925,.0107106,0,0,.999861,.0107655,0,712986e-10,.999763,.0108497,0,743959e-9,.999616,.0109716,0,.00227361,.999408,.0111408,0,.0046983,.999112,.0113659,0,.00800158,.998637,.0116475,0,.0121493,.996223,.0117231,0,.0171023,.994006,.0118064,0,.0228218,.992444,.0120254,0,.0292711,.991028,.0123314,0,.036417,.98803,.0124954,0,.0442295,.984816,.0126538,0,.0526815,.981399,.0128537,0,.0617492,.977085,.0129694,0,.0714114,.972154,.013091,0,.0816495,.966617,.0131166,0,.0924472,.960628,.0131583,0,.10379,.953295,.0131094,0,.115665,.94575,.0129966,0,.128062,.937654,.0128796,0,.140972,.927716,.0126477,0,.154387,.917932,.0123889,0,.168301,.907719,.012131,0,.182709,.89584,.0118013,0,.197608,.883526,.0114145,0,.212994,.870301,.0110075,0,.228867,.856272,.0106019,0,.245227,.842251,.0101938,0,.262074,.826466,.00973254,0,.279412,.810859,.0092846,0,.297244,.795051,.00883304,0,.315575,.780053,.00840272,0,.334412,.76575,.00796438,0,.35376,.752298,.00752526,0,.373631,.739153,.00711486,0,.394034,.725514,.00670361,0,.414983,.711473,.00632656,0,.436491,.696936,.00595206,0,.458575,.682126,.00559191,0,.481253,.667027,.00525362,0,.504547,.651875,.00493805,0,.528481,.636463,.00462848,0,.553081,.620641,.00433936,0,.578377,.604931,.00407,0,.604404,.589549,.00380864,0,.631197,.574712,.00357049,0,.658795,.559775,.00334466,0,.687238,.544514,.00312505,0,.716559,.529555,.00293199,0,.746776,.514402,.00274204,0,.777849,.499302,.00256647,0,.809524,.484114,.00239901,0,.84127,.469308,.00225148,0,.873016,.455133,.00210178,0,.904762,.440939,.0019727,0,.936508,.426627,.00184382,0,.968254,.412509,.00172548,0,1,1,.013628,0,0,1,.0136281,0,0,.999999,.0136289,0,0,.999995,.0136327,0,0,.999983,.0136427,0,0,.99996,.0136638,0,0,.999917,.0137022,0,0,.999846,.0137652,0,204597e-9,.999736,.0138615,0,.00116837,.999573,.0140007,0,.00303325,.99934,.0141927,0,.00580613,.999004,.0144457,0,.00945626,.998407,.0147489,0,.0139421,.995464,.014731,0,.0192202,.993328,.0148283,0,.0252495,.991799,.0150797,0,.0319921,.990397,.0154316,0,.0394138,.986835,.0155005,0,.0474843,.983938,.0157308,0,.0561763,.980154,.0158753,0,.0654661,.975659,.0159581,0,.0753326,.970171,.0159832,0,.0857571,.964803,.0160084,0,.0967236,.958366,.0159484,0,.108218,.950613,.0158001,0,.120227,.942874,.0155845,0,.132741,.935005,.0154292,0,.145751,.924991,.0150742,0,.159249,.914814,.0146757,0,.17323,.904743,.0143097,0,.187687,.893216,.0138695,0,.202619,.880769,.0133706,0,.218021,.868136,.0128606,0,.233894,.85469,.0123403,0,.250238,.840593,.0118091,0,.267052,.825808,.011253,0,.284341,.81009,.0107099,0,.302106,.79504,.0101636,0,.320354,.779757,.00964041,0,.33909,.764697,.00911896,0,.358322,.750913,.00859533,0,.378059,.738175,.00811592,0,.398311,.725242,.00764504,0,.41909,.711864,.00718885,0,.440412,.698009,.00675843,0,.462292,.683841,.00634984,0,.484748,.669391,.00595502,0,.507802,.654731,.00558671,0,.531477,.639805,.00523578,0,.555802,.624789,.00490834,0,.580805,.609325,.00459448,0,.606522,.593975,.00430342,0,.63299,.578983,.00403019,0,.66025,.564442,.0037707,0,.688346,.549835,.0035316,0,.717319,.535039,.00330255,0,.7472,.520403,.00308932,0,.777982,.505687,.00289335,0,.809524,.490939,.00270818,0,.84127,.476233,.0025343,0,.873016,.461624,.00237097,0,.904762,.447833,.00222065,0,.936508,.433992,.00207561,0,.968254,.420147,.00194955,0,1,1,.0173415,0,0,1,.0173416,0,0,.999999,.0173426,0,0,.999995,.0173468,0,0,.999983,.0173582,0,0,.999954,.0173822,0,0,.999908,.0174258,0,669501e-11,.999828,.0174973,0,427399e-9,.999705,.0176063,0,.00171019,.999524,.0177631,0,.0039248,.999263,.0179781,0,.00705382,.998878,.018258,0,.0110552,.998012,.0185551,0,.0158812,.994614,.0184264,0,.0214852,.993132,.0186385,0,.0278239,.991563,.0189067,0,.0348585,.989298,.0191577,0,.0425544,.986036,.0192522,0,.050881,.982558,.0194063,0,.059811,.978531,.019486,0,.0693209,.974198,.0195847,0,.0793895,.968148,.0194749,0,.0899984,.962565,.0194277,0,.101132,.956041,.0192991,0,.112775,.947749,.0189893,0,.124917,.94018,.018704,0,.137547,.93165,.0183458,0,.150655,.921798,.0178775,0,.164236,.911573,.0173618,0,.178281,.901569,.0168482,0,.192788,.890341,.016265,0,.207752,.877835,.0156199,0,.223171,.865472,.0149516,0,.239044,.852905,.0143274,0,.255371,.838906,.0136643,0,.272153,.824888,.0129903,0,.289393,.809977,.0123218,0,.307093,.794697,.0116572,0,.325259,.780028,.0110307,0,.343896,.765124,.0104236,0,.363012,.750411,.0098219,0,.382617,.737264,.00924397,0,.402719,.724799,.00868719,0,.423332,.712253,.00816476,0,.444469,.699267,.00767262,0,.466146,.685618,.00719746,0,.488383,.671736,.00673916,0,.511199,.657777,.00631937,0,.534618,.643497,.00592411,0,.558668,.62889,.00553928,0,.58338,.614299,.0051934,0,.608787,.599197,.00485985,0,.634929,.584175,.00454357,0,.661849,.569541,.00425787,0,.689594,.555193,.00397905,0,.718211,.540947,.00372364,0,.747742,.526593,.00348599,0,.778205,.512335,.00326103,0,.80953,.498017,.00305137,0,.84127,.483609,.00285485,0,.873016,.469368,.00267472,0,.904762,.455037,.00249945,0,.936508,.441493,.00234792,0,.968254,.428147,.00219936,0,1,1,.0219422,0,0,1,.0219423,0,0,.999998,.0219434,0,0,.999993,.0219481,0,0,.999981,.021961,0,0,.999949,.0219879,0,0,.999896,.0220367,0,593194e-10,.999808,.0221167,0,75364e-8,.99967,.0222383,0,.00237884,.999466,.0224125,0,.00495612,.999174,.0226495,0,.00844887,.998725,.0229525,0,.0128058,.996979,.0231123,0,.0179742,.994317,.0230742,0,.0239047,.992781,.0232895,0,.0305526,.991191,.0235734,0,.0378786,.987787,.0236152,0,.0458475,.985092,.0237994,0,.0544287,.981121,.0238553,0,.0635952,.976924,.0238706,0,.0733233,.97218,.0238704,0,.0835922,.965956,.0236598,0,.0943839,.959998,.0234735,0,.105682,.953245,.0232277,0,.117474,.944445,.0226973,0,.129747,.937087,.0223527,0,.142491,.928341,.0218144,0,.155697,.9184,.0211516,0,.169358,.907959,.0204553,0,.183469,.89808,.0197673,0,.198024,.887047,.0189915,0,.21302,.875221,.0182082,0,.228455,.86269,.0173584,0,.244329,.850735,.0165718,0,.260639,.837545,.0157524,0,.277389,.823639,.0149482,0,.29458,.809699,.0141431,0,.312216,.794797,.0133527,0,.3303,.780578,.0126193,0,.34884,.766019,.0118914,0,.367842,.751447,.0111839,0,.387315,.737275,.010514,0,.40727,.724545,.00987277,0,.427717,.712644,.00926569,0,.448671,.700432,.00869029,0,.470149,.687664,.00814691,0,.492167,.674288,.00763012,0,.514746,.660966,.00714437,0,.537911,.647264,.00668457,0,.561688,.633431,.00626581,0,.586108,.619133,.00585593,0,.611206,.604935,.00548188,0,.637022,.590236,.00513288,0,.663599,.575473,.0047906,0,.690989,.561228,.00448895,0,.719242,.547054,.00420233,0,.748411,.533175,.00392869,0,.778531,.519163,.00367445,0,.809583,.505328,.00344097,0,.84127,.491446,.00322003,0,.873016,.477356,.00301283,0,.904762,.46356,.00282592,0,.936508,.449623,.00264956,0,.968254,.436068,.00246956,0,1,1,.0276135,0,0,1,.0276136,0,0,.999998,.0276148,0,0,.999993,.0276201,0,0,.999976,.0276342,0,0,.999945,.027664,0,0,.999884,.0277179,0,18679e-8,.999784,.027806,0,.00119607,.99963,.0279394,0,.00318407,.999401,.0281295,0,.00613601,.999066,.0283858,0,.00999963,.998524,.0287027,0,.0147164,.995702,.0286256,0,.0202295,.993593,.0286733,0,.0264876,.992067,.0288989,0,.0334452,.990548,.0292135,0,.0410621,.986775,.0291296,0,.0493032,.984054,.0293099,0,.0581381,.979481,.0291881,0,.0675397,.975297,.0291598,0,.0774848,.96981,.028954,0,.0879528,.963524,.028628,0,.0989258,.957398,.0283135,0,.110388,.950088,.0278469,0,.122327,.941538,.0271798,0,.134729,.933332,.0265388,0,.147587,.924392,.0257776,0,.160889,.914581,.024916,0,.174631,.904347,.0240242,0,.188806,.894324,.0231229,0,.203409,.883724,.022153,0,.218437,.872207,.0211355,0,.233888,.859927,.0201048,0,.249761,.848373,.0191263,0,.266056,.836023,.0181306,0,.282774,.82289,.0171718,0,.299917,.809324,.0162196,0,.317488,.795361,.0152622,0,.335493,.781253,.01439,0,.353936,.767338,.013533,0,.372825,.753156,.0127244,0,.392168,.739122,.0119454,0,.411976,.725358,.0112054,0,.432259,.712949,.010487,0,.453032,.701621,.00984032,0,.47431,.689703,.00921495,0,.496111,.677216,.00862492,0,.518456,.664217,.00806882,0,.541367,.65137,.00755922,0,.564872,.638,.00705705,0,.589001,.62453,.00661266,0,.613789,.610601,.00618432,0,.639277,.59676,.00578033,0,.66551,.582433,.00540927,0,.692539,.568026,.00506104,0,.720422,.55414,.0047353,0,.749216,.540178,.00442889,0,.778974,.526513,.00414363,0,.809711,.512954,.00388237,0,.84127,.499403,.00362875,0,.873016,.486026,.00340827,0,.904762,.472345,.00318598,0,.936508,.458828,.00297635,0,.968254,.445379,.00279447,0,1,1,.0345716,0,0,1,.0345717,0,0,.999999,.034573,0,0,.999991,.0345787,0,0,.999974,.0345941,0,0,.999937,.0346263,0,188589e-11,.999869,.0346847,0,409238e-9,.999757,.0347798,0,.0017674,.999582,.0349233,0,.00413658,.999322,.0351265,0,.00747408,.998939,.0353967,0,.0117157,.998219,.0357018,0,.0167966,.994974,.0354726,0,.0226572,.993201,.0355621,0,.0292445,.991573,.0357641,0,.0365123,.989301,.0359252,0,.0444203,.985712,.0358017,0,.0529334,.982411,.0358353,0,.0620214,.977827,.035617,0,.0716574,.973278,.0354398,0,.0818186,.967397,.0350483,0,.0924846,.960696,.0344795,0,.103638,.954349,.0339861,0,.115263,.946066,.0331323,0,.127348,.938012,.032359,0,.13988,.929413,.0314413,0,.152849,.920355,.0304103,0,.166248,.910586,.0292785,0,.18007,.900609,.0281391,0,.194308,.890093,.0269103,0,.208958,.880013,.0257269,0,.224018,.869001,.0244671,0,.239485,.85751,.0232252,0,.255359,.84582,.0220117,0,.271638,.834383,.0208274,0,.288324,.822158,.0196628,0,.305419,.809056,.0185306,0,.322927,.795832,.0174174,0,.340851,.782547,.0163758,0,.359199,.7689,.015391,0,.377975,.755526,.0144488,0,.397189,.741681,.0135372,0,.416851,.728178,.0126957,0,.436971,.714642,.0118812,0,.457564,.702756,.0111165,0,.478644,.69175,.0104145,0,.500229,.680159,.00974439,0,.522339,.668073,.00911926,0,.544997,.655405,.00851393,0,.56823,.642921,.00797637,0,.592068,.629993,.00745119,0,.616546,.616828,.00696972,0,.641705,.603305,.00652425,0,.66759,.589833,.00610188,0,.694255,.575945,.00570834,0,.72176,.561745,.00533384,0,.750168,.548277,.00500001,0,.779545,.534467,.00467582,0,.809933,.521032,.00438092,0,.841272,.507877,.00410348,0,.873016,.494654,.00383618,0,.904762,.481592,.00358699,0,.936508,.468509,.00337281,0,.968254,.455293,.00316196,0,1,1,.0430698,0,0,1,.0430699,0,0,.999998,.0430713,0,0,.999991,.0430773,0,0,.99997,.0430936,0,0,.999928,.0431277,0,406396e-10,.999852,.0431893,0,744376e-9,.999724,.0432895,0,.0024806,.999527,.0434397,0,.00524779,.99923,.0436507,0,.00898164,.998783,.0439255,0,.0136083,.997507,.0441104,0,.0190582,.994418,.0438225,0,.0252694,.992864,.0439396,0,.0321879,.991127,.0440962,0,.039767,.987331,.0438408,0,.0479667,.984819,.0438991,0,.056752,.980384,.0435906,0,.0660929,.975846,.0432543,0,.075963,.970748,.0428293,0,.0863398,.964303,.042153,0,.0972035,.95772,.0414111,0,.108537,.950747,.0405893,0,.120325,.942533,.0394887,0,.132554,.934045,.0383544,0,.145215,.924942,.037057,0,.158296,.915811,.0356993,0,.17179,.90612,.0342401,0,.185691,.896434,.0328078,0,.199993,.886021,.031288,0,.214691,.876081,.0297776,0,.229782,.865608,.0282334,0,.245265,.854924,.026749,0,.261138,.843607,.02526,0,.277401,.832456,.0238214,0,.294056,.821342,.0224682,0,.311104,.809303,.0211297,0,.328548,.796468,.0198387,0,.346394,.784046,.0186227,0,.364645,.771262,.0174561,0,.38331,.758118,.0163806,0,.402396,.745075,.0153287,0,.421912,.731926,.0143647,0,.44187,.71863,.0134363,0,.462283,.705414,.0125603,0,.483165,.693792,.0117508,0,.504535,.683108,.0110016,0,.52641,.67183,.0102757,0,.548816,.66015,.00962044,0,.571776,.647907,.00898031,0,.595323,.635734,.00840811,0,.619489,.623208,.00786211,0,.644317,.610438,.00734953,0,.669852,.597345,.00687688,0,.696148,.584138,.00643469,0,.723267,.5707,.00602236,0,.75128,.556966,.0056324,0,.780258,.543607,.00528277,0,.810268,.530213,.00493999,0,.841311,.516912,.00462265,0,.873016,.503916,.0043307,0,.904762,.491146,.00406858,0,.936508,.478439,.00381436,0,.968254,.465834,.00358003,0,1,1,.0534039,0,0,1,.053404,0,0,.999998,.0534055,0,0,.999989,.0534116,0,0,.999968,.0534283,0,0,.999918,.0534633,0,155895e-9,.99983,.0535262,0,.00120914,.999685,.0536281,0,.00334944,.999461,.0537799,0,.00653077,.999119,.0539902,0,.0106718,.998582,.0542524,0,.0156907,.995919,.0540318,0,.0215147,.993735,.0538914,0,.0280801,.992126,.0539557,0,.0353323,.990266,.0540401,0,.0432247,.986317,.0536064,0,.0517172,.983213,.0534425,0,.0607754,.978303,.0528622,0,.0703698,.973665,.0523363,0,.0804742,.968091,.0516165,0,.0910667,.961026,.0505434,0,.102128,.954333,.049523,0,.113641,.946372,.0481698,0,.125591,.938254,.0467674,0,.137965,.929516,.0452341,0,.150754,.920106,.0435083,0,.163947,.910899,.0417399,0,.177537,.901532,.0399389,0,.191516,.891919,.0380901,0,.205881,.882006,.0362341,0,.220626,.871965,.0343444,0,.235749,.862145,.0324832,0,.251248,.852058,.0306681,0,.267121,.84161,.0289097,0,.283368,.830806,.0272079,0,.299992,.820476,.0256089,0,.316992,.809514,.0240394,0,.334374,.797865,.0225379,0,.35214,.785621,.0211235,0,.370296,.773765,.0197908,0,.388849,.761629,.0185235,0,.407807,.748891,.0173358,0,.427178,.736437,.0162305,0,.446974,.723707,.0151778,0,.467207,.710606,.0141791,0,.487892,.698019,.0132592,0,.509046,.686203,.0123887,0,.530687,.675692,.0115976,0,.552839,.664826,.0108325,0,.575527,.65349,.0101348,0,.59878,.641774,.00947756,0,.622634,.629794,.00886058,0,.647128,.617647,.00828526,0,.672308,.60534,.00775312,0,.698231,.592718,.00726033,0,.724958,.579746,.00679731,0,.752563,.566763,.00636111,0,.781127,.553515,.00595228,0,.810733,.540118,.00556876,0,.841426,.527325,.00523051,0,.873016,.514265,.00490712,0,.904762,.501406,.00460297,0,.936508,.488922,.00431247,0,.968254,.476541,.0040472,0,1,1,.0659184,0,0,1,.0659185,0,0,.999998,.06592,0,0,.999988,.0659259,0,0,.999963,.0659423,0,0,.999907,.0659764,0,374198e-9,.999806,.0660376,0,.00182071,.999639,.0661361,0,.0043894,.999378,.0662814,0,.00800055,.998985,.0664779,0,.0125594,.998285,.0666914,0,.0179786,.995071,.0661989,0,.0241822,.993172,.0660454,0,.031106,.991438,.0660105,0,.0386952,.988428,.0656875,0,.0469032,.985218,.0652913,0,.0556905,.981128,.0647107,0,.065023,.976015,.0638491,0,.0748717,.97097,.062993,0,.0852112,.964582,.0617927,0,.0960199,.957383,.0603626,0,.107279,.949969,.0588128,0,.118971,.941843,.0570274,0,.131084,.933624,.0551885,0,.143604,.924543,.053122,0,.156521,.914919,.0508897,0,.169825,.905773,.0486418,0,.18351,.896434,.0463364,0,.197569,.887195,.0440623,0,.211997,.877706,.0417799,0,.226789,.867719,.03945,0,.241944,.858587,.037243,0,.257458,.849317,.0350956,0,.273331,.839585,.0329852,0,.289563,.829856,.0310028,0,.306154,.819589,.0290953,0,.323108,.809714,.0272738,0,.340426,.79934,.0255631,0,.358113,.788224,.0239175,0,.376175,.776619,.0223831,0,.394616,.76521,.0209298,0,.413445,.753716,.0195786,0,.432671,.741564,.0183001,0,.452305,.729413,.0171259,0,.472358,.717146,.0159933,0,.492845,.70436,.0149495,0,.513783,.69219,.0139681,0,.535189,.680289,.0130577,0,.557087,.669611,.0122198,0,.5795,.659113,.0114174,0,.602459,.648148,.0106729,0,.625997,.636905,.00998997,0,.650154,.625154,.00934313,0,.674976,.613481,.00874839,0,.700518,.60154,.00818265,0,.726845,.58943,.00766889,0,.754032,.576828,.00717153,0,.782167,.564194,.00672696,0,.811344,.551501,.00630863,0,.841644,.538635,.00592177,0,.873016,.525724,.00554888,0,.904762,.513209,.00520225,0,.936508,.500457,.00488231,0,.968254,.48799,.00457153,0,1,1,.0810131,0,0,1,.0810133,0,0,.999997,.0810145,0,0,.999985,.08102,0,0,.999956,.0810347,0,195026e-10,.999893,.0810656,0,719316e-9,.999777,.0811205,0,.00259774,.999583,.081208,0,.00561807,.999281,.0813343,0,.00967472,.998813,.0814969,0,.0146627,.997597,.0815217,0,.0204902,.994379,.0808502,0,.0270802,.992744,.0806792,0,.0343674,.990745,.0804589,0,.0422974,.986646,.0796107,0,.0508242,.983611,.0790913,0,.0599087,.978869,.0780746,0,.0695175,.973475,.0768218,0,.0796223,.967845,.0754926,0,.0901983,.960778,.0737063,0,.101224,.953333,.0718052,0,.112682,.945274,.0695946,0,.124555,.936955,.0672492,0,.136831,.928319,.0647732,0,.149496,.919075,.0620947,0,.162542,.909114,.0591816,0,.175958,.900137,.0563917,0,.189739,.891069,.0535392,0,.203877,.882262,.0507642,0,.218368,.873232,.0479793,0,.233208,.864042,.045226,0,.248393,.855002,.0425413,0,.263923,.846569,.0400126,0,.279796,.837714,.0375269,0,.296012,.828918,.0352027,0,.312573,.819783,.0330011,0,.329479,.810129,.0308908,0,.346734,.800866,.0289112,0,.364342,.79093,.0270255,0,.382307,.780593,.0252758,0,.400637,.769511,.0236178,0,.419337,.758558,.0220652,0,.438418,.747632,.0206289,0,.457889,.736146,.0192873,0,.477761,.724093,.0180333,0,.49805,.71234,.0168264,0,.51877,.700201,.015746,0,.53994,.687949,.0147027,0,.561581,.676163,.0137512,0,.583718,.665001,.0128655,0,.60638,.65472,.0120366,0,.629599,.644213,.0112604,0,.653415,.633382,.0105413,0,.677874,.62212,.00986498,0,.70303,.610631,.00923308,0,.728948,.599078,.00864206,0,.755706,.587519,.00811784,0,.783396,.575505,.00761237,0,.812121,.563148,.00713949,0,.841989,.550828,.00668379,0,.873035,.538458,.00627715,0,.904762,.525905,.00588336,0,.936508,.513517,.00552687,0,.968254,.501395,.00519681,0,1,1,.0991506,0,0,1,.0991504,0,0,.999996,.0991515,0,0,.999984,.0991558,0,0,.999947,.0991672,0,114389e-9,.999874,.0991912,0,.00121503,.999739,.0992331,0,.00356108,.999514,.0992983,0,.00705578,.999159,.0993877,0,.011574,.998586,.0994837,0,.017003,.995731,.0988425,0,.0232484,.993384,.098276,0,.0302318,.991615,.0979269,0,.0378884,.989029,.0973432,0,.0461641,.985373,.0963539,0,.0550136,.981278,.0952306,0,.0643988,.975777,.0936233,0,.0742868,.970526,.0920219,0,.0846501,.963755,.0898912,0,.0954644,.956676,.0876064,0,.106709,.948099,.0847751,0,.118367,.939718,.0818638,0,.130423,.931305,.078857,0,.142862,.922342,.0756127,0,.155674,.912842,.0721473,0,.168849,.903304,.0686195,0,.182378,.89411,.0650589,0,.196255,.885512,.0616022,0,.210473,.877193,.0582434,0,.225027,.86877,.0548979,0,.239915,.860267,.0516095,0,.255132,.851915,.048468,0,.270678,.843912,.0454447,0,.286551,.83604,.0425612,0,.302751,.828245,.0398752,0,.31928,.820159,.0373198,0,.336138,.81167,.034916,0,.35333,.802659,.0326402,0,.370858,.793921,.0304901,0,.388728,.784713,.0284857,0,.406944,.774946,.0266186,0,.425515,.76448,.0248593,0,.444449,.753793,.0232114,0,.463756,.743506,.0217039,0,.483447,.732555,.0202841,0,.503535,.720965,.0189648,0,.524036,.709422,.0177189,0,.544968,.697756,.0165626,0,.56635,.685565,.015483,0,.588208,.673987,.0144892,0,.610569,.66244,.0135607,0,.633466,.651675,.0126956,0,.656936,.641598,.0118788,0,.681025,.63121,.0111261,0,.705788,.620514,.010437,0,.731289,.609366,.00978747,0,.757606,.598137,.00917257,0,.784834,.586966,.00859778,0,.813085,.575549,.00806803,0,.842485,.563797,.00757294,0,.87313,.551758,.00710592,0,.904762,.539894,.0066841,0,.936508,.527901,.00627901,0,.968254,.515819,.00590506,0,1,1,.120864,0,0,1,.120864,0,0,.999996,.120864,0,0,.99998,.120867,0,0,.99994,.120872,0,323781e-9,.999852,.120884,0,.00188693,.999693,.120903,0,.00473489,.999426,.120929,0,.00872704,.999002,.120955,0,.0137237,.998235,.120918,0,.0196068,.994608,.119764,0,.0262803,.992997,.119265,0,.0336657,.990968,.11863,0,.0416987,.987002,.117261,0,.0503261,.983524,.116009,0,.0595035,.97875,.114252,0,.0691935,.972652,.11193,0,.0793645,.966613,.109555,0,.0899894,.959275,.106612,0,.101045,.951272,.103375,0,.112512,.942323,.0996594,0,.124372,.933679,.0958841,0,.136611,.924822,.0919265,0,.149216,.915742,.0878061,0,.162176,.906348,.0834894,0,.175482,.896883,.079085,0,.189125,.88774,.0746745,0,.203098,.87986,.0705773,0,.217396,.871998,.0665005,0,.232015,.864325,.0625413,0,.24695,.856685,.0586781,0,.2622,.84925,.0550063,0,.277761,.841719,.0514727,0,.293634,.834755,.0481398,0,.309819,.827853,.0450172,0,.326315,.820888,.0420969,0,.343126,.813616,.0393702,0,.360254,.805767,.0367771,0,.377701,.797338,.0343274,0,.395474,.789122,.0320529,0,.413577,.780601,.0299485,0,.432018,.771424,.0279812,0,.450804,.761502,.0261054,0,.469944,.751166,.0243942,0,.489451,.741276,.0228087,0,.509337,.730898,.0213265,0,.529617,.719878,.0199307,0,.550307,.708379,.0186574,0,.571428,.697165,.0174446,0,.593003,.685554,.0163144,0,.615059,.673631,.015276,0,.637628,.662385,.0143003,0,.660746,.651059,.0134112,0,.68446,.640451,.0125794,0,.70882,.630536,.011793,0,.733893,.620316,.0110547,0,.759756,.609722,.0103668,0,.786505,.598804,.00973009,0,.814259,.587871,.00912812,0,.843157,.577121,.00858916,0,.87334,.566019,.00807333,0,.904762,.554664,.00759687,0,.936508,.543101,.00714759,0,.968254,.531558,.00673418,0,1,1,.146767,0,0,1,.146767,0,0,.999997,.146767,0,0,.999977,.146765,0,320658e-11,.999929,.146762,0,682576e-9,.999823,.146753,0,.00276402,.999633,.146735,0,.00614771,.999314,.146699,0,.0106613,.998796,.14662,0,.0161546,.997124,.146107,0,.0225063,.994062,.144857,0,.0296198,.992154,.144011,0,.037417,.989186,.142712,0,.0458348,.985279,.140926,0,.0548211,.980826,.13885,0,.0643326,.975056,.136168,0,.074333,.969005,.133217,0,.0847917,.961554,.12959,0,.0956828,.954206,.125886,0,.106984,.945046,.121335,0,.118675,.935678,.116492,0,.130741,.926748,.111635,0,.143166,.917764,.106625,0,.155939,.908358,.101325,0,.169049,.899219,.0960249,0,.182487,.890089,.0906527,0,.196245,.881488,.0853905,0,.210317,.874031,.0804177,0,.224697,.866932,.0756005,0,.23938,.859976,.0709019,0,.254364,.853375,.0664391,0,.269646,.846971,.0622012,0,.285223,.840483,.058129,0,.301096,.833969,.0542762,0,.317265,.82806,.0507042,0,.333729,.822128,.047368,0,.350491,.815989,.044272,0,.367554,.809336,.0413444,0,.38492,.802177,.038601,0,.402594,.79441,.0360227,0,.420582,.786573,.0336383,0,.438891,.778619,.0314321,0,.457527,.77,.029362,0,.476499,.760698,.0274102,0,.49582,.750932,.0256146,0,.5155,.740993,.023974,0,.535555,.731159,.0224182,0,.556,.720836,.0209889,0,.576855,.709913,.0196411,0,.598143,.698415,.0183824,0,.619888,.68745,.0172222,0,.642123,.676154,.0161509,0,.664883,.664383,.0151397,0,.688211,.6533,.0141873,0,.71216,.642072,.0133105,0,.736792,.631412,.0124932,0,.762186,.621622,.0117408,0,.788439,.611681,.0110358,0,.815672,.60142,.0103775,0,.844034,.59083,.00975623,0,.873699,.580254,.00918084,0,.904765,.569841,.00864721,0,.936508,.559224,.00815731,0,.968254,.548315,.00767924,0,1,1,.177563,0,0,1,.177563,0,0,.999994,.177562,0,0,.999972,.177555,0,664171e-10,.999914,.177536,0,.0012276,.999787,.177496,0,.00388025,.999556,.17742,0,.00783463,.999165,.177285,0,.0128953,.9985,.177037,0,.0189053,.995388,.175634,0,.025742,.993102,.174375,0,.033309,.990992,.173121,0,.0415298,.986932,.170896,0,.0503425,.982786,.16847,0,.0596964,.977592,.165455,0,.0695498,.971075,.161676,0,.0798676,.963967,.157458,0,.0906201,.956397,.152836,0,.101783,.947489,.147467,0,.113333,.937564,.14145,0,.125254,.928182,.135383,0,.137529,.919027,.129212,0,.150144,.909618,.12276,0,.163088,.900492,.116273,0,.176351,.891671,.1098,0,.189924,.883146,.103362,0,.203799,.875151,.0970799,0,.21797,.868338,.0911732,0,.232433,.862033,.0854966,0,.247182,.856107,.0800691,0,.262216,.850644,.0749618,0,.27753,.845261,.070079,0,.293124,.839885,.0654321,0,.308997,.834609,.0610975,0,.325149,.829083,.0569741,0,.341581,.82404,.0531736,0,.358294,.818968,.049665,0,.37529,.813496,.0463856,0,.392573,.807533,.0433217,0,.410148,.80099,.0404402,0,.428019,.793891,.0377578,0,.446192,.786281,.0352616,0,.464676,.778773,.0329577,0,.483478,.770737,.030808,0,.502608,.762094,.0287964,0,.522079,.752898,.0269254,0,.541905,.743306,.0251926,0,.5621,.733416,.023595,0,.582684,.723742,.0221155,0,.603677,.713542,.0207435,0,.625106,.702755,.019434,0,.646998,.691484,.0182046,0,.66939,.680531,.0170771,0,.692324,.66953,.0160339,0,.715849,.658126,.0150677,0,.740028,.646933,.0141551,0,.764937,.636107,.0133179,0,.790673,.625271,.0125284,0,.817358,.615225,.0117937,0,.84515,.605678,.0111181,0,.874244,.59583,.0104759,0,.904828,.585704,.00986672,0,.936508,.575413,.00929712,0,.968254,.565373,.00876713,0,1,1,.214058,0,0,.999999,.214058,0,0,.999994,.214055,0,0,.999966,.214039,0,259642e-9,.999893,.213998,0,.00200075,.999737,.21391,0,.00527775,.999449,.213745,0,.00983959,.99896,.213458,0,.0154755,.9979,.212855,0,.0220249,.994278,.210779,0,.0293654,.992254,.20926,0,.0374021,.98881,.206908,0,.0460604,.984715,.204009,0,.0552802,.979738,.200471,0,.0650127,.972884,.195813,0,.0752175,.965996,.190856,0,.0858612,.957974,.185077,0,.0969155,.949155,.17868,0,.108356,.939288,.171513,0,.120163,.928996,.163838,0,.132319,.919563,.156246,0,.144808,.910004,.148359,0,.157618,.900791,.140417,0,.170737,.892135,.132569,0,.184155,.883803,.124741,0,.197866,.876034,.117091,0,.211861,.869219,.109835,0,.226134,.863062,.102859,0,.240682,.857795,.0962928,0,.255499,.853009,.0900725,0,.270583,.848603,.0842101,0,.285931,.844335,.0786527,0,.301542,.840208,.0734397,0,.317415,.836035,.0685334,0,.33355,.83172,.0639275,0,.349948,.827135,.0595909,0,.36661,.822797,.0556204,0,.383539,.818387,.0519394,0,.400738,.813565,.0485317,0,.41821,.808142,.0453138,0,.435961,.802212,.0423354,0,.453997,.79573,.0395553,0,.472324,.788741,.036988,0,.490951,.781093,.0345688,0,.509887,.773597,.0323297,0,.529144,.765622,.0302719,0,.548735,.757083,.0283477,0,.568674,.747992,.0265562,0,.588979,.738591,.0248844,0,.609671,.728719,.0233342,0,.630773,.719146,.0219081,0,.652314,.709165,.0205711,0,.674328,.69875,.0193248,0,.696854,.687884,.0181582,0,.719942,.676818,.0170746,0,.743651,.666247,.0160718,0,.768057,.655284,.0151262,0,.793253,.64401,.0142561,0,.819363,.633353,.0134327,0,.846547,.622674,.012653,0,.875017,.612265,.0119354,0,.905021,.602455,.0112533,0,.936508,.593147,.0106234,0,.968254,.583592,.0100213,0,1,1,.25717,0,0,1,.25717,0,0,.999992,.257164,0,0,.999958,.257135,0,641715e-9,.999864,.25706,0,.00305314,.999666,.256897,0,.00700975,.999302,.256596,0,.0122194,.998663,.25607,0,.0184622,.995607,.254123,0,.0255773,.993094,.252081,0,.0334439,.9907,.249867,0,.0419696,.98594,.246118,0,.0510823,.981214,.242049,0,.0607242,.974966,.236869,0,.0708486,.967589,.230724,0,.081417,.95915,.223635,0,.0923974,.950257,.21596,0,.103763,.940165,.207296,0,.115491,.929396,.197901,0,.127562,.919288,.188437,0,.13996,.909428,.178762,0,.15267,.900105,.169072,0,.165679,.891418,.159478,0,.178979,.883347,.15002,0,.192558,.875992,.140813,0,.20641,.869466,.13196,0,.220529,.863699,.123501,0,.234907,.858553,.115436,0,.249542,.854379,.107901,0,.264428,.850894,.10088,0,.279564,.847632,.0942296,0,.294947,.844571,.0879861,0,.310575,.84163,.0821534,0,.326448,.838542,.0766409,0,.342566,.835412,.0715322,0,.358929,.831899,.0666883,0,.37554,.828177,.0622175,0,.392399,.82416,.0580452,0,.409511,.820393,.054267,0,.426878,.816068,.0507172,0,.444506,.811201,.0474041,0,.4624,.805785,.0443174,0,.480566,.799878,.0414562,0,.499013,.793469,.0388147,0,.517749,.786473,.0363453,0,.536785,.778874,.0340225,0,.556134,.771277,.0318599,0,.575809,.763426,.0298859,0,.595827,.755044,.0280357,0,.616207,.746161,.0262979,0,.636973,.737124,.0247295,0,.65815,.72761,.0232514,0,.679772,.717822,.0218755,0,.701876,.708279,.0205942,0,.724509,.698333,.0193947,0,.74773,.68802,.0182717,0,.771609,.677321,.0172044,0,.79624,.666504,.0162122,0,.821743,.656184,.0152924,0,.84828,.64556,.0144326,0,.876069,.634636,.0136157,0,.905404,.624124,.0128612,0,.936508,.613914,.0121435,0,.968254,.603589,.0114887,0,1,1,.307946,0,0,.999999,.307945,0,0,.999988,.307934,0,204479e-10,.999944,.307886,0,.00127833,.999824,.307756,0,.00445047,.999565,.30748,0,.00914673,.999085,.306966,0,.0150498,.998103,.306004,0,.0219367,.994249,.303028,0,.0296485,.991807,.300435,0,.038068,.987773,.296554,0,.0471062,.982673,.2916,0,.0566942,.976623,.285641,0,.0667768,.968757,.27815,0,.0773099,.959849,.269529,0,.088257,.950663,.260248,0,.0995879,.940129,.249704,0,.111277,.92895,.238291,0,.123304,.917996,.226501,0,.13565,.907813,.214669,0,.148299,.898305,.202835,0,.161237,.889626,.191158,0,.174455,.88175,.179695,0,.187941,.874715,.168548,0,.201687,.868746,.15792,0,.215687,.863703,.147807,0,.229933,.859315,.138149,0,.24442,.855538,.128993,0,.259145,.852428,.120414,0,.274103,.850168,.112498,0,.289293,.848132,.105054,0,.304711,.846291,.0981087,0,.320357,.844431,.0915942,0,.33623,.842493,.0855056,0,.35233,.840368,.0798204,0,.368658,.83798,.0745097,0,.385214,.83523,.0695424,0,.402002,.832091,.0649092,0,.419023,.828667,.0606291,0,.436282,.824805,.0566523,0,.453782,.820988,.0530229,0,.471529,.816635,.0496364,0,.489528,.811725,.0464658,0,.507788,.806316,.0435082,0,.526317,.800469,.0407873,0,.545124,.794107,.038255,0,.564221,.787218,.0358825,0,.583621,.779872,.0336785,0,.603341,.772097,.0316379,0,.623397,.764484,.0297379,0,.643812,.756428,.0279581,0,.664611,.748022,.0263153,0,.685824,.739268,.0247799,0,.707488,.73024,.0233385,0,.729646,.720893,.0220035,0,.752354,.71119,.0207555,0,.77568,.701791,.0195843,0,.799715,.692184,.0184891,0,.824574,.682258,.0174541,0,.850417,.67206,.0164873,0,.877466,.661717,.0155959,0,.90604,.651462,.0147519,0,.936528,.641467,.0139727,0,.968254,.631229,.0132363,0,1,1,.367573,0,0,.999999,.367571,0,0,.999984,.367553,0,183382e-9,.999925,.367473,0,.00225254,.999759,.367259,0,.00628165,.99941,.366801,0,.0117858,.998739,.365946,0,.0184359,.995529,.363191,0,.0260114,.992875,.360171,0,.0343581,.989135,.355981,0,.0433637,.984166,.350401,0,.0529438,.977871,.343348,0,.0630334,.96951,.334341,0,.0735805,.959964,.323862,0,.0845437,.950162,.312521,0,.095889,.938882,.299577,0,.107588,.926992,.285573,0,.119617,.915589,.271212,0,.131957,.904791,.256611,0,.144591,.895177,.242224,0,.157503,.886403,.227952,0,.170682,.878957,.214192,0,.184117,.872418,.200795,0,.197799,.867029,.188015,0,.21172,.862835,.175975,0,.225873,.859411,.164526,0,.240253,.856655,.153693,0,.254854,.854519,.14352,0,.269673,.852828,.13397,0,.284707,.851412,.124984,0,.299953,.850609,.116748,0,.315408,.849855,.10905,0,.331073,.849017,.101839,0,.346946,.848079,.0951359,0,.363028,.846911,.0888774,0,.379318,.845445,.0830375,0,.395818,.84362,.0775844,0,.41253,.841411,.0725054,0,.429457,.838768,.0677691,0,.446602,.835801,.0634016,0,.463968,.832341,.0593095,0,.481561,.828424,.0555121,0,.499386,.824312,.052024,0,.51745,.819918,.0487865,0,.535761,.815072,.0457801,0,.554328,.809863,.0430184,0,.573162,.804164,.0404245,0,.592275,.798034,.0380146,0,.611681,.791436,.0357436,0,.631398,.784498,.0336475,0,.651445,.777125,.0316666,0,.671845,.769365,.0298122,0,.692628,.761579,.0281001,0,.713827,.753746,.0265049,0,.735484,.745573,.0250067,0,.75765,.737083,.0236026,0,.78039,.728545,.0223302,0,.803789,.719691,.0211243,0,.82796,.710569,.0199983,0,.853056,.701216,.0189569,0,.879298,.692094,.0179702,0,.907014,.682909,.0170418,0,.936691,.673509,.0161732,0,.968254,.663863,.0153406,0,1,1,.437395,0,0,.999998,.437394,0,0,.99998,.437363,0,616704e-9,.999891,.437232,0,.00367925,.999656,.436877,0,.00867446,.999148,.436121,0,.0150679,.997959,.434564,0,.022531,.993464,.430134,0,.0308507,.990606,.426077,0,.0398805,.985027,.419397,0,.0495148,.978491,.41118,0,.0596749,.969643,.40048,0,.0703001,.959189,.38769,0,.0813427,.948223,.373575,0,.0927641,.935955,.357622,0,.104533,.923237,.34043,0,.116624,.911074,.322735,0,.129015,.899724,.30479,0,.141687,.890189,.287392,0,.154626,.881796,.270248,0,.167818,.874781,.253659,0,.181252,.869166,.237786,0,.194918,.864725,.222618,0,.208807,.861565,.208356,0,.222913,.859284,.194867,0,.237229,.857677,.18212,0,.25175,.856714,.17018,0,.266473,.856155,.158969,0,.281392,.8558,.148413,0,.296505,.855672,.138578,0,.311811,.855538,.129345,0,.327306,.855689,.120861,0,.342991,.855767,.112969,0,.358864,.855618,.105593,0,.374925,.85525,.0987451,0,.391176,.854583,.0923727,0,.407616,.853534,.0864143,0,.424249,.852061,.0808338,0,.441076,.850253,.0756771,0,.4581,.848004,.0708612,0,.475324,.845333,.0663784,0,.492754,.842376,.0622631,0,.510394,.838956,.0584112,0,.528251,.835121,.0548328,0,.546331,.830842,.0514838,0,.564644,.826212,.048355,0,.583198,.821522,.0454714,0,.602005,.816551,.0428263,0,.621078,.811211,.0403612,0,.640434,.805479,.038039,0,.660089,.799409,.0358739,0,.680066,.79306,.0338727,0,.70039,.786395,.0319985,0,.721094,.779416,.030241,0,.742215,.77214,.0285951,0,.7638,.764636,.0270747,0,.785912,.756836,.0256354,0,.808628,.749315,.0243027,0,.832055,.741561,.0230497,0,.856338,.733589,.0218801,0,.88169,.725479,.020784,0,.908441,.717255,.0197702,0,.937125,.708829,.0188168,0,.968254,.700191,.0179113,0,1,1,.518937,0,0,.999998,.518933,0,0,.999967,.518883,0,.00147741,.999832,.51866,0,.00573221,.999466,.518057,0,.011826,.998644,.516752,0,.0192116,.994458,.512347,0,.027573,.991223,.507675,0,.0367099,.985515,.500188,0,.046487,.978308,.490408,0,.0568071,.968359,.477357,0,.0675984,.95682,.461752,0,.0788059,.943929,.443796,0,.090386,.930224,.423893,0,.102304,.916514,.402682,0,.114532,.903653,.380914,0,.127047,.892315,.359212,0,.139828,.882942,.338102,0,.152861,.875438,.31773,0,.16613,.869642,.298186,0,.179624,.865304,.279491,0,.193332,.862382,.261804,0,.207247,.860666,.245146,0,.22136,.859788,.229406,0,.235666,.859608,.214605,0,.250158,.859912,.200691,0,.264832,.86053,.187623,0,.279684,.861368,.17539,0,.294711,.862237,.163901,0,.309911,.863127,.153175,0,.32528,.863923,.143147,0,.340819,.864567,.133781,0,.356524,.865013,.125042,0,.372397,.86539,.116952,0,.388438,.865591,.109476,0,.404645,.865517,.102542,0,.421022,.865084,.0960688,0,.437569,.864309,.0900499,0,.454287,.863151,.0844328,0,.471181,.861649,.0792218,0,.488253,.859742,.0743482,0,.505507,.857446,.0697963,0,.522947,.854757,.0655364,0,.54058,.851783,.061608,0,.558412,.848516,.0579701,0,.576449,.844897,.0545742,0,.594701,.840956,.0514167,0,.613178,.836676,.0484598,0,.631892,.832075,.0456934,0,.650856,.827191,.0431178,0,.670088,.822295,.0407718,0,.689606,.817294,.0386032,0,.709434,.812013,.0365675,0,.7296,.806465,.0346547,0,.750138,.800691,.0328717,0,.771093,.794709,.031211,0,.792519,.788493,.0296504,0,.814488,.782049,.0281782,0,.837097,.775403,.0267965,0,.860481,.76857,.0255002,0,.884842,.761536,.0242759,0,.910494,.754303,.0231142,0,.937985,.74692,.0220305,0,.968254,.739745,.0210192,0,1,1,.613914,0,0,.999996,.613907,0,963597e-10,.999942,.613814,0,.00301247,.999704,.613407,0,.00870385,.999046,.612302,0,.0160714,.995516,.608266,0,.0245899,.991726,.602863,0,.0339681,.985157,.593956,0,.0440254,.97642,.581748,0,.0546409,.964404,.565183,0,.0657284,.950601,.545273,0,.0772246,.935158,.522129,0,.0890812,.919364,.496782,0,.10126,.904754,.470571,0,.113731,.89176,.444037,0,.126469,.881492,.418322,0,.139454,.873656,.393522,0,.15267,.868053,.369795,0,.166101,.864336,.347171,0,.179736,.862259,.325737,0,.193565,.861556,.305532,0,.207578,.861776,.286416,0,.221769,.862661,.268355,0,.23613,.864015,.251334,0,.250656,.865711,.235352,0,.265343,.867519,.220302,0,.280187,.869351,.206161,0,.295183,.871144,.192908,0,.31033,.872839,.180505,0,.325624,.874307,.168848,0,.341065,.875667,.158021,0,.35665,.876758,.147877,0,.37238,.87764,.138441,0,.388253,.878237,.129627,0,.404269,.878563,.121415,0,.42043,.878572,.113741,0,.436735,.87842,.106652,0,.453187,.878057,.100097,0,.469786,.877413,.0940128,0,.486536,.87646,.0883462,0,.503439,.875233,.0830924,0,.520498,.8737,.0781975,0,.537717,.871873,.07364,0,.555102,.86978,.0694103,0,.572657,.867405,.0654696,0,.59039,.864751,.0617914,0,.608307,.861818,.0583491,0,.626419,.858645,.0551443,0,.644733,.855307,.0521894,0,.663264,.851736,.0494334,0,.682025,.847927,.0468504,0,.701032,.843888,.0444261,0,.720308,.839629,.0421497,0,.739875,.835158,.0400082,0,.759764,.830509,.0380076,0,.780014,.825714,.0361488,0,.800673,.820729,.0343956,0,.821803,.815751,.0327781,0,.843492,.810752,.031275,0,.86586,.805587,.0298542,0,.889087,.800317,.0285397,0,.913466,.79489,.0272948,0,.93952,.789314,.0261139,0,.96835,.783593,.0249938,0,1,1,.724258,0,0,.999992,.724243,0,726889e-9,.99987,.724044,0,.00569574,.999336,.72317,0,.0131702,.996271,.719432,0,.0220738,.991159,.712576,0,.0319405,.982465,.700927,0,.0425202,.97049,.684297,0,.0536599,.953973,.661244,0,.065258,.935546,.633804,0,.0772427,.916596,.603071,0,.0895616,.899353,.57105,0,.102175,.885216,.539206,0,.11505,.875076,.508714,0,.128164,.868334,.479571,0,.141495,.864414,.451796,0,.155026,.862678,.425328,0,.168745,.862835,.400352,0,.182639,.864067,.376532,0,.196699,.866086,.35391,0,.210915,.868557,.332424,0,.225282,.871271,.312053,0,.239792,.874058,.292764,0,.25444,.8768,.27453,0,.269223,.87939,.257297,0,.284135,.8819,.24114,0,.299174,.884187,.225934,0,.314337,.886262,.211669,0,.329622,.888119,.198311,0,.345026,.889709,.185783,0,.360549,.891054,.174063,0,.376189,.892196,.163143,0,.391946,.893101,.152952,0,.407819,.893803,.143475,0,.423808,.894277,.134647,0,.439914,.894532,.126434,0,.456137,.894576,.1188,0,.472479,.894393,.111694,0,.48894,.893976,.105069,0,.505523,.893346,.0989077,0,.52223,.892502,.0931724,0,.539064,.891441,.0878276,0,.556028,.890276,.082903,0,.573125,.888972,.0783505,0,.590361,.887469,.0741083,0,.607741,.885785,.0701633,0,.62527,.883914,.0664835,0,.642957,.881872,.0630567,0,.660809,.879651,.0598527,0,.678836,.877267,.0568615,0,.69705,.874717,.05406,0,.715465,.872012,.0514378,0,.734098,.869157,.0489805,0,.752968,.866155,.0466727,0,.772101,.863014,.0445056,0,.791529,.859748,.0424733,0,.81129,.856416,.0405957,0,.831438,.852958,.0388273,0,.852044,.849382,.0371619,0,.87321,.845694,.0355959,0,.89509,.841893,.0341155,0,.917932,.837981,.0327141,0,.942204,.833963,.0313856,0,.968981,.829847,.0301275,0,1,1,.85214,0,0,.999969,.852095,0,.00279627,.999483,.851408,0,.0107635,.994545,.84579,0,.0206454,.986188,.835231,0,.0315756,.969847,.814687,0,.0432021,.945951,.783735,0,.0553396,.91917,.746074,0,.0678766,.895488,.706938,0,.0807395,.878232,.669534,0,.0938767,.868252,.635168,0,.10725,.863873,.603069,0,.120832,.863369,.572514,0,.134598,.86545,.543169,0,.148533,.868803,.514578,0,.16262,.872794,.486762,0,.176849,.87702,.459811,0,.19121,.881054,.433654,0,.205694,.884974,.408574,0,.220294,.888587,.384525,0,.235005,.891877,.36156,0,.24982,.894793,.339661,0,.264737,.89743,.318913,0,.279751,.899796,.299302,0,.294859,.901943,.280843,0,.310058,.903858,.263481,0,.325346,.905574,.247197,0,.340721,.907069,.231915,0,.356181,.908379,.217614,0,.371725,.90952,.20425,0,.387353,.910483,.191758,0,.403063,.91128,.180092,0,.418854,.911936,.169222,0,.434727,.912454,.159098,0,.450682,.912835,.149668,0,.466718,.913078,.140884,0,.482837,.913192,.132709,0,.499038,.913175,.125095,0,.515324,.91304,.118012,0,.531695,.912781,.111417,0,.548153,.91241,.105281,0,.5647,.911924,.0995691,0,.581338,.911331,.0942531,0,.59807,.910637,.0893076,0,.6149,.90984,.0846998,0,.63183,.908941,.0804044,0,.648865,.907944,.0763984,0,.666011,.906857,.0726638,0,.683273,.90568,.0691783,0,.700659,.904416,.0659222,0,.718176,.903067,.0628782,0,.735834,.901637,.0600307,0,.753646,.900128,.0573647,0,.771625,.898544,.0548668,0,.78979,.89689,.052527,0,.808162,.895165,.0503306,0,.826771,.893371,.0482668,0,.845654,.891572,.0463605,0,.864863,.889763,.0445998,0,.884472,.887894,.0429451,0,.904592,.885967,.0413884,0,.925407,.883984,.0399225,0,.947271,.881945,.0385405,0,.97105,.879854,.0372362,0,1,.999804,.995833,0,0,.938155,.933611,0,.0158731,.864755,.854311,0,.0317461,.888594,.865264,0,.0476191,.905575,.863922,0,.0634921,.915125,.850558,0,.0793651,.920665,.829254,0,.0952381,.924073,.802578,0,.111111,.926304,.772211,0,.126984,.927829,.739366,0,.142857,.928924,.705033,0,.15873,.92973,.670019,0,.174603,.930339,.634993,0,.190476,.930811,.600485,0,.206349,.931191,.566897,0,.222222,.93149,.534485,0,.238095,.931737,.503429,0,.253968,.931939,.473811,0,.269841,.932108,.445668,0,.285714,.93225,.418993,0,.301587,.932371,.393762,0,.31746,.932474,.369939,0,.333333,.932562,.347479,0,.349206,.932638,.326336,0,.365079,.932703,.306462,0,.380952,.93276,.287805,0,.396825,.932809,.270313,0,.412698,.932851,.253933,0,.428571,.932887,.23861,0,.444444,.932917,.224289,0,.460317,.932943,.210917,0,.47619,.932965,.19844,0,.492063,.932982,.186807,0,.507937,.932995,.175966,0,.52381,.933005,.165869,0,.539683,.933011,.156468,0,.555556,.933013,.147719,0,.571429,.933013,.139579,0,.587302,.93301,.132007,0,.603175,.933004,.124965,0,.619048,.932994,.118416,0,.634921,.932982,.112326,0,.650794,.932968,.106663,0,.666667,.93295,.101397,0,.68254,.932931,.0964993,0,.698413,.932908,.0919438,0,.714286,.932883,.0877057,0,.730159,.932856,.0837623,0,.746032,.932827,.0800921,0,.761905,.932796,.0766754,0,.777778,.932762,.0734936,0,.793651,.932727,.0705296,0,.809524,.932689,.0677676,0,.825397,.93265,.0651929,0,.84127,.932609,.0627917,0,.857143,.932565,.0605515,0,.873016,.932521,.0584606,0,.888889,.932474,.0565082,0,.904762,.932427,.0546841,0,.920635,.932377,.0529793,0,.936508,.932326,.0513851,0,.952381,.932274,.0498936,0,.968254,.93222,.0484975,0,.984127,.932164,.0471899,0,1]),64,64,RGBAFormat,FloatType,UVMapping,ClampToEdgeWrapping,ClampToEdgeWrapping,LinearFilter,NearestFilter,1);UniformsLib.LTC_1=d,UniformsLib.LTC_2=v;var g={ltc_1:{value:null},ltc_2:{value:null}};Object.assign(ShaderLib.standard.uniforms,g),Object.assign(ShaderLib.physical.uniforms,g)}};function InterleavedBuffer(s,e){this.array=s,this.stride=e,this.count=void 0!==s?s.length/e:0,this.usage=StaticDrawUsage,this.updateRange={offset:0,count:-1},this.version=0}function InstancedInterleavedBuffer(s,e,a){InterleavedBuffer.call(this,s,e),this.meshPerAttribute=a||1}Object.defineProperty(InterleavedBuffer.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(InterleavedBuffer.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},copyAt:function(e,a,d){e*=this.stride,d*=a.stride;for(var v=0,g=this.stride;v<g;v++)this.array[e+v]=a.array[d+v];return this},set:function(e,a){return void 0===a&&(a=0),this.array.set(e,a),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}}),InstancedInterleavedBuffer.prototype=Object.assign(Object.create(InterleavedBuffer.prototype),{constructor:InstancedInterleavedBuffer,isInstancedInterleavedBuffer:!0,copy:function(e){return InterleavedBuffer.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}});var _vector$6=new Vector3;function InterleavedBufferAttribute(s,e,a,d){this.data=s,this.itemSize=e,this.offset=a,this.normalized=!0===d}function InstancedBufferGeometry(){BufferGeometry.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function WireframeGeometry(s){BufferGeometry.call(this),this.type="WireframeGeometry";var a,d,v,g,C,x,b,A,E,O,e=[],w=[0,0],_={},R=["a","b","c"];if(s&&s.isGeometry){var D=s.faces;for(a=0,v=D.length;a<v;a++){var F=D[a];for(d=0;d<3;d++)b=F[R[d]],A=F[R[(d+1)%3]],w[0]=Math.min(b,A),w[1]=Math.max(b,A),void 0===_[E=w[0]+","+w[1]]&&(_[E]={index1:w[0],index2:w[1]})}for(E in _)e.push((O=s.vertices[(x=_[E]).index1]).x,O.y,O.z),e.push((O=s.vertices[x.index2]).x,O.y,O.z)}else if(s&&s.isBufferGeometry){var L,I,V,z,H;if(O=new Vector3,null!==s.index){for(L=s.attributes.position,I=s.index,0===(V=s.groups).length&&(V=[{start:0,count:I.count,materialIndex:0}]),g=0,C=V.length;g<C;++g)for(a=H=(z=V[g]).start,v=H+z.count;a<v;a+=3)for(d=0;d<3;d++)b=I.getX(a+d),A=I.getX(a+(d+1)%3),w[0]=Math.min(b,A),w[1]=Math.max(b,A),void 0===_[E=w[0]+","+w[1]]&&(_[E]={index1:w[0],index2:w[1]});for(E in _)O.fromBufferAttribute(L,(x=_[E]).index1),e.push(O.x,O.y,O.z),O.fromBufferAttribute(L,x.index2),e.push(O.x,O.y,O.z)}else for(a=0,v=(L=s.attributes.position).count/3;a<v;a++)for(d=0;d<3;d++)O.fromBufferAttribute(L,3*a+d),e.push(O.x,O.y,O.z),O.fromBufferAttribute(L,3*a+(d+1)%3),e.push(O.x,O.y,O.z)}this.setAttribute("position",new Float32BufferAttribute(e,3))}Object.defineProperties(InterleavedBufferAttribute.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(InterleavedBufferAttribute.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(e){for(var a=0,d=this.data.count;a<d;a++)_vector$6.x=this.getX(a),_vector$6.y=this.getY(a),_vector$6.z=this.getZ(a),_vector$6.applyMatrix4(e),this.setXYZ(a,_vector$6.x,_vector$6.y,_vector$6.z);return this},setX:function(e,a){return this.data.array[e*this.data.stride+this.offset]=a,this},setY:function(e,a){return this.data.array[e*this.data.stride+this.offset+1]=a,this},setZ:function(e,a){return this.data.array[e*this.data.stride+this.offset+2]=a,this},setW:function(e,a){return this.data.array[e*this.data.stride+this.offset+3]=a,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,a,d){return this.data.array[(e=e*this.data.stride+this.offset)+0]=a,this.data.array[e+1]=d,this},setXYZ:function(e,a,d,v){return this.data.array[(e=e*this.data.stride+this.offset)+0]=a,this.data.array[e+1]=d,this.data.array[e+2]=v,this},setXYZW:function(e,a,d,v,g){return this.data.array[(e=e*this.data.stride+this.offset)+0]=a,this.data.array[e+1]=d,this.data.array[e+2]=v,this.data.array[e+3]=g,this}}),InstancedBufferGeometry.prototype=Object.assign(Object.create(BufferGeometry.prototype),{constructor:InstancedBufferGeometry,isInstancedBufferGeometry:!0,copy:function(e){return BufferGeometry.prototype.copy.call(this,e),this.maxInstancedCount=e.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e=BufferGeometry.prototype.toJSON.call(this);return e.maxInstancedCount=this.maxInstancedCount,e.isInstancedBufferGeometry=!0,e}}),WireframeGeometry.prototype=Object.create(BufferGeometry.prototype),WireframeGeometry.prototype.constructor=WireframeGeometry;var LineSegmentsGeometry=function(){InstancedBufferGeometry.call(this),this.type="LineSegmentsGeometry",this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this.setAttribute("position",new Float32BufferAttribute([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this.setAttribute("uv",new Float32BufferAttribute([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2))};LineSegmentsGeometry.prototype=Object.assign(Object.create(InstancedBufferGeometry.prototype),{constructor:LineSegmentsGeometry,isLineSegmentsGeometry:!0,applyMatrix4:function(e){var a=this.attributes.instanceStart,d=this.attributes.instanceEnd;return void 0!==a&&(a.applyMatrix4(e),d.applyMatrix4(e),a.data.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},setPositions:function(e){var a;e instanceof Float32Array?a=e:Array.isArray(e)&&(a=new Float32Array(e));var d=new InstancedInterleavedBuffer(a,6,1);return this.setAttribute("instanceStart",new InterleavedBufferAttribute(d,3,0)),this.setAttribute("instanceEnd",new InterleavedBufferAttribute(d,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this},setColors:function(e){var a;e instanceof Float32Array?a=e:Array.isArray(e)&&(a=new Float32Array(e));var d=new InstancedInterleavedBuffer(a,6,1);return this.setAttribute("instanceColorStart",new InterleavedBufferAttribute(d,3,0)),this.setAttribute("instanceColorEnd",new InterleavedBufferAttribute(d,3,3)),this},fromWireframeGeometry:function(e){return this.setPositions(e.attributes.position.array),this},fromEdgesGeometry:function(e){return this.setPositions(e.attributes.position.array),this},fromMesh:function(e){return this.fromWireframeGeometry(new WireframeGeometry(e.geometry)),this},fromLineSegements:function(e){var a=e.geometry;return a.isGeometry?this.setPositions(a.vertices):a.isBufferGeometry&&this.setPositions(a.position.array),this},computeBoundingBox:function(){var s=new Box3;return function(){null===this.boundingBox&&(this.boundingBox=new Box3);var a=this.attributes.instanceStart,d=this.attributes.instanceEnd;void 0!==a&&void 0!==d&&(this.boundingBox.setFromBufferAttribute(a),s.setFromBufferAttribute(d),this.boundingBox.union(s))}}(),computeBoundingSphere:function(){var s=new Vector3;return function(){null===this.boundingSphere&&(this.boundingSphere=new Sphere),null===this.boundingBox&&this.computeBoundingBox();var a=this.attributes.instanceStart,d=this.attributes.instanceEnd;if(void 0!==a&&void 0!==d){var v=this.boundingSphere.center;this.boundingBox.getCenter(v);for(var g=0,C=0,w=a.count;C<w;C++)s.fromBufferAttribute(a,C),g=Math.max(g,v.distanceToSquared(s)),s.fromBufferAttribute(d,C),g=Math.max(g,v.distanceToSquared(s));this.boundingSphere.radius=Math.sqrt(g),isNaN(this.boundingSphere.radius)&&console.error("LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}}(),toJSON:function(){},applyMatrix:function(e){return console.warn("LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}}),UniformsLib.line={linewidth:{value:1},resolution:{value:new Vector2(1,1)},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}},ShaderLib.line={uniforms:UniformsUtils.merge([UniformsLib.common,UniformsLib.fog,UniformsLib.line]),vertexShader:"\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\n\t\tvarying vec2 vUv;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\tvUv = uv;\n\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec2 ndcStart = clipStart.xy / clipStart.w;\n\t\t\tvec2 ndcEnd = clipEnd.xy / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd - ndcStart;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\n\t\t\t// perpendicular to dir\n\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\n\t\t\t// undo aspect ratio adjustment\n\t\t\tdir.x /= aspect;\n\t\t\toffset.x /= aspect;\n\n\t\t\t// sign flip\n\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t// endcaps\n\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\toffset += - dir;\n\n\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\toffset += dir;\n\n\t\t\t}\n\n\t\t\t// adjust for linewidth\n\t\t\toffset *= linewidth;\n\n\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\toffset /= resolution.y;\n\n\t\t\t// select end\n\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t// back to clip space\n\t\t\toffset *= clip.w;\n\n\t\t\tclip.xy += offset;\n\n\t\t\tgl_Position = clip;\n\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashSize;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\n\t\tvarying float vLineDistance;\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\tfloat a = vUv.x;\n\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\tif ( len2 > 1.0 ) discard;\n\n\t\t\t}\n\n\t\t\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, diffuseColor.a );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <encodings_fragment>\n\t\t\t#include <fog_fragment>\n\t\t\t#include <premultiplied_alpha_fragment>\n\n\t\t}\n\t\t"};var LineMaterial=function(e){ShaderMaterial.call(this,{type:"LineMaterial",uniforms:UniformsUtils.clone(ShaderLib.line.uniforms),vertexShader:ShaderLib.line.vertexShader,fragmentShader:ShaderLib.line.fragmentShader,clipping:!0}),this.dashed=!1,Object.defineProperties(this,{color:{enumerable:!0,get:function(){return this.uniforms.diffuse.value},set:function(d){this.uniforms.diffuse.value=d}},linewidth:{enumerable:!0,get:function(){return this.uniforms.linewidth.value},set:function(d){this.uniforms.linewidth.value=d}},dashScale:{enumerable:!0,get:function(){return this.uniforms.dashScale.value},set:function(d){this.uniforms.dashScale.value=d}},dashSize:{enumerable:!0,get:function(){return this.uniforms.dashSize.value},set:function(d){this.uniforms.dashSize.value=d}},gapSize:{enumerable:!0,get:function(){return this.uniforms.gapSize.value},set:function(d){this.uniforms.gapSize.value=d}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(d){this.uniforms.resolution.value.copy(d)}}}),this.setValues(e)};LineMaterial.prototype=Object.create(ShaderMaterial.prototype),LineMaterial.prototype.constructor=LineMaterial,LineMaterial.prototype.isLineMaterial=!0;var LineSegments2=function(e,a){Mesh.call(this),this.type="LineSegments2",this.geometry=void 0!==e?e:new LineSegmentsGeometry,this.material=void 0!==a?a:new LineMaterial({color:16777215*Math.random()})};LineSegments2.prototype=Object.assign(Object.create(Mesh.prototype),{constructor:LineSegments2,isLineSegments2:!0,computeLineDistances:function(){var s=new Vector3,e=new Vector3;return function(){for(var d=this.geometry,v=d.attributes.instanceStart,g=d.attributes.instanceEnd,C=new Float32Array(2*v.data.count),w=0,_=0,x=v.data.count;w<x;w++,_+=2)s.fromBufferAttribute(v,w),e.fromBufferAttribute(g,w),C[_]=0===_?0:C[_-1],C[_+1]=C[_]+s.distanceTo(e);var b=new InstancedInterleavedBuffer(C,2,1);return d.setAttribute("instanceDistanceStart",new InterleavedBufferAttribute(b,1,0)),d.setAttribute("instanceDistanceEnd",new InterleavedBufferAttribute(b,1,1)),this}}(),raycast:function(){var s=new Vector4,e=new Vector4,a=new Vector4,d=new Vector3,v=new Matrix4,g=new Line3,C=new Vector3;return function(_,x){null===_.camera&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2.');var b=_.ray,A=_.camera,E=A.projectionMatrix,R=this.geometry,O=this.material,D=O.resolution,F=O.linewidth,L=R.attributes.instanceStart,I=R.attributes.instanceEnd;b.at(1,a),a.w=1,a.applyMatrix4(A.matrixWorldInverse),a.applyMatrix4(E),a.multiplyScalar(1/a.w),a.x*=D.x/2,a.y*=D.y/2,a.z=0,d.copy(a);var V=this.matrixWorld;v.multiplyMatrices(A.matrixWorldInverse,V);for(var z=0,H=L.count;z<H;z++)if(s.fromBufferAttribute(L,z),e.fromBufferAttribute(I,z),s.w=1,e.w=1,s.applyMatrix4(v),e.applyMatrix4(v),s.applyMatrix4(E),e.applyMatrix4(E),s.multiplyScalar(1/s.w),e.multiplyScalar(1/e.w),!(s.z<-1&&e.z<-1||s.z>1&&e.z>1)){s.x*=D.x/2,s.y*=D.y/2,e.x*=D.x/2,e.y*=D.y/2,g.start.copy(s),g.start.z=0,g.end.copy(e),g.end.z=0;var j=g.closestPointToPointParameter(d,!0);g.at(j,C);var te=MathUtils.lerp(s.z,e.z,j),J=te>=-1&&te<=1,k=d.distanceTo(C)<.5*F;if(J&&k){g.start.fromBufferAttribute(L,z),g.end.fromBufferAttribute(I,z),g.start.applyMatrix4(V),g.end.applyMatrix4(V);var U=new Vector3,K=new Vector3;b.distanceSqToSegment(g.start,g.end,K,U),x.push({point:K,pointOnLine:U,distance:b.origin.distanceTo(K),object:this,face:null,faceIndex:z,uv:null,uv2:null})}}}}()});var LineGeometry=function(){LineSegmentsGeometry.call(this),this.type="LineGeometry"};LineGeometry.prototype=Object.assign(Object.create(LineSegmentsGeometry.prototype),{constructor:LineGeometry,isLineGeometry:!0,setPositions:function(e){for(var a=e.length-3,d=new Float32Array(2*a),v=0;v<a;v+=3)d[2*v]=e[v],d[2*v+1]=e[v+1],d[2*v+2]=e[v+2],d[2*v+3]=e[v+3],d[2*v+4]=e[v+4],d[2*v+5]=e[v+5];return LineSegmentsGeometry.prototype.setPositions.call(this,d),this},setColors:function(e){for(var a=e.length-3,d=new Float32Array(2*a),v=0;v<a;v+=3)d[2*v]=e[v],d[2*v+1]=e[v+1],d[2*v+2]=e[v+2],d[2*v+3]=e[v+3],d[2*v+4]=e[v+4],d[2*v+5]=e[v+5];return LineSegmentsGeometry.prototype.setColors.call(this,d),this},fromLine:function(e){var a=e.geometry;return a.isGeometry?this.setPositions(a.vertices):a.isBufferGeometry&&this.setPositions(a.position.array),this},copy:function(){return this}});var Line2=function(e,a){LineSegments2.call(this),this.type="Line2",this.geometry=void 0!==e?e:new LineGeometry,this.material=void 0!==a?a:new LineMaterial({color:16777215*Math.random()})};Line2.prototype=Object.assign(Object.create(LineSegments2.prototype),{constructor:Line2,isLine2:!0});var Wireframe=function(e,a){Mesh.call(this),this.type="Wireframe",this.geometry=void 0!==e?e:new LineSegmentsGeometry,this.material=void 0!==a?a:new LineMaterial({color:16777215*Math.random()})};Wireframe.prototype=Object.assign(Object.create(Mesh.prototype),{constructor:Wireframe,isWireframe:!0,computeLineDistances:function(){var s=new Vector3,e=new Vector3;return function(){for(var d=this.geometry,v=d.attributes.instanceStart,g=d.attributes.instanceEnd,C=new Float32Array(2*v.data.count),w=0,_=0,x=v.data.count;w<x;w++,_+=2)s.fromBufferAttribute(v,w),e.fromBufferAttribute(g,w),C[_]=0===_?0:C[_-1],C[_+1]=C[_]+s.distanceTo(e);var b=new InstancedInterleavedBuffer(C,2,1);return d.setAttribute("instanceDistanceStart",new InterleavedBufferAttribute(b,1,0)),d.setAttribute("instanceDistanceEnd",new InterleavedBufferAttribute(b,1,1)),this}}()});var WireframeGeometry2=function(e){LineSegmentsGeometry.call(this),this.type="WireframeGeometry2",this.fromWireframeGeometry(new WireframeGeometry(e))};WireframeGeometry2.prototype=Object.assign(Object.create(LineSegmentsGeometry.prototype),{constructor:WireframeGeometry2,isWireframeGeometry2:!0});var Cache={enabled:!1,files:{},add:function(e,a){!1!==this.enabled&&(this.files[e]=a)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function LoadingManager(s,e,a){var d=this,v=!1,g=0,C=0,w=void 0,_=[];this.onStart=void 0,this.onLoad=s,this.onProgress=e,this.onError=a,this.itemStart=function(x){C++,!1===v&&void 0!==d.onStart&&d.onStart(x,g,C),v=!0},this.itemEnd=function(x){g++,void 0!==d.onProgress&&d.onProgress(x,g,C),g===C&&(v=!1,void 0!==d.onLoad&&d.onLoad())},this.itemError=function(x){void 0!==d.onError&&d.onError(x)},this.resolveURL=function(x){return w?w(x):x},this.setURLModifier=function(x){return w=x,this},this.addHandler=function(x,b){return _.push(x,b),this},this.removeHandler=function(x){var b=_.indexOf(x);return-1!==b&&_.splice(b,2),this},this.getHandler=function(x){for(var b=0,A=_.length;b<A;b+=2){var E=_[b],R=_[b+1];if(E.global&&(E.lastIndex=0),E.test(x))return R}return null}}var DefaultLoadingManager=new LoadingManager;function Loader(s){this.manager=void 0!==s?s:DefaultLoadingManager,this.crossOrigin="anonymous",this.path="",this.resourcePath=""}Object.assign(Loader.prototype,{load:function(){},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this}});var loading={};function FileLoader(s){Loader.call(this,s)}function Group(){Object3D.call(this),this.type="Group"}FileLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:FileLoader,load:function(e,a,d,v){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var g=this,C=Cache.get(e);if(void 0!==C)return g.manager.itemStart(e),setTimeout(function(){a&&a(C),g.manager.itemEnd(e)},0),C;if(void 0===loading[e]){var _=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(_){var x=_[1],b=!!_[2],A=_[3];A=decodeURIComponent(A),b&&(A=atob(A));try{var E,R=(this.responseType||"").toLowerCase();switch(R){case"arraybuffer":case"blob":for(var O=new Uint8Array(A.length),D=0;D<A.length;D++)O[D]=A.charCodeAt(D);E="blob"===R?new Blob([O.buffer],{type:x}):O.buffer;break;case"document":var F=new DOMParser;E=F.parseFromString(A,x);break;case"json":E=JSON.parse(A);break;default:E=A}setTimeout(function(){a&&a(E),g.manager.itemEnd(e)},0)}catch(V){setTimeout(function(){v&&v(V),g.manager.itemError(e),g.manager.itemEnd(e)},0)}}else{loading[e]=[],loading[e].push({onLoad:a,onProgress:d,onError:v});var L=new XMLHttpRequest;for(var I in L.open("GET",e,!0),L.addEventListener("load",function(V){var z=this.response,H=loading[e];if(delete loading[e],200===this.status||0===this.status){0===this.status&&console.warn("FileLoader: HTTP Status 0 received."),Cache.add(e,z);for(var X=0,re=H.length;X<re;X++)(j=H[X]).onLoad&&j.onLoad(z);g.manager.itemEnd(e)}else{for(X=0,re=H.length;X<re;X++){var j;(j=H[X]).onError&&j.onError(V)}g.manager.itemError(e),g.manager.itemEnd(e)}},!1),L.addEventListener("progress",function(V){for(var z=loading[e],H=0,X=z.length;H<X;H++){var re=z[H];re.onProgress&&re.onProgress(V)}},!1),L.addEventListener("error",function(V){var z=loading[e];delete loading[e];for(var H=0,X=z.length;H<X;H++){var re=z[H];re.onError&&re.onError(V)}g.manager.itemError(e),g.manager.itemEnd(e)},!1),L.addEventListener("abort",function(V){var z=loading[e];delete loading[e];for(var H=0,X=z.length;H<X;H++){var re=z[H];re.onError&&re.onError(V)}g.manager.itemError(e),g.manager.itemEnd(e)},!1),void 0!==this.responseType&&(L.responseType=this.responseType),void 0!==this.withCredentials&&(L.withCredentials=this.withCredentials),L.overrideMimeType&&L.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)L.setRequestHeader(I,this.requestHeader[I]);L.send(null)}return g.manager.itemStart(e),L}loading[e].push({onLoad:a,onProgress:d,onError:v})},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}}),Group.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Group,isGroup:!0});var LoaderUtils={decodeText:function(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var a="",d=0,v=e.length;d<v;d++)a+=String.fromCharCode(e[d]);try{return decodeURIComponent(escape(a))}catch(g){return a}},extractUrlBase:function(e){var a=e.lastIndexOf("/");return-1===a?"./":e.substr(0,a+1)}};function MeshPhongMaterial(s){Material.call(this),this.type="MeshPhongMaterial",this.color=new Color(16777215),this.specular=new Color(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=MultiplyOperation,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(s)}function MeshStandardMaterial(s){Material.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Color(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(s)}function ImageLoader(s){Loader.call(this,s)}function TextureLoader(s){Loader.call(this,s)}MeshPhongMaterial.prototype=Object.create(Material.prototype),MeshPhongMaterial.prototype.constructor=MeshPhongMaterial,MeshPhongMaterial.prototype.isMeshPhongMaterial=!0,MeshPhongMaterial.prototype.copy=function(s){return Material.prototype.copy.call(this,s),this.color.copy(s.color),this.specular.copy(s.specular),this.shininess=s.shininess,this.map=s.map,this.lightMap=s.lightMap,this.lightMapIntensity=s.lightMapIntensity,this.aoMap=s.aoMap,this.aoMapIntensity=s.aoMapIntensity,this.emissive.copy(s.emissive),this.emissiveMap=s.emissiveMap,this.emissiveIntensity=s.emissiveIntensity,this.bumpMap=s.bumpMap,this.bumpScale=s.bumpScale,this.normalMap=s.normalMap,this.normalMapType=s.normalMapType,this.normalScale.copy(s.normalScale),this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this.specularMap=s.specularMap,this.alphaMap=s.alphaMap,this.envMap=s.envMap,this.combine=s.combine,this.reflectivity=s.reflectivity,this.refractionRatio=s.refractionRatio,this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this.wireframeLinecap=s.wireframeLinecap,this.wireframeLinejoin=s.wireframeLinejoin,this.skinning=s.skinning,this.morphTargets=s.morphTargets,this.morphNormals=s.morphNormals,this},MeshStandardMaterial.prototype=Object.create(Material.prototype),MeshStandardMaterial.prototype.constructor=MeshStandardMaterial,MeshStandardMaterial.prototype.isMeshStandardMaterial=!0,MeshStandardMaterial.prototype.copy=function(s){return Material.prototype.copy.call(this,s),this.defines={STANDARD:""},this.color.copy(s.color),this.roughness=s.roughness,this.metalness=s.metalness,this.map=s.map,this.lightMap=s.lightMap,this.lightMapIntensity=s.lightMapIntensity,this.aoMap=s.aoMap,this.aoMapIntensity=s.aoMapIntensity,this.emissive.copy(s.emissive),this.emissiveMap=s.emissiveMap,this.emissiveIntensity=s.emissiveIntensity,this.bumpMap=s.bumpMap,this.bumpScale=s.bumpScale,this.normalMap=s.normalMap,this.normalMapType=s.normalMapType,this.normalScale.copy(s.normalScale),this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this.roughnessMap=s.roughnessMap,this.metalnessMap=s.metalnessMap,this.alphaMap=s.alphaMap,this.envMap=s.envMap,this.envMapIntensity=s.envMapIntensity,this.refractionRatio=s.refractionRatio,this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this.wireframeLinecap=s.wireframeLinecap,this.wireframeLinejoin=s.wireframeLinejoin,this.skinning=s.skinning,this.morphTargets=s.morphTargets,this.morphNormals=s.morphNormals,this},ImageLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:ImageLoader,load:function(e,a,d,v){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var g=this,C=Cache.get(e);if(void 0!==C)return g.manager.itemStart(e),setTimeout(function(){a&&a(C),g.manager.itemEnd(e)},0),C;var w=document.createElementNS("http://www.w3.org/1999/xhtml","img");function _(){w.removeEventListener("load",_,!1),w.removeEventListener("error",x,!1),Cache.add(e,this),a&&a(this),g.manager.itemEnd(e)}function x(b){w.removeEventListener("load",_,!1),w.removeEventListener("error",x,!1),v&&v(b),g.manager.itemError(e),g.manager.itemEnd(e)}return w.addEventListener("load",_,!1),w.addEventListener("error",x,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(w.crossOrigin=this.crossOrigin),g.manager.itemStart(e),w.src=e,w}}),TextureLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:TextureLoader,load:function(e,a,d,v){var g=new Texture,C=new ImageLoader(this.manager);return C.setCrossOrigin(this.crossOrigin),C.setPath(this.path),C.load(e,function(w){g.image=w;var _=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);g.format=_?RGBFormat:RGBAFormat,g.needsUpdate=!0,void 0!==a&&a(g)},d,v),g}});var ThreeMFLoader=function(e){Loader.call(this,e),this.availableExtensions=[]};ThreeMFLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:ThreeMFLoader,load:function(e,a,d,v){var g=this,C=new FileLoader(g.manager);C.setPath(g.path),C.setResponseType("arraybuffer"),C.load(e,function(w){a(g.parse(w))},d,v)},parse:function(e){var a=this,d=new TextureLoader(this.manager);function g(Z){for(var se=[],le=(new DOMParser).parseFromString(Z,"application/xml").querySelectorAll("Relationship"),_e=0;_e<le.length;_e++){var ae=le[_e],pe={target:ae.getAttribute("Target"),id:ae.getAttribute("Id"),type:ae.getAttribute("Type")};se.push(pe)}return se}function w(Z){for(var se={id:Z.getAttribute("id"),basematerials:[]},ve=Z.querySelectorAll("base"),le=0;le<ve.length;le++){var ae=E(ve[le]);ae.index=le,se.basematerials.push(ae)}return se}function _(Z){return{id:Z.getAttribute("id"),path:Z.getAttribute("path"),contenttype:Z.getAttribute("contenttype"),tilestyleu:Z.getAttribute("tilestyleu"),tilestylev:Z.getAttribute("tilestylev"),filter:Z.getAttribute("filter")}}function x(Z){for(var se={id:Z.getAttribute("id"),texid:Z.getAttribute("texid"),displaypropertiesid:Z.getAttribute("displaypropertiesid")},ve=Z.querySelectorAll("tex2coord"),le=[],_e=0;_e<ve.length;_e++){var ae=ve[_e],pe=ae.getAttribute("u"),he=ae.getAttribute("v");le.push(parseFloat(pe),parseFloat(he))}return se.uvs=new Float32Array(le),se}function b(Z){for(var se={id:Z.getAttribute("id"),displaypropertiesid:Z.getAttribute("displaypropertiesid")},ve=Z.querySelectorAll("color"),le=[],_e=new Color,ae=0;ae<ve.length;ae++){var he=ve[ae].getAttribute("color");_e.setStyle(he.substring(0,7)),_e.convertSRGBToLinear(),le.push(_e.r,_e.g,_e.b)}return se.colors=new Float32Array(le),se}function A(Z){for(var se={id:Z.getAttribute("id")},ve=Z.querySelectorAll("pbmetallic"),le=[],_e=0;_e<ve.length;_e++){var ae=ve[_e];le.push({name:ae.getAttribute("name"),metallicness:parseFloat(ae.getAttribute("metallicness")),roughness:parseFloat(ae.getAttribute("roughness"))})}return se.data=le,se}function E(Z){var se={};return se.name=Z.getAttribute("name"),se.displaycolor=Z.getAttribute("displaycolor"),se.displaypropertiesid=Z.getAttribute("displaypropertiesid"),se}function D(Z){var se={};se.objectId=Z.getAttribute("objectid");var ve=Z.getAttribute("transform");return ve&&(se.transform=F(ve)),se}function F(Z){var se=[];Z.split(" ").forEach(function(le){se.push(parseFloat(le))});var ve=new Matrix4;return ve.set(se[0],se[3],se[6],se[9],se[1],se[4],se[7],se[10],se[2],se[5],se[8],se[11],0,0,0,1),ve}function L(Z){var se={type:Z.getAttribute("type")},ve=Z.getAttribute("id");ve&&(se.id=ve);var le=Z.getAttribute("pid");le&&(se.pid=le);var _e=Z.getAttribute("pindex");_e&&(se.pindex=_e);var ae=Z.getAttribute("thumbnail");ae&&(se.thumbnail=ae);var pe=Z.getAttribute("partnumber");pe&&(se.partnumber=pe);var he=Z.getAttribute("name");he&&(se.name=he);var ce=Z.querySelector("mesh");ce&&(se.mesh=function(Z){for(var se={},ve=[],le=Z.querySelectorAll("vertices vertex"),_e=0;_e<le.length;_e++){var ae=le[_e],pe=ae.getAttribute("x"),he=ae.getAttribute("y"),ce=ae.getAttribute("z");ve.push(parseFloat(pe),parseFloat(he),parseFloat(ce))}se.vertices=new Float32Array(ve);var Te=[],be=[],xe=Z.querySelectorAll("triangles triangle");for(_e=0;_e<xe.length;_e++){var we=xe[_e],Ne=we.getAttribute("v1"),Re=we.getAttribute("v2"),De=we.getAttribute("v3"),Je=we.getAttribute("p1"),$e=we.getAttribute("p2"),pt=we.getAttribute("p3"),ut=we.getAttribute("pid"),at={};at.v1=parseInt(Ne,10),at.v2=parseInt(Re,10),at.v3=parseInt(De,10),be.push(at.v1,at.v2,at.v3),Je&&(at.p1=parseInt(Je,10)),$e&&(at.p2=parseInt($e,10)),pt&&(at.p3=parseInt(pt,10)),ut&&(at.pid=ut),0<Object.keys(at).length&&Te.push(at)}return se.triangleProperties=Te,se.triangles=new Uint32Array(be),se}(ce));var Te=Z.querySelector("components");return Te&&(se.components=function(Z){for(var se=[],ve=Z.querySelectorAll("component"),le=0;le<ve.length;le++){var ae=D(ve[le]);se.push(ae)}return se}(Te)),se}function z(Z){var se={unit:Z.getAttribute("unit")||"millimeter"},ve=Z.querySelectorAll("metadata");ve&&(se.metadata=function(Z){for(var se={},ve=0;ve<Z.length;ve++){var le=Z[ve],_e=le.getAttribute("name");0<=["Title","Designer","Description","Copyright","LicenseTerms","Rating","CreationDate","ModificationDate"].indexOf(_e)&&(se[_e]=le.textContent)}return se}(ve));var le=Z.querySelector("resources");le&&(se.resources=function(Z){for(var se={basematerials:{}},ve=Z.querySelectorAll("basematerials"),le=0;le<ve.length;le++){var ae=w(ve[le]);se.basematerials[ae.id]=ae}se.texture2d={};var pe=Z.querySelectorAll("texture2d");for(le=0;le<pe.length;le++){var ce=_(pe[le]);se.texture2d[ce.id]=ce}se.colorgroup={};var Te=Z.querySelectorAll("colorgroup");for(le=0;le<Te.length;le++){var xe=b(Te[le]);se.colorgroup[xe.id]=xe}se.pbmetallicdisplayproperties={};var we=Z.querySelectorAll("pbmetallicdisplayproperties");for(le=0;le<we.length;le++){var Re=A(we[le]);se.pbmetallicdisplayproperties[Re.id]=Re}se.texture2dgroup={};var De=Z.querySelectorAll("texture2dgroup");for(le=0;le<De.length;le++){var $e=x(De[le]);se.texture2dgroup[$e.id]=$e}se.object={};var pt=Z.querySelectorAll("object");for(le=0;le<pt.length;le++){var at=L(pt[le]);se.object[at.id]=at}return se}(le));var _e=Z.querySelector("build");return _e&&(se.build=function(Z){for(var se=[],ve=Z.querySelectorAll("item"),le=0;le<ve.length;le++){var _e=ve[le],ae={objectId:_e.getAttribute("objectid")},pe=_e.getAttribute("transform");pe&&(ae.transform=F(pe)),se.push(ae)}return se}(_e)),se}function H(Z,se,ve,le){var pe=ve.resources.texture2d[Z.texid];if(pe){var Te=new Blob([le[pe.path]],{type:pe.contenttype}),be=URL.createObjectURL(Te),xe=d.load(be,function(){URL.revokeObjectURL(be)});switch(xe.encoding=sRGBEncoding,pe.tilestyleu){case"wrap":default:xe.wrapS=RepeatWrapping;break;case"mirror":xe.wrapS=MirroredRepeatWrapping;break;case"none":case"clamp":xe.wrapS=ClampToEdgeWrapping}switch(pe.tilestylev){case"wrap":default:xe.wrapT=RepeatWrapping;break;case"mirror":xe.wrapT=MirroredRepeatWrapping;break;case"none":case"clamp":xe.wrapT=ClampToEdgeWrapping}switch(pe.filter){case"auto":default:xe.magFilter=LinearFilter,xe.minFilter=LinearMipmapLinearFilter;break;case"linear":xe.magFilter=LinearFilter,xe.minFilter=LinearFilter;break;case"nearest":xe.magFilter=NearestFilter,xe.minFilter=NearestFilter}return xe}return null}function X(Z,se,ve,le,_e,ae){for(var pe=ae.pindex,he={},ce=0,Te=se.length;ce<Te;ce++){var xe=void 0!==(be=se[ce]).p1?be.p1:pe;void 0===he[xe]&&(he[xe]=[]),he[xe].push(be)}var we=Object.keys(he),Ne=[];for(ce=0,Te=we.length;ce<Te;ce++){for(var Re=we[ce],De=he[Re],$e=Q(Z.basematerials[Re],Y,ve,_e,ae,oe),pt=new BufferGeometry,ut=[],at=le.vertices,Xe=0,Ke=De.length;Xe<Ke;Xe++){var be;ut.push(at[3*(be=De[Xe]).v1+0]),ut.push(at[3*be.v1+1]),ut.push(at[3*be.v1+2]),ut.push(at[3*be.v2+0]),ut.push(at[3*be.v2+1]),ut.push(at[3*be.v2+2]),ut.push(at[3*be.v3+0]),ut.push(at[3*be.v3+1]),ut.push(at[3*be.v3+2])}pt.setAttribute("position",new Float32BufferAttribute(ut,3));var lt=new Mesh(pt,$e);Ne.push(lt)}return Ne}function re(Z,se,ve,le,_e,ae){for(var pe=new BufferGeometry,he=[],ce=[],Te=le.vertices,be=Z.uvs,xe=0,we=se.length;xe<we;xe++){var Ne=se[xe];he.push(Te[3*Ne.v1+0]),he.push(Te[3*Ne.v1+1]),he.push(Te[3*Ne.v1+2]),he.push(Te[3*Ne.v2+0]),he.push(Te[3*Ne.v2+1]),he.push(Te[3*Ne.v2+2]),he.push(Te[3*Ne.v3+0]),he.push(Te[3*Ne.v3+1]),he.push(Te[3*Ne.v3+2]),ce.push(be[2*Ne.p1+0]),ce.push(be[2*Ne.p1+1]),ce.push(be[2*Ne.p2+0]),ce.push(be[2*Ne.p2+1]),ce.push(be[2*Ne.p3+0]),ce.push(be[2*Ne.p3+1])}return pe.setAttribute("position",new Float32BufferAttribute(he,3)),pe.setAttribute("uv",new Float32BufferAttribute(ce,2)),new Mesh(pe,new MeshPhongMaterial({map:Q(Z,Y,ve,_e,ae,H),flatShading:!0}))}function j(Z,se,ve,le){for(var _e=new BufferGeometry,ae=[],pe=[],he=le.vertices,ce=Z.colors,Te=0,be=se.length;Te<be;Te++){var xe=se[Te],we=xe.v1,Ne=xe.v2,Re=xe.v3;ae.push(he[3*we+0]),ae.push(he[3*we+1]),ae.push(he[3*we+2]),ae.push(he[3*Ne+0]),ae.push(he[3*Ne+1]),ae.push(he[3*Ne+2]),ae.push(he[3*Re+0]),ae.push(he[3*Re+1]),ae.push(he[3*Re+2]);var De=xe.p1,Je=xe.p2,$e=xe.p3;pe.push(ce[3*De+0]),pe.push(ce[3*De+1]),pe.push(ce[3*De+2]),pe.push(ce[3*(Je||De)+0]),pe.push(ce[3*(Je||De)+1]),pe.push(ce[3*(Je||De)+2]),pe.push(ce[3*($e||De)+0]),pe.push(ce[3*($e||De)+1]),pe.push(ce[3*($e||De)+2])}return _e.setAttribute("position",new Float32BufferAttribute(ae,3)),_e.setAttribute("color",new Float32BufferAttribute(pe,3)),new Mesh(_e,new MeshPhongMaterial({vertexColors:VertexColors,flatShading:!0}))}function te(Z){var se=new BufferGeometry;return se.setIndex(new BufferAttribute(Z.triangles,1)),se.setAttribute("position",new BufferAttribute(Z.vertices,3)),new Mesh(se,new MeshPhongMaterial({color:11184895,flatShading:!0}))}function k(Z,se){return void 0!==se.resources.texture2dgroup[Z]?"texture":void 0!==se.resources.basematerials[Z]?"material":void 0!==se.resources.colorgroup[Z]?"vertexColors":"default"===Z?"default":void 0}function K(Z,se,ve,le,_e){for(var ae=new Group,pe=function(Z,se,ve){for(var le={},_e=se.triangleProperties,ae=ve.pid,pe=0,he=_e.length;pe<he;pe++){var ce=_e[pe],Te=void 0!==ce.pid?ce.pid:ae;void 0===Te&&(Te="default"),void 0===le[Te]&&(le[Te]=[]),le[Te].push(ce)}return le}(0,Z,_e),he=function(Z,se,ve,le,_e){for(var ae=Object.keys(Z),pe=[],he=0,ce=ae.length;he<ce;he++){var Te=ae[he],be=Z[Te];switch(k(Te,se)){case"material":for(var Ne=X(se.resources.basematerials[Te],be,se,ve,le,_e),Re=0,De=Ne.length;Re<De;Re++)pe.push(Ne[Re]);break;case"texture":pe.push(re(se.resources.texture2dgroup[Te],be,se,ve,le,_e));break;case"vertexColors":pe.push(j(se.resources.colorgroup[Te],be,0,ve));break;case"default":pe.push(te(ve));break;default:console.error("3MFLoader: Unsupported resource type.")}}return pe}(pe,ve,Z,le,_e),ce=0,Te=he.length;ce<Te;ce++)ae.add(he[ce]);return ae}function Q(Z,se,ve,le,_e,ae){return void 0!==Z.build||(Z.build=ae(Z,se,ve,le,_e)),Z.build}function oe(Z,se,ve){var le,_e=Z.displaypropertiesid,ae=ve.resources.pbmetallicdisplayproperties;if(null!==_e&&void 0!==ae[_e]){var he=ae[_e].data[Z.index];le=new MeshStandardMaterial({flatShading:!0,roughness:he.roughness,metalness:he.metallicness})}else le=new MeshPhongMaterial({flatShading:!0});le.name=Z.name;var ce=Z.displaycolor,Te=ce.substring(0,7);return le.color.setStyle(Te),le.color.convertSRGBToLinear(),9===ce.length&&(le.opacity=parseInt(ce.charAt(7)+ce.charAt(8),16)/255),le}function me(Z,se,ve,le){for(var _e=new Group,ae=0;ae<Z.length;ae++){var pe=Z[ae],he=se[pe.objectId];void 0===he&&(fe(pe.objectId,se,ve,le),he=se[pe.objectId]);var ce=he.clone(),Te=pe.transform;Te&&ce.applyMatrix4(Te),_e.add(ce)}return _e}function fe(Z,se,ve,le){var _e=ve.resources.object[Z];if(_e.mesh){var ae=_e.mesh;(function(Z,se,ve){if(Z){for(var le=[],_e=Object.keys(Z),ae=0;ae<_e.length;ae++)for(var pe=_e[ae],he=0;he<a.availableExtensions.length;he++)(ce=a.availableExtensions[he]).ns===pe&&le.push(ce);for(ae=0;ae<le.length;ae++){var ce;(ce=le[ae]).apply(ve,Z[ce.ns],se)}}})(ve.extensions,ae,ve.xml),se[_e.id]=Q(ae,se,ve,le,_e,K)}else se[_e.id]=Q(_e.components,se,ve,le,_e,me)}var ue=function(Z){var le,_e,he,ce,se=null,ve=null,ae=[],pe=[],Te={},xe={};try{se=new JSZip(Z)}catch(St){if(St instanceof ReferenceError)return console.error("3MFLoader: jszip missing and file is compressed."),null}for(ve in se.files)ve.match(/\_rels\/.rels$/)?le=ve:ve.match(/3D\/_rels\/.*\.model\.rels$/)?_e=ve:ve.match(/^3D\/.*\.model$/)?ae.push(ve):ve.match(/^3D\/Metadata\/.*\.xml$/)||(ve.match(/^3D\/Textures?\/.*/)?pe.push(ve):ve.match(/^3D\/Other\/.*/));var Ne=new Uint8Array(se.file(le).asArrayBuffer());he=g(LoaderUtils.decodeText(Ne)),_e&&(Ne=new Uint8Array(se.file(_e).asArrayBuffer()),ce=g(LoaderUtils.decodeText(Ne)));for(var De=0;De<ae.length;De++){var Je=ae[De],$e=new Uint8Array(se.file(Je).asArrayBuffer()),pt=LoaderUtils.decodeText($e),ut=(new DOMParser).parseFromString(pt,"application/xml");"model"!==ut.documentElement.nodeName.toLowerCase()&&console.error("3MFLoader: Error loading 3MF - no 3MF document found: ",Je);var at=ut.querySelector("model"),Xe={};for(De=0;De<at.attributes.length;De++){var Ke=at.attributes[De];Ke.name.match(/^xmlns:(.+)$/)&&(Xe[Ke.value]=RegExp.$1)}var lt=z(at);lt.xml=at,0<Object.keys(Xe).length&&(lt.extensions=Xe),Te[Je]=lt}for(De=0;De<pe.length;De++){var ot=pe[De];xe[ot]=se.file(ot).asArrayBuffer()}return{rels:he,modelRels:ce,model:Te,printTicket:{},texture:xe,other:{}}}(e),Y=function(Z){var se=Z.model,ve=Z.modelRels,le={},_e=Object.keys(se),ae={};if(ve)for(var pe=0,he=ve.length;pe<he;pe++){var ce=ve[pe],Te=ce.target.substring(1);Z.texture[Te]&&(ae[ce.target]=Z.texture[Te])}for(pe=0;pe<_e.length;pe++)for(var xe=se[_e[pe]],we=Object.keys(xe.resources.object),Ne=0;Ne<we.length;Ne++)fe(we[Ne],le,xe,ae);return le}(ue);return function(Z,se){for(var ve=new Group,_e=se.model[se.rels[0].target.substring(1)].build,ae=0;ae<_e.length;ae++){var pe=_e[ae],he=Z[pe.objectId],ce=pe.transform;ce&&he.applyMatrix4(ce),ve.add(he)}return ve}(Y,ue)},addExtension:function(e){this.availableExtensions.push(e)}});var AMFLoader=function(e){Loader.call(this,e)};AMFLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:AMFLoader,load:function(e,a,d,v){var g=this,C=new FileLoader(g.manager);C.setPath(g.path),C.setResponseType("arraybuffer"),C.load(e,function(w){a(g.parse(w))},d,v)},parse:function(e){function v($){for(var ue="AMF Material",Y=$.attributes.id.textContent,Z={r:1,g:1,b:1,a:1},se=null,ve=0;ve<$.childNodes.length;ve++){var le=$.childNodes[ve];"metadata"===le.nodeName&&void 0!==le.attributes.type?"name"===le.attributes.type.value&&(ue=le.textContent):"color"===le.nodeName&&(Z=g(le))}return se=new MeshPhongMaterial({flatShading:!0,color:new Color(Z.r,Z.g,Z.b),name:ue}),1!==Z.a&&(se.transparent=!0,se.opacity=Z.a),{id:Y,material:se}}function g($){for(var ue={r:1,g:1,b:1,a:1},Y=0;Y<$.childNodes.length;Y++){var Z=$.childNodes[Y];"r"===Z.nodeName?ue.r=Z.textContent:"g"===Z.nodeName?ue.g=Z.textContent:"b"===Z.nodeName?ue.b=Z.textContent:"a"===Z.nodeName&&(ue.a=Z.textContent)}return ue}function C($){var ue={name:"",triangles:[],materialid:null},Y=$.firstElementChild;for(void 0!==$.attributes.materialid&&(ue.materialId=$.attributes.materialid.nodeValue);Y;){if("metadata"===Y.nodeName)void 0!==Y.attributes.type&&"name"===Y.attributes.type.value&&(ue.name=Y.textContent);else if("triangle"===Y.nodeName){var Z=Y.getElementsByTagName("v1")[0].textContent,se=Y.getElementsByTagName("v2")[0].textContent,ve=Y.getElementsByTagName("v3")[0].textContent;ue.triangles.push(Z,se,ve)}Y=Y.nextElementSibling}return ue}function w($){for(var ue=[],Y=[],Z=$.firstElementChild;Z;){if("vertex"===Z.nodeName)for(var se=Z.firstElementChild;se;){if("coordinates"===se.nodeName){var ve=se.getElementsByTagName("x")[0].textContent,le=se.getElementsByTagName("y")[0].textContent,_e=se.getElementsByTagName("z")[0].textContent;ue.push(ve,le,_e)}else if("normal"===se.nodeName){var ae=se.getElementsByTagName("nx")[0].textContent,pe=se.getElementsByTagName("ny")[0].textContent,he=se.getElementsByTagName("nz")[0].textContent;Y.push(ae,pe,he)}se=se.nextElementSibling}Z=Z.nextElementSibling}return{vertices:ue,normals:Y}}function _($){for(var ue=$.attributes.id.textContent,Y={name:"amfobject",meshes:[]},Z=null,se=$.firstElementChild;se;){if("metadata"===se.nodeName)void 0!==se.attributes.type&&"name"===se.attributes.type.value&&(Y.name=se.textContent);else if("color"===se.nodeName)Z=g(se);else if("mesh"===se.nodeName){for(var ve=se.firstElementChild,le={vertices:[],normals:[],volumes:[],color:Z};ve;){if("vertices"===ve.nodeName){var _e=w(ve);le.normals=le.normals.concat(_e.normals),le.vertices=le.vertices.concat(_e.vertices)}else"volume"===ve.nodeName&&le.volumes.push(C(ve));ve=ve.nextElementSibling}Y.meshes.push(le)}se=se.nextElementSibling}return{id:ue,obj:Y}}var F,L,x=function($){var ue=new DataView($);if("PK"===String.fromCharCode(ue.getUint8(0),ue.getUint8(1))){var Z=null,se=null;console.log("AMFLoader: Loading Zip");try{Z=new JSZip($)}catch(_e){if(_e instanceof ReferenceError)return console.log("AMFLoader: jszip missing and file is compressed."),null}for(se in Z.files)if(".amf"===se.toLowerCase().substr(-4))break;console.log("AMFLoader: Trying to load file asset: "+se),ue=new DataView(Z.file(se).asArrayBuffer())}var ve=LoaderUtils.decodeText(ue),le=(new DOMParser).parseFromString(ve,"application/xml");return"amf"!==le.documentElement.nodeName.toLowerCase()?(console.log("AMFLoader: Error loading AMF - no AMF document found."),null):le}(e),b="",A="",E=function($){var ue=1,Y="millimeter";void 0!==$.documentElement.attributes.unit&&(Y=$.documentElement.attributes.unit.value.toLowerCase());var Z={millimeter:1,inch:25.4,feet:304.8,meter:1e3,micron:.001};return void 0!==Z[Y]&&(ue=Z[Y]),console.log("AMFLoader: Unit scale: "+ue),ue}(x),R={},O={},D=x.documentElement.childNodes;for(F=0;F<D.length;F++){var I=D[F];if("metadata"===I.nodeName)void 0!==I.attributes.type&&("name"===I.attributes.type.value?b=I.textContent:"author"===I.attributes.type.value&&(A=I.textContent));else if("material"===I.nodeName){var V=v(I);R[V.id]=V.material}else if("object"===I.nodeName){var z=_(I);O[z.id]=z.obj}}var H=new Group,X=new MeshPhongMaterial({color:11184895,flatShading:!0});for(var re in H.name=b,H.userData.author=A,H.userData.loader="AMF",O){var j=O[re],te=j.meshes,J=new Group;for(J.name=j.name||"",F=0;F<te.length;F++){var k=X,U=te[F],K=new Float32BufferAttribute(U.vertices,3),ee=null;if(U.normals.length&&(ee=new Float32BufferAttribute(U.normals,3)),U.color){var Q=U.color;(k=X.clone()).color=new Color(Q.r,Q.g,Q.b),1!==Q.a&&(k.transparent=!0,k.opacity=Q.a)}var oe=U.volumes;for(L=0;L<oe.length;L++){var me=oe[L],fe=new BufferGeometry,ge=k;fe.setIndex(me.triangles),fe.setAttribute("position",K.clone()),ee&&fe.setAttribute("normal",ee.clone()),void 0!==R[me.materialId]&&(ge=R[me.materialId]),fe.scale(E,E,E),J.add(new Mesh(fe,ge.clone()))}}H.add(J)}return H}});var _offsetMatrix=new Matrix4,_identityMatrix=new Matrix4;function Skeleton(s,e){if(this.bones=(s=s||[]).slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var a=0,d=this.bones.length;a<d;a++)this.boneInverses.push(new Matrix4)}}function SkinnedMesh(s,e){s&&s.isGeometry&&console.error("SkinnedMesh no longer supports Geometry. Use BufferGeometry instead."),Mesh.call(this,s,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Matrix4,this.bindMatrixInverse=new Matrix4}Object.assign(Skeleton.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,a=this.bones.length;e<a;e++){var d=new Matrix4;this.bones[e]&&d.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(d)}},pose:function(){var e,a,d;for(a=0,d=this.bones.length;a<d;a++)(e=this.bones[a])&&e.matrixWorld.getInverse(this.boneInverses[a]);for(a=0,d=this.bones.length;a<d;a++)(e=this.bones[a])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:function(){for(var e=this.bones,a=this.boneInverses,d=this.boneMatrices,v=this.boneTexture,g=0,C=e.length;g<C;g++)_offsetMatrix.multiplyMatrices(e[g]?e[g].matrixWorld:_identityMatrix,a[g]),_offsetMatrix.toArray(d,16*g);void 0!==v&&(v.needsUpdate=!0)},clone:function(){return new Skeleton(this.bones,this.boneInverses)},getBoneByName:function(e){for(var a=0,d=this.bones.length;a<d;a++){var v=this.bones[a];if(v.name===e)return v}}}),SkinnedMesh.prototype=Object.assign(Object.create(Mesh.prototype),{constructor:SkinnedMesh,isSkinnedMesh:!0,bind:function(e,a){this.skeleton=e,void 0===a&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),a=this.matrixWorld),this.bindMatrix.copy(a),this.bindMatrixInverse.getInverse(a)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new Vector4,a=this.geometry.attributes.skinWeight,d=0,v=a.count;d<v;d++){e.x=a.getX(d),e.y=a.getY(d),e.z=a.getZ(d),e.w=a.getW(d);var g=1/e.manhattanLength();g!==1/0?e.multiplyScalar(g):e.set(1,0,0,0),a.setXYZW(d,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){Mesh.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var AssimpLoader=function(e){Loader.call(this,e)};AssimpLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:AssimpLoader,load:function(e,a,d,v){var g=this,C=""===g.path?LoaderUtils.extractUrlBase(e):g.path,w=new FileLoader(this.manager);w.setPath(g.path),w.setResponseType("arraybuffer"),w.load(e,function(_){a(g.parse(_,C))},d,v)},parse:function(e,a){var d=new TextureLoader(this.manager);d.setPath(this.resourcePath||a).setCrossOrigin(this.crossOrigin);var v={KeyFrame:function(W,ne){this.time=W,this.matrix=ne.clone(),this.position=new Vector3,this.quaternion=new Quaternion,this.scale=new Vector3(1,1,1),this.matrix.decompose(this.position,this.quaternion,this.scale),this.clone=function(){return new v.KeyFrame(this.time,this.matrix)},this.lerp=function(Ie,ze){var Dt=(ze-=this.time)/(Ie.time-this.time),xt=1-Dt,kt=this.position,ir=this.quaternion,Cr=Ie.position,Hr=Ie.quaternion;return v.KeyFrame.tempAniPos.x=kt.x*xt+Cr.x*Dt,v.KeyFrame.tempAniPos.y=kt.y*xt+Cr.y*Dt,v.KeyFrame.tempAniPos.z=kt.z*xt+Cr.z*Dt,v.KeyFrame.tempAniQuat.set(ir.x,ir.y,ir.z,ir.w),v.KeyFrame.tempAniQuat.slerp(Hr,Dt),v.KeyFrame.tempAniMatrix.compose(v.KeyFrame.tempAniPos,v.KeyFrame.tempAniQuat,v.KeyFrame.tempAniScale)}}};function ee(W){return 256<<W}function Q(W){return 65536<<W}function me(W,ne){var Ie=new Bone;for(var ze in Ie.matrix.copy(W.matrix),Ie.matrixWorld.copy(W.matrixWorld),Ie.position.copy(W.position),Ie.quaternion.copy(W.quaternion),Ie.scale.copy(W.scale),ne.nodeCount++,Ie.name="bone_"+W.name+ne.nodeCount.toString(),ne.nodeToBoneMap[W.name]||(ne.nodeToBoneMap[W.name]=[]),ne.nodeToBoneMap[W.name].push(Ie),W.children){var it=me(W.children[ze],ne);Ie.add(it)}return Ie}function fe(W,ne){for(var Ie=[],ze=0;ze<W.length;ze++)Ie.push({i:W[ze],w:ne[ze]});for(Ie.sort(function(Dt,xt){return xt.w-Dt.w});Ie.length<4;)Ie.push({i:0,w:0});Ie.length>4&&(Ie.length=4);var it=0;for(ze=0;ze<4;ze++)it+=Ie[ze].w*Ie[ze].w;for(it=Math.sqrt(it),ze=0;ze<4;ze++)Ie[ze].w=Ie[ze].w/it,W[ze]=Ie[ze].i,ne[ze]=Ie[ze].w}function ge(W,ne){if(0==W.name.indexOf("bone_"+ne))return W;for(var Ie in W.children){var ze=ge(W.children[Ie],ne);if(ze)return ze}}function $(){this.mPrimitiveTypes=0,this.mNumVertices=0,this.mNumFaces=0,this.mNumBones=0,this.mMaterialIndex=0,this.mVertices=[],this.mNormals=[],this.mTangents=[],this.mBitangents=[],this.mColors=[[]],this.mTextureCoords=[[]],this.mFaces=[],this.mBones=[],this.hookupSkeletons=function(W){if(0!=this.mBones.length){for(var ne=[],Ie=[],ze=W.findNode(this.mBones[0].mName);ze.mParent&&ze.mParent.isBone;)ze=ze.mParent;var Dt=me(ze.toTHREE(W),W);this.threeNode.add(Dt);for(var xt=0;xt<this.mBones.length;xt++)if(kt=ge(Dt,this.mBones[xt].mName))ne.push(kt),Ie.push(this.mBones[xt].mOffsetMatrix.toTHREE());else{if(!(ze=W.findNode(this.mBones[xt].mName)))return;Dt=me(ze.toTHREE(W),W),this.threeNode.add(Dt);var kt=ge(Dt,this.mBones[xt].mName);ne.push(kt),Ie.push(this.mBones[xt].mOffsetMatrix.toTHREE())}var Cr=new Skeleton(ne,Ie);this.threeNode.bind(Cr,new Matrix4),this.threeNode.material.skinning=!0}},this.toTHREE=function(W){if(this.threeNode)return this.threeNode;var Ie,Hr,ne=new BufferGeometry;if(Ie=W.mMaterials[this.mMaterialIndex]?W.mMaterials[this.mMaterialIndex].toTHREE(W):new MeshLambertMaterial,ne.setIndex(new BufferAttribute(new Uint32Array(this.mIndexArray),1)),ne.setAttribute("position",new BufferAttribute(this.mVertexBuffer,3)),this.mNormalBuffer&&this.mNormalBuffer.length>0&&ne.setAttribute("normal",new BufferAttribute(this.mNormalBuffer,3)),this.mColorBuffer&&this.mColorBuffer.length>0&&ne.setAttribute("color",new BufferAttribute(this.mColorBuffer,4)),this.mTexCoordsBuffers[0]&&this.mTexCoordsBuffers[0].length>0&&ne.setAttribute("uv",new BufferAttribute(new Float32Array(this.mTexCoordsBuffers[0]),2)),this.mTexCoordsBuffers[1]&&this.mTexCoordsBuffers[1].length>0&&ne.setAttribute("uv1",new BufferAttribute(new Float32Array(this.mTexCoordsBuffers[1]),2)),this.mTangentBuffer&&this.mTangentBuffer.length>0&&ne.setAttribute("tangents",new BufferAttribute(this.mTangentBuffer,3)),this.mBitangentBuffer&&this.mBitangentBuffer.length>0&&ne.setAttribute("bitangents",new BufferAttribute(this.mBitangentBuffer,3)),this.mBones.length>0){for(var ze=[],it=[],Dt=0;Dt<this.mBones.length;Dt++)for(var xt=0;xt<this.mBones[Dt].mWeights.length;xt++){var kt=this.mBones[Dt].mWeights[xt];kt&&(ze[kt.mVertexId]||(ze[kt.mVertexId]=[]),it[kt.mVertexId]||(it[kt.mVertexId]=[]),ze[kt.mVertexId].push(kt.mWeight),it[kt.mVertexId].push(parseInt(Dt)))}for(var Dt in it)fe(it[Dt],ze[Dt]);var ir=[],Cr=[];for(Dt=0;Dt<ze.length;Dt++)for(xt=0;xt<4;xt++)ze[Dt]&&it[Dt]?(ir.push(ze[Dt][xt]),Cr.push(it[Dt][xt])):(ir.push(0),Cr.push(0));ne.setAttribute("skinWeight",new BufferAttribute(new Float32Array(ir),4)),ne.setAttribute("skinIndex",new BufferAttribute(new Float32Array(Cr),4))}return 0==this.mBones.length&&(Hr=new Mesh(ne,Ie)),this.mBones.length>0&&(Hr=new SkinnedMesh(ne,Ie)).normalizeSkinWeights(),this.threeNode=Hr,Hr}}function ue(){this.mNumIndices=0,this.mIndices=[]}function Y(){this.x=0,this.y=0,this.z=0,this.toTHREE=function(){return new Vector3(this.x,this.y,this.z)}}function Z(){this.r=0,this.g=0,this.b=0,this.a=0,this.toTHREE=function(){return new Color(this.r,this.g,this.b)}}function se(){this.x=0,this.y=0,this.z=0,this.w=0,this.toTHREE=function(){return new Quaternion(this.x,this.y,this.z,this.w)}}function ve(){this.mVertexId=0,this.mWeight=0}function le(){this.data=[],this.toString=function(){var W="";return this.data.forEach(function(ne){W+=String.fromCharCode(ne)}),W.replace(/[^\x20-\x7E]+/g,"")}}function _e(){this.mTime=0,this.mValue=null}function ae(){this.mTime=0,this.mValue=null}function pe(){this.mName="",this.mTransformation=[],this.mNumChildren=0,this.mNumMeshes=0,this.mMeshes=[],this.mChildren=[],this.toTHREE=function(W){if(this.threeNode)return this.threeNode;var ne=new Object3D;ne.name=this.mName,ne.matrix=this.mTransformation.toTHREE();for(var Ie=0;Ie<this.mChildren.length;Ie++)ne.add(this.mChildren[Ie].toTHREE(W));for(Ie=0;Ie<this.mMeshes.length;Ie++)ne.add(W.mMeshes[this.mMeshes[Ie]].toTHREE(W));return this.threeNode=ne,ne.matrix.decompose(ne.position,ne.quaternion,ne.scale),ne}}function he(){this.mName="",this.mNumWeights=0,this.mOffsetMatrix=0}function ce(){this.mKey="",this.mSemantic=0,this.mIndex=0,this.mData=[],this.mDataLength=0,this.mType=0,this.dataAsColor=function(){var W=new Uint8Array(this.mData).buffer,ne=new DataView(W);return new Color(ne.getFloat32(0,!0),ne.getFloat32(4,!0),ne.getFloat32(8,!0))},this.dataAsFloat=function(){var W=new Uint8Array(this.mData).buffer;return new DataView(W).getFloat32(0,!0)},this.dataAsBool=function(){var W=new Uint8Array(this.mData).buffer;return!!new DataView(W).getFloat32(0,!0)},this.dataAsString=function(){var W=new le;return W.data=this.mData,W.toString()},this.dataAsMap=function(){var W=new le;W.data=this.mData;var ne=W.toString();return-1!=(ne=ne.replace(/\\/g,"/")).indexOf("/")&&(ne=ne.substr(ne.lastIndexOf("/")+1)),d.load(ne)}}v.KeyFrame.tempAniPos=new Vector3,v.KeyFrame.tempAniQuat=new Quaternion,v.KeyFrame.tempAniScale=new Vector3(1,1,1),v.KeyFrame.tempAniMatrix=new Matrix4,v.KeyFrameTrack=function(){this.keys=[],this.target=null,this.time=0,this.length=0,this._accelTable={},this.fps=20,this.addKey=function(W){this.keys.push(W)},this.init=function(){if(this.sortKeys(),this.length=this.keys.length>0?this.keys[this.keys.length-1].time:0,this.fps)for(var W=0;W<this.length*this.fps;W++)for(var ne=0;ne<this.keys.length;ne++){if(this.keys[ne].time==W){this._accelTable[W]=ne;break}if(this.keys[ne].time<W/this.fps&&this.keys[ne+1]&&this.keys[ne+1].time>=W/this.fps){this._accelTable[W]=ne;break}}},this.parseFromThree=function(W){var ne=W.fps;this.target=W.node;for(var Ie=W.hierarchy[0].keys,ze=0;ze<Ie.length;ze++)this.addKey(new v.KeyFrame(ze/ne||Ie[ze].time,Ie[ze].targets[0].data));this.init()},this.parseFromCollada=function(W){for(var ne=W.keys,Ie=this.fps,ze=0;ze<ne.length;ze++)this.addKey(new v.KeyFrame(ze/Ie||ne[ze].time,ne[ze].matrix));this.init()},this.sortKeys=function(){this.keys.sort(this.keySortFunc)},this.keySortFunc=function(W,ne){return W.time-ne.time},this.clone=function(){var W=new v.KeyFrameTrack;W.target=this.target,W.time=this.time,W.length=this.length;for(var ne=0;ne<this.keys.length;ne++)W.addKey(this.keys[ne].clone());return W.init(),W},this.reTarget=function(W,ne){ne||(ne=v.TrackTargetNodeNameCompare),this.target=ne(W,this.target)},this.keySearchAccel=function(W){return W*=this.fps,W=Math.floor(W),this._accelTable[W]||0},this.setTime=function(W){W=Math.abs(W),this.length&&(W=W%this.length+.05);for(var ne=null,Ie=null,ze=this.keySearchAccel(W);ze<this.keys.length;ze++){if(this.keys[ze].time==W){ne=this.keys[ze],Ie=this.keys[ze];break}if(this.keys[ze].time<W&&this.keys[ze+1]&&this.keys[ze+1].time>W){ne=this.keys[ze],Ie=this.keys[ze+1];break}if(this.keys[ze].time<W&&ze==this.keys.length-1){ne=this.keys[ze],(Ie=this.keys[0].clone()).time+=this.length+.05;break}}return ne&&Ie&&ne!==Ie?(this.target.matrixAutoUpdate=!1,this.target.matrix.copy(ne.lerp(Ie,W)),void(this.target.matrixWorldNeedsUpdate=!0)):ne&&Ie&&ne==Ie?(this.target.matrixAutoUpdate=!1,this.target.matrix.copy(ne.matrix),void(this.target.matrixWorldNeedsUpdate=!0)):void 0}},v.TrackTargetNodeNameCompare=function(W,ne){return function Ie(ze,it){if(ze.name==it)return ze;for(var Dt=0;Dt<ze.children.length;Dt++){var xt=Ie(ze.children[Dt],it);if(xt)return xt}return null}(W,ne.name)},v.Animation=function(){this.tracks=[],this.length=0,this.addTrack=function(W){this.tracks.push(W),this.length=Math.max(W.length,this.length)},this.setTime=function(W){this.time=W;for(var ne=0;ne<this.tracks.length;ne++)this.tracks[ne].setTime(W)},this.clone=function(W,ne){ne||(ne=v.TrackTargetNodeNameCompare);var Ie=new v.Animation;Ie.target=W;for(var ze=0;ze<this.tracks.length;ze++){var it=this.tracks[ze].clone();it.reTarget(W,ne),Ie.addTrack(it)}return Ie}};var Te={"?mat.name":"name","$mat.shadingm":"shading","$mat.twosided":"twoSided","$mat.wireframe":"wireframe","$clr.ambient":"ambient","$clr.diffuse":"color","$clr.specular":"specular","$clr.emissive":"emissive","$clr.transparent":"transparent","$clr.reflective":"reflect","$mat.shininess":"shininess","$mat.reflectivity":"reflectivity","$mat.refracti":"refraction","$tex.file":"map"},be={"?mat.name":"string","$mat.shadingm":"bool","$mat.twosided":"bool","$mat.wireframe":"bool","$clr.ambient":"color","$clr.diffuse":"color","$clr.specular":"color","$clr.emissive":"color","$clr.transparent":"color","$clr.reflective":"color","$mat.shininess":"float","$mat.reflectivity":"float","$mat.refracti":"float","$tex.file":"map"};function xe(){this.mNumAllocated=0,this.mNumProperties=0,this.mProperties=[],this.toTHREE=function(){for(var W=new MeshPhongMaterial,ne=0;ne<this.mProperties.length;ne++)if("float"==be[this.mProperties[ne].mKey]&&(W[Te[this.mProperties[ne].mKey]]=this.mProperties[ne].dataAsFloat()),"color"==be[this.mProperties[ne].mKey]&&(W[Te[this.mProperties[ne].mKey]]=this.mProperties[ne].dataAsColor()),"bool"==be[this.mProperties[ne].mKey]&&(W[Te[this.mProperties[ne].mKey]]=this.mProperties[ne].dataAsBool()),"string"==be[this.mProperties[ne].mKey]&&(W[Te[this.mProperties[ne].mKey]]=this.mProperties[ne].dataAsString()),"map"==be[this.mProperties[ne].mKey]){var Ie=this.mProperties[ne];1==Ie.mSemantic&&(W.map=this.mProperties[ne].dataAsMap()),6==Ie.mSemantic&&(W.normalMap=this.mProperties[ne].dataAsMap()),10==Ie.mSemantic&&(W.lightMap=this.mProperties[ne].dataAsMap()),8==Ie.mSemantic&&(W.alphaMap=this.mProperties[ne].dataAsMap())}return W.ambient.r=.53,W.ambient.g=.53,W.ambient.b=.53,W.color.r=1,W.color.g=1,W.color.b=1,W}}function we(W,ne,Ie){var ze=new Vector3,it=1-Ie;return ze.x=W.x*Ie+ne.x*it,ze.y=W.y*Ie+ne.y*it,ze.z=W.z*Ie+ne.z*it,ze}function Ne(W,ne,Ie){return W.clone().slerp(ne,1-Ie)}function Re(W,ne,Ie,ze){if(1==W.length)return W[0].mValue.toTHREE();for(var it=1/0,Dt=null,xt=null,kt=0;kt<W.length;kt++){var ir=Math.abs(W[kt].mTime-ne);ir<it&&W[kt].mTime<=ne&&(it=ir,Dt=W[kt],xt=W[kt+1])}if(Dt){if(xt){var Xr=(Dt.mTime-ne)/(xt.mTime-Dt.mTime);return ze(Dt.mValue.toTHREE(),xt.mValue.toTHREE(),Xr)}return(xt=W[0].clone()).mTime+=Ie,Xr=(Dt.mTime-ne)/(xt.mTime-Dt.mTime),ze(Dt.mValue.toTHREE(),xt.mValue.toTHREE(),Xr)}return null}function De(){this.mNodeName="",this.mNumPositionKeys=0,this.mNumRotationKeys=0,this.mNumScalingKeys=0,this.mPositionKeys=[],this.mRotationKeys=[],this.mScalingKeys=[],this.mPreState="",this.mPostState="",this.init=function(W){function ne(Ie){Ie.mTime/=W}W||(W=1),this.mPositionKeys.forEach(ne),this.mRotationKeys.forEach(ne),this.mScalingKeys.forEach(ne)},this.sortKeys=function(){function W(ne,Ie){return ne.mTime-Ie.mTime}this.mPositionKeys.sort(W),this.mRotationKeys.sort(W),this.mScalingKeys.sort(W)},this.getLength=function(){return Math.max(Math.max.apply(null,this.mPositionKeys.map(function(W){return W.mTime})),Math.max.apply(null,this.mRotationKeys.map(function(W){return W.mTime})),Math.max.apply(null,this.mScalingKeys.map(function(W){return W.mTime})))},this.toTHREE=function(W){this.sortKeys();for(var ne=this.getLength(),Ie=new v.KeyFrameTrack,ze=0;ze<ne;ze+=.05){var it=new Matrix4,Dt=ze,xt=Re(this.mPositionKeys,Dt,ne,we),kt=Re(this.mScalingKeys,Dt,ne,we),ir=Re(this.mRotationKeys,Dt,ne,Ne);it.compose(xt,ir,kt);var Cr=new v.KeyFrame(Dt,it);Ie.addKey(Cr)}Ie.target=W.findNode(this.mNodeName).toTHREE();var Hr=[Ie];if(W.nodeToBoneMap[this.mNodeName])for(ze=0;ze<W.nodeToBoneMap[this.mNodeName].length;ze++){var Xr=Ie.clone();Xr.target=W.nodeToBoneMap[this.mNodeName][ze],Hr.push(Xr)}return Hr}}function Je(){this.mName="",this.mDuration=0,this.mTicksPerSecond=0,this.mNumChannels=0,this.mChannels=[],this.toTHREE=function(W){var ne=new v.Animation;for(var Ie in this.mChannels){this.mChannels[Ie].init(this.mTicksPerSecond);var ze=this.mChannels[Ie].toTHREE(W);for(var it in ze)ze[it].init(),ne.addTrack(ze[it])}return ne.length=Math.max.apply(null,ne.tracks.map(function(Dt){return Dt.length})),ne}}function $e(){this.mWidth=0,this.mHeight=0,this.texAchFormatHint=[],this.pcData=[]}function pt(){this.mName="",this.mType=0,this.mAttenuationConstant=0,this.mAttenuationLinear=0,this.mAttenuationQuadratic=0,this.mAngleInnerCone=0,this.mAngleOuterCone=0,this.mColorDiffuse=null,this.mColorSpecular=null,this.mColorAmbient=null}function ut(){this.mName="",this.mPosition=null,this.mLookAt=null,this.mUp=null,this.mHorizontalFOV=0,this.mClipPlaneNear=0,this.mClipPlaneFar=0,this.mAspect=0}function at(){this.versionMajor=0,this.versionMinor=0,this.versionRevision=0,this.compileFlags=0,this.mFlags=0,this.mNumMeshes=0,this.mNumMaterials=0,this.mNumAnimations=0,this.mNumTextures=0,this.mNumLights=0,this.mNumCameras=0,this.mRootNode=null,this.mMeshes=[],this.mMaterials=[],this.mAnimations=[],this.mLights=[],this.mCameras=[],this.nodeToBoneMap={},this.findNode=function(W,ne){if(ne||(ne=this.mRootNode),ne.mName==W)return ne;for(var Ie=0;Ie<ne.mChildren.length;Ie++){var ze=this.findNode(W,ne.mChildren[Ie]);if(ze)return ze}return null},this.toTHREE=function(){this.nodeCount=0,function(W){for(var ne in W.mMeshes){var Ie=W.mMeshes[ne];for(var ze in Ie.mBones){var it=W.findNode(Ie.mBones[ze].mName);it&&(it.isBone=!0)}}}(this);var W=this.mRootNode.toTHREE(this);for(var ne in this.mMeshes)this.mMeshes[ne].hookupSkeletons(this);if(this.mAnimations.length>0)var Ie=this.mAnimations[0].toTHREE(this);return{object:W,animation:Ie}}}function Xe(){this.elements=[[],[],[],[]],this.toTHREE=function(){for(var W=new Matrix4,ne=0;ne<4;++ne)for(var Ie=0;Ie<4;++Ie)W.elements[4*ne+Ie]=this.elements[Ie][ne];return W}}var Ke=!0;function lt(W){var ne=W.getFloat32(W.readOffset,Ke);return W.readOffset+=4,ne}function ot(W){var ne=W.getFloat64(W.readOffset,Ke);return W.readOffset+=8,ne}function St(W){var ne=W.getUint8(W.readOffset);return W.readOffset+=1,ne}function ft(W){var ne=W.getUint16(W.readOffset,Ke);return W.readOffset+=2,ne}function He(W){var ne=W.getUint32(W.readOffset,Ke);return W.readOffset+=4,ne}function gt(W){var ne=W.getUint32(W.readOffset,Ke);return W.readOffset+=4,ne}function vt(W){var ne=new Y;return ne.x=lt(W),ne.y=lt(W),ne.z=lt(W),ne}function Gt(W){var ne=new Z;return ne.r=lt(W),ne.g=lt(W),ne.b=lt(W),ne}function yt(W){var ne=new le,Ie=He(W);return W.ReadBytes(ne.data,1,Ie),ne.toString()}function xr(W){var ne=new ve;return ne.mVertexId=He(W),ne.mWeight=lt(W),ne}function Dr(W){for(var ne=new Xe,Ie=0;Ie<4;++Ie)for(var ze=0;ze<4;++ze)ne.elements[Ie][ze]=lt(W);return ne}function Ur(W){var ne=new _e;return ne.mTime=ot(W),ne.mValue=vt(W),ne}function qr(W){var ne=new ae;return ne.mTime=ot(W),ne.mValue=function(W){var ne=new se;return ne.w=lt(W),ne.x=lt(W),ne.y=lt(W),ne.z=lt(W),ne}(W),ne}function hn(W,ne,Ie){for(var ze=0;ze<Ie;ze++)ne[ze]=Ur(W)}function Sr(W,ne,Ie){return W.Seek(sizeof(ne)*Ie,Kn)}function An(W){if(!W)throw"asset failed"}function jr(W,ne,Ie){An(4668==gt(W)),gt(W);var it=new pe;if(it.mParent=ne,it.mDepth=Ie,it.mName=yt(W),it.mTransformation=Dr(W),it.mNumChildren=He(W),it.mNumMeshes=He(W),it.mNumMeshes){it.mMeshes=[];for(var Dt=0;Dt<it.mNumMeshes;++Dt)it.mMeshes[Dt]=He(W)}if(it.mNumChildren)for(it.mChildren=[],Dt=0;Dt<it.mNumChildren;++Dt){var xt=jr(W,it,Ie++);it.mChildren[Dt]=xt}return it}function cn(W,ne){return An(4666==gt(W)),gt(W),ne.mName=yt(W),ne.mNumWeights=He(W),ne.mOffsetMatrix=Dr(W),Wn?Sr(W,ne.mWeights,ne.mNumWeights):(ne.mWeights=[],function(W,ne,Ie){for(var ze=0;ze<Ie;ze++)ne[ze]=xr(W)}(W,ne.mWeights,ne.mNumWeights)),ne}function Fn(W,ne){An(4663==gt(W)),gt(W),ne.mPrimitiveTypes=He(W),ne.mNumVertices=He(W),ne.mNumFaces=He(W),ne.mNumBones=He(W),ne.mMaterialIndex=He(W),ne.mNumUVComponents=[];var ze=He(W);1&ze&&(Wn?Sr(W,ne.mVertices,ne.mNumVertices):(ne.mVertices=[],ne.mVertexBuffer=W.subArray32(W.readOffset,W.readOffset+3*ne.mNumVertices*4),W.Seek(3*ne.mNumVertices*4,Kn))),2&ze&&(Wn?Sr(W,ne.mNormals,ne.mNumVertices):(ne.mNormals=[],ne.mNormalBuffer=W.subArray32(W.readOffset,W.readOffset+3*ne.mNumVertices*4),W.Seek(3*ne.mNumVertices*4,Kn))),4&ze&&(Wn?(Sr(W,ne.mTangents,ne.mNumVertices),Sr(W,ne.mBitangents,ne.mNumVertices)):(ne.mTangents=[],ne.mTangentBuffer=W.subArray32(W.readOffset,W.readOffset+3*ne.mNumVertices*4),W.Seek(3*ne.mNumVertices*4,Kn),ne.mBitangents=[],ne.mBitangentBuffer=W.subArray32(W.readOffset,W.readOffset+3*ne.mNumVertices*4),W.Seek(3*ne.mNumVertices*4,Kn)));for(var it=0;it<1&&ze&Q(it);++it)Wn?Sr(W,ne.mColors[it],ne.mNumVertices):(ne.mColors[it]=[],ne.mColorBuffer=W.subArray32(W.readOffset,W.readOffset+4*ne.mNumVertices*4),W.Seek(4*ne.mNumVertices*4,Kn));for(ne.mTexCoordsBuffers=[],it=0;it<4&&ze&ee(it);++it)if(ne.mNumUVComponents[it]=He(W),Wn)Sr(W,ne.mTextureCoords[it],ne.mNumVertices);else{ne.mTextureCoords[it]=[],ne.mTexCoordsBuffers[it]=[];for(var Dt=0;Dt<ne.mNumVertices;Dt++)ne.mTexCoordsBuffers[it].push(lt(W)),ne.mTexCoordsBuffers[it].push(lt(W)),lt(W)}if(Wn)He(W);else{ne.mFaces=[],ne.mIndexArray=[];for(var xt=0;xt<ne.mNumFaces;++xt){var kt=ne.mFaces[xt]=new ue;kt.mNumIndices=ft(W),kt.mIndices=[];for(var ir=0;ir<kt.mNumIndices;++ir)kt.mIndices[ir]=ne.mNumVertices<65536?ft(W):He(W);if(3===kt.mNumIndices)ne.mIndexArray.push(kt.mIndices[0]),ne.mIndexArray.push(kt.mIndices[1]),ne.mIndexArray.push(kt.mIndices[2]);else{if(4!==kt.mNumIndices)throw new Error("Sorry, can't currently triangulate polys. Use the triangulate preprocessor in Assimp.");ne.mIndexArray.push(kt.mIndices[0]),ne.mIndexArray.push(kt.mIndices[1]),ne.mIndexArray.push(kt.mIndices[2]),ne.mIndexArray.push(kt.mIndices[2]),ne.mIndexArray.push(kt.mIndices[3]),ne.mIndexArray.push(kt.mIndices[0])}}}if(ne.mNumBones)for(ne.mBones=[],ir=0;ir<ne.mNumBones;++ir)ne.mBones[ir]=new he,cn(W,ne.mBones[ir])}function yi(W,ne){An(4670==gt(W)),gt(W),ne.mKey=yt(W),ne.mSemantic=He(W),ne.mIndex=He(W),ne.mDataLength=He(W),ne.mType=He(W),ne.mData=[],W.ReadBytes(ne.mData,1,ne.mDataLength)}function wo(W,ne){if(An(4669==gt(W)),gt(W),ne.mNumAllocated=ne.mNumProperties=He(W),ne.mNumProperties){ne.mProperties&&delete ne.mProperties,ne.mProperties=[];for(var ze=0;ze<ne.mNumProperties;++ze)ne.mProperties[ze]=new ce,yi(W,ne.mProperties[ze])}}function ro(W,ne){An(4664==gt(W)),gt(W),ne.mNodeName=yt(W),ne.mNumPositionKeys=He(W),ne.mNumRotationKeys=He(W),ne.mNumScalingKeys=He(W),ne.mPreState=He(W),ne.mPostState=He(W),ne.mNumPositionKeys&&(Wn?Sr(W,ne.mPositionKeys,ne.mNumPositionKeys):(ne.mPositionKeys=[],hn(W,ne.mPositionKeys,ne.mNumPositionKeys))),ne.mNumRotationKeys&&(Wn?Sr(W,ne.mRotationKeys,ne.mNumRotationKeys):(ne.mRotationKeys=[],function(W,ne,Ie){for(var ze=0;ze<Ie;ze++)ne[ze]=qr(W)}(W,ne.mRotationKeys,ne.mNumRotationKeys))),ne.mNumScalingKeys&&(Wn?Sr(W,ne.mScalingKeys,ne.mNumScalingKeys):(ne.mScalingKeys=[],hn(W,ne.mScalingKeys,ne.mNumScalingKeys)))}function zt(W,ne){if(An(4667==gt(W)),gt(W),ne.mName=yt(W),ne.mDuration=ot(W),ne.mTicksPerSecond=ot(W),ne.mNumChannels=He(W),ne.mNumChannels){ne.mChannels=[];for(var ze=0;ze<ne.mNumChannels;++ze)ne.mChannels[ze]=new De,ro(W,ne.mChannels[ze])}}function Ln(W,ne){An(4662==gt(W)),gt(W),ne.mWidth=He(W),ne.mHeight=He(W),W.ReadBytes(ne.achFormatHint,1,4),Wn||(ne.mHeight?(ne.pcData=[],W.ReadBytes(ne.pcData,1,ne.mWidth*ne.mHeight*4)):(ne.pcData=[],W.ReadBytes(ne.pcData,1,ne.mWidth)))}function Kt(W,ne){An(4661==gt(W)),gt(W),ne.mName=yt(W),ne.mType=He(W),1!=ne.mType&&(ne.mAttenuationConstant=lt(W),ne.mAttenuationLinear=lt(W),ne.mAttenuationQuadratic=lt(W)),ne.mColorDiffuse=Gt(W),ne.mColorSpecular=Gt(W),ne.mColorAmbient=Gt(W),3==ne.mType&&(ne.mAngleInnerCone=lt(W),ne.mAngleOuterCone=lt(W))}function Ee(W,ne){An(4660==gt(W)),gt(W),ne.mName=yt(W),ne.mPosition=vt(W),ne.mLookAt=vt(W),ne.mUp=vt(W),ne.mHorizontalFOV=lt(W),ne.mClipPlaneNear=lt(W),ne.mClipPlaneFar=lt(W),ne.mAspect=lt(W)}function Nr(W,ne){if(An(4665==gt(W)),gt(W),ne.mFlags=He(W),ne.mNumMeshes=He(W),ne.mNumMaterials=He(W),ne.mNumAnimations=He(W),ne.mNumTextures=He(W),ne.mNumLights=He(W),ne.mNumCameras=He(W),ne.mRootNode=new pe,ne.mRootNode=jr(W,null,0),ne.mNumMeshes){ne.mMeshes=[];for(var ze=0;ze<ne.mNumMeshes;++ze)ne.mMeshes[ze]=new $,Fn(W,ne.mMeshes[ze])}if(ne.mNumMaterials)for(ne.mMaterials=[],ze=0;ze<ne.mNumMaterials;++ze)ne.mMaterials[ze]=new xe,wo(W,ne.mMaterials[ze]);if(ne.mNumAnimations)for(ne.mAnimations=[],ze=0;ze<ne.mNumAnimations;++ze)ne.mAnimations[ze]=new Je,zt(W,ne.mAnimations[ze]);if(ne.mNumTextures)for(ne.mTextures=[],ze=0;ze<ne.mNumTextures;++ze)ne.mTextures[ze]=new $e,Ln(W,ne.mTextures[ze]);if(ne.mNumLights)for(ne.mLights=[],ze=0;ze<ne.mNumLights;++ze)ne.mLights[ze]=new pt,Kt(W,ne.mLights[ze]);if(ne.mNumCameras)for(ne.mCameras=[],ze=0;ze<ne.mNumCameras;++ze)ne.mCameras[ze]=new ut,Ee(W,ne.mCameras[ze])}var Wn,Ci,Kn=0;return function(W){var ne=new at,Ie=new DataView(W);if(function(W){W.readOffset=0,W.Seek=function(ne,Ie){Ie==Kn&&(W.readOffset+=ne),1==Ie&&(W.readOffset=ne)},W.ReadBytes=function(ne,Ie,ze){for(var it=Ie*ze,Dt=0;Dt<it;Dt++)ne[Dt]=St(this)},W.subArray32=function(ne,Ie){var it=this.buffer.slice(ne,Ie);return new Float32Array(it)},W.subArrayUint16=function(ne,Ie){var it=this.buffer.slice(ne,Ie);return new Uint16Array(it)},W.subArrayUint8=function(ne,Ie){var it=this.buffer.slice(ne,Ie);return new Uint8Array(it)},W.subArrayUint32=function(ne,Ie){var it=this.buffer.slice(ne,Ie);return new Uint32Array(it)}}(Ie),Ie.Seek(44,Kn),ne.versionMajor=He(Ie),ne.versionMinor=He(Ie),ne.versionRevision=He(Ie),ne.compileFlags=He(Ie),Wn=ft(Ie)>0,Ci=ft(Ie)>0,Wn)throw"Shortened binaries are not supported!";if(Ie.Seek(256,Kn),Ie.Seek(128,Kn),Ie.Seek(64,Kn),Ci){var ze=gt(Ie),it=Ie.FileSize()-Ie.Tell(),Dt=[];Ie.Read(Dt,1,it);var xt=[];uncompress(xt,ze,Dt,it),Nr(new ArrayBuffer(xt),ne)}else Nr(Ie,ne);return ne.toTHREE()}(e)}});var AWDLoader=function(){var re=!0;function j(){this.id=0,this.data=null,this.namespace=0,this.flags=0}function te(){}te.prototype={set:function(U,K){this[U]=K},get:function(U,K){return this.hasOwnProperty(U)?this[U]:K}};var J=function(U){Loader.call(this,U),this.trunk=new Object3D,this.materialFactory=void 0,this._url="",this._baseDir="",this._data=void 0,this._ptr=0,this._version=[],this._streaming=!1,this._optimized_for_accuracy=!1,this._compression=0,this._bodylen=4294967295,this._blocks=[new j],this._accuracyMatrix=!1,this._accuracyGeo=!1,this._accuracyProps=!1};return J.prototype=Object.assign(Object.create(Loader.prototype),{constructor:J,load:function(U,K,ee,Q){var oe=this;this._url=U,this._baseDir=U.substr(0,U.lastIndexOf("/")+1);var me=new FileLoader(this.manager);me.setPath(this.path),me.setResponseType("arraybuffer"),me.load(U,function(fe){K(oe.parse(fe))},ee,Q)},parse:function(U){var K=U.byteLength;for(this._ptr=0,this._data=new DataView(U),this._parseHeader(),0!=this._compression&&console.error("compressed AWD not supported"),!this._streaming&&this._bodylen!=U.byteLength-this._ptr&&console.error("AWDLoader: body len does not match file length",this._bodylen,K-this._ptr);this._ptr<K;)this.parseNextBlock();return this.trunk},parseNextBlock:function(){var U,K,ee=this.readU32(),Q=this.readU8(),oe=this.readU8(),me=this.readU8(),fe=this.readU32();switch(oe){case 1:U=this.parseMeshData();break;case 22:U=this.parseContainer();break;case 23:U=this.parseMeshInstance();break;case 81:U=this.parseMaterial();break;case 82:U=this.parseTexture();break;case 101:U=this.parseSkeleton();break;case 112:U=this.parseMeshPoseAnimation(!1);break;case 113:U=this.parseVertexAnimationSet();break;case 102:U=this.parseSkeletonPose();break;case 103:U=this.parseSkeletonAnimation();break;case 122:U=this.parseAnimatorSet();break;default:this._ptr+=fe}this._blocks[ee]=K=new j,K.data=U,K.id=ee,K.namespace=Q,K.flags=me},_parseHeader:function(){var U=this._version;if(4282180!=(this.readU8()<<16|this.readU8()<<8|this.readU8()))throw new Error("AWDLoader - bad magic");U[0]=this.readU8(),U[1]=this.readU8();var ee=this.readU16();this._streaming=1==(1&ee),2===U[0]&&1===U[1]&&(this._accuracyMatrix=2==(2&ee),this._accuracyGeo=4==(4&ee),this._accuracyProps=8==(8&ee)),this._geoNrType=this._accuracyGeo?8:7,this._matrixNrType=this._accuracyMatrix?8:7,this._propsNrType=this._accuracyProps?8:7,this._optimized_for_accuracy=2==(2&ee),this._compression=this.readU8(),this._bodylen=this.readU32()},parseContainer:function(){var K=new Object3D,ee=this.readU32(),Q=this.parseMatrix4();return K.name=this.readUTF(),K.applyMatrix4(Q),(this._blocks[ee].data||this.trunk).add(K),this.parseProperties({1:this._matrixNrType,2:this._matrixNrType,3:this._matrixNrType,4:4}),K.extra=this.parseUserAttributes(),K},parseMeshInstance:function(){var U,K,ee,Q,oe,me,fe,ge,$,ue,Y,Z,ve;for(me=this.readU32(),ge=this.parseMatrix4(),U=this.readUTF(),fe=this.readU32(),Z=this.readU16(),ee=this.getBlock(fe),$=[],ve=0;ve<Z;ve++)Y=this.readU32(),ue=this.getBlock(Y),$.push(ue);if(oe=[],(Q=ee.length)>1)for(K=new Object3D,ve=0;ve<Q;ve++){var le=new Mesh(ee[ve]);oe.push(le),K.add(le)}else K=new Mesh(ee[0]),oe.push(K);K.applyMatrix4(ge),K.name=U,(this.getBlock(me)||this.trunk).add(K);var _e=$.length,ae=Math.max(Q,_e);for(ve=0;ve<ae;ve++)oe[ve%Q].material=$[ve%_e];return this.parseProperties(null),K.extra=this.parseUserAttributes(),K},parseMaterial:function(){var U,K,ee,Q,oe,me;for(U=this.readUTF(),K=this.readU8(),me=this.readU8(),ee=this.parseProperties({1:3,2:23,11:21,12:7,13:21});0<me;)this.readU16(),this.parseProperties(null),this.parseUserAttributes();if(oe=this.parseUserAttributes(),void 0!==this.materialFactory&&(Q=this.materialFactory(U)))return Q;if(Q=new MeshPhongMaterial,1===K)Q.color.setHex(ee.get(1,13421772));else if(2===K){var ge=ee.get(2,0);Q.map=this.getBlock(ge)}return Q.extra=oe,Q.alphaThreshold=ee.get(12,0),Q.repeat=ee.get(13,!1),Q},parseTexture:function(){var ee,Q,U=this.readUTF();if(0===this.readU8()){Q=this.readU32();var oe=this.readUTFBytes(Q);console.log(oe),(ee=this.loadTexture(oe)).userData={},ee.userData.name=U}return this.parseProperties(null),this.parseUserAttributes(),ee},loadTexture:function(U){var K=new Texture;return new ImageLoader(this.manager).load(this._baseDir+U,function(Q){K.image=Q,K.needsUpdate=!0}),K},parseSkeleton:function(){this.readUTF();var U=this.readU16(),K=[],ee=0;for(this.parseProperties(null);ee<U;){var Q,oe;this.readU16(),(Q=new Bone).parent=this.readU16()-1,Q.name=this.readUTF(),oe=this.parseMatrix4(),Q.skinMatrix=oe,this.parseProperties(null),this.parseUserAttributes(),K.push(Q),ee++}return this.parseUserAttributes(),K},parseSkeletonPose:function(){this.readUTF();var K=this.readU16();this.parseProperties(null);for(var ee=[],Q=0;Q<K;){var me;me=1===this.readU8()?this.parseMatrix4():new Matrix4,ee[Q]=me,Q++}return this.parseUserAttributes(),ee},parseSkeletonAnimation:function(){this.readUTF();var U,K,oe=[],me=this.readU16();this.parseProperties(null);for(var fe=0;fe<me;)K=this.readU32(),U=this.readU16(),oe.push({pose:this._blocks[K].data,duration:U}),fe++;if(0!==oe.length)return this.parseUserAttributes(),oe},parseVertexAnimationSet:function(){this.readUTF();for(var U,ee=this.readU16(),oe=(this.parseProperties({1:5}),0),me=[];oe<ee;)U=this.readU32(),me.push(this._blocks[U].data),oe++;return this.parseUserAttributes(),me},parseAnimatorSet:function(){this.readUTF();var U,Q=this.readU16(),oe=this.parseProperties({1:23});U=this.readU32();for(var me=this.readU16(),fe=[],ge=0;ge<me;ge++)fe.push(this.readU32());this.readU16(),Boolean(this.readU8()),this.parseUserAttributes(),this.parseUserAttributes();var Z,Y=[];for(ge=0;ge<fe.length;ge++)Y.push(this._blocks[fe[ge]].data);for(1==Q&&(Z={animationSet:this._blocks[U].data,skeleton:this._blocks[oe.get(1,0)].data}),ge=0;ge<Y.length;ge++)Y[ge].animator=Z;return Z},parseMeshData:function(){var ee,oe,U=this.readUTF(),K=this.readU16(),Q=0,me=[];for(this.parseProperties({1:this._geoNrType,2:this._geoNrType});Q<K;){var fe,ge,$;for((ee=new BufferGeometry).name=U,me.push(ee),fe=this.readU32(),ge=this._ptr+fe,this.parseProperties({1:this._geoNrType,2:this._geoNrType});this._ptr<ge;){var ue=0,Y=this.readU8(),se=(this.readU8(),this.readU32()),ve=se+this._ptr;if(1===Y)for($=new BufferAttribute(oe=new Float32Array(se/12*3),3),ee.setAttribute("position",$),ue=0;this._ptr<ve;)oe[ue]=-this.readF32(),oe[ue+1]=this.readF32(),oe[ue+2]=this.readF32(),ue+=3;else if(2===Y)for($=new BufferAttribute(oe=new Uint16Array(se/2),1),ee.setIndex($),ue=0;this._ptr<ve;)oe[ue+1]=this.readU16(),oe[ue]=this.readU16(),oe[ue+2]=this.readU16(),ue+=3;else if(3===Y)for($=new BufferAttribute(oe=new Float32Array(se/8*2),2),ee.setAttribute("uv",$),ue=0;this._ptr<ve;)oe[ue]=this.readF32(),oe[ue+1]=1-this.readF32(),ue+=2;else if(4===Y)for($=new BufferAttribute(oe=new Float32Array(se/12*3),3),ee.setAttribute("normal",$),ue=0;this._ptr<ve;)oe[ue]=-this.readF32(),oe[ue+1]=this.readF32(),oe[ue+2]=this.readF32(),ue+=3;else this._ptr=ve}this.parseUserAttributes(),ee.computeBoundingSphere(),Q++}return this.parseUserAttributes(),me},parseMeshPoseAnimation:function(U){var ee,Q,oe,me,fe,ge,Y,Z,ve,K=1,$=0,ue={},se=[],_e=(this.readUTF(),this.readU32()),ae=this.getBlock(_e);if(null!==ae){for((ge=ae.geometry).morphTargets=[],U||(K=this.readU16()),ee=this.readU16(),Y=this.readU16(),Z=0;Z<Y;)se.push(this.readU16()),Z++;for(ve=this.parseProperties({1:21,2:21}),ue.looping=ve.get(1,!0),ue.stitchFinalFrame=ve.get(2,!1),Q=0;Q<K;){for(this.readU16(),oe=0;oe<ee;)for(Z=0,me=this.readU32(),fe=this._ptr+me;Z<Y;){if(1===se[Z]){var pe=new Float32Array(me/4);for(ge.morphTargets.push({array:pe}),$=0;this._ptr<fe;)pe[$]=this.readF32(),pe[$+1]=this.readF32(),pe[$+2]=this.readF32(),$+=3;oe++}else this._ptr=fe;Z++}Q++}return this.parseUserAttributes(),null}console.log("parseMeshPoseAnimation target mesh not found at:",_e)},getBlock:function(U){return this._blocks[U].data},parseMatrix4:function(){var U=new Matrix4,K=U.elements;return K[0]=this.readF32(),K[1]=this.readF32(),K[2]=this.readF32(),K[3]=0,K[4]=this.readF32(),K[5]=this.readF32(),K[6]=this.readF32(),K[7]=0,K[8]=this.readF32(),K[9]=this.readF32(),K[10]=this.readF32(),K[11]=0,K[12]=-this.readF32(),K[13]=this.readF32(),K[14]=this.readF32(),K[15]=1,U},parseProperties:function(U){var K=this.readU32(),ee=this._ptr+K,Q=new te;if(U)for(;this._ptr<ee;){var oe=this.readU16(),me=this.readU32();U.hasOwnProperty(oe)?Q.set(oe,this.parseAttrValue(U[oe],me)):this._ptr+=me}return Q},parseUserAttributes:function(){return this._ptr=this.readU32()+this._ptr,null},parseAttrValue:function(U,K){var ee,Q;switch(U){case 1:ee=1,Q=this.readI8;break;case 2:ee=2,Q=this.readI16;break;case 3:ee=4,Q=this.readI32;break;case 21:case 4:ee=1,Q=this.readU8;break;case 5:ee=2,Q=this.readU16;break;case 6:case 23:ee=4,Q=this.readU32;break;case 7:ee=4,Q=this.readF32;break;case 8:case 41:case 42:case 43:case 44:case 45:case 46:case 47:ee=8,Q=this.readF64}if(ee<K){var oe,me,fe;for(oe=[],me=0,fe=K/ee;me<fe;)oe.push(Q.call(this)),me++;return oe}return Q.call(this)},readU8:function(){return this._data.getUint8(this._ptr++)},readI8:function(){return this._data.getInt8(this._ptr++)},readU16:function(){var U=this._data.getUint16(this._ptr,re);return this._ptr+=2,U},readI16:function(){var U=this._data.getInt16(this._ptr,re);return this._ptr+=2,U},readU32:function(){var U=this._data.getUint32(this._ptr,re);return this._ptr+=4,U},readI32:function(){var U=this._data.getInt32(this._ptr,re);return this._ptr+=4,U},readF32:function(){var U=this._data.getFloat32(this._ptr,re);return this._ptr+=4,U},readF64:function(){var U=this._data.getFloat64(this._ptr,re);return this._ptr+=8,U},readUTF:function(){var U=this.readU16();return this.readUTFBytes(U)},readUTFBytes:function(U){for(var K=[],ee=0;K.length<U;){var Q=this._data.getUint8(this._ptr++,re);if(Q<128)K[ee++]=String.fromCharCode(Q);else if(Q>191&&Q<224){var oe=this._data.getUint8(this._ptr++,re);K[ee++]=String.fromCharCode((31&Q)<<6|63&oe)}else{oe=this._data.getUint8(this._ptr++,re);var me=this._data.getUint8(this._ptr++,re);K[ee++]=String.fromCharCode((15&Q)<<12|(63&oe)<<6|63&me)}}return K.join("")}}),J}();function CompressedTexture(s,e,a,d,v,g,C,w,_,x,b,A){Texture.call(this,null,g,C,w,_,x,d,v,b,A),this.image={width:e,height:a},this.mipmaps=s,this.flipY=!1,this.generateMipmaps=!1}CompressedTexture.prototype=Object.create(Texture.prototype),CompressedTexture.prototype.constructor=CompressedTexture,CompressedTexture.prototype.isCompressedTexture=!0;var BasisTextureLoader=function(e){Loader.call(this,e),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.workerConfig={format:null,astcSupported:!1,etcSupported:!1,dxtSupported:!1,pvrtcSupported:!1}};BasisTextureLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:BasisTextureLoader,setTranscoderPath:function(e){return this.transcoderPath=e,this},setWorkerLimit:function(e){return this.workerLimit=e,this},detectSupport:function(e){var a=this.workerConfig;if(a.astcSupported=!!e.extensions.get("WEBGL_compressed_texture_astc"),a.etcSupported=!!e.extensions.get("WEBGL_compressed_texture_etc1"),a.dxtSupported=!!e.extensions.get("WEBGL_compressed_texture_s3tc"),a.pvrtcSupported=!!e.extensions.get("WEBGL_compressed_texture_pvrtc")||!!e.extensions.get("WEBKIT_WEBGL_compressed_texture_pvrtc"),a.astcSupported)a.format=BasisTextureLoader.BASIS_FORMAT.cTFASTC_4x4;else if(a.dxtSupported)a.format=BasisTextureLoader.BASIS_FORMAT.cTFBC3;else if(a.pvrtcSupported)a.format=BasisTextureLoader.BASIS_FORMAT.cTFPVRTC1_4_RGBA;else{if(!a.etcSupported)throw new Error("BasisTextureLoader: No suitable compressed texture format found.");a.format=BasisTextureLoader.BASIS_FORMAT.cTFETC1}return this},load:function(e,a,d,v){var g=this,C=new FileLoader(this.manager);C.setResponseType("arraybuffer"),C.load(e,function(w){g._createTexture(w).then(a).catch(v)},d,v)},_createTexture:function(e){var d,v,a=this,g=e.byteLength,C=this._allocateWorker(g).then(function(w){return d=w,v=a.workerNextTaskID++,new Promise(function(_,x){d._callbacks[v]={resolve:_,reject:x},d.postMessage({type:"transcode",id:v,buffer:e},[e])})}).then(function(w){var R,_=a.workerConfig,x=w.width,b=w.height,A=w.mipmaps;switch(w.format){case BasisTextureLoader.BASIS_FORMAT.cTFASTC_4x4:R=new CompressedTexture(A,x,b,RGBA_ASTC_4x4_Format);break;case BasisTextureLoader.BASIS_FORMAT.cTFBC1:case BasisTextureLoader.BASIS_FORMAT.cTFBC3:R=new CompressedTexture(A,x,b,BasisTextureLoader.DXT_FORMAT_MAP[_.format],UnsignedByteType);break;case BasisTextureLoader.BASIS_FORMAT.cTFETC1:R=new CompressedTexture(A,x,b,RGB_ETC1_Format);break;case BasisTextureLoader.BASIS_FORMAT.cTFPVRTC1_4_RGB:R=new CompressedTexture(A,x,b,RGB_PVRTC_4BPPV1_Format);break;case BasisTextureLoader.BASIS_FORMAT.cTFPVRTC1_4_RGBA:R=new CompressedTexture(A,x,b,RGBA_PVRTC_4BPPV1_Format);break;default:throw new Error("BasisTextureLoader: No supported format available.")}return R.minFilter=1===A.length?LinearFilter:LinearMipmapLinearFilter,R.magFilter=LinearFilter,R.generateMipmaps=!1,R.needsUpdate=!0,R});return C.finally(function(){d&&v&&(d._taskLoad-=g,delete d._callbacks[v])}),C},_initTranscoder:function(){var e=this;if(!this.transcoderPending){var a=new FileLoader(this.manager);a.setPath(this.transcoderPath);var d=new Promise(function(C,w){a.load("basis_transcoder.js",C,void 0,w)}),v=new FileLoader(this.manager);v.setPath(this.transcoderPath),v.setResponseType("arraybuffer");var g=new Promise(function(C,w){v.load("basis_transcoder.wasm",C,void 0,w)});this.transcoderPending=Promise.all([d,g]).then(function(C){var w=C[0],_=C[1],x=BasisTextureLoader.BasisWorker.toString(),b=["/* basis_transcoder.js */",w,"/* worker */",x.substring(x.indexOf("{")+1,x.lastIndexOf("}"))].join("\n");e.workerSourceURL=URL.createObjectURL(new Blob([b])),e.transcoderBinary=_})}return this.transcoderPending},_allocateWorker:function(e){var a=this;return this._initTranscoder().then(function(){var d;return a.workerPool.length<a.workerLimit?((d=new Worker(a.workerSourceURL))._callbacks={},d._taskLoad=0,d.postMessage({type:"init",config:a.workerConfig,transcoderBinary:a.transcoderBinary}),d.onmessage=function(g){var C=g.data;switch(C.type){case"transcode":d._callbacks[C.id].resolve(C);break;case"error":d._callbacks[C.id].reject(C);break;default:console.error('BasisTextureLoader: Unexpected message, "'+C.type+'"')}},a.workerPool.push(d)):a.workerPool.sort(function(v,g){return v._taskLoad>g._taskLoad?-1:1}),(d=a.workerPool[a.workerPool.length-1])._taskLoad+=e,d})},dispose:function(){for(var e=0;e<this.workerPool.length;e++)this.workerPool[e].terminate();return this.workerPool.length=0,this}}),BasisTextureLoader.BASIS_FORMAT={cTFETC1:0,cTFETC2:1,cTFBC1:2,cTFBC3:3,cTFBC4:4,cTFBC5:5,cTFBC7_M6_OPAQUE_ONLY:6,cTFBC7_M5:7,cTFPVRTC1_4_RGB:8,cTFPVRTC1_4_RGBA:9,cTFASTC_4x4:10,cTFATC_RGB:11,cTFATC_RGBA_INTERPOLATED_ALPHA:12,cTFRGBA32:13,cTFRGB565:14,cTFBGR565:15,cTFRGBA4444:16},BasisTextureLoader.DXT_FORMAT={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779},BasisTextureLoader.DXT_FORMAT_MAP={},BasisTextureLoader.DXT_FORMAT_MAP[BasisTextureLoader.BASIS_FORMAT.cTFBC1]=BasisTextureLoader.DXT_FORMAT.COMPRESSED_RGB_S3TC_DXT1_EXT,BasisTextureLoader.DXT_FORMAT_MAP[BasisTextureLoader.BASIS_FORMAT.cTFBC3]=BasisTextureLoader.DXT_FORMAT.COMPRESSED_RGBA_S3TC_DXT5_EXT,BasisTextureLoader.BasisWorker=function(){var s,e,a;onmessage=function(C){var w=C.data;switch(w.type){case"init":s=w.config,function(g){var C;e=new Promise(function(w){C={wasmBinary:g,onRuntimeInitialized:w},BASIS(C)}).then(function(){a=C.BasisFile,(0,C.initializeBasis)()})}(w.transcoderBinary);break;case"transcode":e.then(function(){try{for(var _=function(g){var C=new a(new Uint8Array(g)),w=C.getImageWidth(0,0),_=C.getImageHeight(0,0),x=C.getNumLevels(0),b=C.getHasAlpha();function A(){C.close(),C.delete()}if(b||9!==s.format||(s.format=8),!w||!_||!x)throw A(),new Error("BasisTextureLoader:  Invalid .basis file");if(!C.startTranscoding())throw A(),new Error("BasisTextureLoader: .startTranscoding failed");for(var E=[],R=0;R<x;R++){var O=C.getImageWidth(0,R),D=C.getImageHeight(0,R),F=new Uint8Array(C.getImageTranscodedSizeInBytes(0,R,s.format));if(!C.transcodeImage(F,0,R,s.format,0,b))throw A(),new Error("BasisTextureLoader: .transcodeImage failed.");E.push({data:F,width:O,height:D})}return A(),{width:w,height:_,hasAlpha:b,mipmaps:E,format:s.format}}(w.buffer),x=_.width,b=_.height,A=_.hasAlpha,E=_.mipmaps,R=_.format,O=[],D=0;D<E.length;++D)O.push(E[D].data.buffer);self.postMessage({type:"transcode",id:w.id,width:x,height:b,hasAlpha:A,mipmaps:E,format:R},O)}catch(F){console.error(F),self.postMessage({type:"error",id:w.id,error:F.message})}})}}};var BVHLoader=function(e){Loader.call(this,e),this.animateBonePositions=!0,this.animateBoneRotations=!0};function AmbientLight(s,e){Light.call(this,s,e),this.type="AmbientLight",this.castShadow=void 0}function LightShadow(s){this.camera=s,this.bias=0,this.radius=1,this.mapSize=new Vector2(512,512),this.map=null,this.mapPass=null,this.matrix=new Matrix4,this._frustum=new Frustum,this._frameExtents=new Vector2(1,1),this._viewportCount=1,this._viewports=[new Vector4(0,0,1,1)]}function DirectionalLightShadow(){LightShadow.call(this,new OrthographicCamera(-5,5,5,-5,.5,500))}function DirectionalLight(s,e){Light.call(this,s,e),this.type="DirectionalLight",this.position.copy(Object3D.DefaultUp),this.updateMatrix(),this.target=new Object3D,this.shadow=new DirectionalLightShadow}function PointLightShadow(){LightShadow.call(this,new PerspectiveCamera(90,1,.5,500)),this._frameExtents=new Vector2(4,2),this._viewportCount=6,this._viewports=[new Vector4(2,1,1,1),new Vector4(0,1,1,1),new Vector4(3,1,1,1),new Vector4(1,1,1,1),new Vector4(3,0,1,1),new Vector4(1,0,1,1)],this._cubeDirections=[new Vector3(1,0,0),new Vector3(-1,0,0),new Vector3(0,0,1),new Vector3(0,0,-1),new Vector3(0,1,0),new Vector3(0,-1,0)],this._cubeUps=[new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,1,0),new Vector3(0,0,1),new Vector3(0,0,-1)]}function PointLight(s,e,a,d){Light.call(this,s,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(g){this.intensity=g/(4*Math.PI)}}),this.distance=void 0!==a?a:0,this.decay=void 0!==d?d:1,this.shadow=new PointLightShadow}function SpotLightShadow(){LightShadow.call(this,new PerspectiveCamera(50,1,.5,500))}function SpotLight(s,e,a,d,v,g){Light.call(this,s,e),this.type="SpotLight",this.position.copy(Object3D.DefaultUp),this.updateMatrix(),this.target=new Object3D,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(w){this.intensity=w/Math.PI}}),this.distance=void 0!==a?a:0,this.angle=void 0!==d?d:Math.PI/3,this.penumbra=void 0!==v?v:0,this.decay=void 0!==g?g:1,this.shadow=new SpotLightShadow}BVHLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:BVHLoader,load:function(e,a,d,v){var g=this,C=new FileLoader(g.manager);C.setPath(g.path),C.load(e,function(w){a(g.parse(w))},d,v)},parse:function(e){function d(R,O,D){if("ENDSITE"!==D.type){var F={time:O,position:new Vector3,rotation:new Quaternion};D.frames.push(F);for(var L=new Quaternion,I=new Vector3(1,0,0),V=new Vector3(0,1,0),z=new Vector3(0,0,1),H=0;H<D.channels.length;H++)switch(D.channels[H]){case"Xposition":F.position.x=parseFloat(R.shift().trim());break;case"Yposition":F.position.y=parseFloat(R.shift().trim());break;case"Zposition":F.position.z=parseFloat(R.shift().trim());break;case"Xrotation":L.setFromAxisAngle(I,parseFloat(R.shift().trim())*Math.PI/180),F.rotation.multiply(L);break;case"Yrotation":L.setFromAxisAngle(V,parseFloat(R.shift().trim())*Math.PI/180),F.rotation.multiply(L);break;case"Zrotation":L.setFromAxisAngle(z,parseFloat(R.shift().trim())*Math.PI/180),F.rotation.multiply(L);break;default:console.warn("BVHLoader: Invalid channel type.")}for(H=0;H<D.children.length;H++)d(R,O,D.children[H])}}function v(R,O,D){var F={name:"",type:"",frames:[]};D.push(F);var L=O.split(/[\s]+/);"END"===L[0].toUpperCase()&&"SITE"===L[1].toUpperCase()?(F.type="ENDSITE",F.name="ENDSITE"):(F.name=L[1],F.type=L[0].toUpperCase()),"{"!==w(R)&&console.error("BVHLoader: Expected opening { after type & name"),"OFFSET"!==(L=w(R).split(/[\s]+/))[0]&&console.error("BVHLoader: Expected OFFSET but got: "+L[0]),4!==L.length&&console.error("BVHLoader: Invalid number of values for OFFSET.");var I=new Vector3(parseFloat(L[1]),parseFloat(L[2]),parseFloat(L[3]));if((isNaN(I.x)||isNaN(I.y)||isNaN(I.z))&&console.error("BVHLoader: Invalid values of OFFSET."),F.offset=I,"ENDSITE"!==F.type){"CHANNELS"!==(L=w(R).split(/[\s]+/))[0]&&console.error("BVHLoader: Expected CHANNELS definition.");var V=parseInt(L[1]);F.channels=L.splice(2,V),F.children=[]}for(;;){var z=w(R);if("}"===z)return F;F.children.push(v(R,z,D))}}function w(R){for(var O;0===(O=R.shift().trim()).length;);return O}var _=this,b=function(R){"HIERARCHY"!==w(R)&&console.error("BVHLoader: HIERARCHY expected.");var O=[],D=v(R,w(R),O);"MOTION"!==w(R)&&console.error("BVHLoader: MOTION expected.");var F=w(R).split(/[\s]+/),L=parseInt(F[1]);isNaN(L)&&console.error("BVHLoader: Failed to read number of frames."),F=w(R).split(/[\s]+/);var I=parseFloat(F[2]);isNaN(I)&&console.error("BVHLoader: Failed to read frame time.");for(var V=0;V<L;V++)d(F=w(R).split(/[\s]+/),V*I,D);return O}(e.split(/[\r\n]+/g)),A=[];!function g(R,O){var D=new Bone;if(O.push(D),D.position.add(R.offset),D.name=R.name,"ENDSITE"!==R.type)for(var F=0;F<R.children.length;F++)D.add(g(R.children[F],O));return D}(b[0],A);var E=function(R){for(var O=[],D=0;D<R.length;D++){var F=R[D];if("ENDSITE"!==F.type){for(var L=[],I=[],V=[],z=0;z<F.frames.length;z++){var H=F.frames[z];L.push(H.time),I.push(H.position.x+F.offset.x),I.push(H.position.y+F.offset.y),I.push(H.position.z+F.offset.z),V.push(H.rotation.x),V.push(H.rotation.y),V.push(H.rotation.z),V.push(H.rotation.w)}_.animateBonePositions&&O.push(new VectorKeyframeTrack(".bones["+F.name+"].position",L,I)),_.animateBoneRotations&&O.push(new QuaternionKeyframeTrack(".bones["+F.name+"].quaternion",L,V))}}return new AnimationClip("animation",-1,O)}(b);return{skeleton:new Skeleton(A),clip:E}}}),AmbientLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:AmbientLight,isAmbientLight:!0}),Object.assign(LightShadow.prototype,{_projScreenMatrix:new Matrix4,_lightPositionWorld:new Vector3,_lookTarget:new Vector3,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(e){var a=this.camera,d=this.matrix,v=this._projScreenMatrix,g=this._lookTarget,C=this._lightPositionWorld;C.setFromMatrixPosition(e.matrixWorld),a.position.copy(C),g.setFromMatrixPosition(e.target.matrixWorld),a.lookAt(g),a.updateMatrixWorld(),v.multiplyMatrices(a.projectionMatrix,a.matrixWorldInverse),this._frustum.setFromProjectionMatrix(v),d.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),d.multiply(a.projectionMatrix),d.multiply(a.matrixWorldInverse)},getViewport:function(e){return this._viewports[e]},getFrameExtents:function(){return this._frameExtents},copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),DirectionalLightShadow.prototype=Object.assign(Object.create(LightShadow.prototype),{constructor:DirectionalLightShadow,isDirectionalLightShadow:!0,updateMatrices:function(e){LightShadow.prototype.updateMatrices.call(this,e)}}),DirectionalLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:DirectionalLight,isDirectionalLight:!0,copy:function(e){return Light.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),PointLightShadow.prototype=Object.assign(Object.create(LightShadow.prototype),{constructor:PointLightShadow,isPointLightShadow:!0,updateMatrices:function(e,a){void 0===a&&(a=0);var d=this.camera,v=this.matrix,g=this._lightPositionWorld,C=this._lookTarget,w=this._projScreenMatrix;g.setFromMatrixPosition(e.matrixWorld),d.position.copy(g),C.copy(d.position),C.add(this._cubeDirections[a]),d.up.copy(this._cubeUps[a]),d.lookAt(C),d.updateMatrixWorld(),v.makeTranslation(-g.x,-g.y,-g.z),w.multiplyMatrices(d.projectionMatrix,d.matrixWorldInverse),this._frustum.setFromProjectionMatrix(w)}}),PointLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:PointLight,isPointLight:!0,copy:function(e){return Light.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),SpotLightShadow.prototype=Object.assign(Object.create(LightShadow.prototype),{constructor:SpotLightShadow,isSpotLightShadow:!0,updateMatrices:function(e){var a=this.camera,d=2*MathUtils.RAD2DEG*e.angle,v=this.mapSize.width/this.mapSize.height,g=e.distance||a.far;(d!==a.fov||v!==a.aspect||g!==a.far)&&(a.fov=d,a.aspect=v,a.far=g,a.updateProjectionMatrix()),LightShadow.prototype.updateMatrices.call(this,e)}}),SpotLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:SpotLight,isSpotLight:!0,copy:function(e){return Light.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}});var TGALoader=function(e){Loader.call(this,e)};function Node(s){this.uuid=MathUtils.generateUUID(),this.name="",this.type=s,this.userData={}}TGALoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:TGALoader,load:function(e,a,d,v){var g=this,C=new Texture,w=new FileLoader(this.manager);return w.setResponseType("arraybuffer"),w.setPath(this.path),w.load(e,function(_){C.image=g.parse(_),C.needsUpdate=!0,void 0!==a&&a(C)},d,v),C},parse:function(e){e.length<19&&console.error("TGALoader: Not enough data to contain header.");var j=new Uint8Array(e),te=0,J={id_length:j[te++],colormap_type:j[te++],image_type:j[te++],colormap_index:j[te++]|j[te++]<<8,colormap_length:j[te++]|j[te++]<<8,colormap_size:j[te++],origin:[j[te++]|j[te++]<<8,j[te++]|j[te++]<<8],width:j[te++]|j[te++]<<8,height:j[te++]|j[te++]<<8,pixel_size:j[te++],flags:j[te++]};(function($){switch($.image_type){case 1:case 9:($.colormap_length>256||24!==$.colormap_size||1!==$.colormap_type)&&console.error("TGALoader: Invalid type colormap data for indexed type.");break;case 2:case 3:case 10:case 11:$.colormap_type&&console.error("TGALoader: Invalid type colormap data for colormap type.");break;case 0:console.error("TGALoader: No data.");default:console.error('TGALoader: Invalid type "%s".',$.image_type)}($.width<=0||$.height<=0)&&console.error("TGALoader: Invalid image size."),8!==$.pixel_size&&16!==$.pixel_size&&24!==$.pixel_size&&32!==$.pixel_size&&console.error('TGALoader: Invalid pixel size "%s".',$.pixel_size)})(J),J.id_length+te>e.length&&console.error("TGALoader: No data."),te+=J.id_length;var k=!1,U=!1,K=!1;switch(J.image_type){case 9:k=!0,U=!0;break;case 1:U=!0;break;case 10:k=!0;break;case 2:break;case 11:k=!0,K=!0;break;case 3:K=!0}var ee="undefined"!=typeof OffscreenCanvas,Q=ee?new OffscreenCanvas(J.width,J.height):document.createElement("canvas");Q.width=J.width,Q.height=J.height;var oe=Q.getContext("2d"),me=oe.createImageData(J.width,J.height),fe=function($,ue,Y,Z,se){var ve,le,_e,ae;if(_e=Y.width*Y.height*(le=Y.pixel_size>>3),ue&&(ae=se.subarray(Z,Z+=Y.colormap_length*(Y.colormap_size>>3))),$){ve=new Uint8Array(_e);for(var pe,he,ce,Te=0,be=new Uint8Array(le);Te<_e;)if(he=1+(127&(pe=se[Z++])),128&pe){for(ce=0;ce<le;++ce)be[ce]=se[Z++];for(ce=0;ce<he;++ce)ve.set(be,Te+ce*le);Te+=le*he}else{for(he*=le,ce=0;ce<he;++ce)ve[Te+ce]=se[Z++];Te+=he}}else ve=se.subarray(Z,Z+=ue?Y.width*Y.height:_e);return{pixel_data:ve,palettes:ae}}(k,U,J,te,j);return function($,ue,Y,Z,se){var ve,le,_e,ae,pe,he;switch((48&J.flags)>>4){default:case 2:ve=0,_e=1,pe=ue,le=0,ae=1,he=Y;break;case 0:ve=0,_e=1,pe=ue,le=Y-1,ae=-1,he=-1;break;case 3:ve=ue-1,_e=-1,pe=-1,le=0,ae=1,he=Y;break;case 1:ve=ue-1,_e=-1,pe=-1,le=Y-1,ae=-1,he=-1}if(K)switch(J.pixel_size){case 8:!function($,ue,Y,Z,se,ve,le,_e){var ae,he,ce,pe=0,Te=J.width;for(ce=ue;ce!==Z;ce+=Y)for(he=se;he!==le;he+=ve,pe++)$[4*(he+Te*ce)+0]=ae=_e[pe],$[4*(he+Te*ce)+1]=ae,$[4*(he+Te*ce)+2]=ae,$[4*(he+Te*ce)+3]=255}($,le,ae,he,ve,_e,pe,Z);break;case 16:!function($,ue,Y,Z,se,ve,le,_e){var pe,he,ae=0,ce=J.width;for(he=ue;he!==Z;he+=Y)for(pe=se;pe!==le;pe+=ve,ae+=2)$[4*(pe+ce*he)+0]=_e[ae+0],$[4*(pe+ce*he)+1]=_e[ae+0],$[4*(pe+ce*he)+2]=_e[ae+0],$[4*(pe+ce*he)+3]=_e[ae+1]}($,le,ae,he,ve,_e,pe,Z);break;default:console.error("TGALoader: Format not supported.")}else switch(J.pixel_size){case 8:!function($,ue,Y,Z,se,ve,le,_e,ae){var he,Te,be,pe=ae,ce=0,xe=J.width;for(be=ue;be!==Z;be+=Y)for(Te=se;Te!==le;Te+=ve,ce++)he=_e[ce],$[4*(Te+xe*be)+3]=255,$[4*(Te+xe*be)+2]=pe[3*he+0],$[4*(Te+xe*be)+1]=pe[3*he+1],$[4*(Te+xe*be)+0]=pe[3*he+2]}($,le,ae,he,ve,_e,pe,Z,se);break;case 16:!function($,ue,Y,Z,se,ve,le,_e){var ae,he,ce,pe=0,Te=J.width;for(ce=ue;ce!==Z;ce+=Y)for(he=se;he!==le;he+=ve,pe+=2)$[4*(he+Te*ce)+0]=(31744&(ae=_e[pe+0]+(_e[pe+1]<<8)))>>7,$[4*(he+Te*ce)+1]=(992&ae)>>2,$[4*(he+Te*ce)+2]=(31&ae)>>3,$[4*(he+Te*ce)+3]=32768&ae?0:255}($,le,ae,he,ve,_e,pe,Z);break;case 24:!function($,ue,Y,Z,se,ve,le,_e){var pe,he,ae=0,ce=J.width;for(he=ue;he!==Z;he+=Y)for(pe=se;pe!==le;pe+=ve,ae+=3)$[4*(pe+ce*he)+3]=255,$[4*(pe+ce*he)+2]=_e[ae+0],$[4*(pe+ce*he)+1]=_e[ae+1],$[4*(pe+ce*he)+0]=_e[ae+2]}($,le,ae,he,ve,_e,pe,Z);break;case 32:!function($,ue,Y,Z,se,ve,le,_e){var pe,he,ae=0,ce=J.width;for(he=ue;he!==Z;he+=Y)for(pe=se;pe!==le;pe+=ve,ae+=4)$[4*(pe+ce*he)+2]=_e[ae+0],$[4*(pe+ce*he)+1]=_e[ae+1],$[4*(pe+ce*he)+0]=_e[ae+2],$[4*(pe+ce*he)+3]=_e[ae+3]}($,le,ae,he,ve,_e,pe,Z);break;default:console.error("TGALoader: Format not supported.")}}(me.data,J.width,J.height,fe.pixel_data,fe.palettes),oe.putImageData(me,0,0),ee?Q.transferToImageBitmap():Q}}),Node.prototype={constructor:Node,isNode:!0,analyze:function(e,a){a=a||{},e.analyzing=!0,this.build(e.addFlow(a.slot,a.cache,a.context),"v4"),e.clearVertexNodeCode(),e.clearFragmentNodeCode(),e.removeFlow(),e.analyzing=!1},analyzeAndFlow:function(e,a,d){return this.analyze(e,d=d||{}),this.flow(e,a,d)},flow:function(e,a,d){e.addFlow((d=d||{}).slot,d.cache,d.context);var v={};return v.result=this.build(e,a),v.code=e.clearNodeCode(),v.extra=e.context.extra,e.removeFlow(),v},build:function(e,a,d){a=a||this.getType(e,a);var v=e.getNodeData(d||this);return e.analyzing&&this.appendDepsNode(e,v,a),-1===e.nodes.indexOf(this)&&e.nodes.push(this),void 0!==this.updateFrame&&-1===e.updaters.indexOf(this)&&e.updaters.push(this),this.generate(e,a,d)},generate:function(){},appendDepsNode:function(e,a,d){a.deps=(a.deps||0)+1;var v=e.getTypeLength(d);(v>(a.outputMax||0)||this.getType(e,d))&&(a.outputMax=v,a.output=d)},setName:function(e){return this.name=e,this},getName:function(){return this.name},getType:function(e,a){return"sampler2D"===a||"samplerCube"===a?a:this.type},getJSONNode:function(e){if(void 0!==e&&"string"!=typeof e&&void 0!==e.nodes[this.uuid])return e.nodes[this.uuid]},copy:function(e){return void 0!==e.name&&(this.name=e.name),void 0!==e.userData&&(this.userData=JSON.parse(JSON.stringify(e.userData))),this},createJSONNode:function(e){var a=void 0===e||"string"==typeof e,d={};if("string"!=typeof this.nodeType)throw new Error("Node does not allow serialization.");return d.uuid=this.uuid,d.nodeType=this.nodeType,""!==this.name&&(d.name=this.name),"{}"!==JSON.stringify(this.userData)&&(d.userData=this.userData),a||(e.nodes[this.uuid]=d),d},toJSON:function(e){return this.getJSONNode(e)||this.createJSONNode(e)}};var ColladaLoader=function(e){Loader.call(this,e)};function CompressedTextureLoader(s){Loader.call(this,s)}ColladaLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:ColladaLoader,load:function(e,a,d,v){var g=this,C=""===g.path?LoaderUtils.extractUrlBase(e):g.path,w=new FileLoader(g.manager);w.setPath(g.path),w.load(e,function(_){a(g.parse(_,C))},d,v)},options:{set convertUpAxis(s){console.warn("ColladaLoader: options.convertUpAxis() has been removed. Up axis is converted automatically.")}},parse:function(e,a){function d(Pe,Oe){for(var Ve=[],We=Pe.childNodes,Ue=0,dt=We.length;Ue<dt;Ue++){var Ft=We[Ue];Ft.nodeName===Oe&&Ve.push(Ft)}return Ve}function v(Pe){if(0===Pe.length)return[];for(var Oe=Pe.trim().split(/\s+/),Ve=new Array(Oe.length),We=0,Ue=Oe.length;We<Ue;We++)Ve[We]=Oe[We];return Ve}function g(Pe){if(0===Pe.length)return[];for(var Oe=Pe.trim().split(/\s+/),Ve=new Array(Oe.length),We=0,Ue=Oe.length;We<Ue;We++)Ve[We]=parseFloat(Oe[We]);return Ve}function C(Pe){if(0===Pe.length)return[];for(var Oe=Pe.trim().split(/\s+/),Ve=new Array(Oe.length),We=0,Ue=Oe.length;We<Ue;We++)Ve[We]=parseInt(Oe[We]);return Ve}function w(Pe){return Pe.substring(1)}function x(Pe){return 0===Object.keys(Pe).length}function R(Pe,Oe,Ve,We){var Ue=d(Pe,Oe)[0];if(void 0!==Ue)for(var dt=d(Ue,Ve),Ft=0;Ft<dt.length;Ft++)We(dt[Ft])}function O(Pe,Oe){for(var Ve in Pe)Pe[Ve].build=Oe(Pe[Ve])}function D(Pe,Oe){return void 0!==Pe.build||(Pe.build=Oe(Pe)),Pe.build}function L(Pe){for(var Oe={inputs:{}},Ve=0,We=Pe.childNodes.length;Ve<We;Ve++){var Ue=Pe.childNodes[Ve];if(1===Ue.nodeType&&"input"===Ue.nodeName){var dt=w(Ue.getAttribute("source")),Ft=Ue.getAttribute("semantic");Oe.inputs[Ft]=dt}}return Oe}function I(Pe){var Oe={},We=Pe.getAttribute("target").split("/"),Ue=We.shift(),dt=We.shift(),Ft=-1!==dt.indexOf("("),Nt=-1!==dt.indexOf(".");if(Nt)We=dt.split("."),dt=We.shift(),Oe.member=We.shift();else if(Ft){var rr=dt.split("(");dt=rr.shift();for(var Qt=0;Qt<rr.length;Qt++)rr[Qt]=parseInt(rr[Qt].replace(/\)/,""));Oe.indices=rr}return Oe.id=Ue,Oe.sid=dt,Oe.arraySyntax=Ft,Oe.memberSyntax=Nt,Oe.sampler=w(Pe.getAttribute("source")),Oe}function V(Pe){var Oe=[],Ve=Pe.channels,We=Pe.samplers,Ue=Pe.sources;for(var dt in Ve)if(Ve.hasOwnProperty(dt)){var Ft=Ve[dt],Nt=We[Ft.sampler];J(H(Ft,Ue[Nt.inputs.INPUT],Ue[Nt.inputs.OUTPUT]),Oe)}return Oe}function z(Pe){return D(hr.animations[Pe],V)}function H(Pe,Oe,Ve){var Nt,rr,Qt,Ht,Tr,mn,We=hr.nodes[Pe.id],Ue=Ye(We.id),dt=We.transforms[Pe.sid],Ft=We.matrix.clone().transpose(),tr={};switch(dt){case"matrix":for(Qt=0,Ht=Oe.array.length;Qt<Ht;Qt++)if(rr=Qt*Ve.stride,void 0===tr[Nt=Oe.array[Qt]]&&(tr[Nt]={}),!0===Pe.arraySyntax)tr[Nt][Pe.indices[0]+4*Pe.indices[1]]=Ve.array[rr];else for(Tr=0,mn=Ve.stride;Tr<mn;Tr++)tr[Nt][Tr]=Ve.array[rr+Tr];break;case"translate":case"rotate":case"scale":console.warn('ColladaLoader: Animation transform type "%s" not yet implemented.',dt)}var Or=function(Pe,Oe){var Ve=[];for(var We in Pe)Ve.push({time:parseFloat(We),value:Pe[We]});Ve.sort(function(Ft,Nt){return Ft.time-Nt.time});for(var Ue=0;Ue<16;Ue++)k(Ve,Ue,Oe.elements[Ue]);return Ve}(tr,Ft);return{name:Ue.uuid,keyframes:Or}}var re=new Vector3,j=new Vector3,te=new Quaternion;function J(Pe,Oe){for(var Ve=Pe.keyframes,We=Pe.name,Ue=[],dt=[],Ft=[],Nt=[],rr=0,Qt=Ve.length;rr<Qt;rr++){var Ht=Ve[rr],Tr=Ht.time;xt.fromArray(Ht.value).transpose(),xt.decompose(re,te,j),Ue.push(Tr),dt.push(re.x,re.y,re.z),Ft.push(te.x,te.y,te.z,te.w),Nt.push(j.x,j.y,j.z)}return dt.length>0&&Oe.push(new VectorKeyframeTrack(We+".position",Ue,dt)),Ft.length>0&&Oe.push(new QuaternionKeyframeTrack(We+".quaternion",Ue,Ft)),Nt.length>0&&Oe.push(new VectorKeyframeTrack(We+".scale",Ue,Nt)),Oe}function k(Pe,Oe,Ve){var We,dt,Ft,Ue=!0;for(dt=0,Ft=Pe.length;dt<Ft;dt++)void 0===(We=Pe[dt]).value[Oe]?We.value[Oe]=null:Ue=!1;if(!0===Ue)for(dt=0,Ft=Pe.length;dt<Ft;dt++)(We=Pe[dt]).value[Oe]=Ve;else!function(Pe,Oe){for(var Ve,We,Ue=0,dt=Pe.length;Ue<dt;Ue++){var Ft=Pe[Ue];if(null===Ft.value[Oe]){if(Ve=K(Pe,Ue,Oe),We=ee(Pe,Ue,Oe),null===Ve){Ft.value[Oe]=We.value[Oe];continue}if(null===We){Ft.value[Oe]=Ve.value[Oe];continue}Q(Ft,Ve,We,Oe)}}}(Pe,Oe)}function K(Pe,Oe,Ve){for(;Oe>=0;){var We=Pe[Oe];if(null!==We.value[Ve])return We;Oe--}return null}function ee(Pe,Oe,Ve){for(;Oe<Pe.length;){var We=Pe[Oe];if(null!==We.value[Ve])return We;Oe++}return null}function Q(Pe,Oe,Ve,We){Pe.value[We]=Ve.time-Oe.time!=0?(Pe.time-Oe.time)*(Ve.value[We]-Oe.value[We])/(Ve.time-Oe.time)+Oe.value[We]:Oe.value[We]}function me(Pe){for(var Oe=[],Ve=Pe.name,We=Pe.end-Pe.start||-1,Ue=Pe.animations,dt=0,Ft=Ue.length;dt<Ft;dt++)for(var Nt=z(Ue[dt]),rr=0,Qt=Nt.length;rr<Qt;rr++)Oe.push(Nt[rr]);return new AnimationClip(Ve,We,Oe)}function fe(Pe){return D(hr.clips[Pe],me)}function $(Pe){for(var Oe={sources:{}},Ve=0,We=Pe.childNodes.length;Ve<We;Ve++){var Ue=Pe.childNodes[Ve];if(1===Ue.nodeType)switch(Ue.nodeName){case"bind_shape_matrix":Oe.bindShapeMatrix=g(Ue.textContent);break;case"source":var dt=Ue.getAttribute("id");Oe.sources[dt]=Ar(Ue);break;case"joints":Oe.joints=ue(Ue);break;case"vertex_weights":Oe.vertexWeights=Y(Ue)}}return Oe}function ue(Pe){for(var Oe={inputs:{}},Ve=0,We=Pe.childNodes.length;Ve<We;Ve++){var Ue=Pe.childNodes[Ve];if(1===Ue.nodeType&&"input"===Ue.nodeName){var dt=Ue.getAttribute("semantic"),Ft=w(Ue.getAttribute("source"));Oe.inputs[dt]=Ft}}return Oe}function Y(Pe){for(var Oe={inputs:{}},Ve=0,We=Pe.childNodes.length;Ve<We;Ve++){var Ue=Pe.childNodes[Ve];if(1===Ue.nodeType)switch(Ue.nodeName){case"input":var dt=Ue.getAttribute("semantic"),Ft=w(Ue.getAttribute("source")),Nt=parseInt(Ue.getAttribute("offset"));Oe.inputs[dt]={id:Ft,offset:Nt};break;case"vcount":Oe.vcount=C(Ue.textContent);break;case"v":Oe.v=C(Ue.textContent)}}return Oe}function Z(Pe){var Oe={id:Pe.id},Ve=hr.geometries[Oe.id];return void 0!==Pe.skin&&(Oe.skin=function(Pe){var tr,Zr,Vr,Ve={joints:[],indices:{array:[],stride:4},weights:{array:[],stride:4}},Ue=Pe.vertexWeights,dt=Ue.vcount,Ft=Ue.v,Nt=Ue.inputs.JOINT.offset,rr=Ue.inputs.WEIGHT.offset,Qt=Pe.sources[Pe.joints.inputs.JOINT],Ht=Pe.sources[Pe.joints.inputs.INV_BIND_MATRIX],Tr=Pe.sources[Ue.inputs.WEIGHT.id].array,mn=0;for(tr=0,Vr=dt.length;tr<Vr;tr++){var Or=dt[tr],Kr=[];for(Zr=0;Zr<Or;Zr++)Kr.push({index:Ft[mn+Nt],weight:Tr[Ft[mn+rr]]}),mn+=2;for(Kr.sort(Ti),Zr=0;Zr<4;Zr++){var pn=Kr[Zr];void 0!==pn?(Ve.indices.array.push(pn.index),Ve.weights.array.push(pn.weight)):(Ve.indices.array.push(0),Ve.weights.array.push(0))}}for(Ve.bindMatrix=Pe.bindShapeMatrix?(new Matrix4).fromArray(Pe.bindShapeMatrix).transpose():(new Matrix4).identity(),tr=0,Vr=Qt.array.length;tr<Vr;tr++){var _o=Qt.array[tr],En=(new Matrix4).fromArray(Ht.array,tr*Ht.stride).transpose();Ve.joints.push({name:_o,boneInverse:En})}return Ve;function Ti(Ii,Ff){return Ff.weight-Ii.weight}}(Pe.skin),Ve.sources.skinIndices=Oe.skin.indices,Ve.sources.skinWeights=Oe.skin.weights),Oe}function ve(Pe){return D(hr.controllers[Pe],Z)}function _e(Pe){return void 0!==Pe.build?Pe.build:Pe.init_from}function ae(Pe){var Oe=hr.images[Pe];return void 0!==Oe?D(Oe,_e):(console.warn("ColladaLoader: Couldn't find image with ID:",Pe),null)}function he(Pe){for(var Oe={surfaces:{},samplers:{}},Ve=0,We=Pe.childNodes.length;Ve<We;Ve++){var Ue=Pe.childNodes[Ve];if(1===Ue.nodeType)switch(Ue.nodeName){case"newparam":ce(Ue,Oe);break;case"technique":Oe.technique=xe(Ue);break;case"extra":Oe.extra=$e(Ue)}}return Oe}function ce(Pe,Oe){for(var Ve=Pe.getAttribute("sid"),We=0,Ue=Pe.childNodes.length;We<Ue;We++){var dt=Pe.childNodes[We];if(1===dt.nodeType)switch(dt.nodeName){case"surface":Oe.surfaces[Ve]=Te(dt);break;case"sampler2D":Oe.samplers[Ve]=be(dt)}}}function Te(Pe){for(var Oe={},Ve=0,We=Pe.childNodes.length;Ve<We;Ve++){var Ue=Pe.childNodes[Ve];1===Ue.nodeType&&"init_from"===Ue.nodeName&&(Oe.init_from=Ue.textContent)}return Oe}function be(Pe){for(var Oe={},Ve=0,We=Pe.childNodes.length;Ve<We;Ve++){var Ue=Pe.childNodes[Ve];1===Ue.nodeType&&"source"===Ue.nodeName&&(Oe.source=Ue.textContent)}return Oe}function xe(Pe){for(var Oe={},Ve=0,We=Pe.childNodes.length;Ve<We;Ve++){var Ue=Pe.childNodes[Ve];if(1===Ue.nodeType)switch(Ue.nodeName){case"constant":case"lambert":case"blinn":case"phong":Oe.type=Ue.nodeName,Oe.parameters=we(Ue)}}return Oe}function we(Pe){for(var Oe={},Ve=0,We=Pe.childNodes.length;Ve<We;Ve++){var Ue=Pe.childNodes[Ve];if(1===Ue.nodeType)switch(Ue.nodeName){case"emission":case"diffuse":case"specular":case"bump":case"ambient":case"shininess":case"transparency":Oe[Ue.nodeName]=Ne(Ue);break;case"transparent":Oe[Ue.nodeName]={opaque:Ue.getAttribute("opaque"),data:Ne(Ue)}}}return Oe}function Ne(Pe){for(var Oe={},Ve=0,We=Pe.childNodes.length;Ve<We;Ve++){var Ue=Pe.childNodes[Ve];if(1===Ue.nodeType)switch(Ue.nodeName){case"color":Oe[Ue.nodeName]=g(Ue.textContent);break;case"float":Oe[Ue.nodeName]=parseFloat(Ue.textContent);break;case"texture":Oe[Ue.nodeName]={id:Ue.getAttribute("texture"),extra:Re(Ue)}}}return Oe}function Re(Pe){for(var Oe={technique:{}},Ve=0,We=Pe.childNodes.length;Ve<We;Ve++){var Ue=Pe.childNodes[Ve];1===Ue.nodeType&&"extra"===Ue.nodeName&&De(Ue,Oe)}return Oe}function De(Pe,Oe){for(var Ve=0,We=Pe.childNodes.length;Ve<We;Ve++){var Ue=Pe.childNodes[Ve];1===Ue.nodeType&&"technique"===Ue.nodeName&&Je(Ue,Oe)}}function Je(Pe,Oe){for(var Ve=0,We=Pe.childNodes.length;Ve<We;Ve++){var Ue=Pe.childNodes[Ve];if(1===Ue.nodeType)switch(Ue.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":Oe.technique[Ue.nodeName]=parseFloat(Ue.textContent);break;case"wrapU":case"wrapV":Oe.technique[Ue.nodeName]="TRUE"===Ue.textContent.toUpperCase()?1:"FALSE"===Ue.textContent.toUpperCase()?0:parseInt(Ue.textContent)}}}function $e(Pe){for(var Oe={},Ve=0,We=Pe.childNodes.length;Ve<We;Ve++){var Ue=Pe.childNodes[Ve];1===Ue.nodeType&&"technique"===Ue.nodeName&&(Oe.technique=pt(Ue))}return Oe}function pt(Pe){for(var Oe={},Ve=0,We=Pe.childNodes.length;Ve<We;Ve++){var Ue=Pe.childNodes[Ve];1===Ue.nodeType&&"double_sided"===Ue.nodeName&&(Oe[Ue.nodeName]=parseInt(Ue.textContent))}return Oe}function ut(Pe){return Pe}function lt(Pe){var Ue,Oe=function(Pe){return D(hr.effects[Pe],ut)}(Pe.url),Ve=Oe.profile.technique,We=Oe.profile.extra;switch(Ve.type){case"phong":case"blinn":Ue=new MeshPhongMaterial;break;case"lambert":Ue=new MeshLambertMaterial;break;default:Ue=new MeshBasicMaterial}function dt(mn){var tr=Oe.profile.samplers[mn.id],Zr=null;if(void 0!==tr?Zr=ae(Oe.profile.surfaces[tr.source].init_from):(console.warn("ColladaLoader: Undefined sampler. Access image directly (see #12530)."),Zr=ae(mn.id)),null!==Zr){var Or=function(Pe){var Ve=Pe.slice(2+(Pe.lastIndexOf(".")-1>>>0));return"tga"===(Ve=Ve.toLowerCase())?zn:fn}(Zr);if(void 0!==Or){var Kr=Or.load(Zr),On=mn.extra;if(void 0!==On&&void 0!==On.technique&&!1===x(On.technique)){var cr=On.technique;Kr.wrapS=cr.wrapU?RepeatWrapping:ClampToEdgeWrapping,Kr.wrapT=cr.wrapV?RepeatWrapping:ClampToEdgeWrapping,Kr.offset.set(cr.offsetU||0,cr.offsetV||0),Kr.repeat.set(cr.repeatU||1,cr.repeatV||1)}else Kr.wrapS=RepeatWrapping,Kr.wrapT=RepeatWrapping;return Kr}return console.warn("ColladaLoader: Loader for texture %s not found.",Zr),null}return console.warn("ColladaLoader: Couldn't create texture with ID:",mn.id),null}Ue.name=Pe.name||"";var Ft=Ve.parameters;for(var Nt in Ft){var rr=Ft[Nt];switch(Nt){case"diffuse":rr.color&&Ue.color.fromArray(rr.color),rr.texture&&(Ue.map=dt(rr.texture));break;case"specular":rr.color&&Ue.specular&&Ue.specular.fromArray(rr.color),rr.texture&&(Ue.specularMap=dt(rr.texture));break;case"bump":rr.texture&&(Ue.normalMap=dt(rr.texture));break;case"ambient":rr.texture&&(Ue.lightMap=dt(rr.texture));break;case"shininess":rr.float&&Ue.shininess&&(Ue.shininess=rr.float);break;case"emission":rr.color&&Ue.emissive&&Ue.emissive.fromArray(rr.color),rr.texture&&(Ue.emissiveMap=dt(rr.texture))}}var Qt=Ft.transparent,Ht=Ft.transparency;if(void 0===Ht&&Qt&&(Ht={float:1}),void 0===Qt&&Ht&&(Qt={opaque:"A_ONE",data:{color:[1,1,1,1]}}),Qt&&Ht)if(Qt.data.texture)Ue.transparent=!0;else{var Tr=Qt.data.color;switch(Qt.opaque){case"A_ONE":Ue.opacity=Tr[3]*Ht.float;break;case"RGB_ZERO":Ue.opacity=1-Tr[0]*Ht.float;break;case"A_ZERO":Ue.opacity=1-Tr[3]*Ht.float;break;case"RGB_ONE":Ue.opacity=Tr[0]*Ht.float;break;default:console.warn('ColladaLoader: Invalid opaque type "%s" of transparent tag.',Qt.opaque)}Ue.opacity<1&&(Ue.transparent=!0)}return void 0!==We&&void 0!==We.technique&&1===We.technique.double_sided&&(Ue.side=DoubleSide),Ue}function ot(Pe){return D(hr.materials[Pe],lt)}function ft(Pe){for(var Oe=0;Oe<Pe.childNodes.length;Oe++){var Ve=Pe.childNodes[Oe];if("technique_common"===Ve.nodeName)return He(Ve)}return{}}function He(Pe){for(var Oe={},Ve=0;Ve<Pe.childNodes.length;Ve++){var We=Pe.childNodes[Ve];switch(We.nodeName){case"perspective":case"orthographic":Oe.technique=We.nodeName,Oe.parameters=gt(We)}}return Oe}function gt(Pe){for(var Oe={},Ve=0;Ve<Pe.childNodes.length;Ve++){var We=Pe.childNodes[Ve];switch(We.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":Oe[We.nodeName]=parseFloat(We.textContent)}}return Oe}function vt(Pe){var Oe;switch(Pe.optics.technique){case"perspective":Oe=new PerspectiveCamera(Pe.optics.parameters.yfov,Pe.optics.parameters.aspect_ratio,Pe.optics.parameters.znear,Pe.optics.parameters.zfar);break;case"orthographic":var Ve=Pe.optics.parameters.ymag,We=Pe.optics.parameters.xmag,Ue=Pe.optics.parameters.aspect_ratio;We=void 0===We?Ve*Ue:We,Ve=void 0===Ve?We/Ue:Ve,Oe=new OrthographicCamera(-(We*=.5),We,Ve*=.5,-Ve,Pe.optics.parameters.znear,Pe.optics.parameters.zfar);break;default:Oe=new PerspectiveCamera}return Oe.name=Pe.name||"",Oe}function Gt(Pe){var Oe=hr.cameras[Pe];return void 0!==Oe?D(Oe,vt):(console.warn("ColladaLoader: Couldn't find camera with ID:",Pe),null)}function yt(Pe){for(var Oe={},Ve=0,We=Pe.childNodes.length;Ve<We;Ve++){var Ue=Pe.childNodes[Ve];if(1===Ue.nodeType)switch(Ue.nodeName){case"directional":case"point":case"spot":case"ambient":Oe.technique=Ue.nodeName,Oe.parameters=xr(Ue)}}return Oe}function xr(Pe){for(var Oe={},Ve=0,We=Pe.childNodes.length;Ve<We;Ve++){var Ue=Pe.childNodes[Ve];if(1===Ue.nodeType)switch(Ue.nodeName){case"color":var dt=g(Ue.textContent);Oe.color=(new Color).fromArray(dt);break;case"falloff_angle":Oe.falloffAngle=parseFloat(Ue.textContent);break;case"quadratic_attenuation":var Ft=parseFloat(Ue.textContent);Oe.distance=Ft?Math.sqrt(1/Ft):0}}return Oe}function Dr(Pe){var Oe;switch(Pe.technique){case"directional":Oe=new DirectionalLight;break;case"point":Oe=new PointLight;break;case"spot":Oe=new SpotLight;break;case"ambient":Oe=new AmbientLight}return Pe.parameters.color&&Oe.color.copy(Pe.parameters.color),Pe.parameters.distance&&(Oe.distance=Pe.parameters.distance),Oe}function Ur(Pe){var Oe=hr.lights[Pe];return void 0!==Oe?D(Oe,Dr):(console.warn("ColladaLoader: Couldn't find light with ID:",Pe),null)}function Ar(Pe){for(var Oe={array:[],stride:3},Ve=0;Ve<Pe.childNodes.length;Ve++){var We=Pe.childNodes[Ve];if(1===We.nodeType)switch(We.nodeName){case"float_array":Oe.array=g(We.textContent);break;case"Name_array":Oe.array=v(We.textContent);break;case"technique_common":var Ue=d(We,"accessor")[0];void 0!==Ue&&(Oe.stride=parseInt(Ue.getAttribute("stride")))}}return Oe}function hn(Pe){for(var Oe={},Ve=0;Ve<Pe.childNodes.length;Ve++){var We=Pe.childNodes[Ve];1===We.nodeType&&(Oe[We.getAttribute("semantic")]=w(We.getAttribute("source")))}return Oe}function Sn(Pe){for(var Oe={type:Pe.nodeName,material:Pe.getAttribute("material"),count:parseInt(Pe.getAttribute("count")),inputs:{},stride:0,hasUV:!1},Ve=0,We=Pe.childNodes.length;Ve<We;Ve++){var Ue=Pe.childNodes[Ve];if(1===Ue.nodeType)switch(Ue.nodeName){case"input":var dt=w(Ue.getAttribute("source")),Ft=Ue.getAttribute("semantic"),Nt=parseInt(Ue.getAttribute("offset")),rr=parseInt(Ue.getAttribute("set"));Oe.inputs[rr>0?Ft+rr:Ft]={id:dt,offset:Nt},Oe.stride=Math.max(Oe.stride,Nt+1),"TEXCOORD"===Ft&&(Oe.hasUV=!0);break;case"vcount":Oe.vcount=C(Ue.textContent);break;case"p":Oe.p=C(Ue.textContent)}}return Oe}function An(Pe){for(var Oe=0,Ve=0,We=Pe.length;Ve<We;Ve++)!0===Pe[Ve].hasUV&&Oe++;Oe>0&&Oe<Pe.length&&(Pe.uvsNeedsFix=!0)}function jr(Pe){var Oe={},Ve=Pe.sources,We=Pe.vertices,Ue=Pe.primitives;if(0===Ue.length)return{};var dt=function(Pe){for(var Oe={},Ve=0;Ve<Pe.length;Ve++){var We=Pe[Ve];void 0===Oe[We.type]&&(Oe[We.type]=[]),Oe[We.type].push(We)}return Oe}(Ue);for(var Ft in dt){var Nt=dt[Ft];An(Nt),Oe[Ft]=cn(Nt,Ve,We)}return Oe}function cn(Pe,Oe,Ve){for(var We={},Ue={array:[],stride:0},dt={array:[],stride:0},Ft={array:[],stride:0},Nt={array:[],stride:0},rr={array:[],stride:0},Qt={array:[],stride:4},Ht={array:[],stride:4},Tr=new BufferGeometry,mn=[],tr=0,Zr=0;Zr<Pe.length;Zr++){var Vr=Pe[Zr],Or=Vr.inputs,Kr=0;switch(Vr.type){case"lines":case"linestrips":Kr=2*Vr.count;break;case"triangles":Kr=3*Vr.count;break;case"polylist":for(var On=0;On<Vr.count;On++){var cr=Vr.vcount[On];switch(cr){case 3:Kr+=3;break;case 4:Kr+=6;break;default:Kr+=3*(cr-2)}}break;default:console.warn("ColladaLoader: Unknow primitive type:",Vr.type)}for(var $r in Tr.addGroup(tr,Kr,Zr),tr+=Kr,Vr.material&&mn.push(Vr.material),Or){var pn=Or[$r];switch($r){case"VERTEX":for(var _o in Ve){var En=Ve[_o];switch(_o){case"POSITION":var Ti=Ue.array.length;if(Fn(Vr,Oe[En],pn.offset,Ue.array),Ue.stride=Oe[En].stride,Oe.skinWeights&&Oe.skinIndices&&(Fn(Vr,Oe.skinIndices,pn.offset,Qt.array),Fn(Vr,Oe.skinWeights,pn.offset,Ht.array)),!1===Vr.hasUV&&!0===Pe.uvsNeedsFix){Kr=(Ue.array.length-Ti)/Ue.stride;for(var Ii=0;Ii<Kr;Ii++)Ft.array.push(0,0)}break;case"NORMAL":Fn(Vr,Oe[En],pn.offset,dt.array),dt.stride=Oe[En].stride;break;case"COLOR":Fn(Vr,Oe[En],pn.offset,rr.array),rr.stride=Oe[En].stride;break;case"TEXCOORD":Fn(Vr,Oe[En],pn.offset,Ft.array),Ft.stride=Oe[En].stride;break;case"TEXCOORD1":Fn(Vr,Oe[En],pn.offset,Nt.array),Ft.stride=Oe[En].stride;break;default:console.warn('ColladaLoader: Semantic "%s" not handled in geometry build process.',_o)}}break;case"NORMAL":Fn(Vr,Oe[pn.id],pn.offset,dt.array),dt.stride=Oe[pn.id].stride;break;case"COLOR":Fn(Vr,Oe[pn.id],pn.offset,rr.array),rr.stride=Oe[pn.id].stride;break;case"TEXCOORD":Fn(Vr,Oe[pn.id],pn.offset,Ft.array),Ft.stride=Oe[pn.id].stride;break;case"TEXCOORD1":Fn(Vr,Oe[pn.id],pn.offset,Nt.array),Nt.stride=Oe[pn.id].stride}}}return Ue.array.length>0&&Tr.setAttribute("position",new Float32BufferAttribute(Ue.array,Ue.stride)),dt.array.length>0&&Tr.setAttribute("normal",new Float32BufferAttribute(dt.array,dt.stride)),rr.array.length>0&&Tr.setAttribute("color",new Float32BufferAttribute(rr.array,rr.stride)),Ft.array.length>0&&Tr.setAttribute("uv",new Float32BufferAttribute(Ft.array,Ft.stride)),Nt.array.length>0&&Tr.setAttribute("uv2",new Float32BufferAttribute(Nt.array,Nt.stride)),Qt.array.length>0&&Tr.setAttribute("skinIndex",new Float32BufferAttribute(Qt.array,Qt.stride)),Ht.array.length>0&&Tr.setAttribute("skinWeight",new Float32BufferAttribute(Ht.array,Ht.stride)),We.data=Tr,We.type=Pe[0].type,We.materialKeys=mn,We}function Fn(Pe,Oe,Ve,We){var Ue=Pe.p,dt=Pe.stride,Ft=Pe.vcount;function Nt($r){for(var pn=Ue[$r+Ve]*Qt,_o=pn+Qt;pn<_o;pn++)We.push(rr[pn])}var rr=Oe.array,Qt=Oe.stride;if(void 0!==Pe.vcount)for(var Ht=0,Tr=0,mn=Ft.length;Tr<mn;Tr++){var tr=Ft[Tr];if(4===tr){var Vr=Ht+1*dt,Or=Ht+2*dt,Kr=Ht+3*dt;Nt(Ht+0*dt),Nt(Vr),Nt(Kr),Nt(Vr),Nt(Or),Nt(Kr)}else if(3===tr)Vr=Ht+1*dt,Or=Ht+2*dt,Nt(Ht+0*dt),Nt(Vr),Nt(Or);else if(tr>4)for(var On=1,cr=tr-2;On<=cr;On++)Vr=Ht+dt*On,Or=Ht+dt*(On+1),Nt(Ht+0*dt),Nt(Vr),Nt(Or);Ht+=dt*tr}else for(Tr=0,mn=Ue.length;Tr<mn;Tr+=dt)Nt(Tr)}function yi(Pe){return D(hr.geometries[Pe],jr)}function ro(Pe){return void 0!==Pe.build?Pe.build:Pe}function Ln(Pe,Oe){for(var Ve=0;Ve<Pe.childNodes.length;Ve++){var We=Pe.childNodes[Ve];if(1===We.nodeType)switch(We.nodeName){case"joint":Oe.joints[We.getAttribute("sid")]=Kt(We);break;case"link":Oe.links.push(Nr(We))}}}function Kt(Pe){for(var Oe,Ve=0;Ve<Pe.childNodes.length;Ve++){var We=Pe.childNodes[Ve];if(1===We.nodeType)switch(We.nodeName){case"prismatic":case"revolute":Oe=Ee(We)}}return Oe}function Ee(Pe,Oe){Oe={sid:Pe.getAttribute("sid"),name:Pe.getAttribute("name")||"",axis:new Vector3,limits:{min:0,max:0},type:Pe.nodeName,static:!1,zeroPosition:0,middlePosition:0};for(var Ve=0;Ve<Pe.childNodes.length;Ve++){var We=Pe.childNodes[Ve];if(1===We.nodeType)switch(We.nodeName){case"axis":var Ue=g(We.textContent);Oe.axis.fromArray(Ue);break;case"limits":var dt=We.getElementsByTagName("max")[0],Ft=We.getElementsByTagName("min")[0];Oe.limits.max=parseFloat(dt.textContent),Oe.limits.min=parseFloat(Ft.textContent)}}return Oe.limits.min>=Oe.limits.max&&(Oe.static=!0),Oe.middlePosition=(Oe.limits.min+Oe.limits.max)/2,Oe}function Nr(Pe){for(var Oe={sid:Pe.getAttribute("sid"),name:Pe.getAttribute("name")||"",attachments:[],transforms:[]},Ve=0;Ve<Pe.childNodes.length;Ve++){var We=Pe.childNodes[Ve];if(1===We.nodeType)switch(We.nodeName){case"attachment_full":Oe.attachments.push(Kn(We));break;case"matrix":case"translate":case"rotate":Oe.transforms.push(Dn(We))}}return Oe}function Kn(Pe){for(var Oe={joint:Pe.getAttribute("joint").split("/").pop(),transforms:[],links:[]},Ve=0;Ve<Pe.childNodes.length;Ve++){var We=Pe.childNodes[Ve];if(1===We.nodeType)switch(We.nodeName){case"link":Oe.links.push(Nr(We));break;case"matrix":case"translate":case"rotate":Oe.transforms.push(Dn(We))}}return Oe}function Dn(Pe){var Oe={type:Pe.nodeName},Ve=g(Pe.textContent);switch(Oe.type){case"matrix":Oe.obj=new Matrix4,Oe.obj.fromArray(Ve).transpose();break;case"translate":Oe.obj=new Vector3,Oe.obj.fromArray(Ve);break;case"rotate":Oe.obj=new Vector3,Oe.obj.fromArray(Ve),Oe.angle=MathUtils.degToRad(Ve[3])}return Oe}function Wn(Pe,Oe){for(var Ve=0;Ve<Pe.childNodes.length;Ve++){var We=Pe.childNodes[Ve];1===We.nodeType&&"technique_common"===We.nodeName&&Ci(We,Oe)}}function Ci(Pe,Oe){for(var Ve=0;Ve<Pe.childNodes.length;Ve++){var We=Pe.childNodes[Ve];if(1===We.nodeType)switch(We.nodeName){case"inertia":Oe.inertia=g(We.textContent);break;case"mass":Oe.mass=g(We.textContent)[0]}}}function W(Pe){for(var Oe={target:Pe.getAttribute("target").split("/").pop()},Ve=0;Ve<Pe.childNodes.length;Ve++){var We=Pe.childNodes[Ve];if(1===We.nodeType&&"axis"===We.nodeName){var Ue=We.getElementsByTagName("param")[0];Oe.axis=Ue.textContent;var dt=Oe.axis.split("inst_").pop().split("axis")[0];Oe.jointIndex=dt.substr(0,dt.length-1)}}return Oe}function ne(Pe){return void 0!==Pe.build?Pe.build:Pe}function it(Pe){for(var Oe=[],Ve=$t.querySelector('[id="'+Pe.id+'"]'),We=0;We<Ve.childNodes.length;We++){var Ue=Ve.childNodes[We];if(1===Ue.nodeType)switch(Ue.nodeName){case"matrix":var dt=g(Ue.textContent),Ft=(new Matrix4).fromArray(dt).transpose();Oe.push({sid:Ue.getAttribute("sid"),type:Ue.nodeName,obj:Ft});break;case"translate":case"scale":dt=g(Ue.textContent);var Nt=(new Vector3).fromArray(dt);Oe.push({sid:Ue.getAttribute("sid"),type:Ue.nodeName,obj:Nt});break;case"rotate":dt=g(Ue.textContent),Nt=(new Vector3).fromArray(dt);var rr=MathUtils.degToRad(dt[3]);Oe.push({sid:Ue.getAttribute("sid"),type:Ue.nodeName,obj:Nt,angle:rr})}}return Oe}var xt=new Matrix4,kt=new Vector3;function ir(Pe){for(var Oe={name:Pe.getAttribute("name")||"",type:Pe.getAttribute("type"),id:Pe.getAttribute("id"),sid:Pe.getAttribute("sid"),matrix:new Matrix4,nodes:[],instanceCameras:[],instanceControllers:[],instanceLights:[],instanceGeometries:[],instanceNodes:[],transforms:{}},Ve=0;Ve<Pe.childNodes.length;Ve++){var We=Pe.childNodes[Ve];if(1===We.nodeType)switch(We.nodeName){case"node":Oe.nodes.push(We.getAttribute("id")),ir(We);break;case"instance_camera":Oe.instanceCameras.push(w(We.getAttribute("url")));break;case"instance_controller":Oe.instanceControllers.push(Cr(We));break;case"instance_light":Oe.instanceLights.push(w(We.getAttribute("url")));break;case"instance_geometry":Oe.instanceGeometries.push(Cr(We));break;case"instance_node":Oe.instanceNodes.push(w(We.getAttribute("url")));break;case"matrix":var Ue=g(We.textContent);Oe.matrix.multiply(xt.fromArray(Ue).transpose()),Oe.transforms[We.getAttribute("sid")]=We.nodeName;break;case"translate":Ue=g(We.textContent),kt.fromArray(Ue),Oe.matrix.multiply(xt.makeTranslation(kt.x,kt.y,kt.z)),Oe.transforms[We.getAttribute("sid")]=We.nodeName;break;case"rotate":Ue=g(We.textContent);var dt=MathUtils.degToRad(Ue[3]);Oe.matrix.multiply(xt.makeRotationAxis(kt.fromArray(Ue),dt)),Oe.transforms[We.getAttribute("sid")]=We.nodeName;break;case"scale":Ue=g(We.textContent),Oe.matrix.scale(kt.fromArray(Ue)),Oe.transforms[We.getAttribute("sid")]=We.nodeName;break;case"extra":break;default:console.log(We)}}return Be(Oe.id)?console.warn("ColladaLoader: There is already a node with ID %s. Exclude current node from further processing.",Oe.id):hr.nodes[Oe.id]=Oe,Oe}function Cr(Pe){for(var Oe={id:w(Pe.getAttribute("url")),materials:{},skeletons:[]},Ve=0;Ve<Pe.childNodes.length;Ve++){var We=Pe.childNodes[Ve];switch(We.nodeName){case"bind_material":for(var Ue=We.getElementsByTagName("instance_material"),dt=0;dt<Ue.length;dt++){var Ft=Ue[dt],Nt=Ft.getAttribute("symbol"),rr=Ft.getAttribute("target");Oe.materials[Nt]=w(rr)}break;case"skeleton":Oe.skeletons.push(w(We.textContent))}}return Oe}function Hr(Pe,Oe){var Ue,Ft,Ve=[],We=[];for(Ue=0;Ue<Pe.length;Ue++){var Nt=Pe[Ue];if(Be(Nt))Xr(Ye(Nt),Oe,Ve);else if(Et(Nt))for(var Ht=hr.visualScenes[Nt].children,dt=0;dt<Ht.length;dt++){var Tr=Ht[dt];"JOINT"===Tr.type&&Xr(Ye(Tr.id),Oe,Ve)}else console.error("ColladaLoader: Unable to find root bone of skeleton with ID:",Nt)}for(Ue=0;Ue<Oe.length;Ue++)for(dt=0;dt<Ve.length;dt++)if((Ft=Ve[dt]).bone.name===Oe[Ue].name){We[Ue]=Ft,Ft.processed=!0;break}for(Ue=0;Ue<Ve.length;Ue++)!1===(Ft=Ve[Ue]).processed&&(We.push(Ft),Ft.processed=!0);var mn=[],tr=[];for(Ue=0;Ue<We.length;Ue++)mn.push((Ft=We[Ue]).bone),tr.push(Ft.boneInverse);return new Skeleton(mn,tr)}function Xr(Pe,Oe,Ve){Pe.traverse(function(We){if(!0===We.isBone){for(var Ue,dt=0;dt<Oe.length;dt++){var Ft=Oe[dt];if(Ft.name===We.name){Ue=Ft.boneInverse;break}}void 0===Ue&&(Ue=new Matrix4),Ve.push({bone:We,boneInverse:Ue,processed:!1})}})}function kr(Pe){for(var Oe=[],Ve=Pe.matrix,We=Pe.nodes,Ue=Pe.type,dt=Pe.instanceCameras,Ft=Pe.instanceControllers,Nt=Pe.instanceLights,rr=Pe.instanceGeometries,Qt=Pe.instanceNodes,Ht=0,Tr=We.length;Ht<Tr;Ht++)Oe.push(Ye(We[Ht]));for(Ht=0,Tr=dt.length;Ht<Tr;Ht++){var mn=Gt(dt[Ht]);null!==mn&&Oe.push(mn.clone())}for(Ht=0,Tr=Ft.length;Ht<Tr;Ht++)for(var Zr=ve((tr=Ft[Ht]).id),Or=wi(yi(Zr.id),tr.materials),cr=Hr(tr.skeletons,Zr.skin.joints),$r=0,pn=Or.length;$r<pn;$r++)(En=Or[$r]).isSkinnedMesh&&(En.bind(cr,Zr.skin.bindMatrix),En.normalizeSkinWeights()),Oe.push(En);for(Ht=0,Tr=Nt.length;Ht<Tr;Ht++){var _o=Ur(Nt[Ht]);null!==_o&&Oe.push(_o.clone())}for(Ht=0,Tr=rr.length;Ht<Tr;Ht++){var tr;for($r=0,pn=(Or=wi(yi((tr=rr[Ht]).id),tr.materials)).length;$r<pn;$r++)Oe.push(Or[$r])}for(Ht=0,Tr=Qt.length;Ht<Tr;Ht++)Oe.push(Ye(Qt[Ht]).clone());var En;if(0===We.length&&1===Oe.length)En=Oe[0];else for(En="JOINT"===Ue?new Bone:new Group,Ht=0;Ht<Oe.length;Ht++)En.add(Oe[Ht]);return""===En.name&&(En.name="JOINT"===Ue?Pe.sid:Pe.name),En.matrix.copy(Ve),En.matrix.decompose(En.position,En.quaternion,En.scale),En}var fr=new MeshBasicMaterial({color:16711935});function Pr(Pe,Oe){for(var Ve=[],We=0,Ue=Pe.length;We<Ue;We++){var dt=Oe[Pe[We]];void 0===dt?(console.warn("ColladaLoader: Material with key %s not found. Apply fallback material.",Pe[We]),Ve.push(fr)):Ve.push(ot(dt))}return Ve}function wi(Pe,Oe){var Ve=[];for(var We in Pe){var Ue=Pe[We],dt=Pr(Ue.materialKeys,Oe);0===dt.length&&dt.push("lines"===We||"linestrips"===We?new LineBasicMaterial:new MeshPhongMaterial);var Ft=void 0!==Ue.data.attributes.skinIndex;if(Ft)for(var Nt=0,rr=dt.length;Nt<rr;Nt++)dt[Nt].skinning=!0;var Ht,Qt=1===dt.length?dt[0]:dt;switch(We){case"lines":Ht=new LineSegments(Ue.data,Qt);break;case"linestrips":Ht=new Line(Ue.data,Qt);break;case"triangles":case"polylist":Ht=Ft?new SkinnedMesh(Ue.data,Qt):new Mesh(Ue.data,Qt)}Ve.push(Ht)}return Ve}function Be(Pe){return void 0!==hr.nodes[Pe]}function Ye(Pe){return D(hr.nodes[Pe],kr)}function bt(Pe){var Oe=new Group;Oe.name=Pe.name;for(var Ve=Pe.children,We=0;We<Ve.length;We++)Oe.add(Ye(Ve[We].id));return Oe}function Et(Pe){return void 0!==hr.visualScenes[Pe]}function ar(Pe){return D(hr.visualScenes[Pe],bt)}if(0===e.length)return{scene:new Scene};var ct=(new DOMParser).parseFromString(e,"application/xml"),$t=d(ct,"COLLADA")[0],or=ct.getElementsByTagName("parsererror")[0];if(void 0!==or){var br,Un=d(or,"div")[0];return br=Un?Un.textContent:function(Pe){for(var Oe="",Ve=[Pe];Ve.length;){var We=Ve.shift();We.nodeType===Node.TEXT_NODE?Oe+=We.textContent:(Oe+="\n",Ve.push.apply(Ve,We.childNodes))}return Oe.trim()}(or),console.error("ColladaLoader: Failed to parse collada file.\n",br),null}var Ge=$t.getAttribute("version");console.log("ColladaLoader: File version",Ge);var Pe,zn,Wr=(Pe=d($t,"asset")[0],{unit:function(Pe){return void 0!==Pe&&!0===Pe.hasAttribute("meter")?parseFloat(Pe.getAttribute("meter")):1}(d(Pe,"unit")[0]),upAxis:function(Pe){return void 0!==Pe?Pe.textContent:"Y_UP"}(d(Pe,"up_axis")[0])}),fn=new TextureLoader(this.manager);fn.setPath(this.resourcePath||a).setCrossOrigin(this.crossOrigin),TGALoader&&(zn=new TGALoader(this.manager)).setPath(this.resourcePath||a);var oi=[],sn={},hi=0,hr={animations:{},clips:{},controllers:{},images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{},kinematicsModels:{},physicsModels:{},kinematicsScenes:{}};R($t,"library_animations","animation",function(Pe){for(var Oe={sources:{},samplers:{},channels:{}},Ve=0,We=Pe.childNodes.length;Ve<We;Ve++){var dt,Ue=Pe.childNodes[Ve];if(1===Ue.nodeType)switch(Ue.nodeName){case"source":dt=Ue.getAttribute("id"),Oe.sources[dt]=Ar(Ue);break;case"sampler":dt=Ue.getAttribute("id"),Oe.samplers[dt]=L(Ue);break;case"channel":dt=Ue.getAttribute("target"),Oe.channels[dt]=I(Ue);break;default:console.log(Ue)}}hr.animations[Pe.getAttribute("id")]=Oe}),R($t,"library_animation_clips","animation_clip",function(Pe){for(var Oe={name:Pe.getAttribute("id")||"default",start:parseFloat(Pe.getAttribute("start")||0),end:parseFloat(Pe.getAttribute("end")||0),animations:[]},Ve=0,We=Pe.childNodes.length;Ve<We;Ve++){var Ue=Pe.childNodes[Ve];1===Ue.nodeType&&"instance_animation"===Ue.nodeName&&Oe.animations.push(w(Ue.getAttribute("url")))}hr.clips[Pe.getAttribute("id")]=Oe}),R($t,"library_controllers","controller",function(Pe){for(var Oe={},Ve=0,We=Pe.childNodes.length;Ve<We;Ve++){var Ue=Pe.childNodes[Ve];if(1===Ue.nodeType)switch(Ue.nodeName){case"skin":Oe.id=w(Ue.getAttribute("source")),Oe.skin=$(Ue);break;case"morph":Oe.id=w(Ue.getAttribute("source")),console.warn("ColladaLoader: Morph target animation not supported yet.")}}hr.controllers[Pe.getAttribute("id")]=Oe}),R($t,"library_images","image",function(Pe){var Oe={init_from:d(Pe,"init_from")[0].textContent};hr.images[Pe.getAttribute("id")]=Oe}),R($t,"library_effects","effect",function(Pe){for(var Oe={},Ve=0,We=Pe.childNodes.length;Ve<We;Ve++){var Ue=Pe.childNodes[Ve];1===Ue.nodeType&&"profile_COMMON"===Ue.nodeName&&(Oe.profile=he(Ue))}hr.effects[Pe.getAttribute("id")]=Oe}),R($t,"library_materials","material",function(Pe){for(var Oe={name:Pe.getAttribute("name")},Ve=0,We=Pe.childNodes.length;Ve<We;Ve++){var Ue=Pe.childNodes[Ve];1===Ue.nodeType&&"instance_effect"===Ue.nodeName&&(Oe.url=w(Ue.getAttribute("url")))}hr.materials[Pe.getAttribute("id")]=Oe}),R($t,"library_cameras","camera",function(Pe){for(var Oe={name:Pe.getAttribute("name")},Ve=0,We=Pe.childNodes.length;Ve<We;Ve++){var Ue=Pe.childNodes[Ve];1===Ue.nodeType&&"optics"===Ue.nodeName&&(Oe.optics=ft(Ue))}hr.cameras[Pe.getAttribute("id")]=Oe}),R($t,"library_lights","light",function(Pe){for(var Oe={},Ve=0,We=Pe.childNodes.length;Ve<We;Ve++){var Ue=Pe.childNodes[Ve];1===Ue.nodeType&&"technique_common"===Ue.nodeName&&(Oe=yt(Ue))}hr.lights[Pe.getAttribute("id")]=Oe}),R($t,"library_geometries","geometry",function(Pe){var Oe={name:Pe.getAttribute("name"),sources:{},vertices:{},primitives:[]},Ve=d(Pe,"mesh")[0];if(void 0!==Ve){for(var We=0;We<Ve.childNodes.length;We++){var Ue=Ve.childNodes[We];if(1===Ue.nodeType){var dt=Ue.getAttribute("id");switch(Ue.nodeName){case"source":Oe.sources[dt]=Ar(Ue);break;case"vertices":Oe.vertices=hn(Ue);break;case"polygons":console.warn("ColladaLoader: Unsupported primitive type: ",Ue.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":Oe.primitives.push(Sn(Ue));break;default:console.log(Ue)}}}hr.geometries[Pe.getAttribute("id")]=Oe}}),R($t,"library_nodes","node",ir),R($t,"library_visual_scenes","visual_scene",function(Pe){var Oe={name:Pe.getAttribute("name"),children:[]};!function(Pe){for(var Oe=Pe.getElementsByTagName("node"),Ve=0;Ve<Oe.length;Ve++){var We=Oe[Ve];!1===We.hasAttribute("id")&&We.setAttribute("id","three_default_"+hi++)}}(Pe);for(var Ve=d(Pe,"node"),We=0;We<Ve.length;We++)Oe.children.push(ir(Ve[We]));hr.visualScenes[Pe.getAttribute("id")]=Oe}),R($t,"library_kinematics_models","kinematics_model",function(Pe){for(var Oe={name:Pe.getAttribute("name")||"",joints:{},links:[]},Ve=0;Ve<Pe.childNodes.length;Ve++){var We=Pe.childNodes[Ve];1===We.nodeType&&"technique_common"===We.nodeName&&Ln(We,Oe)}hr.kinematicsModels[Pe.getAttribute("id")]=Oe}),R($t,"library_physics_models","physics_model",function(Pe){for(var Oe={name:Pe.getAttribute("name")||"",rigidBodies:{}},Ve=0;Ve<Pe.childNodes.length;Ve++){var We=Pe.childNodes[Ve];1===We.nodeType&&"rigid_body"===We.nodeName&&(Oe.rigidBodies[We.getAttribute("name")]={},Wn(We,Oe.rigidBodies[We.getAttribute("name")]))}hr.physicsModels[Pe.getAttribute("id")]=Oe}),R($t,"scene","instance_kinematics_scene",function(Pe){for(var Oe={bindJointAxis:[]},Ve=0;Ve<Pe.childNodes.length;Ve++){var We=Pe.childNodes[Ve];1===We.nodeType&&"bind_joint_axis"===We.nodeName&&Oe.bindJointAxis.push(W(We))}hr.kinematicsScenes[w(Pe.getAttribute("url"))]=Oe}),O(hr.animations,V),O(hr.clips,me),O(hr.controllers,Z),O(hr.images,_e),O(hr.effects,ut),O(hr.materials,lt),O(hr.cameras,vt),O(hr.lights,Dr),O(hr.geometries,jr),O(hr.visualScenes,bt),function(){var Pe=hr.clips;if(!0===x(Pe)){if(!1===x(hr.animations)){var Oe=[];for(var Ve in hr.animations)for(var We=z(Ve),Ue=0,dt=We.length;Ue<dt;Ue++)Oe.push(We[Ue]);oi.push(new AnimationClip("default",-1,Oe))}}else for(var Ve in Pe)oi.push(fe(Ve))}(),function(){var Pe=Object.keys(hr.kinematicsModels)[0],Oe=Object.keys(hr.kinematicsScenes)[0],Ve=Object.keys(hr.visualScenes)[0];if(void 0!==Pe&&void 0!==Oe){for(var We=function(Pe){return D(hr.kinematicsModels[Pe],ro)}(Pe),Ue=function(Pe){return D(hr.kinematicsScenes[Pe],ne)}(Oe),dt=ar(Ve),Ft=Ue.bindJointAxis,Nt={},rr=0,Qt=Ft.length;rr<Qt;rr++){var Ht=Ft[rr],Tr=$t.querySelector('[sid="'+Ht.target+'"]');Tr&&tr(Ht.jointIndex,Tr.parentElement)}var Zr=new Matrix4;sn={joints:We&&We.joints,getJointValue:function(Or){var Kr=Nt[Or];if(Kr)return Kr.position;console.warn("ColladaLoader: Joint "+Or+" doesn't exist.")},setJointValue:function(Or,Kr){var On=Nt[Or];if(On){var cr=On.joint;if(Kr>cr.limits.max||Kr<cr.limits.min)console.warn("ColladaLoader: Joint "+Or+" value "+Kr+" outside of limits (min: "+cr.limits.min+", max: "+cr.limits.max+").");else if(cr.static)console.warn("ColladaLoader: Joint "+Or+" is static.");else{var $r=On.object,pn=cr.axis,_o=On.transforms;xt.identity();for(var En=0;En<_o.length;En++){var Ti=_o[En];if(Ti.sid&&-1!==Ti.sid.indexOf(Or))switch(cr.type){case"revolute":xt.multiply(Zr.makeRotationAxis(pn,MathUtils.degToRad(Kr)));break;case"prismatic":xt.multiply(Zr.makeTranslation(pn.x*Kr,pn.y*Kr,pn.z*Kr));break;default:console.warn("ColladaLoader: Unknown joint type: "+cr.type)}else switch(Ti.type){case"matrix":xt.multiply(Ti.obj);break;case"translate":xt.multiply(Zr.makeTranslation(Ti.obj.x,Ti.obj.y,Ti.obj.z));break;case"scale":xt.scale(Ti.obj);break;case"rotate":xt.multiply(Zr.makeRotationAxis(Ti.obj,Ti.angle))}}$r.matrix.copy(xt),$r.matrix.decompose($r.position,$r.quaternion,$r.scale),Nt[Or].position=Kr}}else console.log("ColladaLoader: "+Or+" does not exist.")}}}function tr(Vr,Or){var Kr=Or.getAttribute("name"),On=We.joints[Vr];dt.traverse(function(cr){cr.name===Kr&&(Nt[Vr]={object:cr,transforms:it(Or),joint:On,position:On.zeroPosition})})}}();var $n=function(Pe){return ar(w(d(Pe,"instance_visual_scene")[0].getAttribute("url")))}(d($t,"scene")[0]);return"Z_UP"===Wr.upAxis&&$n.quaternion.setFromEuler(new Euler(-Math.PI/2,0,0)),$n.scale.multiplyScalar(Wr.unit),{animations:oi,kinematics:sn,library:hr,scene:$n}}}),CompressedTextureLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:CompressedTextureLoader,load:function(e,a,d,v){var g=this,C=[],w=new CompressedTexture;w.image=C;var _=new FileLoader(this.manager);function x(R){_.load(e[R],function(O){var D=g.parse(O,!0);C[R]={width:D.width,height:D.height,format:D.format,mipmaps:D.mipmaps},6===(b+=1)&&(1===D.mipmapCount&&(w.minFilter=LinearFilter),w.format=D.format,w.needsUpdate=!0,a&&a(w))},d,v)}if(_.setPath(this.path),_.setResponseType("arraybuffer"),Array.isArray(e))for(var b=0,A=0,E=e.length;A<E;++A)x(A);else _.load(e,function(R){var O=g.parse(R,!0);if(O.isCubemap)for(var D=O.mipmaps.length/O.mipmapCount,F=0;F<D;F++){C[F]={mipmaps:[]};for(var L=0;L<O.mipmapCount;L++)C[F].mipmaps.push(O.mipmaps[F*O.mipmapCount+L]),C[F].format=O.format,C[F].width=O.width,C[F].height=O.height}else w.image.width=O.width,w.image.height=O.height,w.mipmaps=O.mipmaps;1===O.mipmapCount&&(w.minFilter=LinearFilter),w.format=O.format,w.needsUpdate=!0,a&&a(w)},d,v);return w}});var DDSLoader=function(e){CompressedTextureLoader.call(this,e)};DDSLoader.prototype=Object.assign(Object.create(CompressedTextureLoader.prototype),{constructor:DDSLoader,parse:function(e,a){var d={mipmaps:[],width:0,height:0,format:null,mipmapCount:1};function O(xe){return xe.charCodeAt(0)+(xe.charCodeAt(1)<<8)+(xe.charCodeAt(2)<<16)+(xe.charCodeAt(3)<<24)}function F(xe,we,Ne,Re){for(var De=Ne*Re*4,Je=new Uint8Array(xe,we,De),$e=new Uint8Array(De),pt=0,ut=0,at=0;at<Re;at++)for(var Xe=0;Xe<Ne;Xe++){var Ke=Je[ut],lt=Je[++ut],ot=Je[++ut],St=Je[++ut];ut++,$e[pt]=ot,$e[++pt]=lt,$e[++pt]=Ke,$e[++pt]=St,pt++}return $e}var L=O("DXT1"),I=O("DXT3"),V=O("DXT5"),z=O("ETC1"),$=new Int32Array(e,0,31);if(542327876!==$[0])return console.error("DDSLoader.parse: Invalid magic number in DDS header."),d;if(4&!$[20])return console.error("DDSLoader.parse: Unsupported format, must contain a FourCC code."),d;var ue,xe,Y=$[21],Z=!1;switch(Y){case L:ue=8,d.format=RGB_S3TC_DXT1_Format;break;case I:ue=16,d.format=RGBA_S3TC_DXT3_Format;break;case V:ue=16,d.format=RGBA_S3TC_DXT5_Format;break;case z:ue=8,d.format=RGB_ETC1_Format;break;default:if(!(32===$[22]&&16711680&$[23]&&65280&$[24]&&255&$[25]&&4278190080&$[26]))return console.error("DDSLoader.parse: Unsupported FourCC code ",(xe=Y,String.fromCharCode(255&xe,xe>>8&255,xe>>16&255,xe>>24&255))),d;Z=!0,ue=64,d.format=RGBAFormat}d.mipmapCount=1,131072&$[2]&&!1!==a&&(d.mipmapCount=Math.max(1,$[7]));var se=$[28];if(d.isCubemap=!!(512&se),d.isCubemap&&(!(1024&se)||!(2048&se)||!(4096&se)||!(8192&se)||!(16384&se)||!(32768&se)))return console.error("DDSLoader.parse: Incomplete cubemap faces"),d;d.width=$[4],d.height=$[3];for(var ve=$[1]+4,le=d.isCubemap?6:1,_e=0;_e<le;_e++)for(var ae=d.width,pe=d.height,he=0;he<d.mipmapCount;he++){if(Z)var Te=(ce=F(e,ve,ae,pe)).length;else{Te=Math.max(4,ae)/4*Math.max(4,pe)/4*ue;var ce=new Uint8Array(e,ve,Te)}d.mipmaps.push({data:ce,width:ae,height:pe}),ve+=Te,ae=Math.max(ae>>1,1),pe=Math.max(pe>>1,1)}return d}});var DRACOLoader=function(e){Loader.call(this,e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}};function DataTextureLoader(s){Loader.call(this,s)}DRACOLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:DRACOLoader,setDecoderPath:function(e){return this.decoderPath=e,this},setDecoderConfig:function(e){return this.decoderConfig=e,this},setWorkerLimit:function(e){return this.workerLimit=e,this},setVerbosity:function(){console.warn("DRACOLoader: The .setVerbosity() method has been removed.")},setDrawMode:function(){console.warn("DRACOLoader: The .setDrawMode() method has been removed.")},setSkipDequantization:function(){console.warn("DRACOLoader: The .setSkipDequantization() method has been removed.")},load:function(e,a,d,v){var g=this,C=new FileLoader(this.manager);C.setPath(this.path),C.setResponseType("arraybuffer"),"use-credentials"===this.crossOrigin&&C.setWithCredentials(!0),C.load(e,function(w){g.decodeGeometry(w,{attributeIDs:g.defaultAttributeIDs,attributeTypes:g.defaultAttributeTypes,useUniqueIDs:!1}).then(a).catch(v)},d,v)},decodeDracoFile:function(e,a,d,v){this.decodeGeometry(e,{attributeIDs:d||this.defaultAttributeIDs,attributeTypes:v||this.defaultAttributeTypes,useUniqueIDs:!!d}).then(a)},decodeGeometry:function(e,a){var d=this;for(var v in a.attributeTypes){var g=a.attributeTypes[v];void 0!==g.BYTES_PER_ELEMENT&&(a.attributeTypes[v]=g.name)}var C=JSON.stringify(a);if(DRACOLoader.taskCache.has(e)){var w=DRACOLoader.taskCache.get(e);if(w.key===C)return w.promise;if(0===e.byteLength)throw new Error("DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}var _,x=this.workerNextTaskID++,A=this._getWorker(x,e.byteLength).then(function(E){return _=E,new Promise(function(R,O){_._callbacks[x]={resolve:R,reject:O},_.postMessage({type:"decode",id:x,taskConfig:a,buffer:e},[e])})}).then(function(E){return d._createGeometry(E.geometry)});return A.finally(function(){_&&x&&d._releaseTask(_,x)}),DRACOLoader.taskCache.set(e,{key:C,promise:A}),A},_createGeometry:function(e){var a=new BufferGeometry;e.index&&a.setIndex(new BufferAttribute(e.index.array,1));for(var d=0;d<e.attributes.length;d++){var v=e.attributes[d];a.setAttribute(v.name,new BufferAttribute(v.array,v.itemSize))}return a},_loadLibrary:function(e,a){var d=new FileLoader(this.manager);return d.setPath(this.decoderPath),d.setResponseType(a),new Promise(function(v,g){d.load(e,v,void 0,g)})},preload:function(){return this._initDecoder(),this},_initDecoder:function(){var e=this;if(this.decoderPending)return this.decoderPending;var a="object"!=typeof WebAssembly||"js"===this.decoderConfig.type,d=[];return a?d.push(this._loadLibrary("draco_decoder.js","text")):(d.push(this._loadLibrary("draco_wasm_wrapper.js","text")),d.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(d).then(function(v){var g=v[0];a||(e.decoderConfig.wasmBinary=v[1]);var C=DRACOLoader.DRACOWorker.toString(),w=["/* draco decoder */",g,"","/* worker */",C.substring(C.indexOf("{")+1,C.lastIndexOf("}"))].join("\n");e.workerSourceURL=URL.createObjectURL(new Blob([w]))}),this.decoderPending},_getWorker:function(e,a){var d=this;return this._initDecoder().then(function(){var v;return d.workerPool.length<d.workerLimit?((v=new Worker(d.workerSourceURL))._callbacks={},v._taskCosts={},v._taskLoad=0,v.postMessage({type:"init",decoderConfig:d.decoderConfig}),v.onmessage=function(C){var w=C.data;switch(w.type){case"decode":v._callbacks[w.id].resolve(w);break;case"error":v._callbacks[w.id].reject(w);break;default:console.error('DRACOLoader: Unexpected message, "'+w.type+'"')}},d.workerPool.push(v)):d.workerPool.sort(function(g,C){return g._taskLoad>C._taskLoad?-1:1}),(v=d.workerPool[d.workerPool.length-1])._taskCosts[e]=a,v._taskLoad+=a,v})},_releaseTask:function(e,a){e._taskLoad-=e._taskCosts[a],delete e._callbacks[a],delete e._taskCosts[a]},debug:function(){console.log("Task load: ",this.workerPool.map(function(e){return e._taskLoad}))},dispose:function(){for(var e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}),DRACOLoader.DRACOWorker=function(){var s,e;function d(v,g,C,w,_,x){var R,O,b=x.num_components(),E=C.num_points()*b;switch(_){case Float32Array:R=new v.DracoFloat32Array,g.GetAttributeFloatForAllPoints(C,x,R),O=new Float32Array(E);break;case Int8Array:R=new v.DracoInt8Array,g.GetAttributeInt8ForAllPoints(C,x,R),O=new Int8Array(E);break;case Int16Array:R=new v.DracoInt16Array,g.GetAttributeInt16ForAllPoints(C,x,R),O=new Int16Array(E);break;case Int32Array:R=new v.DracoInt32Array,g.GetAttributeInt32ForAllPoints(C,x,R),O=new Int32Array(E);break;case Uint8Array:R=new v.DracoUInt8Array,g.GetAttributeUInt8ForAllPoints(C,x,R),O=new Uint8Array(E);break;case Uint16Array:R=new v.DracoUInt16Array,g.GetAttributeUInt16ForAllPoints(C,x,R),O=new Uint16Array(E);break;case Uint32Array:R=new v.DracoUInt32Array,g.GetAttributeUInt32ForAllPoints(C,x,R),O=new Uint32Array(E);break;default:throw new Error("DRACOLoader: Unexpected attribute type.")}for(var D=0;D<E;D++)O[D]=R.GetValue(D);return v.destroy(R),{name:w,array:O,itemSize:b}}onmessage=function(g){var C=g.data;switch(C.type){case"init":s=C.decoderConfig,e=new Promise(function(x){s.onModuleLoaded=function(b){x({draco:b})},DracoDecoderModule(s)});break;case"decode":var w=C.buffer,_=C.taskConfig;e.then(function(x){var b=x.draco,A=new b.Decoder,E=new b.DecoderBuffer;E.Init(new Int8Array(w),w.byteLength);try{var R=function(v,g,C,w){var b,A,_=w.attributeIDs,x=w.attributeTypes,E=g.GetEncodedGeometryType(C);if(E===v.TRIANGULAR_MESH)b=new v.Mesh,A=g.DecodeBufferToMesh(C,b);else{if(E!==v.POINT_CLOUD)throw new Error("DRACOLoader: Unexpected geometry type.");b=new v.PointCloud,A=g.DecodeBufferToPointCloud(C,b)}if(!A.ok()||0===b.ptr)throw new Error("DRACOLoader: Decoding failed: "+A.error_msg());var R={index:null,attributes:[]};for(var O in _){var F,L,D=self[x[O]];if(w.useUniqueIDs)F=g.GetAttributeByUniqueId(b,L=_[O]);else{if(-1===(L=g.GetAttributeId(b,v[_[O]])))continue;F=g.GetAttribute(b,L)}R.attributes.push(d(v,g,b,O,D,F))}if(E===v.TRIANGULAR_MESH){for(var I=b.num_faces(),z=new Uint32Array(3*I),H=new v.DracoInt32Array,X=0;X<I;++X){g.GetFaceFromMesh(b,X,H);for(var re=0;re<3;++re)z[3*X+re]=H.GetValue(re)}R.index={array:z,itemSize:1},v.destroy(H)}return v.destroy(b),R}(b,A,E,_),O=R.attributes.map(function(D){return D.array.buffer});R.index&&O.push(R.index.array.buffer),self.postMessage({type:"decode",id:C.id,geometry:R},O)}catch(D){console.error(D),self.postMessage({type:"error",id:C.id,error:D.message})}finally{b.destroy(E),b.destroy(A)}})}}},DRACOLoader.taskCache=new WeakMap,DRACOLoader.setDecoderPath=function(){console.warn("DRACOLoader: The .setDecoderPath() method has been removed. Use instance methods.")},DRACOLoader.setDecoderConfig=function(){console.warn("DRACOLoader: The .setDecoderConfig() method has been removed. Use instance methods.")},DRACOLoader.releaseDecoderModule=function(){console.warn("DRACOLoader: The .releaseDecoderModule() method has been removed. Use instance methods.")},DRACOLoader.getDecoderModule=function(){console.warn("DRACOLoader: The .getDecoderModule() method has been removed. Use instance methods.")},DataTextureLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:DataTextureLoader,load:function(e,a,d,v){var g=this,C=new DataTexture,w=new FileLoader(this.manager);return w.setResponseType("arraybuffer"),w.setPath(this.path),w.load(e,function(_){var x=g.parse(_);!x||(void 0!==x.image?C.image=x.image:void 0!==x.data&&(C.image.width=x.width,C.image.height=x.height,C.image.data=x.data),C.wrapS=void 0!==x.wrapS?x.wrapS:ClampToEdgeWrapping,C.wrapT=void 0!==x.wrapT?x.wrapT:ClampToEdgeWrapping,C.magFilter=void 0!==x.magFilter?x.magFilter:LinearFilter,C.minFilter=void 0!==x.minFilter?x.minFilter:LinearFilter,C.anisotropy=void 0!==x.anisotropy?x.anisotropy:1,void 0!==x.format&&(C.format=x.format),void 0!==x.type&&(C.type=x.type),void 0!==x.mipmaps&&(C.mipmaps=x.mipmaps,C.minFilter=LinearMipmapLinearFilter),1===x.mipmapCount&&(C.minFilter=LinearFilter),C.needsUpdate=!0,a&&a(C,x))},d,v),C}});var EXRLoader=function(e){DataTextureLoader.call(this,e),this.type=FloatType};EXRLoader.prototype=Object.assign(Object.create(DataTextureLoader.prototype),{constructor:EXRLoader,parse:function(e){var a=65536,g=14,C=65537,X=Math.pow(2.7182818,2.2),te={l:0,c:0,lc:0};function J(Be,Ye,st,bt,Et){for(;st<Be;)Ye=Ye<<8|St(bt,Et),st+=8;te.l=Ye>>(st-=Be)&(1<<Be)-1,te.c=Ye,te.lc=st}var k=new Array(59);function ee(Be){return 63&Be}function Q(Be){return Be>>6}var me={c:0,lc:0};function fe(Be,Ye,st,bt){Be=Be<<8|St(st,bt),Ye+=8,me.c=Be,me.lc=Ye}var ge={c:0,lc:0};function $(Be,Ye,st,bt,Et,ar,Xt,Zt,jt,ct){if(Be==Ye){bt<8&&(fe(st,bt,Et,Xt),st=me.c,bt=me.lc);var $t=st>>(bt-=8);if($t=new Uint8Array([$t])[0],jt.value+$t>ct)return!1;for(var or=Zt[jt.value-1];$t-- >0;)Zt[jt.value++]=or}else{if(!(jt.value<ct))return!1;Zt[jt.value++]=Be}ge.c=st,ge.lc=bt}function Y(Be){var Ye=function(Be){return 65535&Be}(Be);return Ye>32767?Ye-65536:Ye}var Z={a:0,b:0};function se(Be,Ye){var st=Y(Be),bt=Y(Ye),ar=st+(1&bt)+(bt>>1),Zt=ar-bt;Z.a=ar,Z.b=Zt}function ve(Be,Ye,st,bt,Et,ar){for(var jt,Xt=st>Et?Et:st,Zt=1;Zt<=Xt;)Zt<<=1;for(jt=Zt>>=1,Zt>>=1;Zt>=1;){for(var Wr,zn,oi,ct=0,$t=ct+ar*(Et-jt),or=ar*Zt,Un=ar*jt,br=bt*Zt,Ge=bt*jt;ct<=$t;ct+=Un){for(var sn=ct,hi=ct+bt*(st-jt);sn<=hi;sn+=Ge){var hr=sn+br,Pe=($n=sn+or)+br;se(Be[sn+Ye],Be[$n+Ye]),Wr=Z.a,zn=Z.b,se(Be[hr+Ye],Be[Pe+Ye]),oi=Z.b,se(Wr,Z.a),Be[sn+Ye]=Z.a,Be[hr+Ye]=Z.b,se(zn,oi),Be[$n+Ye]=Z.a,Be[Pe+Ye]=Z.b}var $n;st&Zt&&(se(Be[sn+Ye],Be[($n=sn+or)+Ye]),Wr=Z.a,Be[$n+Ye]=Z.b,Be[sn+Ye]=Wr)}if(Et&Zt)for(sn=ct,hi=ct+bt*(st-jt);sn<=hi;sn+=Ge)se(Be[sn+Ye],Be[(hr=sn+br)+Ye]),Wr=Z.a,Be[hr+Ye]=Z.b,Be[sn+Ye]=Wr;jt=Zt,Zt>>=1}return ct}function _e(Be,Ye,st,bt,Et,ar){var Zt=st.value,jt=ot(Ye,st),ct=ot(Ye,st);st.value+=4;var $t=ot(Ye,st);if(st.value+=4,jt<0||jt>=C||ct<0||ct>=C)throw"Something wrong with HUF_ENCSIZE";var or=new Array(C),Un=new Array(16384);if(function(Be){for(var Ye=0;Ye<16384;Ye++)Be[Ye]={},Be[Ye].len=0,Be[Ye].lit=0,Be[Ye].p=null}(Un),function(Be,Ye,st,bt,Et,ar,Xt){for(var Zt=st,jt=0,ct=0;Et<=ar;Et++){if(Zt.value-st.value>bt)return!1;J(6,jt,ct,Be,Zt);var $t=te.l;if(jt=te.c,ct=te.lc,Xt[Et]=$t,63==$t){if(Zt.value-st.value>bt)throw"Something wrong with hufUnpackEncTable";if(J(8,jt,ct,Be,Zt),jt=te.c,ct=te.lc,Et+(or=te.l+6)>ar+1)throw"Something wrong with hufUnpackEncTable";for(;or--;)Xt[Et++]=0;Et--}else if($t>=59){var or;if(Et+(or=$t-59+2)>ar+1)throw"Something wrong with hufUnpackEncTable";for(;or--;)Xt[Et++]=0;Et--}}!function(Be){for(var Ye=0;Ye<=58;++Ye)k[Ye]=0;for(Ye=0;Ye<C;++Ye)k[Be[Ye]]+=1;var st=0;for(Ye=58;Ye>0;--Ye){var bt=st+k[Ye]>>1;k[Ye]=st,st=bt}for(Ye=0;Ye<C;++Ye){var Et=Be[Ye];Et>0&&(Be[Ye]=Et|k[Et]++<<6)}}(Xt)}(Be,0,st,bt-(st.value-Zt),jt,ct,or),$t>8*(bt-(st.value-Zt)))throw"Something wrong with hufUncompress";(function(Be,Ye,st,bt){for(;Ye<=st;Ye++){var Et=Q(Be[Ye]),ar=ee(Be[Ye]);if(Et>>ar)throw"Invalid table entry";if(ar>g){if((Xt=bt[Et>>ar-g]).len)throw"Invalid table entry";if(Xt.lit++,Xt.p){var Zt=Xt.p;Xt.p=new Array(Xt.lit);for(var jt=0;jt<Xt.lit-1;++jt)Xt.p[jt]=Zt[jt]}else Xt.p=new Array(1);Xt.p[Xt.lit-1]=Ye}else if(ar){var ct=0;for(jt=1<<g-ar;jt>0;jt--){var Xt;if((Xt=bt[(Et<<g-ar)+ct]).len||Xt.p)throw"Invalid table entry";Xt.len=ar,Xt.lit=Ye,ct++}}}})(or,jt,ct,Un),function(Be,Ye,st,bt,Et,ar,Xt,Zt,jt,ct){for(var $t=0,or=0,Un=Zt,br=Math.trunc(Et.value+(ar+7)/8);Et.value<br;)for(fe($t,or,st,Et),$t=me.c,or=me.lc;or>=g;)if((Wr=Ye[$t>>or-g&16383]).len)$(Wr.lit,Xt,$t,or-=Wr.len,st,0,Et,jt,ct,Un),$t=ge.c,or=ge.lc;else{if(!Wr.p)throw"hufDecode issues";var fn;for(fn=0;fn<Wr.lit;fn++){for(var zn=ee(Be[Wr.p[fn]]);or<zn&&Et.value<br;)fe($t,or,st,Et),$t=me.c,or=me.lc;if(or>=zn&&Q(Be[Wr.p[fn]])==($t>>or-zn&(1<<zn)-1)){$(Wr.p[fn],Xt,$t,or-=zn,st,0,Et,jt,ct,Un),$t=ge.c,or=ge.lc;break}}if(fn==Wr.lit)throw"hufDecode issues"}var oi=8-ar&7;for($t>>=oi,or-=oi;or>0;){var Wr;if(!(Wr=Ye[$t<<g-or&16383]).len)throw"hufDecode issues";$(Wr.lit,Xt,$t,or-=Wr.len,st,0,Et,jt,ct,Un),$t=ge.c,or=ge.lc}}(or,Un,Be,0,st,$t,ct,ar,Et,{value:0})}function pe(Be){for(var Ye=1;Ye<Be.length;Ye++)Be[Ye]=Be[Ye-1]+Be[Ye]-128}function he(Be,Ye){for(var st=0,bt=Math.floor((Be.length+1)/2),Et=0,ar=Be.length-1;!(Et>ar||(Ye[Et++]=Be[st++],Et>ar));)Ye[Et++]=Be[bt++]}function ce(Be){for(var Ye=Be.byteLength,st=new Array,bt=0,Et=new DataView(Be);Ye>0;){var ar=Et.getInt8(bt++);if(ar<0){Ye-=1+(Xt=-ar);for(var Zt=0;Zt<Xt;Zt++)st.push(Et.getUint8(bt++))}else{var Xt=ar;Ye-=2;var jt=Et.getUint8(bt++);for(Zt=0;Zt<Xt+1;Zt++)st.push(jt)}}return st}function be(Be,Ye,st){for(var bt,Et=1;Et<64;)65280==(bt=Ye[Be.value])?Et=64:bt>>8==255?Et+=255&bt:(st[Et]=bt,Et++),Be.value++}function xe(Be,Ye){Ye[0]=vt(Be[0]),Ye[1]=vt(Be[1]),Ye[2]=vt(Be[5]),Ye[3]=vt(Be[6]),Ye[4]=vt(Be[14]),Ye[5]=vt(Be[15]),Ye[6]=vt(Be[27]),Ye[7]=vt(Be[28]),Ye[8]=vt(Be[2]),Ye[9]=vt(Be[4]),Ye[10]=vt(Be[7]),Ye[11]=vt(Be[13]),Ye[12]=vt(Be[16]),Ye[13]=vt(Be[26]),Ye[14]=vt(Be[29]),Ye[15]=vt(Be[42]),Ye[16]=vt(Be[3]),Ye[17]=vt(Be[8]),Ye[18]=vt(Be[12]),Ye[19]=vt(Be[17]),Ye[20]=vt(Be[25]),Ye[21]=vt(Be[30]),Ye[22]=vt(Be[41]),Ye[23]=vt(Be[43]),Ye[24]=vt(Be[9]),Ye[25]=vt(Be[11]),Ye[26]=vt(Be[18]),Ye[27]=vt(Be[24]),Ye[28]=vt(Be[31]),Ye[29]=vt(Be[40]),Ye[30]=vt(Be[44]),Ye[31]=vt(Be[53]),Ye[32]=vt(Be[10]),Ye[33]=vt(Be[19]),Ye[34]=vt(Be[23]),Ye[35]=vt(Be[32]),Ye[36]=vt(Be[39]),Ye[37]=vt(Be[45]),Ye[38]=vt(Be[52]),Ye[39]=vt(Be[54]),Ye[40]=vt(Be[20]),Ye[41]=vt(Be[22]),Ye[42]=vt(Be[33]),Ye[43]=vt(Be[38]),Ye[44]=vt(Be[46]),Ye[45]=vt(Be[51]),Ye[46]=vt(Be[55]),Ye[47]=vt(Be[60]),Ye[48]=vt(Be[21]),Ye[49]=vt(Be[34]),Ye[50]=vt(Be[37]),Ye[51]=vt(Be[47]),Ye[52]=vt(Be[50]),Ye[53]=vt(Be[56]),Ye[54]=vt(Be[59]),Ye[55]=vt(Be[61]),Ye[56]=vt(Be[35]),Ye[57]=vt(Be[36]),Ye[58]=vt(Be[48]),Ye[59]=vt(Be[49]),Ye[60]=vt(Be[57]),Ye[61]=vt(Be[58]),Ye[62]=vt(Be[62]),Ye[63]=vt(Be[63])}function we(Be){for(var Ye=.5*Math.cos(.7853975),st=.5*Math.cos(3.14159/16),bt=.5*Math.cos(3.14159/8),Et=.5*Math.cos(3*3.14159/16),ar=.5*Math.cos(.981746875),Xt=.5*Math.cos(3*3.14159/8),Zt=.5*Math.cos(1.374445625),jt=new Array(4),ct=new Array(4),$t=new Array(4),or=new Array(4),Un=0;Un<8;++Un){var br=8*Un;jt[0]=bt*Be[br+2],jt[1]=Xt*Be[br+2],jt[2]=bt*Be[br+6],jt[3]=Xt*Be[br+6],ct[0]=st*Be[br+1]+Et*Be[br+3]+ar*Be[br+5]+Zt*Be[br+7],ct[1]=Et*Be[br+1]-Zt*Be[br+3]-st*Be[br+5]-ar*Be[br+7],ct[2]=ar*Be[br+1]-st*Be[br+3]+Zt*Be[br+5]+Et*Be[br+7],ct[3]=Zt*Be[br+1]-ar*Be[br+3]+Et*Be[br+5]-st*Be[br+7],$t[0]=Ye*(Be[br+0]+Be[br+4]),$t[3]=Ye*(Be[br+0]-Be[br+4]),$t[1]=jt[0]+jt[3],$t[2]=jt[1]-jt[2],or[0]=$t[0]+$t[1],or[1]=$t[3]+$t[2],or[2]=$t[3]-$t[2],or[3]=$t[0]-$t[1],Be[br+0]=or[0]+ct[0],Be[br+1]=or[1]+ct[1],Be[br+2]=or[2]+ct[2],Be[br+3]=or[3]+ct[3],Be[br+4]=or[3]-ct[3],Be[br+5]=or[2]-ct[2],Be[br+6]=or[1]-ct[1],Be[br+7]=or[0]-ct[0]}for(var Ge=0;Ge<8;++Ge)jt[0]=bt*Be[16+Ge],jt[1]=Xt*Be[16+Ge],jt[2]=bt*Be[48+Ge],jt[3]=Xt*Be[48+Ge],ct[0]=st*Be[8+Ge]+Et*Be[24+Ge]+ar*Be[40+Ge]+Zt*Be[56+Ge],ct[1]=Et*Be[8+Ge]-Zt*Be[24+Ge]-st*Be[40+Ge]-ar*Be[56+Ge],ct[2]=ar*Be[8+Ge]-st*Be[24+Ge]+Zt*Be[40+Ge]+Et*Be[56+Ge],ct[3]=Zt*Be[8+Ge]-ar*Be[24+Ge]+Et*Be[40+Ge]-st*Be[56+Ge],$t[0]=Ye*(Be[Ge]+Be[32+Ge]),$t[3]=Ye*(Be[Ge]-Be[32+Ge]),$t[1]=jt[0]+jt[3],$t[2]=jt[1]-jt[2],or[0]=$t[0]+$t[1],or[1]=$t[3]+$t[2],or[2]=$t[3]-$t[2],or[3]=$t[0]-$t[1],Be[0+Ge]=or[0]+ct[0],Be[8+Ge]=or[1]+ct[1],Be[16+Ge]=or[2]+ct[2],Be[24+Ge]=or[3]+ct[3],Be[32+Ge]=or[3]-ct[3],Be[40+Ge]=or[2]-ct[2],Be[48+Ge]=or[1]-ct[1],Be[56+Ge]=or[0]-ct[0]}function Ne(Be){for(var Ye=0;Ye<64;++Ye){var st=Be[0][Ye],bt=Be[1][Ye],Et=Be[2][Ye];Be[0][Ye]=st+1.5747*Et,Be[1][Ye]=st-.1873*bt-.4682*Et,Be[2][Ye]=st+1.8556*bt}}function Re(Be,Ye,st){for(var bt=0;bt<64;++bt)Ye[st+bt]=Gt(De(Be[bt]))}function De(Be){return Be<=1?Math.sign(Be)*Math.pow(Math.abs(Be),2.2):Math.sign(Be)*Math.pow(X,Math.abs(Be)-1)}function pt(Be){var Ye=Be.array.slice(Be.offset.value,Be.offset.value+Be.size);"undefined"==typeof Zlib&&console.error("EXRLoader: External library Inflate.min.js required, obtain or import from https://github.com/imaya/zlib.js");var st=new Zlib.Inflate(Ye,{resize:!0,verify:!0}),bt=new Uint8Array(st.decompress().buffer),Et=new Uint8Array(bt.length);return pe(bt),he(bt,Et),new DataView(Et.buffer)}function at(Be){var Ye=Be.viewer,st={value:Be.offset.value},bt=new Uint8Array(Be.width*Be.lines*(jr.channels.length*Be.type*2)),Et={version:He(Ye,st),unknownUncompressedSize:He(Ye,st),unknownCompressedSize:He(Ye,st),acCompressedSize:He(Ye,st),dcCompressedSize:He(Ye,st),rleCompressedSize:He(Ye,st),rleUncompressedSize:He(Ye,st),rleRawSize:He(Ye,st),totalAcUncompressedCount:He(Ye,st),totalDcUncompressedCount:He(Ye,st),acCompression:He(Ye,st)};if(Et.version<2)throw"EXRLoader.parse: "+jr.compression+" version "+Et.version+" is unsupported";for(var ar=new Array,Xt=Lt(Ye,st)-2;Xt>0;){var Zt=Xe(Ye.buffer,st),jt=ft(Ye,st),ct=jt>>2&3,or=new Int8Array([(jt>>4)-1])[0],Un=ft(Ye,st);ar.push({name:Zt,index:or,type:Un,compression:ct}),Xt-=Zt.length+3}for(var br=jr.channels,Ge=new Array(Be.channels),Wr=0;Wr<Be.channels;++Wr){var fn=Ge[Wr]={},zn=br[Wr];fn.name=zn.name,fn.compression=0,fn.decoded=!1,fn.type=zn.pixelType,fn.pLinear=zn.pLinear,fn.width=Be.width,fn.height=Be.lines}for(var oi={idx:new Array(3)},sn=0;sn<Be.channels;++sn)for(fn=Ge[sn],Wr=0;Wr<ar.length;++Wr){var hi=ar[Wr];fn.name==hi.name&&(fn.compression=hi.compression,hi.index>=0&&(oi.idx[hi.index]=sn),fn.offset=sn)}if(Et.acCompressedSize>0)switch(Et.acCompression){case 0:var hr=new Uint16Array(Et.totalAcUncompressedCount);_e(Be.array,Ye,st,Et.acCompressedSize,hr,Et.totalAcUncompressedCount);break;case 1:var $n=Be.array.slice(st.value,st.value+Et.totalAcUncompressedCount),Pe=new Zlib.Inflate($n,{resize:!0,verify:!0});hr=new Uint16Array(Pe.decompress().buffer),st.value+=Et.totalAcUncompressedCount}if(Et.dcCompressedSize>0){var Ve=new Uint16Array(pt({array:Be.array,offset:st,size:Et.dcCompressedSize}).buffer);st.value+=Et.dcCompressedSize}if(Et.rleRawSize>0){$n=Be.array.slice(st.value,st.value+Et.rleCompressedSize);var We=ce((Pe=new Zlib.Inflate($n,{resize:!0,verify:!0})).decompress().buffer);st.value+=Et.rleCompressedSize}var Ue=0,dt=new Array(Ge.length);for(Wr=0;Wr<dt.length;++Wr)dt[Wr]=new Array;for(var Ft=0;Ft<Be.lines;++Ft)for(var Nt=0;Nt<Ge.length;++Nt)dt[Nt].push(Ue),Ue+=Ge[Nt].width*Be.type*2;for(function(Be,Ye,st,bt,Et,ar){for(var Xt=new DataView(ar.buffer),Zt=st[Be.idx[0]].width,jt=st[Be.idx[0]].height,$t=Math.floor(Zt/8),or=Math.ceil(Zt/8),Un=Math.ceil(jt/8),br=Zt-8*(or-1),Ge=jt-8*(Un-1),Wr={value:0},fn=new Array(3),zn=new Array(3),oi=new Array(3),sn=new Array(3),hi=new Array(3),hr=0;hr<3;++hr)hi[hr]=Ye[Be.idx[hr]],fn[hr]=hr<1?0:fn[hr-1]+or*Un,zn[hr]=new Float32Array(64),oi[hr]=new Uint16Array(64),sn[hr]=new Uint16Array(64*or);for(var $n=0;$n<Un;++$n){var Pe=8;$n==Un-1&&(Pe=Ge);for(var Oe=8,Ve=0;Ve<or;++Ve){Ve==or-1&&(Oe=br);for(var We=0;We<3;++We)oi[We].fill(0),oi[We][0]=Et[fn[We]++],be(Wr,bt,oi[We]),xe(oi[We],zn[We]),we(zn[We]);Ne(zn);for(var Ue=0;Ue<3;++Ue)Re(zn[Ue],sn[Ue],64*Ve)}for(var dt=0,Ft=0;Ft<3;++Ft){for(var Nt=st[Be.idx[Ft]].type,rr=8*$n;rr<8*$n+Pe;++rr){dt=hi[Ft][rr];for(var Qt=0;Qt<$t;++Qt){var Ht=64*Qt+8*(7&rr);Xt.setUint16(dt+0*Nt,sn[Ft][Ht+0],!0),Xt.setUint16(dt+2*Nt,sn[Ft][Ht+1],!0),Xt.setUint16(dt+4*Nt,sn[Ft][Ht+2],!0),Xt.setUint16(dt+6*Nt,sn[Ft][Ht+3],!0),Xt.setUint16(dt+8*Nt,sn[Ft][Ht+4],!0),Xt.setUint16(dt+10*Nt,sn[Ft][Ht+5],!0),Xt.setUint16(dt+12*Nt,sn[Ft][Ht+6],!0),Xt.setUint16(dt+14*Nt,sn[Ft][Ht+7],!0),dt+=16*Nt}}if($t!=or)for(var Tr=8*$n;Tr<8*$n+Pe;++Tr)for(var mn=hi[Ft][Tr]+8*$t*2*Nt,tr=64*$t+8*(7&Tr),Zr=0;Zr<Oe;++Zr)Xt.setUint16(mn+2*Zr*Nt,sn[Ft][tr+Zr],!0)}}for(var Vr=new Uint16Array(Zt),Or=(Xt=new DataView(ar.buffer),0);Or<3;++Or){st[Be.idx[Or]].decoded=!0;var Kr=st[Be.idx[Or]].type;if(2==st[Or].type)for(var On=0;On<jt;++On){for(var cr=hi[Or][On],$r=0;$r<Zt;++$r)Vr[$r]=Xt.getUint16(cr+2*$r*Kr,!0);for($r=0;$r<Zt;++$r)Xt.setFloat32(cr+2*$r*Kr,vt(Vr[$r]),!0)}}}(oi,dt,Ge,hr,Ve,bt),Wr=0;Wr<Ge.length;++Wr)if(!(fn=Ge[Wr]).decoded){if(2!==fn.compression)throw"EXRLoader.parse: unsupported channel compression";var rr=0,Qt=0;for(Ft=0;Ft<Be.lines;++Ft){for(var Ht=dt[Wr][rr],Tr=0;Tr<fn.width;++Tr){for(var mn=0;mn<2*fn.type;++mn)bt[Ht++]=We[Qt+mn*fn.width*fn.height];Qt++}rr++}}return new DataView(bt.buffer)}function Xe(Be,Ye){for(var st=new Uint8Array(Be),bt=0;0!=st[Ye.value+bt];)bt+=1;var Et=(new TextDecoder).decode(st.slice(Ye.value,Ye.value+bt));return Ye.value=Ye.value+bt+1,Et}function lt(Be,Ye){var st=Be.getUint32(0,!0);return Ye.value=Ye.value+8,st}function ot(Be,Ye){var st=Be.getUint32(Ye.value,!0);return Ye.value=Ye.value+4,st}function St(Be,Ye){var st=Be[Ye.value];return Ye.value=Ye.value+1,st}function ft(Be,Ye){var st=Be.getUint8(Ye.value);return Ye.value=Ye.value+1,st}function He(Be,Ye){var st=Number(Be.getBigInt64(Ye.value,!0));return Ye.value+=8,st}function gt(Be,Ye){var st=Be.getFloat32(Ye.value,!0);return Ye.value+=4,st}function vt(Be){var Ye=(31744&Be)>>10,st=1023&Be;return(Be>>15?-1:1)*(Ye?31===Ye?st?NaN:1/0:Math.pow(2,Ye-15)*(1+st/1024):st/1024*6103515625e-14)}var Be,Ye,Gt=(Be=new Float32Array(1),Ye=new Int32Array(Be.buffer),function(bt){Be[0]=bt;var Et=Ye[0],ar=Et>>16&32768,Xt=Et>>12&2047,Zt=Et>>23&255;return Zt<103?ar:Zt>142?(ar|=31744,ar|=(255==Zt?0:1)&&8388607&Et):Zt<113?ar|=((Xt|=2048)>>114-Zt)+(Xt>>113-Zt&1):(ar|=Zt-112<<10|Xt>>1,ar+=1&Xt)});function Lt(Be,Ye){var st=Be.getUint16(Ye.value,!0);return Ye.value+=2,st}function Sn(Be,Ye,st,bt,Et){if("string"===bt||"stringvector"===bt||"iccProfile"===bt)return function(Be,Ye,st){var bt=(new TextDecoder).decode(new Uint8Array(Be).slice(Ye.value,Ye.value+st));return Ye.value=Ye.value+st,bt}(Ye,st,Et);if("chlist"===bt)return function(Be,Ye,st,bt){for(var Et=st.value,ar=[];st.value<Et+bt-1;){var Xt=Xe(Ye,st),Zt=ot(Be,st),jt=ft(Be,st);st.value+=3;var ct=ot(Be,st),$t=ot(Be,st);ar.push({name:Xt,pixelType:Zt,pLinear:jt,xSampling:ct,ySampling:$t})}return st.value+=1,ar}(Be,Ye,st,Et);if("chromaticities"===bt)return function(Be,Ye){return{redX:gt(Be,Ye),redY:gt(Be,Ye),greenX:gt(Be,Ye),greenY:gt(Be,Ye),blueX:gt(Be,Ye),blueY:gt(Be,Ye),whiteX:gt(Be,Ye),whiteY:gt(Be,Ye)}}(Be,st);if("compression"===bt)return function(Be,Ye){return["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"][ft(Be,Ye)]}(Be,st);if("box2i"===bt)return function(Be,Ye){return{xMin:ot(Be,Ye),yMin:ot(Be,Ye),xMax:ot(Be,Ye),yMax:ot(Be,Ye)}}(Be,st);if("lineOrder"===bt)return function(Be,Ye){return["INCREASING_Y"][ft(Be,Ye)]}(Be,st);if("float"===bt)return gt(Be,st);if("v2f"===bt)return function(Be,Ye){return[gt(Be,Ye),gt(Be,Ye)]}(Be,st);if("int"===bt)return ot(Be,st);throw"Cannot parse value for unsupported type: "+bt}var Sr=new DataView(e),An=new Uint8Array(e),jr={};Sr.getUint32(0,!0),Sr.getUint8(4,!0),Sr.getUint8(5,!0);for(var cn={value:8},Fn=!0;Fn;){var yi=Xe(e,cn);if(0==yi)Fn=!1;else{var zt=Sn(Sr,e,cn,Xe(e,cn),ot(Sr,cn));jr[yi]=zt}}var Kt,Ee,Ln=jr.dataWindow.yMax+1;switch(jr.compression){case"NO_COMPRESSION":Ee=1,Kt=function(Be){return new DataView(Be.array.buffer,Be.offset.value,Be.size)};break;case"RLE_COMPRESSION":Ee=1,Kt=function(Be){var Ye=Be.viewer.buffer.slice(Be.offset.value,Be.offset.value+Be.size),st=new Uint8Array(ce(Ye)),bt=new Uint8Array(st.length);return pe(st),he(st,bt),new DataView(bt.buffer)};break;case"ZIPS_COMPRESSION":Ee=1,Kt=pt;break;case"ZIP_COMPRESSION":Ee=16,Kt=pt;break;case"PIZ_COMPRESSION":Ee=32,Kt=function(Be){for(var Ye=Be.viewer,st={value:Be.offset.value},Et=new Uint16Array(Be.width*Ee*(jr.channels.length*Be.type)),ar=new Uint8Array(8192),Xt=0,Zt=new Array(Be.channels),jt=0;jt<Be.channels;jt++)Zt[jt]={},Zt[jt].start=Xt,Zt[jt].end=Zt[jt].start,Zt[jt].nx=Be.width,Zt[jt].ny=Be.lines,Zt[jt].size=Be.type,Xt+=Zt[jt].nx*Zt[jt].ny*Zt[jt].size;var ct=Lt(Ye,st),$t=Lt(Ye,st);if($t>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(ct<=$t)for(jt=0;jt<$t-ct+1;jt++)ar[jt+ct]=ft(Ye,st);var or=new Uint16Array(a);!function(Be,Ye){for(var st=0,bt=0;bt<a;++bt)(0==bt||Be[bt>>3]&1<<(7&bt))&&(Ye[st++]=bt);for(;st<a;)Ye[st++]=0}(ar,or);var Un=ot(Ye,st);for(_e(Be.array,Ye,st,Un,Et,Xt),jt=0;jt<Be.channels;++jt)for(var br=Zt[jt],Ge=0;Ge<Zt[jt].size;++Ge)ve(Et,br.start+Ge,br.nx,br.size,br.ny,br.nx*br.size);!function(Be,Ye,st){for(var bt=0;bt<st;++bt)Ye[bt]=Be[Ye[bt]]}(or,Et,Xt);for(var Wr=0,fn=new Uint8Array(Et.buffer.byteLength),zn=0;zn<Be.lines;zn++)for(var oi=0;oi<Be.channels;oi++){var sn=(br=Zt[oi]).nx*br.size,hi=new Uint8Array(Et.buffer,2*br.end,2*sn);fn.set(hi,Wr),Wr+=2*sn,br.end+=sn}return new DataView(fn.buffer)};break;case"DWAA_COMPRESSION":Ee=32,Kt=at;break;case"DWAB_COMPRESSION":Ee=256,Kt=at;break;default:throw"EXRLoader.parse: "+jr.compression+" is unsupported"}var Nr,Kn,Dn=jr.channels[0].pixelType;if(1===Dn)switch(this.type){case FloatType:Kn=function(Be,Ye){return vt(Lt(Be,Ye))},Nr=2;break;case HalfFloatType:Kn=Lt,Nr=2}else{if(2!==Dn)throw"EXRLoader.parse: unsupported pixelType "+Dn+" for "+jr.compression+".";switch(this.type){case FloatType:Kn=gt,Nr=4;break;case HalfFloatType:throw"EXRLoader.parse: unsupported HalfFloatType texture for FloatType image file."}}for(var Ni=Ln/Ee,Wn=0;Wn<Ni;Wn++)lt(Sr,cn);var Ci=jr.dataWindow.xMax-jr.dataWindow.xMin+1,Zn=jr.dataWindow.yMax-jr.dataWindow.yMin+1,ne=Ci*Zn*4;switch(this.type){case FloatType:var Ie=new Float32Array(ne);jr.channels.length<4&&Ie.fill(1,0,ne);break;case HalfFloatType:Ie=new Uint16Array(ne),jr.channels.length<4&&Ie.fill(15360,0,ne);break;default:console.error("EXRLoader: unsupported type: ",this.type)}for(var Dt,xt,ze={R:0,G:1,B:2,A:3},it={size:0,width:Ci,lines:Ee,offset:cn,array:An,viewer:Sr,type:Dn,channels:jr.channels.length},kt={value:0},ir=0;ir<Zn/Ee;ir++){Dt=ot(Sr,cn),ne=ot(Sr,cn),it.lines=Dt+Ee>Zn?Zn-Dt:Ee,it.offset=cn,it.size=ne,xt=Kt(it),cn.value+=ne;for(var Cr=0;Cr<Ee;Cr++){var Hr=Cr+ir*Ee;if(Hr>=Zn)break;for(var Xr=0;Xr<jr.channels.length;Xr++)for(var kr=ze[jr.channels[Xr].name],fr=0;fr<Ci;fr++){kt.value=(Cr*(jr.channels.length*Ci)+Xr*Ci+fr)*Nr;var wi=Kn(xt,kt);Ie[4*Ci*(Zn-1-Hr)+4*fr+kr]=wi}}}return{header:jr,width:Ci,height:Zn,data:Ie,format:RGBAFormat,type:this.type}},setDataType:function(e){return this.type=e,this},load:function(e,a,d,v){return DataTextureLoader.prototype.load.call(this,e,function(C,w){switch(C.type){case FloatType:case HalfFloatType:C.encoding=LinearEncoding,C.minFilter=LinearFilter,C.magFilter=LinearFilter,C.generateMipmaps=!1,C.flipY=!1}a&&a(C,w)},d,v)}});var FBXLoader=function(){var s,e,a;function d(J){Loader.call(this,J)}function v(J,k){this.textureLoader=J,this.manager=k}function g(){}function C(){}function w(){}function _(){}function x(J,k){this.dv=new DataView(J),this.offset=0,this.littleEndian=void 0===k||k}function b(){}function R(J){var U=J.match(/FBXVersion: (\d+)/);if(U)return parseInt(U[1]);throw new Error("FBXLoader: Cannot find the version number for the file given.")}function O(J){return J/46186158e3}d.prototype=Object.assign(Object.create(Loader.prototype),{constructor:d,load:function(k,U,K,ee){var Q=this,oe=""===Q.path?LoaderUtils.extractUrlBase(k):Q.path,me=new FileLoader(this.manager);me.setPath(Q.path),me.setResponseType("arraybuffer"),me.load(k,function(fe){try{U(Q.parse(fe,oe))}catch(ge){setTimeout(function(){ee&&ee(ge),Q.manager.itemError(k)},0)}},K,ee)},parse:function(k,U){if(function(J){var k="Kaydara FBX Binary  \0";return J.byteLength>=k.length&&k===X(J,0,k.length)}(k))s=(new _).parse(k);else{var K=X(k);if(!function(J){var oe,me,k=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],U=0;for(var ee=0;ee<k.length;++ee)if(me=void 0,me=J[(oe=1)-1],J=J.slice(U+oe),U++,me===k[ee])return!1;return!0}(K))throw new Error("FBXLoader: Unknown format.");if(R(K)<7e3)throw new Error("FBXLoader: FBX version not supported, FileVersion: "+R(K));s=(new w).parse(K)}return new v(new TextureLoader(this.manager).setPath(this.resourcePath||U).setCrossOrigin(this.crossOrigin),this.manager).parse(s)}}),v.prototype={constructor:v,parse:function(){e=this.parseConnections();var k=this.parseImages(),U=this.parseTextures(k),K=this.parseMaterials(U),ee=this.parseDeformers(),Q=(new g).parse(ee);return this.parseScene(ee,Q,K),a},parseConnections:function(){var k=new Map;return"Connections"in s&&s.Connections.connections.forEach(function(K){var ee=K[0],Q=K[1],oe=K[2];k.has(ee)||k.set(ee,{parents:[],children:[]});var me={ID:Q,relationship:oe};k.get(ee).parents.push(me),k.has(Q)||k.set(Q,{parents:[],children:[]});var fe={ID:ee,relationship:oe};k.get(Q).children.push(fe)}),k},parseImages:function(){var k={},U={};if("Video"in s.Objects){var K=s.Objects.Video;for(var ee in K){var Q=K[ee];if(k[oe=parseInt(ee)]=Q.RelativeFilename||Q.Filename,"Content"in Q&&(Q.Content instanceof ArrayBuffer&&Q.Content.byteLength>0||"string"==typeof Q.Content&&""!==Q.Content)){var ge=this.parseImage(K[ee]);U[Q.RelativeFilename||Q.Filename]=ge}}}for(var oe in k){var $=k[oe];k[oe]=void 0!==U[$]?U[$]:k[oe].split("\\").pop()}return k},parseImage:function(k){var Q,U=k.Content,K=k.RelativeFilename||k.Filename,ee=K.slice(K.lastIndexOf(".")+1).toLowerCase();switch(ee){case"bmp":Q="image/bmp";break;case"jpg":case"jpeg":Q="image/jpeg";break;case"png":Q="image/png";break;case"tif":Q="image/tiff";break;case"tga":null===this.manager.getHandler(".tga")&&console.warn("FBXLoader: TGA loader not found, skipping ",K),Q="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+ee+'" is not supported.')}if("string"==typeof U)return"data:"+Q+";base64,"+U;var oe=new Uint8Array(U);return window.URL.createObjectURL(new Blob([oe],{type:Q}))},parseTextures:function(k){var U=new Map;if("Texture"in s.Objects){var K=s.Objects.Texture;for(var ee in K){var Q=this.parseTexture(K[ee],k);U.set(parseInt(ee),Q)}}return U},parseTexture:function(k,U){var K=this.loadTexture(k,U);K.ID=k.id,K.name=k.attrName;var ee=k.WrapModeU,Q=k.WrapModeV,me=void 0!==Q?Q.value:0;if(K.wrapS=0===(void 0!==ee?ee.value:0)?RepeatWrapping:ClampToEdgeWrapping,K.wrapT=0===me?RepeatWrapping:ClampToEdgeWrapping,"Scaling"in k){var fe=k.Scaling.value;K.repeat.x=fe[0],K.repeat.y=fe[1]}return K},loadTexture:function(k,U){var K,ee=this.textureLoader.path,Q=e.get(k.id).children;void 0!==Q&&Q.length>0&&void 0!==U[Q[0].ID]&&(0===(K=U[Q[0].ID]).indexOf("blob:")||0===K.indexOf("data:"))&&this.textureLoader.setPath(void 0);var oe,me=k.FileName.slice(-3).toLowerCase();if("tga"===me){var fe=this.manager.getHandler(".tga");null===fe?(console.warn("FBXLoader: TGA loader not found, creating placeholder texture for",k.RelativeFilename),oe=new Texture):oe=fe.load(K)}else"psd"===me?(console.warn("FBXLoader: PSD textures are not supported, creating placeholder texture for",k.RelativeFilename),oe=new Texture):oe=this.textureLoader.load(K);return this.textureLoader.setPath(ee),oe},parseMaterials:function(k){var U=new Map;if("Material"in s.Objects){var K=s.Objects.Material;for(var ee in K){var Q=this.parseMaterial(K[ee],k);null!==Q&&U.set(parseInt(ee),Q)}}return U},parseMaterial:function(k,U){var K=k.id,ee=k.attrName,Q=k.ShadingModel;if("object"==typeof Q&&(Q=Q.value),!e.has(K))return null;var me,oe=this.parseParameters(k,U,K);switch(Q.toLowerCase()){case"phong":me=new MeshPhongMaterial;break;case"lambert":me=new MeshLambertMaterial;break;default:console.warn('FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',Q),me=new MeshPhongMaterial}return me.setValues(oe),me.name=ee,me},parseParameters:function(k,U,K){var ee={};k.BumpFactor&&(ee.bumpScale=k.BumpFactor.value),k.Diffuse?ee.color=(new Color).fromArray(k.Diffuse.value):k.DiffuseColor&&"Color"===k.DiffuseColor.type&&(ee.color=(new Color).fromArray(k.DiffuseColor.value)),k.DisplacementFactor&&(ee.displacementScale=k.DisplacementFactor.value),k.Emissive?ee.emissive=(new Color).fromArray(k.Emissive.value):k.EmissiveColor&&"Color"===k.EmissiveColor.type&&(ee.emissive=(new Color).fromArray(k.EmissiveColor.value)),k.EmissiveFactor&&(ee.emissiveIntensity=parseFloat(k.EmissiveFactor.value)),k.Opacity&&(ee.opacity=parseFloat(k.Opacity.value)),ee.opacity<1&&(ee.transparent=!0),k.ReflectionFactor&&(ee.reflectivity=k.ReflectionFactor.value),k.Shininess&&(ee.shininess=k.Shininess.value),k.Specular?ee.specular=(new Color).fromArray(k.Specular.value):k.SpecularColor&&"Color"===k.SpecularColor.type&&(ee.specular=(new Color).fromArray(k.SpecularColor.value));var Q=this;return e.get(K).children.forEach(function(oe){var me=oe.relationship;switch(me){case"Bump":ee.bumpMap=Q.getTexture(U,oe.ID);break;case"Maya|TEX_ao_map":ee.aoMap=Q.getTexture(U,oe.ID);break;case"DiffuseColor":case"Maya|TEX_color_map":ee.map=Q.getTexture(U,oe.ID),ee.map.encoding=sRGBEncoding;break;case"DisplacementColor":ee.displacementMap=Q.getTexture(U,oe.ID);break;case"EmissiveColor":ee.emissiveMap=Q.getTexture(U,oe.ID),ee.emissiveMap.encoding=sRGBEncoding;break;case"NormalMap":case"Maya|TEX_normal_map":ee.normalMap=Q.getTexture(U,oe.ID);break;case"ReflectionColor":ee.envMap=Q.getTexture(U,oe.ID),ee.envMap.mapping=EquirectangularReflectionMapping,ee.envMap.encoding=sRGBEncoding;break;case"SpecularColor":ee.specularMap=Q.getTexture(U,oe.ID),ee.specularMap.encoding=sRGBEncoding;break;case"TransparentColor":ee.alphaMap=Q.getTexture(U,oe.ID),ee.transparent=!0;break;default:console.warn("FBXLoader: %s map is not supported in three.js, skipping texture.",me)}}),ee},getTexture:function(k,U){return"LayeredTexture"in s.Objects&&U in s.Objects.LayeredTexture&&(console.warn("FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),U=e.get(U).children[0].ID),k.get(U)},parseDeformers:function(){var k={},U={};if("Deformer"in s.Objects){var K=s.Objects.Deformer;for(var ee in K){var Q=K[ee],oe=e.get(parseInt(ee));if("Skin"===Q.attrType){var me=this.parseSkeleton(oe,K);me.ID=ee,oe.parents.length>1&&console.warn("FBXLoader: skeleton attached to more than one geometry is not supported."),me.geometryID=oe.parents[0].ID,k[ee]=me}else if("BlendShape"===Q.attrType){var fe={id:ee};fe.rawTargets=this.parseMorphTargets(oe,K),fe.id=ee,oe.parents.length>1&&console.warn("FBXLoader: morph target attached to more than one geometry is not supported."),U[ee]=fe}}}return{skeletons:k,morphTargets:U}},parseSkeleton:function(k,U){var K=[];return k.children.forEach(function(ee){var Q=U[ee.ID];if("Cluster"===Q.attrType){var oe={ID:ee.ID,indices:[],weights:[],transformLink:(new Matrix4).fromArray(Q.TransformLink.a)};"Indexes"in Q&&(oe.indices=Q.Indexes.a,oe.weights=Q.Weights.a),K.push(oe)}}),{rawBones:K,bones:[]}},parseMorphTargets:function(k,U){for(var K=[],ee=0;ee<k.children.length;ee++){var Q=k.children[ee],oe=U[Q.ID],me={name:oe.attrName,initialWeight:oe.DeformPercent,id:oe.id,fullWeights:oe.FullWeights.a};if("BlendShapeChannel"!==oe.attrType)return;me.geoID=e.get(parseInt(Q.ID)).children.filter(function(fe){return void 0===fe.relationship})[0].ID,K.push(me)}return K},parseScene:function(k,U,K){a=new Group;var ee=this.parseModels(k.skeletons,U,K),Q=s.Objects.Model,oe=this;ee.forEach(function(fe){oe.setLookAtProperties(fe,Q[fe.ID]),e.get(fe.ID).parents.forEach(function(ue){var Y=ee.get(ue.ID);void 0!==Y&&Y.add(fe)}),null===fe.parent&&a.add(fe)}),this.bindSkeleton(k.skeletons,U,ee),this.createAmbientLight(),this.setupMorphMaterials(),a.traverse(function(fe){if(fe.userData.transformData){fe.parent&&(fe.userData.transformData.parentMatrixWorld=fe.parent.matrix);var ge=V(fe.userData.transformData);fe.applyMatrix4(ge)}});var me=(new C).parse();1===a.children.length&&a.children[0].isGroup&&(a.children[0].animations=me,a=a.children[0]),a.animations=me},parseModels:function(k,U,K){var ee=new Map,Q=s.Objects.Model;for(var oe in Q){var me=parseInt(oe),fe=Q[oe],ge=e.get(me),$=this.buildSkeleton(ge,k,me,fe.attrName);if(!$){switch(fe.attrType){case"Camera":$=this.createCamera(ge);break;case"Light":$=this.createLight(ge);break;case"Mesh":$=this.createMesh(ge,U,K);break;case"NurbsCurve":$=this.createCurve(ge,U);break;case"LimbNode":case"Root":$=new Bone;break;default:$=new Group}$.name=fe.attrName?PropertyBinding.sanitizeNodeName(fe.attrName):"",$.ID=me}this.getTransformData($,fe),ee.set(me,$)}return ee},buildSkeleton:function(k,U,K,ee){var Q=null;return k.parents.forEach(function(oe){for(var me in U){var fe=U[me];fe.rawBones.forEach(function(ge,$){if(ge.ID===oe.ID){var ue=Q;(Q=new Bone).matrixWorld.copy(ge.transformLink),Q.name=ee?PropertyBinding.sanitizeNodeName(ee):"",Q.ID=K,fe.bones[$]=Q,null!==ue&&Q.add(ue)}})}}),Q},createCamera:function(k){var U,K;if(k.children.forEach(function(Y){var Z=s.Objects.NodeAttribute[Y.ID];void 0!==Z&&(K=Z)}),void 0===K)U=new Object3D;else{var ee=0;void 0!==K.CameraProjectionType&&1===K.CameraProjectionType.value&&(ee=1);var Q=1;void 0!==K.NearPlane&&(Q=K.NearPlane.value/1e3);var oe=1e3;void 0!==K.FarPlane&&(oe=K.FarPlane.value/1e3);var me=window.innerWidth,fe=window.innerHeight;void 0!==K.AspectWidth&&void 0!==K.AspectHeight&&(me=K.AspectWidth.value,fe=K.AspectHeight.value);var ge=me/fe,$=45;void 0!==K.FieldOfView&&($=K.FieldOfView.value);var ue=K.FocalLength?K.FocalLength.value:null;switch(ee){case 0:U=new PerspectiveCamera($,ge,Q,oe),null!==ue&&U.setFocalLength(ue);break;case 1:U=new OrthographicCamera(-me/2,me/2,fe/2,-fe/2,Q,oe);break;default:console.warn("FBXLoader: Unknown camera type "+ee+"."),U=new Object3D}}return U},createLight:function(k){var U,K;if(k.children.forEach(function(ue){var Y=s.Objects.NodeAttribute[ue.ID];void 0!==Y&&(K=Y)}),void 0===K)U=new Object3D;else{var ee;ee=void 0===K.LightType?0:K.LightType.value;var Q=16777215;void 0!==K.Color&&(Q=(new Color).fromArray(K.Color.value));var oe=void 0===K.Intensity?1:K.Intensity.value/100;void 0!==K.CastLightOnObject&&0===K.CastLightOnObject.value&&(oe=0);var me=0;switch(void 0!==K.FarAttenuationEnd&&(me=void 0!==K.EnableFarAttenuation&&0===K.EnableFarAttenuation.value?0:K.FarAttenuationEnd.value),ee){case 0:U=new PointLight(Q,oe,me,1);break;case 1:U=new DirectionalLight(Q,oe);break;case 2:var ge=Math.PI/3;void 0!==K.InnerAngle&&(ge=MathUtils.degToRad(K.InnerAngle.value));var $=0;void 0!==K.OuterAngle&&($=MathUtils.degToRad(K.OuterAngle.value),$=Math.max($,1)),U=new SpotLight(Q,oe,me,ge,$,1);break;default:console.warn("FBXLoader: Unknown light type "+K.LightType.value+", defaulting to a PointLight."),U=new PointLight(Q,oe)}void 0!==K.CastShadows&&1===K.CastShadows.value&&(U.castShadow=!0)}return U},createMesh:function(k,U,K){var ee,Q=null,oe=null,me=[];return k.children.forEach(function(fe){U.has(fe.ID)&&(Q=U.get(fe.ID)),K.has(fe.ID)&&me.push(K.get(fe.ID))}),me.length>1?oe=me:me.length>0?oe=me[0]:(oe=new MeshPhongMaterial({color:13421772}),me.push(oe)),"color"in Q.attributes&&me.forEach(function(fe){fe.vertexColors=VertexColors}),Q.FBX_Deformer?(me.forEach(function(fe){fe.skinning=!0}),(ee=new SkinnedMesh(Q,oe)).normalizeSkinWeights()):ee=new Mesh(Q,oe),ee},createCurve:function(k,U){return new Line(k.children.reduce(function(Q,oe){return U.has(oe.ID)&&(Q=U.get(oe.ID)),Q},null),new LineBasicMaterial({color:3342591,linewidth:1}))},getTransformData:function(k,U){var K={};"InheritType"in U&&(K.inheritType=parseInt(U.InheritType.value)),K.eulerOrder="RotationOrder"in U?z(U.RotationOrder.value):"ZYX","Lcl_Translation"in U&&(K.translation=U.Lcl_Translation.value),"PreRotation"in U&&(K.preRotation=U.PreRotation.value),"Lcl_Rotation"in U&&(K.rotation=U.Lcl_Rotation.value),"PostRotation"in U&&(K.postRotation=U.PostRotation.value),"Lcl_Scaling"in U&&(K.scale=U.Lcl_Scaling.value),"ScalingOffset"in U&&(K.scalingOffset=U.ScalingOffset.value),"ScalingPivot"in U&&(K.scalingPivot=U.ScalingPivot.value),"RotationOffset"in U&&(K.rotationOffset=U.RotationOffset.value),"RotationPivot"in U&&(K.rotationPivot=U.RotationPivot.value),k.userData.transformData=K},setLookAtProperties:function(k,U){"LookAtProperty"in U&&e.get(k.ID).children.forEach(function(ee){if("LookAtProperty"===ee.relationship){var Q=s.Objects.Model[ee.ID];if("Lcl_Translation"in Q){var oe=Q.Lcl_Translation.value;void 0!==k.target?(k.target.position.fromArray(oe),a.add(k.target)):k.lookAt((new Vector3).fromArray(oe))}}})},bindSkeleton:function(k,U,K){var ee=this.parsePoseNodes();for(var Q in k){var oe=k[Q];e.get(parseInt(oe.ID)).parents.forEach(function(fe){U.has(fe.ID)&&e.get(fe.ID).parents.forEach(function(ue){K.has(ue.ID)&&K.get(ue.ID).bind(new Skeleton(oe.bones),ee[ue.ID])})})}},parsePoseNodes:function(){var k={};if("Pose"in s.Objects){var U=s.Objects.Pose;for(var K in U)if("BindPose"===U[K].attrType){var ee=U[K].PoseNode;Array.isArray(ee)?ee.forEach(function(Q){k[Q.Node]=(new Matrix4).fromArray(Q.Matrix.a)}):k[ee.Node]=(new Matrix4).fromArray(ee.Matrix.a)}}return k},createAmbientLight:function(){if("GlobalSettings"in s&&"AmbientColor"in s.GlobalSettings){var k=s.GlobalSettings.AmbientColor.value,U=k[0],K=k[1],ee=k[2];if(0!==U||0!==K||0!==ee){var Q=new Color(U,K,ee);a.add(new AmbientLight(Q,1))}}},setupMorphMaterials:function(){var k=this;a.traverse(function(U){U.isMesh&&U.geometry.morphAttributes.position&&U.geometry.morphAttributes.position.length&&(Array.isArray(U.material)?U.material.forEach(function(K,ee){k.setupMorphMaterial(U,K,ee)}):k.setupMorphMaterial(U,U.material))})},setupMorphMaterial:function(k,U,K){var ee=k.uuid,Q=U.uuid,oe=!1;if(a.traverse(function(fe){fe.isMesh&&(Array.isArray(fe.material)?fe.material.forEach(function(ge){ge.uuid===Q&&fe.uuid!==ee&&(oe=!0)}):fe.material.uuid===Q&&fe.uuid!==ee&&(oe=!0))}),!0===oe){var me=U.clone();me.morphTargets=!0,void 0===K?k.material=me:k.material[K]=me}else U.morphTargets=!0}},g.prototype={constructor:g,parse:function(k){var U=new Map;if("Geometry"in s.Objects){var K=s.Objects.Geometry;for(var ee in K){var Q=e.get(parseInt(ee)),oe=this.parseGeometry(Q,K[ee],k);U.set(parseInt(ee),oe)}}return U},parseGeometry:function(k,U,K){switch(U.attrType){case"Mesh":return this.parseMeshGeometry(k,U,K);case"NurbsCurve":return this.parseNurbsGeometry(U)}},parseMeshGeometry:function(k,U,K){var ee=K.skeletons,Q=[],oe=k.parents.map(function(ue){return s.Objects.Model[ue.ID]});if(0!==oe.length){var me=k.children.reduce(function(ue,Y){return void 0!==ee[Y.ID]&&(ue=ee[Y.ID]),ue},null);k.children.forEach(function(ue){void 0!==K.morphTargets[ue.ID]&&Q.push(K.morphTargets[ue.ID])});var fe=oe[0],ge={};"RotationOrder"in fe&&(ge.eulerOrder=z(fe.RotationOrder.value)),"InheritType"in fe&&(ge.inheritType=parseInt(fe.InheritType.value)),"GeometricTranslation"in fe&&(ge.translation=fe.GeometricTranslation.value),"GeometricRotation"in fe&&(ge.rotation=fe.GeometricRotation.value),"GeometricScaling"in fe&&(ge.scale=fe.GeometricScaling.value);var $=V(ge);return this.genGeometry(U,me,Q,$)}},genGeometry:function(k,U,K,ee){var Q=new BufferGeometry;k.attrName&&(Q.name=k.attrName);var oe=this.parseGeoNode(k,U),me=this.genBuffers(oe),fe=new Float32BufferAttribute(me.vertex,3);if(fe.applyMatrix4(ee),Q.setAttribute("position",fe),me.colors.length>0&&Q.setAttribute("color",new Float32BufferAttribute(me.colors,3)),U&&(Q.setAttribute("skinIndex",new Uint16BufferAttribute(me.weightsIndices,4)),Q.setAttribute("skinWeight",new Float32BufferAttribute(me.vertexWeights,4)),Q.FBX_Deformer=U),me.normal.length>0){var ge=(new Matrix3).getNormalMatrix(ee),$=new Float32BufferAttribute(me.normal,3);$.applyNormalMatrix(ge),Q.setAttribute("normal",$)}if(me.uvs.forEach(function(ve,le){var _e="uv"+(le+1).toString();0===le&&(_e="uv"),Q.setAttribute(_e,new Float32BufferAttribute(me.uvs[le],2))}),oe.material&&"AllSame"!==oe.material.mappingType){var ue=me.materialIndex[0],Y=0;if(me.materialIndex.forEach(function(ve,le){ve!==ue&&(Q.addGroup(Y,le-Y,ue),ue=ve,Y=le)}),Q.groups.length>0){var Z=Q.groups[Q.groups.length-1],se=Z.start+Z.count;se!==me.materialIndex.length&&Q.addGroup(se,me.materialIndex.length-se,ue)}0===Q.groups.length&&Q.addGroup(0,me.materialIndex.length,me.materialIndex[0])}return this.addMorphTargets(Q,k,K,ee),Q},parseGeoNode:function(k,U){var K={};if(K.vertexPositions=void 0!==k.Vertices?k.Vertices.a:[],K.vertexIndices=void 0!==k.PolygonVertexIndex?k.PolygonVertexIndex.a:[],k.LayerElementColor&&(K.color=this.parseVertexColors(k.LayerElementColor[0])),k.LayerElementMaterial&&(K.material=this.parseMaterialIndices(k.LayerElementMaterial[0])),k.LayerElementNormal&&(K.normal=this.parseNormals(k.LayerElementNormal[0])),k.LayerElementUV){K.uv=[];for(var ee=0;k.LayerElementUV[ee];)K.uv.push(this.parseUVs(k.LayerElementUV[ee])),ee++}return K.weightTable={},null!==U&&(K.skeleton=U,U.rawBones.forEach(function(Q,oe){Q.indices.forEach(function(me,fe){void 0===K.weightTable[me]&&(K.weightTable[me]=[]),K.weightTable[me].push({id:oe,weight:Q.weights[fe]})})})),K},genBuffers:function(k){var U={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]},K=0,ee=0,Q=!1,oe=[],me=[],fe=[],ge=[],$=[],ue=[],Y=this;return k.vertexIndices.forEach(function(Z,se){var ve=!1;Z<0&&(Z^=-1,ve=!0);var le=[],_e=[];if(oe.push(3*Z,3*Z+1,3*Z+2),k.color){var ae=F(se,K,Z,k.color);fe.push(ae[0],ae[1],ae[2])}if(k.skeleton){if(void 0!==k.weightTable[Z]&&k.weightTable[Z].forEach(function(be){_e.push(be.weight),le.push(be.id)}),_e.length>4){Q||(console.warn("FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),Q=!0);var pe=[0,0,0,0],he=[0,0,0,0];_e.forEach(function(be,xe){var we=be,Ne=le[xe];he.forEach(function(Re,De,Je){if(we>Re){Je[De]=we,we=Re;var $e=pe[De];pe[De]=Ne,Ne=$e}})}),le=pe,_e=he}for(;_e.length<4;)_e.push(0),le.push(0);for(var ce=0;ce<4;++ce)$.push(_e[ce]),ue.push(le[ce])}if(k.normal&&(ae=F(se,K,Z,k.normal),me.push(ae[0],ae[1],ae[2])),k.material&&"AllSame"!==k.material.mappingType)var Te=F(se,K,Z,k.material)[0];k.uv&&k.uv.forEach(function(be,xe){var we=F(se,K,Z,be);void 0===ge[xe]&&(ge[xe]=[]),ge[xe].push(we[0]),ge[xe].push(we[1])}),ee++,ve&&(Y.genFace(U,k,oe,Te,me,fe,ge,$,ue,ee),K++,ee=0,oe=[],me=[],fe=[],ge=[],$=[],ue=[])}),U},genFace:function(k,U,K,ee,Q,oe,me,fe,ge,$){for(var ue=2;ue<$;ue++)k.vertex.push(U.vertexPositions[K[0]]),k.vertex.push(U.vertexPositions[K[1]]),k.vertex.push(U.vertexPositions[K[2]]),k.vertex.push(U.vertexPositions[K[3*(ue-1)]]),k.vertex.push(U.vertexPositions[K[3*(ue-1)+1]]),k.vertex.push(U.vertexPositions[K[3*(ue-1)+2]]),k.vertex.push(U.vertexPositions[K[3*ue]]),k.vertex.push(U.vertexPositions[K[3*ue+1]]),k.vertex.push(U.vertexPositions[K[3*ue+2]]),U.skeleton&&(k.vertexWeights.push(fe[0]),k.vertexWeights.push(fe[1]),k.vertexWeights.push(fe[2]),k.vertexWeights.push(fe[3]),k.vertexWeights.push(fe[4*(ue-1)]),k.vertexWeights.push(fe[4*(ue-1)+1]),k.vertexWeights.push(fe[4*(ue-1)+2]),k.vertexWeights.push(fe[4*(ue-1)+3]),k.vertexWeights.push(fe[4*ue]),k.vertexWeights.push(fe[4*ue+1]),k.vertexWeights.push(fe[4*ue+2]),k.vertexWeights.push(fe[4*ue+3]),k.weightsIndices.push(ge[0]),k.weightsIndices.push(ge[1]),k.weightsIndices.push(ge[2]),k.weightsIndices.push(ge[3]),k.weightsIndices.push(ge[4*(ue-1)]),k.weightsIndices.push(ge[4*(ue-1)+1]),k.weightsIndices.push(ge[4*(ue-1)+2]),k.weightsIndices.push(ge[4*(ue-1)+3]),k.weightsIndices.push(ge[4*ue]),k.weightsIndices.push(ge[4*ue+1]),k.weightsIndices.push(ge[4*ue+2]),k.weightsIndices.push(ge[4*ue+3])),U.color&&(k.colors.push(oe[0]),k.colors.push(oe[1]),k.colors.push(oe[2]),k.colors.push(oe[3*(ue-1)]),k.colors.push(oe[3*(ue-1)+1]),k.colors.push(oe[3*(ue-1)+2]),k.colors.push(oe[3*ue]),k.colors.push(oe[3*ue+1]),k.colors.push(oe[3*ue+2])),U.material&&"AllSame"!==U.material.mappingType&&(k.materialIndex.push(ee),k.materialIndex.push(ee),k.materialIndex.push(ee)),U.normal&&(k.normal.push(Q[0]),k.normal.push(Q[1]),k.normal.push(Q[2]),k.normal.push(Q[3*(ue-1)]),k.normal.push(Q[3*(ue-1)+1]),k.normal.push(Q[3*(ue-1)+2]),k.normal.push(Q[3*ue]),k.normal.push(Q[3*ue+1]),k.normal.push(Q[3*ue+2])),U.uv&&U.uv.forEach(function(Y,Z){void 0===k.uvs[Z]&&(k.uvs[Z]=[]),k.uvs[Z].push(me[Z][0]),k.uvs[Z].push(me[Z][1]),k.uvs[Z].push(me[Z][2*(ue-1)]),k.uvs[Z].push(me[Z][2*(ue-1)+1]),k.uvs[Z].push(me[Z][2*ue]),k.uvs[Z].push(me[Z][2*ue+1])})},addMorphTargets:function(k,U,K,ee){if(0!==K.length){k.morphTargetsRelative=!0,k.morphAttributes.position=[];var Q=this;K.forEach(function(oe){oe.rawTargets.forEach(function(me){var fe=s.Objects.Geometry[me.geoID];void 0!==fe&&Q.genMorphGeometry(k,U,fe,ee,me.name)})})}},genMorphGeometry:function(k,U,K,ee,Q){for(var oe=void 0!==U.PolygonVertexIndex?U.PolygonVertexIndex.a:[],me=void 0!==K.Vertices?K.Vertices.a:[],fe=void 0!==K.Indexes?K.Indexes.a:[],$=new Float32Array(3*k.attributes.position.count),ue=0;ue<fe.length;ue++){var Y=3*fe[ue];$[Y]=me[3*ue],$[Y+1]=me[3*ue+1],$[Y+2]=me[3*ue+2]}var ve=new Float32BufferAttribute(this.genBuffers({vertexIndices:oe,vertexPositions:$}).vertex,3);ve.name=Q||K.attrName,ve.applyMatrix4(ee),k.morphAttributes.position.push(ve)},parseNormals:function(k){var K=k.ReferenceInformationType,Q=[];return"IndexToDirect"===K&&("NormalIndex"in k?Q=k.NormalIndex.a:"NormalsIndex"in k&&(Q=k.NormalsIndex.a)),{dataSize:3,buffer:k.Normals.a,indices:Q,mappingType:k.MappingInformationType,referenceType:K}},parseUVs:function(k){var K=k.ReferenceInformationType,Q=[];return"IndexToDirect"===K&&(Q=k.UVIndex.a),{dataSize:2,buffer:k.UV.a,indices:Q,mappingType:k.MappingInformationType,referenceType:K}},parseVertexColors:function(k){var K=k.ReferenceInformationType,Q=[];return"IndexToDirect"===K&&(Q=k.ColorIndex.a),{dataSize:4,buffer:k.Colors.a,indices:Q,mappingType:k.MappingInformationType,referenceType:K}},parseMaterialIndices:function(k){var U=k.MappingInformationType,K=k.ReferenceInformationType;if("NoMappingInformation"===U)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:K};for(var ee=k.Materials.a,Q=[],oe=0;oe<ee.length;++oe)Q.push(oe);return{dataSize:1,buffer:ee,indices:Q,mappingType:U,referenceType:K}},parseNurbsGeometry:function(k){if(void 0===NURBSCurve)return console.error("FBXLoader: The loader relies on NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new BufferGeometry;var ge,$,U=parseInt(k.Order);if(isNaN(U))return console.error("FBXLoader: Invalid Order %s given for geometry ID: %s",k.Order,k.id),new BufferGeometry;for(var K=U-1,ee=k.KnotVector.a,Q=[],oe=k.Points.a,me=0,fe=oe.length;me<fe;me+=4)Q.push((new Vector4).fromArray(oe,me));if("Closed"===k.Form)Q.push(Q[0]);else if("Periodic"===k.Form)for($=ee.length-1-(ge=K),me=0;me<K;++me)Q.push(Q[me]);var Y=new NURBSCurve(K,ee,Q,ge,$).getPoints(7*Q.length),Z=new Float32Array(3*Y.length);Y.forEach(function(ve,le){ve.toArray(Z,3*le)});var se=new BufferGeometry;return se.setAttribute("position",new BufferAttribute(Z,3)),se}},C.prototype={constructor:C,parse:function(){var k=[],U=this.parseClips();if(void 0!==U)for(var K in U){var Q=this.addClip(U[K]);k.push(Q)}return k},parseClips:function(){if(void 0!==s.Objects.AnimationCurve){var k=this.parseAnimationCurveNodes();this.parseAnimationCurves(k);var U=this.parseAnimationLayers(k);return this.parseAnimStacks(U)}},parseAnimationCurveNodes:function(){var k=s.Objects.AnimationCurveNode,U=new Map;for(var K in k){var ee=k[K];if(null!==ee.attrName.match(/S|R|T|DeformPercent/)){var Q={id:ee.id,attr:ee.attrName,curves:{}};U.set(Q.id,Q)}}return U},parseAnimationCurves:function(k){var U=s.Objects.AnimationCurve;for(var K in U){var ee={id:U[K].id,times:U[K].KeyTime.a.map(O),values:U[K].KeyValueFloat.a},Q=e.get(ee.id);if(void 0!==Q){var oe=Q.parents[0].ID,me=Q.parents[0].relationship;me.match(/X/)?k.get(oe).curves.x=ee:me.match(/Y/)?k.get(oe).curves.y=ee:me.match(/Z/)?k.get(oe).curves.z=ee:me.match(/d|DeformPercent/)&&k.has(oe)&&(k.get(oe).curves.morph=ee)}}},parseAnimationLayers:function(k){var U=s.Objects.AnimationLayer,K=new Map;for(var ee in U){var Q=[],oe=e.get(parseInt(ee));void 0!==oe&&(oe.children.forEach(function(fe,ge){if(k.has(fe.ID)){var $=k.get(fe.ID);if(void 0!==$.curves.x||void 0!==$.curves.y||void 0!==$.curves.z){if(void 0===Q[ge]&&void 0!==(ue=e.get(fe.ID).parents.filter(function(_e){return void 0!==_e.relationship})[0].ID)){var Z={modelName:(Y=s.Objects.Model[ue.toString()]).attrName?PropertyBinding.sanitizeNodeName(Y.attrName):"",ID:Y.id,initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};a.traverse(function(_e){_e.ID===Y.id&&(Z.transform=_e.matrix,_e.userData.transformData&&(Z.eulerOrder=_e.userData.transformData.eulerOrder))}),Z.transform||(Z.transform=new Matrix4),"PreRotation"in Y&&(Z.preRotation=Y.PreRotation.value),"PostRotation"in Y&&(Z.postRotation=Y.PostRotation.value),Q[ge]=Z}Q[ge]&&(Q[ge][$.attr]=$)}else if(void 0!==$.curves.morph){if(void 0===Q[ge]){var Y,se=e.get(fe.ID).parents.filter(function(he){return void 0!==he.relationship})[0].ID,ve=e.get(se).parents[0].ID,le=e.get(ve).parents[0].ID,ue=e.get(le).parents[0].ID;Z={modelName:(Y=s.Objects.Model[ue]).attrName?PropertyBinding.sanitizeNodeName(Y.attrName):"",morphName:s.Objects.Deformer[se].attrName},Q[ge]=Z}Q[ge][$.attr]=$}}}),K.set(parseInt(ee),Q))}return K},parseAnimStacks:function(k){var U=s.Objects.AnimationStack,K={};for(var ee in U){var Q=e.get(parseInt(ee)).children;Q.length>1&&console.warn("FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");var oe=k.get(Q[0].ID);K[ee]={name:U[ee].attrName,layer:oe}}return K},addClip:function(k){var U=[],K=this;return k.layer.forEach(function(ee){U=U.concat(K.generateTracks(ee))}),new AnimationClip(k.name,-1,U)},generateTracks:function(k){var U=[],K=new Vector3,ee=new Quaternion,Q=new Vector3;if(k.transform&&k.transform.decompose(K,ee,Q),K=K.toArray(),ee=(new Euler).setFromQuaternion(ee,k.eulerOrder).toArray(),Q=Q.toArray(),void 0!==k.T&&Object.keys(k.T.curves).length>0){var oe=this.generateVectorTrack(k.modelName,k.T.curves,K,"position");void 0!==oe&&U.push(oe)}if(void 0!==k.R&&Object.keys(k.R.curves).length>0){var me=this.generateRotationTrack(k.modelName,k.R.curves,ee,k.preRotation,k.postRotation,k.eulerOrder);void 0!==me&&U.push(me)}if(void 0!==k.S&&Object.keys(k.S.curves).length>0){var fe=this.generateVectorTrack(k.modelName,k.S.curves,Q,"scale");void 0!==fe&&U.push(fe)}if(void 0!==k.DeformPercent){var ge=this.generateMorphTrack(k);void 0!==ge&&U.push(ge)}return U},generateVectorTrack:function(k,U,K,ee){var Q=this.getTimesForAllAxes(U);return new VectorKeyframeTrack(k+"."+ee,Q,this.getKeyframeTrackValues(Q,U,K))},generateRotationTrack:function(k,U,K,ee,Q,oe){void 0!==U.x&&(this.interpolateRotations(U.x),U.x.values=U.x.values.map(MathUtils.degToRad)),void 0!==U.y&&(this.interpolateRotations(U.y),U.y.values=U.y.values.map(MathUtils.degToRad)),void 0!==U.z&&(this.interpolateRotations(U.z),U.z.values=U.z.values.map(MathUtils.degToRad));var me=this.getTimesForAllAxes(U),fe=this.getKeyframeTrackValues(me,U,K);void 0!==ee&&((ee=ee.map(MathUtils.degToRad)).push(oe),ee=(new Euler).fromArray(ee),ee=(new Quaternion).setFromEuler(ee)),void 0!==Q&&((Q=Q.map(MathUtils.degToRad)).push(oe),Q=(new Euler).fromArray(Q),Q=(new Quaternion).setFromEuler(Q).inverse());for(var ge=new Quaternion,$=new Euler,ue=[],Y=0;Y<fe.length;Y+=3)$.set(fe[Y],fe[Y+1],fe[Y+2],oe),ge.setFromEuler($),void 0!==ee&&ge.premultiply(ee),void 0!==Q&&ge.multiply(Q),ge.toArray(ue,Y/3*4);return new QuaternionKeyframeTrack(k+".quaternion",me,ue)},generateMorphTrack:function(k){var U=k.DeformPercent.curves.morph,K=U.values.map(function(Q){return Q/100}),ee=a.getObjectByName(k.modelName).morphTargetDictionary[k.morphName];return new NumberKeyframeTrack(k.modelName+".morphTargetInfluences["+ee+"]",U.times,K)},getTimesForAllAxes:function(k){var U=[];return void 0!==k.x&&(U=U.concat(k.x.times)),void 0!==k.y&&(U=U.concat(k.y.times)),void 0!==k.z&&(U=U.concat(k.z.times)),U.sort(function(K,ee){return K-ee}).filter(function(K,ee,Q){return Q.indexOf(K)==ee})},getKeyframeTrackValues:function(k,U,K){var ee=K,Q=[],oe=-1,me=-1,fe=-1;return k.forEach(function(ge){if(U.x&&(oe=U.x.times.indexOf(ge)),U.y&&(me=U.y.times.indexOf(ge)),U.z&&(fe=U.z.times.indexOf(ge)),-1!==oe){var $=U.x.values[oe];Q.push($),ee[0]=$}else Q.push(ee[0]);if(-1!==me){var ue=U.y.values[me];Q.push(ue),ee[1]=ue}else Q.push(ee[1]);if(-1!==fe){var Y=U.z.values[fe];Q.push(Y),ee[2]=Y}else Q.push(ee[2])}),Q},interpolateRotations:function(k){for(var U=1;U<k.values.length;U++){var K=k.values[U-1],ee=k.values[U]-K,Q=Math.abs(ee);if(Q>=180){for(var oe=Q/180,me=ee/oe,fe=K+me,ge=k.times[U-1],ue=(k.times[U]-ge)/oe,Y=ge+ue,Z=[],se=[];Y<k.times[U];)Z.push(Y),Y+=ue,se.push(fe),fe+=me;k.times=te(k.times,U,Z),k.values=te(k.values,U,se)}}}},w.prototype={constructor:w,getPrevNode:function(){return this.nodeStack[this.currentIndent-2]},getCurrentNode:function(){return this.nodeStack[this.currentIndent-1]},getCurrentProp:function(){return this.currentProp},pushStack:function(k){this.nodeStack.push(k),this.currentIndent+=1},popStack:function(){this.nodeStack.pop(),this.currentIndent-=1},setCurrentProp:function(k,U){this.currentProp=k,this.currentPropName=U},parse:function(k){this.currentIndent=0,this.allNodes=new b,this.nodeStack=[],this.currentProp=[],this.currentPropName="";var U=this,K=k.split(/[\r\n]+/);return K.forEach(function(ee,Q){var oe=ee.match(/^[\s\t]*;/),me=ee.match(/^[\s\t]*$/);if(!oe&&!me){var fe=ee.match("^\\t{"+U.currentIndent+"}(\\w+):(.*){",""),ge=ee.match("^\\t{"+U.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),$=ee.match("^\\t{"+(U.currentIndent-1)+"}}");fe?U.parseNodeBegin(ee,fe):ge?U.parseNodeProperty(ee,ge,K[++Q]):$?U.popStack():ee.match(/^[^\s\t}]/)&&U.parseNodePropertyContinued(ee)}}),this.allNodes},parseNodeBegin:function(k,U){var K=U[1].trim().replace(/^"/,"").replace(/"$/,""),ee=U[2].split(",").map(function(fe){return fe.trim().replace(/^"/,"").replace(/"$/,"")}),Q={name:K},oe=this.parseNodeAttr(ee),me=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(K,Q):K in me?("PoseNode"===K?me.PoseNode.push(Q):void 0!==me[K].id&&(me[K]={},me[K][me[K].id]=me[K]),""!==oe.id&&(me[K][oe.id]=Q)):"number"==typeof oe.id?(me[K]={},me[K][oe.id]=Q):"Properties70"!==K&&(me[K]="PoseNode"===K?[Q]:Q),"number"==typeof oe.id&&(Q.id=oe.id),""!==oe.name&&(Q.attrName=oe.name),""!==oe.type&&(Q.attrType=oe.type),this.pushStack(Q)},parseNodeAttr:function(k){var U=k[0];""!==k[0]&&(U=parseInt(k[0]),isNaN(U)&&(U=k[0]));var K="",ee="";return k.length>1&&(K=k[1].replace(/^(\w+)::/,""),ee=k[2]),{id:U,name:K,type:ee}},parseNodeProperty:function(k,U,K){var ee=U[1].replace(/^"/,"").replace(/"$/,"").trim(),Q=U[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===ee&&","===Q&&(Q=K.replace(/"/g,"").replace(/,$/,"").trim());var oe=this.getCurrentNode();if("Properties70"!==oe.name){if("C"===ee){var fe=Q.split(",").slice(1),ge=parseInt(fe[0]),$=parseInt(fe[1]),ue=Q.split(",").slice(3);ee="connections",function(J,k){for(var U=0,K=J.length,ee=k.length;U<ee;U++,K++)J[K]=k[U]}(Q=[ge,$],ue=ue.map(function(Y){return Y.trim().replace(/^"/,"")})),void 0===oe[ee]&&(oe[ee]=[])}"Node"===ee&&(oe.id=Q),ee in oe&&Array.isArray(oe[ee])?oe[ee].push(Q):"a"!==ee?oe[ee]=Q:oe.a=Q,this.setCurrentProp(oe,ee),"a"===ee&&","!==Q.slice(-1)&&(oe.a=H(Q))}else this.parseNodeSpecialProperty(k,ee,Q)},parseNodePropertyContinued:function(k){var U=this.getCurrentNode();U.a+=k,","!==k.slice(-1)&&(U.a=H(U.a))},parseNodeSpecialProperty:function(k,U,K){var ee=K.split('",').map(function($){return $.trim().replace(/^\"/,"").replace(/\s/,"_")}),Q=ee[0],oe=ee[1],me=ee[2],fe=ee[3],ge=ee[4];switch(oe){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":ge=parseFloat(ge);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":ge=H(ge)}this.getPrevNode()[Q]={type:oe,type2:me,flag:fe,value:ge},this.setCurrentProp(this.getPrevNode(),Q)}},_.prototype={constructor:_,parse:function(k){var U=new x(k);U.skip(23);var K=U.getUint32();console.log("FBXLoader: FBX binary version: "+K);for(var ee=new b;!this.endOfContent(U);){var Q=this.parseNode(U,K);null!==Q&&ee.add(Q.name,Q)}return ee},endOfContent:function(k){return k.size()%16==0?(k.getOffset()+160+16&-16)>=k.size():k.getOffset()+160+16>=k.size()},parseNode:function(k,U){var K={},ee=U>=7500?k.getUint64():k.getUint32(),Q=U>=7500?k.getUint64():k.getUint32(),me=(U>=7500?k.getUint64():k.getUint32(),k.getUint8()),fe=k.getString(me);if(0===ee)return null;for(var ge=[],$=0;$<Q;$++)ge.push(this.parseProperty(k));var ue=ge.length>0?ge[0]:"",Y=ge.length>1?ge[1]:"",Z=ge.length>2?ge[2]:"";for(K.singleProperty=1===Q&&k.getOffset()===ee;ee>k.getOffset();){var se=this.parseNode(k,U);null!==se&&this.parseSubNode(fe,K,se)}return K.propertyList=ge,"number"==typeof ue&&(K.id=ue),""!==Y&&(K.attrName=Y),""!==Z&&(K.attrType=Z),""!==fe&&(K.name=fe),K},parseSubNode:function(k,U,K){if(!0===K.singleProperty){var ee=K.propertyList[0];Array.isArray(ee)?(U[K.name]=K,K.a=ee):U[K.name]=ee}else if("Connections"===k&&"C"===K.name){var Q=[];K.propertyList.forEach(function(Y,Z){0!==Z&&Q.push(Y)}),void 0===U.connections&&(U.connections=[]),U.connections.push(Q)}else if("Properties70"===K.name)Object.keys(K).forEach(function(Y){U[Y]=K[Y]});else if("Properties70"===k&&"P"===K.name){var ue,me=K.propertyList[0],fe=K.propertyList[1],ge=K.propertyList[2],$=K.propertyList[3];0===me.indexOf("Lcl ")&&(me=me.replace("Lcl ","Lcl_")),0===fe.indexOf("Lcl ")&&(fe=fe.replace("Lcl ","Lcl_")),ue="Color"===fe||"ColorRGB"===fe||"Vector"===fe||"Vector3D"===fe||0===fe.indexOf("Lcl_")?[K.propertyList[4],K.propertyList[5],K.propertyList[6]]:K.propertyList[4],U[me]={type:fe,type2:ge,flag:$,value:ue}}else void 0===U[K.name]?"number"==typeof K.id?(U[K.name]={},U[K.name][K.id]=K):U[K.name]=K:"PoseNode"===K.name?(Array.isArray(U[K.name])||(U[K.name]=[U[K.name]]),U[K.name].push(K)):void 0===U[K.name][K.id]&&(U[K.name][K.id]=K)},parseProperty:function(k){var U=k.getString(1);switch(U){case"C":return k.getBoolean();case"D":return k.getFloat64();case"F":return k.getFloat32();case"I":return k.getInt32();case"L":return k.getInt64();case"R":var K=k.getUint32();return k.getArrayBuffer(K);case"S":return K=k.getUint32(),k.getString(K);case"Y":return k.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":var ee=k.getUint32(),Q=k.getUint32(),oe=k.getUint32();if(0===Q)switch(U){case"b":case"c":return k.getBooleanArray(ee);case"d":return k.getFloat64Array(ee);case"f":return k.getFloat32Array(ee);case"i":return k.getInt32Array(ee);case"l":return k.getInt64Array(ee)}"undefined"==typeof Zlib&&console.error("FBXLoader: External library Inflate.min.js required, obtain or import from https://github.com/imaya/zlib.js");var fe=new x(new Zlib.Inflate(new Uint8Array(k.getArrayBuffer(oe))).decompress().buffer);switch(U){case"b":case"c":return fe.getBooleanArray(ee);case"d":return fe.getFloat64Array(ee);case"f":return fe.getFloat32Array(ee);case"i":return fe.getInt32Array(ee);case"l":return fe.getInt64Array(ee)}default:throw new Error("FBXLoader: Unknown property type "+U)}}},x.prototype={constructor:x,getOffset:function(){return this.offset},size:function(){return this.dv.buffer.byteLength},skip:function(k){this.offset+=k},getBoolean:function(){return 1==(1&this.getUint8())},getBooleanArray:function(k){for(var U=[],K=0;K<k;K++)U.push(this.getBoolean());return U},getUint8:function(){var k=this.dv.getUint8(this.offset);return this.offset+=1,k},getInt16:function(){var k=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,k},getInt32:function(){var k=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,k},getInt32Array:function(k){for(var U=[],K=0;K<k;K++)U.push(this.getInt32());return U},getUint32:function(){var k=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,k},getInt64:function(){var k,U;return this.littleEndian?(k=this.getUint32(),U=this.getUint32()):(U=this.getUint32(),k=this.getUint32()),2147483648&U?(U=4294967295&~U,4294967295==(k=4294967295&~k)&&(U=U+1&4294967295),-(4294967296*U+(k=k+1&4294967295))):4294967296*U+k},getInt64Array:function(k){for(var U=[],K=0;K<k;K++)U.push(this.getInt64());return U},getUint64:function(){var k,U;return this.littleEndian?(k=this.getUint32(),U=this.getUint32()):(U=this.getUint32(),k=this.getUint32()),4294967296*U+k},getFloat32:function(){var k=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,k},getFloat32Array:function(k){for(var U=[],K=0;K<k;K++)U.push(this.getFloat32());return U},getFloat64:function(){var k=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,k},getFloat64Array:function(k){for(var U=[],K=0;K<k;K++)U.push(this.getFloat64());return U},getArrayBuffer:function(k){var U=this.dv.buffer.slice(this.offset,this.offset+k);return this.offset+=k,U},getString:function(k){for(var U=[],K=0;K<k;K++)U[K]=this.getUint8();var ee=U.indexOf(0);return ee>=0&&(U=U.slice(0,ee)),LoaderUtils.decodeText(new Uint8Array(U))}},b.prototype={constructor:b,add:function(k,U){this[k]=U}};var D=[];function F(J,k,U,K){var ee;switch(K.mappingType){case"ByPolygonVertex":ee=J;break;case"ByPolygon":ee=k;break;case"ByVertice":ee=U;break;case"AllSame":ee=K.indices[0];break;default:console.warn("FBXLoader: unknown attribute mapping type "+K.mappingType)}"IndexToDirect"===K.referenceType&&(ee=K.indices[ee]);var Q=ee*K.dataSize;return function(J,k,U,K){for(var ee=U,Q=0;ee<K;ee++,Q++)J[Q]=k[ee];return J}(D,K.buffer,Q,Q+K.dataSize)}var L=new Euler,I=new Vector3;function V(J){var Z,k=new Matrix4,U=new Matrix4,K=new Matrix4,ee=new Matrix4,Q=new Matrix4,oe=new Matrix4,me=new Matrix4,fe=new Matrix4,ge=new Matrix4,$=new Matrix4,ue=new Matrix4,Y=J.inheritType?J.inheritType:0;J.translation&&k.setPosition(I.fromArray(J.translation)),J.preRotation&&((Z=J.preRotation.map(MathUtils.degToRad)).push(J.eulerOrder),U.makeRotationFromEuler(L.fromArray(Z))),J.rotation&&((Z=J.rotation.map(MathUtils.degToRad)).push(J.eulerOrder),K.makeRotationFromEuler(L.fromArray(Z))),J.postRotation&&((Z=J.postRotation.map(MathUtils.degToRad)).push(J.eulerOrder),ee.makeRotationFromEuler(L.fromArray(Z))),J.scale&&Q.scale(I.fromArray(J.scale)),J.scalingOffset&&me.setPosition(I.fromArray(J.scalingOffset)),J.scalingPivot&&oe.setPosition(I.fromArray(J.scalingPivot)),J.rotationOffset&&fe.setPosition(I.fromArray(J.rotationOffset)),J.rotationPivot&&ge.setPosition(I.fromArray(J.rotationPivot)),J.parentMatrixWorld&&($=J.parentMatrixWorld);var se=U.multiply(K).multiply(ee),ve=new Matrix4;$.extractRotation(ve);var _e,ae,pe,he,le=new Matrix4;if(le.copyPosition($),pe=le.getInverse(le).multiply($),ae=ve.getInverse(ve).multiply(pe),_e=Q,0===Y)he=ve.multiply(se).multiply(ae).multiply(_e);else if(1===Y)he=ve.multiply(ae).multiply(se).multiply(_e);else{var ce=(new Matrix4).copy(Q),Te=ae.multiply(ce.getInverse(ce));he=ve.multiply(se).multiply(Te).multiply(_e)}var be=k.multiply(fe).multiply(ge).multiply(U).multiply(K).multiply(ee).multiply(ge.getInverse(ge)).multiply(me).multiply(oe).multiply(Q).multiply(oe.getInverse(oe)),xe=(new Matrix4).copyPosition(be),we=$.multiply(xe);return ue.copyPosition(we),ue.multiply(he)}function z(J){var k=["ZYX","YZX","XZY","ZXY","YXZ","XYZ"];return 6===(J=J||0)?(console.warn("FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect."),k[0]):k[J]}function H(J){return J.split(",").map(function(U){return parseFloat(U)})}function X(J,k,U){return void 0===k&&(k=0),void 0===U&&(U=J.byteLength),LoaderUtils.decodeText(new Uint8Array(J,k,U))}function te(J,k,U){return J.slice(0,k).concat(U).concat(J.slice(k))}return d}(),GCodeLoader=function(e){Loader.call(this,e),this.splitLayer=!1};function LineLoop(s,e){Line.call(this,s,e),this.type="LineLoop"}function PointsMaterial(s){Material.call(this),this.type="PointsMaterial",this.color=new Color(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(s)}GCodeLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:GCodeLoader,load:function(e,a,d,v){var g=this,C=new FileLoader(g.manager);C.setPath(g.path),C.load(e,function(w){a(g.parse(w))},d,v)},parse:function(e){var a={x:0,y:0,z:0,e:0,f:0,extruding:!1,relative:!1},d=[],v=void 0,g=new LineBasicMaterial({color:16711680});g.name="path";var X,re,C=new LineBasicMaterial({color:65280});function w(X){d.push(v={vertex:[],pathVertex:[],z:X.z})}function x(X,re){return a.relative?re:re-X}function b(X,re){return a.relative?X+re:re}C.name="extruded";for(var A=e.replace(/;.+/g,"").split("\n"),E=0;E<A.length;E++){var R=A[E].split(" "),O=R[0].toUpperCase(),D={};if(R.splice(1).forEach(function(X){if(void 0!==X[0]){var re=X[0].toLowerCase(),j=parseFloat(X.substring(1));D[re]=j}}),"G0"===O||"G1"===O){var F={x:void 0!==D.x?b(a.x,D.x):a.x,y:void 0!==D.y?b(a.y,D.y):a.y,z:void 0!==D.z?b(a.z,D.z):a.z,e:void 0!==D.e?b(a.e,D.e):a.e,f:void 0!==D.f?b(a.f,D.f):a.f};x(a.e,F.e)>0&&(F.extruding=x(a.e,F.e)>0,(null==v||F.z!=v.z)&&w(F)),X=a,re=F,void 0===v&&w(X),F.extruding?(v.vertex.push(X.x,X.y,X.z),v.vertex.push(re.x,re.y,re.z)):(v.pathVertex.push(X.x,X.y,X.z),v.pathVertex.push(re.x,re.y,re.z)),a=F}else"G2"!==O&&"G3"!==O&&("G90"===O?a.relative=!1:"G91"===O?a.relative=!0:"G92"===O&&((F=a).x=void 0!==D.x?D.x:F.x,F.y=void 0!==D.y?D.y:F.y,F.z=void 0!==D.z?D.z:F.z,F.e=void 0!==D.e?D.e:F.e,a=F))}function L(X,re){var j=new BufferGeometry;j.setAttribute("position",new Float32BufferAttribute(X,3));var te=new LineSegments(j,re?C:g);te.name="layer"+E,I.add(te)}var I=new Group;if(I.name="gcode",this.splitLayer)for(E=0;E<d.length;E++)L((V=d[E]).vertex,!0),L(V.pathVertex,!1);else{var z=[],H=[];for(E=0;E<d.length;E++){var V;z=z.concat((V=d[E]).vertex),H=H.concat(V.pathVertex)}L(z,!0),L(H,!1)}return I.quaternion.setFromEuler(new Euler(-Math.PI/2,0,0)),I}}),LineLoop.prototype=Object.assign(Object.create(Line.prototype),{constructor:LineLoop,isLineLoop:!0}),PointsMaterial.prototype=Object.create(Material.prototype),PointsMaterial.prototype.constructor=PointsMaterial,PointsMaterial.prototype.isPointsMaterial=!0,PointsMaterial.prototype.copy=function(s){return Material.prototype.copy.call(this,s),this.color.copy(s.color),this.map=s.map,this.alphaMap=s.alphaMap,this.size=s.size,this.sizeAttenuation=s.sizeAttenuation,this.morphTargets=s.morphTargets,this};var _inverseMatrix$2=new Matrix4,_ray$2=new Ray,_sphere$3=new Sphere,_position$1=new Vector3;function Points(s,e){Object3D.call(this),this.type="Points",this.geometry=void 0!==s?s:new BufferGeometry,this.material=void 0!==e?e:new PointsMaterial,this.updateMorphTargets()}function testPoint(s,e,a,d,v,g,C){var w=_ray$2.distanceSqToPoint(s);if(w<a){var _=new Vector3;_ray$2.closestPointToPoint(s,_),_.applyMatrix4(d);var x=v.ray.origin.distanceTo(_);if(x<v.near||x>v.far)return;g.push({distance:x,distanceToRay:Math.sqrt(w),point:_,index:e,face:null,object:C})}}Points.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Points,isPoints:!0,raycast:function(e,a){var d=this.geometry,v=this.matrixWorld,g=e.params.Points.threshold;if(null===d.boundingSphere&&d.computeBoundingSphere(),_sphere$3.copy(d.boundingSphere),_sphere$3.applyMatrix4(v),_sphere$3.radius+=g,!1!==e.ray.intersectsSphere(_sphere$3)){_inverseMatrix$2.getInverse(v),_ray$2.copy(e.ray).applyMatrix4(_inverseMatrix$2);var C=g/((this.scale.x+this.scale.y+this.scale.z)/3),w=C*C;if(d.isBufferGeometry){var _=d.index,b=d.attributes.position.array;if(null!==_)for(var A=_.array,E=0,R=A.length;E<R;E++){var O=A[E];_position$1.fromArray(b,3*O),testPoint(_position$1,O,w,v,e,a,this)}else{E=0;for(var D=b.length/3;E<D;E++)_position$1.fromArray(b,3*E),testPoint(_position$1,E,w,v,e,a,this)}}else{var F=d.vertices;for(E=0,D=F.length;E<D;E++)testPoint(F[E],E,w,v,e,a,this)}}},updateMorphTargets:function(){var a,d,v,e=this.geometry;if(e.isBufferGeometry){var g=e.morphAttributes,C=Object.keys(g);if(C.length>0){var w=g[C[0]];if(void 0!==w)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},a=0,d=w.length;a<d;a++)v=w[a].name||String(a),this.morphTargetInfluences.push(0),this.morphTargetDictionary[v]=a}}else{var _=e.morphTargets;void 0!==_&&_.length>0&&console.error("Points.updateMorphTargets() does not support Geometry. Use BufferGeometry instead.")}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var GLTFLoader=function(){function s(Y){Loader.call(this,Y),this.dracoLoader=null,this.ddsLoader=null}function e(){var Y={};return{get:function(se){return Y[se]},add:function(se,ve){Y[se]=ve},remove:function(se){delete Y[se]},removeAll:function(){Y={}}}}s.prototype=Object.assign(Object.create(Loader.prototype),{constructor:s,load:function(Z,se,ve,le){var ae,_e=this;ae=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:LoaderUtils.extractUrlBase(Z),_e.manager.itemStart(Z);var pe=function(Te){le?le(Te):console.error(Te),_e.manager.itemError(Z),_e.manager.itemEnd(Z)},he=new FileLoader(_e.manager);he.setPath(this.path),he.setResponseType("arraybuffer"),"use-credentials"===_e.crossOrigin&&he.setWithCredentials(!0),he.load(Z,function(ce){try{_e.parse(ce,ae,function(Te){se(Te),_e.manager.itemEnd(Z)},pe)}catch(Te){pe(Te)}},ve,pe)},setDRACOLoader:function(Z){return this.dracoLoader=Z,this},setDDSLoader:function(Z){return this.ddsLoader=Z,this},parse:function(Z,se,ve,le){var _e,ae={};if("string"==typeof Z)_e=Z;else if(LoaderUtils.decodeText(new Uint8Array(Z,0,4))===C){try{ae[a.KHR_BINARY_GLTF]=new x(Z)}catch(we){return void(le&&le(we))}_e=ae[a.KHR_BINARY_GLTF].content}else _e=LoaderUtils.decodeText(new Uint8Array(Z));var he=JSON.parse(_e);if(void 0===he.asset||he.asset.version[0]<2)le&&le(new Error("GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{if(he.extensionsUsed)for(var ce=0;ce<he.extensionsUsed.length;++ce){var Te=he.extensionsUsed[ce],be=he.extensionsRequired||[];switch(Te){case a.KHR_LIGHTS_PUNCTUAL:ae[Te]=new v(he);break;case a.KHR_MATERIALS_UNLIT:ae[Te]=new g;break;case a.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:ae[Te]=new R;break;case a.KHR_DRACO_MESH_COMPRESSION:ae[Te]=new b(he,this.dracoLoader);break;case a.MSFT_TEXTURE_DDS:ae[Te]=new d(this.ddsLoader);break;case a.KHR_TEXTURE_TRANSFORM:ae[Te]=new A;break;case a.KHR_MESH_QUANTIZATION:ae[Te]=new O;break;default:be.indexOf(Te)>=0&&console.warn('GLTFLoader: Unknown extension "'+Te+'".')}}new fe(he,ae,{path:se||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager}).parse(ve,le)}}});var a={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function d(Y){if(!Y)throw new Error("GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=a.MSFT_TEXTURE_DDS,this.ddsLoader=Y}function v(Y){this.name=a.KHR_LIGHTS_PUNCTUAL,this.lightDefs=(Y.extensions&&Y.extensions[a.KHR_LIGHTS_PUNCTUAL]||{}).lights||[]}function g(){this.name=a.KHR_MATERIALS_UNLIT}v.prototype.loadLight=function(Y){var se,Z=this.lightDefs[Y],ve=new Color(16777215);void 0!==Z.color&&ve.fromArray(Z.color);var le=void 0!==Z.range?Z.range:0;switch(Z.type){case"directional":(se=new DirectionalLight(ve)).target.position.set(0,0,-1),se.add(se.target);break;case"point":(se=new PointLight(ve)).distance=le;break;case"spot":(se=new SpotLight(ve)).distance=le,Z.spot=Z.spot||{},Z.spot.innerConeAngle=void 0!==Z.spot.innerConeAngle?Z.spot.innerConeAngle:0,Z.spot.outerConeAngle=void 0!==Z.spot.outerConeAngle?Z.spot.outerConeAngle:Math.PI/4,se.angle=Z.spot.outerConeAngle,se.penumbra=1-Z.spot.innerConeAngle/Z.spot.outerConeAngle,se.target.position.set(0,0,-1),se.add(se.target);break;default:throw new Error('GLTFLoader: Unexpected light type, "'+Z.type+'".')}return se.position.set(0,0,0),se.decay=2,void 0!==Z.intensity&&(se.intensity=Z.intensity),se.name=Z.name||"light_"+Y,Promise.resolve(se)},g.prototype.getMaterialType=function(){return MeshBasicMaterial},g.prototype.extendParams=function(Y,Z,se){var ve=[];Y.color=new Color(1,1,1),Y.opacity=1;var le=Z.pbrMetallicRoughness;if(le){if(Array.isArray(le.baseColorFactor)){var _e=le.baseColorFactor;Y.color.fromArray(_e),Y.opacity=_e[3]}void 0!==le.baseColorTexture&&ve.push(se.assignTexture(Y,"map",le.baseColorTexture))}return Promise.all(ve)};var C="glTF";function x(Y){this.name=a.KHR_BINARY_GLTF,this.content=null,this.body=null;var Z=new DataView(Y,0,12);if(this.header={magic:LoaderUtils.decodeText(new Uint8Array(Y.slice(0,4))),version:Z.getUint32(4,!0),length:Z.getUint32(8,!0)},this.header.magic!==C)throw new Error("GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("GLTFLoader: Legacy binary file detected.");for(var se=new DataView(Y,12),ve=0;ve<se.byteLength;){var le=se.getUint32(ve,!0),_e=se.getUint32(ve+=4,!0);if(ve+=4,1313821514===_e){var ae=new Uint8Array(Y,12+ve,le);this.content=LoaderUtils.decodeText(ae)}else if(5130562===_e){var pe=12+ve;this.body=Y.slice(pe,pe+le)}ve+=le}if(null===this.content)throw new Error("GLTFLoader: JSON content not found.")}function b(Y,Z){if(!Z)throw new Error("GLTFLoader: No DRACOLoader instance provided.");this.name=a.KHR_DRACO_MESH_COMPRESSION,this.json=Y,this.dracoLoader=Z,this.dracoLoader.preload()}function A(){this.name=a.KHR_TEXTURE_TRANSFORM}function E(Y){MeshStandardMaterial.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var Z=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),se=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),ve=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),le=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),_e=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),ae={specular:{value:(new Color).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=ae,this.onBeforeCompile=function(pe){for(var he in ae)pe.uniforms[he]=ae[he];pe.fragmentShader=pe.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;"),pe.fragmentShader=pe.fragmentShader.replace("uniform float metalness;","uniform float glossiness;"),pe.fragmentShader=pe.fragmentShader.replace("#include <roughnessmap_pars_fragment>",Z),pe.fragmentShader=pe.fragmentShader.replace("#include <metalnessmap_pars_fragment>",se),pe.fragmentShader=pe.fragmentShader.replace("#include <roughnessmap_fragment>",ve),pe.fragmentShader=pe.fragmentShader.replace("#include <metalnessmap_fragment>",le),pe.fragmentShader=pe.fragmentShader.replace("#include <lights_physical_fragment>",_e)},Object.defineProperties(this,{specular:{get:function(){return ae.specular.value},set:function(he){ae.specular.value=he}},specularMap:{get:function(){return ae.specularMap.value},set:function(he){ae.specularMap.value=he}},glossiness:{get:function(){return ae.glossiness.value},set:function(he){ae.glossiness.value=he}},glossinessMap:{get:function(){return ae.glossinessMap.value},set:function(he){ae.glossinessMap.value=he,he?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_ROUGHNESSMAP=""):(delete this.defines.USE_ROUGHNESSMAP,delete this.defines.USE_GLOSSINESSMAP)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(Y)}function R(){return{name:a.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return E},extendParams:function(Z,se,ve){var le=se.extensions[this.name];Z.color=new Color(1,1,1),Z.opacity=1;var _e=[];if(Array.isArray(le.diffuseFactor)){var ae=le.diffuseFactor;Z.color.fromArray(ae),Z.opacity=ae[3]}if(void 0!==le.diffuseTexture&&_e.push(ve.assignTexture(Z,"map",le.diffuseTexture)),Z.emissive=new Color(0,0,0),Z.glossiness=void 0!==le.glossinessFactor?le.glossinessFactor:1,Z.specular=new Color(1,1,1),Array.isArray(le.specularFactor)&&Z.specular.fromArray(le.specularFactor),void 0!==le.specularGlossinessTexture){var pe=le.specularGlossinessTexture;_e.push(ve.assignTexture(Z,"glossinessMap",pe)),_e.push(ve.assignTexture(Z,"specularMap",pe))}return Promise.all(_e)},createMaterial:function(Z){var se=new E(Z);return se.fog=!0,se.color=Z.color,se.map=void 0===Z.map?null:Z.map,se.lightMap=null,se.lightMapIntensity=1,se.aoMap=void 0===Z.aoMap?null:Z.aoMap,se.aoMapIntensity=1,se.emissive=Z.emissive,se.emissiveIntensity=1,se.emissiveMap=void 0===Z.emissiveMap?null:Z.emissiveMap,se.bumpMap=void 0===Z.bumpMap?null:Z.bumpMap,se.bumpScale=1,se.normalMap=void 0===Z.normalMap?null:Z.normalMap,se.normalMapType=TangentSpaceNormalMap,Z.normalScale&&(se.normalScale=Z.normalScale),se.displacementMap=null,se.displacementScale=1,se.displacementBias=0,se.specularMap=void 0===Z.specularMap?null:Z.specularMap,se.specular=Z.specular,se.glossinessMap=void 0===Z.glossinessMap?null:Z.glossinessMap,se.glossiness=Z.glossiness,se.alphaMap=null,se.envMap=void 0===Z.envMap?null:Z.envMap,se.envMapIntensity=1,se.refractionRatio=.98,se}}}function O(){this.name=a.KHR_MESH_QUANTIZATION}function D(Y,Z,se,ve){Interpolant.call(this,Y,Z,se,ve)}b.prototype.decodePrimitive=function(Y,Z){var se=this.json,ve=this.dracoLoader,le=Y.extensions[this.name].bufferView,_e=Y.extensions[this.name].attributes,ae={},pe={},he={};for(var ce in _e){var Te=H[ce]||ce.toLowerCase();ae[Te]=_e[ce]}for(ce in Y.attributes)if(Te=H[ce]||ce.toLowerCase(),void 0!==_e[ce]){var be=se.accessors[Y.attributes[ce]];he[Te]=L[be.componentType],pe[Te]=!0===be.normalized}return Z.getDependency("bufferView",le).then(function(we){return new Promise(function(Ne){ve.decodeDracoFile(we,function(Re){for(var De in Re.attributes){var $e=pe[De];void 0!==$e&&(Re.attributes[De].normalized=$e)}Ne(Re)},ae,he)})})},A.prototype.extendTexture=function(Y,Z){return Y=Y.clone(),void 0!==Z.offset&&Y.offset.fromArray(Z.offset),void 0!==Z.rotation&&(Y.rotation=Z.rotation),void 0!==Z.scale&&Y.repeat.fromArray(Z.scale),void 0!==Z.texCoord&&console.warn('GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),Y.needsUpdate=!0,Y},(E.prototype=Object.create(MeshStandardMaterial.prototype)).constructor=E,E.prototype.copy=function(Y){return MeshStandardMaterial.prototype.copy.call(this,Y),this.specularMap=Y.specularMap,this.specular.copy(Y.specular),this.glossinessMap=Y.glossinessMap,this.glossiness=Y.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},(D.prototype=Object.create(Interpolant.prototype)).constructor=D,D.prototype.beforeStart_=D.prototype.copySampleValue_=function(Y){for(var Z=this.resultBuffer,se=this.sampleValues,ve=this.valueSize,le=Y*ve*3+ve,_e=0;_e!==ve;_e++)Z[_e]=se[le+_e];return Z},D.prototype.afterEnd_=D.prototype.copySampleValue_,D.prototype.interpolate_=function(Y,Z,se,ve){for(var le=this.resultBuffer,_e=this.sampleValues,ae=this.valueSize,pe=2*ae,he=3*ae,ce=ve-Z,Te=(se-Z)/ce,be=Te*Te,xe=be*Te,we=Y*he,Ne=we-he,Re=-2*xe+3*be,De=xe-be,Je=1-Re,$e=De-be+Te,pt=0;pt!==ae;pt++)le[pt]=Je*_e[Ne+pt+ae]+$e*(_e[Ne+pt+pe]*ce)+Re*_e[we+pt+ae]+De*(_e[we+pt]*ce);return le};var L={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},I={9728:NearestFilter,9729:LinearFilter,9984:NearestMipmapNearestFilter,9985:LinearMipmapNearestFilter,9986:NearestMipmapLinearFilter,9987:LinearMipmapLinearFilter},V={33071:ClampToEdgeWrapping,33648:MirroredRepeatWrapping,10497:RepeatWrapping},z={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},H={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},X={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},re={CUBICSPLINE:void 0,LINEAR:InterpolateLinear,STEP:InterpolateDiscrete},te={"image/png":RGBAFormat,"image/jpeg":RGBFormat};function J(Y,Z){return"string"!=typeof Y||""===Y?"":(/^https?:\/\//i.test(Z)&&/^\//.test(Y)&&(Z=Z.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(Y)||/^data:.*,.*$/i.test(Y)||/^blob:.*$/i.test(Y)?Y:Z+Y)}function k(Y){return void 0===Y.DefaultMaterial&&(Y.DefaultMaterial=new MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:FrontSide})),Y.DefaultMaterial}function U(Y,Z,se){for(var ve in se.extensions)void 0===Y[ve]&&(Z.userData.gltfExtensions=Z.userData.gltfExtensions||{},Z.userData.gltfExtensions[ve]=se.extensions[ve])}function K(Y,Z){void 0!==Z.extras&&("object"==typeof Z.extras?Object.assign(Y.userData,Z.extras):console.warn("GLTFLoader: Ignoring primitive type .extras, "+Z.extras))}function Q(Y,Z){if(Y.updateMorphTargets(),void 0!==Z.weights)for(var se=0,ve=Z.weights.length;se<ve;se++)Y.morphTargetInfluences[se]=Z.weights[se];if(Z.extras&&Array.isArray(Z.extras.targetNames)){var le=Z.extras.targetNames;if(Y.morphTargetInfluences.length===le.length)for(Y.morphTargetDictionary={},se=0,ve=le.length;se<ve;se++)Y.morphTargetDictionary[le[se]]=se;else console.warn("GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function oe(Y){var Z=Y.extensions&&Y.extensions[a.KHR_DRACO_MESH_COMPRESSION];return Z?"draco:"+Z.bufferView+":"+Z.indices+":"+me(Z.attributes):Y.indices+":"+me(Y.attributes)+":"+Y.mode}function me(Y){for(var Z="",se=Object.keys(Y).sort(),ve=0,le=se.length;ve<le;ve++)Z+=se[ve]+":"+Y[se[ve]]+";";return Z}function fe(Y,Z,se){this.json=Y||{},this.extensions=Z||{},this.options=se||{},this.cache=new e,this.primitiveCache={},this.textureLoader=new TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function $(Y,Z,se){var ve=Z.attributes,le=[];function _e(ce,Te){return se.getDependency("accessor",ce).then(function(be){Y.setAttribute(Te,be)})}for(var ae in ve){var pe=H[ae]||ae.toLowerCase();pe in Y.attributes||le.push(_e(ve[ae],pe))}if(void 0!==Z.indices&&!Y.index){var he=se.getDependency("accessor",Z.indices).then(function(ce){Y.setIndex(ce)});le.push(he)}return K(Y,Z),function(Y,Z,se){var ve=Z.attributes,le=new Box3;if(void 0!==ve.POSITION){var pe=(_e=se.json.accessors[ve.POSITION]).max;if(void 0!==(ae=_e.min)&&void 0!==pe){le.set(new Vector3(ae[0],ae[1],ae[2]),new Vector3(pe[0],pe[1],pe[2]));var he=Z.targets;if(void 0!==he)for(var ce=new Vector3,Te=0,be=he.length;Te<be;Te++){var _e,ae,xe=he[Te];void 0!==xe.POSITION&&(pe=(_e=se.json.accessors[xe.POSITION]).max,void 0!==(ae=_e.min)&&void 0!==pe?(ce.setX(Math.max(Math.abs(ae[0]),Math.abs(pe[0]))),ce.setY(Math.max(Math.abs(ae[1]),Math.abs(pe[1]))),ce.setZ(Math.max(Math.abs(ae[2]),Math.abs(pe[2]))),le.expandByVector(ce)):console.warn("GLTFLoader: Missing min/max properties for accessor POSITION."))}Y.boundingBox=le;var we=new Sphere;le.getCenter(we.center),we.radius=le.min.distanceTo(le.max)/2,Y.boundingSphere=we}else console.warn("GLTFLoader: Missing min/max properties for accessor POSITION.")}}(Y,Z,se),Promise.all(le).then(function(){return void 0!==Z.targets?function(Y,Z,se){for(var ve=!1,le=!1,_e=0,ae=Z.length;_e<ae&&(void 0!==(pe=Z[_e]).POSITION&&(ve=!0),void 0!==pe.NORMAL&&(le=!0),!ve||!le);_e++);if(!ve&&!le)return Promise.resolve(Y);var he=[],ce=[];for(_e=0,ae=Z.length;_e<ae;_e++){var pe=Z[_e];if(ve){var Te=void 0!==pe.POSITION?se.getDependency("accessor",pe.POSITION):Y.attributes.position;he.push(Te)}le&&(Te=void 0!==pe.NORMAL?se.getDependency("accessor",pe.NORMAL):Y.attributes.normal,ce.push(Te))}return Promise.all([Promise.all(he),Promise.all(ce)]).then(function(be){var we=be[1];return ve&&(Y.morphAttributes.position=be[0]),le&&(Y.morphAttributes.normal=we),Y.morphTargetsRelative=!0,Y})}(Y,Z.targets,se):Y})}function ue(Y,Z){var se=Y.getIndex();if(null===se){var ve=[],le=Y.getAttribute("position");if(void 0===le)return console.error("GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),Y;for(var _e=0;_e<le.count;_e++)ve.push(_e);Y.setIndex(ve),se=Y.getIndex()}var ae=se.count-2,pe=[];if(Z===TriangleFanDrawMode)for(_e=1;_e<=ae;_e++)pe.push(se.getX(0)),pe.push(se.getX(_e)),pe.push(se.getX(_e+1));else for(_e=0;_e<ae;_e++)_e%2==0?(pe.push(se.getX(_e)),pe.push(se.getX(_e+1)),pe.push(se.getX(_e+2))):(pe.push(se.getX(_e+2)),pe.push(se.getX(_e+1)),pe.push(se.getX(_e)));pe.length/3!==ae&&console.error("GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var he=Y.clone();return he.setIndex(pe),he}return fe.prototype.parse=function(Y,Z){var se=this,ve=this.json,le=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then(function(_e){var ae={scene:_e[0][ve.scene||0],scenes:_e[0],animations:_e[1],cameras:_e[2],asset:ve.asset,parser:se,userData:{}};U(le,ae,ve),K(ae,ve),Y(ae)}).catch(Z)},fe.prototype.markDefs=function(){for(var Y=this.json.nodes||[],Z=this.json.skins||[],se=this.json.meshes||[],ve={},le={},_e=0,ae=Z.length;_e<ae;_e++)for(var pe=Z[_e].joints,he=0,ce=pe.length;he<ce;he++)Y[pe[he]].isBone=!0;for(var Te=0,be=Y.length;Te<be;Te++){var xe=Y[Te];void 0!==xe.mesh&&(void 0===ve[xe.mesh]&&(ve[xe.mesh]=le[xe.mesh]=0),ve[xe.mesh]++,void 0!==xe.skin&&(se[xe.mesh].isSkinnedMesh=!0))}this.json.meshReferences=ve,this.json.meshUses=le},fe.prototype.getDependency=function(Y,Z){var se=Y+":"+Z,ve=this.cache.get(se);if(!ve){switch(Y){case"scene":ve=this.loadScene(Z);break;case"node":ve=this.loadNode(Z);break;case"mesh":ve=this.loadMesh(Z);break;case"accessor":ve=this.loadAccessor(Z);break;case"bufferView":ve=this.loadBufferView(Z);break;case"buffer":ve=this.loadBuffer(Z);break;case"material":ve=this.loadMaterial(Z);break;case"texture":ve=this.loadTexture(Z);break;case"skin":ve=this.loadSkin(Z);break;case"animation":ve=this.loadAnimation(Z);break;case"camera":ve=this.loadCamera(Z);break;case"light":ve=this.extensions[a.KHR_LIGHTS_PUNCTUAL].loadLight(Z);break;default:throw new Error("Unknown type: "+Y)}this.cache.add(se,ve)}return ve},fe.prototype.getDependencies=function(Y){var Z=this.cache.get(Y);if(!Z){var se=this;Z=Promise.all((this.json[Y+("mesh"===Y?"es":"s")]||[]).map(function(le,_e){return se.getDependency(Y,_e)})),this.cache.add(Y,Z)}return Z},fe.prototype.loadBuffer=function(Y){var Z=this.json.buffers[Y],se=this.fileLoader;if(Z.type&&"arraybuffer"!==Z.type)throw new Error("GLTFLoader: "+Z.type+" buffer type is not supported.");if(void 0===Z.uri&&0===Y)return Promise.resolve(this.extensions[a.KHR_BINARY_GLTF].body);var ve=this.options;return new Promise(function(le,_e){se.load(J(Z.uri,ve.path),le,void 0,function(){_e(new Error('GLTFLoader: Failed to load buffer "'+Z.uri+'".'))})})},fe.prototype.loadBufferView=function(Y){var Z=this.json.bufferViews[Y];return this.getDependency("buffer",Z.buffer).then(function(se){var le=Z.byteOffset||0;return se.slice(le,le+(Z.byteLength||0))})},fe.prototype.loadAccessor=function(Y){var Z=this,se=this.json,ve=this.json.accessors[Y];if(void 0===ve.bufferView&&void 0===ve.sparse)return Promise.resolve(null);var le=[];return le.push(void 0!==ve.bufferView?this.getDependency("bufferView",ve.bufferView):null),void 0!==ve.sparse&&(le.push(this.getDependency("bufferView",ve.sparse.indices.bufferView)),le.push(this.getDependency("bufferView",ve.sparse.values.bufferView))),Promise.all(le).then(function(_e){var Re,ae=_e[0],pe=z[ve.type],he=L[ve.componentType],ce=he.BYTES_PER_ELEMENT,be=ve.byteOffset||0,xe=void 0!==ve.bufferView?se.bufferViews[ve.bufferView].byteStride:void 0,we=!0===ve.normalized;if(xe&&xe!==ce*pe){var De=Math.floor(be/xe),Je="InterleavedBuffer:"+ve.bufferView+":"+ve.componentType+":"+De+":"+ve.count,$e=Z.cache.get(Je);$e||($e=new InterleavedBuffer(new he(ae,De*xe,ve.count*xe/ce),xe/ce),Z.cache.add(Je,$e)),Re=new InterleavedBufferAttribute($e,pe,be%xe/ce,we)}else Re=new BufferAttribute(null===ae?new he(ve.count*pe):new he(ae,be,ve.count*pe),pe,we);if(void 0!==ve.sparse){var Xe=ve.sparse.values.byteOffset||0,Ke=new(0,L[ve.sparse.indices.componentType])(_e[1],ve.sparse.indices.byteOffset||0,ve.sparse.count*z.SCALAR),lt=new he(_e[2],Xe,ve.sparse.count*pe);null!==ae&&(Re=new BufferAttribute(Re.array.slice(),Re.itemSize,Re.normalized));for(var ot=0,St=Ke.length;ot<St;ot++){var ft=Ke[ot];if(Re.setX(ft,lt[ot*pe]),pe>=2&&Re.setY(ft,lt[ot*pe+1]),pe>=3&&Re.setZ(ft,lt[ot*pe+2]),pe>=4&&Re.setW(ft,lt[ot*pe+3]),pe>=5)throw new Error("GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return Re})},fe.prototype.loadTexture=function(Y){var he,Z=this,se=this.json,ve=this.options,le=this.textureLoader,_e=window.URL||window.webkitURL,ae=se.textures[Y],pe=ae.extensions||{},ce=(he=pe[a.MSFT_TEXTURE_DDS]?se.images[pe[a.MSFT_TEXTURE_DDS].source]:se.images[ae.source]).uri,Te=!1;return void 0!==he.bufferView&&(ce=Z.getDependency("bufferView",he.bufferView).then(function(be){Te=!0;var xe=new Blob([be],{type:he.mimeType});return ce=_e.createObjectURL(xe)})),Promise.resolve(ce).then(function(be){var xe=ve.manager.getHandler(be);return xe||(xe=pe[a.MSFT_TEXTURE_DDS]?Z.extensions[a.MSFT_TEXTURE_DDS].ddsLoader:le),new Promise(function(we,Ne){xe.load(J(be,ve.path),we,void 0,Ne)})}).then(function(be){!0===Te&&_e.revokeObjectURL(ce),be.flipY=!1,void 0!==ae.name&&(be.name=ae.name),he.mimeType in te&&(be.format=te[he.mimeType]);var we=(se.samplers||{})[ae.sampler]||{};return be.magFilter=I[we.magFilter]||LinearFilter,be.minFilter=I[we.minFilter]||LinearMipmapLinearFilter,be.wrapS=V[we.wrapS]||RepeatWrapping,be.wrapT=V[we.wrapT]||RepeatWrapping,be})},fe.prototype.assignTexture=function(Y,Z,se){var ve=this;return this.getDependency("texture",se.index).then(function(le){if(!le.isCompressedTexture)switch(Z){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":le.format=RGBFormat}if(void 0!==se.texCoord&&0!=se.texCoord&&!("aoMap"===Z&&1==se.texCoord)&&console.warn("GLTFLoader: Custom UV set "+se.texCoord+" for texture "+Z+" not yet supported."),ve.extensions[a.KHR_TEXTURE_TRANSFORM]){var _e=void 0!==se.extensions?se.extensions[a.KHR_TEXTURE_TRANSFORM]:void 0;_e&&(le=ve.extensions[a.KHR_TEXTURE_TRANSFORM].extendTexture(le,_e))}Y[Z]=le})},fe.prototype.assignFinalMaterial=function(Y){var Z=Y.geometry,se=Y.material,le=void 0!==Z.attributes.tangent,_e=void 0!==Z.attributes.color,ae=void 0===Z.attributes.normal,pe=!0===Y.isSkinnedMesh,he=Object.keys(Z.morphAttributes).length>0,ce=he&&void 0!==Z.morphAttributes.normal;if(Y.isPoints){var be=this.cache.get(Te="PointsMaterial:"+se.uuid);be||(be=new PointsMaterial,Material.prototype.copy.call(be,se),be.color.copy(se.color),be.map=se.map,be.sizeAttenuation=!1,this.cache.add(Te,be)),se=be}else if(Y.isLine){var xe=this.cache.get(Te="LineBasicMaterial:"+se.uuid);xe||(xe=new LineBasicMaterial,Material.prototype.copy.call(xe,se),xe.color.copy(se.color),this.cache.add(Te,xe)),se=xe}if(le||_e||ae||pe||he){var Te="ClonedMaterial:"+se.uuid+":";se.isGLTFSpecularGlossinessMaterial&&(Te+="specular-glossiness:"),pe&&(Te+="skinning:"),le&&(Te+="vertex-tangents:"),_e&&(Te+="vertex-colors:"),ae&&(Te+="flat-shading:"),he&&(Te+="morph-targets:"),ce&&(Te+="morph-normals:");var we=this.cache.get(Te);we||(we=se.clone(),pe&&(we.skinning=!0),le&&(we.vertexTangents=!0),_e&&(we.vertexColors=VertexColors),ae&&(we.flatShading=!0),he&&(we.morphTargets=!0),ce&&(we.morphNormals=!0),this.cache.add(Te,we)),se=we}se.aoMap&&void 0===Z.attributes.uv2&&void 0!==Z.attributes.uv&&Z.setAttribute("uv2",new BufferAttribute(Z.attributes.uv.array,2)),se.normalScale&&!le&&(se.normalScale.y=-se.normalScale.y),Y.material=se},fe.prototype.loadMaterial=function(Y){var _e,Z=this,ve=this.extensions,le=this.json.materials[Y],ae={},pe=le.extensions||{},he=[];if(pe[a.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var ce=ve[a.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];_e=ce.getMaterialType(),he.push(ce.extendParams(ae,le,Z))}else if(pe[a.KHR_MATERIALS_UNLIT]){var Te=ve[a.KHR_MATERIALS_UNLIT];_e=Te.getMaterialType(),he.push(Te.extendParams(ae,le,Z))}else{_e=MeshStandardMaterial;var be=le.pbrMetallicRoughness||{};if(ae.color=new Color(1,1,1),ae.opacity=1,Array.isArray(be.baseColorFactor)){var xe=be.baseColorFactor;ae.color.fromArray(xe),ae.opacity=xe[3]}void 0!==be.baseColorTexture&&he.push(Z.assignTexture(ae,"map",be.baseColorTexture)),ae.metalness=void 0!==be.metallicFactor?be.metallicFactor:1,ae.roughness=void 0!==be.roughnessFactor?be.roughnessFactor:1,void 0!==be.metallicRoughnessTexture&&(he.push(Z.assignTexture(ae,"metalnessMap",be.metallicRoughnessTexture)),he.push(Z.assignTexture(ae,"roughnessMap",be.metallicRoughnessTexture)))}!0===le.doubleSided&&(ae.side=DoubleSide);var we=le.alphaMode||"OPAQUE";return"BLEND"===we?ae.transparent=!0:(ae.transparent=!1,"MASK"===we&&(ae.alphaTest=void 0!==le.alphaCutoff?le.alphaCutoff:.5)),void 0!==le.normalTexture&&_e!==MeshBasicMaterial&&(he.push(Z.assignTexture(ae,"normalMap",le.normalTexture)),ae.normalScale=new Vector2(1,1),void 0!==le.normalTexture.scale&&ae.normalScale.set(le.normalTexture.scale,le.normalTexture.scale)),void 0!==le.occlusionTexture&&_e!==MeshBasicMaterial&&(he.push(Z.assignTexture(ae,"aoMap",le.occlusionTexture)),void 0!==le.occlusionTexture.strength&&(ae.aoMapIntensity=le.occlusionTexture.strength)),void 0!==le.emissiveFactor&&_e!==MeshBasicMaterial&&(ae.emissive=(new Color).fromArray(le.emissiveFactor)),void 0!==le.emissiveTexture&&_e!==MeshBasicMaterial&&he.push(Z.assignTexture(ae,"emissiveMap",le.emissiveTexture)),Promise.all(he).then(function(){var Ne;return Ne=_e===E?ve[a.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(ae):new _e(ae),void 0!==le.name&&(Ne.name=le.name),Ne.map&&(Ne.map.encoding=sRGBEncoding),Ne.emissiveMap&&(Ne.emissiveMap.encoding=sRGBEncoding),K(Ne,le),le.extensions&&U(ve,Ne,le),Ne})},fe.prototype.loadGeometries=function(Y){var Z=this,se=this.extensions,ve=this.primitiveCache;function le(xe){return se[a.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(xe,Z).then(function(we){return $(we,xe,Z)})}for(var _e=[],ae=0,pe=Y.length;ae<pe;ae++){var be,he=Y[ae],ce=oe(he),Te=ve[ce];Te?_e.push(Te.promise):(be=he.extensions&&he.extensions[a.KHR_DRACO_MESH_COMPRESSION]?le(he):$(new BufferGeometry,he,Z),ve[ce]={primitive:he,promise:be},_e.push(be))}return Promise.all(_e)},fe.prototype.loadMesh=function(Y){for(var Z=this,ve=this.json.meshes[Y],le=ve.primitives,_e=[],ae=0,pe=le.length;ae<pe;ae++){var he=void 0===le[ae].material?k(this.cache):this.getDependency("material",le[ae].material);_e.push(he)}return _e.push(Z.loadGeometries(le)),Promise.all(_e).then(function(ce){for(var Te=ce.slice(0,ce.length-1),be=ce[ce.length-1],xe=[],we=0,Ne=be.length;we<Ne;we++){var Je,Re=be[we],De=le[we],$e=Te[we];if(4===De.mode||5===De.mode||6===De.mode||void 0===De.mode)!0===(Je=!0===ve.isSkinnedMesh?new SkinnedMesh(Re,$e):new Mesh(Re,$e)).isSkinnedMesh&&!Je.geometry.attributes.skinWeight.normalized&&Je.normalizeSkinWeights(),5===De.mode?Je.geometry=ue(Je.geometry,TriangleStripDrawMode):6===De.mode&&(Je.geometry=ue(Je.geometry,TriangleFanDrawMode));else if(1===De.mode)Je=new LineSegments(Re,$e);else if(3===De.mode)Je=new Line(Re,$e);else if(2===De.mode)Je=new LineLoop(Re,$e);else{if(0!==De.mode)throw new Error("GLTFLoader: Primitive mode unsupported: "+De.mode);Je=new Points(Re,$e)}Object.keys(Je.geometry.morphAttributes).length>0&&Q(Je,ve),Je.name=ve.name||"mesh_"+Y,be.length>1&&(Je.name+="_"+we),K(Je,ve),Z.assignFinalMaterial(Je),xe.push(Je)}if(1===xe.length)return xe[0];var pt=new Group;for(we=0,Ne=xe.length;we<Ne;we++)pt.add(xe[we]);return pt})},fe.prototype.loadCamera=function(Y){var Z,se=this.json.cameras[Y],ve=se[se.type];if(ve)return"perspective"===se.type?Z=new PerspectiveCamera(MathUtils.radToDeg(ve.yfov),ve.aspectRatio||1,ve.znear||1,ve.zfar||2e6):"orthographic"===se.type&&(Z=new OrthographicCamera(ve.xmag/-2,ve.xmag/2,ve.ymag/2,ve.ymag/-2,ve.znear,ve.zfar)),void 0!==se.name&&(Z.name=se.name),K(Z,se),Promise.resolve(Z);console.warn("GLTFLoader: Missing camera parameters.")},fe.prototype.loadSkin=function(Y){var Z=this.json.skins[Y],se={joints:Z.joints};return void 0===Z.inverseBindMatrices?Promise.resolve(se):this.getDependency("accessor",Z.inverseBindMatrices).then(function(ve){return se.inverseBindMatrices=ve,se})},fe.prototype.loadAnimation=function(Y){for(var se=this.json.animations[Y],ve=[],le=[],_e=[],ae=[],pe=[],he=0,ce=se.channels.length;he<ce;he++){var Te=se.channels[he],be=se.samplers[Te.sampler],xe=Te.target,Ne=void 0!==se.parameters?se.parameters[be.input]:be.input,Re=void 0!==se.parameters?se.parameters[be.output]:be.output;ve.push(this.getDependency("node",void 0!==xe.node?xe.node:xe.id)),le.push(this.getDependency("accessor",Ne)),_e.push(this.getDependency("accessor",Re)),ae.push(be),pe.push(xe)}return Promise.all([Promise.all(ve),Promise.all(le),Promise.all(_e),Promise.all(ae),Promise.all(pe)]).then(function(De){for(var Je=De[0],$e=De[1],pt=De[2],ut=De[3],at=De[4],Xe=[],Ke=0,lt=Je.length;Ke<lt;Ke++){var ot=Je[Ke],St=$e[Ke],ft=pt[Ke],He=ut[Ke],gt=at[Ke];if(void 0!==ot){var vt;switch(ot.updateMatrix(),ot.matrixAutoUpdate=!0,X[gt.path]){case X.weights:vt=NumberKeyframeTrack;break;case X.rotation:vt=QuaternionKeyframeTrack;break;default:vt=VectorKeyframeTrack}var Gt=ot.name?ot.name:ot.uuid,Lt=void 0!==He.interpolation?re[He.interpolation]:InterpolateLinear,yt=[];X[gt.path]===X.weights?ot.traverse(function(Sr){!0===Sr.isMesh&&Sr.morphTargetInfluences&&yt.push(Sr.name?Sr.name:Sr.uuid)}):yt.push(Gt);var xr=ft.array;if(ft.normalized){var Dr;if(xr.constructor===Int8Array)Dr=1/127;else if(xr.constructor===Uint8Array)Dr=1/255;else if(xr.constructor==Int16Array)Dr=1/32767;else{if(xr.constructor!==Uint16Array)throw new Error("GLTFLoader: Unsupported output accessor component type.");Dr=1/65535}for(var Ur=new Float32Array(xr.length),qr=0,Ar=xr.length;qr<Ar;qr++)Ur[qr]=xr[qr]*Dr;xr=Ur}for(qr=0,Ar=yt.length;qr<Ar;qr++){var hn=new vt(yt[qr]+"."+X[gt.path],St.array,xr,Lt);"CUBICSPLINE"===He.interpolation&&(hn.createInterpolant=function(cn){return new D(this.times,this.values,this.getValueSize()/3,cn)},hn.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),Xe.push(hn)}}}return new AnimationClip(void 0!==se.name?se.name:"animation_"+Y,void 0,Xe)})},fe.prototype.loadNode=function(Y){var pe,Z=this.json,se=this.extensions,le=Z.meshReferences,_e=Z.meshUses,ae=Z.nodes[Y];return(pe=[],void 0!==ae.mesh&&pe.push(this.getDependency("mesh",ae.mesh).then(function(he){var ce;if(le[ae.mesh]>1){var Te=_e[ae.mesh]++;(ce=he.clone()).name+="_instance_"+Te}else ce=he;return void 0!==ae.weights&&ce.traverse(function(be){if(be.isMesh)for(var xe=0,we=ae.weights.length;xe<we;xe++)be.morphTargetInfluences[xe]=ae.weights[xe]}),ce})),void 0!==ae.camera&&pe.push(this.getDependency("camera",ae.camera)),ae.extensions&&ae.extensions[a.KHR_LIGHTS_PUNCTUAL]&&void 0!==ae.extensions[a.KHR_LIGHTS_PUNCTUAL].light&&pe.push(this.getDependency("light",ae.extensions[a.KHR_LIGHTS_PUNCTUAL].light)),Promise.all(pe)).then(function(pe){var he;if((he=!0===ae.isBone?new Bone:pe.length>1?new Group:1===pe.length?pe[0]:new Object3D)!==pe[0])for(var ce=0,Te=pe.length;ce<Te;ce++)he.add(pe[ce]);if(void 0!==ae.name&&(he.userData.name=ae.name,he.name=PropertyBinding.sanitizeNodeName(ae.name)),K(he,ae),ae.extensions&&U(se,he,ae),void 0!==ae.matrix){var be=new Matrix4;be.fromArray(ae.matrix),he.applyMatrix4(be)}else void 0!==ae.translation&&he.position.fromArray(ae.translation),void 0!==ae.rotation&&he.quaternion.fromArray(ae.rotation),void 0!==ae.scale&&he.scale.fromArray(ae.scale);return he})},fe.prototype.loadScene=function(){function Y(Z,se,ve,le){var _e=ve.nodes[Z];return le.getDependency("node",Z).then(function(ae){return void 0===_e.skin?ae:le.getDependency("skin",_e.skin).then(function(he){for(var ce=[],Te=0,be=(pe=he).joints.length;Te<be;Te++)ce.push(le.getDependency("node",pe.joints[Te]));return Promise.all(ce)}).then(function(he){return ae.traverse(function(ce){if(ce.isMesh){for(var Te=[],be=[],xe=0,we=he.length;xe<we;xe++){var Ne=he[xe];if(Ne){Te.push(Ne);var Re=new Matrix4;void 0!==pe.inverseBindMatrices&&Re.fromArray(pe.inverseBindMatrices.array,16*xe),be.push(Re)}else console.warn('GLTFLoader: Joint "%s" could not be found.',pe.joints[xe])}ce.bind(new Skeleton(Te,be),ce.matrixWorld)}}),ae});var pe}).then(function(ae){se.add(ae);var pe=[];if(_e.children)for(var he=_e.children,ce=0,Te=he.length;ce<Te;ce++)pe.push(Y(he[ce],ae,ve,le));return Promise.all(pe)})}return function(se){var ve=this.json,le=this.extensions,_e=this.json.scenes[se],pe=new Scene;void 0!==_e.name&&(pe.name=_e.name),K(pe,_e),_e.extensions&&U(le,pe,_e);for(var he=_e.nodes||[],ce=[],Te=0,be=he.length;Te<be;Te++)ce.push(Y(he[Te],pe,ve,this));return Promise.all(ce).then(function(){return pe})}}(),s}();function CubeTexture(s,e,a,d,v,g,C,w,_,x){Texture.call(this,s=void 0!==s?s:[],e=void 0!==e?e:CubeReflectionMapping,a,d,v,g,C=void 0!==C?C:RGBFormat,w,_,x),this.flipY=!1}CubeTexture.prototype=Object.create(Texture.prototype),CubeTexture.prototype.constructor=CubeTexture,CubeTexture.prototype.isCubeTexture=!0,Object.defineProperty(CubeTexture.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}});var RGBELoader=function(e){DataTextureLoader.call(this,e),this.type=UnsignedByteType};RGBELoader.prototype=Object.assign(Object.create(DataTextureLoader.prototype),{constructor:RGBELoader,parse:function(e){var w=function(ee,Q){switch(ee){case 1:console.error("RGBELoader Read Error: "+(Q||""));break;case 2:console.error("RGBELoader Write Error: "+(Q||""));break;case 3:console.error("RGBELoader Bad File Format: "+(Q||""));break;default:console.error("RGBELoader: Error: "+(Q||""))}return-1},E=function(ee,Q,oe){Q=Q||1024;for(var me=ee.pos,fe=-1,ge=0,$="",Y=String.fromCharCode.apply(null,new Uint16Array(ee.subarray(me,me+128)));0>(fe=Y.indexOf("\n"))&&ge<Q&&me<ee.byteLength;)$+=Y,ge+=Y.length,me+=128,Y+=String.fromCharCode.apply(null,new Uint16Array(ee.subarray(me,me+128)));return-1<fe&&(!1!==oe&&(ee.pos+=ge+fe+1),$+Y.slice(0,fe))},F=function(){var K=new Float32Array(1),ee=new Int32Array(K.buffer);function Q(oe){K[0]=oe;var me=ee[0],fe=me>>16&32768,ge=me>>12&2047,$=me>>23&255;return $<103?fe:$>142?(fe|=31744,fe|=(255==$?0:1)&&8388607&me):$<113?fe|=((ge|=2048)>>114-$)+(ge>>113-$&1):(fe|=$-112<<10|ge>>1,fe+=1&ge)}return function(oe,me,fe,ge){var ue=Math.pow(2,oe[me+3]-128)/255;fe[ge+0]=Q(oe[me+0]*ue),fe[ge+1]=Q(oe[me+1]*ue),fe[ge+2]=Q(oe[me+2]*ue)}}(),L=new Uint8Array(e);L.pos=0;var ee,Q,oe,me,ge,I=function(ee){var Q,oe,fe=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,ge=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,$=/^\s*FORMAT=(\S+)\s*$/,ue=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,Y={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(ee.pos>=ee.byteLength||!(Q=E(ee)))return w(1,"no header found");if(!(oe=Q.match(/^#\?(\S+)$/)))return w(3,"bad initial token");for(Y.valid|=1,Y.programtype=oe[1],Y.string+=Q+"\n";!1!==(Q=E(ee));)if(Y.string+=Q+"\n","#"!==Q.charAt(0)){if((oe=Q.match(fe))&&(Y.gamma=parseFloat(oe[1],10)),(oe=Q.match(ge))&&(Y.exposure=parseFloat(oe[1],10)),(oe=Q.match($))&&(Y.valid|=2,Y.format=oe[1]),(oe=Q.match(ue))&&(Y.valid|=4,Y.height=parseInt(oe[1],10),Y.width=parseInt(oe[2],10)),2&Y.valid&&4&Y.valid)break}else Y.comments+=Q+"\n";return 2&Y.valid?4&Y.valid?Y:w(3,"missing image size specifier"):w(3,"missing format specifier")}(L);if(-1!==I){var V=I.width,z=I.height,H=function(ee,Q,oe){var me,fe,ge,$,ue,Y,Z,se,ve,le,_e,ae,ce,pe=Q,he=oe;if(pe<8||pe>32767||2!==ee[0]||2!==ee[1]||128&ee[2])return new Uint8Array(ee);if(pe!==(ee[2]<<8|ee[3]))return w(3,"wrong scanline width");if(!(me=new Uint8Array(4*Q*oe))||!me.length)return w(4,"unable to allocate buffer space");for(fe=0,ge=0,se=4*pe,ce=new Uint8Array(4),Y=new Uint8Array(se);he>0&&ge<ee.byteLength;){if(ge+4>ee.byteLength)return w(1);if(ce[0]=ee[ge++],ce[1]=ee[ge++],ce[2]=ee[ge++],ce[3]=ee[ge++],2!=ce[0]||2!=ce[1]||(ce[2]<<8|ce[3])!=pe)return w(3,"bad rgbe scanline format");for(Z=0;Z<se&&ge<ee.byteLength;){if((ae=($=ee[ge++])>128)&&($-=128),0===$||Z+$>se)return w(3,"bad scanline data");if(ae)for(ue=ee[ge++],ve=0;ve<$;ve++)Y[Z++]=ue;else Y.set(ee.subarray(ge,ge+$),Z),Z+=$,ge+=$}for(le=pe,ve=0;ve<le;ve++)me[fe]=Y[ve+(_e=0)],me[fe+1]=Y[ve+(_e+=pe)],me[fe+2]=Y[ve+(_e+=pe)],me[fe+3]=Y[ve+(_e+=pe)],fe+=4;he--}return me}(L.subarray(L.pos),V,z);if(-1!==H){switch(this.type){case UnsignedByteType:var X=H,re=RGBEFormat,j=UnsignedByteType;break;case FloatType:for(var te=H.length/4*3,J=new Float32Array(te),k=0;k<te;k++)ee=H,Q=4*k,oe=J,me=3*k,void 0,ge=Math.pow(2,ee[Q+3]-128)/255,oe[me+0]=ee[Q+0]*ge,oe[me+1]=ee[Q+1]*ge,oe[me+2]=ee[Q+2]*ge;X=J,re=RGBFormat,j=FloatType;break;case HalfFloatType:te=H.length/4*3;var U=new Uint16Array(te);for(k=0;k<te;k++)F(H,4*k,U,3*k);X=U,re=RGBFormat,j=HalfFloatType;break;default:console.error("RGBELoader: unsupported type: ",this.type)}return{width:V,height:z,data:X,header:I.string,gamma:I.gamma,exposure:I.exposure,format:re,type:j}}}return null},setDataType:function(e){return this.type=e,this},load:function(e,a,d,v){return DataTextureLoader.prototype.load.call(this,e,function(C,w){switch(C.type){case UnsignedByteType:C.encoding=RGBEEncoding,C.minFilter=NearestFilter,C.magFilter=NearestFilter,C.generateMipmaps=!1,C.flipY=!0;break;case FloatType:case HalfFloatType:C.encoding=LinearEncoding,C.minFilter=LinearFilter,C.magFilter=LinearFilter,C.generateMipmaps=!1,C.flipY=!0}a&&a(C,w)},d,v)}});var HDRCubeTextureLoader=function(e){Loader.call(this,e),this.hdrLoader=new RGBELoader,this.type=UnsignedByteType};HDRCubeTextureLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:HDRCubeTextureLoader,load:function(e,a,d,v){Array.isArray(e)||(console.warn("HDRCubeTextureLoader signature has changed. Use .setDataType() instead."),this.setDataType(e),e=a,a=d,d=v,v=arguments[4]);var g=new CubeTexture;switch(g.type=this.type,g.type){case UnsignedByteType:g.encoding=RGBEEncoding,g.format=RGBAFormat,g.minFilter=NearestFilter,g.magFilter=NearestFilter,g.generateMipmaps=!1;break;case FloatType:case HalfFloatType:g.encoding=LinearEncoding,g.format=RGBFormat,g.minFilter=LinearFilter,g.magFilter=LinearFilter,g.generateMipmaps=!1}var C=this,w=0;function _(b,A,E,R){new FileLoader(C.manager).setPath(C.path).setResponseType("arraybuffer").load(e[b],function(O){w++;var D=C.hdrLoader.parse(O);if(D){if(void 0!==D.data){var F=new DataTexture(D.data,D.width,D.height);F.type=g.type,F.encoding=g.encoding,F.format=g.format,F.minFilter=g.minFilter,F.magFilter=g.magFilter,F.generateMipmaps=g.generateMipmaps,g.images[b]=F}6===w&&(g.needsUpdate=!0,A&&A(g))}},E,R)}for(var x=0;x<e.length;x++)_(x,a,d,v);return g},setDataType:function(e){return this.type=e,this.hdrLoader.setDataType(e),this}});var KMZLoader=function(e){Loader.call(this,e)};KMZLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:KMZLoader,load:function(e,a,d,v){var g=this,C=new FileLoader(g.manager);C.setPath(g.path),C.setResponseType("arraybuffer"),C.load(e,function(w){a(g.parse(w))},d,v)},parse:function(e){var d=new LoadingManager;d.setURLModifier(function(b){var A=function(b){for(var A in v.files)if(A.substr(-b.length)===b)return v.files[A]}(b);if(A){console.log("Loading",b);var E=new Blob([A.asArrayBuffer()],{type:"application/octet-stream"});return URL.createObjectURL(E)}return b});var v=new JSZip(e);if(v.files["doc.kml"]){var C=(new DOMParser).parseFromString(v.files["doc.kml"].asText(),"application/xml").querySelector("Placemark Model Link href");if(C)return new ColladaLoader(d).parse(v.files[C.textContent].asText())}else for(var _ in console.warn("KMZLoader: Missing doc.kml file."),v.files)if("dae"===_.split(".").pop().toLowerCase())return new ColladaLoader(d).parse(v.files[_].asText());return console.error("KMZLoader: Couldn't find .dae file."),{scene:new Group}}});var KTXLoader=function(e){CompressedTextureLoader.call(this,e)};KTXLoader.prototype=Object.assign(Object.create(CompressedTextureLoader.prototype),{constructor:KTXLoader,parse:function(e,a){var d=new KhronosTextureContainer(e,1);return{mipmaps:d.mipmaps(a),width:d.pixelWidth,height:d.pixelHeight,format:d.glInternalFormat,isCubemap:6===d.numberOfFaces,mipmapCount:d.numberOfMipmapLevels}}});var KhronosTextureContainer=function(){function s(e,a){this.arrayBuffer=e;var d=new Uint8Array(this.arrayBuffer,0,12);if(171===d[0]&&75===d[1]&&84===d[2]&&88===d[3]&&32===d[4]&&49===d[5]&&49===d[6]&&187===d[7]&&13===d[8]&&10===d[9]&&26===d[10]&&10===d[11]){var v=Uint32Array.BYTES_PER_ELEMENT,g=new DataView(this.arrayBuffer,12,13*v),w=67305985===g.getUint32(0,!0);this.glType=g.getUint32(1*v,w),this.glTypeSize=g.getUint32(2*v,w),this.glFormat=g.getUint32(3*v,w),this.glInternalFormat=g.getUint32(4*v,w),this.glBaseInternalFormat=g.getUint32(5*v,w),this.pixelWidth=g.getUint32(6*v,w),this.pixelHeight=g.getUint32(7*v,w),this.pixelDepth=g.getUint32(8*v,w),this.numberOfArrayElements=g.getUint32(9*v,w),this.numberOfFaces=g.getUint32(10*v,w),this.numberOfMipmapLevels=g.getUint32(11*v,w),this.bytesOfKeyValueData=g.getUint32(12*v,w),0===this.glType?(this.numberOfMipmapLevels=Math.max(1,this.numberOfMipmapLevels),0!==this.pixelHeight&&0===this.pixelDepth?0===this.numberOfArrayElements?this.numberOfFaces===a?this.loadType=s.COMPRESSED_2D:console.warn("number of faces expected"+a+", but found "+this.numberOfFaces):console.warn("texture arrays not currently supported"):console.warn("only 2D textures currently supported")):console.warn("only compressed formats currently supported")}else console.error("texture missing KTX identifier")}return s.prototype.mipmaps=function(e){for(var a=[],d=s.HEADER_LEN+this.bytesOfKeyValueData,v=this.pixelWidth,g=this.pixelHeight,C=e?this.numberOfMipmapLevels:1,w=0;w<C;w++){var _=new Int32Array(this.arrayBuffer,d,1)[0];d+=4;for(var x=0;x<this.numberOfFaces;x++){var b=new Uint8Array(this.arrayBuffer,d,_);a.push({data:b,width:v,height:g}),d+=_,d+=3-(_+3)%4}v=Math.max(1,.5*v),g=Math.max(1,.5*g)}return a},s.HEADER_LEN=64,s.COMPRESSED_2D=0,s.COMPRESSED_3D=1,s.TEX_2D=2,s.TEX_3D=3,s}(),LDrawLoader=function(){var a=new Vector3,d=new Vector3;function g(b){return/primitive/i.test(b)||"Subpart"===b}function C(b,A){this.line=b,this.lineLength=b.length,this.currentCharIndex=0,this.currentChar=" ",this.lineNumber=A}function w(b,A){return b.colourCode===A.colourCode?0:b.colourCode<A.colourCode?-1:1}function _(b,A,E){b.sort(w);for(var R=[],O=[],D=[],F=new BufferGeometry,L=null,I=0,V=0,z=0,H=b.length;z<H;z++){var X=b[z];if(R.push((re=X.v0).x,re.y,re.z,(j=X.v1).x,j.y,j.z),3===A){R.push(X.v2.x,X.v2.y,X.v2.z);var te=X.n0||X.faceNormal,J=X.n1||X.faceNormal,k=X.n2||X.faceNormal;O.push(te.x,te.y,te.z),O.push(J.x,J.y,J.z),O.push(k.x,k.y,k.z)}L!==X.material?(null!==L&&F.addGroup(I,V,D.length-1),D.push(X.material),L=X.material,I=z*A,V=A):V+=A}V>0&&F.addGroup(I,1/0,D.length-1),F.setAttribute("position",new Float32BufferAttribute(R,3)),3===A&&F.setAttribute("normal",new Float32BufferAttribute(O,3));var U=null;if(2===A?U=new LineSegments(F,D):3===A&&(U=new Mesh(F,D)),E){U.isConditionalLine=!0;for(var K=new Float32Array(3*b.length*2),ee=new Float32Array(3*b.length*2),Q=new Float32Array(3*b.length*2),oe=0,me=b.length;oe<me;oe++){var fe=b[oe],ge=fe.c0,$=fe.c1,re=fe.v0,j=fe.v1,ue=3*oe*2;K[ue+0]=ge.x,K[ue+1]=ge.y,K[ue+2]=ge.z,K[ue+3]=ge.x,K[ue+4]=ge.y,K[ue+5]=ge.z,ee[ue+0]=$.x,ee[ue+1]=$.y,ee[ue+2]=$.z,ee[ue+3]=$.x,ee[ue+4]=$.y,ee[ue+5]=$.z,Q[ue+0]=j.x-re.x,Q[ue+1]=j.y-re.y,Q[ue+2]=j.z-re.z,Q[ue+3]=j.x-re.x,Q[ue+4]=j.y-re.y,Q[ue+5]=j.z-re.z}F.setAttribute("control0",new BufferAttribute(K,3,!1)),F.setAttribute("control1",new BufferAttribute(ee,3,!1)),F.setAttribute("direction",new BufferAttribute(Q,3,!1))}return U}function x(b){Loader.call(this,b),this.parseScopesStack=null,this.materials=[],this.subobjectCache={},this.fileMap=null,this.setMaterials([this.parseColourMetaDirective(new C("Main_Colour CODE 16 VALUE #FF8080 EDGE #333333")),this.parseColourMetaDirective(new C("Edge_Colour CODE 24 VALUE #A0A0A0 EDGE #333333"))]),this.separateObjects=!1,this.smoothNormals=!0}return C.prototype={constructor:C,seekNonSpace:function(){for(;this.currentCharIndex<this.lineLength;){if(this.currentChar=this.line.charAt(this.currentCharIndex)," "!==this.currentChar&&"\t"!==this.currentChar)return;this.currentCharIndex++}},getToken:function(){for(var A=this.currentCharIndex++;this.currentCharIndex<this.lineLength&&(this.currentChar=this.line.charAt(this.currentCharIndex)," "!==this.currentChar&&"\t"!==this.currentChar);)this.currentCharIndex++;var E=this.currentCharIndex;return this.seekNonSpace(),this.line.substring(A,E)},getRemainingString:function(){return this.line.substring(this.currentCharIndex,this.lineLength)},isAtTheEnd:function(){return this.currentCharIndex>=this.lineLength},setToEnd:function(){this.currentCharIndex=this.lineLength},getLineNumberString:function(){return this.lineNumber>=0?" at line "+this.lineNumber:""}},x.FINISH_TYPE_DEFAULT=0,x.FINISH_TYPE_CHROME=1,x.FINISH_TYPE_PEARLESCENT=2,x.FINISH_TYPE_RUBBER=3,x.FINISH_TYPE_MATTE_METALLIC=4,x.FINISH_TYPE_METAL=5,x.FILE_LOCATION_AS_IS=0,x.FILE_LOCATION_TRY_PARTS=1,x.FILE_LOCATION_TRY_P=2,x.FILE_LOCATION_TRY_MODELS=3,x.FILE_LOCATION_TRY_RELATIVE=4,x.FILE_LOCATION_TRY_ABSOLUTE=5,x.FILE_LOCATION_NOT_FOUND=6,x.prototype=Object.assign(Object.create(Loader.prototype),{constructor:x,load:function(A,E,R,O){this.fileMap||(this.fileMap={});var D=this,F=new FileLoader(this.manager);F.setPath(this.path),F.load(A,function(L){D.processObject(L,E,null,A)},R,O)},parse:function(A,E,R){this.processObject(A,R,null,E)},setMaterials:function(A){return this.parseScopesStack=[],this.newParseScopeLevel(A),this.getCurrentParseScope().isFromParse=!1,this.materials=A,this},setFileMap:function(A){return this.fileMap=A,this},newParseScopeLevel:function(A){var E={};if(A)for(var R=0,O=A.length;R<O;R++){var D=A[R];E[D.userData.code]=D}var F=this.getCurrentParseScope(),L={lib:E,url:null,subobjects:null,numSubobjects:0,subobjectIndex:0,inverted:!1,category:null,keywords:null,currentFileName:null,mainColourCode:F?F.mainColourCode:"16",mainEdgeColourCode:F?F.mainEdgeColourCode:"24",currentMatrix:new Matrix4,matrix:new Matrix4,isFromParse:!0,triangles:null,lineSegments:null,conditionalSegments:null,startingConstructionStep:!1};return this.parseScopesStack.push(L),L},removeScopeLevel:function(){return this.parseScopesStack.pop(),this},addMaterial:function(A){var E=this.getCurrentParseScope().lib;return E[A.userData.code]||this.materials.push(A),E[A.userData.code]=A,this},getMaterial:function(A){if(A.startsWith("0x2")){var E=A.substring(3);return this.parseColourMetaDirective(new C("Direct_Color_"+E+" CODE -1 VALUE #"+E+" EDGE #"+E))}for(var R=this.parseScopesStack.length-1;R>=0;R--){var O=this.parseScopesStack[R].lib[A];if(O)return O}return null},getParentParseScope:function(){return this.parseScopesStack.length>1?this.parseScopesStack[this.parseScopesStack.length-2]:null},getCurrentParseScope:function(){return this.parseScopesStack.length>0?this.parseScopesStack[this.parseScopesStack.length-1]:null},parseColourMetaDirective:function(A){var E=null,R=16711935,O=16711935,D=1,F=!1,L=0,I=x.FINISH_TYPE_DEFAULT,V=!0,z=null,H=A.getToken();if(!H)throw'LDrawLoader: Material name was expected after "!COLOUR tag'+A.getLineNumberString()+".";for(var X=null;X=A.getToken();)switch(X.toUpperCase()){case"CODE":E=A.getToken();break;case"VALUE":if((R=A.getToken()).startsWith("0x"))R="#"+R.substring(2);else if(!R.startsWith("#"))throw"LDrawLoader: Invalid colour while parsing material"+A.getLineNumberString()+".";break;case"EDGE":if((O=A.getToken()).startsWith("0x"))O="#"+O.substring(2);else if(!O.startsWith("#")){if(!(z=this.getMaterial(O)))throw"LDrawLoader: Invalid edge colour while parsing material"+A.getLineNumberString()+".";z=z.userData.edgeMaterial}break;case"ALPHA":if(D=parseInt(A.getToken()),isNaN(D))throw"LDrawLoader: Invalid alpha value in material definition"+A.getLineNumberString()+".";(D=Math.max(0,Math.min(1,D/255)))<1&&(F=!0);break;case"LUMINANCE":if(L=parseInt(A.getToken()),isNaN(L))throw"LDrawLoader: Invalid luminance value in material definition"+C.getLineNumberString()+".";L=Math.max(0,Math.min(1,L/255));break;case"CHROME":I=x.FINISH_TYPE_CHROME;break;case"PEARLESCENT":I=x.FINISH_TYPE_PEARLESCENT;break;case"RUBBER":I=x.FINISH_TYPE_RUBBER;break;case"MATTE_METALLIC":I=x.FINISH_TYPE_MATTE_METALLIC;break;case"METAL":I=x.FINISH_TYPE_METAL;break;case"MATERIAL":A.setToEnd();break;default:throw'LDrawLoader: Unknown token "'+X+'" while parsing material'+A.getLineNumberString()+"."}var re=null;switch(I){case x.FINISH_TYPE_DEFAULT:re=new MeshStandardMaterial({color:R,roughness:.3,envMapIntensity:.3,metalness:0});break;case x.FINISH_TYPE_PEARLESCENT:var j=new Color(R),te=j.getHSL({h:0,s:0,l:0});te.h=(te.h+.5)%1,te.l=Math.min(1,te.l+.7*(1-te.l)),j.setHSL(te.h,te.s,te.l),re=new MeshPhongMaterial({color:R,specular:j,shininess:10,reflectivity:.3});break;case x.FINISH_TYPE_CHROME:re=new MeshStandardMaterial({color:R,roughness:0,metalness:1});break;case x.FINISH_TYPE_RUBBER:re=new MeshStandardMaterial({color:R,roughness:.9,metalness:0}),V=!1;break;case x.FINISH_TYPE_MATTE_METALLIC:re=new MeshStandardMaterial({color:R,roughness:.8,metalness:.4});break;case x.FINISH_TYPE_METAL:re=new MeshStandardMaterial({color:R,roughness:.2,metalness:.85})}return re.transparent=F,re.premultipliedAlpha=!0,re.opacity=D,re.depthWrite=!F,re.polygonOffset=!0,re.polygonOffsetFactor=1,re.userData.canHaveEnvMap=V,0!==L&&re.emissive.set(re.color).multiplyScalar(L),z||((z=new LineBasicMaterial({color:O,transparent:F,opacity:D,depthWrite:!F})).userData.code=E,z.name=H+" - Edge",z.userData.canHaveEnvMap=!1,z.userData.conditionalEdgeMaterial=new ShaderMaterial({vertexShader:"\n\tattribute vec3 control0;\n\tattribute vec3 control1;\n\tattribute vec3 direction;\n\tvarying float discardFlag;\n\n\t#include <common>\n\t#include <color_pars_vertex>\n\t#include <fog_pars_vertex>\n\t#include <logdepthbuf_pars_vertex>\n\t#include <clipping_planes_pars_vertex>\n\tvoid main() {\n\t\t#include <color_vertex>\n\n\t\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\t\tgl_Position = projectionMatrix * mvPosition;\n\n\t\t// Transform the line segment ends and control points into camera clip space\n\t\tvec4 c0 = projectionMatrix * modelViewMatrix * vec4( control0, 1.0 );\n\t\tvec4 c1 = projectionMatrix * modelViewMatrix * vec4( control1, 1.0 );\n\t\tvec4 p0 = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\tvec4 p1 = projectionMatrix * modelViewMatrix * vec4( position + direction, 1.0 );\n\n\t\tc0.xy /= c0.w;\n\t\tc1.xy /= c1.w;\n\t\tp0.xy /= p0.w;\n\t\tp1.xy /= p1.w;\n\n\t\t// Get the direction of the segment and an orthogonal vector\n\t\tvec2 dir = p1.xy - p0.xy;\n\t\tvec2 norm = vec2( -dir.y, dir.x );\n\n\t\t// Get control point directions from the line\n\t\tvec2 c0dir = c0.xy - p1.xy;\n\t\tvec2 c1dir = c1.xy - p1.xy;\n\n\t\t// If the vectors to the controls points are pointed in different directions away\n\t\t// from the line segment then the line should not be drawn.\n\t\tfloat d0 = dot( normalize( norm ), normalize( c0dir ) );\n\t\tfloat d1 = dot( normalize( norm ), normalize( c1dir ) );\n\t\tdiscardFlag = float( sign( d0 ) != sign( d1 ) );\n\n\t\t#include <logdepthbuf_vertex>\n\t\t#include <clipping_planes_vertex>\n\t\t#include <fog_vertex>\n\t}\n\t",fragmentShader:"\n\tuniform vec3 diffuse;\n\tuniform float opacity;\n\tvarying float discardFlag;\n\n\t#include <common>\n\t#include <color_pars_fragment>\n\t#include <fog_pars_fragment>\n\t#include <logdepthbuf_pars_fragment>\n\t#include <clipping_planes_pars_fragment>\n\tvoid main() {\n\n\t\tif ( discardFlag > 0.5 ) discard;\n\n\t\t#include <clipping_planes_fragment>\n\t\tvec3 outgoingLight = vec3( 0.0 );\n\t\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t\t#include <logdepthbuf_fragment>\n\t\t#include <color_fragment>\n\t\toutgoingLight = diffuseColor.rgb; // simple shader\n\t\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t\t#include <tonemapping_fragment>\n\t\t#include <encodings_fragment>\n\t\t#include <fog_fragment>\n\t\t#include <premultiplied_alpha_fragment>\n\t}\n\t",uniforms:{diffuse:{value:new Color(O)},opacity:{value:D}},transparent:F,depthWrite:!F}),z.userData.conditionalEdgeMaterial.userData.canHaveEnvMap=!1),re.userData.code=E,re.name=H,re.userData.edgeMaterial=z,re},objectParse:function(A){var F,L,I,E=this.getParentParseScope(),R=E.mainColourCode,O=E.mainEdgeColourCode,D=this.getCurrentParseScope(),V=[],z=null,H=null;-1!==A.indexOf("\r\n")&&(A=A.replace(/\r\n/g,"\n"));var X=A.split("\n"),re=X.length,j=0,te=!1,J=null,k=null,U=!1,K=!0,ee=!1,Q=!0,oe="",me=!1,fe=this;function ge(vt,Gt){var Lt=vt.getToken();!Gt&&"16"===Lt&&(Lt=R),Gt&&"24"===Lt&&(Lt=O);var yt=fe.getMaterial(Lt);if(!yt)throw'LDrawLoader: Unknown colour code "'+Lt+'" is used'+vt.getLineNumberString()+" but it was not defined previously.";return yt}function $(vt){var Gt=new Vector3(parseFloat(vt.getToken()),parseFloat(vt.getToken()),parseFloat(vt.getToken()));return fe.separateObjects||Gt.applyMatrix4(D.currentMatrix),Gt}for(j=0;j<re;j++){var ue=X[j];if(0!==ue.length){if(te){ue.startsWith("0 FILE ")?(this.subobjectCache[J.toLowerCase()]=k,J=ue.substring(7),k=""):k+=ue+"\n";continue}var Y=new C(ue,j+1);if(Y.seekNonSpace(),!Y.isAtTheEnd()){var Z=Y.getToken();switch(Z){case"0":var se=Y.getToken();if(se)switch(se){case"!LDRAW_ORG":oe=Y.getToken(),te||(D.triangles=[],D.lineSegments=[],D.conditionalSegments=[],D.type=oe,(!E.isFromParse||fe.separateObjects&&!g(oe))&&(D.groupObject=new Group,D.groupObject.userData.startingConstructionStep=D.startingConstructionStep),(pt=D.matrix).determinant()<0&&(fe.separateObjects&&g(oe)||!fe.separateObjects)&&(D.inverted=!D.inverted),F=D.triangles,L=D.lineSegments,I=D.conditionalSegments);break;case"!COLOUR":(ae=this.parseColourMetaDirective(Y))?this.addMaterial(ae):console.warn("LDrawLoader: Error parsing material"+Y.getLineNumberString());break;case"!CATEGORY":z=Y.getToken();break;case"!KEYWORDS":var le=Y.getRemainingString().split(",");le.length>0&&(H||(H=[]),le.forEach(function(Gt){H.push(Gt.trim())}));break;case"FILE":j>0&&(te=!0,J=Y.getRemainingString(),k="",U=!1,K=!0);break;case"BFC":for(;!Y.isAtTheEnd();){var _e=Y.getToken();switch(_e){case"CERTIFY":case"NOCERTIFY":U="CERTIFY"===_e,K=!0;break;case"CW":case"CCW":K="CCW"===_e;break;case"INVERTNEXT":ee=!0;break;case"CLIP":case"NOCLIP":Q="CLIP"===_e;break;default:console.warn('LDrawLoader: BFC directive "'+_e+'" is unknown.')}}break;case"STEP":me=!0}break;case"1":var ae=ge(Y),pe=parseFloat(Y.getToken()),he=parseFloat(Y.getToken()),ce=parseFloat(Y.getToken()),Te=parseFloat(Y.getToken()),be=parseFloat(Y.getToken()),xe=parseFloat(Y.getToken()),we=parseFloat(Y.getToken()),Ne=parseFloat(Y.getToken()),Re=parseFloat(Y.getToken()),De=parseFloat(Y.getToken()),Je=parseFloat(Y.getToken()),$e=parseFloat(Y.getToken()),pt=(new Matrix4).set(Te,be,xe,pe,we,Ne,Re,he,De,Je,$e,ce,0,0,0,1),ut=Y.getRemainingString().trim().replace(/\\/g,"/");fe.fileMap[ut]?ut=fe.fileMap[ut]:ut.startsWith("s/")?ut="parts/"+ut:ut.startsWith("48/")&&(ut="p/"+ut),V.push({material:ae,matrix:pt,fileName:ut,originalFileName:ut,locationState:x.FILE_LOCATION_AS_IS,url:null,triedLowerCase:!1,inverted:ee!==D.inverted,startingConstructionStep:me}),ee=!1;break;case"2":var at={material:(ae=ge(Y,!0)).userData.edgeMaterial,colourCode:ae.userData.code,v0:$(Y),v1:$(Y)};L.push(at);break;case"5":at={material:(ae=ge(Y,!0)).userData.edgeMaterial.userData.conditionalEdgeMaterial,colourCode:ae.userData.code,v0:$(Y),v1:$(Y),c0:$(Y),c1:$(Y)},I.push(at);break;case"3":ae=ge(Y);var lt=!U||!Q;!0==(K!==D.inverted)?(ot=$(Y),St=$(Y),ft=$(Y)):(ft=$(Y),St=$(Y),ot=$(Y)),a.subVectors(St,ot),d.subVectors(ft,St),He=(new Vector3).crossVectors(a,d).normalize(),F.push({material:ae,colourCode:ae.userData.code,v0:ot,v1:St,v2:ft,faceNormal:He,n0:null,n1:null,n2:null}),!0===lt&&F.push({material:ae,colourCode:ae.userData.code,v0:ot,v1:ft,v2:St,faceNormal:He,n0:null,n1:null,n2:null});break;case"4":var ot,St,ft,gt,He;ae=ge(Y),lt=!U||!Q,!0==(K!==D.inverted)?(ot=$(Y),St=$(Y),ft=$(Y),gt=$(Y)):(gt=$(Y),ft=$(Y),St=$(Y),ot=$(Y)),a.subVectors(St,ot),d.subVectors(ft,St),He=(new Vector3).crossVectors(a,d).normalize(),F.push({material:ae,colourCode:ae.userData.code,v0:ot,v1:St,v2:ft,faceNormal:He,n0:null,n1:null,n2:null}),F.push({material:ae,colourCode:ae.userData.code,v0:ot,v1:ft,v2:gt,faceNormal:He,n0:null,n1:null,n2:null}),!0===lt&&(F.push({material:ae,colourCode:ae.userData.code,v0:ot,v1:ft,v2:St,faceNormal:He,n0:null,n1:null,n2:null}),F.push({material:ae,colourCode:ae.userData.code,v0:ot,v1:gt,v2:ft,faceNormal:He,n0:null,n1:null,n2:null}));break;default:throw'LDrawLoader: Unknown line type "'+Z+'"'+Y.getLineNumberString()+"."}}}}te&&(this.subobjectCache[J.toLowerCase()]=k),D.category=z,D.keywords=H,D.subobjects=V,D.numSubobjects=V.length,D.subobjectIndex=0},computeConstructionSteps:function(A){var E=0;A.traverse(function(R){R.isGroup&&(R.userData.startingConstructionStep&&E++,R.userData.constructionStep=E)}),A.userData.numConstructionSteps=E+1},processObject:function(A,E,R,O){var D=this,F=D.newParseScopeLevel();F.url=O;var L=D.getParentParseScope();R&&(F.currentMatrix.multiplyMatrices(L.currentMatrix,R.matrix),F.matrix.copy(R.matrix),F.inverted=R.inverted,F.startingConstructionStep=R.startingConstructionStep);var I=L.currentFileName;null!==I&&(I=L.currentFileName.toLowerCase()),void 0===D.subobjectCache[I]&&(D.subobjectCache[I]=A),D.objectParse(A);var V=0;function z(){if(++V===F.subobjects.length+1)!function(){D.smoothNormals&&"Part"===F.type&&function(b,A){function E(le){return~~(100*le.x)+","+~~(100*le.y)+","+~~(100*le.z)}function R(le,_e){return E(le)+"_"+E(_e)}for(var O=new Set,D={},F={},L=[],I=0,V=A.length;I<V;I++){var z=A[I];O.add(R(H=z.v0,X=z.v1)),O.add(R(X,H))}for(I=0,V=b.length;I<V;I++)for(var re=b[I],j=0,te=3;j<te;j++){var U=R(H=re["v"+(J=j)],X=re["v"+(k=(j+1)%3)]);O.has(U)||(D[U]=re,F[U]=re)}for(;;){var K=Object.keys(D);if(0===K.length)break;I=0;for(var ee=[F[K[0]]];I<ee.length;){re=ee[I],I++;var Q=re.faceNormal;for(null===re.n0&&(re.n0=Q.clone(),L.push(re.n0)),null===re.n1&&(re.n1=Q.clone(),L.push(re.n1)),null===re.n2&&(re.n2=Q.clone(),L.push(re.n2)),j=0,te=3;j<te;j++){var J,k,H,X;delete D[U=R(H=re["v"+(J=j)],X=re["v"+(k=(j+1)%3)])];var oe=R(X,H),me=F[oe];if(me){if(Math.abs(me.faceNormal.dot(re.faceNormal))<.25)continue;oe in D&&(ee.push(me),delete D[oe]);for(var fe=0;fe<3;fe++){var $=fe,ue=(fe+1)%3;if(R(me["v"+$],me["v"+ue])===oe){var ve;null===me["n"+$]&&(me["n"+$]=ve=re["n"+k],ve.add(me.faceNormal)),null===me["n"+ue]&&(me["n"+ue]=ve=re["n"+J],ve.add(me.faceNormal));break}}}}}}for(I=0,V=L.length;I<V;I++)L[I].normalize()}(F.triangles,F.lineSegments);var te=!L.isFromParse;if(D.separateObjects&&!g(F.type)||te){var J=F.groupObject;F.triangles.length>0&&J.add(_(F.triangles,3)),F.lineSegments.length>0&&J.add(_(F.lineSegments,2)),F.conditionalSegments.length>0&&J.add(_(F.conditionalSegments,2,!0)),L.groupObject&&(J.name=F.fileName,J.userData.category=F.category,J.userData.keywords=F.keywords,F.matrix.decompose(J.position,J.quaternion,J.scale),L.groupObject.add(J))}else{for(var k=D.separateObjects,U=L.lineSegments,K=L.conditionalSegments,ee=L.triangles,Q=F.lineSegments,oe=F.conditionalSegments,me=F.triangles,fe=0,ge=Q.length;fe<ge;fe++){var $=Q[fe];k&&($.v0.applyMatrix4(F.matrix),$.v1.applyMatrix4(F.matrix)),U.push($)}for(fe=0,ge=oe.length;fe<ge;fe++){var ue=oe[fe];k&&(ue.v0.applyMatrix4(F.matrix),ue.v1.applyMatrix4(F.matrix),ue.c0.applyMatrix4(F.matrix),ue.c1.applyMatrix4(F.matrix)),K.push(ue)}for(fe=0,ge=me.length;fe<ge;fe++){var Y=me[fe];k&&(Y.v0=Y.v0.clone().applyMatrix4(F.matrix),Y.v1=Y.v1.clone().applyMatrix4(F.matrix),Y.v2=Y.v2.clone().applyMatrix4(F.matrix),a.subVectors(Y.v1,Y.v0),d.subVectors(Y.v2,Y.v1),Y.faceNormal.crossVectors(a,d).normalize()),ee.push(Y)}}D.removeScopeLevel(),L.isFromParse||D.computeConstructionSteps(F.groupObject),E&&E(F.groupObject)}();else{var te=F.subobjects[F.subobjectIndex];Promise.resolve().then(function(){X(te)}),F.subobjectIndex++}}function X(te){F.mainColourCode=te.material.userData.code,F.mainEdgeColourCode=te.material.userData.edgeMaterial.userData.code,F.currentFileName=te.originalFileName;var J=D.subobjectCache[te.originalFileName.toLowerCase()];if(J)D.processObject(J,function(ee){re(ee,te),z()},te,O);else{var k=te.fileName,U=x.FILE_LOCATION_NOT_FOUND;switch(te.locationState){case x.FILE_LOCATION_AS_IS:U=te.locationState+1;break;case x.FILE_LOCATION_TRY_PARTS:k="parts/"+k,U=te.locationState+1;break;case x.FILE_LOCATION_TRY_P:k="p/"+k,U=te.locationState+1;break;case x.FILE_LOCATION_TRY_MODELS:k="models/"+k,U=te.locationState+1;break;case x.FILE_LOCATION_TRY_RELATIVE:k=O.substring(0,O.lastIndexOf("/")+1)+k,U=te.locationState+1;break;case x.FILE_LOCATION_TRY_ABSOLUTE:te.triedLowerCase?U=x.FILE_LOCATION_NOT_FOUND:(te.fileName=te.fileName.toLowerCase(),k=te.fileName,te.triedLowerCase=!0,U=x.FILE_LOCATION_AS_IS);break;case x.FILE_LOCATION_NOT_FOUND:return void console.warn('LDrawLoader: Subobject "'+te.originalFileName+'" could not be found.')}te.locationState=U,te.url=k;var K=new FileLoader(D.manager);K.setPath(D.path),K.load(k,function(ee){D.processObject(ee,function(Q){re(Q,te),z()},te,O)},void 0,function(ee){!function(te,J){X(J)}(0,te)},te)}}function re(te,J){null!==te?D.fileMap[J.originalFileName]=J.url:X(J)}z()}}),x}();function MeshPhysicalMaterial(s){MeshStandardMaterial.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearcoat=0,this.clearcoatRoughness=0,this.sheen=null,this.clearcoatNormalScale=new Vector2(1,1),this.clearcoatNormalMap=null,this.transparency=0,this.setValues(s)}function LWO2Parser(s){this.IFF=s}function LWO3Parser(s){this.IFF=s}function IFFParser(){this.debugger=new Debugger}function DataViewReader(s){this.dv=new DataView(s),this.offset=0}function Debugger(){this.active=!1,this.depth=0,this.formList=[]}function isEven(s){return s%2}function stringOffset(s){return s.length+1+(isEven(s.length+1)?1:0)}function printBuffer(s,e,a){console.log(LoaderUtils.decodeText(new Uint8Array(s,e,a)))}MeshPhysicalMaterial.prototype=Object.create(MeshStandardMaterial.prototype),MeshPhysicalMaterial.prototype.constructor=MeshPhysicalMaterial,MeshPhysicalMaterial.prototype.isMeshPhysicalMaterial=!0,MeshPhysicalMaterial.prototype.copy=function(s){return MeshStandardMaterial.prototype.copy.call(this,s),this.defines={STANDARD:"",PHYSICAL:""},this.reflectivity=s.reflectivity,this.clearcoat=s.clearcoat,this.clearcoatRoughness=s.clearcoatRoughness,this.sheen=s.sheen?(this.sheen||new Color).copy(s.sheen):null,this.clearcoatNormalMap=s.clearcoatNormalMap,this.clearcoatNormalScale.copy(s.clearcoatNormalScale),this.transparency=s.transparency,this},LWO2Parser.prototype={constructor:LWO2Parser,parseBlock:function(){this.IFF.debugger.offset=this.IFF.reader.offset,this.IFF.debugger.closeForms();var e=this.IFF.reader.getIDTag(),a=this.IFF.reader.getUint32();switch(a>this.IFF.reader.dv.byteLength-this.IFF.reader.offset&&(this.IFF.reader.offset-=4,a=this.IFF.reader.getUint16()),this.IFF.debugger.dataOffset=this.IFF.reader.offset,this.IFF.debugger.length=a,e){case"FORM":this.IFF.parseForm(a);break;case"ICON":case"VMPA":case"BBOX":case"NORM":case"PRE ":case"POST":case"KEY ":case"SPAN":case"TIME":case"CLRS":case"CLRA":case"FILT":case"DITH":case"CONT":case"BRIT":case"SATR":case"HUE ":case"GAMM":case"NEGA":case"IFLT":case"PFLT":case"PROJ":case"AXIS":case"AAST":case"PIXB":case"AUVO":case"STCK":case"PROC":case"VALU":case"FUNC":case"PNAM":case"INAM":case"GRST":case"GREN":case"GRPT":case"FKEY":case"IKEY":case"CSYS":case"OPAQ":case"CMAP":case"NLOC":case"NZOM":case"NVER":case"NSRV":case"NVSK":case"NCRD":case"WRPW":case"WRPH":case"NMOD":case"NPRW":case"NPLA":case"NODS":case"VERS":case"ENUM":case"TAG ":case"OPAC":case"CGMD":case"CGTY":case"CGST":case"CGEN":case"CGTS":case"CGTE":case"OSMP":case"OMDE":case"OUTR":case"FLAG":case"TRNL":case"GLOW":case"GVAL":case"SHRP":case"RFOP":case"RSAN":case"TROP":case"RBLR":case"TBLR":case"CLRH":case"CLRF":case"ADTR":case"LINE":case"ALPH":case"VCOL":case"ENAB":case"TMAP":this.IFF.debugger.skipped=!0,this.IFF.reader.skip(a);break;case"SURF":this.IFF.parseSurfaceLwo2(a);break;case"CLIP":this.IFF.parseClipLwo2(a);break;case"IPIX":case"IMIP":case"IMOD":case"AMOD":case"IINV":case"INCR":case"IAXS":case"IFOT":case"ITIM":case"IWRL":case"IUTI":case"IINX":case"IINY":case"IINZ":case"IREF":4===a?this.IFF.currentNode[e]=this.IFF.reader.getInt32():this.IFF.reader.skip(a);break;case"OTAG":this.IFF.parseObjectTag();break;case"LAYR":this.IFF.parseLayer(a);break;case"PNTS":this.IFF.parsePoints(a);break;case"VMAP":this.IFF.parseVertexMapping(a);break;case"AUVU":case"AUVN":this.IFF.reader.skip(a-1),this.IFF.reader.getVariableLengthIndex();break;case"POLS":this.IFF.parsePolygonList(a);break;case"TAGS":this.IFF.parseTagStrings(a);break;case"PTAG":this.IFF.parsePolygonTagMapping(a);break;case"VMAD":this.IFF.parseVertexMapping(a,!0);break;case"DESC":this.IFF.currentForm.description=this.IFF.reader.getString();break;case"TEXT":case"CMNT":case"NCOM":this.IFF.currentForm.comment=this.IFF.reader.getString();break;case"NAME":this.IFF.currentForm.channelName=this.IFF.reader.getString();break;case"WRAP":this.IFF.currentForm.wrap={w:this.IFF.reader.getUint16(),h:this.IFF.reader.getUint16()};break;case"IMAG":var d=this.IFF.reader.getVariableLengthIndex();this.IFF.currentForm.imageIndex=d;break;case"OREF":this.IFF.currentForm.referenceObject=this.IFF.reader.getString();break;case"ROID":this.IFF.currentForm.referenceObjectID=this.IFF.reader.getUint32();break;case"SSHN":this.IFF.currentSurface.surfaceShaderName=this.IFF.reader.getString();break;case"AOVN":this.IFF.currentSurface.surfaceCustomAOVName=this.IFF.reader.getString();break;case"NSTA":this.IFF.currentForm.disabled=this.IFF.reader.getUint16();break;case"NRNM":this.IFF.currentForm.realName=this.IFF.reader.getString();break;case"NNME":this.IFF.currentForm.refName=this.IFF.reader.getString(),this.IFF.currentSurface.nodes[this.IFF.currentForm.refName]=this.IFF.currentForm;break;case"INME":this.IFF.currentForm.nodeName||(this.IFF.currentForm.nodeName=[]),this.IFF.currentForm.nodeName.push(this.IFF.reader.getString());break;case"IINN":this.IFF.currentForm.inputNodeName||(this.IFF.currentForm.inputNodeName=[]),this.IFF.currentForm.inputNodeName.push(this.IFF.reader.getString());break;case"IINM":this.IFF.currentForm.inputName||(this.IFF.currentForm.inputName=[]),this.IFF.currentForm.inputName.push(this.IFF.reader.getString());break;case"IONM":this.IFF.currentForm.inputOutputName||(this.IFF.currentForm.inputOutputName=[]),this.IFF.currentForm.inputOutputName.push(this.IFF.reader.getString());break;case"FNAM":this.IFF.currentForm.fileName=this.IFF.reader.getString();break;case"CHAN":4===a?this.IFF.currentForm.textureChannel=this.IFF.reader.getIDTag():this.IFF.reader.skip(a);break;case"SMAN":var v=this.IFF.reader.getFloat32();this.IFF.currentSurface.attributes.smooth=!(v<0);break;case"COLR":this.IFF.currentSurface.attributes.Color={value:this.IFF.reader.getFloat32Array(3)},this.IFF.reader.skip(2);break;case"LUMI":this.IFF.currentSurface.attributes.Luminosity={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"SPEC":this.IFF.currentSurface.attributes.Specular={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"DIFF":this.IFF.currentSurface.attributes.Diffuse={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"REFL":this.IFF.currentSurface.attributes.Reflection={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"GLOS":this.IFF.currentSurface.attributes.Glossiness={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"TRAN":this.IFF.currentSurface.attributes.opacity=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"BUMP":this.IFF.currentSurface.attributes.bumpStrength=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"SIDE":this.IFF.currentSurface.attributes.side=this.IFF.reader.getUint16();break;case"RIMG":this.IFF.currentSurface.attributes.reflectionMap=this.IFF.reader.getVariableLengthIndex();break;case"RIND":this.IFF.currentSurface.attributes.refractiveIndex=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"TIMG":this.IFF.currentSurface.attributes.refractionMap=this.IFF.reader.getVariableLengthIndex();break;case"IMAP":this.IFF.reader.skip(2);break;case"IUVI":this.IFF.currentNode.UVChannel=this.IFF.reader.getString(a);break;case"IUTL":this.IFF.currentNode.widthWrappingMode=this.IFF.reader.getUint32();break;case"IVTL":this.IFF.currentNode.heightWrappingMode=this.IFF.reader.getUint32();break;case"BLOK":break;default:this.IFF.parseUnknownCHUNK(e,a)}"FORM"!=e&&(this.IFF.debugger.node=1,this.IFF.debugger.nodeID=e,this.IFF.debugger.log()),this.IFF.reader.offset>=this.IFF.currentFormEnd&&(this.IFF.currentForm=this.IFF.parentForm)}},LWO3Parser.prototype={constructor:LWO3Parser,parseBlock:function(){this.IFF.debugger.offset=this.IFF.reader.offset,this.IFF.debugger.closeForms();var e=this.IFF.reader.getIDTag(),a=this.IFF.reader.getUint32();switch(this.IFF.debugger.dataOffset=this.IFF.reader.offset,this.IFF.debugger.length=a,e){case"FORM":this.IFF.parseForm(a);break;case"ICON":case"VMPA":case"BBOX":case"NORM":case"PRE ":case"POST":case"KEY ":case"SPAN":case"TIME":case"CLRS":case"CLRA":case"FILT":case"DITH":case"CONT":case"BRIT":case"SATR":case"HUE ":case"GAMM":case"NEGA":case"IFLT":case"PFLT":case"PROJ":case"AXIS":case"AAST":case"PIXB":case"STCK":case"VALU":case"PNAM":case"INAM":case"GRST":case"GREN":case"GRPT":case"FKEY":case"IKEY":case"CSYS":case"OPAQ":case"CMAP":case"NLOC":case"NZOM":case"NVER":case"NSRV":case"NCRD":case"NMOD":case"NSEL":case"NPRW":case"NPLA":case"VERS":case"ENUM":case"TAG ":case"CGMD":case"CGTY":case"CGST":case"CGEN":case"CGTS":case"CGTE":case"OSMP":case"OMDE":case"OUTR":case"FLAG":case"TRNL":case"SHRP":case"RFOP":case"RSAN":case"TROP":case"RBLR":case"TBLR":case"CLRH":case"CLRF":case"ADTR":case"GLOW":case"LINE":case"ALPH":case"VCOL":case"ENAB":this.IFF.debugger.skipped=!0,this.IFF.reader.skip(a);break;case"IPIX":case"IMIP":case"IMOD":case"AMOD":case"IINV":case"INCR":case"IAXS":case"IFOT":case"ITIM":case"IWRL":case"IUTI":case"IINX":case"IINY":case"IINZ":case"IREF":4===a?this.IFF.currentNode[e]=this.IFF.reader.getInt32():this.IFF.reader.skip(a);break;case"OTAG":this.IFF.parseObjectTag();break;case"LAYR":this.IFF.parseLayer(a);break;case"PNTS":this.IFF.parsePoints(a);break;case"VMAP":this.IFF.parseVertexMapping(a);break;case"POLS":this.IFF.parsePolygonList(a);break;case"TAGS":this.IFF.parseTagStrings(a);break;case"PTAG":this.IFF.parsePolygonTagMapping(a);break;case"VMAD":this.IFF.parseVertexMapping(a,!0);break;case"DESC":this.IFF.currentForm.description=this.IFF.reader.getString();break;case"TEXT":case"CMNT":case"NCOM":this.IFF.currentForm.comment=this.IFF.reader.getString();break;case"NAME":this.IFF.currentForm.channelName=this.IFF.reader.getString();break;case"WRAP":this.IFF.currentForm.wrap={w:this.IFF.reader.getUint16(),h:this.IFF.reader.getUint16()};break;case"IMAG":var d=this.IFF.reader.getVariableLengthIndex();this.IFF.currentForm.imageIndex=d;break;case"OREF":this.IFF.currentForm.referenceObject=this.IFF.reader.getString();break;case"ROID":this.IFF.currentForm.referenceObjectID=this.IFF.reader.getUint32();break;case"SSHN":this.IFF.currentSurface.surfaceShaderName=this.IFF.reader.getString();break;case"AOVN":this.IFF.currentSurface.surfaceCustomAOVName=this.IFF.reader.getString();break;case"NSTA":this.IFF.currentForm.disabled=this.IFF.reader.getUint16();break;case"NRNM":this.IFF.currentForm.realName=this.IFF.reader.getString();break;case"NNME":this.IFF.currentForm.refName=this.IFF.reader.getString(),this.IFF.currentSurface.nodes[this.IFF.currentForm.refName]=this.IFF.currentForm;break;case"INME":this.IFF.currentForm.nodeName||(this.IFF.currentForm.nodeName=[]),this.IFF.currentForm.nodeName.push(this.IFF.reader.getString());break;case"IINN":this.IFF.currentForm.inputNodeName||(this.IFF.currentForm.inputNodeName=[]),this.IFF.currentForm.inputNodeName.push(this.IFF.reader.getString());break;case"IINM":this.IFF.currentForm.inputName||(this.IFF.currentForm.inputName=[]),this.IFF.currentForm.inputName.push(this.IFF.reader.getString());break;case"IONM":this.IFF.currentForm.inputOutputName||(this.IFF.currentForm.inputOutputName=[]),this.IFF.currentForm.inputOutputName.push(this.IFF.reader.getString());break;case"FNAM":this.IFF.currentForm.fileName=this.IFF.reader.getString();break;case"CHAN":4===a?this.IFF.currentForm.textureChannel=this.IFF.reader.getIDTag():this.IFF.reader.skip(a);break;case"SMAN":var v=this.IFF.reader.getFloat32();this.IFF.currentSurface.attributes.smooth=!(v<0);break;case"COLR":this.IFF.currentSurface.attributes.Color={value:this.IFF.reader.getFloat32Array(3)},this.IFF.reader.skip(2);break;case"LUMI":this.IFF.currentSurface.attributes.Luminosity={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"SPEC":this.IFF.currentSurface.attributes.Specular={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"DIFF":this.IFF.currentSurface.attributes.Diffuse={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"REFL":this.IFF.currentSurface.attributes.Reflection={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"GLOS":this.IFF.currentSurface.attributes.Glossiness={value:this.IFF.reader.getFloat32()},this.IFF.reader.skip(2);break;case"TRAN":this.IFF.currentSurface.attributes.opacity=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"BUMP":this.IFF.currentSurface.attributes.bumpStrength=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"SIDE":this.IFF.currentSurface.attributes.side=this.IFF.reader.getUint16();break;case"RIMG":this.IFF.currentSurface.attributes.reflectionMap=this.IFF.reader.getVariableLengthIndex();break;case"RIND":this.IFF.currentSurface.attributes.refractiveIndex=this.IFF.reader.getFloat32(),this.IFF.reader.skip(2);break;case"TIMG":this.IFF.currentSurface.attributes.refractionMap=this.IFF.reader.getVariableLengthIndex();break;case"IMAP":this.IFF.currentSurface.attributes.imageMapIndex=this.IFF.reader.getUint32();break;case"IUVI":this.IFF.currentNode.UVChannel=this.IFF.reader.getString(a);break;case"IUTL":this.IFF.currentNode.widthWrappingMode=this.IFF.reader.getUint32();break;case"IVTL":this.IFF.currentNode.heightWrappingMode=this.IFF.reader.getUint32();break;default:this.IFF.parseUnknownCHUNK(e,a)}"FORM"!=e&&(this.IFF.debugger.node=1,this.IFF.debugger.nodeID=e,this.IFF.debugger.log()),this.IFF.reader.offset>=this.IFF.currentFormEnd&&(this.IFF.currentForm=this.IFF.parentForm)}},IFFParser.prototype={constructor:IFFParser,parse:function(e){if(this.reader=new DataViewReader(e),this.tree={materials:{},layers:[],tags:[],textures:[]},this.currentLayer=this.tree,this.currentForm=this.tree,this.parseTopForm(),void 0!==this.tree.format){if("LWO2"===this.tree.format)for(this.parser=new LWO2Parser(this);!this.reader.endOfFile();)this.parser.parseBlock();else if("LWO3"===this.tree.format)for(this.parser=new LWO3Parser(this);!this.reader.endOfFile();)this.parser.parseBlock();return this.debugger.offset=this.reader.offset,this.debugger.closeForms(),this.tree}},parseTopForm:function(){if(this.debugger.offset=this.reader.offset,"FORM"===this.reader.getIDTag()){var a=this.reader.getUint32();this.debugger.dataOffset=this.reader.offset,this.debugger.length=a;var d=this.reader.getIDTag();("LWO2"===d||"LWO3"===d)&&(this.tree.format=d),this.debugger.node=0,this.debugger.nodeID=d,this.debugger.log()}else console.warn("LWOLoader: Top-level FORM missing.")},parseForm:function(e){var a=this.reader.getIDTag();switch(a){case"ISEQ":case"ANIM":case"STCC":case"VPVL":case"VPRM":case"NROT":case"WRPW":case"WRPH":case"FUNC":case"FALL":case"OPAC":case"GRAD":case"ENVS":case"VMOP":case"VMBG":case"OMAX":case"STEX":case"CKBG":case"CKEY":case"VMLA":case"VMLB":this.debugger.skipped=!0,this.skipForm(e);break;case"META":case"NNDS":case"NODS":case"NDTA":case"ADAT":case"AOVS":case"BLOK":case"IBGC":case"IOPC":case"IIMG":case"TXTR":this.debugger.length=4,this.debugger.skipped=!0;break;case"IFAL":case"ISCL":case"IPOS":case"IROT":case"IBMP":case"IUTD":case"IVTD":this.parseTextureNodeAttribute(a);break;case"ENVL":this.parseEnvelope(e);break;case"CLIP":"LWO2"===this.tree.format?this.parseForm(e):this.parseClip(e);break;case"STIL":this.parseImage();break;case"XREF":this.reader.skip(8),this.currentForm.referenceTexture={index:this.reader.getUint32(),refName:this.reader.getString()};break;case"IMST":this.parseImageStateForm(e);break;case"SURF":this.parseSurfaceForm(e);break;case"VALU":this.parseValueForm(e);break;case"NTAG":this.parseSubNode(e);break;case"ATTR":case"SATR":this.setupForm("attributes",e);break;case"NCON":this.parseConnections(e);break;case"SSHA":this.parentForm=this.currentForm,this.currentForm=this.currentSurface,this.setupForm("surfaceShader",e);break;case"SSHD":this.setupForm("surfaceShaderData",e);break;case"ENTR":this.parseEntryForm(e);break;case"IMAP":this.parseImageMap(e);break;case"TAMP":this.parseXVAL("amplitude",e);break;case"TMAP":this.setupForm("textureMap",e);break;case"CNTR":this.parseXVAL3("center",e);break;case"SIZE":this.parseXVAL3("scale",e);break;case"ROTA":this.parseXVAL3("rotation",e);break;default:this.parseUnknownForm(a,e)}this.debugger.node=0,this.debugger.nodeID=a,this.debugger.log()},setupForm:function(e,a){this.currentForm||(this.currentForm=this.currentNode),this.currentFormEnd=this.reader.offset+a,this.parentForm=this.currentForm,this.currentForm[e]?(console.warn("LWOLoader: form already exists on parent: ",e,this.currentForm),this.currentForm=this.currentForm[e]):(this.currentForm[e]={},this.currentForm=this.currentForm[e])},skipForm:function(e){this.reader.skip(e-4)},parseUnknownForm:function(e,a){console.warn("LWOLoader: unknown FORM encountered: "+e,a),printBuffer(this.reader.dv.buffer,this.reader.offset,a-4),this.reader.skip(a-4)},parseSurfaceForm:function(e){this.reader.skip(8);var a=this.reader.getString(),d={attributes:{},connections:{},name:a,inputName:a,nodes:{},source:this.reader.getString()};this.tree.materials[a]=d,this.currentSurface=d,this.parentForm=this.tree.materials,this.currentForm=d,this.currentFormEnd=this.reader.offset+e},parseSurfaceLwo2:function(e){var a=this.reader.getString(),d={attributes:{},connections:{},name:a,nodes:{},source:this.reader.getString()};this.tree.materials[a]=d,this.currentSurface=d,this.parentForm=this.tree.materials,this.currentForm=d,this.currentFormEnd=this.reader.offset+e},parseSubNode:function(e){this.reader.skip(8);var d={name:this.reader.getString()};this.currentForm=d,this.currentNode=d,this.currentFormEnd=this.reader.offset+e},parseConnections:function(e){this.currentFormEnd=this.reader.offset+e,this.parentForm=this.currentForm,this.currentForm=this.currentSurface.connections},parseEntryForm:function(e){this.reader.skip(8);var a=this.reader.getString();this.currentForm=this.currentNode.attributes,this.setupForm(a,e)},parseValueForm:function(){this.reader.skip(8);var e=this.reader.getString();"double"===e?this.currentForm.value=this.reader.getUint64():"int"===e?this.currentForm.value=this.reader.getUint32():"vparam"===e?(this.reader.skip(24),this.currentForm.value=this.reader.getFloat64()):"vparam3"===e&&(this.reader.skip(24),this.currentForm.value=this.reader.getFloat64Array(3))},parseImageStateForm:function(){this.reader.skip(8),this.currentForm.mipMapLevel=this.reader.getFloat32()},parseImageMap:function(e){this.currentFormEnd=this.reader.offset+e,this.parentForm=this.currentForm,this.currentForm.maps||(this.currentForm.maps=[]);var a={};this.currentForm.maps.push(a),this.currentForm=a,this.reader.skip(10)},parseTextureNodeAttribute:function(e){switch(this.reader.skip(28),this.reader.skip(20),e){case"ISCL":this.currentNode.scale=this.reader.getFloat32Array(3);break;case"IPOS":this.currentNode.position=this.reader.getFloat32Array(3);break;case"IROT":this.currentNode.rotation=this.reader.getFloat32Array(3);break;case"IFAL":this.currentNode.falloff=this.reader.getFloat32Array(3);break;case"IBMP":this.currentNode.amplitude=this.reader.getFloat32();break;case"IUTD":this.currentNode.uTiles=this.reader.getFloat32();break;case"IVTD":this.currentNode.vTiles=this.reader.getFloat32()}this.reader.skip(2)},parseEnvelope:function(e){this.reader.skip(e-4)},parseClip:function(e){if("FORM"===this.reader.getIDTag())return this.reader.skip(16),void(this.currentNode.fileName=this.reader.getString());this.reader.setOffset(this.reader.offset-4),this.currentFormEnd=this.reader.offset+e,this.parentForm=this.currentForm,this.reader.skip(8);var d={index:this.reader.getUint32()};this.tree.textures.push(d),this.currentForm=d},parseClipLwo2:function(e){for(var a={index:this.reader.getUint32(),fileName:""};;){var d=this.reader.getIDTag(),v=this.reader.getUint16();if("STIL"===d){a.fileName=this.reader.getString();break}if(v>=e)break}this.tree.textures.push(a),this.currentForm=a},parseImage:function(){this.reader.skip(8),this.currentForm.fileName=this.reader.getString()},parseXVAL:function(e,a){var d=this.reader.offset+a-4;this.reader.skip(8),this.currentForm[e]=this.reader.getFloat32(),this.reader.setOffset(d)},parseXVAL3:function(e,a){var d=this.reader.offset+a-4;this.reader.skip(8),this.currentForm[e]={x:this.reader.getFloat32(),y:this.reader.getFloat32(),z:this.reader.getFloat32()},this.reader.setOffset(d)},parseObjectTag:function(){this.tree.objectTags||(this.tree.objectTags={}),this.tree.objectTags[this.reader.getIDTag()]={tagString:this.reader.getString()}},parseLayer:function(e){var a={number:this.reader.getUint16(),flags:this.reader.getUint16(),pivot:this.reader.getFloat32Array(3),name:this.reader.getString()};this.tree.layers.push(a),this.currentLayer=a;var d=16+stringOffset(this.currentLayer.name);this.currentLayer.parent=d<e?this.reader.getUint16():-1},parsePoints:function(e){this.currentPoints=[];for(var a=0;a<e/4;a+=3)this.currentPoints.push(this.reader.getFloat32(),this.reader.getFloat32(),-this.reader.getFloat32())},parseVertexMapping:function(e,a){var d=this.reader.offset+e,v=this.reader.getString();if(this.reader.offset!==d){this.reader.setOffset(this.reader.offset-stringOffset(v));var g=this.reader.getIDTag();this.reader.getUint16();var C=this.reader.getString(),w=e-6-stringOffset(C);switch(g){case"TXUV":this.parseUVMapping(C,d,a);break;case"MORF":case"SPOT":this.parseMorphTargets(C,d,g);break;case"APSL":case"NORM":case"WGHT":case"MNVW":case"PICK":case"RGB ":case"RGBA":this.reader.skip(w);break;default:console.warn("LWOLoader: unknown vertex map type: "+g),this.reader.skip(w)}}else this.currentForm.UVChannel=v},parseUVMapping:function(e,a,d){for(var v=[],g=[],C=[];this.reader.offset<a;)v.push(this.reader.getVariableLengthIndex()),d&&g.push(this.reader.getVariableLengthIndex()),C.push(this.reader.getFloat32(),this.reader.getFloat32());d?(this.currentLayer.discontinuousUVs||(this.currentLayer.discontinuousUVs={}),this.currentLayer.discontinuousUVs[e]={uvIndices:v,polyIndices:g,uvs:C}):(this.currentLayer.uvs||(this.currentLayer.uvs={}),this.currentLayer.uvs[e]={uvIndices:v,uvs:C})},parseMorphTargets:function(e,a,d){var v=[],g=[];for(d="MORF"===d?"relative":"absolute";this.reader.offset<a;)v.push(this.reader.getVariableLengthIndex()),g.push(this.reader.getFloat32(),this.reader.getFloat32(),-this.reader.getFloat32());this.currentLayer.morphTargets||(this.currentLayer.morphTargets={}),this.currentLayer.morphTargets[e]={indices:v,points:g,type:d}},parsePolygonList:function(e){for(var a=this.reader.offset+e,d=this.reader.getIDTag(),v=[],g=[];this.reader.offset<a;){var C=this.reader.getUint16();g.push(C&=1023);for(var w=0;w<C;w++)v.push(this.reader.getVariableLengthIndex())}var _={type:d,vertexIndices:v,polygonDimensions:g,points:this.currentPoints};1===g[0]?_.type="points":2===g[0]&&(_.type="lines"),this.currentLayer.geometry=_},parseTagStrings:function(e){this.tree.tags=this.reader.getStringArray(e)},parsePolygonTagMapping:function(e){var a=this.reader.offset+e;"SURF"===this.reader.getIDTag()?this.parseMaterialIndices(a):this.reader.skip(e-4)},parseMaterialIndices:function(e){for(this.currentLayer.geometry.materialIndices=[];this.reader.offset<e;){var a=this.reader.getVariableLengthIndex(),d=this.reader.getUint16();this.currentLayer.geometry.materialIndices.push(a,d)}},parseUnknownCHUNK:function(e,a){console.warn("LWOLoader: unknown chunk type: "+e+" length: "+a);var d=this.reader.getString(a);this.currentForm[e]=d}},DataViewReader.prototype={constructor:DataViewReader,size:function(){return this.dv.buffer.byteLength},setOffset:function(e){e>0&&e<this.dv.buffer.byteLength?this.offset=e:console.error("LWOLoader: invalid buffer offset")},endOfFile:function(){return this.offset>=this.size()},skip:function(e){this.offset+=e},getUint8:function(){var e=this.dv.getUint8(this.offset);return this.offset+=1,e},getUint16:function(){var e=this.dv.getUint16(this.offset);return this.offset+=2,e},getInt32:function(){var e=this.dv.getInt32(this.offset,!1);return this.offset+=4,e},getUint32:function(){var e=this.dv.getUint32(this.offset,!1);return this.offset+=4,e},getUint64:function(){return 4294967296*this.getUint32()+this.getUint32()},getFloat32:function(){var e=this.dv.getFloat32(this.offset,!1);return this.offset+=4,e},getFloat32Array:function(e){for(var a=[],d=0;d<e;d++)a.push(this.getFloat32());return a},getFloat64:function(){var e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e},getFloat64Array:function(e){for(var a=[],d=0;d<e;d++)a.push(this.getFloat64());return a},getVariableLengthIndex:function(){var e=this.getUint8();return 255===e?65536*this.getUint8()+256*this.getUint8()+this.getUint8():256*e+this.getUint8()},getIDTag:function(){return this.getString(4)},getString:function(e){if(0!==e){var a=[];if(e)for(var d=0;d<e;d++)a[d]=this.getUint8();else{for(var v,g=0;0!==v;)0!==(v=this.getUint8())&&a.push(v),g++;isEven(g+1)||this.getUint8()}return LoaderUtils.decodeText(new Uint8Array(a))}},getStringArray:function(e){var a=this.getString(e);return(a=a.split("\0")).filter(Boolean)}},Debugger.prototype={constructor:Debugger,enable:function(){this.active=!0},log:function(){if(this.active){var e;switch(this.node){case 0:e="FORM";break;case 1:e="CHK";break;case 2:e="S-CHK"}console.log("| ".repeat(this.depth)+e,this.nodeID,"( "+this.offset+" ) -> ( "+(this.dataOffset+this.length)+" )",0==this.node?" {":"",this.skipped?"SKIPPED":"",0==this.node&&this.skipped?"}":""),0==this.node&&!this.skipped&&(this.depth+=1,this.formList.push(this.dataOffset+this.length)),this.skipped=!1}},closeForms:function(){if(this.active)for(var e=this.formList.length-1;e>=0;e--)this.offset>=this.formList[e]&&(this.depth-=1,console.log("| ".repeat(this.depth)+"}"),this.formList.splice(-1,1))}};var lwoTree,LWOLoader=function(e,a){Loader.call(this,e),this.resourcePath=void 0!==(a=a||{}).resourcePath?a.resourcePath:""};function LWOTreeParser(s){this.textureLoader=s}function MaterialParser(s){this.textureLoader=s}function GeometryParser(){}function extractParentUrl(s,e){var a=s.indexOf(e);return-1===a?"./":s.substr(0,a)}LWOLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:LWOLoader,load:function(e,a,d,v){var g=this,C=""===g.path?extractParentUrl(e,"Objects"):g.path,w=e.split(C).pop().split(".")[0],_=new FileLoader(this.manager);_.setPath(g.path),_.setResponseType("arraybuffer"),_.load(e,function(x){a(g.parse(x,C,w))},d,v)},parse:function(e,a,d){return lwoTree=(new IFFParser).parse(e),new LWOTreeParser(new TextureLoader(this.manager).setPath(this.resourcePath||a).setCrossOrigin(this.crossOrigin)).parse(d)}}),LWOTreeParser.prototype={constructor:LWOTreeParser,parse:function(e){return this.materials=new MaterialParser(this.textureLoader).parse(),this.defaultLayerName=e,this.meshes=this.parseLayers(),{materials:this.materials,meshes:this.meshes}},parseLayers:function(){var e=[],a=[],d=new GeometryParser,v=this;return lwoTree.layers.forEach(function(g){var C=d.parse(g.geometry,g),w=v.parseMesh(C,g);e[g.number]=w,-1===g.parent?a.push(w):e[g.parent].add(w)}),this.applyPivots(a),a},parseMesh:function(e,a){var d,v=this.getMaterials(e.userData.matNames,a.geometry.type);return this.duplicateUVs(e,v),(d="points"===a.geometry.type?new Points(e,v):"lines"===a.geometry.type?new LineSegments(e,v):new Mesh(e,v)).name=a.name?a.name:this.defaultLayerName+"_layer_"+a.number,d.userData.pivot=a.pivot,d},applyPivots:function(e){e.forEach(function(a){a.traverse(function(d){var v=d.userData.pivot;if(d.position.x+=v[0],d.position.y+=v[1],d.position.z+=v[2],d.parent){var g=d.parent.userData.pivot;d.position.x-=g[0],d.position.y-=g[1],d.position.z-=g[2]}})})},getMaterials:function(e,a){var d=[],v=this;e.forEach(function(C,w){d[w]=v.getMaterialByName(C)}),("points"===a||"lines"===a)&&d.forEach(function(C,w){var _={color:C.color};"points"===a?(_.size=.1,_.map=C.map,_.morphTargets=C.morphTargets,d[w]=new PointsMaterial(_)):"lines"===a&&(d[w]=new LineBasicMaterial(_))});var g=d.filter(Boolean);return 1===g.length?g[0]:d},getMaterialByName:function(e){return this.materials.filter(function(a){return a.name===e})[0]},duplicateUVs:function(e,a){var d=!1;Array.isArray(a)?a.forEach(function(v){v.aoMap&&(d=!0)}):a.aoMap&&(d=!0),d&&e.setAttribute("uv2",new BufferAttribute(e.attributes.uv.array,2))}},MaterialParser.prototype={constructor:MaterialParser,parse:function(){var e=[];for(var a in this.textures={},lwoTree.materials)"LWO3"===lwoTree.format?e.push(this.parseMaterial(lwoTree.materials[a],a,lwoTree.textures)):"LWO2"===lwoTree.format&&e.push(this.parseMaterialLwo2(lwoTree.materials[a],a,lwoTree.textures));return e},parseMaterial:function(e,a,d){var v={name:a,side:this.getSide(e.attributes),flatShading:this.getSmooth(e.attributes)},g=this.parseConnections(e.connections,e.nodes),C=this.parseTextureNodes(g.maps);this.parseAttributeImageMaps(g.attributes,d,C,e.maps);var w=this.parseAttributes(g.attributes,C);return this.parseEnvMap(g,C,w),v=Object.assign(C,v),v=Object.assign(v,w),new(this.getMaterialType(g.attributes))(v)},parseMaterialLwo2:function(e,a){var d={name:a,side:this.getSide(e.attributes),flatShading:this.getSmooth(e.attributes)},v=this.parseAttributes(e.attributes,{});return new MeshPhongMaterial(d=Object.assign(d,v))},getSide:function(e){if(!e.side)return BackSide;switch(e.side){case 0:case 1:return BackSide;case 2:return FrontSide;case 3:return DoubleSide}},getSmooth:function(e){return!e.smooth||!e.smooth},parseConnections:function(e,a){var d={maps:{}},v=e.inputName,g=e.inputNodeName,C=e.nodeName,w=this;return v.forEach(function(_,x){if("Material"===_){var b=w.getNodeByRefName(g[x],a);d.attributes=b.attributes,d.envMap=b.fileName,d.name=g[x]}}),C.forEach(function(_,x){_===d.name&&(d.maps[v[x]]=w.getNodeByRefName(g[x],a))}),d},getNodeByRefName:function(e,a){for(var d in a)if(a[d].refName===e)return a[d]},parseTextureNodes:function(e){var a={};for(var d in e){var v=e[d],g=v.fileName;if(!g)return;var C=this.loadTexture(g);switch(void 0!==v.widthWrappingMode&&(C.wrapS=this.getWrappingType(v.widthWrappingMode)),void 0!==v.heightWrappingMode&&(C.wrapT=this.getWrappingType(v.heightWrappingMode)),d){case"Color":a.map=C;break;case"Roughness":a.roughnessMap=C,a.roughness=.5;break;case"Specular":a.specularMap=C,a.specular=16777215;break;case"Luminous":a.emissiveMap=C,a.emissive=8421504;break;case"Luminous Color":a.emissive=8421504;break;case"Metallic":a.metalnessMap=C,a.metalness=.5;break;case"Transparency":case"Alpha":a.alphaMap=C,a.transparent=!0;break;case"Normal":a.normalMap=C,void 0!==v.amplitude&&(a.normalScale=new Vector2(v.amplitude,v.amplitude));break;case"Bump":a.bumpMap=C}}return a.roughnessMap&&a.specularMap&&delete a.specularMap,a},parseAttributeImageMaps:function(e,a,d){for(var v in e){var g=e[v];if(g.maps){var C=g.maps[0],w=this.getTexturePathByIndex(C.imageIndex,a);if(!w)return;var _=this.loadTexture(w);switch(void 0!==C.wrap&&(_.wrapS=this.getWrappingType(C.wrap.w)),void 0!==C.wrap&&(_.wrapT=this.getWrappingType(C.wrap.h)),v){case"Color":d.map=_;break;case"Diffuse":d.aoMap=_;break;case"Roughness":d.roughnessMap=_,d.roughness=1;break;case"Specular":d.specularMap=_,d.specular=16777215;break;case"Luminosity":d.emissiveMap=_,d.emissive=8421504;break;case"Metallic":d.metalnessMap=_,d.metalness=1;break;case"Transparency":case"Alpha":d.alphaMap=_,d.transparent=!0;break;case"Normal":d.normalMap=_;break;case"Bump":d.bumpMap=_}}}},parseAttributes:function(e,a){var d={};return d.color=e.Color&&!a.map?(new Color).fromArray(e.Color.value):new Color,e.Transparency&&0!==e.Transparency.value&&(d.opacity=1-e.Transparency.value,d.transparent=!0),e["Bump Height"]&&(d.bumpScale=.1*e["Bump Height"].value),e["Refraction Index"]&&(d.refractionRatio=1/e["Refraction Index"].value),this.parsePhysicalAttributes(d,e,a),this.parseStandardAttributes(d,e,a),this.parsePhongAttributes(d,e,a),d},parsePhysicalAttributes:function(e,a){a.Clearcoat&&a.Clearcoat.value>0&&(e.clearcoat=a.Clearcoat.value,a["Clearcoat Gloss"]&&(e.clearcoatRoughness=.5*(1-a["Clearcoat Gloss"].value)))},parseStandardAttributes:function(e,a,d){a.Luminous&&(e.emissiveIntensity=a.Luminous.value,e.emissive=a["Luminous Color"]&&!d.emissive?(new Color).fromArray(a["Luminous Color"].value):new Color(8421504)),a.Roughness&&!d.roughnessMap&&(e.roughness=a.Roughness.value),a.Metallic&&!d.metalnessMap&&(e.metalness=a.Metallic.value)},parsePhongAttributes:function(e,a,d){a.Diffuse&&e.color.multiplyScalar(a.Diffuse.value),a.Reflection&&(e.reflectivity=a.Reflection.value,e.combine=AddOperation),a.Luminosity&&(e.emissiveIntensity=a.Luminosity.value,e.emissive=d.emissiveMap||d.map?new Color(8421504):e.color),!a.Roughness&&a.Specular&&!d.specularMap&&(e.specular=a["Color Highlight"]?(new Color).setScalar(a.Specular.value).lerp(e.color.clone().multiplyScalar(a.Specular.value),a["Color Highlight"].value):(new Color).setScalar(a.Specular.value)),e.specular&&a.Glossiness&&(e.shininess=7+Math.pow(2,12*a.Glossiness.value+2))},parseEnvMap:function(e,a,d){if(e.envMap){var v=this.loadTexture(e.envMap);d.transparent&&d.opacity<.999?(v.mapping=EquirectangularRefractionMapping,void 0!==d.reflectivity&&(delete d.reflectivity,delete d.combine),void 0!==d.metalness&&delete d.metalness):v.mapping=EquirectangularReflectionMapping,a.envMap=v}},getTexturePathByIndex:function(e){var a="";return lwoTree.textures&&lwoTree.textures.forEach(function(d){d.index===e&&(a=d.fileName)}),a},loadTexture:function(e){return e?this.textureLoader.load(e,void 0,void 0,function(){console.warn("LWOLoader: non-standard resource hierarchy. Use `resourcePath` parameter to specify root content directory.")}):null},getWrappingType:function(e){switch(e){case 0:return console.warn('LWOLoader: "Reset" texture wrapping type is not supported in three.js'),ClampToEdgeWrapping;case 1:return RepeatWrapping;case 2:return MirroredRepeatWrapping;case 3:return ClampToEdgeWrapping}},getMaterialType:function(e){return e.Clearcoat&&e.Clearcoat.value>0?MeshPhysicalMaterial:e.Roughness?MeshStandardMaterial:MeshPhongMaterial}},GeometryParser.prototype={constructor:GeometryParser,parse:function(e,a){var d=new BufferGeometry;d.setAttribute("position",new Float32BufferAttribute(e.points,3));var v=this.splitIndices(e.vertexIndices,e.polygonDimensions);return d.setIndex(v),this.parseGroups(d,e),d.computeVertexNormals(),this.parseUVs(d,a,v),this.parseMorphTargets(d,a,v),d.translate(-a.pivot[0],-a.pivot[1],-a.pivot[2]),d},splitIndices:function(e,a){var d=[],v=0;return a.forEach(function(g){if(g<4)for(var C=0;C<g;C++)d.push(e[v+C]);else if(4===g)d.push(e[v],e[v+1],e[v+2],e[v],e[v+2],e[v+3]);else if(g>4){for(C=1;C<g-1;C++)d.push(e[v],e[v+C],e[v+C+1]);console.warn("LWOLoader: polygons with greater than 4 sides are not supported")}v+=g}),d},parseGroups:function(e,a){var d=lwoTree.tags,v=[],g=3;"lines"===a.type&&(g=2),"points"===a.type&&(g=1);for(var x,C=this.splitMaterialIndices(a.polygonDimensions,a.materialIndices),w=0,_={},b=0,A=0,E=0;E<C.length;E+=2){var O,R=C[E+1];0===E&&(v[w]=d[R]),void 0===x&&(x=R),R!==x&&(_[d[x]]?O=_[d[x]]:(O=w,_[d[x]]=w,v[w]=d[x],w++),e.addGroup(b,A,O),b+=A,x=R,A=0),A+=g}e.groups.length>0&&(_[d[R]]?O=_[d[R]]:(O=w,_[d[R]]=w,v[w]=d[R]),e.addGroup(b,A,O)),e.userData.matNames=v},splitMaterialIndices:function(e,a){var d=[];return e.forEach(function(v,g){if(v<=3)d.push(a[2*g],a[2*g+1]);else if(4===v)d.push(a[2*g],a[2*g+1],a[2*g],a[2*g+1]);else for(var C=0;C<v-2;C++)d.push(a[2*g],a[2*g+1])}),d},parseUVs:function(e,a){var d=Array.from(Array(2*e.attributes.position.count),function(){return 0});for(var v in a.uvs){var g=a.uvs[v].uvs;a.uvs[v].uvIndices.forEach(function(w,_){d[2*w]=g[2*_],d[2*w+1]=g[2*_+1]})}e.setAttribute("uv",new Float32BufferAttribute(d,2))},parseMorphTargets:function(e,a){var d=0;for(var v in a.morphTargets){var g=e.attributes.position.array.slice();e.morphAttributes.position||(e.morphAttributes.position=[]);var C=a.morphTargets[v].points,_=a.morphTargets[v].type;a.morphTargets[v].indices.forEach(function(x,b){"relative"===_?(g[3*x]+=C[3*b],g[3*x+1]+=C[3*b+1],g[3*x+2]+=C[3*b+2]):(g[3*x]=C[3*b],g[3*x+1]=C[3*b+1],g[3*x+2]=C[3*b+2])}),e.morphAttributes.position[d]=new Float32BufferAttribute(g,3),e.morphAttributes.position[d].name=v,d++}e.morphTargetsRelative=!1}};var MD2Loader=function(e){Loader.call(this,e)};function MeshToonMaterial(s){Material.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Color(16777215),this.specular=new Color(1118481),this.shininess=30,this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Color(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(s)}MD2Loader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:MD2Loader,load:function(e,a,d,v){var g=this,C=new FileLoader(g.manager);C.setPath(g.path),C.setResponseType("arraybuffer"),C.load(e,function(w){a(g.parse(w))},d,v)},parse:function(){var s=[[-.525731,0,.850651],[-.442863,.238856,.864188],[-.295242,0,.955423],[-.309017,.5,.809017],[-.16246,.262866,.951056],[0,0,1],[0,.850651,.525731],[-.147621,.716567,.681718],[.147621,.716567,.681718],[0,.525731,.850651],[.309017,.5,.809017],[.525731,0,.850651],[.295242,0,.955423],[.442863,.238856,.864188],[.16246,.262866,.951056],[-.681718,.147621,.716567],[-.809017,.309017,.5],[-.587785,.425325,.688191],[-.850651,.525731,0],[-.864188,.442863,.238856],[-.716567,.681718,.147621],[-.688191,.587785,.425325],[-.5,.809017,.309017],[-.238856,.864188,.442863],[-.425325,.688191,.587785],[-.716567,.681718,-.147621],[-.5,.809017,-.309017],[-.525731,.850651,0],[0,.850651,-.525731],[-.238856,.864188,-.442863],[0,.955423,-.295242],[-.262866,.951056,-.16246],[0,1,0],[0,.955423,.295242],[-.262866,.951056,.16246],[.238856,.864188,.442863],[.262866,.951056,.16246],[.5,.809017,.309017],[.238856,.864188,-.442863],[.262866,.951056,-.16246],[.5,.809017,-.309017],[.850651,.525731,0],[.716567,.681718,.147621],[.716567,.681718,-.147621],[.525731,.850651,0],[.425325,.688191,.587785],[.864188,.442863,.238856],[.688191,.587785,.425325],[.809017,.309017,.5],[.681718,.147621,.716567],[.587785,.425325,.688191],[.955423,.295242,0],[1,0,0],[.951056,.16246,.262866],[.850651,-.525731,0],[.955423,-.295242,0],[.864188,-.442863,.238856],[.951056,-.16246,.262866],[.809017,-.309017,.5],[.681718,-.147621,.716567],[.850651,0,.525731],[.864188,.442863,-.238856],[.809017,.309017,-.5],[.951056,.16246,-.262866],[.525731,0,-.850651],[.681718,.147621,-.716567],[.681718,-.147621,-.716567],[.850651,0,-.525731],[.809017,-.309017,-.5],[.864188,-.442863,-.238856],[.951056,-.16246,-.262866],[.147621,.716567,-.681718],[.309017,.5,-.809017],[.425325,.688191,-.587785],[.442863,.238856,-.864188],[.587785,.425325,-.688191],[.688191,.587785,-.425325],[-.147621,.716567,-.681718],[-.309017,.5,-.809017],[0,.525731,-.850651],[-.525731,0,-.850651],[-.442863,.238856,-.864188],[-.295242,0,-.955423],[-.16246,.262866,-.951056],[0,0,-1],[.295242,0,-.955423],[.16246,.262866,-.951056],[-.442863,-.238856,-.864188],[-.309017,-.5,-.809017],[-.16246,-.262866,-.951056],[0,-.850651,-.525731],[-.147621,-.716567,-.681718],[.147621,-.716567,-.681718],[0,-.525731,-.850651],[.309017,-.5,-.809017],[.442863,-.238856,-.864188],[.16246,-.262866,-.951056],[.238856,-.864188,-.442863],[.5,-.809017,-.309017],[.425325,-.688191,-.587785],[.716567,-.681718,-.147621],[.688191,-.587785,-.425325],[.587785,-.425325,-.688191],[0,-.955423,-.295242],[0,-1,0],[.262866,-.951056,-.16246],[0,-.850651,.525731],[0,-.955423,.295242],[.238856,-.864188,.442863],[.262866,-.951056,.16246],[.5,-.809017,.309017],[.716567,-.681718,.147621],[.525731,-.850651,0],[-.238856,-.864188,-.442863],[-.5,-.809017,-.309017],[-.262866,-.951056,-.16246],[-.850651,-.525731,0],[-.716567,-.681718,-.147621],[-.716567,-.681718,.147621],[-.525731,-.850651,0],[-.5,-.809017,.309017],[-.238856,-.864188,.442863],[-.262866,-.951056,.16246],[-.864188,-.442863,.238856],[-.809017,-.309017,.5],[-.688191,-.587785,.425325],[-.681718,-.147621,.716567],[-.442863,-.238856,.864188],[-.587785,-.425325,.688191],[-.309017,-.5,.809017],[-.147621,-.716567,.681718],[-.425325,-.688191,.587785],[-.16246,-.262866,.951056],[.442863,-.238856,.864188],[.16246,-.262866,.951056],[.309017,-.5,.809017],[.147621,-.716567,.681718],[0,-.525731,.850651],[.425325,-.688191,.587785],[.587785,-.425325,.688191],[.688191,-.587785,.425325],[-.955423,.295242,0],[-.951056,.16246,.262866],[-1,0,0],[-.850651,0,.525731],[-.955423,-.295242,0],[-.951056,-.16246,.262866],[-.864188,.442863,-.238856],[-.951056,.16246,-.262866],[-.809017,.309017,-.5],[-.864188,-.442863,-.238856],[-.951056,-.16246,-.262866],[-.809017,-.309017,-.5],[-.681718,.147621,-.716567],[-.681718,-.147621,-.716567],[-.850651,0,-.525731],[-.688191,.587785,-.425325],[-.587785,.425325,-.688191],[-.425325,.688191,-.587785],[-.425325,-.688191,-.587785],[-.587785,-.425325,-.688191],[-.688191,-.587785,-.425325]];return function(e){for(var a=new DataView(e),d={},v=["ident","version","skinwidth","skinheight","framesize","num_skins","num_vertices","num_st","num_tris","num_glcmds","num_frames","offset_skins","offset_st","offset_tris","offset_frames","offset_glcmds","offset_end"],g=0;g<v.length;g++)d[v[g]]=a.getInt32(4*g,!0);if(844121161===d.ident&&8===d.version){if(d.offset_end===a.byteLength){for(var C=new BufferGeometry,w=[],_=d.offset_st,x=(g=0,d.num_st);g<x;g++){var b=a.getInt16(_+0,!0),A=a.getInt16(_+2,!0);w.push(b/d.skinwidth,1-A/d.skinheight),_+=4}_=d.offset_tris;var E=[],R=[];for(g=0,x=d.num_tris;g<x;g++)E.push(a.getUint16(_+0,!0),a.getUint16(_+2,!0),a.getUint16(_+4,!0)),R.push(a.getUint16(_+6,!0),a.getUint16(_+8,!0),a.getUint16(_+10,!0)),_+=12;var O=new Vector3,D=new Vector3,F=[],L=[];for(_=d.offset_frames,g=0,x=d.num_frames;g<x;g++){D.set(a.getFloat32(_+0,!0),a.getFloat32(_+4,!0),a.getFloat32(_+8,!0)),O.set(a.getFloat32(_+12,!0),a.getFloat32(_+16,!0),a.getFloat32(_+20,!0)),_+=24;for(var I=0;I<16;I++){var V=a.getUint8(_+I,!0);if(0===V)break;F[I]=V}var z={name:String.fromCharCode.apply(null,F),vertices:[],normals:[]};for(_+=16,I=0;I<d.num_vertices;I++){var H=a.getUint8(_++,!0),X=a.getUint8(_++,!0),re=a.getUint8(_++,!0),j=s[a.getUint8(_++,!0)];z.vertices.push(H=H*D.x+O.x,re=re*D.z+O.z,X=X*D.y+O.y),z.normals.push(j[0],j[2],j[1])}L.push(z)}var te=[],J=[],k=[],U=L[0].vertices,K=L[0].normals;for(g=0,x=E.length;g<x;g++)te.push(H=U[Q=3*E[g]],X=U[Q+1],re=U[Q+2]),J.push(K[Q],K[Q+1],K[Q+2]),k.push(b=w[Q=2*R[g]],A=w[Q+1]);C.setAttribute("position",new Float32BufferAttribute(te,3)),C.setAttribute("normal",new Float32BufferAttribute(J,3)),C.setAttribute("uv",new Float32BufferAttribute(k,2));var $=[],ue=[];for(g=0,x=L.length;g<x;g++){var Y=(z=L[g]).name;if(z.vertices.length>0){te=[],I=0;for(var Z=E.length;I<Z;I++)te.push(H=z.vertices[Q=3*E[I]],X=z.vertices[Q+1],re=z.vertices[Q+2]);var se=new Float32BufferAttribute(te,3);se.name=Y,$.push(se)}if(z.normals.length>0){for(J=[],I=0,Z=E.length;I<Z;I++){var Q;J.push(z.normals[Q=3*E[I]],z.normals[Q+1],z.normals[Q+2])}var ve=new Float32BufferAttribute(J,3);ve.name=Y,ue.push(ve)}}return C.morphAttributes.position=$,C.morphAttributes.normal=ue,C.morphTargetsRelative=!1,C.animations=AnimationClip.CreateClipsFromMorphTargetSequences(L,10),C}console.error("Corrupted MD2 file")}else console.error("Not a valid MD2 file")}}()}),MeshToonMaterial.prototype=Object.create(Material.prototype),MeshToonMaterial.prototype.constructor=MeshToonMaterial,MeshToonMaterial.prototype.isMeshToonMaterial=!0,MeshToonMaterial.prototype.copy=function(s){return Material.prototype.copy.call(this,s),this.color.copy(s.color),this.specular.copy(s.specular),this.shininess=s.shininess,this.map=s.map,this.gradientMap=s.gradientMap,this.lightMap=s.lightMap,this.lightMapIntensity=s.lightMapIntensity,this.aoMap=s.aoMap,this.aoMapIntensity=s.aoMapIntensity,this.emissive.copy(s.emissive),this.emissiveMap=s.emissiveMap,this.emissiveIntensity=s.emissiveIntensity,this.bumpMap=s.bumpMap,this.bumpScale=s.bumpScale,this.normalMap=s.normalMap,this.normalMapType=s.normalMapType,this.normalScale.copy(s.normalScale),this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this.specularMap=s.specularMap,this.alphaMap=s.alphaMap,this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this.wireframeLinecap=s.wireframeLinecap,this.wireframeLinejoin=s.wireframeLinejoin,this.skinning=s.skinning,this.morphTargets=s.morphTargets,this.morphNormals=s.morphNormals,this};var MMDLoader=function(){function s(_){Loader.call(this,_),this.loader=new FileLoader(this.manager),this.parser=null,this.meshBuilder=new a(this.manager),this.animationBuilder=new C}s.prototype=Object.assign(Object.create(Loader.prototype),{constructor:s,setAnimationPath:function(x){return this.animationPath=x,this},load:function(x,b,A,E){var O,R=this.meshBuilder.setCrossOrigin(this.crossOrigin);O=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:LoaderUtils.extractUrlBase(x);var D=this._extractExtension(x).toLowerCase();"pmd"===D||"pmx"===D?this["pmd"===D?"loadPMD":"loadPMX"](x,function(F){b(R.build(F,O,A,E))},A,E):E&&E(new Error("MMDLoader: Unknown model file extension ."+D+"."))},loadAnimation:function(x,b,A,E,R){var O=this.animationBuilder;this.loadVMD(x,function(D){A(b.isCamera?O.buildCameraAnimation(D):O.build(D,b))},E,R)},loadWithAnimation:function(x,b,A,E,R){var O=this;this.load(x,function(D){O.loadAnimation(b,D,function(F){A({mesh:D,animation:F})},E,R)},E,R)},loadPMD:function(x,b,A,E){var R=this._getParser();this.loader.setMimeType(void 0).setPath(this.path).setResponseType("arraybuffer").load(x,function(O){b(R.parsePmd(O,!0))},A,E)},loadPMX:function(x,b,A,E){var R=this._getParser();this.loader.setMimeType(void 0).setPath(this.path).setResponseType("arraybuffer").load(x,function(O){b(R.parsePmx(O,!0))},A,E)},loadVMD:function(x,b,A,E){var R=Array.isArray(x)?x:[x],O=[],D=R.length,F=this._getParser();this.loader.setMimeType(void 0).setPath(this.animationPath).setResponseType("arraybuffer");for(var L=0,I=R.length;L<I;L++)this.loader.load(R[L],function(V){O.push(F.parseVmd(V,!0)),O.length===D&&b(F.mergeVmds(O))},A,E)},loadVPD:function(x,b,A,E,R){var O=this._getParser();this.loader.setMimeType(b?void 0:"text/plain; charset=shift_jis").setPath(this.animationPath).setResponseType("text").load(x,function(D){A(O.parseVpd(D,!0))},E,R)},_extractExtension:function(x){var b=x.lastIndexOf(".");return b<0?"":x.slice(b+1)},_getParser:function(){if(null===this.parser){if("undefined"==typeof MMDParser)throw new Error("MMDLoader: Import MMDParser https://github.com/takahirox/mmd-parser");this.parser=new MMDParser.Parser}return this.parser}});var e=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAN0lEQVRYR+3WQREAMBACsZ5/bWiiMvgEBTt5cW37hjsBBAgQIECAwFwgyfYPCCBAgAABAgTWAh8aBHZBl14e8wAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAOUlEQVRYR+3WMREAMAwDsYY/yoDI7MLwIiP40+RJklfcCCBAgAABAgTqArfb/QMCCBAgQIAAgbbAB3z/e0F3js2cAAAAAElFTkSuQmCC","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAN0lEQVRYR+3WQREAMBACsZ5/B5ilMvgEBTt5cW37hjsBBAgQIECAwFwgyfYPCCBAgAABAgTWAh81dWyx0gFwKAAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAOklEQVRYR+3WoREAMAwDsWb/UQtCy9wxTOQJ/oQ8SXKKGwEECBAgQIBAXeDt7f4BAQQIECBAgEBb4AOz8Hzx7WLY4wAAAABJRU5ErkJggg==","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABPUlEQVRYR+1XwW7CMAy1+f9fZOMysSEOEweEOPRNdm3HbdOyIhAcklPrOs/PLy9RygBALxzcCDQFmgJNgaZAU6Ap0BR4PwX8gsRMVLssMRH5HcpzJEaWL7EVg9F1IHRlyqQohgVr4FGUlUcMJSjcUlDw0zvjeun70cLWmneoyf7NgBTQSniBTQQSuJAZsOnnaczjIMb5hCiuHKxokCrJfVnrctyZL0PkJAJe1HMil4nxeyi3Ypfn1kX51jpPvo/JeCNC4PhVdHdJw2XjBR8brF8PEIhNVn12AgP7uHsTBguBn53MUZCqv7Lp07Pn5k1Ro+uWmUNn7D+M57rtk7aG0Vo73xyF/fbFf0bPJjDXngnGocDTdFhygZjwUQrMNrDcmZlQT50VJ/g/UwNyHpu778+yW+/ksOz/BFo54P4AsUXMfRq7XWsAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAACMElEQVRYR+2Xv4pTQRTGf2dubhLdICiii2KnYKHVolhauKWPoGAnNr6BD6CvIVaihYuI2i1ia0BY0MZGRHQXjZj/mSPnnskfNWiWZUlzJ5k7M2cm833nO5Mziej2DWWJRUoCpQKlAntSQCqgw39/iUWAGmh37jrRnVsKlgpiqmkoGVABA7E57fvY+pJDdgKqF6HzFCSADkDq+F6AHABtQ+UMVE5D7zXod7fFNhTEckTbj5XQgHzNN+5tQvc5NG7C6BNkp6D3EmpXHDR+dQAjFLchW3VS9rlw3JBh+B7ys5Cf9z0GW1C/7P32AyBAOAz1q4jGliIH3YPuBnSfQX4OGreTIgEYQb/pBDtPnEQ4CivXYPAWBk13oHrB54yA9QuSn2H4AcKRpEILDt0BUzj+RLR1V5EqjD66NPRBVpLcQwjHoHYJOhsQv6U4mnzmrIXJCFr4LDwm/xBUoboG9XX4cc9VKdYoSA2yk5NQLJaKDUjTBoveG3Z2TElTxwjNK4M3LEZgUdDdruvcXzKBpStgp2NPiWi3ks9ZXxIoFVi+AvHLdc9TqtjL3/aYjpPlrzOcEnK62Szhimdd7xX232zFDTgtxezOu3WNMRLjiKgjtOhHVMd1loynVHvOgjuIIJMaELEqhJAV/RCSLbWTcfPFakFgFlALTRRvx+ok6Hlp/Q+v3fmx90bMyUzaEAhmM3KvHlXTL5DxnbGf/1M8RNNACLL5MNtPxP/mypJAqcDSFfgFhpYqWUzhTEAAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAL0lEQVRYR+3QQREAAAzCsOFfNJPBJ1XQS9r2hsUAAQIECBAgQIAAAQIECBAgsBZ4MUx/ofm2I/kAAAAASUVORK5CYII="];function a(_){this.geometryBuilder=new v,this.materialBuilder=new g(_)}function v(){}function g(_){this.manager=_,this.textureLoader=new TextureLoader(this.manager),this.tgaLoader=null}function C(){}function w(_,x,b,A,E){Interpolant.call(this,_,x,b,A),this.interpolationParams=E}return a.prototype={constructor:a,crossOrigin:"anonymous",setCrossOrigin:function(x){return this.crossOrigin=x,this},build:function(x,b,A,E){var R=this.geometryBuilder.build(x),D=new SkinnedMesh(R,this.materialBuilder.setCrossOrigin(this.crossOrigin).setResourcePath(b).build(x,R,A,E)),F=new Skeleton(function(_){var A,E,R,O,x=_.geometry,b=[];if(x&&void 0!==x.bones){for(R=0,O=x.bones.length;R<O;R++)E=x.bones[R],A=new Bone,b.push(A),A.name=E.name,A.position.fromArray(E.pos),A.quaternion.fromArray(E.rotq),void 0!==E.scl&&A.scale.fromArray(E.scl);for(R=0,O=x.bones.length;R<O;R++)-1!==(E=x.bones[R]).parent&&null!==E.parent&&void 0!==b[E.parent]?b[E.parent].add(b[R]):_.add(b[R])}return _.updateMatrixWorld(!0),b}(D));return D.bind(F),D}},v.prototype={constructor:v,build:function(x){for(var b=[],A=[],E=[],R=[],O=[],D=[],F=[],L=[],I=[],V=[],z=[],H=[],X=[],re=[],j=0,te={},J=0;J<x.metadata.vertexCount;J++){for(var k=x.vertices[J],U=0,K=k.position.length;U<K;U++)b.push(k.position[U]);for(U=0,K=k.normal.length;U<K;U++)E.push(k.normal[U]);for(U=0,K=k.uv.length;U<K;U++)A.push(k.uv[U]);for(U=0;U<4;U++)F.push(k.skinIndices.length-1>=U?k.skinIndices[U]:0);for(U=0;U<4;U++)L.push(k.skinWeights.length-1>=U?k.skinWeights[U]:0)}for(J=0;J<x.metadata.faceCount;J++){var ee=x.faces[J];for(U=0,K=ee.indices.length;U<K;U++)R.push(ee.indices[U])}for(J=0;J<x.metadata.materialCount;J++){var Q=x.materials[J];O.push({offset:3*j,count:3*Q.faceCount}),j+=Q.faceCount}for(J=0;J<x.metadata.rigidBodyCount;J++){var oe=x.rigidBodies[J],me=te[oe.boneIndex];me=void 0===me?oe.type:Math.max(oe.type,me),te[oe.boneIndex]=me}for(J=0;J<x.metadata.boneCount;J++)-1!==(ge={parent:(fe=x.bones[J]).parentIndex,name:fe.name,pos:fe.position.slice(0,3),rotq:[0,0,0,1],scl:[1,1,1],rigidBodyType:void 0!==te[J]?te[J]:-1}).parent&&(ge.pos[0]-=x.bones[ge.parent].position[0],ge.pos[1]-=x.bones[ge.parent].position[1],ge.pos[2]-=x.bones[ge.parent].position[2]),D.push(ge);if("pmd"===x.metadata.format)for(J=0;J<x.metadata.ikCount;J++){var ue={target:($=x.iks[J]).target,effector:$.effector,iteration:$.iteration,maxAngle:4*$.maxAngle,links:[]};for(U=0,K=$.links.length;U<K;U++)(Y={}).index=$.links[U].index,Y.enabled=!0,x.bones[Y.index].name.indexOf("\u3072\u3056")>=0&&(Y.limitation=new Vector3(1,0,0)),ue.links.push(Y);z.push(ue)}else for(J=0;J<x.metadata.boneCount;J++){var $;if(void 0!==($=x.bones[J].ik)){for(ue={target:J,effector:$.effector,iteration:$.iteration,maxAngle:$.maxAngle,links:[]},U=0,K=$.links.length;U<K;U++){var Y;if((Y={}).index=$.links[U].index,Y.enabled=!0,1===$.links[U].angleLimitation){var Z=$.links[U].lowerLimitationAngle,se=$.links[U].upperLimitationAngle,ve=-se[0],le=-se[1];se[0]=-Z[0],se[1]=-Z[1],Z[0]=ve,Z[1]=le,Y.rotationMin=(new Vector3).fromArray(Z),Y.rotationMax=(new Vector3).fromArray(se)}ue.links.push(Y)}z.push(ue)}}if("pmx"===x.metadata.format){for(J=0;J<x.metadata.boneCount;J++){var fe,_e=(fe=x.bones[J]).grant;void 0!==_e&&H.push(ue={index:J,parentIndex:_e.parentIndex,ratio:_e.ratio,isLocal:_e.isLocal,affectRotation:_e.affectRotation,affectPosition:_e.affectPosition,transformationClass:fe.transformationClass})}H.sort(function(pt,ut){return pt.transformationClass-ut.transformationClass})}function ae(pt,ut,at){for(var Xe=0;Xe<ut.elementCount;Xe++){var lt,Ke=ut.elements[Xe];pt.array[3*(lt="pmd"===x.metadata.format?x.morphs[0].elements[Ke.index].index:Ke.index)+0]+=Ke.position[0]*at,pt.array[3*lt+1]+=Ke.position[1]*at,pt.array[3*lt+2]+=Ke.position[2]*at}}for(J=0;J<x.metadata.morphCount;J++){var pe=x.morphs[J],he={name:pe.name},ce=new Float32BufferAttribute(3*x.metadata.vertexCount,3);for(ce.name=pe.name,U=0;U<3*x.metadata.vertexCount;U++)ce.array[U]=b[U];if("pmd"===x.metadata.format)0!==J&&ae(ce,pe,1);else if(0===pe.type)for(U=0;U<pe.elementCount;U++){var Te=x.morphs[pe.elements[U].index];1===Te.type&&ae(ce,Te,pe.elements[U].ratio)}else 1===pe.type&&ae(ce,pe,1);I.push(he),V.push(ce)}for(J=0;J<x.metadata.rigidBodyCount;J++){var ge,xe=x.rigidBodies[J];for(var we in he={},xe)he[we]=xe[we];"pmx"===x.metadata.format&&-1!==he.boneIndex&&(he.position[0]-=(ge=x.bones[he.boneIndex]).position[0],he.position[1]-=ge.position[1],he.position[2]-=ge.position[2]),X.push(he)}for(J=0;J<x.metadata.constraintCount;J++){var Ne=x.constraints[J];for(var we in he={},Ne)he[we]=Ne[we];var Re=X[he.rigidBodyIndex1],De=X[he.rigidBodyIndex2];0!==Re.type&&2===De.type&&-1!==Re.boneIndex&&-1!==De.boneIndex&&x.bones[De.boneIndex].parentIndex===Re.boneIndex&&(De.type=1),re.push(he)}var Je=new BufferGeometry;Je.setAttribute("position",new Float32BufferAttribute(b,3)),Je.setAttribute("normal",new Float32BufferAttribute(E,3)),Je.setAttribute("uv",new Float32BufferAttribute(A,2)),Je.setAttribute("skinIndex",new Uint16BufferAttribute(F,4)),Je.setAttribute("skinWeight",new Float32BufferAttribute(L,4)),Je.setIndex(R),J=0;for(var $e=O.length;J<$e;J++)Je.addGroup(O[J].offset,O[J].count,J);return Je.bones=D,Je.morphTargets=I,Je.morphAttributes.position=V,Je.morphTargetsRelative=!1,Je.userData.MMD={bones:D,iks:z,grants:H,rigidBodies:X,constraints:re,format:x.metadata.format},Je.computeBoundingSphere(),Je}},g.prototype={constructor:g,crossOrigin:"anonymous",resourcePath:void 0,setCrossOrigin:function(x){return this.crossOrigin=x,this},setResourcePath:function(x){return this.resourcePath=x,this},build:function(x,b){var A=[],E={};this.textureLoader.setCrossOrigin(this.crossOrigin);for(var R=0;R<x.metadata.materialCount;R++){var O=x.materials[R],D={userData:{}};if(void 0!==O.name&&(D.name=O.name),D.color=(new Color).fromArray(O.diffuse),D.opacity=O.diffuse[3],D.specular=(new Color).fromArray(O.specular),D.emissive=(new Color).fromArray(O.ambient),D.shininess=Math.max(O.shininess,1e-4),D.transparent=1!==D.opacity,D.skinning=b.bones.length>0,D.morphTargets=b.morphTargets.length>0,D.fog=!0,D.blending=CustomBlending,D.blendSrc=SrcAlphaFactor,D.blendDst=OneMinusSrcAlphaFactor,D.blendSrcAlpha=SrcAlphaFactor,D.blendDstAlpha=DstAlphaFactor,D.side="pmx"===x.metadata.format&&1==(1&O.flag)?DoubleSide:1===D.opacity?FrontSide:DoubleSide,"pmd"===x.metadata.format){if(O.fileName){var L=O.fileName.split("*");if(D.map=this._loadTexture(L[0],E),L.length>1){var I=L[1].slice(-4).toLowerCase();D.envMap=this._loadTexture(L[1],E,{sphericalReflectionMapping:!0}),D.combine=".sph"===I?MultiplyOperation:AddOperation}}D.gradientMap=this._loadTexture(V=-1===O.toonIndex?"toon00.bmp":x.toonTextures[O.toonIndex].fileName,E,{isToonTexture:!0,isDefaultToonTexture:this._isDefaultToonTexture(V)}),D.userData.outlineParameters={thickness:1===O.edgeFlag?.003:0,color:[0,0,0],alpha:1,visible:1===O.edgeFlag}}else{var V,z;-1!==O.textureIndex&&(D.map=this._loadTexture(x.textures[O.textureIndex],E)),-1!==O.envTextureIndex&&(1===O.envFlag||2==O.envFlag)&&(D.envMap=this._loadTexture(x.textures[O.envTextureIndex],E,{sphericalReflectionMapping:!0}),D.combine=1===O.envFlag?MultiplyOperation:AddOperation),-1===O.toonIndex||0!==O.toonFlag?(V="toon"+("0"+(O.toonIndex+1)).slice(-2)+".bmp",z=!0):(V=x.textures[O.toonIndex],z=!1),D.gradientMap=this._loadTexture(V,E,{isToonTexture:!0,isDefaultToonTexture:z}),D.userData.outlineParameters={thickness:O.edgeSize/300,color:O.edgeColor.slice(0,3),alpha:O.edgeColor[3],visible:0!=(16&O.flag)&&O.edgeSize>0}}void 0!==D.map&&(D.transparent||this._checkImageTransparency(D.map,b,R),D.emissive.multiplyScalar(.2)),A.push(new MeshToonMaterial(D))}if("pmx"===x.metadata.format)for(var H=function(K,ee){for(var Q=0,oe=K.length;Q<oe;Q++){var me=K[Q];if(-1!==me.index){var fe=ee[me.index];fe.opacity!==me.diffuse[3]&&(fe.transparent=!0)}}},X=(R=0,x.morphs.length);R<X;R++){var re=x.morphs[R],j=re.elements;if(0===re.type)for(var te=0,J=j.length;te<J;te++){var k=x.morphs[j[te].index];8===k.type&&H(k.elements,A)}else 8===re.type&&H(j,A)}return A},_getTGALoader:function(){if(null===this.tgaLoader){if(void 0===TGALoader)throw new Error("MMDLoader: Import TGALoader");this.tgaLoader=new TGALoader(this.manager)}return this.tgaLoader},_isDefaultToonTexture:function(x){return 10===x.length&&/toon(10|0[0-9])\.bmp/.test(x)},_loadTexture:function(x,b,A,E,R){var D,O=this;if(!0===(A=A||{}).isDefaultToonTexture){var F;try{F=parseInt(x.match("toon([0-9]{2}).bmp$")[1])}catch(V){console.warn("MMDLoader: "+x+" seems like a not right default texture path. Using toon00.bmp instead."),F=0}D=e[F]}else D=this.resourcePath+x;if(void 0!==b[D])return b[D];var L=this.manager.getHandler(D);null===L&&(L=".tga"===x.slice(-4).toLowerCase()?this._getTGALoader():this.textureLoader);var I=L.load(D,function(V){!0===A.isToonTexture&&(V.image=O._getRotatedImage(V.image),V.magFilter=NearestFilter,V.minFilter=NearestFilter),V.flipY=!1,V.wrapS=RepeatWrapping,V.wrapT=RepeatWrapping;for(var z=0;z<I.readyCallbacks.length;z++)I.readyCallbacks[z](I);delete I.readyCallbacks},E,R);return!0===A.sphericalReflectionMapping&&(I.mapping=SphericalReflectionMapping),I.readyCallbacks=[],b[D]=I,I},_getRotatedImage:function(x){var b=document.createElement("canvas"),A=b.getContext("2d"),E=x.width,R=x.height;return b.width=E,b.height=R,A.clearRect(0,0,E,R),A.translate(E/2,R/2),A.rotate(.5*Math.PI),A.translate(-E/2,-R/2),A.drawImage(x,0,0),A.getImageData(0,0,E,R)},_checkImageTransparency:function(x,b,A){x.readyCallbacks.push(function(E){function D(I,V){var z=I.width,H=I.height,X=Math.round(V.x*z)%z,re=Math.round(V.y*H)%H;return X<0&&(X+=z),re<0&&(re+=H),I.data[4*(re*z+X)+3]}var F=void 0!==E.image.data?E.image:function(I){var V=document.createElement("canvas");V.width=I.width,V.height=I.height;var z=V.getContext("2d");return z.drawImage(I,0,0),z.getImageData(0,0,V.width,V.height)}(E.image),L=b.groups[A];(function(I,V,z){if(I.data.length/(I.width*I.height)!=4)return!1;for(var te=0;te<z.length;te+=3){for(var J={x:0,y:0},k=0;k<3;k++){var U=z[3*te+k],K={x:V[2*U+0],y:V[2*U+1]};if(D(I,K)<253)return!0;J.x+=K.x,J.y+=K.y}if(J.x/=3,J.y/=3,D(I,J)<253)return!0}return!1})(F,b.attributes.uv.array,b.index.array.slice(L.start,L.start+L.count))&&(x.transparent=!0)})}},C.prototype={constructor:C,build:function(x,b){for(var A=this.buildSkeletalAnimation(x,b).tracks,E=this.buildMorphAnimation(x,b).tracks,R=0,O=E.length;R<O;R++)A.push(E[R]);return new AnimationClip("",-1,A)},buildSkeletalAnimation:function(x,b){function A(fe,ge,$){fe.push(ge[$+0]/127),fe.push(ge[$+8]/127),fe.push(ge[$+4]/127),fe.push(ge[$+12]/127)}for(var E=[],R={},O=b.skeleton.bones,D={},F=0,L=O.length;F<L;F++)D[O[F].name]=!0;for(F=0;F<x.metadata.motionCount;F++){var I=x.motions[F],V=I.boneName;void 0!==D[V]&&(R[V]=R[V]||[],R[V].push(I))}for(var z in R){var H=R[z];H.sort(function(fe,ge){return fe.frameNum-ge.frameNum});var X=[],re=[],j=[],te=[],J=[],k=b.skeleton.getBoneByName(z).position.toArray();for(F=0,L=H.length;F<L;F++){var K=H[F].position,ee=H[F].rotation,Q=H[F].interpolation;X.push(H[F].frameNum/30);for(var oe=0;oe<3;oe++)re.push(k[oe]+K[oe]);for(oe=0;oe<4;oe++)j.push(ee[oe]);for(oe=0;oe<3;oe++)A(te,Q,oe);A(J,Q,3)}var me=".bones["+z+"]";E.push(this._createTrack(me+".position",VectorKeyframeTrack,X,re,te)),E.push(this._createTrack(me+".quaternion",QuaternionKeyframeTrack,X,j,J))}return new AnimationClip("",-1,E)},buildMorphAnimation:function(x,b){for(var A=[],E={},R=b.morphTargetDictionary,O=0;O<x.metadata.morphCount;O++){var D=x.morphs[O],F=D.morphName;void 0!==R[F]&&(E[F]=E[F]||[],E[F].push(D))}for(var L in E){var I=E[L];I.sort(function(X,re){return X.frameNum-re.frameNum});for(var V=[],z=[],H=(O=0,I.length);O<H;O++)V.push(I[O].frameNum/30),z.push(I[O].weight);A.push(new NumberKeyframeTrack(".morphTargetInfluences["+R[L]+"]",V,z))}return new AnimationClip("",-1,A)},buildCameraAnimation:function(x){function b(Y,Z){Y.push(Z.x),Y.push(Z.y),Y.push(Z.z)}function E(Y,Z,se){Y.push(Z[4*se+0]/127),Y.push(Z[4*se+1]/127),Y.push(Z[4*se+2]/127),Y.push(Z[4*se+3]/127)}var Y,Z,R=[],O=void 0===x.cameras?[]:x.cameras.slice();O.sort(function(Y,Z){return Y.frameNum-Z.frameNum});for(var D=[],F=[],L=[],I=[],V=[],z=[],H=[],X=[],re=[],j=new Quaternion,te=new Euler,J=new Vector3,k=new Vector3,U=0,K=O.length;U<K;U++){var ee=O[U],oe=ee.position,me=ee.rotation,fe=ee.distance,ge=ee.fov,$=ee.interpolation;D.push(ee.frameNum/30),J.set(0,0,-fe),k.set(oe[0],oe[1],oe[2]),te.set(-me[0],-me[1],-me[2]),j.setFromEuler(te),J.add(k),J.applyQuaternion(j),b(F,k),(Y=L).push((Z=j).x),Y.push(Z.y),Y.push(Z.z),Y.push(Z.w),b(I,J),V.push(ge);for(var ue=0;ue<3;ue++)E(z,$,ue);for(E(H,$,3),ue=0;ue<3;ue++)E(X,$,4);E(re,$,5)}return(R=[]).push(this._createTrack("target.position",VectorKeyframeTrack,D,F,z)),R.push(this._createTrack(".quaternion",QuaternionKeyframeTrack,D,L,H)),R.push(this._createTrack(".position",VectorKeyframeTrack,D,I,X)),R.push(this._createTrack(".fov",NumberKeyframeTrack,D,V,re)),new AnimationClip("",-1,R)},_createTrack:function(x,b,A,E,R){if(A.length>2){A=A.slice(),E=E.slice(),R=R.slice();for(var O=E.length/A.length,D=R.length/A.length,F=1,L=2,I=A.length;L<I;L++){for(var V=0;V<O;V++)if(E[F*O+V]!==E[(F-1)*O+V]||E[F*O+V]!==E[L*O+V]){F++;break}if(L>F){for(A[F]=A[L],V=0;V<O;V++)E[F*O+V]=E[L*O+V];for(V=0;V<D;V++)R[F*D+V]=R[L*D+V]}}A.length=F+1,E.length=(F+1)*O,R.length=(F+1)*D}var z=new b(x,A,E);return z.createInterpolant=function(X){return new w(this.times,this.values,this.getValueSize(),X,new Float32Array(R))},z}},w.prototype=Object.assign(Object.create(Interpolant.prototype),{constructor:w,interpolate_:function(x,b,A,E){var R=this.resultBuffer,O=this.sampleValues,D=this.valueSize,F=this.interpolationParams,L=x*D,I=L-D,V=E-b<.05?0:(A-b)/(E-b);if(4===D){var j=this._calculate(F[4*x+0],F[4*x+1],F[4*x+2],F[4*x+3],V);Quaternion.slerpFlat(R,0,O,I,O,L,j)}else if(3===D)for(var te=0;te!==D;++te)j=this._calculate(F[12*x+4*te+0],F[12*x+4*te+1],F[12*x+4*te+2],F[12*x+4*te+3],V),R[te]=O[I+te]*(1-j)+O[L+te]*j;else j=this._calculate(F[4*x+0],F[4*x+1],F[4*x+2],F[4*x+3],V),R[0]=O[I]*(1-j)+O[L]*j;return R},_calculate:function(x,b,A,E,R){for(var z,H,X,O=.5,D=O,F=1-D,V=Math,re=0;re<15;re++){var j=(z=3*F*F*D)*x+(H=3*F*D*D)*b+(X=D*D*D)-R;if(V.abs(j)<1e-5)break;O/=2,F=1-(D+=j<0?O:-O)}return z*A+H*E+X}}),s}(),MTLLoader=function(e){Loader.call(this,e)};function TempNode(s,e){Node.call(this,s),this.shared=void 0===(e=e||{}).shared||e.shared,this.unique=void 0!==e.unique&&e.unique}function InputNode(s,e){(e=e||{}).shared=void 0!==e.shared&&e.shared,TempNode.call(this,s,e),this.readonly=!1}MTLLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:MTLLoader,load:function(e,a,d,v){var g=this,C=""===this.path?LoaderUtils.extractUrlBase(e):this.path,w=new FileLoader(this.manager);w.setPath(this.path),w.load(e,function(_){a(g.parse(_,C))},d,v)},setMaterialOptions:function(e){return this.materialOptions=e,this},parse:function(e,a){for(var d=e.split("\n"),v={},g=/\s+/,C={},w=0;w<d.length;w++){var _=d[w];if(0!==(_=_.trim()).length&&"#"!==_.charAt(0)){var x=_.indexOf(" "),b=x>=0?_.substring(0,x):_;b=b.toLowerCase();var A=x>=0?_.substring(x+1):"";if(A=A.trim(),"newmtl"===b)C[A]=v={name:A};else if("ka"===b||"kd"===b||"ks"===b||"ke"===b){var E=A.split(g,3);v[b]=[parseFloat(E[0]),parseFloat(E[1]),parseFloat(E[2])]}else v[b]=A}}var R=new MTLLoader.MaterialCreator(this.resourcePath||a,this.materialOptions);return R.setCrossOrigin(this.crossOrigin),R.setManager(this.manager),R.setMaterials(C),R}}),MTLLoader.MaterialCreator=function(s,e){this.baseUrl=s||"",this.options=e,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:RepeatWrapping},MTLLoader.MaterialCreator.prototype={constructor:MTLLoader.MaterialCreator,crossOrigin:"anonymous",setCrossOrigin:function(e){return this.crossOrigin=e,this},setManager:function(e){this.manager=e},setMaterials:function(e){this.materialsInfo=this.convert(e),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(e){if(!this.options)return e;var a={};for(var d in e){var v=e[d],g={};for(var C in a[d]=g,v){var w=!0,_=v[C],x=C.toLowerCase();switch(x){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(_=[_[0]/255,_[1]/255,_[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===_[0]&&0===_[1]&&0===_[2]&&(w=!1)}w&&(g[x]=_)}}return a},preload:function(){for(var e in this.materialsInfo)this.create(e)},getIndex:function(e){return this.nameLookup[e]},getAsArray:function(){var e=0;for(var a in this.materialsInfo)this.materialsArray[e]=this.create(a),this.nameLookup[a]=e,e++;return this.materialsArray},create:function(e){return void 0===this.materials[e]&&this.createMaterial_(e),this.materials[e]},createMaterial_:function(e){var a=this,d=this.materialsInfo[e],v={name:e,side:this.side};function C(b,A){if(!v[b]){var E=a.getTextureParams(A,v),R=a.loadTexture(function(b,A){return"string"!=typeof A||""===A?"":/^https?:\/\//i.test(A)?A:b+A}(a.baseUrl,E.url));R.repeat.copy(E.scale),R.offset.copy(E.offset),R.wrapS=a.wrap,R.wrapT=a.wrap,v[b]=R}}for(var w in d){var x,_=d[w];if(""!==_)switch(w.toLowerCase()){case"kd":v.color=(new Color).fromArray(_);break;case"ks":v.specular=(new Color).fromArray(_);break;case"ke":v.emissive=(new Color).fromArray(_);break;case"map_kd":C("map",_);break;case"map_ks":C("specularMap",_);break;case"map_ke":C("emissiveMap",_);break;case"norm":C("normalMap",_);break;case"map_bump":case"bump":C("bumpMap",_);break;case"map_d":C("alphaMap",_),v.transparent=!0;break;case"ns":v.shininess=parseFloat(_);break;case"d":(x=parseFloat(_))<1&&(v.opacity=x,v.transparent=!0);break;case"tr":x=parseFloat(_),this.options&&this.options.invertTrProperty&&(x=1-x),x>0&&(v.opacity=1-x,v.transparent=!0)}}return this.materials[e]=new MeshPhongMaterial(v),this.materials[e]},getTextureParams:function(e,a){var g,d={scale:new Vector2(1,1),offset:new Vector2(0,0)},v=e.split(/\s+/);return(g=v.indexOf("-bm"))>=0&&(a.bumpScale=parseFloat(v[g+1]),v.splice(g,2)),(g=v.indexOf("-s"))>=0&&(d.scale.set(parseFloat(v[g+1]),parseFloat(v[g+2])),v.splice(g,4)),(g=v.indexOf("-o"))>=0&&(d.offset.set(parseFloat(v[g+1]),parseFloat(v[g+2])),v.splice(g,4)),d.url=v.join(" ").trim(),d},loadTexture:function(e,a,d,v,g){var C,w=void 0!==this.manager?this.manager:DefaultLoadingManager,_=w.getHandler(e);return null===_&&(_=new TextureLoader(w)),_.setCrossOrigin&&_.setCrossOrigin(this.crossOrigin),C=_.load(e,d,v,g),void 0!==a&&(C.mapping=a),C}},TempNode.prototype=Object.create(Node.prototype),TempNode.prototype.constructor=TempNode,TempNode.prototype.build=function(s,e,a,d){if(e=e||this.getType(s),this.getShared(s,e)){var v=this.getUnique(s,e);v&&void 0===this.constructor.uuid&&(this.constructor.uuid=MathUtils.generateUUID()),a=s.getUuid(a||this.getUuid(),!v);var g=s.getNodeData(a),C=g.output||this.getType(s);if(s.analyzing)return(g.deps||0)>0||this.getLabel()?(this.appendDepsNode(s,g,e),this.generate(s,e,a)):Node.prototype.build.call(this,s,e,a);if(v)return g.name=g.name||Node.prototype.build.call(this,s,e,a),g.name;if(!this.getLabel()&&(!this.getShared(s,C)||s.context.ignoreCache||1===g.deps))return Node.prototype.build.call(this,s,e,a);a=this.getUuid(!1);var w=this.getTemp(s,a);if(w)return s.format(w,C,e);w=TempNode.prototype.generate.call(this,s,e,a,g.output,d);var _=this.generate(s,C,a);return s.addNodeCode(w+" = "+_+";"),s.format(w,C,e)}return Node.prototype.build.call(this,s,e,a)},TempNode.prototype.getShared=function(s,e){return"sampler2D"!==e&&"samplerCube"!==e&&this.shared},TempNode.prototype.getUnique=function(){return this.unique},TempNode.prototype.setLabel=function(s){return this.label=s,this},TempNode.prototype.getLabel=function(){return this.label},TempNode.prototype.getUuid=function(s){var e=(s||null==s)&&this.constructor.uuid||this.uuid;return"string"==typeof this.scope&&(e=this.scope+"-"+e),e},TempNode.prototype.getTemp=function(s,e){e=e||this.uuid;var a=s.getVars()[e];return a?a.name:void 0},TempNode.prototype.generate=function(s,e,a,d,v){return this.getShared(s,e)||console.error("TempNode is not shared!"),s.getTempVar(a=a||this.uuid,d||this.getType(s),v,this.getLabel()).name},InputNode.prototype=Object.create(TempNode.prototype),InputNode.prototype.constructor=InputNode,InputNode.prototype.setReadonly=function(s){return this.readonly=s,this},InputNode.prototype.getReadonly=function(){return this.readonly},InputNode.prototype.copy=function(s){return TempNode.prototype.copy.call(this,s),void 0!==s.readonly&&(this.readonly=s.readonly),this},InputNode.prototype.createJSONNode=function(s){var e=TempNode.prototype.createJSONNode.call(this,s);return!0===this.readonly&&(e.readonly=this.readonly),e},InputNode.prototype.generate=function(s,e,a,d,v,g){a=s.getUuid(a||this.getUuid()),d=d||this.getType(s);var C=s.getNodeData(a);return this.getReadonly(s)&&void 0!==this.generateReadonly?this.generateReadonly(s,e,a,d,v,g):s.isShader("vertex")?(C.vertex||(C.vertex=s.createVertexUniform(d,this,v,g,this.getLabel())),s.format(C.vertex.name,d,e)):(C.fragment||(C.fragment=s.createFragmentUniform(d,this,v,g,this.getLabel())),s.format(C.fragment.name,d,e))};var declarationRegexp=/^([a-z_0-9]+)\s([a-z_0-9]+)\s?\=?\s?(.*?)(\;|$)/i;function ConstNode(s,e){TempNode.call(this),this.parse(s||ConstNode.PI,e)}function VarNode(s,e){Node.call(this,s),this.value=e}ConstNode.PI="PI",ConstNode.PI2="PI2",ConstNode.RECIPROCAL_PI="RECIPROCAL_PI",ConstNode.RECIPROCAL_PI2="RECIPROCAL_PI2",ConstNode.LOG2="LOG2",ConstNode.EPSILON="EPSILON",ConstNode.prototype=Object.create(TempNode.prototype),ConstNode.prototype.constructor=ConstNode,ConstNode.prototype.nodeType="Const",ConstNode.prototype.getType=function(s){return s.getTypeByFormat(this.type)},ConstNode.prototype.parse=function(s,e){this.src=s||"";var a,d,v="",g=this.src.match(declarationRegexp);this.useDefine=e||"#"===this.src.charAt(0),g&&g.length>1?(d=g[1],a=g[2],v=g[3]):(a=this.src,d="f"),this.name=a,this.type=d,this.value=v},ConstNode.prototype.build=function(s,e){return"source"!==e?(s.include(this),s.format(this.name,this.getType(s),e)):this.value?this.useDefine?"#define "+this.name+" "+this.value:"const "+this.type+" "+this.name+" = "+this.value+";":this.useDefine?this.src:void 0},ConstNode.prototype.generate=function(s,e){return s.format(this.name,this.getType(s),e)},ConstNode.prototype.copy=function(s){return TempNode.prototype.copy.call(this,s),this.parse(s.src,s.useDefine),this},ConstNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).src=this.src,!0===e.useDefine&&(e.useDefine=!0)),e},VarNode.prototype=Object.create(Node.prototype),VarNode.prototype.constructor=VarNode,VarNode.prototype.nodeType="Var",VarNode.prototype.getType=function(s){return s.getTypeByFormat(this.type)},VarNode.prototype.generate=function(s,e){var a=s.getVar(this.uuid,this.type);return this.value&&s.isShader("vertex")&&s.addNodeCode(a.name+" = "+this.value.build(s,this.getType(s))+";"),s.format(a.name,this.getType(s),e)},VarNode.prototype.copy=function(s){return Node.prototype.copy.call(this,s),this.type=s.type,this.value=s.value,this},VarNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).type=this.type,this.value&&(e.value=this.value.toJSON(s).uuid)),e};var declarationRegexp$1=/^struct\s*([a-z_0-9]+)\s*{\s*((.|\n)*?)}/gim,propertiesRegexp=/\s*(\w*?)\s*(\w*?)(\=|\;)/gim;function StructNode(s){TempNode.call(this),this.parse(s)}function AttributeNode(s,e){Node.call(this,e),this.name=s}StructNode.prototype=Object.create(TempNode.prototype),StructNode.prototype.constructor=StructNode,StructNode.prototype.nodeType="Struct",StructNode.prototype.getType=function(s){return s.getTypeByFormat(this.name)},StructNode.prototype.getInputByName=function(s){for(var e=this.inputs.length;e--;)if(this.inputs[e].name===s)return this.inputs[e]},StructNode.prototype.generate=function(s,e){return"source"===e?this.src+";":s.format("( "+this.src+" )",this.getType(s),e)},StructNode.prototype.parse=function(s){this.src=s||"",this.inputs=[];var e=declarationRegexp$1.exec(this.src);if(e){for(var d,a=e[2];d=propertiesRegexp.exec(a);)this.inputs.push({type:d[1],name:d[2]});this.name=e[1]}else this.name="";this.type=this.name},StructNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).src=this.src),e},AttributeNode.prototype=Object.create(Node.prototype),AttributeNode.prototype.constructor=AttributeNode,AttributeNode.prototype.nodeType="Attribute",AttributeNode.prototype.getAttributeType=function(s){return"number"==typeof this.type?s.getConstructorFromLength(this.type):this.type},AttributeNode.prototype.getType=function(s){var e=this.getAttributeType(s);return s.getTypeByFormat(e)},AttributeNode.prototype.generate=function(s,e){var a=this.getAttributeType(s),d=s.getAttribute(this.name,a),v=s.isShader("vertex")?this.name:d.varying.name;return s.format(v,this.getType(s),e)},AttributeNode.prototype.copy=function(s){return Node.prototype.copy.call(this,s),this.type=s.type,this},AttributeNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).type=this.type),e};var NodeLib={nodes:{},keywords:{},add:function(e){this.nodes[e.name]=e},addKeyword:function(e,a,d){this.keywords[e]={callback:a,cache:d=void 0===d||d}},remove:function(e){delete this.nodes[e.name]},removeKeyword:function(e){delete this.keywords[e]},get:function(e){return this.nodes[e]},getKeyword:function(e,a){return this.keywords[e].callback.call(this,a)},getKeywordData:function(e){return this.keywords[e]},contains:function(e){return void 0!==this.nodes[e]},containsKeyword:function(e){return void 0!==this.keywords[e]}},declarationRegexp$2=/^([a-z_0-9]+)\s([a-z_0-9]+)\s*\((.*?)\)/i,propertiesRegexp$1=/[a-z_0-9]+/gi;function FunctionNode(s,e,a,d,v){this.isMethod=void 0===v,this.isInterface=!1,TempNode.call(this,v),this.parse(s,e,a,d)}function ExpressionNode(s,e,a,d,v){FunctionNode.call(this,s,v,d,a,e)}function FunctionCallNode(s,e){TempNode.call(this),this.setFunction(s,e)}FunctionNode.prototype=Object.create(TempNode.prototype),FunctionNode.prototype.constructor=FunctionNode,FunctionNode.prototype.nodeType="Function",FunctionNode.prototype.useKeywords=!0,FunctionNode.prototype.getShared=function(){return!this.isMethod},FunctionNode.prototype.getType=function(s){return s.getTypeByFormat(this.type)},FunctionNode.prototype.getInputByName=function(s){for(var e=this.inputs.length;e--;)if(this.inputs[e].name===s)return this.inputs[e]},FunctionNode.prototype.getIncludeByName=function(s){for(var e=this.includes.length;e--;)if(this.includes[e].name===s)return this.includes[e]},FunctionNode.prototype.generate=function(s,e){for(var d=0,v=this.src,g=0;g<this.includes.length;g++)s.include(this.includes[g],this);for(var C in this.extensions)s.extensions[C]=!0;for(var w=[];a=propertiesRegexp$1.exec(this.src);)w.push(a);for(g=0;g<w.length;g++){var a,_=(a=w[g])[0],x=!this.isMethod||!this.getInputByName(_),b=_;if(this.keywords[_]||this.useKeywords&&x&&NodeLib.containsKeyword(_)){var A=this.keywords[_];if(!A){var E=NodeLib.getKeywordData(_);E.cache&&(A=s.keywords[_]),A=A||NodeLib.getKeyword(_,s),E.cache&&(s.keywords[_]=A)}b=A.build(s)}_!==b&&(v=v.substring(0,a.index+d)+b+v.substring(a.index+_.length+d),d+=b.length-_.length),void 0===this.getIncludeByName(b)&&NodeLib.contains(b)&&s.include(NodeLib.get(b))}return"source"===e?v:this.isMethod?(this.isInterface||s.include(this,!1,v),this.name):s.format("( "+v+" )",this.getType(s),e)},FunctionNode.prototype.parse=function(s,e,a,d){if(this.src=s||"",this.includes=e||[],this.extensions=a||{},this.keywords=d||{},this.isMethod){var v=this.src.match(declarationRegexp$2);if(this.inputs=[],v&&4==v.length){this.type=v[1],this.name=v[2];var g=v[3].match(propertiesRegexp$1);if(g)for(var C=0;C<g.length;){var _,x,w=g[C++];"in"===w||"out"===w||"inout"===w?_=g[C++]:(_=w,w=""),x=g[C++],this.inputs.push({name:x,type:_,qualifier:w})}this.isInterface=-1===this.src.indexOf("{")}else this.type="",this.name=""}},FunctionNode.prototype.copy=function(s){return TempNode.prototype.copy.call(this,s),this.isMethod=s.isMethod,this.useKeywords=s.useKeywords,this.parse(s.src,s.includes,s.extensions,s.keywords),void 0!==s.type&&(this.type=s.type),this},FunctionNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);if(!e){for(var a in(e=this.createJSONNode(s)).src=this.src,e.isMethod=this.isMethod,e.useKeywords=this.useKeywords,this.isMethod||(e.type=this.type),e.extensions=JSON.parse(JSON.stringify(this.extensions)),e.keywords={},this.keywords)e.keywords[a]=this.keywords[a].toJSON(s).uuid;if(this.includes.length){e.includes=[];for(var d=0;d<this.includes.length;d++)e.includes.push(this.includes[d].toJSON(s).uuid)}}return e},ExpressionNode.prototype=Object.create(FunctionNode.prototype),ExpressionNode.prototype.constructor=ExpressionNode,ExpressionNode.prototype.nodeType="Expression",FunctionCallNode.prototype=Object.create(TempNode.prototype),FunctionCallNode.prototype.constructor=FunctionCallNode,FunctionCallNode.prototype.nodeType="FunctionCall",FunctionCallNode.prototype.setFunction=function(s,e){this.value=s,this.inputs=e||[]},FunctionCallNode.prototype.getFunction=function(){return this.value},FunctionCallNode.prototype.getType=function(s){return this.value.getType(s)},FunctionCallNode.prototype.generate=function(s,e){for(var a=this.getType(s),d=this.value,v=d.build(s,e)+"( ",g=[],C=0;C<d.inputs.length;C++){var w=d.inputs[C];g.push((this.inputs[C]||this.inputs[w.name]).build(s,s.getTypeByFormat(w.type)))}return v+=g.join(", ")+" )",s.format(v,a,e)},FunctionCallNode.prototype.copy=function(s){for(var e in TempNode.prototype.copy.call(this,s),s.inputs)this.inputs[e]=s.inputs[e];return this.value=s.value,this},FunctionCallNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);if(!e){var a=this.value;if((e=this.createJSONNode(s)).value=this.value.toJSON(s).uuid,a.inputs.length){e.inputs={};for(var d=0;d<a.inputs.length;d++){var v=a.inputs[d];e.inputs[v.name]=(this.inputs[d]||this.inputs[v.name]).toJSON(s).uuid}}}return e};var NodeUtils={elements:["x","y","z","w"],addShortcuts:function(){function s(e,a,d){return d?{get:function(){return this[e][a][d]},set:function(g){this[e][a][d]=g}}:{get:function(){return this[e][a]},set:function(g){this[e][a]=g}}}return function(a,d,v){for(var g={},C=0;C<v.length;++C){var w=v[C].split("."),_=w[0];g[_]=s(d,_,w[1])}Object.defineProperties(a,g)}}()};function NodeFrame(s){this.time=void 0!==s?s:0,this.id=0}function NodeUniform(s){this.name=(s=s||{}).name,this.type=s.type,this.node=s.node,this.needsUpdate=s.needsUpdate}function Vector2Node(s,e){InputNode.call(this,"v2"),this.value=s instanceof Vector2?s:new Vector2(s,e)}function Vector3Node(s,e,a){InputNode.call(this,"v3"),this.value=s instanceof Vector3?s:new Vector3(s,e,a)}function Vector4Node(s,e,a,d){InputNode.call(this,"v4"),this.value=s instanceof Vector4?s:new Vector4(s,e,a,d)}function UVNode(s){TempNode.call(this,"v2",{shared:!1}),this.index=s||0}function FloatNode(s){InputNode.call(this,"f"),this.value=s||0}function ColorSpaceNode(s,e){TempNode.call(this,"v4"),this.input=s,this.method=e||ColorSpaceNode.LINEAR_TO_LINEAR}function TextureNode(s,e,a,d){InputNode.call(this,"v4",{shared:!0}),this.value=s,this.uv=e||new UVNode,this.bias=a,this.project=void 0!==d&&d}function PositionNode(s){TempNode.call(this,"v3"),this.scope=s||PositionNode.LOCAL}function NormalNode(s){TempNode.call(this,"v3"),this.scope=s||NormalNode.VIEW}function ReflectNode(s){TempNode.call(this,"v3"),this.scope=s||ReflectNode.CUBE}function CubeTextureNode(s,e,a){InputNode.call(this,"v4",{shared:!0}),this.value=s,this.uv=e||new ReflectNode,this.bias=a}function OperatorNode(s,e,a){TempNode.call(this),this.a=s,this.b=e,this.op=a}function MathNode(s,e,a,d){TempNode.call(this),this.a=s,"string"!=typeof e?this.b=e:d=e,"string"!=typeof a?this.c=a:d=a,this.method=d}function TextureCubeUVNode(s,e,a){TempNode.call(this,"v4"),this.value=s,this.uv=e,this.bias=a}function TextureCubeNode(s,e,a){TempNode.call(this,"v4"),this.value=s,this.radianceNode=new TextureCubeUVNode(this.value,e||new ReflectNode(ReflectNode.VECTOR),a),this.irradianceNode=new TextureCubeUVNode(this.value,new NormalNode(NormalNode.WORLD),new FloatNode(1).setReadonly(!0))}NodeFrame.prototype={constructor:NodeFrame,update:function(e){return++this.id,this.time+=e,this.delta=e,this},setRenderer:function(e){return this.renderer=e,this},setRenderTexture:function(e){return this.renderTexture=e,this},updateNode:function(e){return e.frameId===this.id||(e.updateFrame(this),e.frameId=this.id),this}},Object.defineProperties(NodeUniform.prototype,{value:{get:function(){return this.node.value},set:function(e){this.node.value=e}}}),Vector2Node.prototype=Object.create(InputNode.prototype),Vector2Node.prototype.constructor=Vector2Node,Vector2Node.prototype.nodeType="Vector2",NodeUtils.addShortcuts(Vector2Node.prototype,"value",["x","y"]),Vector2Node.prototype.generateReadonly=function(s,e,a,d){return s.format("vec2( "+this.x+", "+this.y+" )",d,e)},Vector2Node.prototype.copy=function(s){return InputNode.prototype.copy.call(this,s),this.value.copy(s),this},Vector2Node.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).x=this.x,e.y=this.y,!0===this.readonly&&(e.readonly=!0)),e},Vector3Node.prototype=Object.create(InputNode.prototype),Vector3Node.prototype.constructor=Vector3Node,Vector3Node.prototype.nodeType="Vector3",NodeUtils.addShortcuts(Vector3Node.prototype,"value",["x","y","z"]),Vector3Node.prototype.generateReadonly=function(s,e,a,d){return s.format("vec3( "+this.x+", "+this.y+", "+this.z+" )",d,e)},Vector3Node.prototype.copy=function(s){return InputNode.prototype.copy.call(this,s),this.value.copy(s),this},Vector3Node.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).x=this.x,e.y=this.y,e.z=this.z,!0===this.readonly&&(e.readonly=!0)),e},Vector4Node.prototype=Object.create(InputNode.prototype),Vector4Node.prototype.constructor=Vector4Node,Vector4Node.prototype.nodeType="Vector4",NodeUtils.addShortcuts(Vector4Node.prototype,"value",["x","y","z","w"]),Vector4Node.prototype.generateReadonly=function(s,e,a,d){return s.format("vec4( "+this.x+", "+this.y+", "+this.z+", "+this.w+" )",d,e)},Vector4Node.prototype.copy=function(s){return InputNode.prototype.copy.call(this,s),this.value.copy(s),this},Vector4Node.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).x=this.x,e.y=this.y,e.z=this.z,e.w=this.w,!0===this.readonly&&(e.readonly=!0)),e},UVNode.prototype=Object.create(TempNode.prototype),UVNode.prototype.constructor=UVNode,UVNode.prototype.nodeType="UV",UVNode.prototype.generate=function(s,e){s.requires.uv[this.index]=!0;var a=this.index>0?this.index+1:"",d=s.isShader("vertex")?"uv"+a:"vUv"+a;return s.format(d,this.getType(s),e)},UVNode.prototype.copy=function(s){return TempNode.prototype.copy.call(this,s),this.index=s.index,this},UVNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).index=this.index),e},NodeLib.addKeyword("uv",function(){return new UVNode}),NodeLib.addKeyword("uv2",function(){return new UVNode(1)}),FloatNode.prototype=Object.create(InputNode.prototype),FloatNode.prototype.constructor=FloatNode,FloatNode.prototype.nodeType="Float",FloatNode.prototype.generateReadonly=function(s,e,a,d){return s.format(this.value+(this.value%1?"":".0"),d,e)},FloatNode.prototype.copy=function(s){return InputNode.prototype.copy.call(this,s),this.value=s.value,this},FloatNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).value=this.value,!0===this.readonly&&(e.readonly=!0)),e},ColorSpaceNode.Nodes=function(){var s=new FunctionNode(["vec4 LinearToLinear( in vec4 value ) {","\treturn value;","}"].join("\n")),e=new FunctionNode(["vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {","\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );","}"].join("\n")),a=new FunctionNode(["vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {","\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );","}"].join("\n")),d=new FunctionNode(["vec4 sRGBToLinear( in vec4 value ) {","\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );","}"].join("\n")),v=new FunctionNode(["vec4 LinearTosRGB( in vec4 value ) {","\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );","}"].join("\n")),g=new FunctionNode(["vec4 RGBEToLinear( in vec4 value ) {","\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );","}"].join("\n")),C=new FunctionNode(["vec4 LinearToRGBE( in vec4 value ) {","\tfloat maxComponent = max( max( value.r, value.g ), value.b );","\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );","\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );","}"].join("\n")),w=new FunctionNode(["vec3 RGBMToLinear( in vec4 value, in float maxRange ) {","\treturn vec4( value.xyz * value.w * maxRange, 1.0 );","}"].join("\n")),_=new FunctionNode(["vec3 LinearToRGBM( in vec4 value, in float maxRange ) {","\tfloat maxRGB = max( value.x, max( value.g, value.b ) );","\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );","\tM            = ceil( M * 255.0 ) / 255.0;","\treturn vec4( value.rgb / ( M * maxRange ), M );","}"].join("\n")),x=new FunctionNode(["vec3 RGBDToLinear( in vec4 value, in float maxRange ) {","\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );","}"].join("\n")),b=new FunctionNode(["vec3 LinearToRGBD( in vec4 value, in float maxRange ) {","\tfloat maxRGB = max( value.x, max( value.g, value.b ) );","\tfloat D      = max( maxRange / maxRGB, 1.0 );","\tD            = clamp( floor( D ) / 255.0, 0.0, 1.0 );","\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );","}"].join("\n")),A=new ConstNode("const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );"),E=new FunctionNode(["vec4 LinearToLogLuv( in vec4 value ) {","\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;","\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));","\tvec4 vResult;","\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;","\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;","\tvResult.w = fract(Le);","\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;","\treturn vResult;","}"].join("\n"),[A]),R=new ConstNode("const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );");return{LinearToLinear:s,GammaToLinear:e,LinearToGamma:a,sRGBToLinear:d,LinearTosRGB:v,RGBEToLinear:g,LinearToRGBE:C,RGBMToLinear:w,LinearToRGBM:_,RGBDToLinear:x,LinearToRGBD:b,cLogLuvM:A,LinearToLogLuv:E,cLogLuvInverseM:R,LogLuvToLinear:new FunctionNode(["vec4 LogLuvToLinear( in vec4 value ) {","\tfloat Le = value.z * 255.0 + value.w;","\tvec3 Xp_Y_XYZp;","\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);","\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;","\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;","\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;","\treturn vec4( max(vRGB, 0.0), 1.0 );","}"].join("\n"),[R])}}(),ColorSpaceNode.LINEAR_TO_LINEAR="LinearToLinear",ColorSpaceNode.GAMMA_TO_LINEAR="GammaToLinear",ColorSpaceNode.LINEAR_TO_GAMMA="LinearToGamma",ColorSpaceNode.SRGB_TO_LINEAR="sRGBToLinear",ColorSpaceNode.LINEAR_TO_SRGB="LinearTosRGB",ColorSpaceNode.RGBE_TO_LINEAR="RGBEToLinear",ColorSpaceNode.LINEAR_TO_RGBE="LinearToRGBE",ColorSpaceNode.RGBM_TO_LINEAR="RGBMToLinear",ColorSpaceNode.LINEAR_TO_RGBM="LinearToRGBM",ColorSpaceNode.RGBD_TO_LINEAR="RGBDToLinear",ColorSpaceNode.LINEAR_TO_RGBD="LinearToRGBD",ColorSpaceNode.LINEAR_TO_LOG_LUV="LinearToLogLuv",ColorSpaceNode.LOG_LUV_TO_LINEAR="LogLuvToLinear",ColorSpaceNode.getEncodingComponents=function(s){switch(s){case LinearEncoding:return["Linear"];case sRGBEncoding:return["sRGB"];case RGBEEncoding:return["RGBE"];case RGBM7Encoding:return["RGBM",new FloatNode(7).setReadonly(!0)];case RGBM16Encoding:return["RGBM",new FloatNode(16).setReadonly(!0)];case RGBDEncoding:return["RGBD",new FloatNode(256).setReadonly(!0)];case GammaEncoding:return["Gamma",new ExpressionNode("float( GAMMA_FACTOR )","f")]}},ColorSpaceNode.prototype=Object.create(TempNode.prototype),ColorSpaceNode.prototype.constructor=ColorSpaceNode,ColorSpaceNode.prototype.nodeType="ColorSpace",ColorSpaceNode.prototype.generate=function(s,e){var a=this.input.build(s,"v4"),d=this.getType(s),v=ColorSpaceNode.Nodes[this.method],g=s.include(v);if(g===ColorSpaceNode.LINEAR_TO_LINEAR)return s.format(a,d,e);if(2===v.inputs.length){var C=this.factor.build(s,"f");return s.format(g+"( "+a+", "+C+" )",d,e)}return s.format(g+"( "+a+" )",d,e)},ColorSpaceNode.prototype.fromEncoding=function(s){var e=ColorSpaceNode.getEncodingComponents(s);this.method="LinearTo"+e[0],this.factor=e[1]},ColorSpaceNode.prototype.fromDecoding=function(s){var e=ColorSpaceNode.getEncodingComponents(s);this.method=e[0]+"ToLinear",this.factor=e[1]},ColorSpaceNode.prototype.copy=function(s){return TempNode.prototype.copy.call(this,s),this.input=s.input,this.method=s.method,this},ColorSpaceNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).input=this.input.toJSON(s).uuid,e.method=this.method),e},TextureNode.prototype=Object.create(InputNode.prototype),TextureNode.prototype.constructor=TextureNode,TextureNode.prototype.nodeType="Texture",TextureNode.prototype.getTexture=function(s,e){return InputNode.prototype.generate.call(this,s,e,this.value.uuid,"t")},TextureNode.prototype.generate=function(s,e){if("sampler2D"===e)return this.getTexture(s,e);var g,C,a=this.getTexture(s,e),d=this.uv.build(s,this.project?"v4":"v2"),v=this.bias?this.bias.build(s,"f"):void 0;void 0===v&&s.context.bias&&(v=s.context.bias.setTexture(this).build(s,"f")),g=this.project?"texture2DProj":v?"tex2DBias":"tex2D",C=v?g+"( "+a+", "+d+", "+v+" )":g+"( "+a+", "+d+" )";var w={include:s.isShader("vertex"),ignoreCache:!0},_=this.getType(s);return s.addContext(w),this.colorSpace=this.colorSpace||new ColorSpaceNode(new ExpressionNode("",_)),this.colorSpace.fromDecoding(s.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(C),C=this.colorSpace.build(s,_),s.removeContext(),s.format(C,_,e)},TextureNode.prototype.copy=function(s){return InputNode.prototype.copy.call(this,s),s.value&&(this.value=s.value),this.uv=s.uv,s.bias&&(this.bias=s.bias),void 0!==s.project&&(this.project=s.project),this},TextureNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||(e=this.createJSONNode(s),this.value&&(e.value=this.value.uuid),e.uv=this.uv.toJSON(s).uuid,e.project=this.project,this.bias&&(e.bias=this.bias.toJSON(s).uuid)),e},PositionNode.LOCAL="local",PositionNode.WORLD="world",PositionNode.VIEW="view",PositionNode.PROJECTION="projection",PositionNode.prototype=Object.create(TempNode.prototype),PositionNode.prototype.constructor=PositionNode,PositionNode.prototype.nodeType="Position",PositionNode.prototype.getType=function(){return this.scope===PositionNode.PROJECTION?"v4":this.type},PositionNode.prototype.getShared=function(){switch(this.scope){case PositionNode.LOCAL:case PositionNode.WORLD:return!1}return!0},PositionNode.prototype.generate=function(s,e){var a;switch(this.scope){case PositionNode.LOCAL:s.isShader("vertex")?a="transformed":(s.requires.position=!0,a="vPosition");break;case PositionNode.WORLD:if(s.isShader("vertex"))return"( modelMatrix * vec4( transformed, 1.0 ) ).xyz";s.requires.worldPosition=!0,a="vWPosition";break;case PositionNode.VIEW:a=s.isShader("vertex")?"-mvPosition.xyz":"vViewPosition";break;case PositionNode.PROJECTION:a=s.isShader("vertex")?"( projectionMatrix * modelViewMatrix * vec4( position, 1.0 ) )":"vec4( 0.0 )"}return s.format(a,this.getType(s),e)},PositionNode.prototype.copy=function(s){return TempNode.prototype.copy.call(this,s),this.scope=s.scope,this},PositionNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).scope=this.scope),e},NodeLib.addKeyword("position",function(){return new PositionNode}),NodeLib.addKeyword("worldPosition",function(){return new PositionNode(PositionNode.WORLD)}),NodeLib.addKeyword("viewPosition",function(){return new PositionNode(PositionNode.VIEW)}),NormalNode.LOCAL="local",NormalNode.WORLD="world",NormalNode.VIEW="view",NormalNode.prototype=Object.create(TempNode.prototype),NormalNode.prototype.constructor=NormalNode,NormalNode.prototype.nodeType="Normal",NormalNode.prototype.getShared=function(){return this.scope===NormalNode.WORLD},NormalNode.prototype.build=function(s,e,a,d){var v=s.context[this.scope+"Normal"];return v?v.build(s,e,a,d):TempNode.prototype.build.call(this,s,e,a)},NormalNode.prototype.generate=function(s,e){var a;switch(this.scope){case NormalNode.VIEW:a=s.isShader("vertex")?"transformedNormal":"geometryNormal";break;case NormalNode.LOCAL:s.isShader("vertex")?a="objectNormal":(s.requires.normal=!0,a="vObjectNormal");break;case NormalNode.WORLD:s.isShader("vertex")?a="inverseTransformDirection( transformedNormal, viewMatrix ).xyz":(s.requires.worldNormal=!0,a="vWNormal")}return s.format(a,this.getType(s),e)},NormalNode.prototype.copy=function(s){return TempNode.prototype.copy.call(this,s),this.scope=s.scope,this},NormalNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).scope=this.scope),e},NodeLib.addKeyword("viewNormal",function(){return new NormalNode(NormalNode.VIEW)}),NodeLib.addKeyword("localNormal",function(){return new NormalNode(NormalNode.NORMAL)}),NodeLib.addKeyword("worldNormal",function(){return new NormalNode(NormalNode.WORLD)}),ReflectNode.CUBE="cube",ReflectNode.SPHERE="sphere",ReflectNode.VECTOR="vector",ReflectNode.prototype=Object.create(TempNode.prototype),ReflectNode.prototype.constructor=ReflectNode,ReflectNode.prototype.nodeType="Reflect",ReflectNode.prototype.getUnique=function(s){return!s.context.viewNormal},ReflectNode.prototype.getType=function(){return this.scope===ReflectNode.SPHERE?"v2":this.type},ReflectNode.prototype.generate=function(s,e){var a=this.getUnique(s);if(s.isShader("fragment")){var d;switch(this.scope){case ReflectNode.VECTOR:var v=new NormalNode(NormalNode.VIEW),g=s.context.roughness,C=v.build(s,"v3"),w=new PositionNode(PositionNode.VIEW).build(s,"v3"),_=g?g.build(s,"f"):void 0,x="reflect( -normalize( "+w+" ), "+C+" )";_&&(x="normalize( mix( "+x+", "+C+", "+_+" * "+_+" ) )");var b="inverseTransformDirection( "+x+", viewMatrix )";a?(s.addNodeCode("vec3 reflectVec = "+b+";"),d="reflectVec"):d=b;break;case ReflectNode.CUBE:b="vec3( -"+(A=new ReflectNode(ReflectNode.VECTOR).build(s,"v3"))+".x, "+A+".yz )",a?(s.addNodeCode("vec3 reflectCubeVec = "+b+";"),d="reflectCubeVec"):d=b;break;case ReflectNode.SPHERE:var A;b="normalize( ( viewMatrix * vec4( "+(A=new ReflectNode(ReflectNode.VECTOR).build(s,"v3"))+", 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) ).xy * 0.5 + 0.5",a?(s.addNodeCode("vec2 reflectSphereVec = "+b+";"),d="reflectSphereVec"):d=b}return s.format(d,this.getType(s),e)}return console.warn("ReflectNode is not compatible with "+s.shader+" shader."),s.format("vec3( 0.0 )",this.type,e)},ReflectNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).scope=this.scope),e},CubeTextureNode.prototype=Object.create(InputNode.prototype),CubeTextureNode.prototype.constructor=CubeTextureNode,CubeTextureNode.prototype.nodeType="CubeTexture",CubeTextureNode.prototype.getTexture=function(s,e){return InputNode.prototype.generate.call(this,s,e,this.value.uuid,"tc")},CubeTextureNode.prototype.generate=function(s,e){if("samplerCube"===e)return this.getTexture(s,e);var g,a=this.getTexture(s,e),d=this.uv.build(s,"v3"),v=this.bias?this.bias.build(s,"f"):void 0;void 0===v&&s.context.bias&&(v=s.context.bias.setTexture(this).build(s,"f")),g=v?"texCubeBias( "+a+", "+d+", "+v+" )":"texCube( "+a+", "+d+" )";var C={include:s.isShader("vertex"),ignoreCache:!0},w=this.getType(s);return s.addContext(C),this.colorSpace=this.colorSpace||new ColorSpaceNode(new ExpressionNode("",w)),this.colorSpace.fromDecoding(s.getTextureEncodingFromMap(this.value)),this.colorSpace.input.parse(g),g=this.colorSpace.build(s,w),s.removeContext(),s.format(g,w,e)},CubeTextureNode.prototype.copy=function(s){return InputNode.prototype.copy.call(this,s),s.value&&(this.value=s.value),this.uv=s.uv,s.bias&&(this.bias=s.bias),this},CubeTextureNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).value=this.value.uuid,e.uv=this.uv.toJSON(s).uuid,this.bias&&(e.bias=this.bias.toJSON(s).uuid)),e},OperatorNode.ADD="+",OperatorNode.SUB="-",OperatorNode.MUL="*",OperatorNode.DIV="/",OperatorNode.prototype=Object.create(TempNode.prototype),OperatorNode.prototype.constructor=OperatorNode,OperatorNode.prototype.nodeType="Operator",OperatorNode.prototype.getType=function(s){var e=this.a.getType(s),a=this.b.getType(s);return s.isTypeMatrix(e)?"v4":s.getTypeLength(a)>s.getTypeLength(e)?a:e},OperatorNode.prototype.generate=function(s,e){var a=this.getType(s),d=this.a.build(s,a),v=this.b.build(s,a);return s.format("( "+d+" "+this.op+" "+v+" )",a,e)},OperatorNode.prototype.copy=function(s){return TempNode.prototype.copy.call(this,s),this.a=s.a,this.b=s.b,this.op=s.op,this},OperatorNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).a=this.a.toJSON(s).uuid,e.b=this.b.toJSON(s).uuid,e.op=this.op),e},MathNode.RAD="radians",MathNode.DEG="degrees",MathNode.EXP="exp",MathNode.EXP2="exp2",MathNode.LOG="log",MathNode.LOG2="log2",MathNode.SQRT="sqrt",MathNode.INV_SQRT="inversesqrt",MathNode.FLOOR="floor",MathNode.CEIL="ceil",MathNode.NORMALIZE="normalize",MathNode.FRACT="fract",MathNode.SATURATE="saturate",MathNode.SIN="sin",MathNode.COS="cos",MathNode.TAN="tan",MathNode.ASIN="asin",MathNode.ACOS="acos",MathNode.ARCTAN="atan",MathNode.ABS="abs",MathNode.SIGN="sign",MathNode.LENGTH="length",MathNode.NEGATE="negate",MathNode.INVERT="invert",MathNode.MIN="min",MathNode.MAX="max",MathNode.MOD="mod",MathNode.STEP="step",MathNode.REFLECT="reflect",MathNode.DISTANCE="distance",MathNode.DOT="dot",MathNode.CROSS="cross",MathNode.POW="pow",MathNode.MIX="mix",MathNode.CLAMP="clamp",MathNode.REFRACT="refract",MathNode.SMOOTHSTEP="smoothstep",MathNode.FACEFORWARD="faceforward",MathNode.prototype=Object.create(TempNode.prototype),MathNode.prototype.constructor=MathNode,MathNode.prototype.nodeType="Math",MathNode.prototype.getNumInputs=function(){switch(this.method){case MathNode.MIX:case MathNode.CLAMP:case MathNode.REFRACT:case MathNode.SMOOTHSTEP:case MathNode.FACEFORWARD:return 3;case MathNode.MIN:case MathNode.MAX:case MathNode.MOD:case MathNode.STEP:case MathNode.REFLECT:case MathNode.DISTANCE:case MathNode.DOT:case MathNode.CROSS:case MathNode.POW:return 2;default:return 1}},MathNode.prototype.getInputType=function(s){var e=s.getTypeLength(this.a.getType(s)),a=this.b?s.getTypeLength(this.b.getType(s)):0,d=this.c?s.getTypeLength(this.c.getType(s)):0;return e>a&&e>d?this.a.getType(s):a>d?this.b.getType(s):this.c.getType(s)},MathNode.prototype.getType=function(s){switch(this.method){case MathNode.LENGTH:case MathNode.DISTANCE:case MathNode.DOT:return"f";case MathNode.CROSS:return"v3"}return this.getInputType(s)},MathNode.prototype.generate=function(s,e){var a,d,v,g=this.a?s.getTypeLength(this.a.getType(s)):0,C=this.b?s.getTypeLength(this.b.getType(s)):0,w=this.c?s.getTypeLength(this.c.getType(s)):0,_=this.getInputType(s),x=this.getType(s);switch(this.method){case MathNode.NEGATE:return s.format("( -"+this.a.build(s,_)+" )",_,e);case MathNode.INVERT:return s.format("( 1.0 - "+this.a.build(s,_)+" )",_,e);case MathNode.CROSS:a=this.a.build(s,"v3"),d=this.b.build(s,"v3");break;case MathNode.STEP:a=this.a.build(s,1===g?"f":_),d=this.b.build(s,_);break;case MathNode.MIN:case MathNode.MAX:case MathNode.MOD:a=this.a.build(s,_),d=this.b.build(s,1===C?"f":_);break;case MathNode.REFRACT:a=this.a.build(s,_),d=this.b.build(s,_),v=this.c.build(s,"f");break;case MathNode.MIX:a=this.a.build(s,_),d=this.b.build(s,_),v=this.c.build(s,1===w?"f":_);break;default:a=this.a.build(s,_),this.b&&(d=this.b.build(s,_)),this.c&&(v=this.c.build(s,_))}var b=[];b.push(a),d&&b.push(d),v&&b.push(v);var A=this.getNumInputs(s);if(b.length!==A)throw Error('Arguments not match used in "'+this.method+'". Require '+A+", currently "+b.length+".");return s.format(this.method+"( "+b.join(", ")+" )",x,e)},MathNode.prototype.copy=function(s){return TempNode.prototype.copy.call(this,s),this.a=s.a,this.b=s.b,this.c=s.c,this.method=s.method,this},MathNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).a=this.a.toJSON(s).uuid,this.b&&(e.b=this.b.toJSON(s).uuid),this.c&&(e.c=this.c.toJSON(s).uuid),e.method=this.method),e},TextureCubeUVNode.Nodes=function(){var s=new StructNode("struct TextureCubeUVData {\n\t\t\tvec4 tl;\n\t\t\tvec4 tr;\n\t\t\tvec4 br;\n\t\t\tvec4 bl;\n\t\t\tvec2 f;\n\t\t}"),e=new ConstNode("float cubeUV_maxMipLevel 8.0",!0),a=new ConstNode("float cubeUV_minMipLevel 4.0",!0),d=new ConstNode("float cubeUV_maxTileSize 256.0",!0),v=new ConstNode("float cubeUV_minTileSize 16.0",!0),g=new FunctionNode("float getFace(vec3 direction) {\n\t\t\t\tvec3 absDirection = abs(direction);\n\t\t\t\tfloat face = -1.0;\n\t\t\t\tif (absDirection.x > absDirection.z) {\n\t\t\t\t\tif (absDirection.x > absDirection.y)\n\t\t\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\t\t\telse\n\t\t\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t\t\t} else {\n\t\t\t\t\tif (absDirection.z > absDirection.y)\n\t\t\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\t\t\telse\n\t\t\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t\t\t}\n\t\t\t\treturn face;\n\t\t}");g.useKeywords=!1;var C=new FunctionNode("vec2 getUV(vec3 direction, float face) {\n\t\t\t\tvec2 uv;\n\t\t\t\tif (face == 0.0) {\n\t\t\t\t\tuv = vec2(-direction.z, direction.y) / abs(direction.x);\n\t\t\t\t} else if (face == 1.0) {\n\t\t\t\t\tuv = vec2(direction.x, -direction.z) / abs(direction.y);\n\t\t\t\t} else if (face == 2.0) {\n\t\t\t\t\tuv = direction.xy / abs(direction.z);\n\t\t\t\t} else if (face == 3.0) {\n\t\t\t\t\tuv = vec2(direction.z, direction.y) / abs(direction.x);\n\t\t\t\t} else if (face == 4.0) {\n\t\t\t\t\tuv = direction.xz / abs(direction.y);\n\t\t\t\t} else {\n\t\t\t\t\tuv = vec2(-direction.x, direction.y) / abs(direction.z);\n\t\t\t\t}\n\t\t\t\treturn 0.5 * (uv + 1.0);\n\t\t}");C.useKeywords=!1;var w=new FunctionNode("TextureCubeUVData bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n\n\t\t\tfloat face = getFace(direction);\n\t\t\tfloat filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n\t\t\tmipInt = max(mipInt, cubeUV_minMipLevel);\n\t\t\tfloat faceSize = exp2(mipInt);\n\n\t\t\tfloat texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n\n\t\t\tvec2 uv = getUV(direction, face) * (faceSize - 1.0);\n\t\t\tvec2 f = fract(uv);\n\t\t\tuv += 0.5 - f;\n\t\t\tif (face > 2.0) {\n\t\t\t\tuv.y += faceSize;\n\t\t\t\tface -= 3.0;\n\t\t\t}\n\t\t\tuv.x += face * faceSize;\n\t\t\tif(mipInt < cubeUV_maxMipLevel){\n\t\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t\t}\n\t\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\t\tuv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n\t\t\tuv *= texelSize;\n \n\t\t\tvec4 tl = texture2D(envMap, uv);\n\t\t\tuv.x += texelSize;\n\t\t\tvec4 tr = texture2D(envMap, uv);\n\t\t\tuv.y += texelSize;\n\t\t\tvec4 br = texture2D(envMap, uv);\n\t\t\tuv.x -= texelSize;\n\t\t\tvec4 bl = texture2D(envMap, uv);\n\n\t\t\treturn TextureCubeUVData( tl, tr, br, bl, f );\n\t\t}",[s,g,C,e,a,d,v]);w.useKeywords=!1;var _=new ConstNode("float r0 1.0",!0),x=new ConstNode("float v0 0.339",!0),b=new ConstNode("float m0 -2.0",!0);return{bilinearCubeUV:w,roughnessToMip:new FunctionNode("float roughnessToMip(float roughness) {\n\t\t\tfloat mip = 0.0;\n\t\t\tif (roughness >= r1) {\n\t\t\t\tmip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n\t\t\t} else if (roughness >= r4) {\n\t\t\t\tmip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n\t\t\t} else if (roughness >= r5) {\n\t\t\t\tmip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n\t\t\t} else if (roughness >= r6) {\n\t\t\t\tmip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n\t\t\t} else {\n\t\t\t\tmip = -2.0 * log2(1.16 * roughness);// 1.16 = 1.79^0.25\n\t\t\t}\n\t\t\treturn mip;\n\t\t}",[_,x,b,new ConstNode("float r1 0.8",!0),new ConstNode("float v1 0.276",!0),new ConstNode("float m1 -1.0",!0),new ConstNode("float r4 0.4",!0),new ConstNode("float v4 0.046",!0),new ConstNode("float m4 2.0",!0),new ConstNode("float r5 0.305",!0),new ConstNode("float v5 0.016",!0),new ConstNode("float m5 3.0",!0),new ConstNode("float r6 0.21",!0),new ConstNode("float v6 0.0038",!0),new ConstNode("float m6 4.0",!0)]),m0:b,cubeUV_maxMipLevel:e}}(),TextureCubeUVNode.prototype=Object.create(TempNode.prototype),TextureCubeUVNode.prototype.constructor=TextureCubeUVNode,TextureCubeUVNode.prototype.nodeType="TextureCubeUV",TextureCubeUVNode.prototype.bilinearCubeUV=function(s,e,a,d){var v=new FunctionCallNode(TextureCubeUVNode.Nodes.bilinearCubeUV,[e,a,d]);this.colorSpaceTL=this.colorSpaceTL||new ColorSpaceNode(new ExpressionNode("","v4")),this.colorSpaceTL.fromDecoding(s.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTL.input.parse(v.build(s)+".tl"),this.colorSpaceTR=this.colorSpaceTR||new ColorSpaceNode(new ExpressionNode("","v4")),this.colorSpaceTR.fromDecoding(s.getTextureEncodingFromMap(this.value.value)),this.colorSpaceTR.input.parse(v.build(s)+".tr"),this.colorSpaceBL=this.colorSpaceBL||new ColorSpaceNode(new ExpressionNode("","v4")),this.colorSpaceBL.fromDecoding(s.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBL.input.parse(v.build(s)+".bl"),this.colorSpaceBR=this.colorSpaceBR||new ColorSpaceNode(new ExpressionNode("","v4")),this.colorSpaceBR.fromDecoding(s.getTextureEncodingFromMap(this.value.value)),this.colorSpaceBR.input.parse(v.build(s)+".br");var g={include:s.isShader("vertex"),ignoreCache:!0};s.addContext(g),this.colorSpaceTLExp=new ExpressionNode(this.colorSpaceTL.build(s,"v4"),"v4"),this.colorSpaceTRExp=new ExpressionNode(this.colorSpaceTR.build(s,"v4"),"v4"),this.colorSpaceBLExp=new ExpressionNode(this.colorSpaceBL.build(s,"v4"),"v4"),this.colorSpaceBRExp=new ExpressionNode(this.colorSpaceBR.build(s,"v4"),"v4"),s.removeContext();var C=new ExpressionNode("mix( mix( cubeUV_TL, cubeUV_TR, cubeUV.f.x ), mix( cubeUV_BL, cubeUV_BR, cubeUV.f.x ), cubeUV.f.y )","v4");return C.keywords.cubeUV_TL=this.colorSpaceTLExp,C.keywords.cubeUV_TR=this.colorSpaceTRExp,C.keywords.cubeUV_BL=this.colorSpaceBLExp,C.keywords.cubeUV_BR=this.colorSpaceBRExp,C.keywords.cubeUV=v,C},TextureCubeUVNode.prototype.generate=function(s,e){if(s.isShader("fragment")){var a=this.uv,g=new MathNode(new FunctionCallNode(TextureCubeUVNode.Nodes.roughnessToMip,[this.bias||s.context.roughness]),TextureCubeUVNode.Nodes.m0,TextureCubeUVNode.Nodes.cubeUV_maxMipLevel,MathNode.CLAMP),C=new MathNode(g,MathNode.FLOOR),w=new MathNode(g,MathNode.FRACT),b=new MathNode(this.bilinearCubeUV(s,this.value,a,C),this.bilinearCubeUV(s,this.value,a,new OperatorNode(C,new FloatNode(1).setReadonly(!0),OperatorNode.ADD)),w,MathNode.MIX);return s.format(b.build(s),"v4",e)}return console.warn("TextureCubeUVNode is not compatible with "+s.shader+" shader."),s.format("vec4( 0.0 )",this.getType(s),e)},TextureCubeUVNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).value=this.value.toJSON(s).uuid,e.uv=this.uv.toJSON(s).uuid,e.bias=this.bias.toJSON(s).uuid),e},TextureCubeNode.prototype=Object.create(TempNode.prototype),TextureCubeNode.prototype.constructor=TextureCubeNode,TextureCubeNode.prototype.nodeType="TextureCube",TextureCubeNode.prototype.generate=function(s,e){return s.isShader("fragment")?(s.require("irradiance"),s.context.bias&&s.context.bias.setTexture(this.value),("irradiance"===s.slot?this.irradianceNode:this.radianceNode).build(s,e)):(console.warn("TextureCubeNode is not compatible with "+s.shader+" shader."),s.format("vec4( 0.0 )",this.getType(s),e))},TextureCubeNode.prototype.copy=function(s){return TempNode.prototype.copy.call(this,s),this.value=s.value,this},TextureCubeNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).value=this.value.toJSON(s).uuid),e};var elements=NodeUtils.elements,constructors=["float","vec2","vec3","vec4"],convertFormatToType={float:"f",vec2:"v2",vec3:"v3",vec4:"v4",mat4:"v4",int:"i",bool:"b"},convertTypeToFormat={t:"sampler2D",tc:"samplerCube",b:"bool",i:"int",f:"float",c:"vec3",v2:"vec2",v3:"vec3",v4:"vec4",m3:"mat3",m4:"mat4"};function NodeBuilder(){this.slots=[],this.caches=[],this.contexts=[],this.keywords={},this.nodeData={},this.requires={uv:[],color:[],lights:!1,fog:!1},this.includes={consts:[],functions:[],structs:[]},this.attributes={},this.prefixCode=["#ifdef TEXTURE_LOD_EXT","\t#define texCube(a, b) textureCube(a, b)","\t#define texCubeBias(a, b, c) textureCubeLodEXT(a, b, c)","\t#define tex2D(a, b) texture2D(a, b)","\t#define tex2DBias(a, b, c) texture2DLodEXT(a, b, c)","#else","\t#define texCube(a, b) textureCube(a, b)","\t#define texCubeBias(a, b, c) textureCube(a, b, c)","\t#define tex2D(a, b) texture2D(a, b)","\t#define tex2DBias(a, b, c) texture2D(a, b, c)","#endif","#include <packing>","#include <common>"].join("\n"),this.parsCode={vertex:"",fragment:""},this.code={vertex:"",fragment:""},this.nodeCode={vertex:"",fragment:""},this.resultCode={vertex:"",fragment:""},this.finalCode={vertex:"",fragment:""},this.inputs={uniforms:{list:[],vertex:[],fragment:[]},vars:{varying:[],vertex:[],fragment:[]}},this.defines={},this.uniforms={},this.extensions={},this.updaters=[],this.nodes=[],this.analyzing=!1}function BoolNode(s){InputNode.call(this,"b"),this.value=Boolean(s)}function IntNode(s){InputNode.call(this,"i"),this.value=Math.floor(s||0)}function ColorNode(s,e,a){InputNode.call(this,"c"),this.value=s instanceof Color?s:new Color(s||0,e,a)}function Matrix3Node(s){InputNode.call(this,"m3"),this.value=s||new Matrix3}function Matrix4Node(s){InputNode.call(this,"m4"),this.value=s||new Matrix4}function ScreenNode(s){TextureNode.call(this,void 0,s)}function ReflectorNode(s){TempNode.call(this,"v4"),s&&this.setMirror(s)}function PropertyNode(s,e,a){InputNode.call(this,a),this.object=s,this.property=e}function RawNode(s){Node.call(this,"v4"),this.value=s}function NodeMaterial(s,e){ShaderMaterial.call(this);var a=this;this.vertex=s||new RawNode(new PositionNode(PositionNode.PROJECTION)),this.fragment=e||new RawNode(new ColorNode(16711680)),this.updaters=[],this.onBeforeCompile=function(d,v){var g=v.properties.get(this);this.version!==g.__version&&(this.build({renderer:v}),d.uniforms=this.uniforms,d.vertexShader=this.vertexShader,d.fragmentShader=this.fragmentShader)},this.onBeforeCompile.toString=function(){return a.needsCompile}}function RTTNode(s,e,a,d){d=d||{},this.input=a,this.clear=void 0===d.clear||d.clear,this.renderTarget=new WebGLRenderTarget(s,e,d),this.material=new NodeMaterial,this.camera=new OrthographicCamera(-1,1,1,-1,0,1),this.scene=new Scene,this.quad=new Mesh(new PlaneBufferGeometry(2,2),this.material),this.quad.frustumCulled=!1,this.scene.add(this.quad),this.render=!0,TextureNode.call(this,this.renderTarget.texture)}NodeBuilder.prototype={constructor:NodeBuilder,build:function(e,a){this.buildShader("vertex",e),this.buildShader("fragment",a);for(var d=0;d<this.requires.uv.length;d++)if(this.requires.uv[d]){var v=d>0?d+1:"";this.addVaryCode("varying vec2 vUv"+v+";"),d>0&&this.addVertexParsCode("attribute vec2 uv"+v+";"),this.addVertexFinalCode("vUv"+v+" = uv"+v+";")}return this.requires.color[0]&&(this.addVaryCode("varying vec4 vColor;"),this.addVertexParsCode("attribute vec4 color;"),this.addVertexFinalCode("vColor = color;")),this.requires.color[1]&&(this.addVaryCode("varying vec4 vColor2;"),this.addVertexParsCode("attribute vec4 color2;"),this.addVertexFinalCode("vColor2 = color2;")),this.requires.position&&(this.addVaryCode("varying vec3 vPosition;"),this.addVertexFinalCode("vPosition = transformed;")),this.requires.worldPosition&&(this.addVaryCode("varying vec3 vWPosition;"),this.addVertexFinalCode("vWPosition = ( modelMatrix * vec4( transformed, 1.0 ) ).xyz;")),this.requires.normal&&(this.addVaryCode("varying vec3 vObjectNormal;"),this.addVertexFinalCode("vObjectNormal = normal;")),this.requires.worldNormal&&(this.addVaryCode("varying vec3 vWNormal;"),this.addVertexFinalCode("vWNormal = inverseTransformDirection( transformedNormal, viewMatrix ).xyz;")),this},buildShader:function(e,a){this.resultCode[e]=a.build(this.setShader(e),"v4")},setMaterial:function(e,a){return this.material=e,this.renderer=a,this.requires.lights=e.lights,this.requires.fog=e.fog,this.mergeDefines(e.defines),this},addFlow:function(e,a,d){return this.addSlot(e).addCache(a).addContext(d)},removeFlow:function(){return this.removeSlot().removeCache().removeContext()},addCache:function(e){return this.cache=e||"",this.caches.push(this.cache),this},removeCache:function(){return this.caches.pop(),this.cache=this.caches[this.caches.length-1]||"",this},addContext:function(e){return this.context=Object.assign({},this.context,e),this.context.extra=this.context.extra||{},this.contexts.push(this.context),this},removeContext:function(){return this.contexts.pop(),this.context=this.contexts[this.contexts.length-1]||{},this},addSlot:function(e){return this.slot=e||"",this.slots.push(this.slot),this},removeSlot:function(){return this.slots.pop(),this.slot=this.slots[this.slots.length-1]||"",this},addVertexCode:function(e){this.addCode(e,"vertex")},addFragmentCode:function(e){this.addCode(e,"fragment")},addCode:function(e,a){this.code[a||this.shader]+=e+"\n"},addVertexNodeCode:function(e){this.addNodeCode(e,"vertex")},addFragmentNodeCode:function(e){this.addNodeCode(e,"fragment")},addNodeCode:function(e,a){this.nodeCode[a||this.shader]+=e+"\n"},clearNodeCode:function(e){var a=this.nodeCode[e=e||this.shader];return this.nodeCode[e]="",a},clearVertexNodeCode:function(){return this.clearNodeCode("vertex")},clearFragmentNodeCode:function(){return this.clearNodeCode("fragment")},addVertexFinalCode:function(e){this.addFinalCode(e,"vertex")},addFragmentFinalCode:function(e){this.addFinalCode(e,"fragment")},addFinalCode:function(e,a){this.finalCode[a||this.shader]+=e+"\n"},addVertexParsCode:function(e){this.addParsCode(e,"vertex")},addFragmentParsCode:function(e){this.addParsCode(e,"fragment")},addParsCode:function(e,a){this.parsCode[a||this.shader]+=e+"\n"},addVaryCode:function(e){this.addVertexParsCode(e),this.addFragmentParsCode(e)},isCache:function(e){return-1!==this.caches.indexOf(e)},isSlot:function(e){return-1!==this.slots.indexOf(e)},define:function(e,a){this.defines[e]=void 0===a?1:a},require:function(e){this.requires[e]=!0},isDefined:function(e){return void 0!==this.defines[e]},getVar:function(e,a,d,v,g,C){void 0===v&&(v="varying"),void 0===g&&(g="V"),void 0===C&&(C="");var w=this.getVars(v),_=w[e];return _||(w.push(_={name:d||"node"+g+w.length+(C?"_"+C:""),type:a}),w[e]=_),_},getTempVar:function(e,a,d,v){return this.getVar(e,a,d,this.shader,"T",v)},getAttribute:function(e,a){if(!this.attributes[e]){var d=this.getVar(e,a);this.addVertexParsCode("attribute "+a+" "+e+";"),this.addVertexFinalCode(d.name+" = "+e+";"),this.attributes[e]={varying:d,name:e,type:a}}return this.attributes[e]},getCode:function(e){return[this.prefixCode,this.parsCode[e],this.getVarListCode(this.getVars("varying"),"varying"),this.getVarListCode(this.inputs.uniforms[e],"uniform"),this.getIncludesCode("consts",e),this.getIncludesCode("structs",e),this.getIncludesCode("functions",e),"void main() {",this.getVarListCode(this.getVars(e)),this.code[e],this.resultCode[e],this.finalCode[e],"}"].join("\n")},getVarListCode:function(e,a){a=a||"";for(var d="",v=0,g=e.length;v<g;++v){var C=e[v],_=C.name,x=this.getFormatByType(C.type);if(void 0===x)throw new Error("Node pars "+x+" not found.");d+=a+" "+x+" "+_+";\n"}return d},getVars:function(e){return this.inputs.vars[e||this.shader]},getNodeData:function(e){var a=e.isNode?e.uuid:e;return this.nodeData[a]=this.nodeData[a]||{}},createUniform:function(e,a,d,v,g,C){var w=this.inputs.uniforms,x=new NodeUniform({type:a,name:v||"nodeU"+w.list.length+(C?"_"+C:""),node:d,needsUpdate:g});return w.list.push(x),w[e].push(x),w[e][x.name]=x,this.uniforms[x.name]=x,x},createVertexUniform:function(e,a,d,v,g){return this.createUniform("vertex",e,a,d,v,g)},createFragmentUniform:function(e,a,d,v,g){return this.createUniform("fragment",e,a,d,v,g)},include:function(e,a,d){var v;if(e="string"==typeof e?NodeLib.get(e):e,!1===this.context.include)return e.name;e instanceof FunctionNode?v=this.includes.functions:e instanceof ConstNode?v=this.includes.consts:e instanceof StructNode&&(v=this.includes.structs);var g=v[this.shader]=v[this.shader]||[];if(e){var C=g[e.name];if(C||(C=g[e.name]={node:e,deps:[]},g.push(C),C.src=e.build(this,"source")),e instanceof FunctionNode&&a&&g[a.name]&&-1==g[a.name].deps.indexOf(e)&&(g[a.name].deps.push(e),e.includes&&e.includes.length)){var w=0;do{this.include(e.includes[w++],a)}while(w<e.includes.length)}return d&&(C.src=d),e.name}throw new Error("Include not found.")},colorToVectorProperties:function(e){return e.replace("r","x").replace("g","y").replace("b","z").replace("a","w")},colorToVector:function(e){return e.replace(/c/g,"v3")},getIncludes:function(e,a){return this.includes[e][a||this.shader]},getIncludesCode:function(){function s(e,a){return e.deps.length-a.deps.length}return function(a,d){if(!(v=this.getIncludes(a,d)))return"";for(var g="",v=v.sort(s),C=0;C<v.length;C++)v[C].src&&(g+=v[C].src+"\n");return g}}(),getConstructorFromLength:function(e){return constructors[e-1]},isTypeMatrix:function(e){return/^m/.test(e)},getTypeLength:function(e){return"f"===e?1:parseInt(this.colorToVector(e).substr(1))},getTypeFromLength:function(e){return 1===e?"f":"v"+e},findNode:function(){for(var e=arguments,a=0;a<arguments.length;a++){var d=e[a];if(void 0!==d&&d.isNode)return d}},resolve:function(){for(var e=arguments,a=0;a<arguments.length;a++){var d=e[a];if(void 0!==d){if(d.isNode)return d;if(d.isTexture)switch(d.mapping){case CubeReflectionMapping:case CubeRefractionMapping:return new CubeTextureNode(d);case CubeUVReflectionMapping:case CubeUVRefractionMapping:return new TextureCubeNode(new TextureNode(d));default:return new TextureNode(d)}else{if(d.isVector2)return new Vector2Node(d);if(d.isVector3)return new Vector3Node(d);if(d.isVector4)return new Vector4Node(d)}}}},format:function(e,a,d){switch(this.colorToVector(d+" <- "+a)){case"f <- v2":case"f <- v3":case"f <- v4":return e+".x";case"f <- i":case"f <- b":return"float( "+e+" )";case"v2 <- f":return"vec2( "+e+" )";case"v2 <- v3":case"v2 <- v4":return e+".xy";case"v2 <- i":case"v2 <- b":case"v3 <- i":case"v3 <- b":return"vec2( float( "+e+" ) )";case"v3 <- f":return"vec3( "+e+" )";case"v3 <- v2":return"vec3( "+e+", 0.0 )";case"v3 <- v4":return e+".xyz";case"v4 <- f":return"vec4( "+e+" )";case"v4 <- v2":return"vec4( "+e+", 0.0, 1.0 )";case"v4 <- v3":return"vec4( "+e+", 1.0 )";case"v4 <- i":case"v4 <- b":return"vec4( float( "+e+" ) )";case"i <- f":case"i <- b":return"int( "+e+" )";case"i <- v2":case"i <- v3":case"i <- v4":return"int( "+e+".x )";case"b <- f":return"( "+e+" != 0.0 )";case"b <- v2":return"( "+e+" != vec2( 0.0 ) )";case"b <- v3":return"( "+e+" != vec3( 0.0 ) )";case"b <- v4":return"( "+e+" != vec4( 0.0 ) )";case"b <- i":return"( "+e+" != 0 )"}return e},getTypeByFormat:function(e){return convertFormatToType[e]||e},getFormatByType:function(e){return convertTypeToFormat[e]||e},getUuid:function(e,a){return(a=void 0===a||a)&&this.cache&&(e=this.cache+"-"+e),e},getElementByIndex:function(e){return elements[e]},getIndexByElement:function(e){return elements.indexOf(e)},isShader:function(e){return this.shader===e},setShader:function(e){return this.shader=e,this},mergeDefines:function(e){for(var a in e)this.defines[a]=e[a];return this.defines},mergeUniform:function(e){for(var a in e)this.uniforms[a]=e[a];return this.uniforms},getTextureEncodingFromMap:function(e){var a;return e?e.isTexture?a=e.encoding:e.isWebGLRenderTarget&&(console.warn("WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),a=e.texture.encoding):a=LinearEncoding,a===LinearEncoding&&this.context.gamma&&(a=GammaEncoding),a}},BoolNode.prototype=Object.create(InputNode.prototype),BoolNode.prototype.constructor=BoolNode,BoolNode.prototype.nodeType="Bool",BoolNode.prototype.generateReadonly=function(s,e,a,d){return s.format(this.value,d,e)},BoolNode.prototype.copy=function(s){return InputNode.prototype.copy.call(this,s),this.value=s.value,this},BoolNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).value=this.value,!0===this.readonly&&(e.readonly=!0)),e},IntNode.prototype=Object.create(InputNode.prototype),IntNode.prototype.constructor=IntNode,IntNode.prototype.nodeType="Int",IntNode.prototype.generateReadonly=function(s,e,a,d){return s.format(this.value,d,e)},IntNode.prototype.copy=function(s){return InputNode.prototype.copy.call(this,s),this.value=s.value,this},IntNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).value=this.value,!0===this.readonly&&(e.readonly=!0)),e},ColorNode.prototype=Object.create(InputNode.prototype),ColorNode.prototype.constructor=ColorNode,ColorNode.prototype.nodeType="Color",NodeUtils.addShortcuts(ColorNode.prototype,"value",["r","g","b"]),ColorNode.prototype.generateReadonly=function(s,e,a,d){return s.format("vec3( "+this.r+", "+this.g+", "+this.b+" )",d,e)},ColorNode.prototype.copy=function(s){return InputNode.prototype.copy.call(this,s),this.value.copy(s),this},ColorNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).r=this.r,e.g=this.g,e.b=this.b,!0===this.readonly&&(e.readonly=!0)),e},Matrix3Node.prototype=Object.create(InputNode.prototype),Matrix3Node.prototype.constructor=Matrix3Node,Matrix3Node.prototype.nodeType="Matrix3",Object.defineProperties(Matrix3Node.prototype,{elements:{set:function(e){this.value.elements=e},get:function(){return this.value.elements}}}),Matrix3Node.prototype.generateReadonly=function(s,e,a,d){return s.format("mat3( "+this.value.elements.join(", ")+" )",d,e)},Matrix3Node.prototype.copy=function(s){return InputNode.prototype.copy.call(this,s),this.value.fromArray(s.elements),this},Matrix3Node.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).elements=this.value.elements.concat()),e},Matrix4Node.prototype=Object.create(InputNode.prototype),Matrix4Node.prototype.constructor=Matrix4Node,Matrix4Node.prototype.nodeType="Matrix4",Object.defineProperties(Matrix4Node.prototype,{elements:{set:function(e){this.value.elements=e},get:function(){return this.value.elements}}}),Matrix4Node.prototype.generateReadonly=function(s,e,a,d){return s.format("mat4( "+this.value.elements.join(", ")+" )",d,e)},Matrix4Node.prototype.copy=function(s){return InputNode.prototype.copy.call(this,s),this.scope.value.fromArray(s.elements),this},Matrix4Node.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).elements=this.value.elements.concat()),e},ScreenNode.prototype=Object.create(TextureNode.prototype),ScreenNode.prototype.constructor=ScreenNode,ScreenNode.prototype.nodeType="Screen",ScreenNode.prototype.getUnique=function(){return!0},ScreenNode.prototype.getTexture=function(s,e){return InputNode.prototype.generate.call(this,s,e,this.getUuid(),"t","renderTexture")},ReflectorNode.prototype=Object.create(TempNode.prototype),ReflectorNode.prototype.constructor=ReflectorNode,ReflectorNode.prototype.nodeType="Reflector",ReflectorNode.prototype.setMirror=function(s){this.mirror=s,this.textureMatrix=new Matrix4Node(this.mirror.material.uniforms.textureMatrix.value),this.localPosition=new PositionNode(PositionNode.LOCAL),this.uv=new OperatorNode(this.textureMatrix,this.localPosition,OperatorNode.MUL),this.uvResult=new OperatorNode(null,this.uv,OperatorNode.ADD),this.texture=new TextureNode(this.mirror.material.uniforms.tDiffuse.value,this.uv,null,!0)},ReflectorNode.prototype.generate=function(s,e){return s.isShader("fragment")?(this.uvResult.a=this.offset,this.texture.uv=this.offset?this.uvResult:this.uv,"sampler2D"===e?this.texture.build(s,e):s.format(this.texture.build(s,this.type),this.type,e)):(console.warn("ReflectorNode is not compatible with "+s.shader+" shader."),s.format("vec4( 0.0 )",this.type,e))},ReflectorNode.prototype.copy=function(s){return InputNode.prototype.copy.call(this,s),this.scope.mirror=s.mirror,this},ReflectorNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).mirror=this.mirror.uuid,this.offset&&(e.offset=this.offset.toJSON(s).uuid)),e},PropertyNode.prototype=Object.create(InputNode.prototype),PropertyNode.prototype.constructor=PropertyNode,PropertyNode.prototype.nodeType="Property",Object.defineProperties(PropertyNode.prototype,{value:{get:function(){return this.object[this.property]},set:function(e){this.object[this.property]=e}}}),PropertyNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).value=this.value,e.property=this.property),e},RawNode.prototype=Object.create(Node.prototype),RawNode.prototype.constructor=RawNode,RawNode.prototype.nodeType="Raw",RawNode.prototype.generate=function(s){var e=this.value.analyzeAndFlow(s,this.type),a=e.code+"\n";return s.isShader("vertex")?a+="gl_Position = "+e.result+";":a+="gl_FragColor = "+e.result+";",a},RawNode.prototype.copy=function(s){return Node.prototype.copy.call(this,s),this.value=s.value,this},RawNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).value=this.value.toJSON(s).uuid),e},NodeMaterial.prototype=Object.create(ShaderMaterial.prototype),NodeMaterial.prototype.constructor=NodeMaterial,NodeMaterial.prototype.type="NodeMaterial",NodeMaterial.prototype.isNodeMaterial=!0,Object.defineProperties(NodeMaterial.prototype,{properties:{get:function(){return this.fragment.properties}},needsUpdate:{set:function(e){!0===e&&this.version++,this.needsCompile=e},get:function(){return this.needsCompile}}}),NodeMaterial.prototype.updateFrame=function(s){for(var e=0;e<this.updaters.length;++e)s.updateNode(this.updaters[e])},NodeMaterial.prototype.build=function(s){var e=(s=s||{}).builder||new NodeBuilder;return e.setMaterial(this,s.renderer),e.build(this.vertex,this.fragment),this.vertexShader=e.getCode("vertex"),this.fragmentShader=e.getCode("fragment"),this.defines=e.defines,this.uniforms=e.uniforms,this.extensions=e.extensions,this.updaters=e.updaters,this.fog=e.requires.fog,this.lights=e.requires.lights,this.transparent=e.requires.transparent||this.blending>NormalBlending,this},NodeMaterial.prototype.copy=function(s){var e=this.uuid;for(var a in s)this[a]=s[a];return this.uuid=e,void 0!==s.userData&&(this.userData=JSON.parse(JSON.stringify(s.userData))),this},NodeMaterial.prototype.toJSON=function(s){if((void 0===s||"string"==typeof s)&&(s={nodes:{}}),s&&!s.materials&&(s.materials={}),!s.materials[this.uuid]){var a={};a.uuid=this.uuid,a.type=this.type,s.materials[a.uuid]=a,""!==this.name&&(a.name=this.name),void 0!==this.size&&(a.size=this.size),void 0!==this.sizeAttenuation&&(a.sizeAttenuation=this.sizeAttenuation),this.blending!==NormalBlending&&(a.blending=this.blending),!0===this.flatShading&&(a.flatShading=this.flatShading),this.side!==FrontSide&&(a.side=this.side),this.vertexColors!==NoColors&&(a.vertexColors=this.vertexColors),this.depthFunc!==LessEqualDepth&&(a.depthFunc=this.depthFunc),!1===this.depthTest&&(a.depthTest=this.depthTest),!1===this.depthWrite&&(a.depthWrite=this.depthWrite),1!==this.linewidth&&(a.linewidth=this.linewidth),void 0!==this.dashSize&&(a.dashSize=this.dashSize),void 0!==this.gapSize&&(a.gapSize=this.gapSize),void 0!==this.scale&&(a.scale=this.scale),!0===this.dithering&&(a.dithering=!0),!0===this.wireframe&&(a.wireframe=this.wireframe),this.wireframeLinewidth>1&&(a.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(a.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(a.wireframeLinejoin=this.wireframeLinejoin),this.alphaTest>0&&(a.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(a.premultipliedAlpha=this.premultipliedAlpha),!0===this.morphTargets&&(a.morphTargets=!0),!0===this.skinning&&(a.skinning=!0),!1===this.visible&&(a.visible=!1),"{}"!==JSON.stringify(this.userData)&&(a.userData=this.userData),a.fog=this.fog,a.lights=this.lights,a.vertex=this.vertex.toJSON(s).uuid,a.fragment=this.fragment.toJSON(s).uuid}return s.material=this.uuid,s},RTTNode.prototype=Object.create(TextureNode.prototype),RTTNode.prototype.constructor=RTTNode,RTTNode.prototype.nodeType="RTT",RTTNode.prototype.build=function(s,e,a){var d=new NodeBuilder;return d.nodes=s.nodes,d.updaters=s.updaters,this.material.fragment.value=this.input,this.material.build({builder:d}),TextureNode.prototype.build.call(this,s,e,a)},RTTNode.prototype.updateFramesaveTo=function(s){if(this.saveTo.render=!1,this.saveTo!==this.saveToCurrent){this.saveToMaterial&&this.saveToMaterial.dispose();var e=new NodeMaterial;e.fragment.value=this,e.build();var a=new Scene,d=new Mesh(new PlaneBufferGeometry(2,2),e);d.frustumCulled=!1,a.add(d),this.saveToScene=a,this.saveToMaterial=e}this.saveToCurrent=this.saveTo,s.renderer.setRenderTarget(this.saveTo.renderTarget),this.saveTo.clear&&s.renderer.clear(),s.renderer.render(this.saveToScene,this.camera)},RTTNode.prototype.updateFrame=function(s){s.renderer?(this.saveTo&&!1===this.saveTo.render&&this.updateFramesaveTo(s),this.render&&(this.material.uniforms.renderTexture&&(this.material.uniforms.renderTexture.value=s.renderTexture),s.renderer.setRenderTarget(this.renderTarget),this.clear&&s.renderer.clear(),s.renderer.render(this.scene,this.camera)),this.saveTo&&!0===this.saveTo.render&&this.updateFramesaveTo(s)):console.warn("RTTNode need a renderer in NodeFrame")},RTTNode.prototype.copy=function(s){return TextureNode.prototype.copy.call(this,s),this.saveTo=s.saveTo,this},RTTNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||(e=TextureNode.prototype.toJSON.call(this,s),this.saveTo&&(e.saveTo=this.saveTo.toJSON(s).uuid)),e};var vertexDict=["color","color2"],fragmentDict=["vColor","vColor2"];function ColorsNode(s){TempNode.call(this,"v4",{shared:!1}),this.index=s||0}function CameraNode(s,e){TempNode.call(this,"v3"),this.setScope(s||CameraNode.POSITION),this.setCamera(e)}function LightNode(s){TempNode.call(this,"v3",{shared:!1}),this.scope=s||LightNode.TOTAL}function ResolutionNode(){Vector2Node.call(this),this.size=new Vector2}function ScreenUVNode(s){TempNode.call(this,"v2"),this.resolution=s||new ResolutionNode}function CondNode(s,e,a,d,v){TempNode.call(this),this.a=s,this.b=e,this.op=a,this.ifNode=d,this.elseNode=v}function NoiseNode(s){TempNode.call(this,"f"),this.uv=s||new UVNode}function CheckerNode(s){TempNode.call(this,"f"),this.uv=s||new UVNode}function NormalMapNode(s,e){TempNode.call(this,"v3"),this.value=s,this.scale=e||new Vector2Node(1,1)}function BumpMapNode(s,e){TempNode.call(this,"v3"),this.value=s,this.scale=e||new FloatNode(1),this.toNormalMap=!1}function BypassNode(s,e){Node.call(this),this.code=s,this.value=e}ColorsNode.prototype=Object.create(TempNode.prototype),ColorsNode.prototype.constructor=ColorsNode,ColorsNode.prototype.nodeType="Colors",ColorsNode.prototype.generate=function(s,e){s.requires.color[this.index]=!0;var a=s.isShader("vertex")?vertexDict[this.index]:fragmentDict[this.index];return s.format(a,this.getType(s),e)},ColorsNode.prototype.copy=function(s){return TempNode.prototype.copy.call(this,s),this.index=s.index,this},ColorsNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).index=this.index),e},CameraNode.Nodes={depthColor:new FunctionNode(["float depthColor( float mNear, float mFar ) {","\t#ifdef USE_LOGDEPTHBUF_EXT","\t\tfloat depth = gl_FragDepthEXT / gl_FragCoord.w;","\t#else","\t\tfloat depth = gl_FragCoord.z / gl_FragCoord.w;","\t#endif","\treturn 1.0 - smoothstep( mNear, mFar, depth );","}"].join("\n"))},CameraNode.POSITION="position",CameraNode.DEPTH="depth",CameraNode.TO_VERTEX="toVertex",CameraNode.prototype=Object.create(TempNode.prototype),CameraNode.prototype.constructor=CameraNode,CameraNode.prototype.nodeType="Camera",CameraNode.prototype.setCamera=function(s){this.camera=s,this.updateFrame=void 0!==s?this.onUpdateFrame:void 0},CameraNode.prototype.setScope=function(s){if(this.scope===CameraNode.DEPTH&&(delete this.near,delete this.far),this.scope=s,s===CameraNode.DEPTH){var e=this.camera;this.near=new FloatNode(e?e.near:1),this.far=new FloatNode(e?e.far:1200)}},CameraNode.prototype.getType=function(){return this.scope===CameraNode.DEPTH?"f":this.type},CameraNode.prototype.getUnique=function(){switch(this.scope){case CameraNode.DEPTH:case CameraNode.TO_VERTEX:return!0}return!1},CameraNode.prototype.getShared=function(){return this.scope!==CameraNode.POSITION},CameraNode.prototype.generate=function(s,e){var a;switch(this.scope){case CameraNode.POSITION:a="cameraPosition";break;case CameraNode.DEPTH:a=s.include(CameraNode.Nodes.depthColor)+"( "+this.near.build(s,"f")+", "+this.far.build(s,"f")+" )";break;case CameraNode.TO_VERTEX:a="normalize( "+new PositionNode(PositionNode.WORLD).build(s,"v3")+" - cameraPosition )"}return s.format(a,this.getType(s),e)},CameraNode.prototype.onUpdateFrame=function(){if(this.scope===CameraNode.DEPTH){var s=this.camera;this.near.value=s.near,this.far.value=s.far}},CameraNode.prototype.copy=function(s){return TempNode.prototype.copy.call(this,s),this.setScope(s.scope),s.camera&&this.setCamera(s.camera),s.scope===CameraNode.DEPTH&&(this.near.number=s.near,this.far.number=s.far),this},CameraNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).scope=this.scope,this.camera&&(e.camera=this.camera.uuid),this.scope!==CameraNode.DEPTH)||(e.near=this.near.value,e.far=this.far.value),e},LightNode.TOTAL="total",LightNode.prototype=Object.create(TempNode.prototype),LightNode.prototype.constructor=LightNode,LightNode.prototype.nodeType="Light",LightNode.prototype.generate=function(s,e){return s.isCache("light")?s.format("reflectedLight.directDiffuse",this.type,e):(console.warn('LightNode is only compatible in "light" channel.'),s.format("vec3( 0.0 )",this.type,e))},LightNode.prototype.copy=function(s){return TempNode.prototype.copy.call(this,s),this.scope=s.scope,this},LightNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).scope=this.scope),e},ResolutionNode.prototype=Object.create(Vector2Node.prototype),ResolutionNode.prototype.constructor=ResolutionNode,ResolutionNode.prototype.nodeType="Resolution",ResolutionNode.prototype.updateFrame=function(s){if(s.renderer){s.renderer.getSize(this.size);var e=s.renderer.getPixelRatio();this.x=this.size.width*e,this.y=this.size.height*e}else console.warn("ResolutionNode need a renderer in NodeFrame")},ResolutionNode.prototype.copy=function(s){return Vector2Node.prototype.copy.call(this,s),this.renderer=s.renderer,this},ResolutionNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).renderer=this.renderer.uuid),e},ScreenUVNode.prototype=Object.create(TempNode.prototype),ScreenUVNode.prototype.constructor=ScreenUVNode,ScreenUVNode.prototype.nodeType="ScreenUV",ScreenUVNode.prototype.generate=function(s,e){var a;return s.isShader("fragment")?a="( gl_FragCoord.xy / "+this.resolution.build(s,"v2")+")":(console.warn("ScreenUVNode is not compatible with "+s.shader+" shader."),a="vec2( 0.0 )"),s.format(a,this.getType(s),e)},ScreenUVNode.prototype.copy=function(s){return TempNode.prototype.copy.call(this,s),this.resolution=s.resolution,this},ScreenUVNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).resolution=this.resolution.toJSON(s).uuid),e},CondNode.EQUAL="==",CondNode.NOT_EQUAL="!=",CondNode.GREATER=">",CondNode.GREATER_EQUAL=">=",CondNode.LESS="<",CondNode.LESS_EQUAL="<=",CondNode.prototype=Object.create(TempNode.prototype),CondNode.prototype.constructor=CondNode,CondNode.prototype.nodeType="Cond",CondNode.prototype.getType=function(s){if(this.ifNode){var e=this.ifNode.getType(s),a=this.elseNode.getType(s);return s.getTypeLength(a)>s.getTypeLength(e)?a:e}return"b"},CondNode.prototype.getCondType=function(s){return s.getTypeLength(this.b.getType(s))>s.getTypeLength(this.a.getType(s))?this.b.getType(s):this.a.getType(s)},CondNode.prototype.generate=function(s,e){var C,a=this.getType(s),d=this.getCondType(s),v=this.a.build(s,d),g=this.b.build(s,d);if(this.ifNode){var w=this.ifNode.build(s,a),_=this.elseNode.build(s,a);C="( "+[v,this.op,g,"?",w,":",_].join(" ")+" )"}else C="( "+v+" "+this.op+" "+g+" )";return s.format(C,this.getType(s),e)},CondNode.prototype.copy=function(s){return TempNode.prototype.copy.call(this,s),this.a=s.a,this.b=s.b,this.op=s.op,this.ifNode=s.ifNode,this.elseNode=s.elseNode,this},CondNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).a=this.a.toJSON(s).uuid,e.b=this.b.toJSON(s).uuid,e.op=this.op,e.ifNode&&(e.ifNode=this.ifNode.toJSON(s).uuid),e.elseNode&&(e.elseNode=this.elseNode.toJSON(s).uuid)),e},NoiseNode.prototype=Object.create(TempNode.prototype),NoiseNode.prototype.constructor=NoiseNode,NoiseNode.prototype.nodeType="Noise",NoiseNode.Nodes={snoise:new FunctionNode(["float snoise(vec2 co) {","\treturn fract( sin( dot( co.xy, vec2( 12.9898, 78.233 ) ) ) * 43758.5453 );","}"].join("\n"))},NoiseNode.prototype.generate=function(s,e){var a=s.include(NoiseNode.Nodes.snoise);return s.format(a+"( "+this.uv.build(s,"v2")+" )",this.getType(s),e)},NoiseNode.prototype.copy=function(s){return TempNode.prototype.copy.call(this,s),this.uv=s.uv,this},NoiseNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).uv=this.uv.toJSON(s).uuid),e},CheckerNode.prototype=Object.create(TempNode.prototype),CheckerNode.prototype.constructor=CheckerNode,CheckerNode.prototype.nodeType="Noise",CheckerNode.Nodes={checker:new FunctionNode(["float checker( vec2 uv ) {","\tfloat cx = floor( uv.x );","\tfloat cy = floor( uv.y ); ","\tfloat result = mod( cx + cy, 2.0 );","\treturn sign( result );","}"].join("\n"))},CheckerNode.prototype.generate=function(s,e){var a=s.include(CheckerNode.Nodes.checker);return s.format(a+"( "+this.uv.build(s,"v2")+" )",this.getType(s),e)},CheckerNode.prototype.copy=function(s){return TempNode.prototype.copy.call(this,s),this.uv=s.uv,this},CheckerNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).uv=this.uv.toJSON(s).uuid),e},NormalMapNode.Nodes={perturbNormal2Arb:new FunctionNode("vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 map, vec2 vUv, vec2 normalScale ) {\n\n\t\t// Workaround for Adreno 3XX dFd*( vec3 ) bug. See #9988\n\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s ); // we do not care about the magnitude\n\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\n\t\tvec3 mapN = map * 2.0 - 1.0;\n\n\t\tmapN.xy *= normalScale;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\t// Workaround for Adreno GPUs gl_FrontFacing bug. See #15850 and #10331\n\n\t\t\tif ( dot( cross( S, T ), N ) < 0.0 ) mapN.xy *= - 1.0;\n\n\t\t#else\n\n\t\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t\t#endif\n\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\n\t}",null,{derivatives:!0})},NormalMapNode.prototype=Object.create(TempNode.prototype),NormalMapNode.prototype.constructor=NormalMapNode,NormalMapNode.prototype.nodeType="NormalMap",NormalMapNode.prototype.generate=function(s,e){if(s.isShader("fragment")){var a=s.include(NormalMapNode.Nodes.perturbNormal2Arb);this.normal=this.normal||new NormalNode,this.position=this.position||new PositionNode(PositionNode.VIEW),this.uv=this.uv||new UVNode;var d=this.scale.build(s,"v2");return s.material.side===BackSide&&(d="-"+d),s.format(a+"( -"+this.position.build(s,"v3")+", "+this.normal.build(s,"v3")+", "+this.value.build(s,"v3")+", "+this.uv.build(s,"v2")+", "+d+" )",this.getType(s),e)}return console.warn("NormalMapNode is not compatible with "+s.shader+" shader."),s.format("vec3( 0.0 )",this.getType(s),e)},NormalMapNode.prototype.copy=function(s){return TempNode.prototype.copy.call(this,s),this.value=s.value,this.scale=s.scale,this},NormalMapNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).value=this.value.toJSON(s).uuid,e.scale=this.scale.toJSON(s).uuid),e},BumpMapNode.Nodes=function(){var s=new FunctionNode(["vec2 dHdxy_fwd( sampler2D bumpMap, vec2 vUv, float bumpScale ) {","\tvec2 dSTdx = dFdx( vUv );","\tvec2 dSTdy = dFdy( vUv );","\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;","\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;","\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;","\treturn vec2( dBx, dBy );","}"].join("\n"),null,{derivatives:!0});return{dHdxy_fwd:s,perturbNormalArb:new FunctionNode(["vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {","\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );","\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );","\tvec3 vN = surf_norm;","\tvec3 R1 = cross( vSigmaY, vN );","\tvec3 R2 = cross( vN, vSigmaX );","\tfloat fDet = dot( vSigmaX, R1 );","\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );","\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );","\treturn normalize( abs( fDet ) * surf_norm - vGrad );","}"].join("\n"),[s],{derivatives:!0}),bumpToNormal:new FunctionNode(["vec3 bumpToNormal( sampler2D bumpMap, vec2 uv, float scale ) {","\tvec2 dSTdx = dFdx( uv );","\tvec2 dSTdy = dFdy( uv );","\tfloat Hll = texture2D( bumpMap, uv ).x;","\tfloat dBx = texture2D( bumpMap, uv + dSTdx ).x - Hll;","\tfloat dBy = texture2D( bumpMap, uv + dSTdy ).x - Hll;","\treturn vec3( .5 - ( dBx * scale ), .5 - ( dBy * scale ), 1.0 );","}"].join("\n"),null,{derivatives:!0})}}(),BumpMapNode.prototype=Object.create(TempNode.prototype),BumpMapNode.prototype.constructor=BumpMapNode,BumpMapNode.prototype.nodeType="BumpMap",BumpMapNode.prototype.generate=function(s,e){if(s.isShader("fragment")){if(this.toNormalMap){var a=s.include(BumpMapNode.Nodes.bumpToNormal);return s.format(a+"( "+this.value.build(s,"sampler2D")+", "+this.value.uv.build(s,"v2")+", "+this.scale.build(s,"f")+" )",this.getType(s),e)}var d=s.include(BumpMapNode.Nodes.dHdxy_fwd),v=s.include(BumpMapNode.Nodes.perturbNormalArb);this.normal=this.normal||new NormalNode,this.position=this.position||new PositionNode(PositionNode.VIEW);var g=d+"( "+this.value.build(s,"sampler2D")+", "+this.value.uv.build(s,"v2")+", "+this.scale.build(s,"f")+" )";return s.format(v+"( -"+this.position.build(s,"v3")+", "+this.normal.build(s,"v3")+", "+g+" )",this.getType(s),e)}return console.warn("BumpMapNode is not compatible with "+s.shader+" shader."),s.format("vec3( 0.0 )",this.getType(s),e)},BumpMapNode.prototype.copy=function(s){return TempNode.prototype.copy.call(this,s),this.value=s.value,this.scale=s.scale,this},BumpMapNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).value=this.value.toJSON(s).uuid,e.scale=this.scale.toJSON(s).uuid),e},BypassNode.prototype=Object.create(Node.prototype),BypassNode.prototype.constructor=BypassNode,BypassNode.prototype.nodeType="Bypass",BypassNode.prototype.getType=function(s){return this.value?this.value.getType(s):s.isShader("fragment")?"f":"void"},BypassNode.prototype.generate=function(s,e){var a=this.code.build(s,e)+";";return s.addNodeCode(a),s.isShader("vertex")?this.value?this.value.build(s,e):void 0:this.value?this.value.build(s,e):s.format("0.0","f",e)},BypassNode.prototype.copy=function(s){return Node.prototype.copy.call(this,s),this.code=s.code,this.value=s.value,this},BypassNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).code=this.code.toJSON(s).uuid,this.value&&(e.value=this.value.toJSON(s).uuid)),e};var inputs=NodeUtils.elements;function JoinNode(s,e,a,d){TempNode.call(this,"f"),this.x=s,this.y=e,this.z=a,this.w=d}function SwitchNode(s,e){Node.call(this),this.node=s,this.components=e||"x"}function TimerNode(s,e,a){FloatNode.call(this),this.scale=void 0!==s?s:1,this.scope=e||TimerNode.GLOBAL,this.timeScale=void 0!==a?a:void 0!==s}function VelocityNode(s,e){Vector3Node.call(this),this.params={},this.velocity=new Vector3,this.setTarget(s),this.setParams(e)}function UVTransformNode(s,e){ExpressionNode.call(this,"( uvTransform * vec3( uvNode, 1 ) ).xy","vec2"),this.uv=s||new UVNode,this.position=e||new Matrix3Node}function MaxMIPLevelNode(s){FloatNode.call(this),this.texture=s,this.maxMIPLevel=0}function SpecularMIPLevelNode(s,e){TempNode.call(this,"f"),this.roughness=s,this.texture=e,this.maxMIPLevel=void 0}function SubSlotNode(s){TempNode.call(this),this.slots=s||{}}function BlurNode(s,e,a,d){TempNode.call(this,"v4"),this.value=s,this.uv=e||new UVNode,this.radius=a||new Vector2Node(1,1),this.size=d,this.blurX=!0,this.blurY=!0,this.horizontal=new FloatNode(1/64),this.vertical=new FloatNode(1/64)}function LuminanceNode(s){TempNode.call(this,"f"),this.rgb=s}function ColorAdjustmentNode(s,e,a){TempNode.call(this,"v3"),this.rgb=s,this.adjustment=e,this.method=a||ColorAdjustmentNode.SATURATION}function SpriteNode(){Node.call(this),this.color=new ColorNode(15658734),this.spherical=!0}function PhongNode(){Node.call(this),this.color=new ColorNode(15658734),this.specular=new ColorNode(1118481),this.shininess=new FloatNode(30)}function StandardNode(){Node.call(this),this.color=new ColorNode(16777215),this.roughness=new FloatNode(1),this.metalness=new FloatNode(0)}function MeshStandardNode(){StandardNode.call(this),this.properties={color:new Color(16777215),roughness:.5,metalness:.5,normalScale:new Vector2(1,1)},this.inputs={color:new PropertyNode(this.properties,"color","c"),roughness:new PropertyNode(this.properties,"roughness","f"),metalness:new PropertyNode(this.properties,"metalness","f"),normalScale:new PropertyNode(this.properties,"normalScale","v2")}}function SpriteNodeMaterial(){var s=new SpriteNode;NodeMaterial.call(this,s,s),this.type="SpriteNodeMaterial"}function PhongNodeMaterial(){var s=new PhongNode;NodeMaterial.call(this,s,s),this.type="PhongNodeMaterial"}function StandardNodeMaterial(){var s=new StandardNode;NodeMaterial.call(this,s,s),this.type="StandardNodeMaterial"}function MeshStandardNodeMaterial(){var s=new MeshStandardNode;NodeMaterial.call(this,s,s),this.type="MeshStandardNodeMaterial"}function NodePostProcessing(s,e){if(void 0===e){var a={minFilter:LinearFilter,magFilter:LinearFilter,format:RGBAFormat,stencilBuffer:!1},d=s.getDrawingBufferSize(new Vector2);e=new WebGLRenderTarget(d.width,d.height,a)}this.renderer=s,this.renderTarget=e,this.output=new ScreenNode,this.material=new NodeMaterial,this.camera=new OrthographicCamera(-1,1,1,-1,0,1),this.scene=new Scene,this.quad=new Mesh(new PlaneBufferGeometry(2,2),this.material),this.quad.frustumCulled=!1,this.scene.add(this.quad),this.needsUpdate=!0}JoinNode.prototype=Object.create(TempNode.prototype),JoinNode.prototype.constructor=JoinNode,JoinNode.prototype.nodeType="Join",JoinNode.prototype.getNumElements=function(){for(var s=inputs.length;s--;)if(void 0!==this[inputs[s]]){++s;break}return Math.max(s,2)},JoinNode.prototype.getType=function(s){return s.getTypeFromLength(this.getNumElements())},JoinNode.prototype.generate=function(s,e){for(var a=this.getType(s),d=this.getNumElements(),v=[],g=0;g<d;g++){var C=this[inputs[g]];v.push(C?C.build(s,"f"):"0.0")}var w=(d>1?s.getConstructorFromLength(d):"")+"( "+v.join(", ")+" )";return s.format(w,a,e)},JoinNode.prototype.copy=function(s){for(var e in TempNode.prototype.copy.call(this,s),s.inputs)this[e]=s.inputs[e];return this},JoinNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);if(!e){(e=this.createJSONNode(s)).inputs={};for(var a=this.getNumElements(),d=0;d<a;d++){var v=this[inputs[d]];v&&(e.inputs[inputs[d]]=v.toJSON(s).uuid)}}return e},SwitchNode.prototype=Object.create(Node.prototype),SwitchNode.prototype.constructor=SwitchNode,SwitchNode.prototype.nodeType="Switch",SwitchNode.prototype.getType=function(s){return s.getTypeFromLength(this.components.length)},SwitchNode.prototype.generate=function(s,e){var a=this.node.getType(s),d=this.node.build(s,a),v=s.getTypeLength(a)-1;if(v>0){var w,g=0,C=s.colorToVectorProperties(this.components),_=C.length;for(w=0;w<_;w++)g=Math.max(g,s.getIndexByElement(C.charAt(w)));for(g>v&&(g=v),d+=".",w=0;w<_;w++){C.charAt(w);var b=s.getIndexByElement(C.charAt(w));b>g&&(b=g),d+=s.getElementByIndex(b)}return s.format(d,this.getType(s),e)}return s.format(d,a,e)},SwitchNode.prototype.copy=function(s){return Node.prototype.copy.call(this,s),this.node=s.node,this.components=s.components,this},SwitchNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).node=this.node.toJSON(s).uuid,e.components=this.components),e},TimerNode.GLOBAL="global",TimerNode.LOCAL="local",TimerNode.DELTA="delta",TimerNode.prototype=Object.create(FloatNode.prototype),TimerNode.prototype.constructor=TimerNode,TimerNode.prototype.nodeType="Timer",TimerNode.prototype.getReadonly=function(){return!1},TimerNode.prototype.getUnique=function(){return this.timeScale&&(this.scope===TimerNode.GLOBAL||this.scope===TimerNode.DELTA)},TimerNode.prototype.updateFrame=function(s){var e=this.timeScale?this.scale:1;switch(this.scope){case TimerNode.LOCAL:this.value+=s.delta*e;break;case TimerNode.DELTA:this.value=s.delta*e;break;default:this.value=s.time*e}},TimerNode.prototype.copy=function(s){return FloatNode.prototype.copy.call(this,s),this.scope=s.scope,this.scale=s.scale,this.timeScale=s.timeScale,this},TimerNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).scope=this.scope,e.scale=this.scale,e.timeScale=this.timeScale),e},NodeLib.addKeyword("time",function(){return new TimerNode}),VelocityNode.prototype=Object.create(Vector3Node.prototype),VelocityNode.prototype.constructor=VelocityNode,VelocityNode.prototype.nodeType="Velocity",VelocityNode.prototype.getReadonly=function(){return!1},VelocityNode.prototype.setParams=function(s){"elastic"===this.params.type&&(delete this.moment,delete this.speed,delete this.springVelocity,delete this.lastVelocity),"elastic"===(this.params=s||{},this.params.type)&&(this.moment=new Vector3,this.speed=new Vector3,this.springVelocity=new Vector3,this.lastVelocity=new Vector3)},VelocityNode.prototype.setTarget=function(s){this.target&&(delete this.position,delete this.oldPosition),this.target=s,s&&(this.position=s.getWorldPosition(this.position||new Vector3),this.oldPosition=this.position.clone())},VelocityNode.prototype.updateFrameVelocity=function(){this.target&&(this.position=this.target.getWorldPosition(this.position||new Vector3),this.velocity.subVectors(this.position,this.oldPosition),this.oldPosition.copy(this.position))},VelocityNode.prototype.updateFrame=function(s){if("elastic"===(this.updateFrameVelocity(s),this.params.type)){var e=s.delta*(this.params.fps||60),a=Math.pow(this.params.spring,e),d=Math.pow(this.params.damping,e);this.velocity.multiplyScalar(Math.exp(-this.params.damping*e)),this.velocity.add(this.springVelocity),this.velocity.add(this.speed.multiplyScalar(d).multiplyScalar(1-a)),this.speed.subVectors(this.velocity,this.lastVelocity),this.springVelocity.add(this.speed),this.springVelocity.multiplyScalar(a),this.moment.add(this.springVelocity),this.moment.multiplyScalar(d),this.lastVelocity.copy(this.velocity),this.value.copy(this.moment)}else this.value.copy(this.velocity)},VelocityNode.prototype.copy=function(s){return Vector3Node.prototype.copy.call(this,s),s.target&&this.setTarget(s.target),this.setParams(s.params),this},VelocityNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||(e=this.createJSONNode(s),this.target&&(e.target=this.target.uuid),e.params=JSON.parse(JSON.stringify(this.params))),e},UVTransformNode.prototype=Object.create(ExpressionNode.prototype),UVTransformNode.prototype.constructor=UVTransformNode,UVTransformNode.prototype.nodeType="UVTransform",UVTransformNode.prototype.generate=function(s,e){return this.keywords.uvNode=this.uv,this.keywords.uvTransform=this.position,ExpressionNode.prototype.generate.call(this,s,e)},UVTransformNode.prototype.setUvTransform=function(s,e,a,d,v,g,C){this.position.value.setUvTransform(s,e,a,d,v,g=void 0!==g?g:.5,C=void 0!==C?C:.5)},UVTransformNode.prototype.copy=function(s){return ExpressionNode.prototype.copy.call(this,s),this.uv=s.uv,this.position=s.position,this},UVTransformNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).uv=this.uv.toJSON(s).uuid,e.position=this.position.toJSON(s).uuid),e},MaxMIPLevelNode.prototype=Object.create(FloatNode.prototype),MaxMIPLevelNode.prototype.constructor=MaxMIPLevelNode,MaxMIPLevelNode.prototype.nodeType="MaxMIPLevel",Object.defineProperties(MaxMIPLevelNode.prototype,{value:{get:function(){if(0===this.maxMIPLevel){var e=this.texture.value.image;Array.isArray(e)&&(e=e[0]),this.maxMIPLevel=void 0!==e?Math.log(Math.max(e.width,e.height))*Math.LOG2E:0}return this.maxMIPLevel},set:function(){}}}),MaxMIPLevelNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).texture=this.texture.uuid),e},SpecularMIPLevelNode.Nodes={getSpecularMIPLevel:new FunctionNode(["float getSpecularMIPLevel( const in float roughness, const in float maxMIPLevelScalar ) {","\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );","\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );","\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );","}"].join("\n"))},SpecularMIPLevelNode.prototype=Object.create(TempNode.prototype),SpecularMIPLevelNode.prototype.constructor=SpecularMIPLevelNode,SpecularMIPLevelNode.prototype.nodeType="SpecularMIPLevel",SpecularMIPLevelNode.prototype.setTexture=function(s){return this.texture=s,this},SpecularMIPLevelNode.prototype.generate=function(s,e){if(s.isShader("fragment")){this.maxMIPLevel=this.maxMIPLevel||new MaxMIPLevelNode,this.maxMIPLevel.texture=this.texture;var a=s.include(SpecularMIPLevelNode.Nodes.getSpecularMIPLevel);return s.format(a+"( "+this.roughness.build(s,"f")+", "+this.maxMIPLevel.build(s,"f")+" )",this.type,e)}return console.warn("SpecularMIPLevelNode is not compatible with "+s.shader+" shader."),s.format("0.0",this.type,e)},SpecularMIPLevelNode.prototype.copy=function(s){return TempNode.prototype.copy.call(this,s),this.texture=s.texture,this.roughness=s.roughness,this},SpecularMIPLevelNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).texture=this.texture,e.roughness=this.roughness),e},SubSlotNode.prototype=Object.create(TempNode.prototype),SubSlotNode.prototype.constructor=SubSlotNode,SubSlotNode.prototype.nodeType="SubSlot",SubSlotNode.prototype.getType=function(s,e){return e},SubSlotNode.prototype.generate=function(s,e){return this.slots[s.slot]?this.slots[s.slot].build(s,e):s.format("0.0","f",e)},SubSlotNode.prototype.copy=function(s){for(var e in TempNode.prototype.copy.call(this,s),s.slots)this.slots[e]=s.slots[e];return this},SubSlotNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);if(!e)for(var a in(e=this.createJSONNode(s)).slots={},this.slots){var d=this.slots[a];d&&(e.slots[a]=d.toJSON(s).uuid)}return e},BlurNode.Nodes={blurX:new FunctionNode(["vec4 blurX( sampler2D texture, vec2 uv, float s ) {","\tvec4 sum = vec4( 0.0 );","\tsum += texture2D( texture, vec2( uv.x - 4.0 * s, uv.y ) ) * 0.051;","\tsum += texture2D( texture, vec2( uv.x - 3.0 * s, uv.y ) ) * 0.0918;","\tsum += texture2D( texture, vec2( uv.x - 2.0 * s, uv.y ) ) * 0.12245;","\tsum += texture2D( texture, vec2( uv.x - 1.0 * s, uv.y ) ) * 0.1531;","\tsum += texture2D( texture, vec2( uv.x, uv.y ) ) * 0.1633;","\tsum += texture2D( texture, vec2( uv.x + 1.0 * s, uv.y ) ) * 0.1531;","\tsum += texture2D( texture, vec2( uv.x + 2.0 * s, uv.y ) ) * 0.12245;","\tsum += texture2D( texture, vec2( uv.x + 3.0 * s, uv.y ) ) * 0.0918;","\tsum += texture2D( texture, vec2( uv.x + 4.0 * s, uv.y ) ) * 0.051;","\treturn sum * .667;","}"].join("\n")),blurY:new FunctionNode(["vec4 blurY( sampler2D texture, vec2 uv, float s ) {","\tvec4 sum = vec4( 0.0 );","\tsum += texture2D( texture, vec2( uv.x, uv.y - 4.0 * s ) ) * 0.051;","\tsum += texture2D( texture, vec2( uv.x, uv.y - 3.0 * s ) ) * 0.0918;","\tsum += texture2D( texture, vec2( uv.x, uv.y - 2.0 * s ) ) * 0.12245;","\tsum += texture2D( texture, vec2( uv.x, uv.y - 1.0 * s ) ) * 0.1531;","\tsum += texture2D( texture, vec2( uv.x, uv.y ) ) * 0.1633;","\tsum += texture2D( texture, vec2( uv.x, uv.y + 1.0 * s ) ) * 0.1531;","\tsum += texture2D( texture, vec2( uv.x, uv.y + 2.0 * s ) ) * 0.12245;","\tsum += texture2D( texture, vec2( uv.x, uv.y + 3.0 * s ) ) * 0.0918;","\tsum += texture2D( texture, vec2( uv.x, uv.y + 4.0 * s ) ) * 0.051;","\treturn sum * .667;","}"].join("\n"))},BlurNode.prototype=Object.create(TempNode.prototype),BlurNode.prototype.constructor=BlurNode,BlurNode.prototype.nodeType="Blur",BlurNode.prototype.updateFrame=function(){if(this.size)this.horizontal.value=this.radius.x/this.size.x,this.vertical.value=this.radius.y/this.size.y;else if(this.value.value&&this.value.value.image){var s=this.value.value.image;this.horizontal.value=this.radius.x/s.width,this.vertical.value=this.radius.y/s.height}},BlurNode.prototype.generate=function(s,e){if(s.isShader("fragment")){var d,a=[],v=s.include(BlurNode.Nodes.blurX),g=s.include(BlurNode.Nodes.blurY);return this.blurX&&a.push(v+"( "+this.value.build(s,"sampler2D")+", "+this.uv.build(s,"v2")+", "+this.horizontal.build(s,"f")+" )"),this.blurY&&a.push(g+"( "+this.value.build(s,"sampler2D")+", "+this.uv.build(s,"v2")+", "+this.vertical.build(s,"f")+" )"),d=2==a.length?"( "+a.join(" + ")+" / 2.0 )":a.length?"( "+a[0]+" )":"vec4( 0.0 )",s.format(d,this.getType(s),e)}return console.warn("BlurNode is not compatible with "+s.shader+" shader."),s.format("vec4( 0.0 )",this.getType(s),e)},BlurNode.prototype.copy=function(s){return TempNode.prototype.copy.call(this,s),this.value=s.value,this.uv=s.uv,this.radius=s.radius,void 0!==s.size&&(this.size=new Vector2(s.size.x,s.size.y)),this.blurX=s.blurX,this.blurY=s.blurY,this},BlurNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).value=this.value.toJSON(s).uuid,e.uv=this.uv.toJSON(s).uuid,e.radius=this.radius.toJSON(s).uuid,this.size&&(e.size={x:this.size.x,y:this.size.y}),e.blurX=this.blurX,e.blurY=this.blurY),e},LuminanceNode.Nodes=function(){var s=new ConstNode("vec3 LUMA vec3( 0.2125, 0.7154, 0.0721 )");return{LUMA:s,luminance:new FunctionNode(["float luminance( vec3 rgb ) {","\treturn dot( rgb, LUMA );","}"].join("\n"),[s])}}(),LuminanceNode.prototype=Object.create(TempNode.prototype),LuminanceNode.prototype.constructor=LuminanceNode,LuminanceNode.prototype.nodeType="Luminance",LuminanceNode.prototype.generate=function(s,e){var a=s.include(LuminanceNode.Nodes.luminance);return s.format(a+"( "+this.rgb.build(s,"v3")+" )",this.getType(s),e)},LuminanceNode.prototype.copy=function(s){return TempNode.prototype.copy.call(this,s),this.rgb=s.rgb,this},LuminanceNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).rgb=this.rgb.toJSON(s).uuid),e},ColorAdjustmentNode.Nodes={hue:new FunctionNode(["vec3 hue(vec3 rgb, float adjustment) {","\tconst mat3 RGBtoYIQ = mat3(0.299, 0.587, 0.114, 0.595716, -0.274453, -0.321263, 0.211456, -0.522591, 0.311135);","\tconst mat3 YIQtoRGB = mat3(1.0, 0.9563, 0.6210, 1.0, -0.2721, -0.6474, 1.0, -1.107, 1.7046);","\tvec3 yiq = RGBtoYIQ * rgb;","\tfloat hue = atan(yiq.z, yiq.y) + adjustment;","\tfloat chroma = sqrt(yiq.z * yiq.z + yiq.y * yiq.y);","\treturn YIQtoRGB * vec3(yiq.x, chroma * cos(hue), chroma * sin(hue));","}"].join("\n")),saturation:new FunctionNode(["vec3 saturation(vec3 rgb, float adjustment) {","\tvec3 intensity = vec3( luminance( rgb ) );","\treturn mix( intensity, rgb, adjustment );","}"].join("\n"),[LuminanceNode.Nodes.luminance]),vibrance:new FunctionNode(["vec3 vibrance(vec3 rgb, float adjustment) {","\tfloat average = (rgb.r + rgb.g + rgb.b) / 3.0;","\tfloat mx = max(rgb.r, max(rgb.g, rgb.b));","\tfloat amt = (mx - average) * (-3.0 * adjustment);","\treturn mix(rgb.rgb, vec3(mx), amt);","}"].join("\n"))},ColorAdjustmentNode.SATURATION="saturation",ColorAdjustmentNode.HUE="hue",ColorAdjustmentNode.VIBRANCE="vibrance",ColorAdjustmentNode.BRIGHTNESS="brightness",ColorAdjustmentNode.CONTRAST="contrast",ColorAdjustmentNode.prototype=Object.create(TempNode.prototype),ColorAdjustmentNode.prototype.constructor=ColorAdjustmentNode,ColorAdjustmentNode.prototype.nodeType="ColorAdjustment",ColorAdjustmentNode.prototype.generate=function(s,e){var a=this.rgb.build(s,"v3"),d=this.adjustment.build(s,"f");switch(this.method){case ColorAdjustmentNode.BRIGHTNESS:return s.format("( "+a+" + "+d+" )",this.getType(s),e);case ColorAdjustmentNode.CONTRAST:return s.format("( "+a+" * "+d+" )",this.getType(s),e)}var v=s.include(ColorAdjustmentNode.Nodes[this.method]);return s.format(v+"( "+a+", "+d+" )",this.getType(s),e)},ColorAdjustmentNode.prototype.copy=function(s){return TempNode.prototype.copy.call(this,s),this.rgb=s.rgb,this.adjustment=s.adjustment,this.method=s.method,this},ColorAdjustmentNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||((e=this.createJSONNode(s)).rgb=this.rgb.toJSON(s).uuid,e.adjustment=this.adjustment.toJSON(s).uuid,e.method=this.method),e},SpriteNode.prototype=Object.create(Node.prototype),SpriteNode.prototype.constructor=SpriteNode,SpriteNode.prototype.nodeType="Sprite",SpriteNode.prototype.build=function(s){if(s.define("SPRITE"),s.requires.lights=!1,s.requires.transparent=void 0!==this.alpha,s.isShader("vertex")){var a=this.position?this.position.analyzeAndFlow(s,"v3",{cache:"position"}):void 0;s.mergeUniform(UniformsUtils.merge([UniformsLib.fog])),s.addParsCode(["#include <fog_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n")),e=["#include <clipping_planes_fragment>","#include <begin_vertex>"],a&&e.push(a.code,a.result?"transformed = "+a.result+";":""),e.push("#include <project_vertex>","#include <fog_vertex>","mat4 modelViewMtx = modelViewMatrix;","mat4 modelMtx = modelMatrix;","modelMtx[3][0] = 0.0;","modelMtx[3][1] = 0.0;","modelMtx[3][2] = 0.0;"),this.spherical||e.push("modelMtx[1][1] = 1.0;"),e.push("modelViewMtx[0][0] = 1.0;","modelViewMtx[0][1] = 0.0;","modelViewMtx[0][2] = 0.0;"),this.spherical&&e.push("modelViewMtx[1][0] = 0.0;","modelViewMtx[1][1] = 1.0;","modelViewMtx[1][2] = 0.0;"),e.push("modelViewMtx[2][0] = 0.0;","modelViewMtx[2][1] = 0.0;","modelViewMtx[2][2] = 1.0;","gl_Position = projectionMatrix * modelViewMtx * modelMtx * vec4( transformed, 1.0 );","#include <logdepthbuf_vertex>","#include <clipping_planes_vertex>","#include <fog_vertex>")}else{s.addParsCode(["#include <fog_pars_fragment>","#include <logdepthbuf_pars_fragment>","#include <clipping_planes_pars_fragment>"].join("\n")),s.addCode(["#include <clipping_planes_fragment>","#include <logdepthbuf_fragment>"].join("\n")),this.mask&&this.mask.analyze(s),this.alpha&&this.alpha.analyze(s),this.color.analyze(s,{slot:"color"});var d=this.mask?this.mask.flow(s,"b"):void 0,v=this.alpha?this.alpha.flow(s,"f"):void 0,g=this.color.flow(s,"c",{slot:"color"}),e=[];d&&e.push(d.code,"if ( ! "+d.result+" ) discard;"),v?e.push(v.code,"#ifdef ALPHATEST","if ( "+v.result+" <= ALPHATEST ) discard;","#endif",g.code,"gl_FragColor = vec4( "+g.result+", "+v.result+" );"):e.push(g.code,"gl_FragColor = vec4( "+g.result+", 1.0 );"),e.push("#include <tonemapping_fragment>","#include <encodings_fragment>","#include <fog_fragment>")}return e.join("\n")},SpriteNode.prototype.copy=function(s){return Node.prototype.copy.call(this,s),s.position&&(this.position=s.position),this.color=s.color,void 0!==s.spherical&&(this.spherical=s.spherical),s.mask&&(this.mask=s.mask),s.alpha&&(this.alpha=s.alpha),this},SpriteNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||(e=this.createJSONNode(s),this.position&&(e.position=this.position.toJSON(s).uuid),e.color=this.color.toJSON(s).uuid,!1===this.spherical&&(e.spherical=!1),this.mask&&(e.mask=this.mask.toJSON(s).uuid),this.alpha&&(e.alpha=this.alpha.toJSON(s).uuid)),e},PhongNode.prototype=Object.create(Node.prototype),PhongNode.prototype.constructor=PhongNode,PhongNode.prototype.nodeType="Phong",PhongNode.prototype.build=function(s){var e;if(s.define("PHONG"),s.requires.lights=!0,s.isShader("vertex")){var a=this.position?this.position.analyzeAndFlow(s,"v3",{cache:"position"}):void 0;s.mergeUniform(UniformsUtils.merge([UniformsLib.fog,UniformsLib.lights])),s.addParsCode(["varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif","#include <fog_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","#include <shadowmap_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));var d=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#ifndef FLAT_SHADED","\tvNormal = normalize( transformedNormal );","#endif","#include <begin_vertex>"];a&&d.push(a.code,a.result?"transformed = "+a.result+";":""),d.push("\t#include <morphtarget_vertex>","\t#include <skinning_vertex>","\t#include <project_vertex>","\t#include <fog_vertex>","\t#include <logdepthbuf_vertex>","\t#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","\t#include <worldpos_vertex>","\t#include <shadowmap_vertex>","\t#include <fog_vertex>"),e=d.join("\n")}else{this.mask&&this.mask.analyze(s),this.color.analyze(s,{slot:"color"}),this.specular.analyze(s),this.shininess.analyze(s),this.alpha&&this.alpha.analyze(s),this.normal&&this.normal.analyze(s),this.light&&this.light.analyze(s,{cache:"light"}),this.ao&&this.ao.analyze(s),this.ambient&&this.ambient.analyze(s),this.shadow&&this.shadow.analyze(s),this.emissive&&this.emissive.analyze(s,{slot:"emissive"}),this.environment&&this.environment.analyze(s,{slot:"environment"}),this.environmentAlpha&&this.environment&&this.environmentAlpha.analyze(s);var v=this.mask?this.mask.flow(s,"b"):void 0,g=this.color.flow(s,"c",{slot:"color"}),C=this.specular.flow(s,"c"),w=this.shininess.flow(s,"f"),_=this.alpha?this.alpha.flow(s,"f"):void 0,x=this.normal?this.normal.flow(s,"v3"):void 0,b=this.light?this.light.flow(s,"v3",{cache:"light"}):void 0,A=this.ao?this.ao.flow(s,"f"):void 0,E=this.ambient?this.ambient.flow(s,"c"):void 0,R=this.shadow?this.shadow.flow(s,"c"):void 0,O=this.emissive?this.emissive.flow(s,"c",{slot:"emissive"}):void 0,D=this.environment?this.environment.flow(s,"c",{slot:"environment"}):void 0,F=this.environmentAlpha&&this.environment?this.environmentAlpha.flow(s,"f"):void 0;s.requires.transparent=void 0!==_,s.addParsCode(["#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_phong_pars_fragment>","#include <shadowmap_pars_fragment>","#include <logdepthbuf_pars_fragment>"].join("\n")),d=["#include <normal_fragment_begin>","\tBlinnPhongMaterial material;"],v&&d.push(v.code,"if ( ! "+v.result+" ) discard;"),d.push(g.code,"\tvec3 diffuseColor = "+g.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","#include <logdepthbuf_fragment>",C.code,"\tvec3 specular = "+C.result+";",w.code,"\tfloat shininess = max( 0.0001, "+w.result+" );","\tfloat specularStrength = 1.0;"),_&&d.push(_.code,"#ifdef ALPHATEST","if ( "+_.result+" <= ALPHATEST ) discard;","#endif"),x&&d.push(x.code,"normal = "+x.result+";"),d.push("material.diffuseColor = "+(b?"vec3( 1.0 )":"diffuseColor")+";"),d.push("material.specularColor = specular;","material.specularShininess = shininess;","material.specularStrength = specularStrength;","#include <lights_fragment_begin>","#include <lights_fragment_end>"),b&&(d.push(b.code,"reflectedLight.directDiffuse = "+b.result+";"),d.push("reflectedLight.directDiffuse *= diffuseColor;","reflectedLight.indirectDiffuse *= diffuseColor;")),A&&d.push(A.code,"reflectedLight.indirectDiffuse *= "+A.result+";"),E&&d.push(E.code,"reflectedLight.indirectDiffuse += "+E.result+";"),R&&d.push(R.code,"reflectedLight.directDiffuse *= "+R.result+";","reflectedLight.directSpecular *= "+R.result+";"),O&&d.push(O.code,"reflectedLight.directDiffuse += "+O.result+";"),d.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular;"),D&&(d.push(D.code),F?d.push(F.code,"outgoingLight = mix( outgoingLight, "+D.result+", "+F.result+" );"):d.push("outgoingLight = "+D.result+";")),d.push(_?"gl_FragColor = vec4( outgoingLight, "+_.result+" );":"gl_FragColor = vec4( outgoingLight, 1.0 );"),d.push("#include <tonemapping_fragment>","#include <encodings_fragment>","#include <fog_fragment>","#include <premultiplied_alpha_fragment>"),e=d.join("\n")}return e},PhongNode.prototype.copy=function(s){return Node.prototype.copy.call(this,s),s.position&&(this.position=s.position),this.color=s.color,this.specular=s.specular,this.shininess=s.shininess,s.mask&&(this.mask=s.mask),s.alpha&&(this.alpha=s.alpha),s.normal&&(this.normal=s.normal),s.light&&(this.light=s.light),s.shadow&&(this.shadow=s.shadow),s.ao&&(this.ao=s.ao),s.emissive&&(this.emissive=s.emissive),s.ambient&&(this.ambient=s.ambient),s.environment&&(this.environment=s.environment),s.environmentAlpha&&(this.environmentAlpha=s.environmentAlpha),this},PhongNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||(e=this.createJSONNode(s),this.position&&(e.position=this.position.toJSON(s).uuid),e.color=this.color.toJSON(s).uuid,e.specular=this.specular.toJSON(s).uuid,e.shininess=this.shininess.toJSON(s).uuid,this.mask&&(e.mask=this.mask.toJSON(s).uuid),this.alpha&&(e.alpha=this.alpha.toJSON(s).uuid),this.normal&&(e.normal=this.normal.toJSON(s).uuid),this.light&&(e.light=this.light.toJSON(s).uuid),this.ao&&(e.ao=this.ao.toJSON(s).uuid),this.ambient&&(e.ambient=this.ambient.toJSON(s).uuid),this.shadow&&(e.shadow=this.shadow.toJSON(s).uuid),this.emissive&&(e.emissive=this.emissive.toJSON(s).uuid),this.environment&&(e.environment=this.environment.toJSON(s).uuid),this.environmentAlpha&&(e.environmentAlpha=this.environmentAlpha.toJSON(s).uuid)),e},StandardNode.prototype=Object.create(Node.prototype),StandardNode.prototype.constructor=StandardNode,StandardNode.prototype.nodeType="Standard",StandardNode.prototype.build=function(s){var e;s.define("STANDARD");var a=this.clearcoat||this.clearcoatRoughness||this.clearCoatNormal;if(a&&s.define("CLEARCOAT"),s.requires.lights=!0,s.extensions.derivatives=!0,s.extensions.shaderTextureLOD=!0,s.isShader("vertex")){var d=this.position?this.position.analyzeAndFlow(s,"v3",{cache:"position"}):void 0;s.mergeUniform(UniformsUtils.merge([UniformsLib.fog,UniformsLib.lights])),UniformsLib.LTC_1&&(s.uniforms.ltc_1={value:void 0},s.uniforms.ltc_2={value:void 0}),s.addParsCode(["varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif","#include <fog_pars_vertex>","#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","#include <shadowmap_pars_vertex>","#include <logdepthbuf_pars_vertex>","#include <clipping_planes_pars_vertex>"].join("\n"));var v=["#include <beginnormal_vertex>","#include <morphnormal_vertex>","#include <skinbase_vertex>","#include <skinnormal_vertex>","#include <defaultnormal_vertex>","#ifndef FLAT_SHADED","\tvNormal = normalize( transformedNormal );","#endif","#include <begin_vertex>"];d&&v.push(d.code,d.result?"transformed = "+d.result+";":""),v.push("#include <morphtarget_vertex>","#include <skinning_vertex>","#include <project_vertex>","#include <fog_vertex>","#include <logdepthbuf_vertex>","#include <clipping_planes_vertex>","\tvViewPosition = - mvPosition.xyz;","#include <worldpos_vertex>","#include <shadowmap_vertex>"),e=v.join("\n")}else{var g=new ExpressionNode("material.specularRoughness","f"),C=new ExpressionNode("material.clearcoatRoughness","f"),w={roughness:g,bias:new SpecularMIPLevelNode(g),viewNormal:new ExpressionNode("normal","v3"),worldNormal:new ExpressionNode("inverseTransformDirection( geometry.normal, viewMatrix )","v3"),gamma:!0},_={gamma:!0},x={roughness:C,bias:new SpecularMIPLevelNode(C),viewNormal:new ExpressionNode("clearcoatNormal","v3"),worldNormal:new ExpressionNode("inverseTransformDirection( geometry.clearcoatNormal, viewMatrix )","v3"),gamma:!0};this.mask&&this.mask.analyze(s),this.color.analyze(s,{slot:"color",context:_}),this.roughness.analyze(s),this.metalness.analyze(s),this.alpha&&this.alpha.analyze(s),this.normal&&this.normal.analyze(s),this.clearcoat&&this.clearcoat.analyze(s),this.clearcoatRoughness&&this.clearcoatRoughness.analyze(s),this.clearcoatNormal&&this.clearcoatNormal.analyze(s),this.reflectivity&&this.reflectivity.analyze(s),this.light&&this.light.analyze(s,{cache:"light"}),this.ao&&this.ao.analyze(s),this.ambient&&this.ambient.analyze(s),this.shadow&&this.shadow.analyze(s),this.emissive&&this.emissive.analyze(s,{slot:"emissive"}),this.environment&&(this.environment.analyze(s,{cache:"radiance",context:w,slot:"radiance"}),s.requires.irradiance&&this.environment.analyze(s,{cache:"irradiance",context:w,slot:"irradiance"})),this.sheen&&this.sheen.analyze(s);var j,b=this.mask?this.mask.flow(s,"b"):void 0,A=this.color.flow(s,"c",{slot:"color",context:_}),E=this.roughness.flow(s,"f"),R=this.metalness.flow(s,"f"),O=this.alpha?this.alpha.flow(s,"f"):void 0,D=this.normal?this.normal.flow(s,"v3"):void 0,F=this.clearcoat?this.clearcoat.flow(s,"f"):void 0,L=(C=this.clearcoatRoughness?this.clearcoatRoughness.flow(s,"f"):void 0,this.clearcoatNormal?this.clearcoatNormal.flow(s,"v3"):void 0),I=this.reflectivity?this.reflectivity.flow(s,"f"):void 0,V=this.light?this.light.flow(s,"v3",{cache:"light"}):void 0,z=this.ao?this.ao.flow(s,"f"):void 0,H=this.ambient?this.ambient.flow(s,"c"):void 0,X=this.shadow?this.shadow.flow(s,"c"):void 0,re=this.emissive?this.emissive.flow(s,"c",{slot:"emissive"}):void 0;this.environment&&(j={radiance:this.environment.flow(s,"c",{cache:"radiance",context:w,slot:"radiance"})},s.requires.irradiance&&(j.irradiance=this.environment.flow(s,"c",{cache:"irradiance",context:w,slot:"irradiance"})));var te=a&&j?this.environment.flow(s,"c",{cache:"clearcoat",context:x,slot:"environment"}):void 0,J=this.sheen?this.sheen.flow(s,"c"):void 0;s.requires.transparent=void 0!==O,s.addParsCode(["varying vec3 vViewPosition;","#ifndef FLAT_SHADED","\tvarying vec3 vNormal;","#endif","#include <dithering_pars_fragment>","#include <fog_pars_fragment>","#include <bsdfs>","#include <lights_pars_begin>","#include <lights_physical_pars_fragment>","#include <shadowmap_pars_fragment>","#include <logdepthbuf_pars_fragment>"].join("\n")),v=["#include <clipping_planes_fragment>","\t#include <normal_fragment_begin>","\t#include <clearcoat_normal_fragment_begin>","\tPhysicalMaterial material;","\tmaterial.diffuseColor = vec3( 1.0 );"],b&&v.push(b.code,"if ( ! "+b.result+" ) discard;"),v.push(A.code,"\tvec3 diffuseColor = "+A.result+";","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","#include <logdepthbuf_fragment>",E.code,"\tfloat roughnessFactor = "+E.result+";",R.code,"\tfloat metalnessFactor = "+R.result+";"),O&&v.push(O.code,"#ifdef ALPHATEST","\tif ( "+O.result+" <= ALPHATEST ) discard;","#endif"),D&&v.push(D.code,"normal = "+D.result+";"),L&&v.push(L.code,"clearcoatNormal = "+L.result+";"),v.push("vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );"),v.push("material.diffuseColor = "+(V?"vec3( 1.0 )":"diffuseColor * ( 1.0 - metalnessFactor )")+";","material.specularRoughness = max( roughnessFactor, 0.0525 );","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );"),F?v.push(F.code,"material.clearcoat = saturate( "+F.result+" );"):a&&v.push("material.clearcoat = 0.0;"),C?v.push(C.code,"material.clearcoatRoughness = max( "+C.result+", 0.0525 );","material.clearcoatRoughness += geometryRoughness;","material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );"):a&&v.push("material.clearcoatRoughness = 0.0;"),J&&v.push("material.sheenColor = "+J.result+";"),I?v.push(I.code,"material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( "+I.result+" ) ), diffuseColor, metalnessFactor );"):v.push("material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor, metalnessFactor );"),v.push("#include <lights_fragment_begin>"),V&&(v.push(V.code,"reflectedLight.directDiffuse = "+V.result+";"),v.push("diffuseColor *= 1.0 - metalnessFactor;","reflectedLight.directDiffuse *= diffuseColor;","reflectedLight.indirectDiffuse *= diffuseColor;")),z&&v.push(z.code,"reflectedLight.indirectDiffuse *= "+z.result+";","float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );","reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, "+z.result+", material.specularRoughness );"),H&&v.push(H.code,"reflectedLight.indirectDiffuse += "+H.result+";"),X&&v.push(X.code,"reflectedLight.directDiffuse *= "+X.result+";","reflectedLight.directSpecular *= "+X.result+";"),re&&v.push(re.code,"reflectedLight.directDiffuse += "+re.result+";"),j&&(v.push(j.radiance.code),s.requires.irradiance&&v.push(j.irradiance.code),te&&v.push(te.code,"clearcoatRadiance += "+te.result+";"),v.push("radiance += "+j.radiance.result+";"),s.requires.irradiance&&v.push("iblIrradiance += PI * "+j.irradiance.result+";")),v.push("#include <lights_fragment_end>"),v.push("vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular;"),v.push(O?"gl_FragColor = vec4( outgoingLight, "+O.result+" );":"gl_FragColor = vec4( outgoingLight, 1.0 );"),v.push("#include <tonemapping_fragment>","#include <encodings_fragment>","#include <fog_fragment>","#include <premultiplied_alpha_fragment>","#include <dithering_fragment>"),e=v.join("\n")}return e},StandardNode.prototype.copy=function(s){return Node.prototype.copy.call(this,s),s.position&&(this.position=s.position),this.color=s.color,this.roughness=s.roughness,this.metalness=s.metalness,s.mask&&(this.mask=s.mask),s.alpha&&(this.alpha=s.alpha),s.normal&&(this.normal=s.normal),s.clearcoat&&(this.clearcoat=s.clearcoat),s.clearcoatRoughness&&(this.clearcoatRoughness=s.clearcoatRoughness),s.clearcoatNormal&&(this.clearcoatNormal=s.clearcoatNormal),s.reflectivity&&(this.reflectivity=s.reflectivity),s.light&&(this.light=s.light),s.shadow&&(this.shadow=s.shadow),s.ao&&(this.ao=s.ao),s.emissive&&(this.emissive=s.emissive),s.ambient&&(this.ambient=s.ambient),s.environment&&(this.environment=s.environment),s.sheen&&(this.sheen=s.sheen),this},StandardNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||(e=this.createJSONNode(s),this.position&&(e.position=this.position.toJSON(s).uuid),e.color=this.color.toJSON(s).uuid,e.roughness=this.roughness.toJSON(s).uuid,e.metalness=this.metalness.toJSON(s).uuid,this.mask&&(e.mask=this.mask.toJSON(s).uuid),this.alpha&&(e.alpha=this.alpha.toJSON(s).uuid),this.normal&&(e.normal=this.normal.toJSON(s).uuid),this.clearcoat&&(e.clearcoat=this.clearcoat.toJSON(s).uuid),this.clearcoatRoughness&&(e.clearcoatRoughness=this.clearcoatRoughness.toJSON(s).uuid),this.clearcoatNormal&&(e.clearcoatNormal=this.clearcoatNormal.toJSON(s).uuid),this.reflectivity&&(e.reflectivity=this.reflectivity.toJSON(s).uuid),this.light&&(e.light=this.light.toJSON(s).uuid),this.shadow&&(e.shadow=this.shadow.toJSON(s).uuid),this.ao&&(e.ao=this.ao.toJSON(s).uuid),this.emissive&&(e.emissive=this.emissive.toJSON(s).uuid),this.ambient&&(e.ambient=this.ambient.toJSON(s).uuid),this.environment&&(e.environment=this.environment.toJSON(s).uuid),this.sheen&&(e.sheen=this.sheen.toJSON(s).uuid)),e},MeshStandardNode.prototype=Object.create(StandardNode.prototype),MeshStandardNode.prototype.constructor=MeshStandardNode,MeshStandardNode.prototype.nodeType="MeshStandard",MeshStandardNode.prototype.build=function(s){var e=this.properties,a=this.inputs;if(s.isShader("fragment")){var d=s.findNode(e.color,a.color),v=s.resolve(e.map);this.color=v?new OperatorNode(d,v,OperatorNode.MUL):d;var g=s.findNode(e.roughness,a.roughness),C=s.resolve(e.roughnessMap);this.roughness=C?new OperatorNode(g,new SwitchNode(C,"g"),OperatorNode.MUL):g;var w=s.findNode(e.metalness,a.metalness),_=s.resolve(e.metalnessMap);this.metalness=_?new OperatorNode(w,new SwitchNode(_,"b"),OperatorNode.MUL):w,e.normalMap?(this.normal=new NormalMapNode(s.resolve(e.normalMap)),this.normal.scale=s.findNode(e.normalScale,a.normalScale)):this.normal=void 0,this.environment=s.resolve(e.envMap)}return StandardNode.prototype.build.call(this,s)},MeshStandardNode.prototype.toJSON=function(s){var e=this.getJSONNode(s);return e||(e=this.createJSONNode(s),console.warn(".toJSON not implemented in",this)),e},SpriteNodeMaterial.prototype=Object.create(NodeMaterial.prototype),SpriteNodeMaterial.prototype.constructor=SpriteNodeMaterial,NodeUtils.addShortcuts(SpriteNodeMaterial.prototype,"fragment",["color","alpha","mask","position","spherical"]),PhongNodeMaterial.prototype=Object.create(NodeMaterial.prototype),PhongNodeMaterial.prototype.constructor=PhongNodeMaterial,NodeUtils.addShortcuts(PhongNodeMaterial.prototype,"fragment",["color","alpha","specular","shininess","normal","emissive","ambient","light","shadow","ao","environment","environmentAlpha","mask","position"]),StandardNodeMaterial.prototype=Object.create(NodeMaterial.prototype),StandardNodeMaterial.prototype.constructor=StandardNodeMaterial,NodeUtils.addShortcuts(StandardNodeMaterial.prototype,"fragment",["color","alpha","roughness","metalness","reflectivity","clearcoat","clearcoatRoughness","clearcoatNormal","normal","emissive","ambient","light","shadow","ao","environment","mask","position","sheen"]),MeshStandardNodeMaterial.prototype=Object.create(NodeMaterial.prototype),MeshStandardNodeMaterial.prototype.constructor=MeshStandardNodeMaterial,NodeUtils.addShortcuts(MeshStandardNodeMaterial.prototype,"properties",["color","roughness","metalness","map","normalMap","normalScale","metalnessMap","roughnessMap","envMap"]),NodePostProcessing.prototype={constructor:NodePostProcessing,render:function(e,a,d){this.needsUpdate&&(this.material.dispose(),this.material.fragment.value=this.output,this.material.build(),this.material.uniforms.renderTexture&&(this.material.uniforms.renderTexture.value=this.renderTarget.texture),this.needsUpdate=!1),d.setRenderer(this.renderer).setRenderTexture(this.renderTarget.texture),this.renderer.setRenderTarget(this.renderTarget),this.renderer.render(e,a),d.updateNode(this.material),this.renderer.setRenderTarget(null),this.renderer.render(this.scene,this.camera)},setPixelRatio:function(e){this.renderer.setPixelRatio(e);var a=this.renderer.getSize(new Vector2);this.setSize(a.width,a.height)},setSize:function(e,a){var d=this.renderer.getPixelRatio();this.renderTarget.setSize(e*d,a*d),this.renderer.setSize(e,a)},copy:function(e){return this.output=e.output,this},toJSON:function(e){if((void 0===e||"string"==typeof e)&&(e={nodes:{}}),e&&!e.post&&(e.post={}),!e.post[this.uuid]){var d={};d.uuid=this.uuid,d.type="NodePostProcessing",e.post[this.uuid]=d,""!==this.name&&(d.name=this.name),"{}"!==JSON.stringify(this.userData)&&(d.userData=this.userData),d.output=this.output.toJSON(e).uuid}return e.post=this.uuid,e}};var Nodes={Node:Node,TempNode:TempNode,InputNode:InputNode,ConstNode:ConstNode,VarNode:VarNode,StructNode:StructNode,AttributeNode:AttributeNode,FunctionNode:FunctionNode,ExpressionNode:ExpressionNode,FunctionCallNode:FunctionCallNode,NodeLib:NodeLib,NodeUtils:NodeUtils,NodeFrame:NodeFrame,NodeUniform:NodeUniform,NodeBuilder:NodeBuilder,BoolNode:BoolNode,IntNode:IntNode,FloatNode:FloatNode,Vector2Node:Vector2Node,Vector3Node:Vector3Node,Vector4Node:Vector4Node,ColorNode:ColorNode,Matrix3Node:Matrix3Node,Matrix4Node:Matrix4Node,TextureNode:TextureNode,CubeTextureNode:CubeTextureNode,ScreenNode:ScreenNode,ReflectorNode:ReflectorNode,PropertyNode:PropertyNode,RTTNode:RTTNode,UVNode:UVNode,ColorsNode:ColorsNode,PositionNode:PositionNode,NormalNode:NormalNode,CameraNode:CameraNode,LightNode:LightNode,ReflectNode:ReflectNode,ScreenUVNode:ScreenUVNode,ResolutionNode:ResolutionNode,MathNode:MathNode,OperatorNode:OperatorNode,CondNode:CondNode,NoiseNode:NoiseNode,CheckerNode:CheckerNode,TextureCubeUVNode:TextureCubeUVNode,TextureCubeNode:TextureCubeNode,NormalMapNode:NormalMapNode,BumpMapNode:BumpMapNode,BypassNode:BypassNode,JoinNode:JoinNode,SwitchNode:SwitchNode,TimerNode:TimerNode,VelocityNode:VelocityNode,UVTransformNode:UVTransformNode,MaxMIPLevelNode:MaxMIPLevelNode,SpecularMIPLevelNode:SpecularMIPLevelNode,ColorSpaceNode:ColorSpaceNode,SubSlotNode:SubSlotNode,BlurNode:BlurNode,ColorAdjustmentNode:ColorAdjustmentNode,LuminanceNode:LuminanceNode,RawNode:RawNode,SpriteNode:SpriteNode,PhongNode:PhongNode,StandardNode:StandardNode,MeshStandardNode:MeshStandardNode,NodeMaterial:NodeMaterial,SpriteNodeMaterial:SpriteNodeMaterial,PhongNodeMaterial:PhongNodeMaterial,StandardNodeMaterial:StandardNodeMaterial,MeshStandardNodeMaterial:MeshStandardNodeMaterial,NodePostProcessing:NodePostProcessing},NodeMaterialLoader=function(e,a){this.manager=void 0!==e?e:DefaultLoadingManager,this.nodes={},this.materials={},this.passes={},this.names={},this.library=a||{}},NodeMaterialLoaderUtils={replaceUUIDObject:function(e,a,d,v){if(v=void 0===v||v,"object"==typeof a&&(a=a.uuid),"object"==typeof e)for(var g=Object.keys(e),C=0;C<g.length;C++){var w=g[C];v&&(e[w]=this.replaceUUIDObject(e[w],a,d)),w===a&&(e[a]=e[w],delete e[w])}return e===a?d:e},replaceUUID:function(e,a,d){return this.replaceUUIDObject(e,a,d,!1),this.replaceUUIDObject(e.nodes,a,d),this.replaceUUIDObject(e.materials,a,d),this.replaceUUIDObject(e.passes,a,d),this.replaceUUIDObject(e.library,a,d,!1),e}};Object.assign(NodeMaterialLoader.prototype,{load:function(e,a,d,v){var g=this,C=new FileLoader(g.manager);return C.setPath(g.path),C.load(e,function(w){a(g.parse(JSON.parse(w)))},d,v),this},setPath:function(e){return this.path=e,this},getObjectByName:function(e){return this.names[e]},getObjectById:function(e){return this.library[e]||this.nodes[e]||this.materials[e]||this.passes[e]||this.names[e]},getNode:function(e){var a=this.getObjectById(e);return a||console.warn('Node "'+e+'" not found.'),a},resolve:function(e){switch(typeof e){case"boolean":case"number":return e;case"string":return/^\w{8}-\w{4}-\w{4}-\w{4}-\w{12}$/i.test(e)||this.library[e]?this.getNode(e):e;default:if(Array.isArray(e))for(var a=0;a<e.length;a++)e[a]=this.resolve(e[a]);else for(var d in e)"uuid"!==d&&(e[d]=this.resolve(e[d]))}return e},declare:function(e){var a,d,v;for(a in e.nodes)v=new Nodes[(d=e.nodes[a]).nodeType+"Node"],d.name&&(v.name=d.name,this.names[v.name]=v),this.nodes[a]=v;for(a in e.materials)v=new Nodes[(d=e.materials[a]).type],d.name&&(v.name=d.name,this.names[v.name]=v),this.materials[a]=v;for(a in e.passes)v=new Nodes[(d=e.passes[a]).type],d.name&&(v.name=d.name,this.names[v.name]=v),this.passes[a]=v;return e.material&&(this.material=this.materials[e.material]),e.pass&&(this.pass=this.passes[e.pass]),e},parse:function(e){var a;for(a in(e=this.resolve(this.declare(e))).nodes)this.nodes[a].copy(e.nodes[a]);for(a in e.materials)this.materials[a].copy(e.materials[a]);for(a in e.passes)this.passes[a].copy(e.passes[a]);return this.material||this.pass||this}});var VolumeSlice=function(e,a,d){var v=this;this.volume=e,a=a||0,Object.defineProperty(this,"index",{get:function(){return a},set:function(_){return a=_,v.geometryNeedsUpdate=!0,a}}),this.axis=d||"z",this.canvas=document.createElement("canvas"),this.canvasBuffer=document.createElement("canvas"),this.updateGeometry();var g=new Texture(this.canvas);g.minFilter=LinearFilter,g.wrapS=g.wrapT=ClampToEdgeWrapping;var C=new MeshBasicMaterial({map:g,side:DoubleSide,transparent:!0});this.mesh=new Mesh(this.geometry,C),this.mesh.matrixAutoUpdate=!1,this.geometryNeedsUpdate=!0,this.repaint()};VolumeSlice.prototype={constructor:VolumeSlice,repaint:function(){this.geometryNeedsUpdate&&this.updateGeometry();var e=this.iLength,a=this.jLength,d=this.sliceAccess,v=this.volume,g=this.canvasBuffer,C=this.ctxBuffer,w=C.getImageData(0,0,e,a),_=w.data,x=v.data,b=v.upperThreshold,A=v.lowerThreshold,E=v.windowLow,R=v.windowHigh,O=0;if("label"===v.dataType)for(var D=0;D<a;D++)for(var F=0;F<e;F++){var L=x[d(F,D)],I=this.colorMap[L=L>=this.colorMap.length?L%this.colorMap.length+1:L];_[4*O]=I>>24&255,_[4*O+1]=I>>16&255,_[4*O+2]=I>>8&255,_[4*O+3]=255&I,O++}else for(D=0;D<a;D++)for(F=0;F<e;F++){var V=x[d(F,D)],z=255;z=b>=V&&A<=V?z:0,V=Math.floor(255*(V-E)/(R-E)),_[4*O]=V=V>255?255:V<0?0:0|V,_[4*O+1]=V,_[4*O+2]=V,_[4*O+3]=z,O++}C.putImageData(w,0,0),this.ctx.drawImage(g,0,0,e,a,0,0,this.canvas.width,this.canvas.height),this.mesh.material.map.needsUpdate=!0},updateGeometry:function(){var e=this.volume.extractPerpendicularPlane(this.axis,this.index);this.sliceAccess=e.sliceAccess,this.jLength=e.jLength,this.iLength=e.iLength,this.matrix=e.matrix,this.canvas.width=e.planeWidth,this.canvas.height=e.planeHeight,this.canvasBuffer.width=this.iLength,this.canvasBuffer.height=this.jLength,this.ctx=this.canvas.getContext("2d"),this.ctxBuffer=this.canvasBuffer.getContext("2d"),this.geometry&&this.geometry.dispose(),this.geometry=new PlaneBufferGeometry(e.planeWidth,e.planeHeight),this.mesh&&(this.mesh.geometry=this.geometry,this.mesh.matrix.identity(),this.mesh.applyMatrix4(this.matrix)),this.geometryNeedsUpdate=!1}};var Volume=function(e,a,d,v,g){if(arguments.length>0){switch(this.xLength=Number(e)||1,this.yLength=Number(a)||1,this.zLength=Number(d)||1,v){case"Uint8":case"uint8":case"uchar":case"unsigned char":case"uint8_t":default:this.data=new Uint8Array(g);break;case"Int8":case"int8":case"signed char":case"int8_t":this.data=new Int8Array(g);break;case"Int16":case"int16":case"short":case"short int":case"signed short":case"signed short int":case"int16_t":this.data=new Int16Array(g);break;case"Uint16":case"uint16":case"ushort":case"unsigned short":case"unsigned short int":case"uint16_t":this.data=new Uint16Array(g);break;case"Int32":case"int32":case"int":case"signed int":case"int32_t":this.data=new Int32Array(g);break;case"Uint32":case"uint32":case"uint":case"unsigned int":case"uint32_t":this.data=new Uint32Array(g);break;case"longlong":case"long long":case"long long int":case"signed long long":case"signed long long int":case"int64":case"int64_t":case"ulonglong":case"unsigned long long":case"unsigned long long int":case"uint64":case"uint64_t":throw"Error in Volume constructor : this type is not supported in JavaScript";case"Float32":case"float32":case"float":this.data=new Float32Array(g);break;case"Float64":case"float64":case"double":this.data=new Float64Array(g)}if(this.data.length!==this.xLength*this.yLength*this.zLength)throw"Error in Volume constructor, lengths are not matching arrayBuffer size"}this.spacing=[1,1,1],this.offset=[0,0,0],this.matrix=new Matrix3,this.matrix.identity();var C=-1/0;Object.defineProperty(this,"lowerThreshold",{get:function(){return C},set:function(x){C=x,this.sliceList.forEach(function(b){b.geometryNeedsUpdate=!0})}});var w=1/0;Object.defineProperty(this,"upperThreshold",{get:function(){return w},set:function(x){w=x,this.sliceList.forEach(function(b){b.geometryNeedsUpdate=!0})}}),this.sliceList=[]};Volume.prototype={constructor:Volume,getData:function(e,a,d){return this.data[d*this.xLength*this.yLength+a*this.xLength+e]},access:function(e,a,d){return d*this.xLength*this.yLength+a*this.xLength+e},reverseAccess:function(e){var a=Math.floor(e/(this.yLength*this.xLength)),d=Math.floor((e-a*this.yLength*this.xLength)/this.xLength);return[e-a*this.yLength*this.xLength-d*this.xLength,d,a]},map:function(e,a){var d=this.data.length;a=a||this;for(var v=0;v<d;v++)this.data[v]=e.call(a,this.data[v],v,this.data);return this},extractPerpendicularPlane:function extractPerpendicularPlane(axis,RASIndex){var iLength,jLength,sliceAccess,planeMatrix=(new Matrix4).identity(),volume=this,planeWidth,planeHeight,firstSpacing,secondSpacing,positionOffset,IJKIndex,axisInIJK=new Vector3,firstDirection=new Vector3,secondDirection=new Vector3,dimensions=new Vector3(this.xLength,this.yLength,this.zLength);switch(axis){case"x":axisInIJK.set(1,0,0),firstDirection.set(0,0,-1),secondDirection.set(0,-1,0),firstSpacing=this.spacing[2],secondSpacing=this.spacing[1],IJKIndex=new Vector3(RASIndex,0,0),planeMatrix.multiply((new Matrix4).makeRotationY(Math.PI/2)),positionOffset=(volume.RASDimensions[0]-1)/2,planeMatrix.setPosition(new Vector3(RASIndex-positionOffset,0,0));break;case"y":axisInIJK.set(0,1,0),firstDirection.set(1,0,0),secondDirection.set(0,0,1),firstSpacing=this.spacing[0],secondSpacing=this.spacing[2],IJKIndex=new Vector3(0,RASIndex,0),planeMatrix.multiply((new Matrix4).makeRotationX(-Math.PI/2)),positionOffset=(volume.RASDimensions[1]-1)/2,planeMatrix.setPosition(new Vector3(0,RASIndex-positionOffset,0));break;default:axisInIJK.set(0,0,1),firstDirection.set(1,0,0),secondDirection.set(0,-1,0),firstSpacing=this.spacing[0],secondSpacing=this.spacing[1],IJKIndex=new Vector3(0,0,RASIndex),positionOffset=(volume.RASDimensions[2]-1)/2,planeMatrix.setPosition(new Vector3(0,0,RASIndex-positionOffset))}firstDirection.applyMatrix4(volume.inverseMatrix).normalize(),firstDirection.argVar="i",secondDirection.applyMatrix4(volume.inverseMatrix).normalize(),secondDirection.argVar="j",axisInIJK.applyMatrix4(volume.inverseMatrix).normalize(),iLength=Math.floor(Math.abs(firstDirection.dot(dimensions))),jLength=Math.floor(Math.abs(secondDirection.dot(dimensions))),planeWidth=Math.abs(iLength*firstSpacing),planeHeight=Math.abs(jLength*secondSpacing),IJKIndex=Math.abs(Math.round(IJKIndex.applyMatrix4(volume.inverseMatrix).dot(axisInIJK)));var base=[new Vector3(1,0,0),new Vector3(0,1,0),new Vector3(0,0,1)],iDirection=[firstDirection,secondDirection,axisInIJK].find(function(s){return Math.abs(s.dot(base[0]))>.9}),jDirection=[firstDirection,secondDirection,axisInIJK].find(function(s){return Math.abs(s.dot(base[1]))>.9}),kDirection=[firstDirection,secondDirection,axisInIJK].find(function(s){return Math.abs(s.dot(base[2]))>.9}),argumentsWithInversion=["volume.xLength-1-","volume.yLength-1-","volume.zLength-1-"],argArray=[iDirection,jDirection,kDirection].map(function(s,e){return(s.dot(base[e])>0?"":argumentsWithInversion[e])+(s===axisInIJK?"IJKIndex":s.argVar)}),argString=argArray.join(",");return sliceAccess=eval("(function sliceAccess (i,j) {return volume.access( "+argString+");})"),{iLength:iLength,jLength:jLength,sliceAccess:sliceAccess,matrix:planeMatrix,planeWidth:planeWidth,planeHeight:planeHeight}},extractSlice:function(e,a){var d=new VolumeSlice(this,a,e);return this.sliceList.push(d),d},repaintAllSlices:function(){return this.sliceList.forEach(function(e){e.repaint()}),this},computeMinMax:function(){var e=1/0,a=-1/0,d=this.data.length,v=0;for(v=0;v<d;v++)if(!isNaN(this.data[v])){var g=this.data[v];e=Math.min(e,g),a=Math.max(a,g)}return this.min=e,this.max=a,[e,a]}};var NRRDLoader=function(e){Loader.call(this,e)};NRRDLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:NRRDLoader,load:function(e,a,d,v){var g=this,C=new FileLoader(g.manager);C.setPath(g.path),C.setResponseType("arraybuffer"),C.load(e,function(w){a(g.parse(w))},d,v)},parse:function(e){var a=e,d=0,v=new Int8Array(new Int16Array([1]).buffer)[0]>0,C={},A=function(K,ee){null==ee&&(ee=1);var Q=1,oe=Uint8Array;var me=new oe(a.slice(d,d+=ee*Q));return 1!=v&&(me=function(K,ee){for(var Q=new Uint8Array(K.buffer,K.byteOffset,K.byteLength),oe=0;oe<K.byteLength;oe+=ee)for(var me=oe+ee-1,fe=oe;me>fe;me--,fe++){var ge=Q[fe];Q[fe]=Q[me],Q[me]=ge}return K}(me,Q)),1==ee?me[0]:me}(0,e.byteLength),E=A.length,R=null,O=0;for(D=1;D<E;D++)if(10==A[D-1]&&10==A[D]){R=this.parseChars(A,0,D-2),O=D+1;break}if(function(K){var ee,Q,oe,me,fe,ge,$,ue,Y;for(ue=0,Y=(ge=K.split(/\r?\n/)).length;ue<Y;ue++)(fe=ge[ue]).match(/NRRD\d+/)?C.isNrrd=!0:fe.match(/^#/)||($=fe.match(/(.*):(.*)/))&&(Q=$[1].trim(),ee=$[2].trim(),(oe=NRRDLoader.prototype.fieldFunctions[Q])?oe.call(C,ee):C[Q]=ee);if(!C.isNrrd)throw new Error("Not an NRRD file");if("bz2"===C.encoding||"bzip2"===C.encoding)throw new Error("Bzip is not supported");if(!C.vectors&&(C.vectors=[new Vector3(1,0,0),new Vector3(0,1,0),new Vector3(0,0,1)],C.spacings))for(me=0;me<=2;me++)isNaN(C.spacings[me])||C.vectors[me].multiplyScalar(C.spacings[me])}(R),a=A.subarray(O),"gzip"===C.encoding||"gz"===C.encoding){var F=new Zlib.Gunzip(new Uint8Array(a));a=F.decompress()}else if("ascii"===C.encoding||"text"===C.encoding||"txt"===C.encoding||"hex"===C.encoding)a=function(K,ee,Q){var oe="";ee=ee||0,Q=Q||K.length;var me,fe=C.sizes.reduce(function(se,ve){return se*ve},1),ge=10;"hex"===C.encoding&&(ge=16);var $=new C.__array(fe),ue=0,Y=parseInt;(C.__array===Float32Array||C.__array===Float64Array)&&(Y=parseFloat);for(var Z=ee;Z<Q;Z++)((me=K[Z])<9||me>13)&&32!==me?oe+=String.fromCharCode(me):(""!==oe&&($[ue]=Y(oe,ge),ue++),oe="");return""!==oe&&($[ue]=Y(oe,ge),ue++),$}(a);else if("raw"===C.encoding){for(var L=new Uint8Array(a.length),D=0;D<a.length;D++)L[D]=a[D];a=L}a=a.buffer;var I=new Volume;I.header=C,I.data=new C.__array(a);var V=I.computeMinMax(),z=V[0],H=V[1];I.windowLow=z,I.windowHigh=H,I.dimensions=[C.sizes[0],C.sizes[1],C.sizes[2]],I.xLength=I.dimensions[0],I.yLength=I.dimensions[1],I.zLength=I.dimensions[2];var X=new Vector3(C.vectors[0][0],C.vectors[0][1],C.vectors[0][2]).length(),re=new Vector3(C.vectors[1][0],C.vectors[1][1],C.vectors[1][2]).length(),j=new Vector3(C.vectors[2][0],C.vectors[2][1],C.vectors[2][2]).length();I.spacing=[X,re,j],I.matrix=new Matrix4;var te=1,J=1;if("left-posterior-superior"==C.space?(te=-1,J=-1):"left-anterior-superior"===C.space&&(te=-1),C.vectors){var U=C.vectors;I.matrix.set(te*U[0][0],te*U[1][0],te*U[2][0],0,J*U[0][1],J*U[1][1],J*U[2][1],0,1*U[0][2],1*U[1][2],1*U[2][2],0,0,0,0,1)}else I.matrix.set(te,0,0,0,0,J,0,0,0,0,1,0,0,0,0,1);return I.inverseMatrix=new Matrix4,I.inverseMatrix.getInverse(I.matrix),I.RASDimensions=new Vector3(I.xLength,I.yLength,I.zLength).applyMatrix4(I.matrix).round().toArray().map(Math.abs),I.lowerThreshold===-1/0&&(I.lowerThreshold=z),I.upperThreshold===1/0&&(I.upperThreshold=H),I},parseChars:function(e,a,d){void 0===a&&(a=0),void 0===d&&(d=e.length);var v="",g=0;for(g=a;g<d;++g)v+=String.fromCharCode(e[g]);return v},fieldFunctions:{type:function(e){switch(e){case"uchar":case"unsigned char":case"uint8":case"uint8_t":this.__array=Uint8Array;break;case"signed char":case"int8":case"int8_t":this.__array=Int8Array;break;case"short":case"short int":case"signed short":case"signed short int":case"int16":case"int16_t":this.__array=Int16Array;break;case"ushort":case"unsigned short":case"unsigned short int":case"uint16":case"uint16_t":this.__array=Uint16Array;break;case"int":case"signed int":case"int32":case"int32_t":this.__array=Int32Array;break;case"uint":case"unsigned int":case"uint32":case"uint32_t":this.__array=Uint32Array;break;case"float":this.__array=Float32Array;break;case"double":this.__array=Float64Array;break;default:throw new Error("Unsupported NRRD data type: "+e)}return this.type=e},endian:function(e){return this.endian=e},encoding:function(e){return this.encoding=e},dimension:function(e){return this.dim=parseInt(e,10)},sizes:function(e){return this.sizes=function(){var d,v,g,C;for(C=[],d=0,v=(g=e.split(/\s+/)).length;d<v;d++)C.push(parseInt(g[d],10));return C}()},space:function(e){return this.space=e},"space origin":function(e){return this.space_origin=e.split("(")[1].split(")")[0].split(",")},"space directions":function(e){var d,v;return d=e.match(/\(.*?\)/g),this.vectors=function(){var g,C,w;for(w=[],g=0,C=d.length;g<C;g++)v=d[g],w.push(function(){var _,x,b,A;for(A=[],_=0,x=(b=v.slice(1,-1).split(/,/)).length;_<x;_++)A.push(parseFloat(b[_]));return A}());return w}()},spacings:function(e){var d;return d=e.split(/\s+/),this.spacings=function(){var v,g,C=[];for(v=0,g=d.length;v<g;v++)C.push(parseFloat(d[v]));return C}()}}});var MtlObjBridge={link:function(e,a){"function"==typeof a.addMaterials&&a.addMaterials(this.addMaterialsFromMtlLoader(e),!0)},addMaterialsFromMtlLoader:function(e){var a={};return e instanceof MTLLoader.MaterialCreator&&(e.preload(),a=e.materials),a}};function LineDashedMaterial(s){LineBasicMaterial.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(s)}function MeshDepthMaterial(s){Material.call(this),this.type="MeshDepthMaterial",this.depthPacking=BasicDepthPacking,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(s)}function MeshDistanceMaterial(s){Material.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new Vector3,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(s)}function MeshNormalMaterial(s){Material.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(s)}function RawShaderMaterial(s){ShaderMaterial.call(this,s),this.type="RawShaderMaterial"}function ShadowMaterial(s){Material.call(this),this.type="ShadowMaterial",this.color=new Color(0),this.transparent=!0,this.setValues(s)}function SpriteMaterial(s){Material.call(this),this.type="SpriteMaterial",this.color=new Color(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(s)}LineDashedMaterial.prototype=Object.create(LineBasicMaterial.prototype),LineDashedMaterial.prototype.constructor=LineDashedMaterial,LineDashedMaterial.prototype.isLineDashedMaterial=!0,LineDashedMaterial.prototype.copy=function(s){return LineBasicMaterial.prototype.copy.call(this,s),this.scale=s.scale,this.dashSize=s.dashSize,this.gapSize=s.gapSize,this},MeshDepthMaterial.prototype=Object.create(Material.prototype),MeshDepthMaterial.prototype.constructor=MeshDepthMaterial,MeshDepthMaterial.prototype.isMeshDepthMaterial=!0,MeshDepthMaterial.prototype.copy=function(s){return Material.prototype.copy.call(this,s),this.depthPacking=s.depthPacking,this.skinning=s.skinning,this.morphTargets=s.morphTargets,this.map=s.map,this.alphaMap=s.alphaMap,this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this},MeshDistanceMaterial.prototype=Object.create(Material.prototype),MeshDistanceMaterial.prototype.constructor=MeshDistanceMaterial,MeshDistanceMaterial.prototype.isMeshDistanceMaterial=!0,MeshDistanceMaterial.prototype.copy=function(s){return Material.prototype.copy.call(this,s),this.referencePosition.copy(s.referencePosition),this.nearDistance=s.nearDistance,this.farDistance=s.farDistance,this.skinning=s.skinning,this.morphTargets=s.morphTargets,this.map=s.map,this.alphaMap=s.alphaMap,this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this},MeshNormalMaterial.prototype=Object.create(Material.prototype),MeshNormalMaterial.prototype.constructor=MeshNormalMaterial,MeshNormalMaterial.prototype.isMeshNormalMaterial=!0,MeshNormalMaterial.prototype.copy=function(s){return Material.prototype.copy.call(this,s),this.bumpMap=s.bumpMap,this.bumpScale=s.bumpScale,this.normalMap=s.normalMap,this.normalMapType=s.normalMapType,this.normalScale.copy(s.normalScale),this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this.wireframe=s.wireframe,this.wireframeLinewidth=s.wireframeLinewidth,this.skinning=s.skinning,this.morphTargets=s.morphTargets,this.morphNormals=s.morphNormals,this},RawShaderMaterial.prototype=Object.create(ShaderMaterial.prototype),RawShaderMaterial.prototype.constructor=RawShaderMaterial,RawShaderMaterial.prototype.isRawShaderMaterial=!0,ShadowMaterial.prototype=Object.create(Material.prototype),ShadowMaterial.prototype.constructor=ShadowMaterial,ShadowMaterial.prototype.isShadowMaterial=!0,ShadowMaterial.prototype.copy=function(s){return Material.prototype.copy.call(this,s),this.color.copy(s.color),this},SpriteMaterial.prototype=Object.create(Material.prototype),SpriteMaterial.prototype.constructor=SpriteMaterial,SpriteMaterial.prototype.isSpriteMaterial=!0,SpriteMaterial.prototype.copy=function(s){return Material.prototype.copy.call(this,s),this.color.copy(s.color),this.map=s.map,this.alphaMap=s.alphaMap,this.rotation=s.rotation,this.sizeAttenuation=s.sizeAttenuation,this};var Materials={LineBasicMaterial:LineBasicMaterial,LineDashedMaterial:LineDashedMaterial,MeshBasicMaterial:MeshBasicMaterial,MeshDepthMaterial:MeshDepthMaterial,MeshDistanceMaterial:MeshDistanceMaterial,MeshLambertMaterial:MeshLambertMaterial,MeshNormalMaterial:MeshNormalMaterial,MeshPhongMaterial:MeshPhongMaterial,MeshPhysicalMaterial:MeshPhysicalMaterial,MeshStandardMaterial:MeshStandardMaterial,MeshToonMaterial:MeshToonMaterial,PointsMaterial:PointsMaterial,RawShaderMaterial:RawShaderMaterial,ShaderMaterial:ShaderMaterial,ShadowMaterial:ShadowMaterial,SpriteMaterial:SpriteMaterial};function MaterialLoader(s){Loader.call(this,s),this.textures={}}MaterialLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:MaterialLoader,load:function(e,a,d,v){var g=this,C=new FileLoader(g.manager);C.setPath(g.path),C.load(e,function(w){a(g.parse(JSON.parse(w)))},d,v)},parse:function(e){var a=this.textures;function d(x){return void 0===a[x]&&console.warn("MaterialLoader: Undefined texture",x),a[x]}var v=new Materials[e.type];if(void 0!==e.uuid&&(v.uuid=e.uuid),void 0!==e.name&&(v.name=e.name),void 0!==e.color&&v.color.setHex(e.color),void 0!==e.roughness&&(v.roughness=e.roughness),void 0!==e.metalness&&(v.metalness=e.metalness),void 0!==e.sheen&&(v.sheen=(new Color).setHex(e.sheen)),void 0!==e.emissive&&v.emissive.setHex(e.emissive),void 0!==e.specular&&v.specular.setHex(e.specular),void 0!==e.shininess&&(v.shininess=e.shininess),void 0!==e.clearcoat&&(v.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(v.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.vertexColors&&(v.vertexColors=e.vertexColors),void 0!==e.fog&&(v.fog=e.fog),void 0!==e.flatShading&&(v.flatShading=e.flatShading),void 0!==e.blending&&(v.blending=e.blending),void 0!==e.combine&&(v.combine=e.combine),void 0!==e.side&&(v.side=e.side),void 0!==e.opacity&&(v.opacity=e.opacity),void 0!==e.transparent&&(v.transparent=e.transparent),void 0!==e.alphaTest&&(v.alphaTest=e.alphaTest),void 0!==e.depthTest&&(v.depthTest=e.depthTest),void 0!==e.depthWrite&&(v.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(v.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(v.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(v.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(v.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(v.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(v.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(v.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(v.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(v.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(v.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(v.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(v.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(v.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(v.rotation=e.rotation),1!==e.linewidth&&(v.linewidth=e.linewidth),void 0!==e.dashSize&&(v.dashSize=e.dashSize),void 0!==e.gapSize&&(v.gapSize=e.gapSize),void 0!==e.scale&&(v.scale=e.scale),void 0!==e.polygonOffset&&(v.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(v.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(v.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(v.skinning=e.skinning),void 0!==e.morphTargets&&(v.morphTargets=e.morphTargets),void 0!==e.morphNormals&&(v.morphNormals=e.morphNormals),void 0!==e.dithering&&(v.dithering=e.dithering),void 0!==e.visible&&(v.visible=e.visible),void 0!==e.toneMapped&&(v.toneMapped=e.toneMapped),void 0!==e.userData&&(v.userData=e.userData),void 0!==e.uniforms)for(var g in e.uniforms){var C=e.uniforms[g];switch(v.uniforms[g]={},C.type){case"t":v.uniforms[g].value=d(C.value);break;case"c":v.uniforms[g].value=(new Color).setHex(C.value);break;case"v2":v.uniforms[g].value=(new Vector2).fromArray(C.value);break;case"v3":v.uniforms[g].value=(new Vector3).fromArray(C.value);break;case"v4":v.uniforms[g].value=(new Vector4).fromArray(C.value);break;case"m3":v.uniforms[g].value=(new Matrix3).fromArray(C.value);case"m4":v.uniforms[g].value=(new Matrix4).fromArray(C.value);break;default:v.uniforms[g].value=C.value}}if(void 0!==e.defines&&(v.defines=e.defines),void 0!==e.vertexShader&&(v.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(v.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(var w in e.extensions)v.extensions[w]=e.extensions[w];if(void 0!==e.shading&&(v.flatShading=1===e.shading),void 0!==e.size&&(v.size=e.size),void 0!==e.sizeAttenuation&&(v.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(v.map=d(e.map)),void 0!==e.matcap&&(v.matcap=d(e.matcap)),void 0!==e.alphaMap&&(v.alphaMap=d(e.alphaMap),v.transparent=!0),void 0!==e.bumpMap&&(v.bumpMap=d(e.bumpMap)),void 0!==e.bumpScale&&(v.bumpScale=e.bumpScale),void 0!==e.normalMap&&(v.normalMap=d(e.normalMap)),void 0!==e.normalMapType&&(v.normalMapType=e.normalMapType),void 0!==e.normalScale){var _=e.normalScale;!1===Array.isArray(_)&&(_=[_,_]),v.normalScale=(new Vector2).fromArray(_)}return void 0!==e.displacementMap&&(v.displacementMap=d(e.displacementMap)),void 0!==e.displacementScale&&(v.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(v.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(v.roughnessMap=d(e.roughnessMap)),void 0!==e.metalnessMap&&(v.metalnessMap=d(e.metalnessMap)),void 0!==e.emissiveMap&&(v.emissiveMap=d(e.emissiveMap)),void 0!==e.emissiveIntensity&&(v.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(v.specularMap=d(e.specularMap)),void 0!==e.envMap&&(v.envMap=d(e.envMap)),void 0!==e.envMapIntensity&&(v.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(v.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(v.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(v.lightMap=d(e.lightMap)),void 0!==e.lightMapIntensity&&(v.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(v.aoMap=d(e.aoMap)),void 0!==e.aoMapIntensity&&(v.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(v.gradientMap=d(e.gradientMap)),void 0!==e.clearcoatNormalMap&&(v.clearcoatNormalMap=d(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(v.clearcoatNormalScale=(new Vector2).fromArray(e.clearcoatNormalScale)),v},setTextures:function(e){return this.textures=e,this}});var MaterialHandler=function(){this.logging={enabled:!1,debug:!1},this.callbacks={onLoadMaterials:null},this.materials={}};MaterialHandler.prototype={constructor:MaterialHandler,setLogging:function(e,a){this.logging.enabled=!0===e,this.logging.debug=!0===a},_setCallbacks:function(e){null!=e&&e instanceof Function&&(this.callbacks.onLoadMaterials=e)},createDefaultMaterials:function(e){var a=new MeshStandardMaterial({color:14479871});a.name="defaultMaterial";var d=new MeshStandardMaterial({color:14479871});d.name="defaultVertexColorMaterial",d.vertexColors=VertexColors;var v=new LineBasicMaterial;v.name="defaultLineMaterial";var g=new PointsMaterial({size:.1});g.name="defaultPointMaterial";var C={};C[a.name]=a,C[d.name]=d,C[v.name]=v,C[g.name]=g,this.addMaterials(C,e)},addPayloadMaterials:function(e){var a,d,v=e.materials.materialCloneInstructions,g={};if(null!=v){var C=v.materialNameOrg,w=this.materials[C=null!=C?C:""];w?((a=w.clone()).name=d=v.materialName,Object.assign(a,v.materialProperties),this.materials[d]=a,g[d]=a):this.logging.enabled&&console.info('Requested material "'+C+'" is not available!')}var _=e.materials.serializedMaterials;if(null!=_&&Object.keys(_).length>0){var b,x=new MaterialLoader;for(d in _)null!=(b=_[d])&&(a=x.parse(b),this.logging.enabled&&console.info('De-serialized material with name "'+d+'" will be added.'),this.materials[d]=a,g[d]=a)}return this.addMaterials(_=e.materials.runtimeMaterials,!0,g)},addMaterials:function(e,a,d){var v,C;if(null==d&&(d={}),null!=e&&Object.keys(e).length>0)for(var w in e)v=e[w],(C=!0===a)||(C=null==this.materials[w]),C&&(this.materials[w]=v,d[w]=v),this.logging.enabled&&this.logging.debug&&console.info('Material with name "'+w+'" was added.');return this.callbacks.onLoadMaterials&&this.callbacks.onLoadMaterials(d),d},getMaterials:function(){return this.materials},getMaterial:function(e){return this.materials[e]},getMaterialsJSON:function(){var e={};for(var d in this.materials)e[d]=this.materials[d].toJSON();return e},clearMaterials:function(){this.materials={}}};var MeshReceiver=function(e){this.logging={enabled:!1,debug:!1},this.callbacks={onProgress:null,onMeshAlter:null},this.materialHandler=e};MeshReceiver.prototype={constructor:MeshReceiver,setLogging:function(e,a){this.logging.enabled=!0===e,this.logging.debug=!0===a},_setCallbacks:function(e,a){null!=e&&e instanceof Function&&(this.callbacks.onProgress=e),null!=a&&a instanceof Function&&(this.callbacks.onMeshAlter=a)},buildMeshes:function(e){var a=e.params.meshName,d=e.buffers,v=new BufferGeometry;null!=d.vertices&&v.setAttribute("position",new BufferAttribute(new Float32Array(d.vertices),3)),null!=d.indices&&v.setIndex(new BufferAttribute(new Uint32Array(d.indices),1)),null!=d.colors&&v.setAttribute("color",new BufferAttribute(new Float32Array(d.colors),3)),null!=d.normals?v.setAttribute("normal",new BufferAttribute(new Float32Array(d.normals),3)):v.computeVertexNormals(),null!=d.uvs&&v.setAttribute("uv",new BufferAttribute(new Float32Array(d.uvs),2)),null!=d.skinIndex&&v.setAttribute("skinIndex",new BufferAttribute(new Uint16Array(d.skinIndex),4)),null!=d.skinWeight&&v.setAttribute("skinWeight",new BufferAttribute(new Float32Array(d.skinWeight),4));var g,w,_=e.materials.materialNames,x=e.materials.multiMaterial,b=[];for(w in _)g=this.materialHandler.getMaterial(_[w]),x&&b.push(g);if(x){g=b;var E,A=e.materials.materialGroups;for(w in A)v.addGroup((E=A[w]).start,E.count,E.index)}var O,D,R=[],F=!0,L=null===e.geometryType?0:e.geometryType;if(this.callbacks.onMeshAlter&&(D=this.callbacks.onMeshAlter({detail:{meshName:a,bufferGeometry:v,material:g,geometryType:L}})),D)if(D.isDisregardMesh())F=!1;else if(D.providesAlteredMeshes()){for(var I in D.meshes)R.push(D.meshes[I]);F=!1}F&&(e.computeBoundingSphere&&v.computeBoundingSphere(),(O=0===L?new Mesh(v,g):1===L?new LineSegments(v,g):new Points(v,g)).name=a,R.push(O));var V=e.params.meshName;if(R.length>0){var z=[];for(var H in R)z[H]=(O=R[H]).name;V+=": Adding mesh(es) ("+z.length+": "+z+") from input mesh: "+a,V+=" ("+(100*e.progress.numericalValue).toFixed(2)+"%)"}else V+=": Not adding mesh: "+a,V+=" ("+(100*e.progress.numericalValue).toFixed(2)+"%)";return this.callbacks.onProgress&&this.callbacks.onProgress("progress",V,e.progress.numericalValue),R}};var LoadedMeshUserOverride=function(e,a){this.disregardMesh=!0===e,this.alteredMesh=!0===a,this.meshes=[]};LoadedMeshUserOverride.prototype={constructor:LoadedMeshUserOverride,addMesh:function(e){this.meshes.push(e),this.alteredMesh=!0},isDisregardMesh:function(){return this.disregardMesh},providesAlteredMeshes:function(){return this.alteredMesh}};var CodeSerializer={serializeClass:function(e,a,d,v){var g,C,w,_,x,b=a.constructor.name,A=[],E=[],R=[],O=null!=d;for(var D in Array.isArray(v)||(v=[]),e.prototype)g=e.prototype[D],(_=new CodeSerializationInstruction(D,b+".prototype."+D)).setCode(g.toString()),"constructor"===D?_.isRemoveCode()||(C=b+" = "+_.getCode()+";\n\n"):"function"==typeof g&&((x=v[D])instanceof CodeSerializationInstruction&&x.getName()===_.getName()&&(_=x),_.isRemoveCode()||A.push(O?_.getFullName()+" = "+_.getCode()+";\n\n":"\t"+_.getName()+": "+_.getCode()+",\n\n"));for(var F in e)g=e[F],_=new CodeSerializationInstruction(F,b+"."+F),"function"==typeof g?((x=v[F])instanceof CodeSerializationInstruction&&x.getName()===_.getName()?_=x:_.setCode(g.toString()),_.isRemoveCode()||R.push(_.getFullName()+" = "+_.getCode()+";\n\n")):("string"==typeof g||g instanceof String?_.setCode('"'+g.toString()+'"'):"object"==typeof g?(console.log('Omitting object "'+_.getName()+'" and replace it with empty object.'),_.setCode("{}")):_.setCode(g),_.isRemoveCode()||E.push(_.getFullName()+" = "+_.getCode()+";\n"));var L=C+"\n\n";for(O&&(L+=b+".prototype = Object.create( "+d+".prototype );\n"),L+=b+".prototype.constructor = "+b+";\n",L+="\n\n",w=0;w<E.length;w++)L+=E[w];for(L+="\n\n",w=0;w<R.length;w++)L+=R[w];if(L+="\n\n",O)for(w=0;w<A.length;w++)L+=A[w];else{for(L+=b+".prototype = {\n\n",w=0;w<A.length;w++)L+=A[w];L+="\n};"}return L+"\n\n"}},CodeSerializationInstruction=function(e,a){this.name=e,this.fullName=a,this.code=null,this.removeCode=!1};CodeSerializationInstruction.prototype={constructor:CodeSerializationInstruction,getName:function(){return this.name},getFullName:function(){return this.fullName},setCode:function(e){return this.code=e,this},getCode:function(){return this.code},setRemoveCode:function(e){return this.removeCode=e,this},isRemoveCode:function(){return this.removeCode}};var CodeBuilderInstructions=function(e,a,d){this.supportsStandardWorker=e,this.supportsJsmWorker=a,this.preferJsmWorker=d,this.startCode="",this.codeFragments=[],this.importStatements=[],this.jsmWorkerFile=null,this.defaultGeometryType=0};CodeBuilderInstructions.prototype={constructor:CodeBuilderInstructions,isSupportsStandardWorker:function(){return this.supportsStandardWorker},isSupportsJsmWorker:function(){return this.supportsJsmWorker},isPreferJsmWorker:function(){return this.preferJsmWorker},setJsmWorkerFile:function(e){null!=e&&(this.jsmWorkerFile=e)},addStartCode:function(e){this.startCode=e},addCodeFragment:function(e){this.codeFragments.push(e)},addLibraryImport:function(e){var a=new URL(e,window.location.href).href;this.importStatements.push('importScripts( "'+a+'" );')},getImportStatements:function(){return this.importStatements},getCodeFragments:function(){return this.codeFragments},getStartCode:function(){return this.startCode}};var WorkerExecutionSupport=function(){if(void 0===window.Worker)throw"This browser does not support web workers!";if(void 0===window.Blob)throw"This browser does not support Blob!";if("function"!=typeof window.URL.createObjectURL)throw"This browser does not support Object creation from URL!";this._reset()};WorkerExecutionSupport.WORKER_SUPPORT_VERSION="3.1.0",console.info("Using WorkerSupport version: "+WorkerExecutionSupport.WORKER_SUPPORT_VERSION),WorkerExecutionSupport.prototype={constructor:WorkerExecutionSupport,_reset:function(){this.logging={enabled:!1,debug:!1};var e=this;this.worker={native:null,jsmWorker:!1,logging:!0,workerRunner:{name:"WorkerRunner",usesMeshDisassembler:!1,defaultGeometryType:0},terminateWorkerOnLoad:!0,forceWorkerDataCopy:!1,started:!1,queuedMessage:null,callbacks:{onAssetAvailable:null,onLoad:null,terminate:function(){e._terminate()}}}},setLogging:function(e,a){return this.logging.enabled=!0===e,this.logging.debug=!0===a,this.worker.logging=!0===e,this},setForceWorkerDataCopy:function(e){return this.worker.forceWorkerDataCopy=!0===e,this},setTerminateWorkerOnLoad:function(e){return this.worker.terminateWorkerOnLoad=!0===e,this.worker.terminateWorkerOnLoad&&this.isWorkerLoaded(this.worker.jsmWorker)&&null===this.worker.queuedMessage&&this.worker.started&&(this.logging.enabled&&console.info("Worker is terminated immediately as it is not running!"),this._terminate()),this},updateCallbacks:function(e,a){null!=e&&(this.worker.callbacks.onAssetAvailable=e),null!=a&&(this.worker.callbacks.onLoad=a),this._verifyCallbacks()},_verifyCallbacks:function(){if(null==this.worker.callbacks.onAssetAvailable)throw'Unable to run as no "onAssetAvailable" callback is set.'},buildWorker:function(e){var a=!1;e.isSupportsJsmWorker()&&e.isPreferJsmWorker()&&(a=this._buildWorkerJsm(e)),!a&&e.isSupportsStandardWorker()&&this._buildWorkerStandard(e)},_buildWorkerJsm:function(e){var a=!0,d="buildWorkerJsm";if(!this._buildWorkerCheckPreconditions(!0,d)){var g=new URL(e.jsmWorkerFile,window.location.href).href;try{var C=new Worker(g,{type:"module"});this._configureWorkerCommunication(C,!0,e.defaultGeometryType,d)}catch(w){a=!1,(w instanceof TypeError||w instanceof SyntaxError)&&console.error("Modules are not supported in workers.")}}return a},_buildWorkerStandard:function(e){var a="buildWorkerStandard";if(!this._buildWorkerCheckPreconditions(!1,a)){var v="";e.getImportStatements().forEach(function(w){v+=w+"\n"}),v+="\n",e.getCodeFragments().forEach(function(w){v+=w+"\n"}),v+="\n",v+=e.getStartCode();var g=new Blob([v],{type:"application/javascript"}),C=new Worker(window.URL.createObjectURL(g));this._configureWorkerCommunication(C,!1,e.defaultGeometryType,a)}},_buildWorkerCheckPreconditions:function(e,a){var d=!1;return this.isWorkerLoaded(e)?d=!0:this.logging.enabled&&(console.info("WorkerExecutionSupport: Building "+(e?"jsm":"standard")+" worker code..."),console.time(a)),d},_configureWorkerCommunication:function(e,a,d,v){this.worker.native=e,this.worker.jsmWorker=a;var g=this;this.worker.native.onmessage=function(_){g._receiveWorkerMessage(_)},null!=d&&(this.worker.workerRunner.defaultGeometryType=d),this.logging.enabled&&console.timeEnd(v)},isWorkerLoaded:function(e){return null!==this.worker.native&&(e&&this.worker.jsmWorker||!e&&!this.worker.jsmWorker)},_receiveWorkerMessage:function(e){var a=e.data,d=this.worker.workerRunner.name;switch(a.cmd){case"assetAvailable":this.worker.callbacks.onAssetAvailable(a);break;case"completeOverall":this.worker.queuedMessage=null,this.worker.started=!1,null!==this.worker.callbacks.onLoad&&this.worker.callbacks.onLoad(a.msg),this.worker.terminateWorkerOnLoad&&(this.worker.logging.enabled&&console.info("WorkerSupport ["+d+"]: Run is complete. Terminating application on request!"),this.worker.callbacks.terminate());break;case"error":console.error("WorkerSupport ["+d+"]: Reported error: "+a.msg),this.worker.queuedMessage=null,this.worker.started=!1,null!==this.worker.callbacks.onLoad&&this.worker.callbacks.onLoad(a.msg),this.worker.terminateWorkerOnLoad&&(this.worker.logging.enabled&&console.info("WorkerSupport ["+d+"]: Run reported error. Terminating application on request!"),this.worker.callbacks.terminate());break;default:console.error("WorkerSupport ["+d+"]: Received unknown command: "+a.cmd)}},executeParallel:function(e,a){e.cmd="parse",e.usesMeshDisassembler=this.worker.workerRunner.usesMeshDisassembler,e.defaultGeometryType=this.worker.workerRunner.defaultGeometryType,this._verifyWorkerIsAvailable(e,a)&&this._postMessage()},_verifyWorkerIsAvailable:function(e,a){this._verifyCallbacks();var d=!0;return null!==this.worker.queuedMessage?(console.warn("Already processing message. Rejecting new run instruction"),d=!1):(this.worker.queuedMessage={payload:e,transferables:null==a?[]:a},this.worker.started=!0),d},_postMessage:function(){if(null!==this.worker.queuedMessage)if(this.worker.queuedMessage.payload.data.input instanceof ArrayBuffer){var e=[];e.push(this.worker.forceWorkerDataCopy?this.worker.queuedMessage.payload.data.input.slice(0):this.worker.queuedMessage.payload.data.input),this.worker.queuedMessage.transferables.length>0&&(e=e.concat(this.worker.queuedMessage.transferables)),this.worker.native.postMessage(this.worker.queuedMessage.payload,e)}else this.worker.native.postMessage(this.worker.queuedMessage.payload)},_terminate:function(){this.worker.native.terminate(),this._reset()}};var OBJLoader2Parser=function(){this.logging={enabled:!1,debug:!1};var e=this;this.callbacks={onProgress:function(d){e._onProgress(d)},onAssetAvailable:function(d){e._onAssetAvailable(d)},onError:function(d){e._onError(d)},onLoad:function(d,v){e._onLoad(d,v)}},this.contentRef=null,this.legacyMode=!1,this.materials={},this.materialPerSmoothingGroup=!1,this.useOAsMesh=!1,this.useIndices=!1,this.disregardNormals=!1,this.vertices=[],this.colors=[],this.normals=[],this.uvs=[],this.rawMesh={objectName:"",groupName:"",activeMtlName:"",mtllibName:"",faceType:-1,subGroups:[],subGroupInUse:null,smoothingGroup:{splitMaterials:!1,normalized:-1,real:-1},counts:{doubleIndicesCount:0,faceCount:0,mtlCount:0,smoothingGroupCount:0}},this.inputObjectCount=1,this.outputObjectCount=1,this.globalCounts={vertices:0,faces:0,doubleIndicesCount:0,lineByte:0,currentByte:0,totalBytes:0}};OBJLoader2Parser.prototype={constructor:OBJLoader2Parser,_resetRawMesh:function(){this.rawMesh.subGroups=[],this.rawMesh.subGroupInUse=null,this.rawMesh.smoothingGroup.normalized=-1,this.rawMesh.smoothingGroup.real=-1,this._pushSmoothingGroup(1),this.rawMesh.counts.doubleIndicesCount=0,this.rawMesh.counts.faceCount=0,this.rawMesh.counts.mtlCount=0,this.rawMesh.counts.smoothingGroupCount=0},setMaterialPerSmoothingGroup:function(e){return this.materialPerSmoothingGroup=!0===e,this},setUseOAsMesh:function(e){return this.useOAsMesh=!0===e,this},setUseIndices:function(e){return this.useIndices=!0===e,this},setDisregardNormals:function(e){return this.disregardNormals=!0===e,this},setMaterials:function(e){this.materials=Object.assign({},e)},setCallbackOnAssetAvailable:function(e){return null!=e&&e instanceof Function&&(this.callbacks.onAssetAvailable=e),this},setCallbackOnProgress:function(e){return null!=e&&e instanceof Function&&(this.callbacks.onProgress=e),this},setCallbackOnError:function(e){return null!=e&&e instanceof Function&&(this.callbacks.onError=e),this},setCallbackOnLoad:function(e){return null!=e&&e instanceof Function&&(this.callbacks.onLoad=e),this},_onProgress:function(e){this.logging.enabled&&this.logging.debug&&console.log(e||"")},_onError:function(e){this.logging.enabled&&this.logging.debug&&console.error(e)},_onAssetAvailable:function(e){var a="OBJLoader2Parser does not provide implementation for onAssetAvailable. Aborting...";throw this.callbacks.onError(a),a},_onLoad:function(e,a){console.log("You reached parser default onLoad callback: "+a)},setLogging:function(e,a){return this.logging.enabled=!0===e,this.logging.debug=!0===a,this},_configure:function(){if(this._pushSmoothingGroup(1),this.logging.enabled){var e=Object.keys(this.materials),d="OBJLoader.Parser configuration:"+(e.length>0?"\n\tmaterialNames:\n\t\t- "+e.join("\n\t\t- "):"\n\tmaterialNames: None")+"\n\tmaterialPerSmoothingGroup: "+this.materialPerSmoothingGroup+"\n\tuseOAsMesh: "+this.useOAsMesh+"\n\tuseIndices: "+this.useIndices+"\n\tdisregardNormals: "+this.disregardNormals;d+="\n\tcallbacks.onProgress: "+this.callbacks.onProgress.name,d+="\n\tcallbacks.onAssetAvailable: "+this.callbacks.onAssetAvailable.name,d+="\n\tcallbacks.onError: "+this.callbacks.onError.name,console.info(d)}},execute:function(e){this.logging.enabled&&console.time("OBJLoader2Parser.execute"),this._configure();var a=new Uint8Array(e);this.contentRef=a;var d=a.byteLength;this.globalCounts.totalBytes=d;for(var v=new Array(128),g=void 0,C="",w=0,_=0,x=0;x<d;x++)switch(g=a[x],g){case 32:C.length>0&&(v[w++]=C),C="";break;case 47:C.length>0&&(v[w++]=C),_++,C="";break;case 10:C.length>0&&(v[w++]=C),C="",this.globalCounts.lineByte=this.globalCounts.currentByte,this.globalCounts.currentByte=x,this._processLine(v,w,_),w=0,_=0;break;case 13:break;default:C+=String.fromCharCode(g)}this._finalizeParsing(),this.logging.enabled&&console.timeEnd("OBJLoader2Parser.execute")},executeLegacy:function(e){this.logging.enabled&&console.time("OBJLoader2Parser.executeLegacy"),this._configure(),this.legacyMode=!0,this.contentRef=e;var a=e.length;this.globalCounts.totalBytes=a;for(var d=new Array(128),v=void 0,g="",C=0,w=0,_=0;_<a;_++)switch(v=e[_],v){case" ":g.length>0&&(d[C++]=g),g="";break;case"/":g.length>0&&(d[C++]=g),w++,g="";break;case"\n":g.length>0&&(d[C++]=g),g="",this.globalCounts.lineByte=this.globalCounts.currentByte,this.globalCounts.currentByte=_,this._processLine(d,C,w),C=0,w=0;break;case"\r":break;default:g+=v}this._finalizeParsing(),this.logging.enabled&&console.timeEnd("OBJLoader2Parser.executeLegacy")},_processLine:function(e,a,d){if(!(a<1)){var g,C,w,_,v=function(A,E,R,O){var D="";if(O>R){var F;if(E)for(F=R;F<O;F++)D+=A[F];else for(F=R;F<O;F++)D+=String.fromCharCode(A[F]);D=D.trim()}return D};switch(_=e[0]){case"v":this.vertices.push(parseFloat(e[1])),this.vertices.push(parseFloat(e[2])),this.vertices.push(parseFloat(e[3])),a>4&&(this.colors.push(parseFloat(e[4])),this.colors.push(parseFloat(e[5])),this.colors.push(parseFloat(e[6])));break;case"vt":this.uvs.push(parseFloat(e[1])),this.uvs.push(parseFloat(e[2]));break;case"vn":this.normals.push(parseFloat(e[1])),this.normals.push(parseFloat(e[2])),this.normals.push(parseFloat(e[3]));break;case"f":if(g=a-1,0===d)for(this._checkFaceType(0),w=2,C=g;w<C;w++)this._buildFace(e[1]),this._buildFace(e[w]),this._buildFace(e[w+1]);else if(g===2*d)for(this._checkFaceType(1),w=3,C=g-2;w<C;w+=2)this._buildFace(e[1],e[2]),this._buildFace(e[w],e[w+1]),this._buildFace(e[w+2],e[w+3]);else if(2*g==3*d)for(this._checkFaceType(2),w=4,C=g-3;w<C;w+=3)this._buildFace(e[1],e[2],e[3]),this._buildFace(e[w],e[w+1],e[w+2]),this._buildFace(e[w+3],e[w+4],e[w+5]);else for(this._checkFaceType(3),w=3,C=g-2;w<C;w+=2)this._buildFace(e[1],void 0,e[2]),this._buildFace(e[w],void 0,e[w+1]),this._buildFace(e[w+2],void 0,e[w+3]);break;case"l":case"p":if((g=a-1)==2*d)for(this._checkFaceType(4),w=1,C=g+1;w<C;w+=2)this._buildFace(e[w],e[w+1]);else for(this._checkFaceType("l"===_?5:6),w=1,C=g+1;w<C;w++)this._buildFace(e[w]);break;case"s":this._pushSmoothingGroup(e[1]);break;case"g":this._processCompletedMesh(),this.rawMesh.groupName=v(this.contentRef,this.legacyMode,this.globalCounts.lineByte+2,this.globalCounts.currentByte);break;case"o":this.useOAsMesh&&this._processCompletedMesh(),this.rawMesh.objectName=v(this.contentRef,this.legacyMode,this.globalCounts.lineByte+2,this.globalCounts.currentByte);break;case"mtllib":this.rawMesh.mtllibName=v(this.contentRef,this.legacyMode,this.globalCounts.lineByte+7,this.globalCounts.currentByte);break;case"usemtl":var x=v(this.contentRef,this.legacyMode,this.globalCounts.lineByte+7,this.globalCounts.currentByte);""!==x&&this.rawMesh.activeMtlName!==x&&(this.rawMesh.activeMtlName=x,this.rawMesh.counts.mtlCount++,this._checkSubGroup())}}},_pushSmoothingGroup:function(e){var a=parseInt(e);isNaN(a)&&(a="off"===e?0:1);var d=this.rawMesh.smoothingGroup.normalized;this.rawMesh.smoothingGroup.normalized=this.rawMesh.smoothingGroup.splitMaterials?a:0===a?0:1,this.rawMesh.smoothingGroup.real=a,d!==a&&(this.rawMesh.counts.smoothingGroupCount++,this._checkSubGroup())},_checkFaceType:function(e){this.rawMesh.faceType!==e&&(this._processCompletedMesh(),this.rawMesh.faceType=e,this._checkSubGroup())},_checkSubGroup:function(){var e=this.rawMesh.activeMtlName+"|"+this.rawMesh.smoothingGroup.normalized;this.rawMesh.subGroupInUse=this.rawMesh.subGroups[e],null==this.rawMesh.subGroupInUse&&(this.rawMesh.subGroupInUse={index:e,objectName:this.rawMesh.objectName,groupName:this.rawMesh.groupName,materialName:this.rawMesh.activeMtlName,smoothingGroup:this.rawMesh.smoothingGroup.normalized,vertices:[],indexMappingsCount:0,indexMappings:[],indices:[],colors:[],uvs:[],normals:[]},this.rawMesh.subGroups[e]=this.rawMesh.subGroupInUse)},_buildFace:function(e,a,d){var v=this.rawMesh.subGroupInUse,g=this,C=function(){var b=parseInt(e),A=3*(b>0?b-1:b+g.vertices.length/3),E=g.colors.length>0?A:null,R=v.vertices;if(R.push(g.vertices[A++]),R.push(g.vertices[A++]),R.push(g.vertices[A]),null!==E){var O=v.colors;O.push(g.colors[E++]),O.push(g.colors[E++]),O.push(g.colors[E])}if(a){var D=parseInt(a),F=2*(D>0?D-1:D+g.uvs.length/2),L=v.uvs;L.push(g.uvs[F++]),L.push(g.uvs[F])}if(d&&!g.disregardNormals){var I=parseInt(d),V=3*(I>0?I-1:I+g.normals.length/3),z=v.normals;z.push(g.normals[V++]),z.push(g.normals[V++]),z.push(g.normals[V])}};if(this.useIndices){this.disregardNormals&&(d=void 0);var w=e+(a?"_"+a:"_n")+(d?"_"+d:"_n"),_=v.indexMappings[w];null==_?(_=this.rawMesh.subGroupInUse.vertices.length/3,C(),v.indexMappings[w]=_,v.indexMappingsCount++):this.rawMesh.counts.doubleIndicesCount++,v.indices.push(_)}else C();this.rawMesh.counts.faceCount++},_createRawMeshReport:function(e){return"Input Object number: "+e+"\n\tObject name: "+this.rawMesh.objectName+"\n\tGroup name: "+this.rawMesh.groupName+"\n\tMtllib name: "+this.rawMesh.mtllibName+"\n\tVertex count: "+this.vertices.length/3+"\n\tNormal count: "+this.normals.length/3+"\n\tUV count: "+this.uvs.length/2+"\n\tSmoothingGroup count: "+this.rawMesh.counts.smoothingGroupCount+"\n\tMaterial count: "+this.rawMesh.counts.mtlCount+"\n\tReal MeshOutputGroup count: "+this.rawMesh.subGroups.length},_finalizeRawMesh:function(){var a,x,e=[],d=0,v=0,g=0,C=0,w=0,_=0;for(var b in this.rawMesh.subGroups)if((a=this.rawMesh.subGroups[b]).vertices.length>0){if((x=a.indices).length>0&&v>0)for(var A=0;A<x.length;A++)x[A]=x[A]+v;e.push(a),d+=a.vertices.length,v+=a.indexMappingsCount,g+=a.indices.length,C+=a.colors.length,_+=a.uvs.length,w+=a.normals.length}var E=null;return e.length>0&&(E={name:""!==this.rawMesh.groupName?this.rawMesh.groupName:this.rawMesh.objectName,subGroups:e,absoluteVertexCount:d,absoluteIndexCount:g,absoluteColorCount:C,absoluteNormalCount:w,absoluteUvCount:_,faceCount:this.rawMesh.counts.faceCount,doubleIndicesCount:this.rawMesh.counts.doubleIndicesCount}),E},_processCompletedMesh:function(){var e=this._finalizeRawMesh(),a=null!==e;return a&&(this.colors.length>0&&this.colors.length!==this.vertices.length&&this.callbacks.onError("Vertex Colors were detected, but vertex count and color count do not match!"),this.logging.enabled&&this.logging.debug&&console.debug(this._createRawMeshReport(this.inputObjectCount)),this.inputObjectCount++,this._buildMesh(e),this._onProgress("Completed [o: "+this.rawMesh.objectName+" g:"+this.rawMesh.groupName+"] Total progress: "+(this.globalCounts.currentByte/this.globalCounts.totalBytes*100).toFixed(2)+"%"),this._resetRawMesh()),a},_buildMesh:function(e){var a=e.subGroups,d=new Float32Array(e.absoluteVertexCount);this.globalCounts.vertices+=e.absoluteVertexCount/3,this.globalCounts.faces+=e.faceCount,this.globalCounts.doubleIndicesCount+=e.doubleIndicesCount;var x,O,te,J,k,v=e.absoluteIndexCount>0?new Uint32Array(e.absoluteIndexCount):null,g=e.absoluteColorCount>0?new Float32Array(e.absoluteColorCount):null,C=e.absoluteNormalCount>0?new Float32Array(e.absoluteNormalCount):null,w=e.absoluteUvCount>0?new Float32Array(e.absoluteUvCount):null,_=null!==g,b=[],A=a.length>1,E=0,R=[],F=[],L=0,I=0,V=0,z=0,H=0,X=0,re=0;for(var U in a)if(a.hasOwnProperty(U)){if(k=(x=a[U]).materialName,te=this.materials[J=this.rawMesh.faceType<4?k+(_?"_vertexColor":"")+(0===x.smoothingGroup?"_flat":""):6===this.rawMesh.faceType?"defaultPointMaterial":"defaultLineMaterial"],null==this.materials[k]&&null==te&&(te=this.materials[J=_?"defaultVertexColorMaterial":"defaultMaterial"],this.logging.enabled&&console.info('object_group "'+x.objectName+"_"+x.groupName+'" was defined with unresolvable material "'+k+'"! Assigning "'+J+'".')),null==te){var K={materialNameOrg:k,materialName:J,materialProperties:{vertexColors:_?2:0,flatShading:0===x.smoothingGroup}};this.callbacks.onAssetAvailable({cmd:"assetAvailable",type:"material",materials:{materialCloneInstructions:K}}),null==this.materials[J]&&(this.materials[J]=K)}A?((O=R[J])||(O=E,R[J]=E,b.push(J),E++),F.push({start:X,count:re=this.useIndices?x.indices.length:x.vertices.length/3,index:O}),X+=re):b.push(J),d.set(x.vertices,L),L+=x.vertices.length,v&&(v.set(x.indices,I),I+=x.indices.length),g&&(g.set(x.colors,V),V+=x.colors.length),C&&(C.set(x.normals,z),z+=x.normals.length),w&&(w.set(x.uvs,H),H+=x.uvs.length),this.logging.enabled&&this.logging.debug&&console.debug("\tOutput Object no.: "+this.outputObjectCount+"\n\t\tgroupName: "+x.groupName+"\n\t\tIndex: "+x.index+"\n\t\tfaceType: "+this.rawMesh.faceType+"\n\t\tmaterialName: "+x.materialName+"\n\t\tsmoothingGroup: "+x.smoothingGroup+(null==O?"":"\n\t\tmaterialIndex: "+O)+"\n\t\tobjectName: "+x.objectName+"\n\t\t#vertices: "+x.vertices.length/3+"\n\t\t#indices: "+x.indices.length+"\n\t\t#colors: "+x.colors.length/3+"\n\t\t#uvs: "+x.uvs.length/2+"\n\t\t#normals: "+x.normals.length/3)}this.outputObjectCount++,this.callbacks.onAssetAvailable({cmd:"assetAvailable",type:"mesh",progress:{numericalValue:this.globalCounts.currentByte/this.globalCounts.totalBytes},params:{meshName:e.name},materials:{multiMaterial:A,materialNames:b,materialGroups:F},buffers:{vertices:d,indices:v,colors:g,normals:C,uvs:w},geometryType:this.rawMesh.faceType<4?0:6===this.rawMesh.faceType?2:1},[d.buffer],null!==v?[v.buffer]:null,null!==g?[g.buffer]:null,null!==C?[C.buffer]:null,null!==w?[w.buffer]:null)},_finalizeParsing:function(){this.logging.enabled&&console.info("Global output object count: "+this.outputObjectCount),this._processCompletedMesh()&&this.logging.enabled&&console.info("Overall counts: \n\tVertices: "+this.globalCounts.vertices+"\n\tFaces: "+this.globalCounts.faces+"\n\tMultiple definitions: "+this.globalCounts.doubleIndicesCount)}};var ObjectManipulator=function(){};ObjectManipulator.prototype={constructor:ObjectManipulator,applyProperties:function(e,a,d){var v,g,C;if(null!=e&&null!=a)for(v in a)g="set"+v.substring(0,1).toLocaleUpperCase()+v.substring(1),C=a[v],"function"==typeof e[g]?e[g](C):(e.hasOwnProperty(v)||d)&&(e[v]=C)}};var DefaultWorkerPayloadHandler=function(e){this.parser=e,this.logging={enabled:!1,debug:!1}};DefaultWorkerPayloadHandler.prototype={constructor:DefaultWorkerPayloadHandler,handlePayload:function(e){if(e.logging&&(this.logging.enabled=!0===e.logging.enabled,this.logging.debug=!0===e.logging.debug),"parse"===e.cmd){var a=this,d={callbackOnAssetAvailable:function(x){self.postMessage(x)},callbackOnProgress:function(x){a.logging.enabled&&a.logging.debug&&console.debug("WorkerRunner: progress: "+x)}},v=this.parser;"function"==typeof v.setLogging&&v.setLogging(this.logging.enabled,this.logging.debug);var g=new ObjectManipulator;g.applyProperties(v,e.params,!1),g.applyProperties(v,d,!1);var C=e.data.input,w="execute";"function"==typeof v.getParseFunctionName&&(w=v.getParseFunctionName()),e.usesMeshDisassembler||v[w](C,e.data.options),this.logging.enabled&&console.log("WorkerRunner: Run complete!"),self.postMessage({cmd:"completeOverall",msg:"WorkerRunner completed run."})}else console.error("WorkerRunner: Received unknown command: "+e.cmd)}};var WorkerRunner=function(e){this.payloadHandler=e;var a=this;self.addEventListener("message",function(g){a.processMessage(g.data)},!1)};WorkerRunner.prototype={constructor:WorkerRunner,processMessage:function(e){this.payloadHandler.handlePayload(e)}};var OBJLoader=function(){var s=/^[og]\s*(.+)?/,e=/^mtllib /,a=/^usemtl /,d=/^usemap /;function v(){var C={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(_,x){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=_,void(this.object.fromDeclaration=!1!==x);var b=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:_||"",fromDeclaration:!1!==x,geometry:{vertices:[],normals:[],colors:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(R,O){var D=this._finalize(!1);D&&(D.inherited||D.groupCount<=0)&&this.materials.splice(D.index,1);var F={index:this.materials.length,name:R||"",mtllib:Array.isArray(O)&&O.length>0?O[O.length-1]:"",smooth:void 0!==D?D.smooth:this.smooth,groupStart:void 0!==D?D.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(I){var V={index:"number"==typeof I?I:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return V.clone=this.clone.bind(V),V}};return this.materials.push(F),F},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(R){var O=this.currentMaterial();if(O&&-1===O.groupEnd&&(O.groupEnd=this.geometry.vertices.length/3,O.groupCount=O.groupEnd-O.groupStart,O.inherited=!1),R&&this.materials.length>1)for(var D=this.materials.length-1;D>=0;D--)this.materials[D].groupCount<=0&&this.materials.splice(D,1);return R&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),O}},b&&b.name&&"function"==typeof b.clone){var A=b.clone(0);A.inherited=!0,this.object.materials.push(A)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(_,x){var b=parseInt(_,10);return 3*(b>=0?b-1:b+x/3)},parseNormalIndex:function(_,x){var b=parseInt(_,10);return 3*(b>=0?b-1:b+x/3)},parseUVIndex:function(_,x){var b=parseInt(_,10);return 2*(b>=0?b-1:b+x/2)},addVertex:function(_,x,b){var A=this.vertices,E=this.object.geometry.vertices;E.push(A[_+0],A[_+1],A[_+2]),E.push(A[x+0],A[x+1],A[x+2]),E.push(A[b+0],A[b+1],A[b+2])},addVertexPoint:function(_){var x=this.vertices;this.object.geometry.vertices.push(x[_+0],x[_+1],x[_+2])},addVertexLine:function(_){var x=this.vertices;this.object.geometry.vertices.push(x[_+0],x[_+1],x[_+2])},addNormal:function(_,x,b){var A=this.normals,E=this.object.geometry.normals;E.push(A[_+0],A[_+1],A[_+2]),E.push(A[x+0],A[x+1],A[x+2]),E.push(A[b+0],A[b+1],A[b+2])},addColor:function(_,x,b){var A=this.colors,E=this.object.geometry.colors;E.push(A[_+0],A[_+1],A[_+2]),E.push(A[x+0],A[x+1],A[x+2]),E.push(A[b+0],A[b+1],A[b+2])},addUV:function(_,x,b){var A=this.uvs,E=this.object.geometry.uvs;E.push(A[_+0],A[_+1]),E.push(A[x+0],A[x+1]),E.push(A[b+0],A[b+1])},addUVLine:function(_){var x=this.uvs;this.object.geometry.uvs.push(x[_+0],x[_+1])},addFace:function(_,x,b,A,E,R,O,D,F){var L=this.vertices.length,I=this.parseVertexIndex(_,L),V=this.parseVertexIndex(x,L),z=this.parseVertexIndex(b,L);if(this.addVertex(I,V,z),this.colors.length>0&&this.addColor(I,V,z),void 0!==A&&""!==A){var H=this.uvs.length;I=this.parseUVIndex(A,H),V=this.parseUVIndex(E,H),z=this.parseUVIndex(R,H),this.addUV(I,V,z)}if(void 0!==O&&""!==O){var X=this.normals.length;I=this.parseNormalIndex(O,X),V=O===D?I:this.parseNormalIndex(D,X),z=O===F?I:this.parseNormalIndex(F,X),this.addNormal(I,V,z)}},addPointGeometry:function(_){this.object.geometry.type="Points";for(var x=this.vertices.length,b=0,A=_.length;b<A;b++)this.addVertexPoint(this.parseVertexIndex(_[b],x))},addLineGeometry:function(_,x){this.object.geometry.type="Line";for(var b=this.vertices.length,A=this.uvs.length,E=0,R=_.length;E<R;E++)this.addVertexLine(this.parseVertexIndex(_[E],b));var O=0;for(R=x.length;O<R;O++)this.addUVLine(this.parseUVIndex(x[O],A))}};return C.startObject("",!1),C}function g(C){Loader.call(this,C),this.materials=null}return g.prototype=Object.assign(Object.create(Loader.prototype),{constructor:g,load:function(w,_,x,b){var A=this,E=new FileLoader(A.manager);E.setPath(this.path),E.load(w,function(R){_(A.parse(R))},x,b)},setMaterials:function(w){return this.materials=w,this},parse:function(w){var _=new v;-1!==w.indexOf("\r\n")&&(w=w.replace(/\r\n/g,"\n")),-1!==w.indexOf("\\\n")&&(w=w.replace(/\\\n/g,""));for(var x=w.split("\n"),b="",A="",R=[],O="function"==typeof"".trimLeft,D=0,F=x.length;D<F;D++)if(b=x[D],0!==(b=O?b.trimLeft():b.trim()).length&&"#"!==(A=b.charAt(0)))if("v"===A){var L=b.split(/\s+/);switch(L[0]){case"v":_.vertices.push(parseFloat(L[1]),parseFloat(L[2]),parseFloat(L[3])),L.length>=7&&_.colors.push(parseFloat(L[4]),parseFloat(L[5]),parseFloat(L[6]));break;case"vn":_.normals.push(parseFloat(L[1]),parseFloat(L[2]),parseFloat(L[3]));break;case"vt":_.uvs.push(parseFloat(L[1]),parseFloat(L[2]))}}else if("f"===A){for(var V=b.substr(1).trim().split(/\s+/),z=[],H=0,X=V.length;H<X;H++){var re=V[H];if(re.length>0){var j=re.split("/");z.push(j)}}var te=z[0];for(H=1,X=z.length-1;H<X;H++){var J=z[H],k=z[H+1];_.addFace(te[0],J[0],k[0],te[1],J[1],k[1],te[2],J[2],k[2])}}else if("l"===A){var U=b.substring(1).trim().split(" "),K=[],ee=[];if(-1===b.indexOf("/"))K=U;else for(var Q=0,oe=U.length;Q<oe;Q++){var me=U[Q].split("/");""!==me[0]&&K.push(me[0]),""!==me[1]&&ee.push(me[1])}_.addLineGeometry(K,ee)}else if("p"===A){var fe=b.substr(1).trim().split(" ");_.addPointGeometry(fe)}else if(null!==(R=s.exec(b))){var ge=(" "+R[0].substr(1).trim()).substr(1);_.startObject(ge)}else if(a.test(b))_.object.startMaterial(b.substring(7).trim(),_.materialLibraries);else if(e.test(b))_.materialLibraries.push(b.substring(7).trim());else if(d.test(b))console.warn('OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if("s"===A){if((R=b.split(" ")).length>1){var $=R[1].trim().toLowerCase();_.object.smooth="0"!==$&&"off"!==$}else _.object.smooth=!0;(ue=_.object.currentMaterial())&&(ue.smooth=_.object.smooth)}else{if("\0"===b)continue;console.warn('OBJLoader: Unexpected line: "'+b+'"')}_.finalize();var Y=new Group;for(Y.materialLibraries=[].concat(_.materialLibraries),D=0,F=_.objects.length;D<F;D++){var Z=_.objects[D],se=Z.geometry,ve=Z.materials,le="Line"===se.type,_e="Points"===se.type,ae=!1;if(0!==se.vertices.length){var Re,pe=new BufferGeometry;pe.setAttribute("position",new Float32BufferAttribute(se.vertices,3)),se.normals.length>0?pe.setAttribute("normal",new Float32BufferAttribute(se.normals,3)):pe.computeVertexNormals(),se.colors.length>0&&(ae=!0,pe.setAttribute("color",new Float32BufferAttribute(se.colors,3))),se.uvs.length>0&&pe.setAttribute("uv",new Float32BufferAttribute(se.uvs,2));for(var he=[],ce=0,Te=ve.length;ce<Te;ce++){var xe=(be=ve[ce]).name+"_"+be.smooth+"_"+ae,ue=_.materials[xe];if(null!==this.materials)if(ue=this.materials.create(be.name),!le||!ue||ue instanceof LineBasicMaterial){if(_e&&ue&&!(ue instanceof PointsMaterial)){var Ne=new PointsMaterial({size:10,sizeAttenuation:!1});Material.prototype.copy.call(Ne,ue),Ne.color.copy(ue.color),Ne.map=ue.map,ue=Ne}}else{var we=new LineBasicMaterial;Material.prototype.copy.call(we,ue),we.color.copy(ue.color),ue=we}void 0===ue&&((ue=le?new LineBasicMaterial:_e?new PointsMaterial({size:1,sizeAttenuation:!1}):new MeshPhongMaterial).name=be.name,ue.flatShading=!be.smooth,ue.vertexColors=ae?VertexColors:NoColors,_.materials[xe]=ue),he.push(ue)}if(he.length>1){for(ce=0,Te=ve.length;ce<Te;ce++){var be;pe.addGroup((be=ve[ce]).groupStart,be.groupCount,ce)}Re=le?new LineSegments(pe,he):_e?new Points(pe,he):new Mesh(pe,he)}else Re=le?new LineSegments(pe,he[0]):_e?new Points(pe,he[0]):new Mesh(pe,he[0]);Re.name=Z.name,Y.add(Re)}}return Y}}),g}(),OBJLoader2=function(e){Loader.call(this,e),this.parser=new OBJLoader2Parser,this.modelName="",this.instanceNo=0,this.baseObject3d=new Object3D,this.materialHandler=new MaterialHandler,this.meshReceiver=new MeshReceiver(this.materialHandler);var a=this;this.parser.setCallbackOnAssetAvailable(function(g){a._onAssetAvailable(g)})};OBJLoader2.OBJLOADER2_VERSION="3.1.1",console.info("Using OBJLoader2 version: "+OBJLoader2.OBJLOADER2_VERSION),OBJLoader2.prototype=Object.assign(Object.create(Loader.prototype),{constructor:OBJLoader2,setLogging:function(e,a){return this.parser.setLogging(e,a),this},setMaterialPerSmoothingGroup:function(e){return this.parser.setMaterialPerSmoothingGroup(e),this},setUseOAsMesh:function(e){return this.parser.setUseOAsMesh(e),this},setUseIndices:function(e){return this.parser.setUseIndices(e),this},setDisregardNormals:function(e){return this.parser.setDisregardNormals(e),this},setModelName:function(e){return this.modelName=e||this.modelName,this},setBaseObject3d:function(e){return this.baseObject3d=null==e?this.baseObject3d:e,this},addMaterials:function(e,a){return this.materialHandler.addMaterials(e,a),this},setCallbackOnAssetAvailable:function(e){return this.parser.setCallbackOnAssetAvailable(e),this},setCallbackOnProgress:function(e){return this.parser.setCallbackOnProgress(e),this},setCallbackOnError:function(e){return this.parser.setCallbackOnError(e),this},setCallbackOnLoad:function(e){return this.parser.setCallbackOnLoad(e),this},setCallbackOnMeshAlter:function(e){return this.meshReceiver._setCallbacks(this.parser.callbacks.onProgress,e),this},setCallbackOnLoadMaterials:function(e){return this.materialHandler._setCallbacks(e),this},load:function(e,a,d,v,g){var C=this;if(!(null!=a&&a instanceof Function)){var w="onLoad is not a function! Aborting...";throw C.parser.callbacks.onError(w),w}this.parser.setCallbackOnLoad(a),(null==v||!(v instanceof Function))&&(v=function(L){var I=L;L.currentTarget&&null!==L.currentTarget.statusText&&(I="Error occurred while downloading!\nurl: "+L.currentTarget.responseURL+"\nstatus: "+L.currentTarget.statusText),C.parser.callbacks.onError(I)}),e||v("An invalid url was provided. Unable to continue!");var _=new URL(e,window.location.href).href,x=_,b=_.split("/");if(b.length>2){x=b[b.length-1];var A=b.slice(0,b.length-1).join("/")+"/";null!=A&&(this.path=A)}if(null==d||!(d instanceof Function)){var E=0,R=0;d=function(L){if(L.lengthComputable&&(R=L.loaded/L.total)>E){E=R;var I='Download of "'+e+'": '+(100*R).toFixed(2)+"%";C.parser.callbacks.onProgress("progressLoad",I,R)}}}this.setCallbackOnMeshAlter(g);var D=new FileLoader(this.manager);D.setPath(this.path||this.resourcePath),D.setResponseType("arraybuffer"),D.load(x,function(L){C.parser.callbacks.onLoad(C.parse(L),"OBJLoader2#load: Parsing completed")},d,v)},parse:function(e){if(null==e)throw"Provided content is not a valid ArrayBuffer or String. Unable to continue parsing";return this.parser.logging.enabled&&console.time("OBJLoader parse: "+this.modelName),this.materialHandler.createDefaultMaterials(!1),this.parser.setMaterials(this.materialHandler.getMaterials()),e instanceof ArrayBuffer||e instanceof Uint8Array?(this.parser.logging.enabled&&console.info("Parsing arrayBuffer..."),this.parser.execute(e)):"string"==typeof e||e instanceof String?(this.parser.logging.enabled&&console.info("Parsing text..."),this.parser.executeLegacy(e)):this.parser.callbacks.onError("Provided content was neither of type String nor Uint8Array! Aborting..."),this.parser.logging.enabled&&console.timeEnd("OBJLoader parse: "+this.modelName),this.baseObject3d},_onAssetAvailable:function(e){if("assetAvailable"===e.cmd)if("mesh"===e.type)for(var a=this.meshReceiver.buildMeshes(e),d=0,v=a.length;d<v;d++)this.baseObject3d.add(a[d]);else"material"===e.type&&this.materialHandler.addPayloadMaterials(e)}});var OBJLoader2Parallel=function(e){OBJLoader2.call(this,e),this.preferJsmWorker=!1,this.executeParallel=!0,this.workerExecutionSupport=new WorkerExecutionSupport};OBJLoader2Parallel.OBJLOADER2_PARALLEL_VERSION="3.1.2",console.info("Using OBJLoader2Parallel version: "+OBJLoader2Parallel.OBJLOADER2_PARALLEL_VERSION),OBJLoader2Parallel.prototype=Object.assign(Object.create(OBJLoader2.prototype),{constructor:OBJLoader2Parallel,setExecuteParallel:function(e){return this.executeParallel=!0===e,this},setPreferJsmWorker:function(e){return this.preferJsmWorker=!0===e,this},getWorkerExecutionSupport:function(){return this.workerExecutionSupport},buildWorkerCode:function(){var e=new CodeBuilderInstructions(!0,!0,this.preferJsmWorker);if(e.isSupportsJsmWorker()&&e.setJsmWorkerFile("../sources/loaders/obj2/worker/parallel/jsm/OBJLoader2Worker.js"),e.isSupportsStandardWorker()){var a=new ObjectManipulator,d=new DefaultWorkerPayloadHandler(this.parser),v=new WorkerRunner({});e.addCodeFragment(CodeSerializer.serializeClass(OBJLoader2Parser,this.parser)),e.addCodeFragment(CodeSerializer.serializeClass(ObjectManipulator,a)),e.addCodeFragment(CodeSerializer.serializeClass(DefaultWorkerPayloadHandler,d)),e.addCodeFragment(CodeSerializer.serializeClass(WorkerRunner,v)),e.addStartCode("new "+v.constructor.name+"( new "+d.constructor.name+"( new "+this.parser.constructor.name+"() ) );")}return e},load:function(e,a,d,v,g){var C=this;OBJLoader2.prototype.load.call(this,e,function(_,x){"OBJLoader2ParallelDummy"===_.name?C.parser.logging.enabled&&C.parser.logging.debug&&console.debug("Received dummy answer from OBJLoader2Parallel#parse"):a(_,x)},d,v,g)},parse:function(e){if(this.executeParallel){if(this.parser.callbacks.onLoad===this.parser._onLoad)throw"No callback other than the default callback was provided! Aborting!";if(!this.workerExecutionSupport.isWorkerLoaded(this.preferJsmWorker)){this.workerExecutionSupport.buildWorker(this.buildWorkerCode());var d=this;this.workerExecutionSupport.updateCallbacks(function(w){d._onAssetAvailable(w)},function(w){d.parser.callbacks.onLoad(d.baseObject3d,w)})}this.materialHandler.createDefaultMaterials(!1),this.workerExecutionSupport.executeParallel({params:{modelName:this.modelName,instanceNo:this.instanceNo,useIndices:this.parser.useIndices,disregardNormals:this.parser.disregardNormals,materialPerSmoothingGroup:this.parser.materialPerSmoothingGroup,useOAsMesh:this.parser.useOAsMesh,materials:this.materialHandler.getMaterialsJSON()},data:{input:e,options:null},logging:{enabled:this.parser.logging.enabled,debug:this.parser.logging.debug}});var g=new Object3D;return g.name="OBJLoader2ParallelDummy",g}return OBJLoader2.prototype.parse.call(this,e)}});var PCDLoader=function(e){Loader.call(this,e),this.littleEndian=!0};PCDLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:PCDLoader,load:function(e,a,d,v){var g=this,C=new FileLoader(g.manager);C.setPath(g.path),C.setResponseType("arraybuffer"),C.load(e,function(w){try{a(g.parse(w,e))}catch(_){if(!v)throw _;v(_)}},d,v)},parse:function(e,a){var g=LoaderUtils.decodeText(new Uint8Array(e)),C=function(ee){var Q={},oe=ee.search(/[\r\n]DATA\s(\S*)\s/i),me=/[\r\n]DATA\s(\S*)\s/i.exec(ee.substr(oe-1));if(Q.data=me[1],Q.headerLen=me[0].length+oe,Q.str=ee.substr(0,Q.headerLen),Q.str=Q.str.replace(/\#.*/gi,""),Q.version=/VERSION (.*)/i.exec(Q.str),Q.fields=/FIELDS (.*)/i.exec(Q.str),Q.size=/SIZE (.*)/i.exec(Q.str),Q.type=/TYPE (.*)/i.exec(Q.str),Q.count=/COUNT (.*)/i.exec(Q.str),Q.width=/WIDTH (.*)/i.exec(Q.str),Q.height=/HEIGHT (.*)/i.exec(Q.str),Q.viewpoint=/VIEWPOINT (.*)/i.exec(Q.str),Q.points=/POINTS (.*)/i.exec(Q.str),null!==Q.version&&(Q.version=parseFloat(Q.version[1])),null!==Q.fields&&(Q.fields=Q.fields[1].split(" ")),null!==Q.type&&(Q.type=Q.type[1].split(" ")),null!==Q.width&&(Q.width=parseInt(Q.width[1])),null!==Q.height&&(Q.height=parseInt(Q.height[1])),null!==Q.viewpoint&&(Q.viewpoint=Q.viewpoint[1]),null!==Q.points&&(Q.points=parseInt(Q.points[1],10)),null===Q.points&&(Q.points=Q.width*Q.height),null!==Q.size&&(Q.size=Q.size[1].split(" ").map(function(ue){return parseInt(ue,10)})),null!==Q.count)Q.count=Q.count[1].split(" ").map(function(ue){return parseInt(ue,10)});else{Q.count=[];for(var fe=0,ge=Q.fields.length;fe<ge;fe++)Q.count.push(1)}Q.offset={};var $=0;for(fe=0,ge=Q.fields.length;fe<ge;fe++)"ascii"===Q.data?Q.offset[Q.fields[fe]]=fe:(Q.offset[Q.fields[fe]]=$,$+=Q.size[fe]);return Q.rowSize=$,Q}(g),w=[],_=[],x=[];if("ascii"===C.data)for(var b=C.offset,E=g.substr(C.headerLen).split("\n"),R=0,O=E.length;R<O;R++)if(""!==E[R]){var D=E[R].split(" ");if(void 0!==b.x&&(w.push(parseFloat(D[b.x])),w.push(parseFloat(D[b.y])),w.push(parseFloat(D[b.z]))),void 0!==b.rgb){var F=parseFloat(D[b.rgb]);x.push((F>>16&255)/255,(F>>8&255)/255,(F>>0&255)/255)}void 0!==b.normal_x&&(_.push(parseFloat(D[b.normal_x])),_.push(parseFloat(D[b.normal_y])),_.push(parseFloat(D[b.normal_z])))}if("binary_compressed"===C.data){var z=new Uint32Array(e.slice(C.headerLen,C.headerLen+8)),X=z[1],re=function(ee,Q){var $,ue,Y,oe=ee.length,me=new Uint8Array(Q),fe=0,ge=0;do{if(($=ee[fe++])<32){if(ge+ ++$>Q)throw new Error("Output buffer is not large enough");if(fe+$>oe)throw new Error("Invalid compressed data");do{me[ge++]=ee[fe++]}while(--$)}else{if(ue=$>>5,Y=ge-((31&$)<<8)-1,fe>=oe)throw new Error("Invalid compressed data");if(7===ue&&(ue+=ee[fe++],fe>=oe))throw new Error("Invalid compressed data");if(Y-=ee[fe++],ge+ue+2>Q)throw new Error("Output buffer is not large enough");if(Y<0)throw new Error("Invalid compressed data");if(Y>=ge)throw new Error("Invalid compressed data");do{me[ge++]=me[Y++]}while(2+--ue)}}while(fe<oe);return me}(new Uint8Array(e,C.headerLen+8,z[0]),X),j=new DataView(re.buffer);for(b=C.offset,R=0;R<C.points;R++)void 0!==b.x&&(w.push(j.getFloat32(C.points*b.x+C.size[0]*R,this.littleEndian)),w.push(j.getFloat32(C.points*b.y+C.size[1]*R,this.littleEndian)),w.push(j.getFloat32(C.points*b.z+C.size[2]*R,this.littleEndian))),void 0!==b.rgb&&(x.push(j.getUint8(C.points*b.rgb+C.size[3]*R+0)/255),x.push(j.getUint8(C.points*b.rgb+C.size[3]*R+1)/255),x.push(j.getUint8(C.points*b.rgb+C.size[3]*R+2)/255)),void 0!==b.normal_x&&(_.push(j.getFloat32(C.points*b.normal_x+C.size[4]*R,this.littleEndian)),_.push(j.getFloat32(C.points*b.normal_y+C.size[5]*R,this.littleEndian)),_.push(j.getFloat32(C.points*b.normal_z+C.size[6]*R,this.littleEndian)))}if("binary"===C.data){j=new DataView(e,C.headerLen),b=C.offset,R=0;for(var te=0;R<C.points;R++,te+=C.rowSize)void 0!==b.x&&(w.push(j.getFloat32(te+b.x,this.littleEndian)),w.push(j.getFloat32(te+b.y,this.littleEndian)),w.push(j.getFloat32(te+b.z,this.littleEndian))),void 0!==b.rgb&&(x.push(j.getUint8(te+b.rgb+2)/255),x.push(j.getUint8(te+b.rgb+1)/255),x.push(j.getUint8(te+b.rgb+0)/255)),void 0!==b.normal_x&&(_.push(j.getFloat32(te+b.normal_x,this.littleEndian)),_.push(j.getFloat32(te+b.normal_y,this.littleEndian)),_.push(j.getFloat32(te+b.normal_z,this.littleEndian)))}var J=new BufferGeometry;w.length>0&&J.setAttribute("position",new Float32BufferAttribute(w,3)),_.length>0&&J.setAttribute("normal",new Float32BufferAttribute(_,3)),x.length>0&&J.setAttribute("color",new Float32BufferAttribute(x,3)),J.computeBoundingSphere();var k=new PointsMaterial({size:.005});x.length>0?k.vertexColors=VertexColors:k.color.setHex(16777215*Math.random());var U=new Points(J,k),K=a.split("").reverse().join("");return K=(K=/([^\/]*)/.exec(K))[1].split("").reverse().join(""),U.name=K,U}});var PDBLoader=function(e){Loader.call(this,e)};PDBLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:PDBLoader,load:function(e,a,d,v){var g=this,C=new FileLoader(g.manager);C.setPath(g.path),C.load(e,function(w){a(g.parse(w))},d,v)},parse:function(e){function a(z){return z.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function g(z,H){var X=parseInt(F[L].substr(z,H));if(X){var re=function(z,H){return"s"+Math.min(z,H)+"e"+Math.max(z,H)}(V,X);void 0===b[re]&&(x.push([V-1,X-1,1]),b[re]=x.length-1)}}for(var A,E,R,O,D,w={h:[255,255,255],he:[217,255,255],li:[204,128,255],be:[194,255,0],b:[255,181,181],c:[144,144,144],n:[48,80,248],o:[255,13,13],f:[144,224,80],ne:[179,227,245],na:[171,92,242],mg:[138,255,0],al:[191,166,166],si:[240,200,160],p:[255,128,0],s:[255,255,48],cl:[31,240,31],ar:[128,209,227],k:[143,64,212],ca:[61,255,0],sc:[230,230,230],ti:[191,194,199],v:[166,166,171],cr:[138,153,199],mn:[156,122,199],fe:[224,102,51],co:[240,144,160],ni:[80,208,80],cu:[200,128,51],zn:[125,128,176],ga:[194,143,143],ge:[102,143,143],as:[189,128,227],se:[255,161,0],br:[166,41,41],kr:[92,184,209],rb:[112,46,176],sr:[0,255,0],y:[148,255,255],zr:[148,224,224],nb:[115,194,201],mo:[84,181,181],tc:[59,158,158],ru:[36,143,143],rh:[10,125,140],pd:[0,105,133],ag:[192,192,192],cd:[255,217,143],in:[166,117,115],sn:[102,128,128],sb:[158,99,181],te:[212,122,0],i:[148,0,148],xe:[66,158,176],cs:[87,23,143],ba:[0,201,0],la:[112,212,255],ce:[255,255,199],pr:[217,255,199],nd:[199,255,199],pm:[163,255,199],sm:[143,255,199],eu:[97,255,199],gd:[69,255,199],tb:[48,255,199],dy:[31,255,199],ho:[0,255,156],er:[0,230,117],tm:[0,212,82],yb:[0,191,56],lu:[0,171,36],hf:[77,194,255],ta:[77,166,255],w:[33,148,214],re:[38,125,171],os:[38,102,150],ir:[23,84,135],pt:[208,208,224],au:[255,209,35],hg:[184,184,208],tl:[166,84,77],pb:[87,89,97],bi:[158,79,181],po:[171,92,0],at:[117,79,69],rn:[66,130,150],fr:[66,0,102],ra:[0,125,0],ac:[112,171,250],th:[0,186,255],pa:[0,161,255],u:[0,143,255],np:[0,128,255],pu:[0,107,255],am:[84,92,242],cm:[120,92,227],bk:[138,79,227],cf:[161,54,212],es:[179,31,212],fm:[179,31,186],md:[179,13,166],no:[189,13,135],lr:[199,0,102],rf:[204,0,89],db:[209,0,79],sg:[217,0,69],bh:[224,0,56],hs:[230,0,46],mt:[235,0,38],ds:[235,0,38],rg:[235,0,38],cn:[235,0,38],uut:[235,0,38],uuq:[235,0,38],uup:[235,0,38],uuh:[235,0,38],uus:[235,0,38],uuo:[235,0,38]},_=[],x=[],b={},F=e.split("\n"),L=0,I=F.length;L<I;L++)if("ATOM"===F[L].substr(0,4)||"HETATM"===F[L].substr(0,6))A=parseFloat(F[L].substr(30,7)),E=parseFloat(F[L].substr(38,7)),R=parseFloat(F[L].substr(46,7)),O=parseInt(F[L].substr(6,5))-1,""===(D=a(F[L].substr(76,2)).toLowerCase())&&(D=a(F[L].substr(12,2)).toLowerCase()),_[O]=[A,E,R,w[D],(z=D,z.charAt(0).toUpperCase()+z.substr(1).toLowerCase())];else if("CONECT"===F[L].substr(0,6)){var V=parseInt(F[L].substr(6,5));g(11,5),g(16,5),g(21,5),g(26,5)}var z;return function(){var re,j,z={geometryAtoms:new BufferGeometry,geometryBonds:new BufferGeometry,json:{atoms:_,bonds:x}},H=z.geometryAtoms,X=z.geometryBonds,te=[],J=[],k=[];for(re=0,j=_.length;re<j;re++){var U=_[re];te.push(U[0],U[1],U[2]),J.push(U[3][0]/255,U[3][1]/255,U[3][2]/255)}for(re=0,j=x.length;re<j;re++){var ge=x[re],$=ge[0],ue=ge[1];k.push(te[3*$+0]),k.push(te[3*$+1]),k.push(te[3*$+2]),k.push(te[3*ue+0]),k.push(te[3*ue+1]),k.push(te[3*ue+2])}return H.setAttribute("position",new Float32BufferAttribute(te,3)),H.setAttribute("color",new Float32BufferAttribute(J,3)),X.setAttribute("position",new Float32BufferAttribute(k,3)),z}()}});var PLYLoader=function(e){Loader.call(this,e),this.propertyNameMapping={}};PLYLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:PLYLoader,load:function(e,a,d,v){var g=this,C=new FileLoader(this.manager);C.setPath(this.path),C.setResponseType("arraybuffer"),C.load(e,function(w){a(g.parse(w))},d,v)},setPropertyNameMapping:function(e){this.propertyNameMapping=e},parse:function(e){function a(D){var L="",I=0,V=/ply([\s\S]*)end_header\r?\n/.exec(D);null!==V&&(L=V[1],I=V[0].length);for(var X,re,j,U,K,ee,z={comments:[],elements:[],headerLength:I},H=L.split("\n"),J=0;J<H.length;J++){var k=H[J];if(""!==(k=k.trim()))switch(j=k.split(/\s+/),re=j.shift(),k=j.join(" "),re){case"format":z.format=j[0],z.version=j[1];break;case"comment":z.comments.push(k);break;case"element":void 0!==X&&z.elements.push(X),(X={}).name=j[0],X.count=parseInt(j[1]),X.properties=[];break;case"property":X.properties.push((K=E.propertyNameMapping,ee=void 0,"list"===(ee={type:(U=j)[0]}).type?(ee.name=U[3],ee.countType=U[1],ee.itemType=U[2]):ee.name=U[1],ee.name in K&&(ee.name=K[ee.name]),ee));break;default:console.log("unhandled",re,j)}}return void 0!==X&&z.elements.push(X),z}function d(D,F){switch(F){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return parseInt(D);case"float":case"double":case"float32":case"float64":return parseFloat(D)}}function v(D,F){for(var L=F.split(/\s+/),I={},V=0;V<D.length;V++)if("list"===D[V].type){for(var z=[],H=d(L.shift(),D[V].countType),X=0;X<H;X++)z.push(d(L.shift(),D[V].itemType));I[D[V].name]=z}else I[D[V].name]=d(L.shift(),D[V].type);return I}function g(D,F){var I,L={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},z="";null!==(I=/end_header\s([\s\S]*)$/.exec(D))&&(z=I[1]);for(var H=z.split("\n"),X=0,re=0,j=0;j<H.length;j++){var te=H[j];if(""!==(te=te.trim())){re>=F.elements[X].count&&(X++,re=0);var J=v(F.elements[X].properties,te);w(L,F.elements[X].name,J),re++}}return C(L)}function C(D){var F=new BufferGeometry;return D.indices.length>0&&F.setIndex(D.indices),F.setAttribute("position",new Float32BufferAttribute(D.vertices,3)),D.normals.length>0&&F.setAttribute("normal",new Float32BufferAttribute(D.normals,3)),D.uvs.length>0&&F.setAttribute("uv",new Float32BufferAttribute(D.uvs,2)),D.colors.length>0&&F.setAttribute("color",new Float32BufferAttribute(D.colors,3)),D.faceVertexUvs.length>0&&(F=F.toNonIndexed()).setAttribute("uv",new Float32BufferAttribute(D.faceVertexUvs,2)),F.computeBoundingSphere(),F}function w(D,F,L){if("vertex"===F)D.vertices.push(L.x,L.y,L.z),"nx"in L&&"ny"in L&&"nz"in L&&D.normals.push(L.nx,L.ny,L.nz),"s"in L&&"t"in L&&D.uvs.push(L.s,L.t),"red"in L&&"green"in L&&"blue"in L&&D.colors.push(L.red/255,L.green/255,L.blue/255);else if("face"===F){var I=L.vertex_indices||L.vertex_index,V=L.texcoord;3===I.length?(D.indices.push(I[0],I[1],I[2]),V&&6===V.length&&(D.faceVertexUvs.push(V[0],V[1]),D.faceVertexUvs.push(V[2],V[3]),D.faceVertexUvs.push(V[4],V[5]))):4===I.length&&(D.indices.push(I[0],I[1],I[3]),D.indices.push(I[1],I[2],I[3]))}}function _(D,F,L,I){switch(L){case"int8":case"char":return[D.getInt8(F),1];case"uint8":case"uchar":return[D.getUint8(F),1];case"int16":case"short":return[D.getInt16(F,I),2];case"uint16":case"ushort":return[D.getUint16(F,I),2];case"int32":case"int":return[D.getInt32(F,I),4];case"uint32":case"uint":return[D.getUint32(F,I),4];case"float32":case"float":return[D.getFloat32(F,I),4];case"float64":case"double":return[D.getFloat64(F,I),8]}}function x(D,F,L,I){for(var z,V={},H=0,X=0;X<L.length;X++)if("list"===L[X].type){var re=[],j=(z=_(D,F+H,L[X].countType,I))[0];H+=z[1];for(var te=0;te<j;te++)z=_(D,F+H,L[X].itemType,I),re.push(z[0]),H+=z[1];V[L[X].name]=re}else z=_(D,F+H,L[X].type,I),V[L[X].name]=z[0],H+=z[1];return[V,H]}var A,E=this;if(e instanceof ArrayBuffer){var R=LoaderUtils.decodeText(new Uint8Array(e)),O=a(R);A="ascii"===O.format?g(R,O):function(D,F){for(var z,L={indices:[],vertices:[],normals:[],uvs:[],faceVertexUvs:[],colors:[]},I="binary_little_endian"===F.format,V=new DataView(D,F.headerLength),H=0,X=0;X<F.elements.length;X++)for(var re=0;re<F.elements[X].count;re++)H+=(z=x(V,H,F.elements[X].properties,I))[1],w(L,F.elements[X].name,z[0]);return C(L)}(e,O)}else A=g(e,a(e));return A}});var PRWMLoader=function(){var s=null;function e(){if(null===s){var w=new ArrayBuffer(2),_=new Uint8Array(w),x=new Uint16Array(w);_[0]=170,_[1]=187,s=43707===x[0]}return s}var a=[null,Float32Array,null,Int8Array,Int16Array,null,Int32Array,Uint8Array,Uint16Array,null,Uint32Array],d={Uint16Array:"getUint16",Uint32Array:"getUint32",Int16Array:"getInt16",Int32Array:"getInt32",Float32Array:"getFloat32",Float64Array:"getFloat64"};function v(w,_,x,b,A){var R,E=_.BYTES_PER_ELEMENT;if(A===e()||1===E)R=new _(w,x,b);else{var O=new DataView(w,x,b*E),D=d[_.name],F=!A,L=0;for(R=new _(b);L<b;L++)R[L]=O[D](L*E,F)}return R}function C(w){Loader.call(this,w)}return C.prototype=Object.assign(Object.create(Loader.prototype),{constructor:C,load:function(_,x,b,A){var E=this,R=new FileLoader(E.manager);R.setPath(E.path),R.setResponseType("arraybuffer"),_=_.replace(/\*/g,e()?"be":"le"),R.load(_,function(O){x(E.parse(O))},b,A)},parse:function(_){var E,R,x=function(w){var _=new Uint8Array(w),x=_[0],b=_[1],A=!!(b>>7&1),E=b>>6&1,R=1==(b>>5&1),O=31&b,D=0,F=0;if(R?(D=(_[2]<<16)+(_[3]<<8)+_[4],F=(_[5]<<16)+(_[6]<<8)+_[7]):(D=_[2]+(_[3]<<8)+(_[4]<<16),F=_[5]+(_[6]<<8)+(_[7]<<16)),0===x)throw new Error("PRWM decoder: Invalid format version: 0");if(1!==x)throw new Error("PRWM decoder: Unsupported format version: "+x);if(!A){if(0!==E)throw new Error("PRWM decoder: Indices type must be set to 0 for non-indexed geometries");if(0!==F)throw new Error("PRWM decoder: Number of indices must be set to 0 for non-indexed geometries")}var V,z,H,X,j,te,J,k,L=8,I={};for(k=0;k<O;k++){for(V="";L<_.length&&(z=_[L],L++,0!==z);)V+=String.fromCharCode(z);H=(b=_[L])>>7&1,X=1+(b>>4&3),L++,te=v(w,j=a[15&b],L=4*Math.ceil(L/4),X*D,R),L+=j.BYTES_PER_ELEMENT*X*D,I[V]={type:H,cardinality:X,values:te}}return L=4*Math.ceil(L/4),J=null,A&&(J=v(w,1===E?Uint32Array:Uint16Array,L,F,R)),{version:x,attributes:I,indices:J}}(_),b=Object.keys(x.attributes),A=new BufferGeometry;for(R=0;R<b.length;R++)A.setAttribute(b[R],new BufferAttribute((E=x.attributes[b[R]]).values,E.cardinality,E.normalized));return null!==x.indices&&A.setIndex(new BufferAttribute(x.indices,1)),A}}),C.isBigEndianPlatform=function(){return e()},C}(),PVRLoader=function(e){CompressedTextureLoader.call(this,e)};PVRLoader.prototype=Object.assign(Object.create(CompressedTextureLoader.prototype),{constructor:PVRLoader,parse:function(e,a){var v=new Uint32Array(e,0,13),g={buffer:e,header:v,loadMipmaps:a};return 55727696===v[0]?PVRLoader._parseV3(g):559044176===v[11]?PVRLoader._parseV2(g):void console.error("PVRLoader: Unknown PVR format.")}}),PVRLoader._parseV3=function(s){var a,d,e=s.header,v=e[12],g=e[2],C=e[6],w=e[7],_=e[10],x=e[11];switch(g){case 0:a=2,d=RGB_PVRTC_2BPPV1_Format;break;case 1:a=2,d=RGBA_PVRTC_2BPPV1_Format;break;case 2:a=4,d=RGB_PVRTC_4BPPV1_Format;break;case 3:a=4,d=RGBA_PVRTC_4BPPV1_Format;break;default:console.error("PVRLoader: Unsupported PVR format:",g)}return s.dataPtr=52+v,s.bpp=a,s.format=d,s.width=w,s.height=C,s.numSurfaces=_,s.numMipmaps=x,s.isCubemap=6===_,PVRLoader._extract(s)},PVRLoader._parseV2=function(s){var R,O,e=s.header,a=e[0],d=e[1],v=e[2],g=e[3],_=e[12],E=255&e[4],D=e[10]>0;return 25===E?(O=D?RGBA_PVRTC_4BPPV1_Format:RGB_PVRTC_4BPPV1_Format,R=4):24===E?(O=D?RGBA_PVRTC_2BPPV1_Format:RGB_PVRTC_2BPPV1_Format,R=2):console.error("PVRLoader: Unknown PVR format:",E),s.dataPtr=a,s.bpp=R,s.format=O,s.width=v,s.height=d,s.numSurfaces=_,s.numMipmaps=g+1,s.isCubemap=6===_,PVRLoader._extract(s)},PVRLoader._extract=function(s){var w,e={mipmaps:[],width:s.width,height:s.height,format:s.format,mipmapCount:s.numMipmaps,isCubemap:s.isCubemap},a=s.buffer,d=s.dataPtr,v=s.bpp,g=s.numSurfaces,C=0,_=0,x=0,b=0,A=0;2===v?(_=8,x=4):(_=4,x=4),w=_*x*v/8,e.mipmaps.length=s.numMipmaps*g;for(var E=0;E<s.numMipmaps;){var R=s.width>>E,O=s.height>>E;(b=R/_)<2&&(b=2),(A=O/x)<2&&(A=2),C=b*A*w;for(var D=0;D<g;D++){var F=new Uint8Array(a,d,C);e.mipmaps[D*s.numMipmaps+E]={data:F,width:R,height:O},d+=C}E++}return e};var STLLoader=function(e){Loader.call(this,e)};function EllipseCurve(s,e,a,d,v,g,C,w){Curve.call(this),this.type="EllipseCurve",this.aX=s||0,this.aY=e||0,this.xRadius=a||1,this.yRadius=d||1,this.aStartAngle=v||0,this.aEndAngle=g||2*Math.PI,this.aClockwise=C||!1,this.aRotation=w||0}function ArcCurve(s,e,a,d,v,g){EllipseCurve.call(this,s,e,a,a,d,v,g),this.type="ArcCurve"}function CubicPoly(){var s=0,e=0,a=0,d=0;function v(g,C,w,_){s=g,e=w,a=-3*g+3*C-2*w-_,d=2*g-2*C+w+_}return{initCatmullRom:function(C,w,_,x,b){v(w,_,b*(_-C),b*(x-w))},initNonuniformCatmullRom:function(C,w,_,x,b,A,E){var R=(w-C)/b-(_-C)/(b+A)+(_-w)/A,O=(_-w)/A-(x-w)/(A+E)+(x-_)/E;v(w,_,R*=A,O*=A)},calc:function(C){var w=C*C;return s+e*C+a*w+d*(w*C)}}}STLLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:STLLoader,load:function(e,a,d,v){var g=this,C=new FileLoader(g.manager);C.setPath(g.path),C.setResponseType("arraybuffer"),C.load(e,function(w){try{a(g.parse(w))}catch(_){v&&v(_)}},d,v)},parse:function(e){function d(x,b,A){for(var E=0,R=x.length;E<R;E++)if(x[E]!==b.getUint8(A+E,!1))return!1;return!0}var x,_=function(x){if("string"==typeof x){for(var b=new Uint8Array(x.length),A=0;A<x.length;A++)b[A]=255&x.charCodeAt(A);return b.buffer||b}return x}(e);return function(x){var R;if(84+50*(R=new DataView(x)).getUint32(80,!0)===R.byteLength)return!0;for(var O=[115,111,108,105,100],D=0;D<5;D++)if(d(O,R,D))return!1;return!0}(_)?function(x){for(var E,R,O,F,L,I,V,z,b=new DataView(x),A=b.getUint32(80,!0),D=!1,H=0;H<70;H++)1129270351==b.getUint32(H,!1)&&82==b.getUint8(H+4)&&61==b.getUint8(H+5)&&(D=!0,F=new Float32Array(3*A*3),L=b.getUint8(H+6)/255,I=b.getUint8(H+7)/255,V=b.getUint8(H+8)/255,z=b.getUint8(H+9)/255);for(var j=new BufferGeometry,te=new Float32Array(3*A*3),J=new Float32Array(3*A*3),k=0;k<A;k++){var U=84+50*k,K=b.getFloat32(U,!0),ee=b.getFloat32(U+4,!0),Q=b.getFloat32(U+8,!0);if(D){var oe=b.getUint16(U+48,!0);0==(32768&oe)?(E=(31&oe)/31,R=(oe>>5&31)/31,O=(oe>>10&31)/31):(E=L,R=I,O=V)}for(var me=1;me<=3;me++){var fe=U+12*me,ge=3*k*3+3*(me-1);te[ge]=b.getFloat32(fe,!0),te[ge+1]=b.getFloat32(fe+4,!0),te[ge+2]=b.getFloat32(fe+8,!0),J[ge]=K,J[ge+1]=ee,J[ge+2]=Q,D&&(F[ge]=E,F[ge+1]=R,F[ge+2]=O)}}return j.setAttribute("position",new BufferAttribute(te,3)),j.setAttribute("normal",new BufferAttribute(J,3)),D&&(j.setAttribute("color",new BufferAttribute(F,3)),j.hasColors=!0,j.alpha=z),j}(_):function(x){for(var z,b=new BufferGeometry,A=/solid([\s\S]*?)endsolid/g,E=/facet([\s\S]*?)endfacet/g,R=0,O=/[\s]+([+-]?(?:\d*)(?:\.\d*)?(?:[eE][+-]?\d+)?)/.source,D=new RegExp("vertex"+O+O+O,"g"),F=new RegExp("normal"+O+O+O,"g"),L=[],I=[],V=new Vector3,H=0,X=0,re=0;null!==(z=A.exec(x));){X=re;for(var j=z[0];null!==(z=E.exec(j));){for(var te=0,J=0,k=z[0];null!==(z=F.exec(k));)V.x=parseFloat(z[1]),V.y=parseFloat(z[2]),V.z=parseFloat(z[3]),J++;for(;null!==(z=D.exec(k));)L.push(parseFloat(z[1]),parseFloat(z[2]),parseFloat(z[3])),I.push(V.x,V.y,V.z),te++,re++;1!==J&&console.error("STLLoader: Something isn't right with the normal of face number "+R),3!==te&&console.error("STLLoader: Something isn't right with the vertices of face number "+R),R++}b.addGroup(X,re-X,H),H++}return b.setAttribute("position",new Float32BufferAttribute(L,3)),b.setAttribute("normal",new Float32BufferAttribute(I,3)),b}("string"!=typeof(x=e)?LoaderUtils.decodeText(new Uint8Array(x)):x)}}),EllipseCurve.prototype=Object.create(Curve.prototype),EllipseCurve.prototype.constructor=EllipseCurve,EllipseCurve.prototype.isEllipseCurve=!0,EllipseCurve.prototype.getPoint=function(s,e){for(var a=e||new Vector2,d=2*Math.PI,v=this.aEndAngle-this.aStartAngle,g=Math.abs(v)<Number.EPSILON;v<0;)v+=d;for(;v>d;)v-=d;v<Number.EPSILON&&(v=g?0:d),!0===this.aClockwise&&!g&&(v===d?v=-d:v-=d);var C=this.aStartAngle+s*v,w=this.aX+this.xRadius*Math.cos(C),_=this.aY+this.yRadius*Math.sin(C);if(0!==this.aRotation){var x=Math.cos(this.aRotation),b=Math.sin(this.aRotation),A=w-this.aX,E=_-this.aY;w=A*x-E*b+this.aX,_=A*b+E*x+this.aY}return a.set(w,_)},EllipseCurve.prototype.copy=function(s){return Curve.prototype.copy.call(this,s),this.aX=s.aX,this.aY=s.aY,this.xRadius=s.xRadius,this.yRadius=s.yRadius,this.aStartAngle=s.aStartAngle,this.aEndAngle=s.aEndAngle,this.aClockwise=s.aClockwise,this.aRotation=s.aRotation,this},EllipseCurve.prototype.toJSON=function(){var s=Curve.prototype.toJSON.call(this);return s.aX=this.aX,s.aY=this.aY,s.xRadius=this.xRadius,s.yRadius=this.yRadius,s.aStartAngle=this.aStartAngle,s.aEndAngle=this.aEndAngle,s.aClockwise=this.aClockwise,s.aRotation=this.aRotation,s},EllipseCurve.prototype.fromJSON=function(s){return Curve.prototype.fromJSON.call(this,s),this.aX=s.aX,this.aY=s.aY,this.xRadius=s.xRadius,this.yRadius=s.yRadius,this.aStartAngle=s.aStartAngle,this.aEndAngle=s.aEndAngle,this.aClockwise=s.aClockwise,this.aRotation=s.aRotation,this},ArcCurve.prototype=Object.create(EllipseCurve.prototype),ArcCurve.prototype.constructor=ArcCurve,ArcCurve.prototype.isArcCurve=!0;var tmp=new Vector3,px=new CubicPoly,py=new CubicPoly,pz=new CubicPoly;function CatmullRomCurve3(s,e,a,d){Curve.call(this),this.type="CatmullRomCurve3",this.points=s||[],this.closed=e||!1,this.curveType=a||"centripetal",this.tension=d||.5}function CatmullRom(s,e,a,d,v){var g=.5*(d-e),C=.5*(v-a),w=s*s;return(2*a-2*d+g+C)*(s*w)+(-3*a+3*d-2*g-C)*w+g*s+a}function QuadraticBezierP0(s,e){var a=1-s;return a*a*e}function QuadraticBezierP1(s,e){return 2*(1-s)*s*e}function QuadraticBezierP2(s,e){return s*s*e}function QuadraticBezier(s,e,a,d){return QuadraticBezierP0(s,e)+QuadraticBezierP1(s,a)+QuadraticBezierP2(s,d)}function CubicBezierP0(s,e){var a=1-s;return a*a*a*e}function CubicBezierP1(s,e){var a=1-s;return 3*a*a*s*e}function CubicBezierP2(s,e){return 3*(1-s)*s*s*e}function CubicBezierP3(s,e){return s*s*s*e}function CubicBezier(s,e,a,d,v){return CubicBezierP0(s,e)+CubicBezierP1(s,a)+CubicBezierP2(s,d)+CubicBezierP3(s,v)}function CubicBezierCurve(s,e,a,d){Curve.call(this),this.type="CubicBezierCurve",this.v0=s||new Vector2,this.v1=e||new Vector2,this.v2=a||new Vector2,this.v3=d||new Vector2}function CubicBezierCurve3(s,e,a,d){Curve.call(this),this.type="CubicBezierCurve3",this.v0=s||new Vector3,this.v1=e||new Vector3,this.v2=a||new Vector3,this.v3=d||new Vector3}function LineCurve(s,e){Curve.call(this),this.type="LineCurve",this.v1=s||new Vector2,this.v2=e||new Vector2}function LineCurve3(s,e){Curve.call(this),this.type="LineCurve3",this.v1=s||new Vector3,this.v2=e||new Vector3}function QuadraticBezierCurve(s,e,a){Curve.call(this),this.type="QuadraticBezierCurve",this.v0=s||new Vector2,this.v1=e||new Vector2,this.v2=a||new Vector2}function QuadraticBezierCurve3(s,e,a){Curve.call(this),this.type="QuadraticBezierCurve3",this.v0=s||new Vector3,this.v1=e||new Vector3,this.v2=a||new Vector3}function SplineCurve(s){Curve.call(this),this.type="SplineCurve",this.points=s||[]}CatmullRomCurve3.prototype=Object.create(Curve.prototype),CatmullRomCurve3.prototype.constructor=CatmullRomCurve3,CatmullRomCurve3.prototype.isCatmullRomCurve3=!0,CatmullRomCurve3.prototype.getPoint=function(s,e){var _,x,b,A,a=e||new Vector3,d=this.points,v=d.length,g=(v-(this.closed?0:1))*s,C=Math.floor(g),w=g-C;if(this.closed?C+=C>0?0:(Math.floor(Math.abs(C)/v)+1)*v:0===w&&C===v-1&&(C=v-2,w=1),this.closed||C>0?_=d[(C-1)%v]:(tmp.subVectors(d[0],d[1]).add(d[0]),_=tmp),x=d[C%v],b=d[(C+1)%v],this.closed||C+2<v?A=d[(C+2)%v]:(tmp.subVectors(d[v-1],d[v-2]).add(d[v-1]),A=tmp),"centripetal"===this.curveType||"chordal"===this.curveType){var E="chordal"===this.curveType?.5:.25,R=Math.pow(_.distanceToSquared(x),E),O=Math.pow(x.distanceToSquared(b),E),D=Math.pow(b.distanceToSquared(A),E);O<1e-4&&(O=1),R<1e-4&&(R=O),D<1e-4&&(D=O),px.initNonuniformCatmullRom(_.x,x.x,b.x,A.x,R,O,D),py.initNonuniformCatmullRom(_.y,x.y,b.y,A.y,R,O,D),pz.initNonuniformCatmullRom(_.z,x.z,b.z,A.z,R,O,D)}else"catmullrom"===this.curveType&&(px.initCatmullRom(_.x,x.x,b.x,A.x,this.tension),py.initCatmullRom(_.y,x.y,b.y,A.y,this.tension),pz.initCatmullRom(_.z,x.z,b.z,A.z,this.tension));return a.set(px.calc(w),py.calc(w),pz.calc(w)),a},CatmullRomCurve3.prototype.copy=function(s){Curve.prototype.copy.call(this,s),this.points=[];for(var e=0,a=s.points.length;e<a;e++)this.points.push(s.points[e].clone());return this.closed=s.closed,this.curveType=s.curveType,this.tension=s.tension,this},CatmullRomCurve3.prototype.toJSON=function(){var s=Curve.prototype.toJSON.call(this);s.points=[];for(var e=0,a=this.points.length;e<a;e++)s.points.push(this.points[e].toArray());return s.closed=this.closed,s.curveType=this.curveType,s.tension=this.tension,s},CatmullRomCurve3.prototype.fromJSON=function(s){Curve.prototype.fromJSON.call(this,s),this.points=[];for(var e=0,a=s.points.length;e<a;e++){var d=s.points[e];this.points.push((new Vector3).fromArray(d))}return this.closed=s.closed,this.curveType=s.curveType,this.tension=s.tension,this},CubicBezierCurve.prototype=Object.create(Curve.prototype),CubicBezierCurve.prototype.constructor=CubicBezierCurve,CubicBezierCurve.prototype.isCubicBezierCurve=!0,CubicBezierCurve.prototype.getPoint=function(s,e){var a=e||new Vector2,d=this.v0,v=this.v1,g=this.v2,C=this.v3;return a.set(CubicBezier(s,d.x,v.x,g.x,C.x),CubicBezier(s,d.y,v.y,g.y,C.y)),a},CubicBezierCurve.prototype.copy=function(s){return Curve.prototype.copy.call(this,s),this.v0.copy(s.v0),this.v1.copy(s.v1),this.v2.copy(s.v2),this.v3.copy(s.v3),this},CubicBezierCurve.prototype.toJSON=function(){var s=Curve.prototype.toJSON.call(this);return s.v0=this.v0.toArray(),s.v1=this.v1.toArray(),s.v2=this.v2.toArray(),s.v3=this.v3.toArray(),s},CubicBezierCurve.prototype.fromJSON=function(s){return Curve.prototype.fromJSON.call(this,s),this.v0.fromArray(s.v0),this.v1.fromArray(s.v1),this.v2.fromArray(s.v2),this.v3.fromArray(s.v3),this},CubicBezierCurve3.prototype=Object.create(Curve.prototype),CubicBezierCurve3.prototype.constructor=CubicBezierCurve3,CubicBezierCurve3.prototype.isCubicBezierCurve3=!0,CubicBezierCurve3.prototype.getPoint=function(s,e){var a=e||new Vector3,d=this.v0,v=this.v1,g=this.v2,C=this.v3;return a.set(CubicBezier(s,d.x,v.x,g.x,C.x),CubicBezier(s,d.y,v.y,g.y,C.y),CubicBezier(s,d.z,v.z,g.z,C.z)),a},CubicBezierCurve3.prototype.copy=function(s){return Curve.prototype.copy.call(this,s),this.v0.copy(s.v0),this.v1.copy(s.v1),this.v2.copy(s.v2),this.v3.copy(s.v3),this},CubicBezierCurve3.prototype.toJSON=function(){var s=Curve.prototype.toJSON.call(this);return s.v0=this.v0.toArray(),s.v1=this.v1.toArray(),s.v2=this.v2.toArray(),s.v3=this.v3.toArray(),s},CubicBezierCurve3.prototype.fromJSON=function(s){return Curve.prototype.fromJSON.call(this,s),this.v0.fromArray(s.v0),this.v1.fromArray(s.v1),this.v2.fromArray(s.v2),this.v3.fromArray(s.v3),this},LineCurve.prototype=Object.create(Curve.prototype),LineCurve.prototype.constructor=LineCurve,LineCurve.prototype.isLineCurve=!0,LineCurve.prototype.getPoint=function(s,e){var a=e||new Vector2;return 1===s?a.copy(this.v2):(a.copy(this.v2).sub(this.v1),a.multiplyScalar(s).add(this.v1)),a},LineCurve.prototype.getPointAt=function(s,e){return this.getPoint(s,e)},LineCurve.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},LineCurve.prototype.copy=function(s){return Curve.prototype.copy.call(this,s),this.v1.copy(s.v1),this.v2.copy(s.v2),this},LineCurve.prototype.toJSON=function(){var s=Curve.prototype.toJSON.call(this);return s.v1=this.v1.toArray(),s.v2=this.v2.toArray(),s},LineCurve.prototype.fromJSON=function(s){return Curve.prototype.fromJSON.call(this,s),this.v1.fromArray(s.v1),this.v2.fromArray(s.v2),this},LineCurve3.prototype=Object.create(Curve.prototype),LineCurve3.prototype.constructor=LineCurve3,LineCurve3.prototype.isLineCurve3=!0,LineCurve3.prototype.getPoint=function(s,e){var a=e||new Vector3;return 1===s?a.copy(this.v2):(a.copy(this.v2).sub(this.v1),a.multiplyScalar(s).add(this.v1)),a},LineCurve3.prototype.getPointAt=function(s,e){return this.getPoint(s,e)},LineCurve3.prototype.copy=function(s){return Curve.prototype.copy.call(this,s),this.v1.copy(s.v1),this.v2.copy(s.v2),this},LineCurve3.prototype.toJSON=function(){var s=Curve.prototype.toJSON.call(this);return s.v1=this.v1.toArray(),s.v2=this.v2.toArray(),s},LineCurve3.prototype.fromJSON=function(s){return Curve.prototype.fromJSON.call(this,s),this.v1.fromArray(s.v1),this.v2.fromArray(s.v2),this},QuadraticBezierCurve.prototype=Object.create(Curve.prototype),QuadraticBezierCurve.prototype.constructor=QuadraticBezierCurve,QuadraticBezierCurve.prototype.isQuadraticBezierCurve=!0,QuadraticBezierCurve.prototype.getPoint=function(s,e){var a=e||new Vector2,d=this.v0,v=this.v1,g=this.v2;return a.set(QuadraticBezier(s,d.x,v.x,g.x),QuadraticBezier(s,d.y,v.y,g.y)),a},QuadraticBezierCurve.prototype.copy=function(s){return Curve.prototype.copy.call(this,s),this.v0.copy(s.v0),this.v1.copy(s.v1),this.v2.copy(s.v2),this},QuadraticBezierCurve.prototype.toJSON=function(){var s=Curve.prototype.toJSON.call(this);return s.v0=this.v0.toArray(),s.v1=this.v1.toArray(),s.v2=this.v2.toArray(),s},QuadraticBezierCurve.prototype.fromJSON=function(s){return Curve.prototype.fromJSON.call(this,s),this.v0.fromArray(s.v0),this.v1.fromArray(s.v1),this.v2.fromArray(s.v2),this},QuadraticBezierCurve3.prototype=Object.create(Curve.prototype),QuadraticBezierCurve3.prototype.constructor=QuadraticBezierCurve3,QuadraticBezierCurve3.prototype.isQuadraticBezierCurve3=!0,QuadraticBezierCurve3.prototype.getPoint=function(s,e){var a=e||new Vector3,d=this.v0,v=this.v1,g=this.v2;return a.set(QuadraticBezier(s,d.x,v.x,g.x),QuadraticBezier(s,d.y,v.y,g.y),QuadraticBezier(s,d.z,v.z,g.z)),a},QuadraticBezierCurve3.prototype.copy=function(s){return Curve.prototype.copy.call(this,s),this.v0.copy(s.v0),this.v1.copy(s.v1),this.v2.copy(s.v2),this},QuadraticBezierCurve3.prototype.toJSON=function(){var s=Curve.prototype.toJSON.call(this);return s.v0=this.v0.toArray(),s.v1=this.v1.toArray(),s.v2=this.v2.toArray(),s},QuadraticBezierCurve3.prototype.fromJSON=function(s){return Curve.prototype.fromJSON.call(this,s),this.v0.fromArray(s.v0),this.v1.fromArray(s.v1),this.v2.fromArray(s.v2),this},SplineCurve.prototype=Object.create(Curve.prototype),SplineCurve.prototype.constructor=SplineCurve,SplineCurve.prototype.isSplineCurve=!0,SplineCurve.prototype.getPoint=function(s,e){var a=e||new Vector2,d=this.points,v=(d.length-1)*s,g=Math.floor(v),C=v-g,w=d[0===g?g:g-1],_=d[g],x=d[g>d.length-2?d.length-1:g+1],b=d[g>d.length-3?d.length-1:g+2];return a.set(CatmullRom(C,w.x,_.x,x.x,b.x),CatmullRom(C,w.y,_.y,x.y,b.y)),a},SplineCurve.prototype.copy=function(s){Curve.prototype.copy.call(this,s),this.points=[];for(var e=0,a=s.points.length;e<a;e++)this.points.push(s.points[e].clone());return this},SplineCurve.prototype.toJSON=function(){var s=Curve.prototype.toJSON.call(this);s.points=[];for(var e=0,a=this.points.length;e<a;e++)s.points.push(this.points[e].toArray());return s},SplineCurve.prototype.fromJSON=function(s){Curve.prototype.fromJSON.call(this,s),this.points=[];for(var e=0,a=s.points.length;e<a;e++){var d=s.points[e];this.points.push((new Vector2).fromArray(d))}return this};var Curves={ArcCurve:ArcCurve,CatmullRomCurve3:CatmullRomCurve3,CubicBezierCurve:CubicBezierCurve,CubicBezierCurve3:CubicBezierCurve3,EllipseCurve:EllipseCurve,LineCurve:LineCurve,LineCurve3:LineCurve3,QuadraticBezierCurve:QuadraticBezierCurve,QuadraticBezierCurve3:QuadraticBezierCurve3,SplineCurve:SplineCurve,GrannyKnot:GrannyKnot,HeartCurve:HeartCurve,VivianiCurve:VivianiCurve,KnotCurve:KnotCurve,HelixCurve:HelixCurve,TrefoilKnot:TrefoilKnot,TorusKnot:TorusKnot,CinquefoilKnot:CinquefoilKnot,TrefoilPolynomialKnot:TrefoilPolynomialKnot,FigureEightPolynomialKnot:FigureEightPolynomialKnot,DecoratedTorusKnot4a:DecoratedTorusKnot4a,DecoratedTorusKnot4b:DecoratedTorusKnot4b,DecoratedTorusKnot5a:DecoratedTorusKnot5a,DecoratedTorusKnot5c:DecoratedTorusKnot5c};function CurvePath(){Curve.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Path(s){CurvePath.call(this),this.type="Path",this.currentPoint=new Vector2,s&&this.setFromPoints(s)}function Shape(s){Path.call(this,s),this.uuid=MathUtils.generateUUID(),this.type="Shape",this.holes=[]}CurvePath.prototype=Object.assign(Object.create(Curve.prototype),{constructor:CurvePath,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),a=this.curves[this.curves.length-1].getPoint(1);e.equals(a)||this.curves.push(new Curves.LineCurve(a,e))},getPoint:function(e){for(var a=e*this.getLength(),d=this.getCurveLengths(),v=0;v<d.length;){if(d[v]>=a){var g=d[v]-a,C=this.curves[v],w=C.getLength();return C.getPointAt(0===w?0:1-g/w)}v++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],a=0,d=0,v=this.curves.length;d<v;d++)a+=this.curves[d].getLength(),e.push(a);return this.cacheLengths=e,e},getSpacedPoints:function(e){void 0===e&&(e=40);for(var a=[],d=0;d<=e;d++)a.push(this.getPoint(d/e));return this.autoClose&&a.push(a[0]),a},getPoints:function(e){e=e||12;for(var d,a=[],v=0,g=this.curves;v<g.length;v++)for(var C=g[v],_=C.getPoints(C&&C.isEllipseCurve?2*e:C&&(C.isLineCurve||C.isLineCurve3)?1:C&&C.isSplineCurve?e*C.points.length:e),x=0;x<_.length;x++){var b=_[x];d&&d.equals(b)||(a.push(b),d=b)}return this.autoClose&&a.length>1&&!a[a.length-1].equals(a[0])&&a.push(a[0]),a},copy:function(e){Curve.prototype.copy.call(this,e),this.curves=[];for(var a=0,d=e.curves.length;a<d;a++)this.curves.push(e.curves[a].clone());return this.autoClose=e.autoClose,this},toJSON:function(){var e=Curve.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var a=0,d=this.curves.length;a<d;a++)e.curves.push(this.curves[a].toJSON());return e},fromJSON:function(e){Curve.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var a=0,d=e.curves.length;a<d;a++){var v=e.curves[a];this.curves.push((new Curves[v.type]).fromJSON(v))}return this}}),Path.prototype=Object.assign(Object.create(CurvePath.prototype),{constructor:Path,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var a=1,d=e.length;a<d;a++)this.lineTo(e[a].x,e[a].y);return this},moveTo:function(e,a){return this.currentPoint.set(e,a),this},lineTo:function(e,a){var d=new LineCurve(this.currentPoint.clone(),new Vector2(e,a));return this.curves.push(d),this.currentPoint.set(e,a),this},quadraticCurveTo:function(e,a,d,v){var g=new QuadraticBezierCurve(this.currentPoint.clone(),new Vector2(e,a),new Vector2(d,v));return this.curves.push(g),this.currentPoint.set(d,v),this},bezierCurveTo:function(e,a,d,v,g,C){var w=new CubicBezierCurve(this.currentPoint.clone(),new Vector2(e,a),new Vector2(d,v),new Vector2(g,C));return this.curves.push(w),this.currentPoint.set(g,C),this},splineThru:function(e){var d=new SplineCurve([this.currentPoint.clone()].concat(e));return this.curves.push(d),this.currentPoint.copy(e[e.length-1]),this},arc:function(e,a,d,v,g,C){return this.absarc(e+this.currentPoint.x,a+this.currentPoint.y,d,v,g,C),this},absarc:function(e,a,d,v,g,C){return this.absellipse(e,a,d,d,v,g,C),this},ellipse:function(e,a,d,v,g,C,w,_){return this.absellipse(e+this.currentPoint.x,a+this.currentPoint.y,d,v,g,C,w,_),this},absellipse:function(e,a,d,v,g,C,w,_){var x=new EllipseCurve(e,a,d,v,g,C,w,_);if(this.curves.length>0){var b=x.getPoint(0);b.equals(this.currentPoint)||this.lineTo(b.x,b.y)}this.curves.push(x);var A=x.getPoint(1);return this.currentPoint.copy(A),this},copy:function(e){return CurvePath.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=CurvePath.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return CurvePath.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),Shape.prototype=Object.assign(Object.create(Path.prototype),{constructor:Shape,getPointsHoles:function(e){for(var a=[],d=0,v=this.holes.length;d<v;d++)a[d]=this.holes[d].getPoints(e);return a},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){Path.prototype.copy.call(this,e),this.holes=[];for(var a=0,d=e.holes.length;a<d;a++)this.holes.push(e.holes[a].clone());return this},toJSON:function(){var e=Path.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var a=0,d=this.holes.length;a<d;a++)e.holes.push(this.holes[a].toJSON());return e},fromJSON:function(e){Path.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var a=0,d=e.holes.length;a<d;a++){var v=e.holes[a];this.holes.push((new Path).fromJSON(v))}return this}});var Earcut={triangulate:function(e,a,d){d=d||2;var _,x,b,A,E,R,O,v=a&&a.length,g=v?a[0]*d:e.length,C=linkedList(e,0,g,d,!0),w=[];if(!C||C.next===C.prev)return w;if(v&&(C=eliminateHoles(e,a,C,d)),e.length>80*d){_=b=e[0],x=A=e[1];for(var D=d;D<g;D+=d)(E=e[D])<_&&(_=E),(R=e[D+1])<x&&(x=R),E>b&&(b=E),R>A&&(A=R);O=0!==(O=Math.max(b-_,A-x))?1/O:0}return earcutLinked(C,w,d,_,x,O),w}};function linkedList(s,e,a,d,v){var g,C;if(v===signedArea(s,e,a,d)>0)for(g=e;g<a;g+=d)C=insertNode(g,s[g],s[g+1],C);else for(g=a-d;g>=e;g-=d)C=insertNode(g,s[g],s[g+1],C);return C&&equals(C,C.next)&&(removeNode(C),C=C.next),C}function filterPoints(s,e){if(!s)return s;e||(e=s);var d,a=s;do{if(d=!1,a.steiner||!equals(a,a.next)&&0!==area(a.prev,a,a.next))a=a.next;else{if(removeNode(a),(a=e=a.prev)===a.next)break;d=!0}}while(d||a!==e);return e}function earcutLinked(s,e,a,d,v,g,C){if(s){!C&&g&&indexCurve(s,d,v,g);for(var _,x,w=s;s.prev!==s.next;)if(_=s.prev,x=s.next,g?isEarHashed(s,d,v,g):isEar(s))e.push(_.i/a),e.push(s.i/a),e.push(x.i/a),removeNode(s),s=x.next,w=x.next;else if((s=x)===w){C?1===C?earcutLinked(s=cureLocalIntersections(s,e,a),e,a,d,v,g,2):2===C&&splitEarcut(s,e,a,d,v,g):earcutLinked(filterPoints(s),e,a,d,v,g,1);break}}}function isEar(s){var e=s.prev,a=s,d=s.next;if(area(e,a,d)>=0)return!1;for(var v=s.next.next;v!==s.prev;){if(pointInTriangle(e.x,e.y,a.x,a.y,d.x,d.y,v.x,v.y)&&area(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function isEarHashed(s,e,a,d){var v=s.prev,g=s,C=s.next;if(area(v,g,C)>=0)return!1;for(var x=v.x>g.x?v.x>C.x?v.x:C.x:g.x>C.x?g.x:C.x,b=v.y>g.y?v.y>C.y?v.y:C.y:g.y>C.y?g.y:C.y,A=zOrder(v.x<g.x?v.x<C.x?v.x:C.x:g.x<C.x?g.x:C.x,v.y<g.y?v.y<C.y?v.y:C.y:g.y<C.y?g.y:C.y,e,a,d),E=zOrder(x,b,e,a,d),R=s.prevZ,O=s.nextZ;R&&R.z>=A&&O&&O.z<=E;){if(R!==s.prev&&R!==s.next&&pointInTriangle(v.x,v.y,g.x,g.y,C.x,C.y,R.x,R.y)&&area(R.prev,R,R.next)>=0||(R=R.prevZ,O!==s.prev&&O!==s.next&&pointInTriangle(v.x,v.y,g.x,g.y,C.x,C.y,O.x,O.y)&&area(O.prev,O,O.next)>=0))return!1;O=O.nextZ}for(;R&&R.z>=A;){if(R!==s.prev&&R!==s.next&&pointInTriangle(v.x,v.y,g.x,g.y,C.x,C.y,R.x,R.y)&&area(R.prev,R,R.next)>=0)return!1;R=R.prevZ}for(;O&&O.z<=E;){if(O!==s.prev&&O!==s.next&&pointInTriangle(v.x,v.y,g.x,g.y,C.x,C.y,O.x,O.y)&&area(O.prev,O,O.next)>=0)return!1;O=O.nextZ}return!0}function cureLocalIntersections(s,e,a){var d=s;do{var v=d.prev,g=d.next.next;!equals(v,g)&&intersects(v,d,d.next,g)&&locallyInside(v,g)&&locallyInside(g,v)&&(e.push(v.i/a),e.push(d.i/a),e.push(g.i/a),removeNode(d),removeNode(d.next),d=s=g),d=d.next}while(d!==s);return d}function splitEarcut(s,e,a,d,v,g){var C=s;do{for(var w=C.next.next;w!==C.prev;){if(C.i!==w.i&&isValidDiagonal(C,w)){var _=splitPolygon(C,w);return C=filterPoints(C,C.next),_=filterPoints(_,_.next),earcutLinked(C,e,a,d,v,g),void earcutLinked(_,e,a,d,v,g)}w=w.next}C=C.next}while(C!==s)}function eliminateHoles(s,e,a,d){var g,C,x,v=[];for(g=0,C=e.length;g<C;g++)(x=linkedList(s,e[g]*d,g<C-1?e[g+1]*d:s.length,d,!1))===x.next&&(x.steiner=!0),v.push(getLeftmost(x));for(v.sort(compareX),g=0;g<v.length;g++)eliminateHole(v[g],a),a=filterPoints(a,a.next);return a}function compareX(s,e){return s.x-e.x}function eliminateHole(s,e){if(e=findHoleBridge(s,e)){var a=splitPolygon(e,s);filterPoints(a,a.next)}}function findHoleBridge(s,e){var C,a=e,d=s.x,v=s.y,g=-1/0;do{if(v<=a.y&&v>=a.next.y&&a.next.y!==a.y){var w=a.x+(v-a.y)*(a.next.x-a.x)/(a.next.y-a.y);if(w<=d&&w>g){if(g=w,w===d){if(v===a.y)return a;if(v===a.next.y)return a.next}C=a.x<a.next.x?a:a.next}}a=a.next}while(a!==e);if(!C)return null;if(d===g)return C.prev;var E,_=C,x=C.x,b=C.y,A=1/0;for(a=C.next;a!==_;)d>=a.x&&a.x>=x&&d!==a.x&&pointInTriangle(v<b?d:g,v,x,b,v<b?g:d,v,a.x,a.y)&&((E=Math.abs(v-a.y)/(d-a.x))<A||E===A&&a.x>C.x)&&locallyInside(a,s)&&(C=a,A=E),a=a.next;return C}function indexCurve(s,e,a,d){var v=s;do{null===v.z&&(v.z=zOrder(v.x,v.y,e,a,d)),v.prevZ=v.prev,v.nextZ=v.next,v=v.next}while(v!==s);v.prevZ.nextZ=null,v.prevZ=null,sortLinked(v)}function sortLinked(s){var e,a,d,v,g,C,w,_,x=1;do{for(a=s,s=null,g=null,C=0;a;){for(C++,d=a,w=0,e=0;e<x&&(w++,d=d.nextZ);e++);for(_=x;w>0||_>0&&d;)0!==w&&(0===_||!d||a.z<=d.z)?(v=a,a=a.nextZ,w--):(v=d,d=d.nextZ,_--),g?g.nextZ=v:s=v,v.prevZ=g,g=v;a=d}g.nextZ=null,x*=2}while(C>1);return s}function zOrder(s,e,a,d,v){return(s=1431655765&((s=858993459&((s=252645135&((s=16711935&((s=32767*(s-a)*v)|s<<8))|s<<4))|s<<2))|s<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-d)*v)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function getLeftmost(s){var e=s,a=s;do{(e.x<a.x||e.x===a.x&&e.y<a.y)&&(a=e),e=e.next}while(e!==s);return a}function pointInTriangle(s,e,a,d,v,g,C,w){return(v-C)*(e-w)-(s-C)*(g-w)>=0&&(s-C)*(d-w)-(a-C)*(e-w)>=0&&(a-C)*(g-w)-(v-C)*(d-w)>=0}function isValidDiagonal(s,e){return s.next.i!==e.i&&s.prev.i!==e.i&&!intersectsPolygon(s,e)&&locallyInside(s,e)&&locallyInside(e,s)&&middleInside(s,e)}function area(s,e,a){return(e.y-s.y)*(a.x-e.x)-(e.x-s.x)*(a.y-e.y)}function equals(s,e){return s.x===e.x&&s.y===e.y}function intersects(s,e,a,d){return!!(equals(s,a)&&equals(e,d)||equals(s,d)&&equals(a,e))||area(s,e,a)>0!=area(s,e,d)>0&&area(a,d,s)>0!=area(a,d,e)>0}function intersectsPolygon(s,e){var a=s;do{if(a.i!==s.i&&a.next.i!==s.i&&a.i!==e.i&&a.next.i!==e.i&&intersects(a,a.next,s,e))return!0;a=a.next}while(a!==s);return!1}function locallyInside(s,e){return area(s.prev,s,s.next)<0?area(s,e,s.next)>=0&&area(s,s.prev,e)>=0:area(s,e,s.prev)<0||area(s,s.next,e)<0}function middleInside(s,e){var a=s,d=!1,v=(s.x+e.x)/2,g=(s.y+e.y)/2;do{a.y>g!=a.next.y>g&&a.next.y!==a.y&&v<(a.next.x-a.x)*(g-a.y)/(a.next.y-a.y)+a.x&&(d=!d),a=a.next}while(a!==s);return d}function splitPolygon(s,e){var a=new Node$1(s.i,s.x,s.y),d=new Node$1(e.i,e.x,e.y),v=s.next,g=e.prev;return s.next=e,e.prev=s,a.next=v,v.prev=a,d.next=a,a.prev=d,g.next=d,d.prev=g,d}function insertNode(s,e,a,d){var v=new Node$1(s,e,a);return d?(v.next=d.next,v.prev=d,d.next.prev=v,d.next=v):(v.prev=v,v.next=v),v}function removeNode(s){s.next.prev=s.prev,s.prev.next=s.next,s.prevZ&&(s.prevZ.nextZ=s.nextZ),s.nextZ&&(s.nextZ.prevZ=s.prevZ)}function Node$1(s,e,a){this.i=s,this.x=e,this.y=a,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(s,e,a,d){for(var v=0,g=e,C=a-d;g<a;g+=d)v+=(s[C]-s[g])*(s[g+1]+s[C+1]),C=g;return v}var ShapeUtils={area:function(e){for(var a=e.length,d=0,v=a-1,g=0;g<a;v=g++)d+=e[v].x*e[g].y-e[g].x*e[v].y;return.5*d},isClockWise:function(e){return ShapeUtils.area(e)<0},triangulateShape:function(e,a){var d=[],v=[],g=[];removeDupEndPts(e),addContour(d,e);var C=e.length;a.forEach(removeDupEndPts);for(var w=0;w<a.length;w++)v.push(C),C+=a[w].length,addContour(d,a[w]);var _=Earcut.triangulate(d,v);for(w=0;w<_.length;w+=3)g.push(_.slice(w,w+3));return g}};function removeDupEndPts(s){var e=s.length;e>2&&s[e-1].equals(s[0])&&s.pop()}function addContour(s,e){for(var a=0;a<e.length;a++)s.push(e[a].x),s.push(e[a].y)}function ShapePath(){this.type="ShapePath",this.color=new Color,this.subPaths=[],this.currentPath=null}Object.assign(ShapePath.prototype,{moveTo:function(e,a){return this.currentPath=new Path,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,a),this},lineTo:function(e,a){return this.currentPath.lineTo(e,a),this},quadraticCurveTo:function(e,a,d,v){return this.currentPath.quadraticCurveTo(e,a,d,v),this},bezierCurveTo:function(e,a,d,v,g,C){return this.currentPath.bezierCurveTo(e,a,d,v,g,C),this},splineThru:function(e){return this.currentPath.splineThru(e),this},toShapes:function(e,a){function d(oe){for(var me=[],fe=0,ge=oe.length;fe<ge;fe++){var $=oe[fe],ue=new Shape;ue.curves=$.curves,me.push(ue)}return me}function v(oe,me){for(var fe=me.length,ge=!1,$=fe-1,ue=0;ue<fe;$=ue++){var Y=me[$],Z=me[ue],se=Z.x-Y.x,ve=Z.y-Y.y;if(Math.abs(ve)>Number.EPSILON){if(ve<0&&(Y=me[ue],se=-se,Z=me[$],ve=-ve),oe.y<Y.y||oe.y>Z.y)continue;if(oe.y===Y.y){if(oe.x===Y.x)return!0}else{var le=ve*(oe.x-Y.x)-se*(oe.y-Y.y);if(0===le)return!0;if(le<0)continue;ge=!ge}}else{if(oe.y!==Y.y)continue;if(Z.x<=oe.x&&oe.x<=Y.x||Y.x<=oe.x&&oe.x<=Z.x)return!0}}return ge}var g=ShapeUtils.isClockWise,C=this.subPaths;if(0===C.length)return[];if(!0===a)return d(C);var w,_,x,b=[];if(1===C.length)return _=C[0],(x=new Shape).curves=_.curves,b.push(x),b;var A=!g(C[0].getPoints());A=e?!A:A;var F,E=[],R=[],O=[],D=0;R[D]=void 0,O[D]=[];for(var L=0,I=C.length;L<I;L++)w=g(F=(_=C[L]).getPoints()),(w=e?!w:w)?(!A&&R[D]&&D++,R[D]={s:new Shape,p:F},R[D].s.curves=_.curves,A&&D++,O[D]=[]):O[D].push({h:_,p:F[0]});if(!R[0])return d(C);if(R.length>1){for(var V=!1,z=[],H=0,X=R.length;H<X;H++)E[H]=[];for(H=0,X=R.length;H<X;H++)for(var re=O[H],j=0;j<re.length;j++){for(var te=re[j],J=!0,k=0;k<R.length;k++)v(te.p,R[k].p)&&(H!==k&&z.push({froms:H,tos:k,hole:j}),J?(J=!1,E[k].push(te)):V=!0);J&&E[H].push(te)}z.length>0&&(V||(O=E))}L=0;for(var U,K=R.length;L<K;L++){b.push(x=R[L].s);for(var ee=0,Q=(U=O[L]).length;ee<Q;ee++)x.holes.push(U[ee].h)}return b}});var SVGLoader=function(e){Loader.call(this,e),this.defaultDPI=90,this.defaultUnit="px"};SVGLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:SVGLoader,load:function(e,a,d,v){var g=this,C=new FileLoader(g.manager);C.setPath(g.path),C.load(e,function(w){a(g.parse(w))},d,v)},parse:function(e){var a=this;function g($,ue,Y,Z,se,ve,le,_e){Z=Z*Math.PI/180,ue=Math.abs(ue),Y=Math.abs(Y);var ae=(le.x-_e.x)/2,pe=(le.y-_e.y)/2,he=Math.cos(Z)*ae+Math.sin(Z)*pe,ce=-Math.sin(Z)*ae+Math.cos(Z)*pe,Te=ue*ue,be=Y*Y,xe=he*he,we=ce*ce,Ne=xe/Te+we/be;if(Ne>1){var Re=Math.sqrt(Ne);Te=(ue*=Re)*ue,be=(Y*=Re)*Y}var De=Te*we+be*xe,$e=Math.sqrt(Math.max(0,(Te*be-De)/De));se===ve&&($e=-$e);var pt=$e*ue*ce/Y,ut=-$e*Y*he/ue,at=Math.cos(Z)*pt-Math.sin(Z)*ut+(le.x+_e.x)/2,Xe=Math.sin(Z)*pt+Math.cos(Z)*ut+(le.y+_e.y)/2,Ke=C(1,0,(he-pt)/ue,(ce-ut)/Y),lt=C((he-pt)/ue,(ce-ut)/Y,(-he-pt)/ue,(-ce-ut)/Y)%(2*Math.PI);$.currentPath.absellipse(at,Xe,ue,Y,Ke,Ke+lt,0===ve,Z)}function C($,ue,Y,Z){var se=$*Y+ue*Z,ve=Math.sqrt($*$+ue*ue)*Math.sqrt(Y*Y+Z*Z),le=Math.acos(Math.max(-1,Math.min(1,se/ve)));return $*Z-ue*Y<0&&(le=-le),le}function R($,ue){function Y(ve,le,_e){void 0===_e&&(_e=function(pe){return pe}),$.hasAttribute(ve)&&(ue[le]=_e($.getAttribute(ve))),$.style&&""!==$.style[ve]&&(ue[le]=_e($.style[ve]))}function Z(ve){return Math.max(0,Math.min(1,I(ve)))}function se(ve){return Math.max(0,I(ve))}return ue=Object.assign({},ue),Y("fill","fill"),Y("fill-opacity","fillOpacity",Z),Y("stroke","stroke"),Y("stroke-opacity","strokeOpacity",Z),Y("stroke-width","strokeWidth",se),Y("stroke-linejoin","strokeLineJoin"),Y("stroke-linecap","strokeLineCap"),Y("stroke-miterlimit","strokeMiterLimit",se),ue}function O($,ue){return $-(ue-$)}function D($){for(var ue=$.split(/[\s,]+|(?=\s?[+\-])/),Y=0;Y<ue.length;Y++){var Z=ue[Y];if(Z.indexOf(".")!==Z.lastIndexOf("."))for(var se=Z.split("."),ve=2;ve<se.length;ve++)ue.splice(Y+ve-1,0,"0."+se[ve]);ue[Y]=I(Z)}return ue}var F=["mm","cm","in","pt","pc","px"],L={mm:{mm:1,cm:.1,in:1/25.4,pt:72/25.4,pc:6/25.4,px:-1},cm:{mm:10,cm:1,in:1/2.54,pt:72/2.54,pc:6/2.54,px:-1},in:{mm:25.4,cm:2.54,in:1,pt:72,pc:6,px:-1},pt:{mm:25.4/72,cm:2.54/72,in:1/72,pt:1,pc:6/72,px:-1},pc:{mm:25.4/6,cm:2.54/6,in:1/6,pt:12,pc:1,px:-1},px:{px:1}};function I($){var ue="px";if("string"==typeof $||$ instanceof String)for(var Y=0,Z=F.length;Y<Z;Y++){var se=F[Y];if($.endsWith(se)){ue=se,$=$.substring(0,$.length-se.length);break}}var ve=void 0;return"px"===ue&&"px"!==a.defaultUnit?ve=L.in[a.defaultUnit]/a.defaultDPI:(ve=L[ue][a.defaultUnit])<0&&(ve=L[ue].in*a.defaultDPI),ve*parseFloat($)}function re($){var ue=$.elements;return Math.sqrt(ue[0]*ue[0]+ue[1]*ue[1])}function j($){var ue=$.elements;return Math.sqrt(ue[3]*ue[3]+ue[4]*ue[4])}var te=[],J=[],k=new Matrix3,U=new Matrix3,K=new Matrix3,ee=new Matrix3,Q=new Vector2,oe=new Vector3,me=new Matrix3,fe=(new DOMParser).parseFromString(e,"image/svg+xml");return function d($,ue){if(1===$.nodeType){var Y=function($){if(!$.hasAttribute("transform"))return null;var ue=function($){for(var ue=new Matrix3,Y=k,Z=$.getAttribute("transform").split(")"),se=Z.length-1;se>=0;se--){var ve=Z[se].trim();if(""!==ve){var le=ve.indexOf("("),_e=ve.length;if(le>0&&le<_e){var ae=ve.substr(0,le),pe=D(ve.substr(le+1,_e-le-1));switch(Y.identity(),ae){case"translate":if(pe.length>=1){var he=pe[0],ce=he;pe.length>=2&&(ce=pe[1]),Y.translate(he,ce)}break;case"rotate":if(pe.length>=1){var Te,be=0,xe=0;Te=-pe[0]*Math.PI/180,pe.length>=3&&(be=pe[1],xe=pe[2]),U.identity().translate(-be,-xe),K.identity().rotate(Te),ee.multiplyMatrices(K,U),U.identity().translate(be,xe),Y.multiplyMatrices(U,ee)}break;case"scale":if(pe.length>=1){var we=pe[0],Ne=we;pe.length>=2&&(Ne=pe[1]),Y.scale(we,Ne)}break;case"skewX":1===pe.length&&Y.set(1,Math.tan(pe[0]*Math.PI/180),0,0,1,0,0,0,1);break;case"skewY":1===pe.length&&Y.set(1,0,0,Math.tan(pe[0]*Math.PI/180),1,0,0,0,1);break;case"matrix":6===pe.length&&Y.set(pe[0],pe[2],pe[4],pe[1],pe[3],pe[5],0,0,1)}}ue.premultiply(Y)}}return ue}($);return J.length>0&&ue.premultiply(J[J.length-1]),me.copy(ue),J.push(ue),ue}($),Z=null;switch($.nodeName){case"svg":break;case"g":ue=R($,ue);break;case"path":ue=R($,ue),$.hasAttribute("d")&&(Z=function($){for(var ue=new ShapePath,Y=new Vector2,Z=new Vector2,se=new Vector2,ve=!0,le=!1,ae=$.getAttribute("d").match(/[a-df-z][^a-df-z]*/gi),pe=0,he=ae.length;pe<he;pe++){var ce=ae[pe],Te=ce.charAt(0),be=ce.substr(1).trim();switch(!0===ve&&(le=!0,ve=!1),Te){case"M":for(var we=0,Ne=(xe=D(be)).length;we<Ne;we+=2)Y.x=xe[we+0],Y.y=xe[we+1],Z.x=Y.x,Z.y=Y.y,0===we?ue.moveTo(Y.x,Y.y):ue.lineTo(Y.x,Y.y),0===we&&!0===le&&se.copy(Y);break;case"H":for(we=0,Ne=(xe=D(be)).length;we<Ne;we++)Y.x=xe[we],Z.x=Y.x,Z.y=Y.y,ue.lineTo(Y.x,Y.y),0===we&&!0===le&&se.copy(Y);break;case"V":for(we=0,Ne=(xe=D(be)).length;we<Ne;we++)Y.y=xe[we],Z.x=Y.x,Z.y=Y.y,ue.lineTo(Y.x,Y.y),0===we&&!0===le&&se.copy(Y);break;case"L":for(we=0,Ne=(xe=D(be)).length;we<Ne;we+=2)Y.x=xe[we+0],Y.y=xe[we+1],Z.x=Y.x,Z.y=Y.y,ue.lineTo(Y.x,Y.y),0===we&&!0===le&&se.copy(Y);break;case"C":for(we=0,Ne=(xe=D(be)).length;we<Ne;we+=6)ue.bezierCurveTo(xe[we+0],xe[we+1],xe[we+2],xe[we+3],xe[we+4],xe[we+5]),Z.x=xe[we+2],Z.y=xe[we+3],Y.x=xe[we+4],Y.y=xe[we+5],0===we&&!0===le&&se.copy(Y);break;case"S":for(we=0,Ne=(xe=D(be)).length;we<Ne;we+=4)ue.bezierCurveTo(O(Y.x,Z.x),O(Y.y,Z.y),xe[we+0],xe[we+1],xe[we+2],xe[we+3]),Z.x=xe[we+0],Z.y=xe[we+1],Y.x=xe[we+2],Y.y=xe[we+3],0===we&&!0===le&&se.copy(Y);break;case"Q":for(we=0,Ne=(xe=D(be)).length;we<Ne;we+=4)ue.quadraticCurveTo(xe[we+0],xe[we+1],xe[we+2],xe[we+3]),Z.x=xe[we+0],Z.y=xe[we+1],Y.x=xe[we+2],Y.y=xe[we+3],0===we&&!0===le&&se.copy(Y);break;case"T":for(we=0,Ne=(xe=D(be)).length;we<Ne;we+=2){var Re=O(Y.x,Z.x),De=O(Y.y,Z.y);ue.quadraticCurveTo(Re,De,xe[we+0],xe[we+1]),Z.x=Re,Z.y=De,Y.x=xe[we+0],Y.y=xe[we+1],0===we&&!0===le&&se.copy(Y)}break;case"A":for(we=0,Ne=(xe=D(be)).length;we<Ne;we+=7){var Je=Y.clone();Y.x=xe[we+5],Y.y=xe[we+6],Z.x=Y.x,Z.y=Y.y,g(ue,xe[we],xe[we+1],xe[we+2],xe[we+3],xe[we+4],Je,Y),0===we&&!0===le&&se.copy(Y)}break;case"m":for(we=0,Ne=(xe=D(be)).length;we<Ne;we+=2)Y.x+=xe[we+0],Y.y+=xe[we+1],Z.x=Y.x,Z.y=Y.y,0===we?ue.moveTo(Y.x,Y.y):ue.lineTo(Y.x,Y.y),0===we&&!0===le&&se.copy(Y);break;case"h":for(we=0,Ne=(xe=D(be)).length;we<Ne;we++)Y.x+=xe[we],Z.x=Y.x,Z.y=Y.y,ue.lineTo(Y.x,Y.y),0===we&&!0===le&&se.copy(Y);break;case"v":for(we=0,Ne=(xe=D(be)).length;we<Ne;we++)Y.y+=xe[we],Z.x=Y.x,Z.y=Y.y,ue.lineTo(Y.x,Y.y),0===we&&!0===le&&se.copy(Y);break;case"l":for(we=0,Ne=(xe=D(be)).length;we<Ne;we+=2)Y.x+=xe[we+0],Y.y+=xe[we+1],Z.x=Y.x,Z.y=Y.y,ue.lineTo(Y.x,Y.y),0===we&&!0===le&&se.copy(Y);break;case"c":for(we=0,Ne=(xe=D(be)).length;we<Ne;we+=6)ue.bezierCurveTo(Y.x+xe[we+0],Y.y+xe[we+1],Y.x+xe[we+2],Y.y+xe[we+3],Y.x+xe[we+4],Y.y+xe[we+5]),Z.x=Y.x+xe[we+2],Z.y=Y.y+xe[we+3],Y.x+=xe[we+4],Y.y+=xe[we+5],0===we&&!0===le&&se.copy(Y);break;case"s":for(we=0,Ne=(xe=D(be)).length;we<Ne;we+=4)ue.bezierCurveTo(O(Y.x,Z.x),O(Y.y,Z.y),Y.x+xe[we+0],Y.y+xe[we+1],Y.x+xe[we+2],Y.y+xe[we+3]),Z.x=Y.x+xe[we+0],Z.y=Y.y+xe[we+1],Y.x+=xe[we+2],Y.y+=xe[we+3],0===we&&!0===le&&se.copy(Y);break;case"q":for(we=0,Ne=(xe=D(be)).length;we<Ne;we+=4)ue.quadraticCurveTo(Y.x+xe[we+0],Y.y+xe[we+1],Y.x+xe[we+2],Y.y+xe[we+3]),Z.x=Y.x+xe[we+0],Z.y=Y.y+xe[we+1],Y.x+=xe[we+2],Y.y+=xe[we+3],0===we&&!0===le&&se.copy(Y);break;case"t":for(we=0,Ne=(xe=D(be)).length;we<Ne;we+=2)Re=O(Y.x,Z.x),De=O(Y.y,Z.y),ue.quadraticCurveTo(Re,De,Y.x+xe[we+0],Y.y+xe[we+1]),Z.x=Re,Z.y=De,Y.x=Y.x+xe[we+0],Y.y=Y.y+xe[we+1],0===we&&!0===le&&se.copy(Y);break;case"a":var xe;for(we=0,Ne=(xe=D(be)).length;we<Ne;we+=7)Je=Y.clone(),Y.x+=xe[we+5],Y.y+=xe[we+6],Z.x=Y.x,Z.y=Y.y,g(ue,xe[we],xe[we+1],xe[we+2],xe[we+3],xe[we+4],Je,Y),0===we&&!0===le&&se.copy(Y);break;case"Z":case"z":ue.currentPath.autoClose=!0,ue.currentPath.curves.length>0&&(Y.copy(se),ue.currentPath.currentPoint.copy(Y),ve=!0);break;default:console.warn(ce)}le=!1}return ue}($));break;case"rect":ue=R($,ue),Z=function($){var ue=I($.getAttribute("x")||0),Y=I($.getAttribute("y")||0),Z=I($.getAttribute("rx")||0),se=I($.getAttribute("ry")||0),ve=I($.getAttribute("width")),le=I($.getAttribute("height")),_e=new ShapePath;return _e.moveTo(ue+2*Z,Y),_e.lineTo(ue+ve-2*Z,Y),(0!==Z||0!==se)&&_e.bezierCurveTo(ue+ve,Y,ue+ve,Y,ue+ve,Y+2*se),_e.lineTo(ue+ve,Y+le-2*se),(0!==Z||0!==se)&&_e.bezierCurveTo(ue+ve,Y+le,ue+ve,Y+le,ue+ve-2*Z,Y+le),_e.lineTo(ue+2*Z,Y+le),(0!==Z||0!==se)&&_e.bezierCurveTo(ue,Y+le,ue,Y+le,ue,Y+le-2*se),_e.lineTo(ue,Y+2*se),(0!==Z||0!==se)&&_e.bezierCurveTo(ue,Y,ue,Y,ue+2*Z,Y),_e}($);break;case"polygon":ue=R($,ue),Z=function($){var Z=new ShapePath,se=0;return $.getAttribute("points").replace(/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,function(ve,le,_e){var ae=I(le),pe=I(_e);0===se?Z.moveTo(ae,pe):Z.lineTo(ae,pe),se++}),Z.currentPath.autoClose=!0,Z}($);break;case"polyline":ue=R($,ue),Z=function($){var Z=new ShapePath,se=0;return $.getAttribute("points").replace(/(-?[\d\.?]+)[,|\s](-?[\d\.?]+)/g,function(ve,le,_e){var ae=I(le),pe=I(_e);0===se?Z.moveTo(ae,pe):Z.lineTo(ae,pe),se++}),Z.currentPath.autoClose=!1,Z}($);break;case"circle":ue=R($,ue),Z=function($){var ue=I($.getAttribute("cx")),Y=I($.getAttribute("cy")),Z=I($.getAttribute("r")),se=new Path;se.absarc(ue,Y,Z,0,2*Math.PI);var ve=new ShapePath;return ve.subPaths.push(se),ve}($);break;case"ellipse":ue=R($,ue),Z=function($){var ue=I($.getAttribute("cx")),Y=I($.getAttribute("cy")),Z=I($.getAttribute("rx")),se=I($.getAttribute("ry")),ve=new Path;ve.absellipse(ue,Y,Z,se,0,2*Math.PI);var le=new ShapePath;return le.subPaths.push(ve),le}($);break;case"line":ue=R($,ue),Z=function($){var ue=I($.getAttribute("x1")),Y=I($.getAttribute("y1")),Z=I($.getAttribute("x2")),se=I($.getAttribute("y2")),ve=new ShapePath;return ve.moveTo(ue,Y),ve.lineTo(Z,se),ve.currentPath.autoClose=!1,ve}($);break;default:console.log($)}Z&&(void 0!==ue.fill&&"none"!==ue.fill&&Z.color.setStyle(ue.fill),function($,ue){function Y(ce){oe.set(ce.x,ce.y,1).applyMatrix3(ue),ce.set(oe.x,oe.y)}for(var Z=function($){return 0!==$.elements[1]||0!==$.elements[3]}(ue),se=$.subPaths,ve=0,le=se.length;ve<le;ve++)for(var ae=se[ve].curves,pe=0;pe<ae.length;pe++){var he=ae[pe];he.isLineCurve?(Y(he.v1),Y(he.v2)):he.isCubicBezierCurve?(Y(he.v0),Y(he.v1),Y(he.v2),Y(he.v3)):he.isQuadraticBezierCurve?(Y(he.v0),Y(he.v1),Y(he.v2)):he.isEllipseCurve&&(Z&&console.warn("SVGLoader: Elliptic arc or ellipse rotation or skewing is not implemented."),Q.set(he.aX,he.aY),Y(Q),he.aX=Q.x,he.aY=Q.y,he.xRadius*=re(ue),he.yRadius*=j(ue))}}(Z,me),te.push(Z),Z.userData={node:$,style:ue});for(var se=$.childNodes,ve=0;ve<se.length;ve++)d(se[ve],ue);Y&&(J.pop(),J.length>0?me.copy(J[J.length-1]):me.identity())}}(fe.documentElement,{fill:"#000",fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeLineJoin:"miter",strokeLineCap:"butt",strokeMiterLimit:4}),{paths:te,xml:fe.documentElement}}}),SVGLoader.getStrokeStyle=function(s,e,a,d,v){return{strokeColor:e=void 0!==e?e:"#000",strokeWidth:s=void 0!==s?s:1,strokeLineJoin:a=void 0!==a?a:"miter",strokeLineCap:d=void 0!==d?d:"butt",strokeMiterLimit:v=void 0!==v?v:4}},SVGLoader.pointsToStroke=function(s,e,a,d){var v=[],g=[],C=[];if(0===SVGLoader.pointsToStrokeWithBuffers(s,e,a,d,v,g,C))return null;var w=new BufferGeometry;return w.setAttribute("position",new Float32BufferAttribute(v,3)),w.setAttribute("normal",new Float32BufferAttribute(g,3)),w.setAttribute("uv",new Float32BufferAttribute(C,2)),w},SVGLoader.pointsToStrokeWithBuffers=function(){var s=new Vector2,e=new Vector2,a=new Vector2,d=new Vector2,v=new Vector2,g=new Vector2,C=new Vector2,w=new Vector2,_=new Vector2,x=new Vector2,b=new Vector2,A=new Vector2,E=new Vector2,R=new Vector2,O=new Vector2,D=new Vector2,F=new Vector2;return function(L,I,V,z,H,X,re,j){V=void 0!==V?V:12,z=void 0!==z?z:.001,j=void 0!==j?j:0;var te=(L=function(at){for(var Xe=!1,Ke=1,lt=at.length-1;Ke<lt;Ke++)if(at[Ke].distanceTo(at[Ke+1])<z){Xe=!0;break}if(!Xe)return at;var ot=[];for(ot.push(at[0]),Ke=1,lt=at.length-1;Ke<lt;Ke++)at[Ke].distanceTo(at[Ke+1])>=z&&ot.push(at[Ke]);return ot.push(at[at.length-1]),ot}(L)).length;if(te<2)return 0;var k,K,me,fe,ge,J=L[0].equals(L[te-1]),U=L[0],ee=I.strokeWidth/2,Q=1/(te-1),oe=0,$=!1,ue=0,Y=3*j,Z=2*j;we(L[0],L[1],s).multiplyScalar(ee),w.copy(L[0]).sub(s),_.copy(L[0]).add(s),x.copy(w),b.copy(_);for(var se=1;se<te;se++){K=se===te-1?J?L[1]:void 0:L[se+1];var ve=s;we(U,k=L[se],ve),a.copy(ve).multiplyScalar(ee),A.copy(k).sub(a),E.copy(k).add(a);var le=oe+Q;if(me=!1,void 0!==K){we(k,K,e),a.copy(e).multiplyScalar(ee),R.copy(k).sub(a),O.copy(k).add(a),fe=!0,a.subVectors(K,U),ve.dot(a)<0&&(fe=!1),1===se&&($=fe),a.subVectors(K,k),a.normalize();var _e=Math.abs(ve.dot(a));if(0!==_e){var ae=ee/_e;a.multiplyScalar(-ae),d.subVectors(k,U),v.copy(d).setLength(ae).add(a),D.copy(v).negate();var pe=v.length(),he=d.length();d.divideScalar(he),g.subVectors(K,k);var ce=g.length();switch(g.divideScalar(ce),d.dot(D)<he&&g.dot(D)<ce&&(me=!0),F.copy(v).add(k),D.add(k),ge=!1,me?fe?(O.copy(D),E.copy(D)):(R.copy(D),A.copy(D)):De(),I.strokeLineJoin){case"bevel":Je(fe,me,le);break;case"round":$e(fe,me),fe?Re(k,A,R,le,0):Re(k,O,E,le,1);break;default:var Te=ee*I.strokeMiterLimit/pe;if(Te<1){if("miter-clip"!==I.strokeLineJoin){Je(fe,me,le);break}$e(fe,me),fe?(g.subVectors(F,A).multiplyScalar(Te).add(A),C.subVectors(F,R).multiplyScalar(Te).add(R),Ne(A,le,0),Ne(g,le,0),Ne(k,le,.5),Ne(k,le,.5),Ne(g,le,0),Ne(C,le,0),Ne(k,le,.5),Ne(C,le,0),Ne(R,le,0)):(g.subVectors(F,E).multiplyScalar(Te).add(E),C.subVectors(F,O).multiplyScalar(Te).add(O),Ne(E,le,1),Ne(g,le,1),Ne(k,le,.5),Ne(k,le,.5),Ne(g,le,1),Ne(C,le,1),Ne(k,le,.5),Ne(C,le,1),Ne(O,le,1))}else me?(fe?(Ne(_,oe,1),Ne(w,oe,0),Ne(F,le,0),Ne(_,oe,1),Ne(F,le,0),Ne(D,le,1)):(Ne(_,oe,1),Ne(w,oe,0),Ne(F,le,1),Ne(w,oe,0),Ne(D,le,0),Ne(F,le,1)),fe?R.copy(F):O.copy(F)):fe?(Ne(A,le,0),Ne(F,le,0),Ne(k,le,.5),Ne(k,le,.5),Ne(F,le,0),Ne(R,le,0)):(Ne(E,le,1),Ne(F,le,1),Ne(k,le,.5),Ne(k,le,.5),Ne(F,le,1),Ne(O,le,1)),ge=!0}}else De()}else De();!J&&se===te-1&&pt(L[0],x,b,fe,!0,oe),oe=le,U=k,w.copy(R),_.copy(O)}if(J){if(me&&H){var be=F,xe=D;$!==fe&&(be=D,xe=F),fe?(ge||$)&&(xe.toArray(H,0),xe.toArray(H,9),ge&&be.toArray(H,3)):(ge||!$)&&(xe.toArray(H,3),xe.toArray(H,9),ge&&be.toArray(H,0))}}else pt(k,A,E,fe,!1,le);return ue;function we(at,Xe,Ke){return Ke.subVectors(Xe,at),Ke.set(-Ke.y,Ke.x).normalize()}function Ne(at,Xe,Ke){H&&(H[Y]=at.x,H[Y+1]=at.y,H[Y+2]=0,X&&(X[Y]=0,X[Y+1]=0,X[Y+2]=1),Y+=3,re&&(re[Z]=Xe,re[Z+1]=Ke,Z+=2)),ue+=3}function Re(at,Xe,Ke,lt,ot){s.copy(Xe).sub(at).normalize(),e.copy(Ke).sub(at).normalize();var St=Math.PI,ft=s.dot(e);Math.abs(ft)<1&&(St=Math.abs(Math.acos(ft))),St/=V,a.copy(Xe);for(var He=0,gt=V-1;He<gt;He++)d.copy(a).rotateAround(at,St),Ne(a,lt,ot),Ne(d,lt,ot),Ne(at,lt,.5),a.copy(d);Ne(d,lt,ot),Ne(Ke,lt,ot),Ne(at,lt,.5)}function De(){Ne(_,oe,1),Ne(w,oe,0),Ne(A,le,0),Ne(_,oe,1),Ne(A,le,1),Ne(E,le,0)}function Je(at,Xe,Ke){Xe?at?(Ne(_,oe,1),Ne(w,oe,0),Ne(A,le,0),Ne(_,oe,1),Ne(A,le,0),Ne(D,le,1),Ne(A,Ke,0),Ne(R,Ke,0),Ne(D,Ke,.5)):(Ne(_,oe,1),Ne(w,oe,0),Ne(E,le,1),Ne(w,oe,0),Ne(D,le,0),Ne(E,le,1),Ne(E,Ke,1),Ne(O,Ke,0),Ne(D,Ke,.5)):at?(Ne(A,Ke,0),Ne(R,Ke,0),Ne(k,Ke,.5)):(Ne(E,Ke,1),Ne(O,Ke,0),Ne(k,Ke,.5))}function $e(at,Xe){Xe&&(at?(Ne(_,oe,1),Ne(w,oe,0),Ne(A,le,0),Ne(_,oe,1),Ne(A,le,0),Ne(D,le,1),Ne(A,oe,0),Ne(k,le,.5),Ne(D,le,1),Ne(k,le,.5),Ne(R,oe,0),Ne(D,le,1)):(Ne(_,oe,1),Ne(w,oe,0),Ne(E,le,1),Ne(w,oe,0),Ne(D,le,0),Ne(E,le,1),Ne(E,oe,1),Ne(D,le,0),Ne(k,le,.5),Ne(k,le,.5),Ne(D,le,0),Ne(O,oe,1)))}function pt(at,Xe,Ke,lt,ot,St){switch(I.strokeLineCap){case"round":ot?Re(at,Ke,Xe,St,.5):Re(at,Xe,Ke,St,.5);break;case"square":if(ot)s.subVectors(Xe,at),e.set(s.y,-s.x),a.addVectors(s,e).add(at),d.subVectors(e,s).add(at),lt?(a.toArray(H,3),d.toArray(H,0),d.toArray(H,9)):(a.toArray(H,3),a.toArray(H,9),d.toArray(H,0));else{s.subVectors(Ke,at),e.set(s.y,-s.x),a.addVectors(s,e).add(at),d.subVectors(e,s).add(at);var ft=H.length;lt?(a.toArray(H,ft-3),d.toArray(H,ft-6),d.toArray(H,ft-12)):(a.toArray(H,ft-6),d.toArray(H,ft-3),d.toArray(H,ft-12))}}}}}();var TDSLoader=function(e){Loader.call(this,e),this.debug=!1,this.group=null,this.position=0,this.materials=[],this.meshes=[]};TDSLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:TDSLoader,load:function(e,a,d,v){var g=this,C=""===g.path?LoaderUtils.extractUrlBase(e):g.path,w=new FileLoader(this.manager);w.setPath(this.path),w.setResponseType("arraybuffer"),w.load(e,function(_){a(g.parse(_,C))},d,v)},parse:function(e,a){this.group=new Group,this.position=0,this.materials=[],this.meshes=[],this.readFile(e,a);for(var d=0;d<this.meshes.length;d++)this.group.add(this.meshes[d]);return this.group},readFile:function(e,a){var d=new DataView(e),v=this.readChunk(d);if(v.id===MLIBMAGIC||v.id===CMAGIC||v.id===M3DMAGIC)for(var g=this.nextChunk(d,v);0!==g;){if(g===M3D_VERSION){var C=this.readDWord(d);this.debugMessage("3DS file version: "+C)}else g===MDATA?(this.resetPosition(d),this.readMeshData(d,a)):this.debugMessage("Unknown main chunk: "+g.toString(16));g=this.nextChunk(d,v)}this.debugMessage("Parsed "+this.meshes.length+" meshes")},readMeshData:function(e,a){for(var d=this.readChunk(e),v=this.nextChunk(e,d);0!==v;){if(v===MESH_VERSION){var g=+this.readDWord(e);this.debugMessage("Mesh Version: "+g)}else if(v===MASTER_SCALE){var C=this.readFloat(e);this.debugMessage("Master scale: "+C),this.group.scale.set(C,C,C)}else v===NAMED_OBJECT?(this.debugMessage("Named Object"),this.resetPosition(e),this.readNamedObject(e)):v===MAT_ENTRY?(this.debugMessage("Material"),this.resetPosition(e),this.readMaterialEntry(e,a)):this.debugMessage("Unknown MDATA chunk: "+v.toString(16));v=this.nextChunk(e,d)}},readNamedObject:function(e){var a=this.readChunk(e),d=this.readString(e,64);a.cur=this.position;for(var v=this.nextChunk(e,a);0!==v;){if(v===N_TRI_OBJECT){this.resetPosition(e);var g=this.readMesh(e);g.name=d,this.meshes.push(g)}else this.debugMessage("Unknown named object chunk: "+v.toString(16));v=this.nextChunk(e,a)}this.endChunk(a)},readMaterialEntry:function(e,a){for(var d=this.readChunk(e),v=this.nextChunk(e,d),g=new MeshPhongMaterial;0!==v;){if(v===MAT_NAME)g.name=this.readString(e,64),this.debugMessage("   Name: "+g.name);else if(v===MAT_WIRE)this.debugMessage("   Wireframe"),g.wireframe=!0;else if(v===MAT_WIRE_SIZE){var C=this.readByte(e);g.wireframeLinewidth=C,this.debugMessage("   Wireframe Thickness: "+C)}else if(v===MAT_TWO_SIDE)g.side=DoubleSide,this.debugMessage("   DoubleSided");else if(v===MAT_ADDITIVE)this.debugMessage("   Additive Blending"),g.blending=AdditiveBlending;else if(v===MAT_DIFFUSE)this.debugMessage("   Diffuse Color"),g.color=this.readColor(e);else if(v===MAT_SPECULAR)this.debugMessage("   Specular Color"),g.specular=this.readColor(e);else if(v===MAT_AMBIENT)this.debugMessage("   Ambient color"),g.color=this.readColor(e);else if(v===MAT_SHININESS){var w=this.readWord(e);g.shininess=w,this.debugMessage("   Shininess : "+w)}else if(v===MAT_TRANSPARENCY){var _=this.readWord(e);g.opacity=.01*_,this.debugMessage("  Opacity : "+_),g.transparent=_<100}else v===MAT_TEXMAP?(this.debugMessage("   ColorMap"),this.resetPosition(e),g.map=this.readMap(e,a)):v===MAT_BUMPMAP?(this.debugMessage("   BumpMap"),this.resetPosition(e),g.bumpMap=this.readMap(e,a)):v===MAT_OPACMAP?(this.debugMessage("   OpacityMap"),this.resetPosition(e),g.alphaMap=this.readMap(e,a)):v===MAT_SPECMAP?(this.debugMessage("   SpecularMap"),this.resetPosition(e),g.specularMap=this.readMap(e,a)):this.debugMessage("   Unknown material chunk: "+v.toString(16));v=this.nextChunk(e,d)}this.endChunk(d),this.materials[g.name]=g},readMesh:function(e){var a=this.readChunk(e),d=this.nextChunk(e,a),v=new BufferGeometry,g=[],w=new Mesh(v,new MeshPhongMaterial);for(w.name="mesh";0!==d;){if(d===POINT_ARRAY){var _=this.readWord(e);this.debugMessage("   Vertex: "+_);for(var x=[],b=0;b<_;b++)x.push(this.readFloat(e)),x.push(this.readFloat(e)),x.push(this.readFloat(e));v.setAttribute("position",new Float32BufferAttribute(x,3))}else if(d===FACE_ARRAY)this.resetPosition(e),this.readFaceArray(e,w);else if(d===TEX_VERTS){var A=this.readWord(e);for(this.debugMessage("   UV: "+A),g=[],b=0;b<A;b++)g.push(this.readFloat(e)),g.push(this.readFloat(e));v.setAttribute("uv",new Float32BufferAttribute(g,2))}else if(d===MESH_MATRIX){this.debugMessage("   Tranformation Matrix (TODO)");var E=[];for(b=0;b<12;b++)E[b]=this.readFloat(e);var R=new Matrix4;R.elements[0]=E[0],R.elements[1]=E[6],R.elements[2]=E[3],R.elements[3]=E[9],R.elements[4]=E[2],R.elements[5]=E[8],R.elements[6]=E[5],R.elements[7]=E[11],R.elements[8]=E[1],R.elements[9]=E[7],R.elements[10]=E[4],R.elements[11]=E[10],R.elements[12]=0,R.elements[13]=0,R.elements[14]=0,R.elements[15]=1,R.transpose();var O=new Matrix4;O.getInverse(R,!0),v.applyMatrix4(O),R.decompose(w.position,w.quaternion,w.scale)}else this.debugMessage("   Unknown mesh chunk: "+d.toString(16));d=this.nextChunk(e,a)}return this.endChunk(a),v.computeVertexNormals(),w},readFaceArray:function(e,a){var d=this.readChunk(e),v=this.readWord(e);this.debugMessage("   Faces: "+v);for(var g=[],C=0;C<v;++C)g.push(this.readWord(e),this.readWord(e),this.readWord(e)),this.readWord(e);for(a.geometry.setIndex(g);this.position<d.end;){if((d=this.readChunk(e)).id===MSH_MAT_GROUP){this.debugMessage("      Material Group"),this.resetPosition(e);var w=this.readMaterialGroup(e),_=this.materials[w.name];void 0!==_&&(a.material=_,""===_.name&&(_.name=a.name))}else this.debugMessage("      Unknown face array chunk: "+d.toString(16));this.endChunk(d)}this.endChunk(d)},readMap:function(e,a){var d=this.readChunk(e),v=this.nextChunk(e,d),g={},C=new TextureLoader(this.manager);for(C.setPath(this.resourcePath||a).setCrossOrigin(this.crossOrigin);0!==v;){if(v===MAT_MAPNAME){var w=this.readString(e,128);g=C.load(w),this.debugMessage("      File: "+a+w)}else v===MAT_MAP_UOFFSET?(g.offset.x=this.readFloat(e),this.debugMessage("      OffsetX: "+g.offset.x)):v===MAT_MAP_VOFFSET?(g.offset.y=this.readFloat(e),this.debugMessage("      OffsetY: "+g.offset.y)):v===MAT_MAP_USCALE?(g.repeat.x=this.readFloat(e),this.debugMessage("      RepeatX: "+g.repeat.x)):v===MAT_MAP_VSCALE?(g.repeat.y=this.readFloat(e),this.debugMessage("      RepeatY: "+g.repeat.y)):this.debugMessage("      Unknown map chunk: "+v.toString(16));v=this.nextChunk(e,d)}return this.endChunk(d),g},readMaterialGroup:function(e){this.readChunk(e);var a=this.readString(e,64),d=this.readWord(e);this.debugMessage("         Name: "+a),this.debugMessage("         Faces: "+d);for(var v=[],g=0;g<d;++g)v.push(this.readWord(e));return{name:a,index:v}},readColor:function(e){var a=this.readChunk(e),d=new Color;if(a.id===COLOR_24||a.id===LIN_COLOR_24){var v=this.readByte(e),g=this.readByte(e),C=this.readByte(e);d.setRGB(v/255,g/255,C/255),this.debugMessage("      Color: "+d.r+", "+d.g+", "+d.b)}else a.id===COLOR_F||a.id===LIN_COLOR_F?(v=this.readFloat(e),g=this.readFloat(e),C=this.readFloat(e),d.setRGB(v,g,C),this.debugMessage("      Color: "+d.r+", "+d.g+", "+d.b)):this.debugMessage("      Unknown color chunk: "+a.toString(16));return this.endChunk(a),d},readChunk:function(e){var a={};return a.cur=this.position,a.id=this.readWord(e),a.size=this.readDWord(e),a.end=a.cur+a.size,a.cur+=6,a},endChunk:function(e){this.position=e.end},nextChunk:function(e,a){if(a.cur>=a.end)return 0;this.position=a.cur;try{var d=this.readChunk(e);return a.cur+=d.size,d.id}catch(v){return this.debugMessage("Unable to read chunk at "+this.position),0}},resetPosition:function(){this.position-=6},readByte:function(e){var a=e.getUint8(this.position,!0);return this.position+=1,a},readFloat:function(e){try{var a=e.getFloat32(this.position,!0);return this.position+=4,a}catch(d){this.debugMessage(d+" "+this.position+" "+e.byteLength)}},readInt:function(e){var a=e.getInt32(this.position,!0);return this.position+=4,a},readShort:function(e){var a=e.getInt16(this.position,!0);return this.position+=2,a},readDWord:function(e){var a=e.getUint32(this.position,!0);return this.position+=4,a},readWord:function(e){var a=e.getUint16(this.position,!0);return this.position+=2,a},readString:function(e,a){for(var d="",v=0;v<a;v++){var g=this.readByte(e);if(!g)break;d+=String.fromCharCode(g)}return d},debugMessage:function(e){this.debug&&console.log(e)}});var M3DMAGIC=19789,MLIBMAGIC=15786,CMAGIC=49725,M3D_VERSION=2,COLOR_F=16,COLOR_24=17,LIN_COLOR_24=18,LIN_COLOR_F=19,MDATA=15677,MESH_VERSION=15678,MASTER_SCALE=256,MAT_ENTRY=45055,MAT_NAME=40960,MAT_AMBIENT=40976,MAT_DIFFUSE=40992,MAT_SPECULAR=41008,MAT_SHININESS=41024,MAT_TRANSPARENCY=41040,MAT_TWO_SIDE=41089,MAT_ADDITIVE=41091,MAT_WIRE=41093,MAT_WIRE_SIZE=41095,MAT_TEXMAP=41472,MAT_OPACMAP=41488,MAT_BUMPMAP=41520,MAT_SPECMAP=41476,MAT_MAPNAME=41728,MAT_MAP_USCALE=41812,MAT_MAP_VSCALE=41814,MAT_MAP_UOFFSET=41816,MAT_MAP_VOFFSET=41818,NAMED_OBJECT=16384,N_TRI_OBJECT=16640,POINT_ARRAY=16656,FACE_ARRAY=16672,MSH_MAT_GROUP=16688,TEX_VERTS=16704,MESH_MATRIX=16736,TTFLoader=function(e){Loader.call(this,e),this.reversed=!1};TTFLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:TTFLoader,load:function(e,a,d,v){var g=this,C=new FileLoader(this.manager);C.setPath(this.path),C.setResponseType("arraybuffer"),C.load(e,function(w){a(g.parse(w))},d,v)},parse:function(e){function d(v){var C,g=[];v.forEach(function(_){"m"===_.type.toLowerCase()?g.push(C=[_]):"z"!==_.type.toLowerCase()&&C.push(_)});var w=[];return g.forEach(function(_){w.push(x={type:"m",x:_[_.length-1].x,y:_[_.length-1].y});for(var b=_.length-1;b>0;b--){var A=_[b],x={type:A.type};void 0!==A.x2&&void 0!==A.y2?(x.x1=A.x2,x.y1=A.y2,x.x2=A.x1,x.y2=A.y1):void 0!==A.x1&&void 0!==A.y1&&(x.x1=A.x1,x.y1=A.y1),x.x=_[b-1].x,x.y=_[b-1].y,w.push(x)}}),w}return"undefined"==typeof opentype?(console.warn("TTFLoader: The loader requires opentype.js. Make sure it's included before using the loader."),null):function(v,g){for(var C=Math.round,w={},_=1e5/(72*(v.unitsPerEm||2048)),x=v.encoding.cmap.glyphIndexMap,b=Object.keys(x),A=0;A<b.length;A++){var E=b[A],R=v.glyphs.glyphs[x[E]];if(void 0!==E){var O={ha:C(R.advanceWidth*_),x_min:C(R.xMin*_),x_max:C(R.xMax*_),o:""};g&&(R.path.commands=d(R.path.commands)),R.path.commands.forEach(function(D){"c"===D.type.toLowerCase()&&(D.type="b"),O.o+=D.type.toLowerCase()+" ",void 0!==D.x&&void 0!==D.y&&(O.o+=C(D.x*_)+" "+C(D.y*_)+" "),void 0!==D.x1&&void 0!==D.y1&&(O.o+=C(D.x1*_)+" "+C(D.y1*_)+" "),void 0!==D.x2&&void 0!==D.y2&&(O.o+=C(D.x2*_)+" "+C(D.y2*_)+" ")}),w[String.fromCodePoint(R.unicode)]=O}}return{glyphs:w,familyName:v.getEnglishName("fullName"),ascender:C(v.ascender*_),descender:C(v.descender*_),underlinePosition:v.tables.post.underlinePosition,underlineThickness:v.tables.post.underlineThickness,boundingBox:{xMin:v.tables.head.xMin,xMax:v.tables.head.xMax,yMin:v.tables.head.yMin,yMax:v.tables.head.yMax},resolution:1e3,original_font_information:v.tables.name}}(opentype.parse(e),this.reversed)}});var VRMLoader=function(){function s(e){if(void 0===GLTFLoader)throw new Error("VRMLoader: Import GLTFLoader.");Loader.call(this,e),this.gltfLoader=new GLTFLoader(this.manager)}return s.prototype=Object.assign(Object.create(Loader.prototype),{constructor:s,load:function(a,d,v,g){var C=this;this.gltfLoader.load(a,function(w){C.parse(w,d)},v,g)},setDRACOLoader:function(a){return this.glTFLoader.setDRACOLoader(a),this},parse:function(a,d){d(a)}}),s}(),VTKLoader=function(e){Loader.call(this,e)};VTKLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:VTKLoader,load:function(e,a,d,v){var g=this,C=new FileLoader(g.manager);C.setPath(g.path),C.setResponseType("arraybuffer"),C.load(e,function(w){a(g.parse(w))},d,v)},parse:function(e){function v(x,b){var A=x.length,E=new Float32Array(A+b.length);return E.set(x),E.set(b,A),E}function g(x,b){var A=x.length,E=new Int32Array(A+b.length);return E.set(x),E.set(b,A),E}function w(x){for(var b="",A=new Uint8Array(x),E=0,R=A.length;R--;)b+=String.fromCharCode(A[E++]);return b}var _=LoaderUtils.decodeText(new Uint8Array(e,0,250)).split("\n");return-1!==_[0].indexOf("xml")?function(x){function A(ce){var be,De,Je,$e,pt,ut,Te="undefined"!=typeof Uint8Array?Uint8Array:Array,xe=[],we=[],Ne="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Re=Ne.length;for(be=0;be<Re;be++)xe[be]=Ne[be];for(be=0;be<Re;++be)we[Ne.charCodeAt(be)]=be;if(we["-".charCodeAt(0)]=62,we["_".charCodeAt(0)]=63,(Re=ce.length)%4>0)throw new Error("Invalid string. Length must be a multiple of 4");ut=new Te(3*Re/4-(pt="="===ce[Re-2]?2:"="===ce[Re-1]?1:0)),Je=pt>0?Re-4:Re;var at=0;for(be=0,De=0;be<Je;be+=4,De+=3)$e=we[ce.charCodeAt(be)]<<18|we[ce.charCodeAt(be+1)]<<12|we[ce.charCodeAt(be+2)]<<6|we[ce.charCodeAt(be+3)],ut[at++]=(16711680&$e)>>16,ut[at++]=(65280&$e)>>8,ut[at++]=255&$e;return 2===pt?($e=we[ce.charCodeAt(be)]<<2|we[ce.charCodeAt(be+1)]>>4,ut[at++]=255&$e):1===pt&&($e=we[ce.charCodeAt(be)]<<10|we[ce.charCodeAt(be+1)]<<4|we[ce.charCodeAt(be+2)]>>2,ut[at++]=$e>>8&255,ut[at++]=255&$e),ut}function E(ce,Te){var be=0;if("UInt64"===D.attributes.header_type?be=8:"UInt32"===D.attributes.header_type&&(be=4),"binary"===ce.attributes.format&&Te){var Ne,Re,De,Je,pt,ut;if("Float32"===ce.attributes.type)var at=new Float32Array;else"Int64"===ce.attributes.type&&(at=new Int32Array);Re=(Ne=A(ce["#text"]))[0];for(var Xe=1;Xe<be-1;Xe++)Re|=Ne[Xe]<<Xe*be;for(Je=(Re+3)*be,(pt=[]).push(ut=Je+=Je%3>0?3-Je%3:0),De=3*be,Xe=0;Xe<Re;Xe++){for(var Ke=Ne[Xe*be+De],lt=1;lt<be-1;lt++)Ke|=Ne[Xe*be+De+lt]<<8*lt;pt.push(ut+=Ke)}for(Xe=0;Xe<pt.length-1;Xe++)we=(we=new Zlib.Inflate(Ne.slice(pt[Xe],pt[Xe+1]),{resize:!0,verify:!0}).decompress()).buffer,"Float32"===ce.attributes.type?at=v(at,we=new Float32Array(we)):"Int64"===ce.attributes.type&&(at=g(at,we=new Int32Array(we)));delete ce["#text"],"Int64"===ce.attributes.type&&"binary"===ce.attributes.format&&(at=at.filter(function(St,ft){if(ft%2!=1)return!0}))}else{if("binary"!==ce.attributes.format||Te)if(ce["#text"])var we=ce["#text"].split(/\s+/).filter(function(ft){if(""!==ft)return ft});else we=new Int32Array(0).buffer;else we=(we=A(ce["#text"])).slice(be).buffer;delete ce["#text"],"Float32"===ce.attributes.type?at=new Float32Array(we):"Int32"===ce.attributes.type?at=new Int32Array(we):"Int64"===ce.attributes.type&&(at=new Int32Array(we),"binary"===ce.attributes.format&&(at=at.filter(function(ft,He){if(He%2!=1)return!0})))}return at}var R=null;if(window.DOMParser)try{R=(new DOMParser).parseFromString(x,"text/xml")}catch(ce){R=null}else{if(!window.ActiveXObject)throw new Error("Cannot parse xml string!");try{if((R=new ActiveXObject("Microsoft.XMLDOM")).async=!1,!R.loadXML())throw new Error(R.parseError.reason+R.parseError.srcText)}catch(ce){R=null}}var D=function b(ce){var Te={};if(1===ce.nodeType){if(ce.attributes&&ce.attributes.length>0){Te.attributes={};for(var be=0;be<ce.attributes.length;be++){var xe=ce.attributes.item(be);Te.attributes[xe.nodeName]=xe.nodeValue.trim()}}}else 3===ce.nodeType&&(Te=ce.nodeValue.trim());if(ce.hasChildNodes())for(var we=0;we<ce.childNodes.length;we++){var De,Ne=ce.childNodes.item(we),Re=Ne.nodeName;if(void 0===Te[Re])""!==(De=b(Ne))&&(Te[Re]=De);else void 0===Te[Re].push&&(Te[Re]=[Te[Re]]),""!==(De=b(Ne))&&Te[Re].push(De)}return Te}(R.documentElement),F=[],L=[],I=[];if(D.PolyData){for(var V=D.PolyData.Piece,z=D.attributes.hasOwnProperty("compressor"),H=["PointData","Points","Strips","Polys"],X=0,re=H.length;X<re;){var j=V[H[X]];if(j&&j.DataArray){if("[object Array]"===Object.prototype.toString.call(j.DataArray))var te=j.DataArray;else te=[j.DataArray];for(var J=0,k=te.length;J<k;)"#text"in te[J]&&te[J]["#text"].length>0&&(te[J].text=E(te[J],z)),J++;switch(H[X]){case"PointData":var U=parseInt(V.attributes.NumberOfPoints),K=j.attributes.Normals;if(U>0)for(var ee=0,Q=te.length;ee<Q;ee++)if(K===te[ee].attributes.Name){var oe=te[ee].attributes.NumberOfComponents;(L=new Float32Array(U*oe)).set(te[ee].text,0)}break;case"Points":(U=parseInt(V.attributes.NumberOfPoints))>0&&(oe=j.DataArray.attributes.NumberOfComponents,(F=new Float32Array(U*oe)).set(j.DataArray.text,0));break;case"Strips":var me=parseInt(V.attributes.NumberOfStrips);if(me>0){var fe=new Int32Array(j.DataArray[0].text.length),ge=new Int32Array(j.DataArray[1].text.length);fe.set(j.DataArray[0].text,0),ge.set(j.DataArray[1].text,0);var $=me+fe.length;I=new Uint32Array(3*$-9*me);var ue=0;for(ee=0,Q=me;ee<Q;ee++){for(var Y=[],Z=0,se=ge[ee],ve=0;Z<se-ve;Z++)Y.push(fe[Z]),ee>0&&(ve=ge[ee-1]);var le=0;for(se=ge[ee],ve=0;le<se-ve-2;le++)le%2?(I[ue++]=Y[le],I[ue++]=Y[le+2],I[ue++]=Y[le+1]):(I[ue++]=Y[le],I[ue++]=Y[le+1],I[ue++]=Y[le+2]),ee>0&&(ve=ge[ee-1])}}break;case"Polys":var _e=parseInt(V.attributes.NumberOfPolys);if(_e>0){fe=new Int32Array(j.DataArray[0].text.length),ge=new Int32Array(j.DataArray[1].text.length),fe.set(j.DataArray[0].text,0),ge.set(j.DataArray[1].text,0),$=_e+fe.length,I=new Uint32Array(3*$-9*_e),ue=0;var ae=0;for(ee=0,Q=_e,ve=0;ee<Q;){var pe=[];for(Z=0,se=ge[ee];Z<se-ve;)pe.push(fe[ae++]),Z++;for(le=1;le<se-ve-1;)I[ue++]=pe[0],I[ue++]=pe[le],I[ue++]=pe[le+1],le++;ve=ge[++ee-1]}}}}X++}var he=new BufferGeometry;return he.setIndex(new BufferAttribute(I,1)),he.setAttribute("position",new BufferAttribute(F,3)),L.length===F.length&&he.setAttribute("normal",new BufferAttribute(L,3)),he}throw new Error("Unsupported DATASET type")}(w(e)):_[2].includes("ASCII")?function(x){var O,b=[],A=[],E=[],R=[],D=/^[^\d.\s-]+/,F=/(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)/g,L=/^(\d+)\s+([\s\d]*)/,I=/^POINTS /,V=/^POLYGONS /,z=/^TRIANGLE_STRIPS /,H=/^POINT_DATA[ ]+(\d+)/,X=/^CELL_DATA[ ]+(\d+)/,re=/^COLOR_SCALARS[ ]+(\w+)[ ]+3/,j=/^NORMALS[ ]+(\w+)[ ]+(\w+)/,te=!1,J=!1,k=!1,U=!1,K=!1,ee=!1,Q=!1,oe=x.split("\n");for(var me in oe){var fe=oe[me].trim();if(0===fe.indexOf("DATASET")){var ge=fe.split(" ")[1];if("POLYDATA"!==ge)throw new Error("Unsupported DATASET type: "+ge)}else if(te)for(;null!==(O=F.exec(fe))&&null===D.exec(fe);){var $=parseFloat(O[1]),ue=parseFloat(O[2]),Y=parseFloat(O[3]);A.push($,ue,Y)}else if(J){if(null!==(O=L.exec(fe))){var Z=parseInt(O[1]),se=O[2].split(/\s+/);if(Z>=3)for(var ve=parseInt(se[0]),ae=1,pe=0;pe<Z-2;++pe)le=parseInt(se[ae]),_e=parseInt(se[ae+1]),b.push(ve,le,_e),ae++}}else if(k){if(null!==(O=L.exec(fe))){var le,_e;if(Z=parseInt(O[1]),se=O[2].split(/\s+/),Z>=3)for(pe=0;pe<Z-2;pe++)pe%2==1?(ve=parseInt(se[pe]),le=parseInt(se[pe+2]),_e=parseInt(se[pe+1]),b.push(ve,le,_e)):(ve=parseInt(se[pe]),le=parseInt(se[pe+1]),_e=parseInt(se[pe+2]),b.push(ve,le,_e))}}else if(U||K)if(ee)for(;null!==(O=F.exec(fe))&&null===D.exec(fe);){var he=parseFloat(O[1]),ce=parseFloat(O[2]),Te=parseFloat(O[3]);E.push(he,ce,Te)}else if(Q)for(;null!==(O=F.exec(fe))&&null===D.exec(fe);){var be=parseFloat(O[1]),xe=parseFloat(O[2]),we=parseFloat(O[3]);R.push(be,xe,we)}null!==V.exec(fe)?(J=!0,te=!1,k=!1):null!==I.exec(fe)?(J=!1,te=!0,k=!1):null!==z.exec(fe)?(J=!1,te=!1,k=!0):null!==H.exec(fe)?(U=!0,te=!1,J=!1,k=!1):null!==X.exec(fe)?(K=!0,te=!1,J=!1,k=!1):null!==re.exec(fe)?(ee=!0,Q=!1,te=!1,J=!1,k=!1):null!==j.exec(fe)&&(Q=!0,ee=!1,te=!1,J=!1,k=!1)}var Ne=new BufferGeometry;if(Ne.setIndex(b),Ne.setAttribute("position",new Float32BufferAttribute(A,3)),R.length===A.length&&Ne.setAttribute("normal",new Float32BufferAttribute(R,3)),E.length!==b.length)E.length===A.length&&Ne.setAttribute("color",new Float32BufferAttribute(E,3));else{var Re=(Ne=Ne.toNonIndexed()).attributes.position.count/3;if(E.length===3*Re){var De=[];for(me=0;me<Re;me++)De.push(he=E[3*me+0],ce=E[3*me+1],Te=E[3*me+2]),De.push(he,ce,Te),De.push(he,ce,Te);Ne.setAttribute("color",new Float32BufferAttribute(De,3))}}return Ne}(w(e)):function(x){var b,A,E,R,O,X,re,D=new Uint8Array(x),F=new DataView(x),L=[],I=[],V=[],z=0;function H(oe,me){for(var fe=me,ge=oe[fe],$=[];10!==ge;)$.push(String.fromCharCode(ge)),ge=oe[++fe];return{start:me,end:fe,next:fe+1,parsedString:$.join("")}}for(;;){if(0===(re=(X=H(D,z)).parsedString).indexOf("DATASET")){var j=re.split(" ")[1];if("POLYDATA"!==j)throw new Error("Unsupported DATASET type: "+j)}else if(0===re.indexOf("POINTS")){for(b=4*(R=parseInt(re.split(" ")[1],10))*3,L=new Float32Array(3*R),A=X.next,E=0;E<R;E++)L[3*E]=F.getFloat32(A,!1),L[3*E+1]=F.getFloat32(A+4,!1),L[3*E+2]=F.getFloat32(A+8,!1),A+=12;X.next=X.next+b+1}else if(0===re.indexOf("TRIANGLE_STRIPS")){var te=parseInt(re.split(" ")[1],10);b=4*(J=parseInt(re.split(" ")[2],10)),V=new Uint32Array(3*J-9*te);var k=0;for(A=X.next,E=0;E<te;E++){var U=F.getInt32(A,!1),K=[];for(A+=4,O=0;O<U;O++)K.push(F.getInt32(A,!1)),A+=4;for(var ee=0;ee<U-2;ee++)ee%2?(V[k++]=K[ee],V[k++]=K[ee+2],V[k++]=K[ee+1]):(V[k++]=K[ee],V[k++]=K[ee+1],V[k++]=K[ee+2])}X.next=X.next+b+1}else if(0===re.indexOf("POLYGONS")){var J;for(te=parseInt(re.split(" ")[1],10),b=4*(J=parseInt(re.split(" ")[2],10)),V=new Uint32Array(3*J-9*te),k=0,A=X.next,E=0;E<te;E++){for(U=F.getInt32(A,!1),K=[],A+=4,O=0;O<U;O++)K.push(F.getInt32(A,!1)),A+=4;for(ee=1;ee<U-1;ee++)V[k++]=K[0],V[k++]=K[ee],V[k++]=K[ee+1]}X.next=X.next+b+1}else if(0===re.indexOf("POINT_DATA")){for(R=parseInt(re.split(" ")[1],10),X=H(D,X.next),b=4*R*3,I=new Float32Array(3*R),A=X.next,E=0;E<R;E++)I[3*E]=F.getFloat32(A,!1),I[3*E+1]=F.getFloat32(A+4,!1),I[3*E+2]=F.getFloat32(A+8,!1),A+=12;X.next=X.next+b}if((z=X.next)>=D.byteLength)break}var Q=new BufferGeometry;return Q.setIndex(new BufferAttribute(V,1)),Q.setAttribute("position",new BufferAttribute(L,3)),I.length===L.length&&Q.setAttribute("normal",new BufferAttribute(I,3)),Q}(e)}});var XLoader=function(){var s=function(_,x){if(!(_ instanceof x))throw new TypeError("Cannot call a class as a function")},e=function(){function w(_,x){for(var b=0;b<x.length;b++){var A=x[b];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(_,A.key,A)}}return function(_,x,b){return x&&w(_.prototype,x),b&&w(_,b),_}}(),a=function w(){s(this,w),this.boneName="",this.BoneIndex=0,this.Indeces=[],this.Weights=[],this.initMatrix=null,this.OffsetMatrix=null},d=function w(){s(this,w),this.animeName="",this.boneName="",this.targetBone=null,this.keyType=4,this.frameStartLv=0,this.keyFrames=[],this.InverseMx=null},v=function(){function w(_){s(this,w),this.fps=30,this.name="xanimation",this.length=0,this.hierarchy=[],this.putFlags=_,void 0===this.putFlags.putPos&&(this.putFlags.putPos=!0),void 0===this.putFlags.putRot&&(this.putFlags.putRot=!0),void 0===this.putFlags.putScl&&(this.putFlags.putScl=!0)}return e(w,[{key:"make",value:function(x){for(var b=0;b<x.length;b++)this.hierarchy.push(this.makeBonekeys(x[b]));this.length=this.hierarchy[0].keys[this.hierarchy[0].keys.length-1].time}},{key:"clone",value:function(){return Object.assign({},this)}},{key:"makeBonekeys",value:function(x){var b={};return b.name=x.boneName,b.parent="",b.keys=this.keyFrameRefactor(x),b.copy=function(){return Object.assign({},this)},b}},{key:"keyFrameRefactor",value:function(x){for(var b=[],A=0;A<x.keyFrames.length;A++){var E={};E.time=x.keyFrames[A].time*this.fps,x.keyFrames[A].pos&&this.putFlags.putPos&&(E.pos=x.keyFrames[A].pos),x.keyFrames[A].rot&&this.putFlags.putRot&&(E.rot=x.keyFrames[A].rot),x.keyFrames[A].scl&&this.putFlags.putScl&&(E.scl=x.keyFrames[A].scl),x.keyFrames[A].matrix&&(E.matrix=x.keyFrames[A].matrix,this.putFlags.putPos&&(E.pos=(new Vector3).setFromMatrixPosition(E.matrix)),this.putFlags.putRot&&(E.rot=(new Quaternion).setFromRotationMatrix(E.matrix)),this.putFlags.putScl&&(E.scl=(new Vector3).setFromMatrixScale(E.matrix))),b.push(E)}return b}}]),w}(),g=function w(){s(this,w),this.index=0,this.Frame=0,this.time=0,this.matrix=null},C=function(){function w(_){Loader.call(this,_),s(this,w),this.debug=!1,this.texloader=new TextureLoader(this.manager),this.url="",this._putMatLength=0,this._nowMat=null,this._nowFrameName="",this.frameHierarchie=[],this.Hierarchies={},this.HieStack=[],this._currentObject={},this._currentFrame={},this._data=null,this.onLoad=null,this.IsUvYReverse=!0,this.Meshes=[],this.animations=[],this.animTicksPerSecond=30,this._currentGeo=null,this._currentAnime=null,this._currentAnimeFrames=null}return e(w,[{key:"_setArgOption",value:function(x){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(x){for(var A=b;A<x.length;A++)switch(A){case 0:this.url=x[A];break;case 1:this.options=x[A]}void 0===this.options&&(this.options={})}}},{key:"load",value:function(x,b,A,E){var R=this;this._setArgOption(x);var O=new FileLoader(this.manager);O.setPath(this.path),O.setResponseType("arraybuffer"),O.load(this.url,function(D){R.parse(D,b)},A,E)}},{key:"_readLine",value:function(x){for(var b=0;;){var A=-1;if(-1===(A=x.indexOf("//",b))&&(A=x.indexOf("#",b)),!(A>-1&&A<2))break;var E=-1;b=(E=x.indexOf("\r\n",b))>0?E+2:(E=x.indexOf("\r",b))>0?E+1:x.indexOf("\n",b)+1}return x.substr(b)}},{key:"_readLine",value:function(x){for(var b=0;;){var A=-1;if(-1===(A=x.indexOf("//",b))&&(A=x.indexOf("#",b)),!(A>-1&&A<2))break;var E=-1;b=(E=x.indexOf("\r\n",b))>0?E+2:(E=x.indexOf("\r",b))>0?E+1:x.indexOf("\n",b)+1}return x.substr(b)}},{key:"_isBinary",value:function(x){var b=new DataView(x);if(84+50*b.getUint32(80,!0)===b.byteLength)return!0;for(var O=b.byteLength,D=0;D<O;D++)if(b.getUint8(D,!1)>127)return!0;return!1}},{key:"_ensureBinary",value:function(x){if("string"==typeof x){for(var b=new Uint8Array(x.length),A=0;A<x.length;A++)b[A]=255&x.charCodeAt(A);return b.buffer||b}return x}},{key:"_ensureString",value:function(x){return"string"!=typeof x?LoaderUtils.decodeText(new Uint8Array(x)):x}},{key:"parse",value:function(x,b){var A=this._ensureBinary(x);return this._data=this._ensureString(x),this.onLoad=b,this._isBinary(A)?this._parseBinary(A):this._parseASCII()}},{key:"_parseBinary",value:function(x){return this._parseASCII(LoaderUtils.decodeText(new Uint8Array(x)))}},{key:"_parseASCII",value:function(){var x;x=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:LoaderUtils.extractUrlBase(this.url),this.texloader.setPath(x).setCrossOrigin(this.crossOrigin),this.Hierarchies.children=[],this._hierarchieParse(this.Hierarchies,16),this._changeRoot(),this._currentObject=this.Hierarchies.children.shift(),this._mainloop()}},{key:"_hierarchieParse",value:function(x,b){for(var A=b;;){var E=this._data.indexOf("{",A)+1,R=this._data.indexOf("}",A),O=this._data.indexOf("{",E)+1;if(!(E>0&&R>E)){A=-1===E?this._data.length:R+1;break}var D={children:[]},F=this._readLine(this._data.substr(A,E-A-1)).trim(),L=F.split(/ /g);if(L.length>0?(D.type=L[0],D.name=L.length>=2?L[1]:L[0]+this.Hierarchies.children.length):(D.name=F,D.type=""),"Animation"===D.type){D.data=this._data.substr(O,R-O).trim();var I=this._hierarchieParse(D,R+1);A=I.end,D.children=I.parent.children}else{var V=this._data.lastIndexOf(";",O>0?Math.min(O,R):R);if(D.data=this._data.substr(E,V-E).trim(),O<=0||R<O)A=R+1;else{var z=Math.max(V+1,E),H=this._hierarchieParse(D,z);A=H.end,D.children=H.parent.children}}D.parent=x,"template"!=D.type&&x.children.push(D)}return{parent:x,end:A}}},{key:"_mainloop",value:function(){var x=this;this._mainProc(),this._currentObject.parent||this._currentObject.children.length>0||!this._currentObject.worked?setTimeout(function(){x._mainloop()},1):setTimeout(function(){x.onLoad({models:x.Meshes,animations:x.animations})},1)}},{key:"_mainProc",value:function(){for(var x=!1;;){if(!this._currentObject.worked){switch(this._currentObject.type){case"template":case"VertexDuplicationIndices":break;case"AnimTicksPerSecond":this.animTicksPerSecond=parseInt(this._currentObject.data);break;case"Frame":this._setFrame();break;case"FrameTransformMatrix":this._setFrameTransformMatrix();break;case"Mesh":this._changeRoot(),this._currentGeo={},this._currentGeo.name=this._currentObject.name.trim(),this._currentGeo.parentName=this._getParentName(this._currentObject).trim(),this._currentGeo.VertexSetedBoneCount=[],this._currentGeo.GeometryData={vertices:[],normals:[],uvs:[],skinIndices:[],skinWeights:[],indices:[],materialIndices:[]},this._currentGeo.Materials=[],this._currentGeo.normalVectors=[],this._currentGeo.BoneInfs=[],this._currentGeo.baseFrame=this._currentFrame,this._makeBoneFrom_CurrentFrame(),this._readVertexDatas(),x=!0;break;case"MeshNormals":this._readVertexDatas();break;case"MeshTextureCoords":this._setMeshTextureCoords();break;case"MeshMaterialList":this._setMeshMaterialList();break;case"Material":this._setMaterial();break;case"SkinWeights":this._setSkinWeights();break;case"AnimationSet":this._changeRoot(),this._currentAnime={},this._currentAnime.name=this._currentObject.name.trim(),this._currentAnime.AnimeFrames=[];break;case"Animation":this._currentAnimeFrames&&this._currentAnime.AnimeFrames.push(this._currentAnimeFrames),this._currentAnimeFrames=new d,this._currentAnimeFrames.boneName=this._currentObject.data.trim();break;case"AnimationKey":this._readAnimationKey(),x=!0}this._currentObject.worked=!0}if(this._currentObject.children.length>0){if(this._currentObject=this._currentObject.children.shift(),this.debug&&console.log("processing "+this._currentObject.name),x)break}else if(this._currentObject.worked&&this._currentObject.parent&&!this._currentObject.parent.parent&&this._changeRoot(),this._currentObject.parent?this._currentObject=this._currentObject.parent:x=!0,x)break}}},{key:"_changeRoot",value:function(){null!=this._currentGeo&&this._currentGeo.name&&this._makeOutputGeometry(),this._currentGeo={},null!=this._currentAnime&&this._currentAnime.name&&(this._currentAnimeFrames&&(this._currentAnime.AnimeFrames.push(this._currentAnimeFrames),this._currentAnimeFrames=null),this._makeOutputAnimation()),this._currentAnime={}}},{key:"_getParentName",value:function(x){return x.parent?x.parent.name?x.parent.name:this._getParentName(x.parent):""}},{key:"_setFrame",value:function(){this._nowFrameName=this._currentObject.name.trim(),this._currentFrame={},this._currentFrame.name=this._nowFrameName,this._currentFrame.children=[],this._currentObject.parent&&this._currentObject.parent.name&&(this._currentFrame.parentName=this._currentObject.parent.name),this.frameHierarchie.push(this._nowFrameName),this.HieStack[this._nowFrameName]=this._currentFrame}},{key:"_setFrameTransformMatrix",value:function(){this._currentFrame.FrameTransformMatrix=new Matrix4;var x=this._currentObject.data.split(",");this._ParseMatrixData(this._currentFrame.FrameTransformMatrix,x),this._makeBoneFrom_CurrentFrame()}},{key:"_makeBoneFrom_CurrentFrame",value:function(){if(this._currentFrame.FrameTransformMatrix){var x=new Bone;if(x.name=this._currentFrame.name,x.applyMatrix4(this._currentFrame.FrameTransformMatrix),x.matrixWorld=x.matrix,x.FrameTransformMatrix=this._currentFrame.FrameTransformMatrix,this._currentFrame.putBone=x,this._currentFrame.parentName)for(var b in this.HieStack)this.HieStack[b].name===this._currentFrame.parentName&&this.HieStack[b].putBone.add(this._currentFrame.putBone)}}},{key:"_readVertexDatas",value:function(){for(var x=0,b=0,A=0,E=0;;){var R=!1;if(0===A){var O=this._readInt1(x);A=1,(E=this._currentObject.data.indexOf(";",x=O.endRead)+1)<=0&&(E=this._currentObject.data.length)}else{var D=0;switch(b){case 0:D=this._currentObject.data.indexOf(",",x)+1;break;case 1:D=this._currentObject.data.indexOf(";,",x)+1}switch((0===D||D>E)&&(D=E,A=0,R=!0),this._currentObject.type){case"Mesh":switch(b){case 0:this._readVertex1(this._currentObject.data.substr(x,D-x));break;case 1:this._readFace1(this._currentObject.data.substr(x,D-x))}break;case"MeshNormals":0===b&&this._readNormalVector1(this._currentObject.data.substr(x,D-x))}x=D+1,R&&b++}if(x>=this._currentObject.data.length)break}}},{key:"_readInt1",value:function(x){var b=this._currentObject.data.indexOf(";",x);return{refI:parseInt(this._currentObject.data.substr(x,b-x)),endRead:b+1}}},{key:"_readVertex1",value:function(x){var b=this._readLine(x.trim()).substr(0,x.length-2).split(";");this._currentGeo.GeometryData.vertices.push(parseFloat(b[0]),parseFloat(b[1]),parseFloat(b[2])),this._currentGeo.GeometryData.skinIndices.push(0,0,0,0),this._currentGeo.GeometryData.skinWeights.push(1,0,0,0),this._currentGeo.VertexSetedBoneCount.push(0)}},{key:"_readFace1",value:function(x){var b=this._readLine(x.trim()).substr(2,x.length-4).split(",");this._currentGeo.GeometryData.indices.push(parseInt(b[0],10),parseInt(b[1],10),parseInt(b[2],10))}},{key:"_readNormalVector1",value:function(x){var b=this._readLine(x.trim()).substr(0,x.length-2).split(";");this._currentGeo.GeometryData.normals.push(parseFloat(b[0]),parseFloat(b[1]),parseFloat(b[2]))}},{key:"_buildGeometry",value:function(){for(var x=new BufferGeometry,b=[],A=[],E=[],R=[],O=[],D=this._currentGeo.GeometryData,F=0,L=D.indices.length;F<L;F++){var I=2*D.indices[F],V=3*D.indices[F],z=4*D.indices[F];b.push(D.vertices[V],D.vertices[V+1],D.vertices[V+2]),A.push(D.normals[V],D.normals[V+1],D.normals[V+2]),R.push(D.skinIndices[z],D.skinIndices[z+1],D.skinIndices[z+2],D.skinIndices[z+3]),O.push(D.skinWeights[z],D.skinWeights[z+1],D.skinWeights[z+2],D.skinWeights[z+3]),E.push(D.uvs[I],D.uvs[I+1])}return x.setAttribute("position",new Float32BufferAttribute(b,3)),x.setAttribute("normal",new Float32BufferAttribute(A,3)),x.setAttribute("uv",new Float32BufferAttribute(E,2)),x.setAttribute("skinIndex",new Uint16BufferAttribute(R,4)),x.setAttribute("skinWeight",new Float32BufferAttribute(O,4)),this._computeGroups(x,D.materialIndices),x}},{key:"_computeGroups",value:function(x,b){for(var A,E=[],R=void 0,O=0;O<b.length;O++){var D=b[O];D!==R&&(R=D,void 0!==A&&(A.count=3*O-A.start,E.push(A)),A={start:3*O,materialIndex:R})}void 0!==A&&(A.count=3*O-A.start,E.push(A)),x.groups=E}},{key:"_setMeshTextureCoords",value:function(){for(var x=0,b=0,A=0;;){if(0===b)if(0===A)x=this._readInt1(0).endRead,A=1;else{var R=this._currentObject.data.indexOf(",",x)+1;0===R&&(R=this._currentObject.data.length,b=2,A=0);var O=this._currentObject.data.substr(x,R-x),D=this._readLine(O.trim()).split(";");this._currentGeo.GeometryData.uvs.push(parseFloat(D[0]),this.IsUvYReverse?1-parseFloat(D[1]):parseFloat(D[1])),x=R+1}if(x>=this._currentObject.data.length)break}}},{key:"_setMeshMaterialList",value:function(){for(var x=0,b=0,A=0;;){if(A<2)x=this._readInt1(x).endRead,A++;else{var R=this._currentObject.data.indexOf(";",x);-1===R&&(R=this._currentObject.data.length,b=3,A=0);for(var O=this._currentObject.data.substr(x,R-x),D=this._readLine(O.trim()).split(","),F=0;F<D.length;F++)this._currentGeo.GeometryData.materialIndices[F]=parseInt(D[F]);x=this._currentObject.data.length}if(x>=this._currentObject.data.length||b>=3)break}}},{key:"_setMaterial",value:function(){var x=new MeshPhongMaterial({color:16777215*Math.random()});x.side=FrontSide,x.name=this._currentObject.name;var b=0,A=this._currentObject.data.indexOf(";",b),E=this._currentObject.data.substr(b,A-b),R=this._readLine(E.trim()).split(";");x.color.r=parseFloat(R[0]),x.color.g=parseFloat(R[1]),x.color.b=parseFloat(R[2]),A=this._currentObject.data.indexOf(";",b=A+2),E=this._currentObject.data.substr(b,A-b),x.shininess=parseFloat(this._readLine(E)),A=this._currentObject.data.indexOf(";",b=A+1),E=this._currentObject.data.substr(b,A-b);var O=this._readLine(E.trim()).split(";");x.specular.r=parseFloat(O[0]),x.specular.g=parseFloat(O[1]),x.specular.b=parseFloat(O[2]),-1===(A=this._currentObject.data.indexOf(";",b=A+2))&&(A=this._currentObject.data.length),E=this._currentObject.data.substr(b,A-b);var D=this._readLine(E.trim()).split(";");x.emissive.r=parseFloat(D[0]),x.emissive.g=parseFloat(D[1]),x.emissive.b=parseFloat(D[2]);for(var F=null;this._currentObject.children.length>0;){F=this._currentObject.children.shift(),this.debug&&console.log("processing "+F.name);var L=F.data.substr(1,F.data.length-2);switch(F.type){case"TextureFilename":x.map=this.texloader.load(L);break;case"BumpMapFilename":x.bumpMap=this.texloader.load(L),x.bumpScale=.05;break;case"NormalMapFilename":x.normalMap=this.texloader.load(L),x.normalScale=new Vector2(2,2);break;case"EmissiveMapFilename":x.emissiveMap=this.texloader.load(L);break;case"LightMapFilename":x.lightMap=this.texloader.load(L)}}this._currentGeo.Materials.push(x)}},{key:"_setSkinWeights",value:function(){var x=new a,b=0,A=this._currentObject.data.indexOf(";",b),E=this._currentObject.data.substr(b,A-b);b=A+1,x.boneName=E.substr(1,E.length-2),x.BoneIndex=this._currentGeo.BoneInfs.length,A=this._currentObject.data.indexOf(";",b),A=this._currentObject.data.indexOf(";",b=A+1),E=this._currentObject.data.substr(b,A-b);for(var R=this._readLine(E.trim()).split(","),O=0;O<R.length;O++)x.Indeces.push(parseInt(R[O]));A=this._currentObject.data.indexOf(";",b=A+1),E=this._currentObject.data.substr(b,A-b);for(var D=this._readLine(E.trim()).split(","),F=0;F<D.length;F++)x.Weights.push(parseFloat(D[F]));(A=this._currentObject.data.indexOf(";",b=A+1))<=0&&(A=this._currentObject.data.length),E=this._currentObject.data.substr(b,A-b);var L=this._readLine(E.trim()).split(",");x.OffsetMatrix=new Matrix4,this._ParseMatrixData(x.OffsetMatrix,L),this._currentGeo.BoneInfs.push(x)}},{key:"_makePutBoneList",value:function(x,b){var A=!1;for(var E in this.HieStack)if(this.HieStack[E].name===x||A){A=!0;var R=new Bone;if(R.name=this.HieStack[E].name,R.applyMatrix4(this.HieStack[E].FrameTransformMatrix),R.matrixWorld=R.matrix,R.FrameTransformMatrix=this.HieStack[E].FrameTransformMatrix,R.pos=(new Vector3).setFromMatrixPosition(R.FrameTransformMatrix).toArray(),R.rotq=(new Quaternion).setFromRotationMatrix(R.FrameTransformMatrix).toArray(),R.scl=(new Vector3).setFromMatrixScale(R.FrameTransformMatrix).toArray(),this.HieStack[E].parentName&&this.HieStack[E].parentName.length>0)for(var O=0;O<b.length;O++)if(this.HieStack[E].parentName===b[O].name){b[O].add(R),R.parent=O;break}b.push(R)}}},{key:"_makeOutputGeometry",value:function(){var x=null;if(this._currentGeo.BoneInfs.length>0){var b=[];this._makePutBoneList(this._currentGeo.baseFrame.parentName,b);for(var A=0;A<this._currentGeo.BoneInfs.length;A++){for(var E=0,R=0;R<b.length;R++)if(b[R].name===this._currentGeo.BoneInfs[A].boneName){E=R,b[R].OffsetMatrix=new Matrix4,b[R].OffsetMatrix.copy(this._currentGeo.BoneInfs[A].OffsetMatrix);break}for(var O=0;O<this._currentGeo.BoneInfs[A].Indeces.length;O++){var D=this._currentGeo.BoneInfs[A].Indeces[O],F=this._currentGeo.BoneInfs[A].Weights[O],L=4*D;switch(this._currentGeo.VertexSetedBoneCount[D]){case 0:this._currentGeo.GeometryData.skinIndices[L]=E,this._currentGeo.GeometryData.skinWeights[L]=F;break;case 1:this._currentGeo.GeometryData.skinIndices[L+1]=E,this._currentGeo.GeometryData.skinWeights[L+1]=F;break;case 2:this._currentGeo.GeometryData.skinIndices[L+2]=E,this._currentGeo.GeometryData.skinWeights[L+2]=F;break;case 3:this._currentGeo.GeometryData.skinIndices[L+3]=E,this._currentGeo.GeometryData.skinWeights[L+3]=F}this._currentGeo.VertexSetedBoneCount[D]++,this._currentGeo.VertexSetedBoneCount[D]>4&&console.log("warn! over 4 bone weight! :"+D)}}for(var I=0;I<this._currentGeo.Materials.length;I++)this._currentGeo.Materials[I].skinning=!0;for(var V=[],z=0;z<b.length;z++)V.push(b[z].OffsetMatrix?b[z].OffsetMatrix:new Matrix4);x=new SkinnedMesh(this._buildGeometry(),1===this._currentGeo.Materials.length?this._currentGeo.Materials[0]:this._currentGeo.Materials),this._initSkeleton(x,b,V)}else x=new Mesh(this._buildGeometry(),1===this._currentGeo.Materials.length?this._currentGeo.Materials[0]:this._currentGeo.Materials);x.name=this._currentGeo.name;var re=new Matrix4,j=this._currentGeo.baseFrame.putBone;if(j&&j.parent){for(;j=j.parent;)re.multiply(j.FrameTransformMatrix);x.applyMatrix4(re)}this.Meshes.push(x)}},{key:"_initSkeleton",value:function(x,b,A){var R,O,D,F,E=[];for(D=0,F=b.length;D<F;D++)O=b[D],R=new Bone,E.push(R),R.name=O.name,R.position.fromArray(O.pos),R.quaternion.fromArray(O.rotq),void 0!==O.scl&&R.scale.fromArray(O.scl);for(D=0,F=b.length;D<F;D++)-1!==(O=b[D]).parent&&null!==O.parent&&void 0!==E[O.parent]?E[O.parent].add(E[D]):x.add(E[D]);x.updateMatrixWorld(!0);var L=new Skeleton(E,A);x.bind(L,x.matrixWorld)}},{key:"_readAnimationKey",value:function(){var x=0,b=this._currentObject.data.indexOf(";",x),A=this._currentObject.data.substr(x,b-x);x=b+1;var E=parseInt(this._readLine(A));b=this._currentObject.data.indexOf(";",x),A=this._currentObject.data.substr(x=b+1);for(var R=this._readLine(A.trim()).split(";,"),O=0;O<R.length;O++){var D=R[O].split(";"),F=new g;if(F.type=E,F.Frame=parseInt(D[0]),F.index=this._currentAnimeFrames.keyFrames.length,F.time=F.Frame,4!=E){for(var L=!1,I=0;I<this._currentAnimeFrames.keyFrames.length;I++)if(this._currentAnimeFrames.keyFrames[I].Frame===F.Frame){F=this._currentAnimeFrames.keyFrames[I],L=!0;break}var V=D[2].split(",");switch(E){case 0:F.rot=new Quaternion(parseFloat(V[1]),parseFloat(V[2]),parseFloat(V[3]),-1*parseFloat(V[0]));break;case 1:F.scl=new Vector3(parseFloat(V[0]),parseFloat(V[1]),parseFloat(V[2]));break;case 2:F.pos=new Vector3(parseFloat(V[0]),parseFloat(V[1]),parseFloat(V[2]))}L||this._currentAnimeFrames.keyFrames.push(F)}else F.matrix=new Matrix4,this._ParseMatrixData(F.matrix,D[2].split(",")),this._currentAnimeFrames.keyFrames.push(F)}}},{key:"_makeOutputAnimation",value:function(){var x=new v(this.options);x.fps=this.animTicksPerSecond,x.name=this._currentAnime.name,x.make(this._currentAnime.AnimeFrames),this.animations.push(x)}},{key:"assignAnimation",value:function(x,b){var A=x,E=b;if(A||(A=this.Meshes[0]),E||(E=this.animations[0]),!A||!E)return null;var R={};R.fps=E.fps,R.name=E.name,R.length=E.length,R.hierarchy=[];for(var O=0;O<A.skeleton.bones.length;O++){for(var D=!1,F=0;F<E.hierarchy.length;F++)if(A.skeleton.bones[O].name===E.hierarchy[F].name){D=!0;var L=E.hierarchy[F].copy();if(L.parent=-1,A.skeleton.bones[O].parent&&"Bone"===A.skeleton.bones[O].parent.type)for(var I=0;I<R.hierarchy.length;I++)R.hierarchy[I].name===A.skeleton.bones[O].parent.name&&(L.parent=I,L.parentName=A.skeleton.bones[O].parent.name);R.hierarchy.push(L);break}if(!D){var V=E.hierarchy[0].copy();V.name=A.skeleton.bones[O].name,V.parent=-1;for(var z=0;z<V.keys.length;z++)V.keys[z].pos&&V.keys[z].pos.set(0,0,0),V.keys[z].scl&&V.keys[z].scl.set(1,1,1),V.keys[z].rot&&V.keys[z].rot.set(0,0,0,1);R.hierarchy.push(V)}}return A.geometry.animations||(A.geometry.animations=[]),A.geometry.animations.push(AnimationClip.parseAnimation(R,A.skeleton.bones)),A.animationMixer||(A.animationMixer=new AnimationMixer(A)),R}},{key:"_ParseMatrixData",value:function(x,b){x.set(parseFloat(b[0]),parseFloat(b[4]),parseFloat(b[8]),parseFloat(b[12]),parseFloat(b[1]),parseFloat(b[5]),parseFloat(b[9]),parseFloat(b[13]),parseFloat(b[2]),parseFloat(b[6]),parseFloat(b[10]),parseFloat(b[14]),parseFloat(b[3]),parseFloat(b[7]),parseFloat(b[11]),parseFloat(b[15]))}}]),w}();return C}(),ColorConverter={setHSV:function(e,a,d,v){return a=MathUtils.euclideanModulo(a,1),d=MathUtils.clamp(d,0,1),v=MathUtils.clamp(v,0,1),e.setHSL(a,d*v/((a=(2-d)*v)<1?a:2-a),.5*a)},getHSV:function(){var s={};return function(a,d){return void 0===d&&(console.warn("ColorConverter: .getHSV() target is now required"),d={h:0,s:0,l:0}),a.getHSL(s),s.s*=s.l<.5?s.l:1-s.l,d.h=s.h,d.s=2*s.s/(s.l+s.s),d.v=s.l+s.s,d}}(),setCMYK:function(e,a,d,v,g){return e.setRGB((1-a)*(1-g),(1-d)*(1-g),(1-v)*(1-g))},getCMYK:function(e,a){void 0===a&&(console.warn("ColorConverter: .getCMYK() target is now required"),a={c:0,m:0,y:0,k:0});var d=e.r,v=e.g,g=e.b,C=1-Math.max(d,v,g),_=(1-v-C)/(1-C),x=(1-g-C)/(1-C);return a.c=(1-d-C)/(1-C),a.m=_,a.y=x,a.k=C,a}},ImprovedNoise=function(){for(var e=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],a=0;a<256;a++)e[256+a]=e[a];function d(C){return C*C*C*(C*(6*C-15)+10)}function v(C,w,_){return w+C*(_-w)}function g(C,w,_,x){var b=15&C,A=b<8?w:_,E=b<4?_:12==b||14==b?w:x;return(0==(1&b)?A:-A)+(0==(2&b)?E:-E)}return{noise:function(w,_,x){var b=Math.floor(w),A=Math.floor(_),E=Math.floor(x),R=255&b,O=255&A,D=255&E,F=(w-=b)-1,L=(_-=A)-1,I=(x-=E)-1,V=d(w),z=d(_),H=d(x),X=e[R]+O,re=e[X]+D,j=e[X+1]+D,te=e[R+1]+O,J=e[te]+D,k=e[te+1]+D;return v(H,v(z,v(V,g(e[re],w,_,x),g(e[J],F,_,x)),v(V,g(e[j],w,L,x),g(e[k],F,L,x))),v(z,v(V,g(e[re+1],w,_,I),g(e[J+1],F,_,x-1)),v(V,g(e[j+1],w,L,I),g(e[k+1],F,L,I))))}}},Lut=function(e,a){return this.lut=[],this.setColorMap(e,a),this};Lut.prototype={constructor:Lut,lut:[],map:[],n:256,minV:0,maxV:1,set:function(e){return e instanceof Lut&&this.copy(e),this},setMin:function(e){return this.minV=e,this},setMax:function(e){return this.maxV=e,this},setColorMap:function(e,a){this.map=ColorMapKeywords[e]||ColorMapKeywords.rainbow,this.n=a||32;var d=1/this.n;this.lut.length=0;for(var v=0;v<=1;v+=d)for(var g=0;g<this.map.length-1;g++)if(v>=this.map[g][0]&&v<this.map[g+1][0]){var C=this.map[g][0],w=this.map[g+1][0],_=new Color(this.map[g][1]),x=new Color(this.map[g+1][1]),b=_.lerp(x,(v-C)/(w-C));this.lut.push(b)}return this},copy:function(e){return this.lut=e.lut,this.map=e.map,this.n=e.n,this.minV=e.minV,this.maxV=e.maxV,this},getColor:function(e){e<=this.minV?e=this.minV:e>=this.maxV&&(e=this.maxV),e=(e-this.minV)/(this.maxV-this.minV);var a=Math.round(e*this.n);return a==this.n&&(a-=1),this.lut[a]},addColorMap:function(e,a){ColorMapKeywords[e]=a},createCanvas:function(){var e=document.createElement("canvas");return e.width=1,e.height=this.n,this.updateCanvas(e),e},updateCanvas:function(e){for(var a=e.getContext("2d",{alpha:!1}),d=a.getImageData(0,0,1,this.n),v=d.data,g=0,C=1/this.n,w=1;w>=0;w-=C)for(var _=this.map.length-1;_>=0;_--)if(w<this.map[_][0]&&w>=this.map[_-1][0]){var x=this.map[_-1][0],b=this.map[_][0],A=new Color(this.map[_-1][1]),E=new Color(this.map[_][1]),R=A.lerp(E,(w-x)/(b-x));v[4*g]=Math.round(255*R.r),v[4*g+1]=Math.round(255*R.g),v[4*g+2]=Math.round(255*R.b),v[4*g+3]=255,g+=1}return a.putImageData(d,0,0),e}};var ColorMapKeywords={rainbow:[[0,255],[.2,65535],[.5,65280],[.8,16776960],[1,16711680]],cooltowarm:[[0,3952322],[.2,10206463],[.5,14474460],[.8,16163717],[1,11797542]],blackbody:[[0,0],[.2,7864320],[.5,15086080],[.8,16776960],[1,16777215]],grayscale:[[0,0],[.2,4210752],[.5,8355712],[.8,12566463],[1,16777215]]},MeshSurfaceSampler=function(){var s=new Triangle;function e(a){var d=a.geometry;if(!d.isBufferGeometry||3!==d.attributes.position.itemSize)throw new Error("MeshSurfaceSampler: Requires BufferGeometry triangle mesh.");d.index&&(console.warn("MeshSurfaceSampler: Converting geometry to non-indexed BufferGeometry."),d=d.toNonIndexed()),this.geometry=d,this.positionAttribute=this.geometry.getAttribute("position"),this.weightAttribute=null,this.distribution=null}return e.prototype={constructor:e,setWeightAttribute:function(d){return this.weightAttribute=d?this.geometry.getAttribute(d):null,this},build:function(){for(var d=this.positionAttribute,v=this.weightAttribute,g=new Float32Array(d.count/3),C=0;C<d.count;C+=3){var w=1;v&&(w=v.getX(C)+v.getX(C+1)+v.getX(C+2)),s.a.fromBufferAttribute(d,C),s.b.fromBufferAttribute(d,C+1),s.c.fromBufferAttribute(d,C+2),w*=s.getArea(),g[C/3]=w}this.distribution=new Float32Array(d.count/3);var _=0;for(C=0;C<g.length;C++)this.distribution[C]=_+=g[C];return this},sample:function(d,v){var g=this.distribution[this.distribution.length-1],C=this.binarySearch(Math.random()*g);return this.sampleFace(C,d,v)},binarySearch:function(d){for(var v=this.distribution,g=0,C=v.length-1,w=-1;g<=C;){var _=Math.floor((g+C)/2);if(0===_||v[_-1]<=d&&v[_]>d){w=_;break}d<v[_]?C=_-1:g=_+1}return w},sampleFace:function(d,v,g){var C=Math.random(),w=Math.random();return C+w>1&&(C=1-C,w=1-w),s.a.fromBufferAttribute(this.positionAttribute,3*d),s.b.fromBufferAttribute(this.positionAttribute,3*d+1),s.c.fromBufferAttribute(this.positionAttribute,3*d+2),v.set(0,0,0).addScaledVector(s.a,C).addScaledVector(s.b,w).addScaledVector(s.c,1-(C+w)),s.getNormal(g),this}},e}(),ConvexObjectBreaker=function(e,a){this.minSizeForBreak=e||1.4,this.smallDelta=a||1e-4,this.tempLine1=new Line3,this.tempPlane1=new Plane,this.tempPlane2=new Plane,this.tempPlane_Cut=new Plane,this.tempCM1=new Vector3,this.tempCM2=new Vector3,this.tempVector3=new Vector3,this.tempVector3_2=new Vector3,this.tempVector3_3=new Vector3,this.tempVector3_P0=new Vector3,this.tempVector3_P1=new Vector3,this.tempVector3_P2=new Vector3,this.tempVector3_N0=new Vector3,this.tempVector3_N1=new Vector3,this.tempVector3_AB=new Vector3,this.tempVector3_CB=new Vector3,this.tempResultObjects={object1:null,object2:null},this.segments=[];for(var v=0;v<900;v++)this.segments[v]=!1};ConvexObjectBreaker.prototype={constructor:ConvexObjectBreaker,prepareBreakableObject:function(e,a,d,v,g){e.geometry.isBufferGeometry||console.error("ConvexObjectBreaker.prepareBreakableObject(): Parameter object must have a BufferGeometry.");var C=e.userData;C.mass=a,C.velocity=d.clone(),C.angularVelocity=v.clone(),C.breakable=g},subdivideByImpact:function(e,a,d,v,g){var C=[],w=this.tempPlane1,_=this.tempPlane2;this.tempVector3.addVectors(a,d),w.setFromCoplanarPoints(a,e.position,this.tempVector3);var x=g+v,b=this;return function A(E,R,O,D){if(Math.random()<.05*D||D>x)C.push(E);else{var F=Math.PI;0===D?(_.normal.copy(w.normal),_.constant=w.constant):D<=v?(F=(O-R)*(.2+.6*Math.random())+R,b.tempVector3_2.copy(e.position).sub(a).applyAxisAngle(d,F).add(a),_.setFromCoplanarPoints(a,b.tempVector3,b.tempVector3_2)):(F=(.5*(1&D)+.2*(2-Math.random()))*Math.PI,b.tempVector3_2.copy(a).sub(E.position).applyAxisAngle(d,F).add(E.position),b.tempVector3_3.copy(d).add(E.position),_.setFromCoplanarPoints(E.position,b.tempVector3_3,b.tempVector3_2)),b.cutByPlane(E,_,b.tempResultObjects);var L=b.tempResultObjects.object1,I=b.tempResultObjects.object2;L&&A(L,R,F,D+1),I&&A(I,F,O,D+1)}}(e,0,2*Math.PI,0),C},cutByPlane:function(e,a,d){var v=e.geometry,g=v.attributes.position.array,C=v.attributes.normal.array,w=g.length/3,_=w/3,x=v.getIndex();function b(be,xe){var we=3*be+xe;return x?x[we]:we}x&&(_=(x=x.array).length/3);for(var A=[],E=[],R=this.smallDelta,O=w*w,D=0;D<O;D++)this.segments[D]=!1;var F=this.tempVector3_P0,L=this.tempVector3_P1,I=this.tempVector3_N0,V=this.tempVector3_N1;for(D=0;D<_-1;D++){var z=b(D,0),H=b(D,1),X=b(D,2);I.set(C[z],C[z]+1,C[z]+2);for(var re=D+1;re<_;re++){var j=b(re,0),te=b(re,1),J=b(re,2);V.set(C[j],C[j]+1,C[j]+2),1-I.dot(V)<R&&(z===j||z===te||z===J?H===j||H===te||H===J?(this.segments[z*w+H]=!0,this.segments[H*w+z]=!0):(this.segments[X*w+z]=!0,this.segments[z*w+X]=!0):(H===j||H===te||H===J)&&(this.segments[X*w+H]=!0,this.segments[H*w+X]=!0))}}var U=this.tempPlane_Cut;for(e.updateMatrix(),ConvexObjectBreaker.transformPlaneToLocalSpace(a,e.matrix,U),D=0;D<_;D++)for(var K=b(D,0),ee=b(D,1),Q=b(D,2),oe=0;oe<3;oe++){var me=0===oe?K:1===oe?ee:Q,fe=0===oe?ee:1===oe?Q:K;if(!this.segments[me*w+fe]){this.segments[me*w+fe]=!0,this.segments[fe*w+me]=!0,F.set(g[3*me],g[3*me+1],g[3*me+2]),L.set(g[3*fe],g[3*fe+1],g[3*fe+2]);var $=0;(ue=U.distanceToPoint(F))>R?($=2,E.push(F.clone())):ue<-R?($=1,A.push(F.clone())):($=3,A.push(F.clone()),E.push(F.clone()));var ue,Y=0;if((ue=U.distanceToPoint(L))>R?(Y=2,E.push(L.clone())):ue<-R?(Y=1,A.push(L.clone())):(Y=3,A.push(L.clone()),E.push(L.clone())),1===$&&2===Y||2===$&&1===Y){this.tempLine1.start.copy(F),this.tempLine1.end.copy(L);var Z=new Vector3;if(void 0===(Z=U.intersectLine(this.tempLine1,Z)))return console.error("Internal error: segment does not intersect plane."),d.segmentedObject1=null,d.segmentedObject2=null,0;A.push(Z),E.push(Z.clone())}}}var se=.5*e.userData.mass;this.tempCM1.set(0,0,0);var ve=0,le=A.length;if(le>0){for(D=0;D<le;D++)this.tempCM1.add(A[D]);for(this.tempCM1.divideScalar(le),D=0;D<le;D++)(_e=A[D]).sub(this.tempCM1),ve=Math.max(ve,_e.x,_e.y,_e.z);this.tempCM1.add(e.position)}this.tempCM2.set(0,0,0);var ae=0,pe=E.length;if(pe>0){for(D=0;D<pe;D++)this.tempCM2.add(E[D]);for(this.tempCM2.divideScalar(pe),D=0;D<pe;D++){var _e;(_e=E[D]).sub(this.tempCM2),ae=Math.max(ae,_e.x,_e.y,_e.z)}this.tempCM2.add(e.position)}var he=null,ce=null,Te=0;return le>4&&((he=new Mesh(new ConvexBufferGeometry(A),e.material)).position.copy(this.tempCM1),he.quaternion.copy(e.quaternion),this.prepareBreakableObject(he,se,e.userData.velocity,e.userData.angularVelocity,2*ve>this.minSizeForBreak),Te++),pe>4&&((ce=new Mesh(new ConvexBufferGeometry(E),e.material)).position.copy(this.tempCM2),ce.quaternion.copy(e.quaternion),this.prepareBreakableObject(ce,se,e.userData.velocity,e.userData.angularVelocity,2*ae>this.minSizeForBreak),Te++),d.object1=he,d.object2=ce,Te}},ConvexObjectBreaker.transformFreeVector=function(s,e){var a=s.x,d=s.y,v=s.z,g=e.elements;return s.x=g[0]*a+g[4]*d+g[8]*v,s.y=g[1]*a+g[5]*d+g[9]*v,s.z=g[2]*a+g[6]*d+g[10]*v,s},ConvexObjectBreaker.transformFreeVectorInverse=function(s,e){var a=s.x,d=s.y,v=s.z,g=e.elements;return s.x=g[0]*a+g[1]*d+g[2]*v,s.y=g[4]*a+g[5]*d+g[6]*v,s.z=g[8]*a+g[9]*d+g[10]*v,s},ConvexObjectBreaker.transformTiedVectorInverse=function(s,e){var a=s.x,d=s.y,v=s.z,g=e.elements;return s.x=g[0]*a+g[1]*d+g[2]*v-g[12],s.y=g[4]*a+g[5]*d+g[6]*v-g[13],s.z=g[8]*a+g[9]*d+g[10]*v-g[14],s},ConvexObjectBreaker.transformPlaneToLocalSpace=function(){var s=new Vector3;return function(a,d,v){v.normal.copy(a.normal),v.constant=a.constant;var g=ConvexObjectBreaker.transformTiedVectorInverse(a.coplanarPoint(s),d);ConvexObjectBreaker.transformFreeVectorInverse(v.normal,d),v.constant=-g.dot(v.normal)}}();var GPUComputationRenderer=function(e,a,d){this.variables=[],this.currentTextureIndex=0;var v=new Scene,g=new Camera;g.position.z=1;var C={passThruTexture:{value:null}},w=b("uniform sampler2D passThruTexture;\n\nvoid main() {\n\n\tvec2 uv = gl_FragCoord.xy / resolution.xy;\n\n\tgl_FragColor = texture2D( passThruTexture, uv );\n\n}\n",C),_=new Mesh(new PlaneBufferGeometry(2,2),w);function x(R){R.defines.resolution="vec2( "+e.toFixed(1)+", "+a.toFixed(1)+" )"}function b(R,O){var D=new ShaderMaterial({uniforms:O=O||{},vertexShader:"void main()\t{\n\n\tgl_Position = vec4( position, 1.0 );\n\n}\n",fragmentShader:R});return x(D),D}v.add(_),this.addVariable=function(R,O,D){var L={name:R,initialValueTexture:D,material:this.createShaderMaterial(O),dependencies:null,renderTargets:[],wrapS:null,wrapT:null,minFilter:NearestFilter,magFilter:NearestFilter};return this.variables.push(L),L},this.setVariableDependencies=function(R,O){R.dependencies=O},this.init=function(){if(!d.capabilities.isWebGL2&&!d.extensions.get("OES_texture_float"))return"No OES_texture_float support for float textures.";if(0===d.capabilities.maxVertexTextures)return"No support for vertex shader textures.";for(var R=0;R<this.variables.length;R++){var O=this.variables[R];O.renderTargets[0]=this.createRenderTarget(e,a,O.wrapS,O.wrapT,O.minFilter,O.magFilter),O.renderTargets[1]=this.createRenderTarget(e,a,O.wrapS,O.wrapT,O.minFilter,O.magFilter),this.renderTexture(O.initialValueTexture,O.renderTargets[0]),this.renderTexture(O.initialValueTexture,O.renderTargets[1]);var D=O.material,F=D.uniforms;if(null!==O.dependencies)for(var L=0;L<O.dependencies.length;L++){var I=O.dependencies[L];if(I.name!==O.name){for(var V=!1,z=0;z<this.variables.length;z++)if(I.name===this.variables[z].name){V=!0;break}if(!V)return"Variable dependency not found. Variable="+O.name+", dependency="+I.name}F[I.name]={value:null},D.fragmentShader="\nuniform sampler2D "+I.name+";\n"+D.fragmentShader}}return this.currentTextureIndex=0,null},this.compute=function(){for(var R=this.currentTextureIndex,O=0===this.currentTextureIndex?1:0,D=0,F=this.variables.length;D<F;D++){var L=this.variables[D];if(null!==L.dependencies)for(var I=L.material.uniforms,V=0,z=L.dependencies.length;V<z;V++){var H=L.dependencies[V];I[H.name].value=H.renderTargets[R].texture}this.doRenderTarget(L.material,L.renderTargets[O])}this.currentTextureIndex=O},this.getCurrentRenderTarget=function(R){return R.renderTargets[this.currentTextureIndex]},this.getAlternateRenderTarget=function(R){return R.renderTargets[0===this.currentTextureIndex?1:0]},this.addResolutionDefine=x,this.createShaderMaterial=b,this.createRenderTarget=function(R,O,D,F,L,I){return new WebGLRenderTarget(R=R||e,O=O||a,{wrapS:D=D||ClampToEdgeWrapping,wrapT:F=F||ClampToEdgeWrapping,minFilter:L=L||NearestFilter,magFilter:I=I||NearestFilter,format:RGBAFormat,type:/(iPad|iPhone|iPod)/g.test(navigator.userAgent)?HalfFloatType:FloatType,stencilBuffer:!1,depthBuffer:!1})},this.createTexture=function(){return new DataTexture(new Float32Array(e*a*4),e,a,RGBAFormat,FloatType)},this.renderTexture=function(R,O){C.passThruTexture.value=R,this.doRenderTarget(w,O),C.passThruTexture.value=null},this.doRenderTarget=function(R,O){var D=d.getRenderTarget();_.material=R,d.setRenderTarget(O),d.render(v,g),_.material=w,d.setRenderTarget(D)}},Gyroscope=function(){Object3D.call(this)};Gyroscope.prototype=Object.create(Object3D.prototype),Gyroscope.prototype.constructor=Gyroscope,Gyroscope.prototype.updateMatrixWorld=function(){var s=new Vector3,e=new Quaternion,a=new Vector3,d=new Vector3,v=new Quaternion,g=new Vector3;return function(w){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||w)&&(null!==this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(d,v,g),this.matrix.decompose(s,e,a),this.matrixWorld.compose(d,e,g)):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,w=!0);for(var _=0,x=this.children.length;_<x;_++)this.children[_].updateMatrixWorld(w)}}();var MD2Character=function(){var e=this;function a(g,C){for(var w=new TextureLoader,_=[],x=0;x<C.length;x++)_[x]=w.load(g+C[x],v),_[x].mapping=UVMapping,_[x].name=C[x],_[x].encoding=sRGBEncoding;return _}function d(g,C){var w=new MeshLambertMaterial({color:16755200,wireframe:!0,morphTargets:!0,morphNormals:!0}),_=new MeshLambertMaterial({color:16777215,wireframe:!1,map:C,morphTargets:!0,morphNormals:!0}),x=new Mesh(g,_);return x.rotation.y=-Math.PI/2,x.castShadow=!0,x.receiveShadow=!0,x.materialTexture=_,x.materialWireframe=w,x}function v(){e.loadCounter-=1,0===e.loadCounter&&e.onLoadComplete()}this.scale=1,this.animationFPS=6,this.root=new Object3D,this.meshBody=null,this.meshWeapon=null,this.skinsBody=[],this.skinsWeapon=[],this.weapons=[],this.activeAnimation=null,this.mixer=null,this.onLoadComplete=function(){},this.loadCounter=0,this.loadParts=function(g){this.loadCounter=2*g.weapons.length+g.skins.length+1;for(var C=[],w=0;w<g.weapons.length;w++)C[w]=g.weapons[w][1];this.skinsBody=a(g.baseUrl+"skins/",g.skins),this.skinsWeapon=a(g.baseUrl+"skins/",C);var _=new MD2Loader;_.load(g.baseUrl+g.body,function(b){var A=new Box3;A.setFromBufferAttribute(b.attributes.position),e.root.position.y=-e.scale*A.min.y;var E=d(b,e.skinsBody[0]);E.scale.set(e.scale,e.scale,e.scale),e.root.add(E),e.meshBody=E,e.meshBody.clipOffset=0,e.activeAnimationClipName=E.geometry.animations[0].name,e.mixer=new AnimationMixer(E),v()});var x=function(A,E){return function(R){var O=d(R,e.skinsWeapon[A]);O.scale.set(e.scale,e.scale,e.scale),O.visible=!1,O.name=E,e.root.add(O),e.weapons[A]=O,e.meshWeapon=O,v()}};for(w=0;w<g.weapons.length;w++)_.load(g.baseUrl+g.weapons[w][0],x(w,g.weapons[w][0]))},this.setPlaybackRate=function(g){this.mixer.timeScale=0!==g?1/g:0},this.setWireframe=function(g){g?(this.meshBody&&(this.meshBody.material=this.meshBody.materialWireframe),this.meshWeapon&&(this.meshWeapon.material=this.meshWeapon.materialWireframe)):(this.meshBody&&(this.meshBody.material=this.meshBody.materialTexture),this.meshWeapon&&(this.meshWeapon.material=this.meshWeapon.materialTexture))},this.setSkin=function(g){this.meshBody&&!1===this.meshBody.material.wireframe&&(this.meshBody.material.map=this.skinsBody[g])},this.setWeapon=function(g){for(var C=0;C<this.weapons.length;C++)this.weapons[C].visible=!1;var w=this.weapons[g];w&&(w.visible=!0,this.meshWeapon=w,e.syncWeaponAnimation())},this.setAnimation=function(g){if(this.meshBody){this.meshBody.activeAction&&(this.meshBody.activeAction.stop(),this.meshBody.activeAction=null);var C=this.mixer.clipAction(g,this.meshBody);C&&(this.meshBody.activeAction=C.play())}e.activeClipName=g,e.syncWeaponAnimation()},this.syncWeaponAnimation=function(){var g=e.activeClipName;if(e.meshWeapon){this.meshWeapon.activeAction&&(this.meshWeapon.activeAction.stop(),this.meshWeapon.activeAction=null);var C=this.mixer.clipAction(g,this.meshWeapon);C&&(this.meshWeapon.activeAction=C.syncWith(this.meshBody.activeAction).play())}},this.update=function(g){this.mixer&&this.mixer.update(g)}},MorphBlendMesh=function(e,a){Mesh.call(this,e,a),this.animationsMap={},this.animationsList=[];var d=Object.keys(this.morphTargetDictionary).length,v="__default";this.createAnimation(v,0,d-1,d/1),this.setAnimationWeight(v,1)};MorphBlendMesh.prototype=Object.assign(Object.create(Mesh.prototype),{constructor:MorphBlendMesh,createAnimation:function(e,a,d,v){var g={start:a,end:d,length:d-a+1,fps:v,duration:(d-a)/v,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[e]=g,this.animationsList.push(g)},autoCreateAnimations:function(e){var d,a=/([a-z]+)_?(\d+)/i,v={},g=0;for(var C in this.morphTargetDictionary){var w=C.match(a);w&&w.length>1&&(v[_=w[1]]||(v[_]={start:1/0,end:-1/0}),g<(x=v[_]).start&&(x.start=g),g>x.end&&(x.end=g),d||(d=_)),g++}for(var _ in v){var x;this.createAnimation(_,(x=v[_]).start,x.end,e)}this.firstAnimation=d},setAnimationDirectionForward:function(e){var a=this.animationsMap[e];a&&(a.direction=1,a.directionBackwards=!1)},setAnimationDirectionBackward:function(e){var a=this.animationsMap[e];a&&(a.direction=-1,a.directionBackwards=!0)},setAnimationFPS:function(e,a){var d=this.animationsMap[e];d&&(d.fps=a,d.duration=(d.end-d.start)/d.fps)},setAnimationDuration:function(e,a){var d=this.animationsMap[e];d&&(d.duration=a,d.fps=(d.end-d.start)/d.duration)},setAnimationWeight:function(e,a){var d=this.animationsMap[e];d&&(d.weight=a)},setAnimationTime:function(e,a){var d=this.animationsMap[e];d&&(d.time=a)},getAnimationTime:function(e){var a=0,d=this.animationsMap[e];return d&&(a=d.time),a},getAnimationDuration:function(e){var a=-1,d=this.animationsMap[e];return d&&(a=d.duration),a},playAnimation:function(e){var a=this.animationsMap[e];a?(a.time=0,a.active=!0):console.warn("MorphBlendMesh: animation["+e+"] undefined in .playAnimation()")},stopAnimation:function(e){var a=this.animationsMap[e];a&&(a.active=!1)},update:function(e){for(var a=0,d=this.animationsList.length;a<d;a++){var v=this.animationsList[a];if(v.active){var g=v.duration/v.length;v.time+=v.direction*e,v.mirroredLoop?(v.time>v.duration||v.time<0)&&(v.direction*=-1,v.time>v.duration&&(v.time=v.duration,v.directionBackwards=!0),v.time<0&&(v.time=0,v.directionBackwards=!1)):(v.time=v.time%v.duration,v.time<0&&(v.time+=v.duration));var C=v.start+MathUtils.clamp(Math.floor(v.time/g),0,v.length-1),w=v.weight;C!==v.currentFrame&&(this.morphTargetInfluences[v.lastFrame]=0,this.morphTargetInfluences[v.currentFrame]=1*w,this.morphTargetInfluences[C]=0,v.lastFrame=v.currentFrame,v.currentFrame=C);var _=v.time%g/g;v.directionBackwards&&(_=1-_),v.currentFrame!==v.lastFrame?(this.morphTargetInfluences[v.currentFrame]=_*w,this.morphTargetInfluences[v.lastFrame]=(1-_)*w):this.morphTargetInfluences[v.currentFrame]=w}}}});var MD2CharacterComplex=function(){var e=this;function a(C,w){for(var _=new TextureLoader,x=[],b=0;b<w.length;b++)x[b]=_.load(C+w[b],v),x[b].mapping=UVMapping,x[b].name=w[b],x[b].encoding=sRGBEncoding;return x}function d(C,w){var _=new MeshLambertMaterial({color:16755200,wireframe:!0,morphTargets:!0,morphNormals:!0}),x=new MeshLambertMaterial({color:16777215,wireframe:!1,map:w,morphTargets:!0,morphNormals:!0}),b=new MorphBlendMesh(C,x);return b.rotation.y=-Math.PI/2,b.materialTexture=x,b.materialWireframe=_,b.autoCreateAnimations(e.animationFPS),b}function v(){e.loadCounter-=1,0===e.loadCounter&&e.onLoadComplete()}function g(C){return 1===C?1:1-Math.pow(2,-10*C)}this.scale=1,this.animationFPS=6,this.transitionFrames=15,this.maxSpeed=275,this.maxReverseSpeed=-275,this.frontAcceleration=600,this.backAcceleration=600,this.frontDecceleration=600,this.angularSpeed=2.5,this.root=new Object3D,this.meshBody=null,this.meshWeapon=null,this.controls=null,this.skinsBody=[],this.skinsWeapon=[],this.weapons=[],this.currentSkin=void 0,this.onLoadComplete=function(){},this.meshes=[],this.animations={},this.loadCounter=0,this.speed=0,this.bodyOrientation=0,this.walkSpeed=this.maxSpeed,this.crouchSpeed=.5*this.maxSpeed,this.activeAnimation=null,this.oldAnimation=null,this.enableShadows=function(C){for(var w=0;w<this.meshes.length;w++)this.meshes[w].castShadow=C,this.meshes[w].receiveShadow=C},this.setVisible=function(C){for(var w=0;w<this.meshes.length;w++)this.meshes[w].visible=C,this.meshes[w].visible=C},this.shareParts=function(C){this.animations=C.animations,this.walkSpeed=C.walkSpeed,this.crouchSpeed=C.crouchSpeed,this.skinsBody=C.skinsBody,this.skinsWeapon=C.skinsWeapon;var w=d(C.meshBody.geometry,this.skinsBody[0]);w.scale.set(this.scale,this.scale,this.scale),this.root.position.y=C.root.position.y,this.root.add(w),this.meshBody=w,this.meshes.push(w);for(var _=0;_<C.weapons.length;_++){var x=d(C.weapons[_].geometry,this.skinsWeapon[_]);x.scale.set(this.scale,this.scale,this.scale),x.visible=!1,x.name=C.weapons[_].name,this.root.add(x),this.weapons[_]=x,this.meshWeapon=x,this.meshes.push(x)}},this.loadParts=function(C){this.animations=C.animations,this.walkSpeed=C.walkSpeed,this.crouchSpeed=C.crouchSpeed,this.loadCounter=2*C.weapons.length+C.skins.length+1;for(var w=[],_=0;_<C.weapons.length;_++)w[_]=C.weapons[_][1];this.skinsBody=a(C.baseUrl+"skins/",C.skins),this.skinsWeapon=a(C.baseUrl+"skins/",w);var x=new MD2Loader;x.load(C.baseUrl+C.body,function(A){var E=new Box3;E.setFromBufferAttribute(A.attributes.position),e.root.position.y=-e.scale*E.min.y;var R=d(A,e.skinsBody[0]);R.scale.set(e.scale,e.scale,e.scale),e.root.add(R),e.meshBody=R,e.meshes.push(R),v()});var b=function(E,R){return function(O){var D=d(O,e.skinsWeapon[E]);D.scale.set(e.scale,e.scale,e.scale),D.visible=!1,D.name=R,e.root.add(D),e.weapons[E]=D,e.meshWeapon=D,e.meshes.push(D),v()}};for(_=0;_<C.weapons.length;_++)x.load(C.baseUrl+C.weapons[_][0],b(_,C.weapons[_][0]))},this.setPlaybackRate=function(C){this.meshBody&&(this.meshBody.duration=this.meshBody.baseDuration/C),this.meshWeapon&&(this.meshWeapon.duration=this.meshWeapon.baseDuration/C)},this.setWireframe=function(C){C?(this.meshBody&&(this.meshBody.material=this.meshBody.materialWireframe),this.meshWeapon&&(this.meshWeapon.material=this.meshWeapon.materialWireframe)):(this.meshBody&&(this.meshBody.material=this.meshBody.materialTexture),this.meshWeapon&&(this.meshWeapon.material=this.meshWeapon.materialTexture))},this.setSkin=function(C){this.meshBody&&!1===this.meshBody.material.wireframe&&(this.meshBody.material.map=this.skinsBody[C],this.currentSkin=C)},this.setWeapon=function(C){for(var w=0;w<this.weapons.length;w++)this.weapons[w].visible=!1;var _=this.weapons[C];_&&(_.visible=!0,this.meshWeapon=_,this.activeAnimation&&(_.playAnimation(this.activeAnimation),this.meshWeapon.setAnimationTime(this.activeAnimation,this.meshBody.getAnimationTime(this.activeAnimation))))},this.setAnimation=function(C){C===this.activeAnimation||!C||(this.meshBody&&(this.meshBody.setAnimationWeight(C,0),this.meshBody.playAnimation(C),this.oldAnimation=this.activeAnimation,this.activeAnimation=C,this.blendCounter=this.transitionFrames),this.meshWeapon&&(this.meshWeapon.setAnimationWeight(C,0),this.meshWeapon.playAnimation(C)))},this.update=function(C){this.controls&&this.updateMovementModel(C),this.animations&&(this.updateBehaviors(),this.updateAnimations(C))},this.updateAnimations=function(C){var w=1;this.blendCounter>0&&(w=(this.transitionFrames-this.blendCounter)/this.transitionFrames,this.blendCounter-=1),this.meshBody&&(this.meshBody.update(C),this.meshBody.setAnimationWeight(this.activeAnimation,w),this.meshBody.setAnimationWeight(this.oldAnimation,1-w)),this.meshWeapon&&(this.meshWeapon.update(C),this.meshWeapon.setAnimationWeight(this.activeAnimation,w),this.meshWeapon.setAnimationWeight(this.oldAnimation,1-w))},this.updateBehaviors=function(){var _,x,C=this.controls,w=this.animations;C.crouch?(_=w.crouchMove,x=w.crouchIdle):(_=w.move,x=w.idle),C.jump&&(_=w.jump,x=w.jump),C.attack&&(C.crouch?(_=w.crouchAttack,x=w.crouchAttack):(_=w.attack,x=w.attack)),(C.moveForward||C.moveBackward||C.moveLeft||C.moveRight)&&this.activeAnimation!==_&&this.setAnimation(_),Math.abs(this.speed)<.2*this.maxSpeed&&!(C.moveLeft||C.moveRight||C.moveForward||C.moveBackward)&&this.activeAnimation!==x&&this.setAnimation(x),C.moveForward&&(this.meshBody&&(this.meshBody.setAnimationDirectionForward(this.activeAnimation),this.meshBody.setAnimationDirectionForward(this.oldAnimation)),this.meshWeapon&&(this.meshWeapon.setAnimationDirectionForward(this.activeAnimation),this.meshWeapon.setAnimationDirectionForward(this.oldAnimation))),C.moveBackward&&(this.meshBody&&(this.meshBody.setAnimationDirectionBackward(this.activeAnimation),this.meshBody.setAnimationDirectionBackward(this.oldAnimation)),this.meshWeapon&&(this.meshWeapon.setAnimationDirectionBackward(this.activeAnimation),this.meshWeapon.setAnimationDirectionBackward(this.oldAnimation)))},this.updateMovementModel=function(C){var w=this.controls;if(this.maxSpeed=w.crouch?this.crouchSpeed:this.walkSpeed,this.maxReverseSpeed=-this.maxSpeed,w.moveForward&&(this.speed=MathUtils.clamp(this.speed+C*this.frontAcceleration,this.maxReverseSpeed,this.maxSpeed)),w.moveBackward&&(this.speed=MathUtils.clamp(this.speed-C*this.backAcceleration,this.maxReverseSpeed,this.maxSpeed)),w.moveLeft&&(this.bodyOrientation+=C*this.angularSpeed,this.speed=MathUtils.clamp(this.speed+1*C*this.frontAcceleration,this.maxReverseSpeed,this.maxSpeed)),w.moveRight&&(this.bodyOrientation-=C*this.angularSpeed,this.speed=MathUtils.clamp(this.speed+1*C*this.frontAcceleration,this.maxReverseSpeed,this.maxSpeed)),!w.moveForward&&!w.moveBackward)if(this.speed>0){var x=g(this.speed/this.maxSpeed);this.speed=MathUtils.clamp(this.speed-x*C*this.frontDecceleration,0,this.maxSpeed)}else x=g(this.speed/this.maxReverseSpeed),this.speed=MathUtils.clamp(this.speed+x*C*this.backAcceleration,this.maxReverseSpeed,0);var b=this.speed*C;this.root.position.x+=Math.sin(this.bodyOrientation)*b,this.root.position.z+=Math.cos(this.bodyOrientation)*b,this.root.rotation.y=this.bodyOrientation}},MorphAnimMesh=function(e,a){Mesh.call(this,e,a),this.type="MorphAnimMesh",this.mixer=new AnimationMixer(this),this.activeAction=null};MorphAnimMesh.prototype=Object.create(Mesh.prototype),MorphAnimMesh.prototype.constructor=MorphAnimMesh,MorphAnimMesh.prototype.setDirectionForward=function(){this.mixer.timeScale=1},MorphAnimMesh.prototype.setDirectionBackward=function(){this.mixer.timeScale=-1},MorphAnimMesh.prototype.playAnimation=function(s,e){this.activeAction&&(this.activeAction.stop(),this.activeAction=null);var a=AnimationClip.findByName(this,s);if(!a)throw new Error("MorphAnimMesh: animations["+s+"] undefined in .playAnimation()");var d=this.mixer.clipAction(a);d.timeScale=a.tracks.length*e/a.duration,this.activeAction=d.play()},MorphAnimMesh.prototype.updateAnimation=function(s){this.mixer.update(s)},MorphAnimMesh.prototype.copy=function(s){return Mesh.prototype.copy.call(this,s),this.mixer=new AnimationMixer(this),this};var OceanShaders={};OceanShaders.ocean_sim_vertex={vertexShader:["varying vec2 vUV;","void main (void) {","\tvUV = position.xy * 0.5 + 0.5;","\tgl_Position = vec4(position, 1.0 );","}"].join("\n")},OceanShaders.ocean_subtransform={uniforms:{u_input:{value:null},u_transformSize:{value:512},u_subtransformSize:{value:250}},fragmentShader:["precision highp float;","#include <common>","uniform sampler2D u_input;","uniform float u_transformSize;","uniform float u_subtransformSize;","varying vec2 vUV;","vec2 multiplyComplex (vec2 a, vec2 b) {","\treturn vec2(a[0] * b[0] - a[1] * b[1], a[1] * b[0] + a[0] * b[1]);","}","void main (void) {","\t#ifdef HORIZONTAL","\tfloat index = vUV.x * u_transformSize - 0.5;","\t#else","\tfloat index = vUV.y * u_transformSize - 0.5;","\t#endif","\tfloat evenIndex = floor(index / u_subtransformSize) * (u_subtransformSize * 0.5) + mod(index, u_subtransformSize * 0.5);","\t#ifdef HORIZONTAL","\tvec4 even = texture2D(u_input, vec2(evenIndex + 0.5, gl_FragCoord.y) / u_transformSize).rgba;","\tvec4 odd = texture2D(u_input, vec2(evenIndex + u_transformSize * 0.5 + 0.5, gl_FragCoord.y) / u_transformSize).rgba;","\t#else","\tvec4 even = texture2D(u_input, vec2(gl_FragCoord.x, evenIndex + 0.5) / u_transformSize).rgba;","\tvec4 odd = texture2D(u_input, vec2(gl_FragCoord.x, evenIndex + u_transformSize * 0.5 + 0.5) / u_transformSize).rgba;","\t#endif","\tfloat twiddleArgument = -2.0 * PI * (index / u_subtransformSize);","\tvec2 twiddle = vec2(cos(twiddleArgument), sin(twiddleArgument));","\tvec2 outputA = even.xy + multiplyComplex(twiddle, odd.xy);","\tvec2 outputB = even.zw + multiplyComplex(twiddle, odd.zw);","\tgl_FragColor = vec4(outputA, outputB);","}"].join("\n")},OceanShaders.ocean_initial_spectrum={uniforms:{u_wind:{value:new Vector2(10,10)},u_resolution:{value:512},u_size:{value:250}},vertexShader:["void main (void) {","\tgl_Position = vec4(position, 1.0);","}"].join("\n"),fragmentShader:["precision highp float;","#include <common>","const float G = 9.81;","const float KM = 370.0;","const float CM = 0.23;","uniform vec2 u_wind;","uniform float u_resolution;","uniform float u_size;","float omega (float k) {","\treturn sqrt(G * k * (1.0 + pow2(k / KM)));","}","#if __VERSION__ == 100","float tanh (float x) {","\treturn (1.0 - exp(-2.0 * x)) / (1.0 + exp(-2.0 * x));","}","#endif","void main (void) {","\tvec2 coordinates = gl_FragCoord.xy - 0.5;","\tfloat n = (coordinates.x < u_resolution * 0.5) ? coordinates.x : coordinates.x - u_resolution;","\tfloat m = (coordinates.y < u_resolution * 0.5) ? coordinates.y : coordinates.y - u_resolution;","\tvec2 K = (2.0 * PI * vec2(n, m)) / u_size;","\tfloat k = length(K);","\tfloat l_wind = length(u_wind);","\tfloat Omega = 0.84;","\tfloat kp = G * pow2(Omega / l_wind);","\tfloat c = omega(k) / k;","\tfloat cp = omega(kp) / kp;","\tfloat Lpm = exp(-1.25 * pow2(kp / k));","\tfloat gamma = 1.7;","\tfloat sigma = 0.08 * (1.0 + 4.0 * pow(Omega, -3.0));","\tfloat Gamma = exp(-pow2(sqrt(k / kp) - 1.0) / 2.0 * pow2(sigma));","\tfloat Jp = pow(gamma, Gamma);","\tfloat Fp = Lpm * Jp * exp(-Omega / sqrt(10.0) * (sqrt(k / kp) - 1.0));","\tfloat alphap = 0.006 * sqrt(Omega);","\tfloat Bl = 0.5 * alphap * cp / c * Fp;","\tfloat z0 = 0.000037 * pow2(l_wind) / G * pow(l_wind / cp, 0.9);","\tfloat uStar = 0.41 * l_wind / log(10.0 / z0);","\tfloat alpham = 0.01 * ((uStar < CM) ? (1.0 + log(uStar / CM)) : (1.0 + 3.0 * log(uStar / CM)));","\tfloat Fm = exp(-0.25 * pow2(k / KM - 1.0));","\tfloat Bh = 0.5 * alpham * CM / c * Fm * Lpm;","\tfloat a0 = log(2.0) / 4.0;","\tfloat am = 0.13 * uStar / CM;","\tfloat Delta = tanh(a0 + 4.0 * pow(c / cp, 2.5) + am * pow(CM / c, 2.5));","\tfloat cosPhi = dot(normalize(u_wind), normalize(K));","\tfloat S = (1.0 / (2.0 * PI)) * pow(k, -4.0) * (Bl + Bh) * (1.0 + Delta * (2.0 * cosPhi * cosPhi - 1.0));","\tfloat dk = 2.0 * PI / u_size;","\tfloat h = sqrt(S / 2.0) * dk;","\tif (K.x == 0.0 && K.y == 0.0) {","\t\th = 0.0;","\t}","\tgl_FragColor = vec4(h, 0.0, 0.0, 0.0);","}"].join("\n")},OceanShaders.ocean_phase={uniforms:{u_phases:{value:null},u_deltaTime:{value:null},u_resolution:{value:null},u_size:{value:null}},fragmentShader:["precision highp float;","#include <common>","const float G = 9.81;","const float KM = 370.0;","varying vec2 vUV;","uniform sampler2D u_phases;","uniform float u_deltaTime;","uniform float u_resolution;","uniform float u_size;","float omega (float k) {","\treturn sqrt(G * k * (1.0 + k * k / KM * KM));","}","void main (void) {","\tfloat deltaTime = 1.0 / 60.0;","\tvec2 coordinates = gl_FragCoord.xy - 0.5;","\tfloat n = (coordinates.x < u_resolution * 0.5) ? coordinates.x : coordinates.x - u_resolution;","\tfloat m = (coordinates.y < u_resolution * 0.5) ? coordinates.y : coordinates.y - u_resolution;","\tvec2 waveVector = (2.0 * PI * vec2(n, m)) / u_size;","\tfloat phase = texture2D(u_phases, vUV).r;","\tfloat deltaPhase = omega(length(waveVector)) * u_deltaTime;","\tphase = mod(phase + deltaPhase, 2.0 * PI);","\tgl_FragColor = vec4(phase, 0.0, 0.0, 0.0);","}"].join("\n")},OceanShaders.ocean_spectrum={uniforms:{u_size:{value:null},u_resolution:{value:null},u_choppiness:{value:null},u_phases:{value:null},u_initialSpectrum:{value:null}},fragmentShader:["precision highp float;","#include <common>","const float G = 9.81;","const float KM = 370.0;","varying vec2 vUV;","uniform float u_size;","uniform float u_resolution;","uniform float u_choppiness;","uniform sampler2D u_phases;","uniform sampler2D u_initialSpectrum;","vec2 multiplyComplex (vec2 a, vec2 b) {","\treturn vec2(a[0] * b[0] - a[1] * b[1], a[1] * b[0] + a[0] * b[1]);","}","vec2 multiplyByI (vec2 z) {","\treturn vec2(-z[1], z[0]);","}","float omega (float k) {","\treturn sqrt(G * k * (1.0 + k * k / KM * KM));","}","void main (void) {","\tvec2 coordinates = gl_FragCoord.xy - 0.5;","\tfloat n = (coordinates.x < u_resolution * 0.5) ? coordinates.x : coordinates.x - u_resolution;","\tfloat m = (coordinates.y < u_resolution * 0.5) ? coordinates.y : coordinates.y - u_resolution;","\tvec2 waveVector = (2.0 * PI * vec2(n, m)) / u_size;","\tfloat phase = texture2D(u_phases, vUV).r;","\tvec2 phaseVector = vec2(cos(phase), sin(phase));","\tvec2 h0 = texture2D(u_initialSpectrum, vUV).rg;","\tvec2 h0Star = texture2D(u_initialSpectrum, vec2(1.0 - vUV + 1.0 / u_resolution)).rg;","\th0Star.y *= -1.0;","\tvec2 h = multiplyComplex(h0, phaseVector) + multiplyComplex(h0Star, vec2(phaseVector.x, -phaseVector.y));","\tvec2 hX = -multiplyByI(h * (waveVector.x / length(waveVector))) * u_choppiness;","\tvec2 hZ = -multiplyByI(h * (waveVector.y / length(waveVector))) * u_choppiness;","\tif (waveVector.x == 0.0 && waveVector.y == 0.0) {","\t\th = vec2(0.0);","\t\thX = vec2(0.0);","\t\thZ = vec2(0.0);","\t}","\tgl_FragColor = vec4(hX + multiplyByI(h), hZ);","}"].join("\n")},OceanShaders.ocean_normals={uniforms:{u_displacementMap:{value:null},u_resolution:{value:null},u_size:{value:null}},fragmentShader:["precision highp float;","varying vec2 vUV;","uniform sampler2D u_displacementMap;","uniform float u_resolution;","uniform float u_size;","void main (void) {","\tfloat texel = 1.0 / u_resolution;","\tfloat texelSize = u_size / u_resolution;","\tvec3 center = texture2D(u_displacementMap, vUV).rgb;","\tvec3 right = vec3(texelSize, 0.0, 0.0) + texture2D(u_displacementMap, vUV + vec2(texel, 0.0)).rgb - center;","\tvec3 left = vec3(-texelSize, 0.0, 0.0) + texture2D(u_displacementMap, vUV + vec2(-texel, 0.0)).rgb - center;","\tvec3 top = vec3(0.0, 0.0, -texelSize) + texture2D(u_displacementMap, vUV + vec2(0.0, -texel)).rgb - center;","\tvec3 bottom = vec3(0.0, 0.0, texelSize) + texture2D(u_displacementMap, vUV + vec2(0.0, texel)).rgb - center;","\tvec3 topRight = cross(right, top);","\tvec3 topLeft = cross(top, left);","\tvec3 bottomLeft = cross(left, bottom);","\tvec3 bottomRight = cross(bottom, right);","\tgl_FragColor = vec4(normalize(topRight + topLeft + bottomLeft + bottomRight), 1.0);","}"].join("\n")},OceanShaders.ocean_main={uniforms:{u_displacementMap:{value:null},u_normalMap:{value:null},u_geometrySize:{value:null},u_size:{value:null},u_projectionMatrix:{value:null},u_viewMatrix:{value:null},u_cameraPosition:{value:null},u_skyColor:{value:null},u_oceanColor:{value:null},u_sunDirection:{value:null},u_exposure:{value:null}},vertexShader:["precision highp float;","varying vec3 vPos;","varying vec2 vUV;","uniform mat4 u_projectionMatrix;","uniform mat4 u_viewMatrix;","uniform float u_size;","uniform float u_geometrySize;","uniform sampler2D u_displacementMap;","void main (void) {","\tvec3 newPos = position + texture2D(u_displacementMap, uv).rgb * (u_geometrySize / u_size);","\tvPos = newPos;","\tvUV = uv;","\tgl_Position = u_projectionMatrix * u_viewMatrix * vec4(newPos, 1.0);","}"].join("\n"),fragmentShader:["precision highp float;","varying vec3 vPos;","varying vec2 vUV;","uniform sampler2D u_displacementMap;","uniform sampler2D u_normalMap;","uniform vec3 u_cameraPosition;","uniform vec3 u_oceanColor;","uniform vec3 u_skyColor;","uniform vec3 u_sunDirection;","uniform float u_exposure;","vec3 hdr (vec3 color, float exposure) {","\treturn 1.0 - exp(-color * exposure);","}","void main (void) {","\tvec3 normal = texture2D(u_normalMap, vUV).rgb;","\tvec3 view = normalize(u_cameraPosition - vPos);","\tfloat fresnel = 0.02 + 0.98 * pow(1.0 - dot(normal, view), 5.0);","\tvec3 sky = fresnel * u_skyColor;","\tfloat diffuse = clamp(dot(normal, normalize(u_sunDirection)), 0.0, 1.0);","\tvec3 water = (1.0 - fresnel) * u_oceanColor * u_skyColor * diffuse;","\tvec3 color = sky + water;","\tgl_FragColor = vec4(hdr(color, u_exposure), 1.0);","}"].join("\n")};var Ocean=function(e,a,d,v){function g(te,J){return void 0!==te?te:J}this.changed=!0,this.initial=!0,this.oceanCamera=new OrthographicCamera,this.oceanCamera.position.z=1,this.renderer=e,this.renderer.clearColor(16777215),this.scene=new Scene,this.clearColor=g((v=v||{}).CLEAR_COLOR,[1,1,1,0]),this.geometryOrigin=g(v.GEOMETRY_ORIGIN,[-1e3,-1e3]),this.sunDirectionX=g(v.SUN_DIRECTION[0],-1),this.sunDirectionY=g(v.SUN_DIRECTION[1],1),this.sunDirectionZ=g(v.SUN_DIRECTION[2],1),this.oceanColor=g(v.OCEAN_COLOR,new Vector3(.004,.016,.047)),this.skyColor=g(v.SKY_COLOR,new Vector3(3.2,9.6,12.8)),this.exposure=g(v.EXPOSURE,.35),this.geometryResolution=g(v.GEOMETRY_RESOLUTION,32),this.geometrySize=g(v.GEOMETRY_SIZE,2e3),this.resolution=g(v.RESOLUTION,64),this.floatSize=g(v.SIZE_OF_FLOAT,4),this.windX=g(v.INITIAL_WIND[0],10),this.windY=g(v.INITIAL_WIND[1],10),this.size=g(v.INITIAL_SIZE,250),this.choppiness=g(v.INITIAL_CHOPPINESS,1.5),this.matrixNeedsUpdate=!1;var C=g(v.USE_HALF_FLOAT,!1)?HalfFloatType:FloatType,w={minFilter:LinearFilter,magFilter:LinearFilter,wrapS:ClampToEdgeWrapping,wrapT:ClampToEdgeWrapping,format:RGBAFormat,stencilBuffer:!1,depthBuffer:!1,premultiplyAlpha:!1,type:C},_={minFilter:NearestFilter,magFilter:NearestFilter,wrapS:ClampToEdgeWrapping,wrapT:ClampToEdgeWrapping,format:RGBAFormat,stencilBuffer:!1,depthBuffer:!1,premultiplyAlpha:!1,type:C};this.initialSpectrumFramebuffer=new WebGLRenderTarget(this.resolution,this.resolution,{minFilter:NearestFilter,magFilter:NearestFilter,wrapS:RepeatWrapping,wrapT:RepeatWrapping,format:RGBAFormat,stencilBuffer:!1,depthBuffer:!1,premultiplyAlpha:!1,type:C}),this.spectrumFramebuffer=new WebGLRenderTarget(this.resolution,this.resolution,_),this.pingPhaseFramebuffer=new WebGLRenderTarget(this.resolution,this.resolution,_),this.pongPhaseFramebuffer=new WebGLRenderTarget(this.resolution,this.resolution,_),this.pingTransformFramebuffer=new WebGLRenderTarget(this.resolution,this.resolution,_),this.pongTransformFramebuffer=new WebGLRenderTarget(this.resolution,this.resolution,_),this.displacementMapFramebuffer=new WebGLRenderTarget(this.resolution,this.resolution,w),this.normalMapFramebuffer=new WebGLRenderTarget(this.resolution,this.resolution,w);var b=OceanShaders.ocean_sim_vertex,A=OceanShaders.ocean_subtransform,E=UniformsUtils.clone(A.uniforms);this.materialOceanHorizontal=new ShaderMaterial({uniforms:E,vertexShader:b.vertexShader,fragmentShader:"#define HORIZONTAL \n"+A.fragmentShader}),this.materialOceanHorizontal.uniforms.u_transformSize={value:this.resolution},this.materialOceanHorizontal.uniforms.u_subtransformSize={value:null},this.materialOceanHorizontal.uniforms.u_input={value:null},this.materialOceanHorizontal.depthTest=!1;var R=OceanShaders.ocean_subtransform,O=UniformsUtils.clone(R.uniforms);this.materialOceanVertical=new ShaderMaterial({uniforms:O,vertexShader:b.vertexShader,fragmentShader:R.fragmentShader}),this.materialOceanVertical.uniforms.u_transformSize={value:this.resolution},this.materialOceanVertical.uniforms.u_subtransformSize={value:null},this.materialOceanVertical.uniforms.u_input={value:null},this.materialOceanVertical.depthTest=!1;var D=OceanShaders.ocean_initial_spectrum,F=UniformsUtils.clone(D.uniforms);this.materialInitialSpectrum=new ShaderMaterial({uniforms:F,vertexShader:D.vertexShader,fragmentShader:D.fragmentShader}),this.materialInitialSpectrum.uniforms.u_wind={value:new Vector2},this.materialInitialSpectrum.uniforms.u_resolution={value:this.resolution},this.materialInitialSpectrum.depthTest=!1;var L=OceanShaders.ocean_phase,I=UniformsUtils.clone(L.uniforms);this.materialPhase=new ShaderMaterial({uniforms:I,vertexShader:b.vertexShader,fragmentShader:L.fragmentShader}),this.materialPhase.uniforms.u_resolution={value:this.resolution},this.materialPhase.depthTest=!1;var V=OceanShaders.ocean_spectrum,z=UniformsUtils.clone(V.uniforms);this.materialSpectrum=new ShaderMaterial({uniforms:z,vertexShader:b.vertexShader,fragmentShader:V.fragmentShader}),this.materialSpectrum.uniforms.u_initialSpectrum={value:null},this.materialSpectrum.uniforms.u_resolution={value:this.resolution},this.materialSpectrum.depthTest=!1;var H=OceanShaders.ocean_normals,X=UniformsUtils.clone(H.uniforms);this.materialNormal=new ShaderMaterial({uniforms:X,vertexShader:b.vertexShader,fragmentShader:H.fragmentShader}),this.materialNormal.uniforms.u_displacementMap={value:null},this.materialNormal.uniforms.u_resolution={value:this.resolution},this.materialNormal.depthTest=!1;var re=OceanShaders.ocean_main,j=UniformsUtils.clone(re.uniforms);this.materialOcean=new ShaderMaterial({uniforms:j,vertexShader:re.vertexShader,fragmentShader:re.fragmentShader}),this.materialOcean.uniforms.u_geometrySize={value:this.resolution},this.materialOcean.uniforms.u_displacementMap={value:this.displacementMapFramebuffer.texture},this.materialOcean.uniforms.u_normalMap={value:this.normalMapFramebuffer.texture},this.materialOcean.uniforms.u_oceanColor={value:this.oceanColor},this.materialOcean.uniforms.u_skyColor={value:this.skyColor},this.materialOcean.uniforms.u_sunDirection={value:new Vector3(this.sunDirectionX,this.sunDirectionY,this.sunDirectionZ)},this.materialOcean.uniforms.u_exposure={value:this.exposure},this.materialOceanHorizontal.blending=0,this.materialOceanVertical.blending=0,this.materialInitialSpectrum.blending=0,this.materialPhase.blending=0,this.materialSpectrum.blending=0,this.materialNormal.blending=0,this.materialOcean.blending=0,this.screenQuad=new Mesh(new PlaneBufferGeometry(2,2)),this.scene.add(this.screenQuad),this.generateSeedPhaseTexture(),this.generateMesh()};Ocean.prototype.generateMesh=function(){var s=new PlaneBufferGeometry(this.geometrySize,this.geometrySize,this.geometryResolution,this.geometryResolution);s.rotateX(-Math.PI/2),this.oceanMesh=new Mesh(s,this.materialOcean)},Ocean.prototype.render=function(){var s=this.renderer.getRenderTarget();this.scene.overrideMaterial=null,this.changed&&this.renderInitialSpectrum(),this.renderWavePhase(),this.renderSpectrum(),this.renderSpectrumFFT(),this.renderNormalMap(),this.scene.overrideMaterial=null,this.renderer.setRenderTarget(s)},Ocean.prototype.generateSeedPhaseTexture=function(){this.pingPhase=!0;for(var s=new window.Float32Array(this.resolution*this.resolution*4),e=0;e<this.resolution;e++)for(var a=0;a<this.resolution;a++)s[e*this.resolution*4+4*a]=2*Math.random()*Math.PI,s[e*this.resolution*4+4*a+1]=0,s[e*this.resolution*4+4*a+2]=0,s[e*this.resolution*4+4*a+3]=0;this.pingPhaseTexture=new DataTexture(s,this.resolution,this.resolution,RGBAFormat),this.pingPhaseTexture.wrapS=ClampToEdgeWrapping,this.pingPhaseTexture.wrapT=ClampToEdgeWrapping,this.pingPhaseTexture.type=FloatType},Ocean.prototype.renderInitialSpectrum=function(){this.scene.overrideMaterial=this.materialInitialSpectrum,this.materialInitialSpectrum.uniforms.u_wind.value.set(this.windX,this.windY),this.materialInitialSpectrum.uniforms.u_size.value=this.size,this.renderer.setRenderTarget(this.initialSpectrumFramebuffer),this.renderer.clear(),this.renderer.render(this.scene,this.oceanCamera)},Ocean.prototype.renderWavePhase=function(){this.scene.overrideMaterial=this.materialPhase,this.screenQuad.material=this.materialPhase,this.initial?(this.materialPhase.uniforms.u_phases.value=this.pingPhaseTexture,this.initial=!1):this.materialPhase.uniforms.u_phases.value=this.pingPhase?this.pingPhaseFramebuffer.texture:this.pongPhaseFramebuffer.texture,this.materialPhase.uniforms.u_deltaTime.value=this.deltaTime,this.materialPhase.uniforms.u_size.value=this.size,this.renderer.setRenderTarget(this.pingPhase?this.pongPhaseFramebuffer:this.pingPhaseFramebuffer),this.renderer.render(this.scene,this.oceanCamera),this.pingPhase=!this.pingPhase},Ocean.prototype.renderSpectrum=function(){this.scene.overrideMaterial=this.materialSpectrum,this.materialSpectrum.uniforms.u_initialSpectrum.value=this.initialSpectrumFramebuffer.texture,this.materialSpectrum.uniforms.u_phases.value=this.pingPhase?this.pingPhaseFramebuffer.texture:this.pongPhaseFramebuffer.texture,this.materialSpectrum.uniforms.u_choppiness.value=this.choppiness,this.materialSpectrum.uniforms.u_size.value=this.size,this.renderer.setRenderTarget(this.spectrumFramebuffer),this.renderer.render(this.scene,this.oceanCamera)},Ocean.prototype.renderSpectrumFFT=function(){var s=Math.log(this.resolution)/Math.log(2);this.scene.overrideMaterial=this.materialOceanHorizontal;for(var e=0;e<s;e++)0===e?(this.materialOceanHorizontal.uniforms.u_input.value=this.spectrumFramebuffer.texture,this.materialOceanHorizontal.uniforms.u_subtransformSize.value=Math.pow(2,e%s+1),this.renderer.setRenderTarget(this.pingTransformFramebuffer),this.renderer.render(this.scene,this.oceanCamera)):e%2==1?(this.materialOceanHorizontal.uniforms.u_input.value=this.pingTransformFramebuffer.texture,this.materialOceanHorizontal.uniforms.u_subtransformSize.value=Math.pow(2,e%s+1),this.renderer.setRenderTarget(this.pongTransformFramebuffer),this.renderer.render(this.scene,this.oceanCamera)):(this.materialOceanHorizontal.uniforms.u_input.value=this.pongTransformFramebuffer.texture,this.materialOceanHorizontal.uniforms.u_subtransformSize.value=Math.pow(2,e%s+1),this.renderer.setRenderTarget(this.pingTransformFramebuffer),this.renderer.render(this.scene,this.oceanCamera));for(this.scene.overrideMaterial=this.materialOceanVertical,e=s;e<2*s;e++)e===2*s-1?(this.materialOceanVertical.uniforms.u_input.value=s%2==0?this.pingTransformFramebuffer.texture:this.pongTransformFramebuffer.texture,this.materialOceanVertical.uniforms.u_subtransformSize.value=Math.pow(2,e%s+1),this.renderer.setRenderTarget(this.displacementMapFramebuffer),this.renderer.render(this.scene,this.oceanCamera)):e%2==1?(this.materialOceanVertical.uniforms.u_input.value=this.pingTransformFramebuffer.texture,this.materialOceanVertical.uniforms.u_subtransformSize.value=Math.pow(2,e%s+1),this.renderer.setRenderTarget(this.pongTransformFramebuffer),this.renderer.render(this.scene,this.oceanCamera)):(this.materialOceanVertical.uniforms.u_input.value=this.pongTransformFramebuffer.texture,this.materialOceanVertical.uniforms.u_subtransformSize.value=Math.pow(2,e%s+1),this.renderer.setRenderTarget(this.pingTransformFramebuffer),this.renderer.render(this.scene,this.oceanCamera))},Ocean.prototype.renderNormalMap=function(){this.scene.overrideMaterial=this.materialNormal,this.changed&&(this.materialNormal.uniforms.u_size.value=this.size),this.materialNormal.uniforms.u_displacementMap.value=this.displacementMapFramebuffer.texture,this.renderer.setRenderTarget(this.normalMapFramebuffer),this.renderer.clear(),this.renderer.render(this.scene,this.oceanCamera)};var RollerCoasterGeometry=function(e,a){BufferGeometry.call(this);var d=[],v=[],g=[],C=[1,1,1],w=[1,1,0],_=new Vector3(0,1,0),x=new Vector3,b=new Vector3,A=new Quaternion,E=new Quaternion;E.setFromAxisAngle(_,Math.PI/2);var R=new Vector3,O=new Vector3;O.copy(e.getPointAt(0));for(var D=[new Vector3(-.225,0,0),new Vector3(0,-.05,0),new Vector3(0,-.175,0),new Vector3(0,-.05,0),new Vector3(.225,0,0),new Vector3(0,-.175,0)],F=2*Math.PI,L=5,I=[],V=0;V<L;V++){var z=V/L*F;I.push(new Vector3(.06*Math.sin(z),.06*Math.cos(z),0))}L=6;var H=[];for(V=0;V<L;V++)z=V/L*F,H.push(new Vector3(.025*Math.sin(z),.025*Math.cos(z),0));var X=new Vector3,re=new Vector3;function j(ge,$){re.set(0,0,-1).applyQuaternion(A);for(var ue=0;ue<ge.length;ue++)X.copy(ge[ue]),X.applyQuaternion(A),X.add(R),d.push(X.x,X.y,X.z),v.push(re.x,re.y,re.z),g.push($[0],$[1],$[2]);for(re.set(0,0,1).applyQuaternion(A),ue=ge.length-1;ue>=0;ue--)X.copy(ge[ue]),X.applyQuaternion(A),X.add(R),d.push(X.x,X.y,X.z),v.push(re.x,re.y,re.z),g.push($[0],$[1],$[2])}var te=new Vector3,J=new Vector3,k=new Vector3,U=new Vector3,K=new Vector3,ee=new Vector3,Q=new Vector3,oe=new Vector3;function me(ge,$,ue){for(var Y=0,Z=ge.length;Y<Z;Y++){var se=ge[Y],ve=ge[(Y+1)%Z];te.copy(se).add($),te.applyQuaternion(A),te.add(R),J.copy(ve).add($),J.applyQuaternion(A),J.add(R),k.copy(ve).add($),k.applyQuaternion(E),k.add(O),U.copy(se).add($),U.applyQuaternion(E),U.add(O),d.push(te.x,te.y,te.z),d.push(J.x,J.y,J.z),d.push(U.x,U.y,U.z),d.push(J.x,J.y,J.z),d.push(k.x,k.y,k.z),d.push(U.x,U.y,U.z),K.copy(se),K.applyQuaternion(A),K.normalize(),ee.copy(ve),ee.applyQuaternion(A),ee.normalize(),Q.copy(ve),Q.applyQuaternion(E),Q.normalize(),oe.copy(se),oe.applyQuaternion(E),oe.normalize(),v.push(K.x,K.y,K.z),v.push(ee.x,ee.y,ee.z),v.push(oe.x,oe.y,oe.z),v.push(ee.x,ee.y,ee.z),v.push(Q.x,Q.y,Q.z),v.push(oe.x,oe.y,oe.z),g.push(ue[0],ue[1],ue[2]),g.push(ue[0],ue[1],ue[2]),g.push(ue[0],ue[1],ue[2]),g.push(ue[0],ue[1],ue[2]),g.push(ue[0],ue[1],ue[2]),g.push(ue[0],ue[1],ue[2])}}var fe=new Vector3;for(V=1;V<=a;V++)R.copy(e.getPointAt(V/a)),_.set(0,1,0),x.subVectors(R,O).normalize(),b.crossVectors(_,x).normalize(),_.crossVectors(x,b),z=Math.atan2(x.x,x.z),A.setFromAxisAngle(_,z),V%2==0&&j(D,w),me(I,fe.set(0,-.125,0),w),me(H,fe.set(.2,0,0),C),me(H,fe.set(-.2,0,0),C),O.copy(R),E.copy(A);this.setAttribute("position",new BufferAttribute(new Float32Array(d),3)),this.setAttribute("normal",new BufferAttribute(new Float32Array(v),3)),this.setAttribute("color",new BufferAttribute(new Float32Array(g),3))};RollerCoasterGeometry.prototype=Object.create(BufferGeometry.prototype);var RollerCoasterLiftersGeometry=function(e,a){BufferGeometry.call(this);var d=[],v=[],g=new Quaternion,C=new Vector3(0,1,0),w=new Vector3,_=new Vector3,x=[new Vector3(0,.05,-.05),new Vector3(0,.05,.05),new Vector3(0,-.05,0)],b=[new Vector3(-.05,0,.05),new Vector3(-.05,0,-.05),new Vector3(.05,0,0)],A=[new Vector3(.05,0,-.05),new Vector3(.05,0,.05),new Vector3(-.05,0,0)],E=new Vector3,R=new Vector3,O=new Vector3,D=new Vector3,F=new Vector3,L=new Vector3,I=new Vector3,V=new Vector3;function z(te,J,k){for(var U=0,K=te.length;U<K;U++){var ee=te[U],Q=te[(U+1)%K];E.copy(ee),E.applyQuaternion(g),E.add(J),R.copy(Q),R.applyQuaternion(g),R.add(J),O.copy(Q),O.applyQuaternion(g),O.add(k),D.copy(ee),D.applyQuaternion(g),D.add(k),d.push(E.x,E.y,E.z),d.push(R.x,R.y,R.z),d.push(D.x,D.y,D.z),d.push(R.x,R.y,R.z),d.push(O.x,O.y,O.z),d.push(D.x,D.y,D.z),F.copy(ee),F.applyQuaternion(g),F.normalize(),L.copy(Q),L.applyQuaternion(g),L.normalize(),I.copy(Q),I.applyQuaternion(g),I.normalize(),V.copy(ee),V.applyQuaternion(g),V.normalize(),v.push(F.x,F.y,F.z),v.push(L.x,L.y,L.z),v.push(V.x,V.y,V.z),v.push(L.x,L.y,L.z),v.push(I.x,I.y,I.z),v.push(V.x,V.y,V.z)}}for(var H=new Vector3,X=new Vector3,re=1;re<=a;re++){w.copy(e.getPointAt(re/a)),_.copy(e.getTangentAt(re/a));var j=Math.atan2(_.x,_.z);g.setFromAxisAngle(C,j),w.y>10?(H.set(-.75,-.35,0),H.applyQuaternion(g),H.add(w),X.set(.75,-.35,0),X.applyQuaternion(g),X.add(w),z(x,H,X),H.set(-.7,-.3,0),H.applyQuaternion(g),H.add(w),X.set(-.7,-w.y,0),X.applyQuaternion(g),X.add(w),z(b,H,X),H.set(.7,-.3,0),H.applyQuaternion(g),H.add(w),X.set(.7,-w.y,0),X.applyQuaternion(g),X.add(w),z(A,H,X)):(H.set(0,-.2,0),H.applyQuaternion(g),H.add(w),X.set(0,-w.y,0),X.applyQuaternion(g),X.add(w),z(A,H,X))}this.setAttribute("position",new BufferAttribute(new Float32Array(d),3)),this.setAttribute("normal",new BufferAttribute(new Float32Array(v),3))};RollerCoasterLiftersGeometry.prototype=Object.create(BufferGeometry.prototype);var RollerCoasterShadowGeometry=function(e,a){BufferGeometry.call(this);var d=[],v=new Vector3(0,1,0),g=new Vector3,C=new Quaternion,w=new Quaternion;w.setFromAxisAngle(v,Math.PI/2);var _=new Vector3,x=new Vector3;x.copy(e.getPointAt(0)),x.y=0;for(var b=new Vector3,A=new Vector3,E=new Vector3,R=new Vector3,O=1;O<=a;O++){_.copy(e.getPointAt(O/a)),_.y=0,g.subVectors(_,x);var D=Math.atan2(g.x,g.z);C.setFromAxisAngle(v,D),b.set(-.3,0,0),b.applyQuaternion(C),b.add(_),A.set(.3,0,0),A.applyQuaternion(C),A.add(_),E.set(.3,0,0),E.applyQuaternion(w),E.add(x),R.set(-.3,0,0),R.applyQuaternion(w),R.add(x),d.push(b.x,b.y,b.z),d.push(A.x,A.y,A.z),d.push(R.x,R.y,R.z),d.push(A.x,A.y,A.z),d.push(E.x,E.y,E.z),d.push(R.x,R.y,R.z),x.copy(_),w.copy(C)}this.setAttribute("position",new BufferAttribute(new Float32Array(d),3))};RollerCoasterShadowGeometry.prototype=Object.create(BufferGeometry.prototype);var SkyGeometry=function(){BufferGeometry.call(this);for(var e=[],a=0;a<100;a++){var d=800*Math.random()-400,v=50*Math.random()+50,g=800*Math.random()-400,C=40*Math.random()+20;e.push(d-C,v,g-C),e.push(d+C,v,g-C),e.push(d-C,v,g+C),e.push(d+C,v,g-C),e.push(d+C,v,g+C),e.push(d-C,v,g+C)}this.setAttribute("position",new BufferAttribute(new Float32Array(e),3))};SkyGeometry.prototype=Object.create(BufferGeometry.prototype);var TreesGeometry=function(e){BufferGeometry.call(this);var a=[],d=[],v=new Raycaster;v.ray.direction.set(0,-1,0);for(var g=0;g<2e3;g++){var C=500*Math.random()-250,w=500*Math.random()-250;v.ray.origin.set(C,50,w);var _=v.intersectObject(e);if(0!==_.length){var x=_[0].point.y,b=5*Math.random()+.5,A=Math.random()*Math.PI*2;a.push(C+Math.sin(A),x,w+Math.cos(A)),a.push(C,x+b,w),a.push(C+Math.sin(A+Math.PI),x,w+Math.cos(A+Math.PI)),A+=Math.PI/2,a.push(C+Math.sin(A),x,w+Math.cos(A)),a.push(C,x+b,w),a.push(C+Math.sin(A+Math.PI),x,w+Math.cos(A+Math.PI));for(var E=.1*Math.random(),R=0;R<6;R++)d.push(.2+E,.4+E,0)}}this.setAttribute("position",new BufferAttribute(new Float32Array(a),3)),this.setAttribute("color",new BufferAttribute(new Float32Array(d),3))};function TubePainter(){var s=3e6,e=new BufferAttribute(new Float32Array(s),3);e.usage=DynamicDrawUsage;var a=new BufferAttribute(new Float32Array(s),3);a.usage=DynamicDrawUsage;var d=new BufferAttribute(new Float32Array(s),3);d.usage=DynamicDrawUsage;var v=new BufferGeometry;v.setAttribute("position",e),v.setAttribute("normal",a),v.setAttribute("color",d),v.drawRange.count=0;var g=new MeshStandardMaterial({vertexColors:VertexColors}),C=new Mesh(v,g);C.frustumCulled=!1;var _=new Vector3,x=new Vector3,b=new Vector3,A=new Vector3,E=new Color(16777215),R=1;var D=new Vector3(0,1,0),F=new Vector3,L=new Vector3,I=new Matrix4,V=new Matrix4,re=0;return{mesh:C,moveTo:function(te){F.copy(te),I.lookAt(L,F,D),L.copy(te),V.copy(I)},lineTo:function(te){F.copy(te),I.lookAt(L,F,D),function(te,J,k,U){if(0!==te.distanceToSquared(J)){for(var K=v.drawRange.count,ee=function(te){for(var J=2*Math.PI,U=[],K=.01*te,ee=0;ee<10;ee++){var Q=ee/10*J;U.push(new Vector3(Math.sin(Q)*K,Math.cos(Q)*K,0))}return U}(R),Q=0,oe=ee.length;Q<oe;Q++){var me=ee[Q],fe=ee[(Q+1)%oe];_.copy(me).applyMatrix4(U).add(J),x.copy(fe).applyMatrix4(U).add(J),b.copy(fe).applyMatrix4(k).add(te),A.copy(me).applyMatrix4(k).add(te),_.toArray(e.array,3*(K+0)),x.toArray(e.array,3*(K+1)),A.toArray(e.array,3*(K+2)),x.toArray(e.array,3*(K+3)),b.toArray(e.array,3*(K+4)),A.toArray(e.array,3*(K+5)),_.copy(me).applyMatrix4(U).normalize(),x.copy(fe).applyMatrix4(U).normalize(),b.copy(fe).applyMatrix4(k).normalize(),A.copy(me).applyMatrix4(k).normalize(),_.toArray(a.array,3*(K+0)),x.toArray(a.array,3*(K+1)),A.toArray(a.array,3*(K+2)),x.toArray(a.array,3*(K+3)),b.toArray(a.array,3*(K+4)),A.toArray(a.array,3*(K+5)),E.toArray(d.array,3*(K+0)),E.toArray(d.array,3*(K+1)),E.toArray(d.array,3*(K+2)),E.toArray(d.array,3*(K+3)),E.toArray(d.array,3*(K+4)),E.toArray(d.array,3*(K+5)),K+=6}v.drawRange.count=K}}(F,L,I,V),L.copy(F),V.copy(I)},setSize:function(te){R=te},update:function(){var te=re,J=v.drawRange.count;te!==J&&(e.updateRange.offset=3*te,e.updateRange.count=3*(J-te),e.needsUpdate=!0,a.updateRange.offset=3*te,a.updateRange.count=3*(J-te),a.needsUpdate=!0,d.updateRange.offset=3*te,d.updateRange.count=3*(J-te),d.needsUpdate=!0,re=v.drawRange.count)}}}TreesGeometry.prototype=Object.create(BufferGeometry.prototype);var ExplodeModifier=function(){};ExplodeModifier.prototype.modify=function(s){for(var e=[],a=0,d=s.faces.length;a<d;a++){var v=e.length,g=s.faces[a],b=s.vertices[g.b],A=s.vertices[g.c];e.push(s.vertices[g.a].clone()),e.push(b.clone()),e.push(A.clone()),g.a=v,g.b=v+1,g.c=v+2}s.vertices=e};var SimplifyModifier=function(){};!function(){var s=new Vector3,e=new Vector3;function d(E,R){var O=E.indexOf(R);O>-1&&E.splice(O,1)}function v(E,R){var L,V,O=R.position.distanceTo(E.position),D=0,F=[],I=E.faces.length;for(L=0;L<I;L++)(V=E.faces[L]).hasVertex(R)&&F.push(V);for(L=0;L<I;L++){var H=1;V=E.faces[L];for(var X=0;X<F.length;X++){var re=V.normal.dot(F[X].normal);H=Math.min(H,(1.001-re)/2)}D=Math.max(D,H)}return F.length<2&&(D=1),O*D+0}function g(E){if(0===E.neighbors.length)return E.collapseNeighbor=null,void(E.collapseCost=-.01);E.collapseCost=1e5,E.collapseNeighbor=null;for(var R=0;R<E.neighbors.length;R++){var O=v(E,E.neighbors[R]);E.collapseNeighbor||(E.collapseNeighbor=E.neighbors[R],E.collapseCost=O,E.minCost=O,E.totalCost=0,E.costCount=0),E.costCount++,E.totalCost+=O,O<E.minCost&&(E.collapseNeighbor=E.neighbors[R],E.minCost=O)}E.collapseCost=E.totalCost/E.costCount}function C(E,R){for(console.assert(0===E.faces.length);E.neighbors.length;)d(E.neighbors.pop().neighbors,E);d(R,E)}function w(E,R){d(R,E),E.v1&&d(E.v1.faces,E),E.v2&&d(E.v2.faces,E),E.v3&&d(E.v3.faces,E);for(var D,F,O=[E.v1,E.v2,E.v3],L=0;L<3;L++)F=O[(L+1)%3],(D=O[L])&&F&&(D.removeIfNonNeighbor(F),F.removeIfNonNeighbor(D))}function _(E,R,O,D){if(D){var F,L=[];for(F=0;F<O.neighbors.length;F++)L.push(O.neighbors[F]);for(F=O.faces.length-1;F>=0;F--)O.faces[F].hasVertex(D)&&w(O.faces[F],R);for(F=O.faces.length-1;F>=0;F--)O.faces[F].replaceVertex(O,D);for(C(O,E),F=0;F<L.length;F++)g(L[F])}else C(O,E)}function x(E){for(var R=E[0],O=0;O<E.length;O++)E[O].collapseCost<R.collapseCost&&(R=E[O]);return R}function b(E,R,O,D,F,L){this.a=D,this.b=F,this.c=L,this.v1=E,this.v2=R,this.v3=O,this.normal=new Vector3,this.computeNormal(),E.faces.push(this),E.addUniqueNeighbor(R),E.addUniqueNeighbor(O),R.faces.push(this),R.addUniqueNeighbor(E),R.addUniqueNeighbor(O),O.faces.push(this),O.addUniqueNeighbor(E),O.addUniqueNeighbor(R)}function A(E,R){this.position=E,this.id=R,this.faces=[],this.neighbors=[],this.collapseCost=0,this.collapseNeighbor=null}b.prototype.computeNormal=function(){var E=this.v1.position,R=this.v2.position;s.subVectors(this.v3.position,R),e.subVectors(E,R),s.cross(e).normalize(),this.normal.copy(s)},b.prototype.hasVertex=function(E){return E===this.v1||E===this.v2||E===this.v3},b.prototype.replaceVertex=function(E,R){E===this.v1?this.v1=R:E===this.v2?this.v2=R:E===this.v3&&(this.v3=R),d(E.faces,this),R.faces.push(this),E.removeIfNonNeighbor(this.v1),this.v1.removeIfNonNeighbor(E),E.removeIfNonNeighbor(this.v2),this.v2.removeIfNonNeighbor(E),E.removeIfNonNeighbor(this.v3),this.v3.removeIfNonNeighbor(E),this.v1.addUniqueNeighbor(this.v2),this.v1.addUniqueNeighbor(this.v3),this.v2.addUniqueNeighbor(this.v1),this.v2.addUniqueNeighbor(this.v3),this.v3.addUniqueNeighbor(this.v1),this.v3.addUniqueNeighbor(this.v2),this.computeNormal()},A.prototype.addUniqueNeighbor=function(E){!function(E,R){-1===E.indexOf(R)&&E.push(R)}(this.neighbors,E)},A.prototype.removeIfNonNeighbor=function(E){var R=this.neighbors,O=this.faces,D=R.indexOf(E);if(-1!==D){for(var F=0;F<O.length;F++)if(O[F].hasVertex(E))return;R.splice(D,1)}},SimplifyModifier.prototype.modify=function(E,R){E.isBufferGeometry&&(E=(new Geometry).fromBufferGeometry(E)),E.mergeVertices();var I,V,O=E.vertices,D=E.faces,F=[],L=[];for(I=0,V=O.length;I<V;I++){var z=new A(O[I],I);F.push(z)}for(I=0,V=D.length;I<V;I++){var te=new b(F[X=(H=D[I]).a],F[re=H.b],F[j=H.c],X,re,j);L.push(te)}for(I=0,V=F.length;I<V;I++)g(F[I]);for(var J,k=R;k--;){if(!(J=x(F))){console.log("SimplifyModifier: No next vertex");break}_(F,L,J,J.collapseNeighbor)}var U=new BufferGeometry,K=[],ee=[];for(I=0;I<F.length;I++)K.push((z=F[I].position).x,z.y,z.z);for(I=0;I<L.length;I++){var H,X=F.indexOf((H=L[I]).v1),re=F.indexOf(H.v2),j=F.indexOf(H.v3);ee.push(X,re,j)}return U.setAttribute("position",new Float32BufferAttribute(K,3)),U.setIndex(ee),U}}();var SubdivisionModifier=function(e){this.subdivisions=void 0===e?1:e};SubdivisionModifier.prototype.modify=function(s){(s=s.isBufferGeometry?(new Geometry).fromBufferGeometry(s):s.clone()).mergeVertices();for(var e=this.subdivisions;e-- >0;)this.smooth(s);return s.computeFaceNormals(),s.computeVertexNormals(),s},function(){var s=["a","b","c"];function e(w,_,x){return x[Math.min(w,_)+"_"+Math.max(w,_)]}function a(w,_,x,b,A,E){var F,R=Math.min(w,_),O=Math.max(w,_),D=R+"_"+O;D in b?F=b[D]:b[D]=F={a:x[R],b:x[O],newEdge:null,faces:[]},F.faces.push(A),E[w].edges.push(F),E[_].edges.push(F)}function v(w,_,x,b,A){w.push(new Face3(_,x,b,void 0,void 0,A))}function g(w,_){return Math.abs(_-w)/2+Math.min(w,_)}function C(w,_,x,b){w.push([_.clone(),x.clone(),b.clone()])}SubdivisionModifier.prototype.smooth=function(w){var x,b,A,E,R,D,F,L,V,z,H,X,re,_=new Vector3,O=[];x=w.vertices,b=w.faces;var te,J,k,U,K,ee,Q,oe,me,fe,ge,$,ue,Y,j=void 0!==(A=w.faceVertexUvs)[0]&&A[0].length>0;if(j)for(var I=0;I<A.length;I++)O.push([]);for(F in function(w,_,x,b){var A,E,R;for(A=0,E=w.length;A<E;A++)x[A]={edges:[]};for(A=0,E=_.length;A<E;A++)a((R=_[A]).a,R.b,w,b,R,x),a(R.b,R.c,w,b,R,x),a(R.c,R.a,w,b,R,x)}(x,b,z=new Array(x.length),H={}),X=[],H){for(J=H[F],k=new Vector3,K=3/8,ee=1/8,2!=(Q=J.faces.length)&&(K=.5,ee=0),k.addVectors(J.a,J.b).multiplyScalar(K),_.set(0,0,0),I=0;I<Q;I++){for(U=J.faces[I],V=0;V<3&&((te=x[U[s[V]]])===J.a||te===J.b);V++);_.add(te)}_.multiplyScalar(ee),k.add(_),J.newEdge=X.length,X.push(k)}for(re=[],F=0,L=x.length;F<L;F++){for(3==(D=($=z[F].edges).length)?oe=3/16:D>3&&(oe=3/(8*D)),me=1-D*oe,fe=oe,D<=2&&2==D&&(me=3/4,fe=1/8),Y=(ue=x[F]).clone().multiplyScalar(me),_.set(0,0,0),I=0;I<D;I++)_.add(te=(ge=$[I]).a!==ue?ge.a:ge.b);_.multiplyScalar(fe),Y.add(_),re.push(Y)}E=re.concat(X);var se,ve,le,Z=re.length;R=[];var _e,ae,pe,he,ce=new Vector2,Te=new Vector2,be=new Vector2;for(F=0,L=b.length;F<L;F++)if(v(R,se=e((U=b[F]).a,U.b,H).newEdge+Z,ve=e(U.b,U.c,H).newEdge+Z,le=e(U.c,U.a,H).newEdge+Z,U.materialIndex),v(R,U.a,se,le,U.materialIndex),v(R,U.b,ve,se,U.materialIndex),v(R,U.c,le,ve,U.materialIndex),j)for(I=0;I<A.length;I++)he=(_e=A[I][F])[2],ce.set(g((ae=_e[0]).x,(pe=_e[1]).x),g(ae.y,pe.y)),Te.set(g(pe.x,he.x),g(pe.y,he.y)),be.set(g(ae.x,he.x),g(ae.y,he.y)),C(O[I],ce,Te,be),C(O[I],ae,ce,be),C(O[I],pe,Te,ce),C(O[I],he,be,Te);w.vertices=E,w.faces=R,j&&(w.faceVertexUvs=O)}}();var TessellateModifier=function(e){this.maxEdgeLength=e};function Pass(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}TessellateModifier.prototype.modify=function(s){for(var e,a=[],d=[],v=this.maxEdgeLength*this.maxEdgeLength,g=0,C=s.faceVertexUvs.length;g<C;g++)d[g]=[];for(g=0,C=s.faces.length;g<C;g++){var w=s.faces[g];if(w instanceof Face3){var _=w.a,x=w.b,b=w.c,A=s.vertices[_],E=s.vertices[x],R=s.vertices[b],O=A.distanceToSquared(E),D=E.distanceToSquared(R),F=A.distanceToSquared(R);if(O>v||D>v||F>v){var L=s.vertices.length,I=w.clone(),V=w.clone();if(O>=D&&O>=F)(z=A.clone()).lerp(E,.5),I.a=_,I.b=L,I.c=b,V.a=L,V.b=x,V.c=b,3===w.vertexNormals.length&&((H=w.vertexNormals[0].clone()).lerp(w.vertexNormals[1],.5),I.vertexNormals[1].copy(H),V.vertexNormals[0].copy(H)),3===w.vertexColors.length&&((X=w.vertexColors[0].clone()).lerp(w.vertexColors[1],.5),I.vertexColors[1].copy(X),V.vertexColors[0].copy(X)),e=0;else if(D>=O&&D>=F)(z=E.clone()).lerp(R,.5),I.a=_,I.b=x,I.c=L,V.a=L,V.b=b,V.c=_,3===w.vertexNormals.length&&((H=w.vertexNormals[1].clone()).lerp(w.vertexNormals[2],.5),I.vertexNormals[2].copy(H),V.vertexNormals[0].copy(H),V.vertexNormals[1].copy(w.vertexNormals[2]),V.vertexNormals[2].copy(w.vertexNormals[0])),3===w.vertexColors.length&&((X=w.vertexColors[1].clone()).lerp(w.vertexColors[2],.5),I.vertexColors[2].copy(X),V.vertexColors[0].copy(X),V.vertexColors[1].copy(w.vertexColors[2]),V.vertexColors[2].copy(w.vertexColors[0])),e=1;else{var z,H,X;(z=A.clone()).lerp(R,.5),I.a=_,I.b=x,I.c=L,V.a=L,V.b=x,V.c=b,3===w.vertexNormals.length&&((H=w.vertexNormals[0].clone()).lerp(w.vertexNormals[2],.5),I.vertexNormals[2].copy(H),V.vertexNormals[0].copy(H)),3===w.vertexColors.length&&((X=w.vertexColors[0].clone()).lerp(w.vertexColors[2],.5),I.vertexColors[2].copy(X),V.vertexColors[0].copy(X)),e=2}a.push(I,V),s.vertices.push(z);for(var re=0,j=s.faceVertexUvs.length;re<j;re++)if(s.faceVertexUvs[re].length){var te=s.faceVertexUvs[re][g],J=te[0],k=te[1],U=te[2];if(0===e){(K=J.clone()).lerp(k,.5);var ee=[J.clone(),K.clone(),U.clone()],Q=[K.clone(),k.clone(),U.clone()]}else if(1===e)(K=k.clone()).lerp(U,.5),ee=[J.clone(),k.clone(),K.clone()],Q=[K.clone(),U.clone(),J.clone()];else{var K;(K=J.clone()).lerp(U,.5),ee=[J.clone(),k.clone(),K.clone()],Q=[K.clone(),k.clone(),U.clone()]}d[re].push(ee,Q)}}else for(a.push(w),re=0,j=s.faceVertexUvs.length;re<j;re++)d[re].push(s.faceVertexUvs[re][g])}}s.faces=a,s.faceVertexUvs=d},Object.assign(Pass.prototype,{setSize:function(){},render:function(){console.error("Pass: .render() must be implemented in derived pass.")}}),Pass.FullScreenQuad=function(){var s=new OrthographicCamera(-1,1,1,-1,0,1),e=new PlaneBufferGeometry(2,2),a=function(v){this._mesh=new Mesh(e,v)};return Object.defineProperty(a.prototype,"material",{get:function(){return this._mesh.material},set:function(v){this._mesh.material=v}}),Object.assign(a.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(v){v.render(this._mesh,s)}}),a}();var ShaderPass=function(e,a){Pass.call(this),this.textureID=void 0!==a?a:"tDiffuse",e instanceof ShaderMaterial?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=UniformsUtils.clone(e.uniforms),this.material=new ShaderMaterial({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new Pass.FullScreenQuad(this.material)};function NodePass(){ShaderPass.call(this),this.name="",this.uuid=MathUtils.generateUUID(),this.userData={},this.textureID="renderTexture",this.input=new ScreenNode,this.material=new NodeMaterial,this.needsUpdate=!0}function Clock(s){this.autoStart=void 0===s||s,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}ShaderPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:ShaderPass,render:function(e,a,d){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=d.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(a),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}}),NodePass.prototype=Object.create(ShaderPass.prototype),NodePass.prototype.constructor=NodePass,NodePass.prototype.render=function(){this.needsUpdate&&(this.material.dispose(),this.material.fragment.value=this.input,this.needsUpdate=!1),this.uniforms=this.material.uniforms,ShaderPass.prototype.render.apply(this,arguments)},NodePass.prototype.copy=function(s){return this.input=s.input,this},NodePass.prototype.toJSON=function(s){if((void 0===s||"string"==typeof s)&&(s={nodes:{}}),s&&!s.passes&&(s.passes={}),!s.passes[this.uuid]){var a={};a.uuid=this.uuid,a.type="NodePass",s.passes[this.uuid]=a,""!==this.name&&(a.name=this.name),"{}"!==JSON.stringify(this.userData)&&(a.userData=this.userData),a.input=this.input.toJSON(s).uuid}return s.pass=this.uuid,s},Object.assign(Clock.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var a=("undefined"==typeof performance?Date:performance).now();e=(a-this.oldTime)/1e3,this.oldTime=a,this.elapsedTime+=e}return e}});var Fire=function s(e,a){Mesh.call(this,e),this.type="Fire",this.clock=new Clock;var d=(a=a||{}).textureWidth||512,v=a.textureHeight||512,g=1/d,C=1/v,w=void 0!==a.debug&&a.debug;this.color1=a.color1||new Color(16777215),this.color2=a.color2||new Color(16752640),this.color3=a.color3||new Color(0),this.colorBias=void 0===a.colorBias?.8:a.colorBias,this.diffuse=void 0===a.diffuse?1.33:a.diffuse,this.viscosity=void 0===a.viscosity?.25:a.viscosity,this.expansion=void 0===a.expansion?-.25:a.expansion,this.swirl=void 0===a.swirl?50:a.swirl,this.burnRate=void 0===a.burnRate?.3:a.burnRate,this.drag=void 0===a.drag?.35:a.drag,this.airSpeed=void 0===a.airSpeed?6:a.airSpeed,this.windVector=a.windVector||new Vector2(0,.75),this.speed=void 0===a.speed?500:a.speed,this.massConservation=void 0!==a.massConservation&&a.massConservation,this.sourceData=new Uint8Array(d*v*4),this.clearSources=function(){for(var A=0;A<v;A++)for(var E=0;E<d;E++){var O=4*(A*d+E);this.sourceData[O]=0,this.sourceData[O+1]=0,this.sourceData[O+2]=0,this.sourceData[O+3]=0}return this.sourceMaterial.uniforms.sourceMap.value=this.internalSource,this.sourceMaterial.needsUpdate=!0,this.sourceData},this.addSource=function(A,E,R,O,D,F){void 0===O&&(O=null),void 0===D&&(D=null),void 0===F&&(F=null);for(var L=Math.max(Math.floor((A-R)*d),0),I=Math.max(Math.floor((E-R)*v),0),V=Math.min(Math.floor((A+R)*d),d),z=Math.min(Math.floor((E+R)*v),v),H=I;H<z;H++)for(var X=L;X<V;X++){var re=X*g-A,j=H*C-E;if(re*re+j*j<R*R){var k,J=4*(H*d+X);null!=O&&(this.sourceData[J]=255*Math.min(Math.max(O,0),1)),null!=D&&(k=(k=Math.min(Math.max(D,-1),1))<0?Math.floor(127*k)+255:Math.floor(127*k),this.sourceData[J+1]=k),null!=F&&(k=(k=Math.min(Math.max(F,-1),1))<0?Math.floor(127*k)+255:Math.floor(127*k),this.sourceData[J+2]=k)}}return this.internalSource.needsUpdate=!0,this.sourceData},this.setSourceMap=function(A){this.sourceMaterial.uniforms.sourceMap.value=A};var b,x={minFilter:NearestFilter,magFilter:NearestFilter,depthBuffer:!1,stencilBuffer:!1};this.field0=new WebGLRenderTarget(d,v,x),this.field0.background=new Color(0),this.field1=new WebGLRenderTarget(d,v,x),this.field0.background=new Color(0),this.fieldProj=new WebGLRenderTarget(d,v,x),this.field0.background=new Color(0),(!MathUtils.isPowerOfTwo(d)||!MathUtils.isPowerOfTwo(v))&&(this.field0.texture.generateMipmaps=!1,this.field1.texture.generateMipmaps=!1,this.fieldProj.texture.generateMipmaps=!1),this.fieldScene=new Scene,this.fieldScene.background=new Color(0),this.orthoCamera=new OrthographicCamera(d/-2,d/2,v/2,v/-2,1,2),this.orthoCamera.position.z=1,this.fieldGeometry=new PlaneBufferGeometry(d,v),this.internalSource=new DataTexture(this.sourceData,d,v,RGBAFormat),this.sourceMaterial=new ShaderMaterial({uniforms:(b=s.SourceShader).uniforms,vertexShader:b.vertexShader,fragmentShader:b.fragmentShader,transparent:!1}),this.clearSources(),this.sourceMesh=new Mesh(this.fieldGeometry,this.sourceMaterial),this.fieldScene.add(this.sourceMesh),this.diffuseMaterial=new ShaderMaterial({uniforms:(b=s.DiffuseShader).uniforms,vertexShader:b.vertexShader,fragmentShader:b.fragmentShader,transparent:!1}),this.diffuseMaterial.uniforms.oneOverWidth.value=g,this.diffuseMaterial.uniforms.oneOverHeight.value=C,this.diffuseMesh=new Mesh(this.fieldGeometry,this.diffuseMaterial),this.fieldScene.add(this.diffuseMesh),this.driftMaterial=new ShaderMaterial({uniforms:(b=s.DriftShader).uniforms,vertexShader:b.vertexShader,fragmentShader:b.fragmentShader,transparent:!1}),this.driftMaterial.uniforms.oneOverWidth.value=g,this.driftMaterial.uniforms.oneOverHeight.value=C,this.driftMesh=new Mesh(this.fieldGeometry,this.driftMaterial),this.fieldScene.add(this.driftMesh),this.projMaterial1=new ShaderMaterial({uniforms:(b=s.ProjectionShader1).uniforms,vertexShader:b.vertexShader,fragmentShader:b.fragmentShader,transparent:!1}),this.projMaterial1.uniforms.oneOverWidth.value=g,this.projMaterial1.uniforms.oneOverHeight.value=C,this.projMesh1=new Mesh(this.fieldGeometry,this.projMaterial1),this.fieldScene.add(this.projMesh1),this.projMaterial2=new ShaderMaterial({uniforms:(b=s.ProjectionShader2).uniforms,vertexShader:b.vertexShader,fragmentShader:b.fragmentShader,transparent:!1}),this.projMaterial2.uniforms.oneOverWidth.value=g,this.projMaterial2.uniforms.oneOverHeight.value=C,this.projMesh2=new Mesh(this.fieldGeometry,this.projMaterial2),this.fieldScene.add(this.projMesh2),this.projMaterial3=new ShaderMaterial({uniforms:(b=s.ProjectionShader3).uniforms,vertexShader:b.vertexShader,fragmentShader:b.fragmentShader,transparent:!1}),this.projMaterial3.uniforms.oneOverWidth.value=g,this.projMaterial3.uniforms.oneOverHeight.value=C,this.projMesh3=new Mesh(this.fieldGeometry,this.projMaterial3),this.fieldScene.add(this.projMesh3),this.material=new ShaderMaterial({uniforms:(b=w?s.DebugShader:s.ColorShader).uniforms,vertexShader:b.vertexShader,fragmentShader:b.fragmentShader,transparent:!0}),this.material.uniforms.densityMap.value=this.field1.texture,this.configShaders=function(A){this.diffuseMaterial.uniforms.diffuse.value=.05*A*this.diffuse,this.diffuseMaterial.uniforms.viscosity.value=.05*A*this.viscosity,this.diffuseMaterial.uniforms.expansion.value=Math.exp(-1*this.expansion),this.diffuseMaterial.uniforms.swirl.value=Math.exp(-.1*this.swirl),this.diffuseMaterial.uniforms.drag.value=Math.exp(-.1*this.drag),this.diffuseMaterial.uniforms.burnRate.value=this.burnRate*A*.01,this.driftMaterial.uniforms.windVector.value=this.windVector,this.driftMaterial.uniforms.airSpeed.value=A*this.airSpeed*.001*v,this.material.uniforms.color1.value=this.color1,this.material.uniforms.color2.value=this.color2,this.material.uniforms.color3.value=this.color3,this.material.uniforms.colorBias.value=this.colorBias},this.clearDiffuse=function(){this.diffuseMaterial.uniforms.expansion.value=1,this.diffuseMaterial.uniforms.swirl.value=1,this.diffuseMaterial.uniforms.drag.value=1,this.diffuseMaterial.uniforms.burnRate.value=0},this.swapTextures=function(){var A=this.field0;this.field0=this.field1,this.field1=A},this.saveRenderState=function(A){this.savedRenderTarget=A.getRenderTarget(),this.savedXrEnabled=A.xr.enabled,this.savedShadowAutoUpdate=A.shadowMap.autoUpdate,this.savedAntialias=A.antialias,this.savedToneMapping=A.toneMapping},this.restoreRenderState=function(A){A.xr.enabled=this.savedXrEnabled,A.shadowMap.autoUpdate=this.savedShadowAutoUpdate,A.setRenderTarget(this.savedRenderTarget),A.antialias=this.savedAntialias,A.toneMapping=this.savedToneMapping},this.renderSource=function(A){this.sourceMesh.visible=!0,this.sourceMaterial.uniforms.densityMap.value=this.field0.texture,A.setRenderTarget(this.field1),A.render(this.fieldScene,this.orthoCamera),this.sourceMesh.visible=!1,this.swapTextures()},this.renderDiffuse=function(A){this.diffuseMesh.visible=!0,this.diffuseMaterial.uniforms.densityMap.value=this.field0.texture,A.setRenderTarget(this.field1),A.render(this.fieldScene,this.orthoCamera),this.diffuseMesh.visible=!1,this.swapTextures()},this.renderDrift=function(A){this.driftMesh.visible=!0,this.driftMaterial.uniforms.densityMap.value=this.field0.texture,A.setRenderTarget(this.field1),A.render(this.fieldScene,this.orthoCamera),this.driftMesh.visible=!1,this.swapTextures()},this.renderProject=function(A){this.projMesh1.visible=!0,this.projMaterial1.uniforms.densityMap.value=this.field0.texture,A.setRenderTarget(this.fieldProj),A.render(this.fieldScene,this.orthoCamera),this.projMesh1.visible=!1,this.projMaterial2.uniforms.densityMap.value=this.fieldProj.texture,this.projMesh2.visible=!0;for(var E=0;E<20;E++){A.setRenderTarget(this.field1),A.render(this.fieldScene,this.orthoCamera);var R=this.field1;this.field1=this.fieldProj,this.fieldProj=R,this.projMaterial2.uniforms.densityMap.value=this.fieldProj.texture}this.projMesh2.visible=!1,this.projMaterial3.uniforms.densityMap.value=this.field0.texture,this.projMaterial3.uniforms.projMap.value=this.fieldProj.texture,this.projMesh3.visible=!0,A.setRenderTarget(this.field1),A.render(this.fieldScene,this.orthoCamera),this.projMesh3.visible=!1,this.swapTextures()},this.onBeforeRender=function(A){var E=this.clock.getDelta();E>.1&&(E=.1);var R=E*(.1*this.speed);this.configShaders(R),this.saveRenderState(A),A.xr.enabled=!1,A.shadowMap.autoUpdate=!1,A.antialias=!1,A.toneMapping=NoToneMapping,this.sourceMesh.visible=!1,this.diffuseMesh.visible=!1,this.driftMesh.visible=!1,this.projMesh1.visible=!1,this.projMesh2.visible=!1,this.projMesh3.visible=!1,this.renderSource(A),this.clearDiffuse();for(var O=0;O<21;O++)this.renderDiffuse(A);this.configShaders(R),this.renderDiffuse(A),this.renderDrift(A),this.massConservation&&(this.renderProject(A),this.renderProject(A)),this.material.map=this.field1.texture,this.material.transparent=!0,this.material.minFilter=LinearFilter,this.material.magFilter=LinearFilter,this.restoreRenderState(A)}};Fire.prototype=Object.create(Mesh.prototype),Fire.prototype.constructor=Fire,Fire.SourceShader={uniforms:{sourceMap:{value:null},densityMap:{value:null}},vertexShader:["varying vec2 vUv;","void main() {"," \t  vUv = uv;","     vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","     gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform sampler2D sourceMap;","uniform sampler2D densityMap;","varying vec2 vUv;","void main() {","    vec4 source = texture2D( sourceMap, vUv );","    vec4 current = texture2D( densityMap, vUv );","    vec2 v0 = (current.gb - step(0.5, current.gb)) * 2.0;","    vec2 v1 = (source.gb - step(0.5, source.gb)) * 2.0;","    vec2 newVel = v0 + v1;","    newVel = clamp(newVel, -0.99, 0.99);","    newVel = newVel * 0.5 + step(0.0, -newVel);","    float newDensity = source.r + current.a;","    float newTemp = source.r + current.r;","    newDensity = clamp(newDensity, 0.0, 1.0);","    newTemp = clamp(newTemp, 0.0, 1.0);","    gl_FragColor = vec4(newTemp, newVel.xy, newDensity);","}"].join("\n")},Fire.DiffuseShader={uniforms:{oneOverWidth:{value:null},oneOverHeight:{value:null},diffuse:{value:null},viscosity:{value:null},expansion:{value:null},swirl:{value:null},drag:{value:null},burnRate:{value:null},densityMap:{value:null}},vertexShader:["varying vec2 vUv;","void main() {"," \t  vUv = uv;","     vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","     gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform float oneOverWidth;","uniform float oneOverHeight;","uniform float diffuse;","uniform float viscosity;","uniform float expansion;","uniform float swirl;","uniform float burnRate;","uniform float drag;","uniform sampler2D densityMap;","varying vec2 vUv;","void main() {","    vec4 dC = texture2D( densityMap, vUv );","    vec4 dL = texture2D( densityMap, vec2(vUv.x - oneOverWidth, vUv.y) );","    vec4 dR = texture2D( densityMap, vec2(vUv.x + oneOverWidth, vUv.y) );","    vec4 dU = texture2D( densityMap, vec2(vUv.x, vUv.y - oneOverHeight) );","    vec4 dD = texture2D( densityMap, vec2(vUv.x, vUv.y + oneOverHeight) );","    vec4 dUL = texture2D( densityMap, vec2(vUv.x - oneOverWidth, vUv.y - oneOverHeight) );","    vec4 dUR = texture2D( densityMap, vec2(vUv.x + oneOverWidth, vUv.y - oneOverHeight) );","    vec4 dDL = texture2D( densityMap, vec2(vUv.x - oneOverWidth, vUv.y + oneOverHeight) );","    vec4 dDR = texture2D( densityMap, vec2(vUv.x + oneOverWidth, vUv.y + oneOverHeight) );","    dC.yz = (dC.yz - step(0.5, dC.yz)) * 2.0;","    dL.yz = (dL.yz - step(0.5, dL.yz)) * 2.0;","    dR.yz = (dR.yz - step(0.5, dR.yz)) * 2.0;","    dU.yz = (dU.yz - step(0.5, dU.yz)) * 2.0;","    dD.yz = (dD.yz - step(0.5, dD.yz)) * 2.0;","    dUL.yz = (dUL.yz - step(0.5, dUL.yz)) * 2.0;","    dUR.yz = (dUR.yz - step(0.5, dUR.yz)) * 2.0;","    dDL.yz = (dDL.yz - step(0.5, dDL.yz)) * 2.0;","    dDR.yz = (dDR.yz - step(0.5, dDR.yz)) * 2.0;","    vec4 result = (dC + vec4(diffuse, viscosity, viscosity, diffuse) * ( dL + dR + dU + dD + dUL + dUR + dDL + dDR )) / (1.0 + 8.0 * vec4(diffuse, viscosity, viscosity, diffuse)) - vec4(0.0, 0.0, 0.0, 0.001);","    float temperature = result.r;","    temperature = clamp(temperature - burnRate, 0.0, 1.0);","    vec2 velocity = result.yz;","    vec2 expansionVec = vec2(dL.w - dR.w, dU.w - dD.w);","    vec2 swirlVec = vec2((dL.z - dR.z) * 0.5, (dU.y - dD.y) * 0.5);","    velocity = velocity + (1.0 - expansion) * expansionVec + (1.0 - swirl) * swirlVec;","    velocity = velocity - (1.0 - drag) * velocity;","    gl_FragColor = vec4(temperature, velocity * 0.5 + step(0.0, -velocity), result.w);","    gl_FragColor = gl_FragColor * step(oneOverWidth, vUv.x);","    gl_FragColor = gl_FragColor * step(oneOverHeight, vUv.y);","    gl_FragColor = gl_FragColor * step(vUv.x, 1.0 - oneOverWidth);","    gl_FragColor = gl_FragColor * step(vUv.y, 1.0 - oneOverHeight);","}"].join("\n")},Fire.DriftShader={uniforms:{oneOverWidth:{value:null},oneOverHeight:{value:null},windVector:{value:new Vector2(0,0)},airSpeed:{value:null},densityMap:{value:null}},vertexShader:["varying vec2 vUv;","void main() {"," \t  vUv = uv;","     vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","     gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform float oneOverWidth;","uniform float oneOverHeight;","uniform vec2 windVector;","uniform float airSpeed;","uniform sampler2D densityMap;","varying vec2 vUv;","void main() {","    vec2 velocity = texture2D( densityMap, vUv ).gb;","    velocity = (velocity - step(0.5, velocity)) * 2.0;","    velocity = velocity + windVector;","    vec2 sourcePos = vUv - airSpeed * vec2(oneOverWidth, oneOverHeight) * velocity;","    vec2 units = sourcePos / vec2(oneOverWidth, oneOverHeight);","    vec2 intPos = floor(units);","    vec2 frac = units - intPos;","    intPos = intPos * vec2(oneOverWidth, oneOverHeight);","    vec4 dX0Y0 = texture2D( densityMap, intPos + vec2(0.0, -oneOverHeight) );","    vec4 dX1Y0 = texture2D( densityMap, intPos + vec2(oneOverWidth, 0.0) );","    vec4 dX0Y1 = texture2D( densityMap, intPos + vec2(0.0, oneOverHeight) );","    vec4 dX1Y1 = texture2D( densityMap, intPos + vec2(oneOverWidth, oneOverHeight) );","    dX0Y0.gb = (dX0Y0.gb - step(0.5, dX0Y0.gb)) * 2.0;","    dX1Y0.gb = (dX1Y0.gb - step(0.5, dX1Y0.gb)) * 2.0;","    dX0Y1.gb = (dX0Y1.gb - step(0.5, dX0Y1.gb)) * 2.0;","    dX1Y1.gb = (dX1Y1.gb - step(0.5, dX1Y1.gb)) * 2.0;","    vec4 source = mix(mix(dX0Y0, dX1Y0, frac.x), mix(dX0Y1, dX1Y1, frac.x), frac.y);","    source.gb = source.gb * 0.5 + step(0.0, -source.gb);","    gl_FragColor = source;","}"].join("\n")},Fire.ProjectionShader1={uniforms:{oneOverWidth:{value:null},oneOverHeight:{value:null},densityMap:{value:null}},vertexShader:["varying vec2 vUv;","void main() {"," \t  vUv = uv;","     vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","     gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform float oneOverWidth;","uniform float oneOverHeight;","uniform sampler2D densityMap;","varying vec2 vUv;","void main() {","    float dL = texture2D( densityMap, vec2(vUv.x - oneOverWidth, vUv.y) ).g;","    float dR = texture2D( densityMap, vec2(vUv.x + oneOverWidth, vUv.y) ).g;","    float dU = texture2D( densityMap, vec2(vUv.x, vUv.y - oneOverHeight) ).b;","    float dD = texture2D( densityMap, vec2(vUv.x, vUv.y + oneOverHeight) ).b;","    dL = (dL - step(0.5, dL)) * 2.0;","    dR = (dR - step(0.5, dR)) * 2.0;","    dU = (dU - step(0.5, dU)) * 2.0;","    dD = (dD - step(0.5, dD)) * 2.0;","    float h = (oneOverWidth + oneOverHeight) * 0.5;","    float div = -0.5 * h * (dR - dL + dD - dU);","    gl_FragColor = vec4( 0.0, 0.0, div * 0.5 + step(0.0, -div), 0.0);","}"].join("\n")},Fire.ProjectionShader2={uniforms:{oneOverWidth:{value:null},oneOverHeight:{value:null},densityMap:{value:null}},vertexShader:["varying vec2 vUv;","void main() {"," \t  vUv = uv;","     vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","     gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform float oneOverWidth;","uniform float oneOverHeight;","uniform sampler2D densityMap;","varying vec2 vUv;","void main() {","    float div = texture2D( densityMap, vUv ).b;","    float pL = texture2D( densityMap, vec2(vUv.x - oneOverWidth, vUv.y) ).g;","    float pR = texture2D( densityMap, vec2(vUv.x + oneOverWidth, vUv.y) ).g;","    float pU = texture2D( densityMap, vec2(vUv.x, vUv.y - oneOverHeight) ).g;","    float pD = texture2D( densityMap, vec2(vUv.x, vUv.y + oneOverHeight) ).g;","    float divNorm = (div - step(0.5, div)) * 2.0;","    pL = (pL - step(0.5, pL)) * 2.0;","    pR = (pR - step(0.5, pR)) * 2.0;","    pU = (pU - step(0.5, pU)) * 2.0;","    pD = (pD - step(0.5, pD)) * 2.0;","    float p = (divNorm + pR + pL + pD + pU) * 0.25;","    gl_FragColor = vec4( 0.0, p * 0.5 + step(0.0, -p), div, 0.0);","}"].join("\n")},Fire.ProjectionShader3={uniforms:{oneOverWidth:{value:null},oneOverHeight:{value:null},densityMap:{value:null},projMap:{value:null}},vertexShader:["varying vec2 vUv;","void main() {"," \t  vUv = uv;","     vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","     gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform float oneOverWidth;","uniform float oneOverHeight;","uniform sampler2D densityMap;","uniform sampler2D projMap;","varying vec2 vUv;","void main() {","    vec4 orig = texture2D(densityMap, vUv);","    float pL = texture2D( projMap, vec2(vUv.x - oneOverWidth, vUv.y) ).g;","    float pR = texture2D( projMap, vec2(vUv.x + oneOverWidth, vUv.y) ).g;","    float pU = texture2D( projMap, vec2(vUv.x, vUv.y - oneOverHeight) ).g;","    float pD = texture2D( projMap, vec2(vUv.x, vUv.y + oneOverHeight) ).g;","    float uNorm = (orig.g - step(0.5, orig.g)) * 2.0;","    float vNorm = (orig.b - step(0.5, orig.b)) * 2.0;","    pL = (pL - step(0.5, pL)) * 2.0;","    pR = (pR - step(0.5, pR)) * 2.0;","    pU = (pU - step(0.5, pU)) * 2.0;","    pD = (pD - step(0.5, pD)) * 2.0;","    float h = (oneOverWidth + oneOverHeight) * 0.5;","    float u = uNorm - (0.5 * (pR - pL) / h);","    float v = vNorm - (0.5 * (pD - pU) / h);","    gl_FragColor = vec4( orig.r, u * 0.5 + step(0.0, -u), v * 0.5 + step(0.0, -v), orig.a);","}"].join("\n")},Fire.ColorShader={uniforms:{color1:{value:null},color2:{value:null},color3:{value:null},colorBias:{value:null},densityMap:{value:null}},vertexShader:["varying vec2 vUv;","void main() {"," \t  vUv = uv;","     vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","     gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform vec3 color1;","uniform vec3 color2;","uniform vec3 color3;","uniform float colorBias;","uniform sampler2D densityMap;","varying vec2 vUv;","void main() {","    float density = texture2D( densityMap, vUv ).a;","    float temperature = texture2D( densityMap, vUv ).r;","    float bias = clamp(colorBias, 0.0001, 0.9999);","    vec3 blend1 = mix(color3, color2, temperature / bias) * (1.0 - step(bias, temperature));","    vec3 blend2 = mix(color2, color1, (temperature - bias) / (1.0 - bias) ) * step(bias, temperature);","    gl_FragColor = vec4(blend1 + blend2, density);","}"].join("\n")},Fire.DebugShader={uniforms:{color1:{value:null},color2:{value:null},color3:{value:null},colorBias:{value:null},densityMap:{value:null}},vertexShader:["varying vec2 vUv;","void main() {"," \t  vUv = uv;","     vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","     gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform sampler2D densityMap;","varying vec2 vUv;","void main() {","    float density;","    density = texture2D( densityMap, vUv ).a;","    vec2 vel = texture2D( densityMap, vUv ).gb;","    vel = (vel - step(0.5, vel)) * 2.0;","    float r = density;","    float g = max(abs(vel.x), density * 0.5);","    float b = max(abs(vel.y), density * 0.5);","    float a = max(density * 0.5, max(abs(vel.x), abs(vel.y)));","    gl_FragColor = vec4(r, g, b, a);","}"].join("\n")};var _vector$7=new Vector2;function Box2(s,e){this.min=void 0!==s?s:new Vector2(1/0,1/0),this.max=void 0!==e?e:new Vector2(-1/0,-1/0)}Object.assign(Box2.prototype,{set:function(e,a){return this.min.copy(e),this.max.copy(a),this},setFromPoints:function(e){this.makeEmpty();for(var a=0,d=e.length;a<d;a++)this.expandByPoint(e[a]);return this},setFromCenterAndSize:function(e,a){var d=_vector$7.copy(a).multiplyScalar(.5);return this.min.copy(e).sub(d),this.max.copy(e).add(d),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return void 0===e&&(console.warn("Box2: .getCenter() target is now required"),e=new Vector2),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("Box2: .getSize() target is now required"),e=new Vector2),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,a){return void 0===a&&(console.warn("Box2: .getParameter() target is now required"),a=new Vector2),a.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,a){return void 0===a&&(console.warn("Box2: .clampPoint() target is now required"),a=new Vector2),a.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return _vector$7.copy(e).clamp(this.min,this.max).sub(e).length()},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var Lensflare=function s(){Mesh.call(this,s.Geometry,new MeshBasicMaterial({opacity:0,transparent:!0})),this.type="Lensflare",this.frustumCulled=!1,this.renderOrder=1/0;var e=new Vector3,a=new Vector3,d=new DataTexture(new Uint8Array(768),16,16,RGBFormat);d.minFilter=NearestFilter,d.magFilter=NearestFilter,d.wrapS=ClampToEdgeWrapping,d.wrapT=ClampToEdgeWrapping;var v=new DataTexture(new Uint8Array(768),16,16,RGBFormat);v.minFilter=NearestFilter,v.magFilter=NearestFilter,v.wrapS=ClampToEdgeWrapping,v.wrapT=ClampToEdgeWrapping;var g=s.Geometry,C=new RawShaderMaterial({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","attribute vec3 position;","void main() {","\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","void main() {","\tgl_FragColor = vec4( 1.0, 0.0, 1.0, 1.0 );","}"].join("\n"),depthTest:!0,depthWrite:!1,transparent:!1}),w=new RawShaderMaterial({uniforms:{map:{value:d},scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","attribute vec3 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","\tvUV = uv;","\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","uniform sampler2D map;","varying vec2 vUV;","void main() {","\tgl_FragColor = texture2D( map, vUV );","}"].join("\n"),depthTest:!1,depthWrite:!1,transparent:!1}),_=new Mesh(g,C),x=[],b=LensflareElement.Shader,A=new RawShaderMaterial({uniforms:{map:{value:null},occlusionMap:{value:v},color:{value:new Color(16777215)},scale:{value:new Vector2},screenPosition:{value:new Vector3}},vertexShader:b.vertexShader,fragmentShader:b.fragmentShader,blending:AdditiveBlending,transparent:!0,depthWrite:!1}),E=new Mesh(g,A);this.addElement=function(L){x.push(L)};var R=new Vector2,O=new Vector2,D=new Box2,F=new Vector4;this.onBeforeRender=function(L,I,V){L.getCurrentViewport(F);var H=F.z/2,X=F.w/2;if(R.set((re=16/F.w)*(F.w/F.z),re),D.min.set(F.x,F.y),D.max.set(F.x+(F.z-16),F.y+(F.w-16)),a.setFromMatrixPosition(this.matrixWorld),a.applyMatrix4(V.matrixWorldInverse),!(a.z>0)&&(e.copy(a).applyMatrix4(V.projectionMatrix),O.x=F.x+e.x*H+H-8,O.y=F.y+e.y*X+X-8,D.containsPoint(O))){L.copyFramebufferToTexture(O,d),(j=C.uniforms).scale.value=R,j.screenPosition.value=e,L.renderBufferDirect(V,null,g,C,_,null),L.copyFramebufferToTexture(O,v),(j=w.uniforms).scale.value=R,j.screenPosition.value=e,L.renderBufferDirect(V,null,g,w,_,null);for(var te=2*-e.x,J=2*-e.y,k=0,U=x.length;k<U;k++){var j,re,K=x[k];(j=A.uniforms).color.value.copy(K.color),j.map.value=K.texture,j.screenPosition.value.x=e.x+te*K.distance,j.screenPosition.value.y=e.y+J*K.distance,j.scale.value.set((re=K.size/F.w)*(F.w/F.z),re),A.uniformsNeedUpdate=!0,L.renderBufferDirect(V,null,g,A,E,null)}}},this.dispose=function(){C.dispose(),w.dispose(),A.dispose(),d.dispose(),v.dispose();for(var L=0,I=x.length;L<I;L++)x[L].texture.dispose()}};Lensflare.prototype=Object.create(Mesh.prototype),Lensflare.prototype.constructor=Lensflare,Lensflare.prototype.isLensflare=!0;var LensflareElement=function(e,a,d,v){this.texture=e,this.size=a||1,this.distance=d||0,this.color=v||new Color(16777215)};LensflareElement.Shader={uniforms:{map:{value:null},occlusionMap:{value:null},color:{value:null},scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform sampler2D occlusionMap;","attribute vec3 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","\tvUV = uv;","\tvec2 pos = position.xy;","\tvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","\tvVisibility =        visibility.r / 9.0;","\tvVisibility *= 1.0 - visibility.g / 9.0;","\tvVisibility *=       visibility.b / 9.0;","\tgl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","uniform sampler2D map;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","\tvec4 texture = texture2D( map, vUV );","\ttexture.a *= vVisibility;","\tgl_FragColor = texture;","\tgl_FragColor.rgb *= color;","}"].join("\n")},Lensflare.Geometry=function(){var s=new BufferGeometry,a=new InterleavedBuffer(new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,1,1,0,1,1,-1,1,0,0,1]),5);return s.setIndex([0,1,2,0,2,3]),s.setAttribute("position",new InterleavedBufferAttribute(a,3,0,!1)),s.setAttribute("uv",new InterleavedBufferAttribute(a,2,3,!1)),s}();var LightningStorm=function(e){Object3D.call(this),this.stormParams=e=e||{},e.size=void 0!==e.size?e.size:1e3,e.minHeight=void 0!==e.minHeight?e.minHeight:80,e.maxHeight=void 0!==e.maxHeight?e.maxHeight:100,e.maxSlope=void 0!==e.maxSlope?e.maxSlope:1.1,e.maxLightnings=void 0!==e.maxLightnings?e.maxLightnings:3,e.lightningMinPeriod=void 0!==e.lightningMinPeriod?e.lightningMinPeriod:3,e.lightningMaxPeriod=void 0!==e.lightningMaxPeriod?e.lightningMaxPeriod:7,e.lightningMinDuration=void 0!==e.lightningMinDuration?e.lightningMinDuration:1,e.lightningMaxDuration=void 0!==e.lightningMaxDuration?e.lightningMaxDuration:2.5,this.lightningParameters=LightningStrike.copyParameters(e.lightningParameters,e.lightningParameters),this.lightningParameters.isEternal=!1,this.lightningMaterial=void 0!==e.lightningMaterial?e.lightningMaterial:new MeshBasicMaterial({color:11599871}),this.onRayPosition=void 0!==e.onRayPosition?e.onRayPosition:function(g,C){C.set((Math.random()-.5)*e.size,0,(Math.random()-.5)*e.size);var w=MathUtils.lerp(e.minHeight,e.maxHeight,Math.random());g.set(e.maxSlope*(2*Math.random()-1),1,e.maxSlope*(2*Math.random()-1)).multiplyScalar(w).add(C)},this.onLightningDown=e.onLightningDown,this.inited=!1,this.nextLightningTime=0,this.lightningsMeshes=[],this.deadLightningsMeshes=[];for(var a=0;a<this.stormParams.maxLightnings;a++){var v=new Mesh(new LightningStrike(LightningStrike.copyParameters({},this.lightningParameters)),this.lightningMaterial);this.deadLightningsMeshes.push(v)}};function ImmediateRenderObject(s){Object3D.call(this),this.material=s,this.render=function(){}}LightningStorm.prototype=Object.create(Object3D.prototype),LightningStorm.prototype.constructor=LightningStorm,LightningStorm.prototype.isLightningStorm=!0,LightningStorm.prototype.update=function(s){if(this.inited||(this.nextLightningTime=this.getNextLightningTime(s)*Math.random(),this.inited=!0),s>=this.nextLightningTime){var e=this.deadLightningsMeshes.pop();if(e){var a=LightningStrike.copyParameters(e.geometry.rayParameters,this.lightningParameters);a.birthTime=s,a.deathTime=s+MathUtils.lerp(this.stormParams.lightningMinDuration,this.stormParams.lightningMaxDuration,Math.random()),this.onRayPosition(a.sourceOffset,a.destOffset),a.noiseSeed=Math.random(),this.add(e),this.lightningsMeshes.push(e)}this.nextLightningTime=this.getNextLightningTime(s)}for(var d=0,v=this.lightningsMeshes.length;d<v;){var g=this.lightningsMeshes[d],C=g.geometry,w=C.state;C.update(s),w===LightningStrike.RAY_PROPAGATING&&C.state>w&&this.onLightningDown&&this.onLightningDown(C),C.state===LightningStrike.RAY_EXTINGUISHED?(this.lightningsMeshes.splice(this.lightningsMeshes.indexOf(g),1),this.deadLightningsMeshes.push(g),this.remove(g),v--):d++}},LightningStorm.prototype.getNextLightningTime=function(s){return s+MathUtils.lerp(this.stormParams.lightningMinPeriod,this.stormParams.lightningMaxPeriod,Math.random())/(this.stormParams.maxLightnings+1)},LightningStorm.prototype.copy=function(s){return Object3D.prototype.copy.call(this,s),this.stormParams.size=s.stormParams.size,this.stormParams.minHeight=s.stormParams.minHeight,this.stormParams.maxHeight=s.stormParams.maxHeight,this.stormParams.maxSlope=s.stormParams.maxSlope,this.stormParams.maxLightnings=s.stormParams.maxLightnings,this.stormParams.lightningMinPeriod=s.stormParams.lightningMinPeriod,this.stormParams.lightningMaxPeriod=s.stormParams.lightningMaxPeriod,this.stormParams.lightningMinDuration=s.stormParams.lightningMinDuration,this.stormParams.lightningMaxDuration=s.stormParams.lightningMaxDuration,this.lightningParameters=LightningStrike.copyParameters({},s.lightningParameters),this.lightningMaterial=s.stormParams.lightningMaterial,this.onLightningDown=s.onLightningDown,this},LightningStrike.prototype.clone=function(){return new this.constructor(this.stormParams).copy(this)},ImmediateRenderObject.prototype=Object.create(Object3D.prototype),ImmediateRenderObject.prototype.constructor=ImmediateRenderObject,ImmediateRenderObject.prototype.isImmediateRenderObject=!0;var MarchingCubes=function(e,a,d,v){ImmediateRenderObject.call(this,a);var g=this,C=new Float32Array(36),w=new Float32Array(36),_=new Float32Array(36);function x(L,I,V){return L+(I-L)*V}function b(L,I,V,z,H,X,re,j,te,J){var k=(V-re)/(j-re),U=g.normal_cache;C[I+0]=z+k*g.delta,C[I+1]=H,C[I+2]=X,w[I+0]=x(U[L+0],U[L+3],k),w[I+1]=x(U[L+1],U[L+4],k),w[I+2]=x(U[L+2],U[L+5],k),_[I+0]=x(g.palette[3*te+0],g.palette[3*J+0],k),_[I+1]=x(g.palette[3*te+1],g.palette[3*J+1],k),_[I+2]=x(g.palette[3*te+2],g.palette[3*J+2],k)}function A(L,I,V,z,H,X,re,j,te,J){var k=(V-re)/(j-re),U=g.normal_cache;C[I+0]=z,C[I+1]=H+k*g.delta,C[I+2]=X;var K=L+3*g.yd;w[I+0]=x(U[L+0],U[K+0],k),w[I+1]=x(U[L+1],U[K+1],k),w[I+2]=x(U[L+2],U[K+2],k),_[I+0]=x(g.palette[3*te+0],g.palette[3*J+0],k),_[I+1]=x(g.palette[3*te+1],g.palette[3*J+1],k),_[I+2]=x(g.palette[3*te+2],g.palette[3*J+2],k)}function E(L,I,V,z,H,X,re,j,te,J){var k=(V-re)/(j-re),U=g.normal_cache;C[I+0]=z,C[I+1]=H,C[I+2]=X+k*g.delta;var K=L+3*g.zd;w[I+0]=x(U[L+0],U[K+0],k),w[I+1]=x(U[L+1],U[K+1],k),w[I+2]=x(U[L+2],U[K+2],k),_[I+0]=x(g.palette[3*te+0],g.palette[3*J+0],k),_[I+1]=x(g.palette[3*te+1],g.palette[3*J+1],k),_[I+2]=x(g.palette[3*te+2],g.palette[3*J+2],k)}function R(L){var I=3*L;0===g.normal_cache[I]&&(g.normal_cache[I+0]=g.field[L-1]-g.field[L+1],g.normal_cache[I+1]=g.field[L-g.yd]-g.field[L+g.yd],g.normal_cache[I+2]=g.field[L-g.zd]-g.field[L+g.zd])}function O(L,I,V,z,H,X){var re=z+1,j=z+g.yd,te=z+g.zd,J=re+g.yd,k=re+g.zd,U=z+g.yd+g.zd,K=re+g.yd+g.zd,ee=0,Q=g.field[z],oe=g.field[re],me=g.field[j],fe=g.field[J],ge=g.field[te],$=g.field[k],ue=g.field[U],Y=g.field[K];Q<H&&(ee|=1),oe<H&&(ee|=2),me<H&&(ee|=8),fe<H&&(ee|=4),ge<H&&(ee|=16),$<H&&(ee|=32),ue<H&&(ee|=128),Y<H&&(ee|=64);var Z=edgeTable[ee];if(0===Z)return 0;var se=g.delta,ve=L+se,le=I+se,_e=V+se;1&Z&&(R(z),R(re),b(3*z,0,H,L,I,V,Q,oe,z,re)),2&Z&&(R(re),R(J),A(3*re,3,H,ve,I,V,oe,fe,re,J)),4&Z&&(R(j),R(J),b(3*j,6,H,L,le,V,me,fe,j,J)),8&Z&&(R(z),R(j),A(3*z,9,H,L,I,V,Q,me,z,j)),16&Z&&(R(te),R(k),b(3*te,12,H,L,I,_e,ge,$,te,k)),32&Z&&(R(k),R(K),A(3*k,15,H,ve,I,_e,$,Y,k,K)),64&Z&&(R(U),R(K),b(3*U,18,H,L,le,_e,ue,Y,U,K)),128&Z&&(R(te),R(U),A(3*te,21,H,L,I,_e,ge,ue,te,U)),256&Z&&(R(z),R(te),E(3*z,24,H,L,I,V,Q,ge,z,te)),512&Z&&(R(re),R(k),E(3*re,27,H,ve,I,V,oe,$,re,k)),1024&Z&&(R(J),R(K),E(3*J,30,H,ve,le,V,fe,Y,J,K)),2048&Z&&(R(j),R(U),E(3*j,33,H,L,le,V,me,ue,j,U)),ee<<=4;for(var ae,ce=0,Te=0;-1!=triTable[ee+Te];)D(C,w,_,3*triTable[ae=ee+Te],3*triTable[ae+1],3*triTable[ae+2],X),Te+=3,ce++;return ce}function D(L,I,V,z,H,X,re){var j=3*g.count;if(g.positionArray[j+0]=L[z],g.positionArray[j+1]=L[z+1],g.positionArray[j+2]=L[z+2],g.positionArray[j+3]=L[H],g.positionArray[j+4]=L[H+1],g.positionArray[j+5]=L[H+2],g.positionArray[j+6]=L[X],g.positionArray[j+7]=L[X+1],g.positionArray[j+8]=L[X+2],!0===g.material.flatShading){var te=(I[z+0]+I[H+0]+I[X+0])/3,J=(I[z+1]+I[H+1]+I[X+1])/3,k=(I[z+2]+I[H+2]+I[X+2])/3;g.normalArray[j+0]=te,g.normalArray[j+1]=J,g.normalArray[j+2]=k,g.normalArray[j+3]=te,g.normalArray[j+4]=J,g.normalArray[j+5]=k,g.normalArray[j+6]=te,g.normalArray[j+7]=J,g.normalArray[j+8]=k}else g.normalArray[j+0]=I[z+0],g.normalArray[j+1]=I[z+1],g.normalArray[j+2]=I[z+2],g.normalArray[j+3]=I[H+0],g.normalArray[j+4]=I[H+1],g.normalArray[j+5]=I[H+2],g.normalArray[j+6]=I[X+0],g.normalArray[j+7]=I[X+1],g.normalArray[j+8]=I[X+2];if(g.enableUvs){var U=2*g.count;g.uvArray[U+0]=L[z+0],g.uvArray[U+1]=L[z+2],g.uvArray[U+2]=L[H+0],g.uvArray[U+3]=L[H+2],g.uvArray[U+4]=L[X+0],g.uvArray[U+5]=L[X+2]}g.enableColors&&(g.colorArray[j+0]=V[z+0],g.colorArray[j+1]=V[z+1],g.colorArray[j+2]=V[z+2],g.colorArray[j+3]=V[H+0],g.colorArray[j+4]=V[H+1],g.colorArray[j+5]=V[H+2],g.colorArray[j+6]=V[X+0],g.colorArray[j+7]=V[X+1],g.colorArray[j+8]=V[X+2]),g.count+=3,g.count>=g.maxCount-3&&(g.hasPositions=!0,g.hasNormals=!0,g.enableUvs&&(g.hasUvs=!0),g.enableColors&&(g.hasColors=!0),re(g))}function F(L,I,V){var z=new Float32Array(L.length+V);return z.set(L,0),z.set(I.slice(0,V),L.length),z}this.enableUvs=void 0!==d&&d,this.enableColors=void 0!==v&&v,this.init=function(L){this.resolution=L,this.isolation=80,this.size=L,this.size2=this.size*this.size,this.size3=this.size2*this.size,this.halfsize=this.size/2,this.delta=2/this.size,this.yd=this.size,this.zd=this.size2,this.field=new Float32Array(this.size3),this.normal_cache=new Float32Array(3*this.size3),this.palette=new Float32Array(3*this.size3),this.maxCount=4096,this.count=0,this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=new Float32Array(3*this.maxCount),this.normalArray=new Float32Array(3*this.maxCount),this.enableUvs&&(this.uvArray=new Float32Array(2*this.maxCount)),this.enableColors&&(this.colorArray=new Float32Array(3*this.maxCount))},this.begin=function(){this.count=0,this.hasPositions=!1,this.hasNormals=!1,this.hasUvs=!1,this.hasColors=!1},this.end=function(L){if(0!==this.count){for(var I=3*this.count;I<this.positionArray.length;I++)this.positionArray[I]=0;this.hasPositions=!0,this.hasNormals=!0,this.enableUvs&&this.material.map&&(this.hasUvs=!0),this.enableColors&&this.material.vertexColors!==NoColors&&(this.hasColors=!0),L(this)}},this.addBall=function(L,I,V,z,H,X){var re=Math.sign(z);z=Math.abs(z);var j=null!=X,te=new Color(L,I,V);if(j)try{te=X instanceof Color?X:Array.isArray(X)?new Color(Math.min(Math.abs(X[0]),1),Math.min(Math.abs(X[1]),1),Math.min(Math.abs(X[2]),1)):new Color(X)}catch(be){te=new Color(L,I,V)}var J=this.size*Math.sqrt(z/H),k=V*this.size,U=I*this.size,K=L*this.size,ee=Math.floor(k-J);ee<1&&(ee=1);var Q=Math.floor(k+J);Q>this.size-1&&(Q=this.size-1);var oe=Math.floor(U-J);oe<1&&(oe=1);var me=Math.floor(U+J);me>this.size-1&&(me=this.size-1);var fe=Math.floor(K-J);fe<1&&(fe=1);var $,ue,Y,Z,se,ve,le,_e,ae,pe,he,ge=Math.floor(K+J);for(ge>this.size-1&&(ge=this.size-1),Y=ee;Y<Q;Y++)for(se=this.size2*Y,ae=(_e=Y/this.size-V)*_e,ue=oe;ue<me;ue++)for(Z=se+this.size*ue,pe=(le=ue/this.size-I)*le,$=fe;$<ge;$++)if((he=z/(1e-6+(ve=$/this.size-L)*ve+pe+ae)-H)>0){this.field[Z+$]+=he*re;var ce=Math.sqrt(($-K)*($-K)+(ue-U)*(ue-U)+(Y-k)*(Y-k))/J,Te=1-ce*ce*ce*(ce*(6*ce-15)+10);this.palette[3*(Z+$)+0]+=te.r*Te,this.palette[3*(Z+$)+1]+=te.g*Te,this.palette[3*(Z+$)+2]+=te.b*Te}},this.addPlaneX=function(L,I){var V,z,H,re,j,te,J=this.size,k=this.yd,U=this.zd,K=this.field,ee=J*Math.sqrt(L/I);for(ee>J&&(ee=J),V=0;V<ee;V++)if((re=L/(1e-4+(j=V/J)*j)-I)>0)for(z=0;z<J;z++)for(te=V+z*k,H=0;H<J;H++)K[U*H+te]+=re},this.addPlaneY=function(L,I){var V,z,H,re,j,te,J,k=this.size,U=this.yd,K=this.zd,ee=this.field,Q=k*Math.sqrt(L/I);for(Q>k&&(Q=k),z=0;z<Q;z++)if((re=L/(1e-4+(j=z/k)*j)-I)>0)for(te=z*U,V=0;V<k;V++)for(J=te+V,H=0;H<k;H++)ee[K*H+J]+=re},this.addPlaneZ=function(L,I){var V,z,H,re,j,te,J,k=this.size,U=this.yd,K=this.zd,ee=this.field,Q=k*Math.sqrt(L/I);for(Q>k&&(Q=k),H=0;H<Q;H++)if((re=L/(1e-4+(j=H/k)*j)-I)>0)for(te=K*H,z=0;z<k;z++)for(J=te+z*U,V=0;V<k;V++)ee[J+V]+=re},this.setCell=function(L,I,V,z){this.field[this.size2*V+this.size*I+L]=z},this.getCell=function(L,I,V){return this.field[this.size2*V+this.size*I+L]},this.blur=function(L){void 0===L&&(L=1);for(var I=this.field,V=I.slice(),z=this.size,H=this.size2,X=0;X<z;X++)for(var re=0;re<z;re++)for(var j=0;j<z;j++){for(var te=H*j+z*re+X,J=V[te],k=1,U=-1;U<=1;U+=2){var K=U+X;if(!(K<0||K>=z))for(var ee=-1;ee<=1;ee+=2){var Q=ee+re;if(!(Q<0||Q>=z))for(var oe=-1;oe<=1;oe+=2){var me=oe+j;me<0||me>=z||(J+=L*(V[H*me+z*Q+K]-J)/++k)}}}I[te]=J}},this.reset=function(){var L;for(L=0;L<this.size3;L++)this.normal_cache[3*L]=0,this.field[L]=0,this.palette[3*L]=this.palette[3*L+1]=this.palette[3*L+2]=0},this.render=function(L){this.begin();for(var I=this.size-2,V=1;V<I;V++)for(var z=this.size2*V,H=(V-this.halfsize)/this.halfsize,X=1;X<I;X++)for(var re=z+this.size*X,j=(X-this.halfsize)/this.halfsize,te=1;te<I;te++)O((te-this.halfsize)/this.halfsize,j,H,re+te,this.isolation,L);this.end(L)},this.generateGeometry=function(){return console.warn("MarchingCubes: generateGeometry() now returns BufferGeometry"),this.generateBufferGeometry()},this.generateBufferGeometry=function(){var L=new BufferGeometry,I=new Float32Array,V=new Float32Array,z=new Float32Array,H=new Float32Array,X=this;return this.render(function(te){X.hasPositions&&(I=F(I,te.positionArray,3*te.count)),X.hasNormals&&(V=F(V,te.normalArray,3*te.count)),X.hasColors&&(z=F(z,te.colorArray,3*te.count)),X.hasUvs&&(H=F(H,te.uvArray,2*te.count)),te.count=0}),this.hasPositions&&L.setAttribute("position",new BufferAttribute(I,3)),this.hasNormals&&L.setAttribute("normal",new BufferAttribute(V,3)),this.hasColors&&L.setAttribute("color",new BufferAttribute(z,3)),this.hasUvs&&L.setAttribute("uv",new BufferAttribute(H,2)),L},this.init(e)};MarchingCubes.prototype=Object.create(ImmediateRenderObject.prototype),MarchingCubes.prototype.constructor=MarchingCubes;var edgeTable=new Int32Array([0,265,515,778,1030,1295,1541,1804,2060,2309,2575,2822,3082,3331,3593,3840,400,153,915,666,1430,1183,1941,1692,2460,2197,2975,2710,3482,3219,3993,3728,560,825,51,314,1590,1855,1077,1340,2620,2869,2111,2358,3642,3891,3129,3376,928,681,419,170,1958,1711,1445,1196,2988,2725,2479,2214,4010,3747,3497,3232,1120,1385,1635,1898,102,367,613,876,3180,3429,3695,3942,2154,2403,2665,2912,1520,1273,2035,1786,502,255,1013,764,3580,3317,4095,3830,2554,2291,3065,2800,1616,1881,1107,1370,598,863,85,348,3676,3925,3167,3414,2650,2899,2137,2384,1984,1737,1475,1226,966,719,453,204,4044,3781,3535,3270,3018,2755,2505,2240,2240,2505,2755,3018,3270,3535,3781,4044,204,453,719,966,1226,1475,1737,1984,2384,2137,2899,2650,3414,3167,3925,3676,348,85,863,598,1370,1107,1881,1616,2800,3065,2291,2554,3830,4095,3317,3580,764,1013,255,502,1786,2035,1273,1520,2912,2665,2403,2154,3942,3695,3429,3180,876,613,367,102,1898,1635,1385,1120,3232,3497,3747,4010,2214,2479,2725,2988,1196,1445,1711,1958,170,419,681,928,3376,3129,3891,3642,2358,2111,2869,2620,1340,1077,1855,1590,314,51,825,560,3728,3993,3219,3482,2710,2975,2197,2460,1692,1941,1183,1430,666,915,153,400,3840,3593,3331,3082,2822,2575,2309,2060,1804,1541,1295,1030,778,515,265,0]),triTable=new Int32Array([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,9,8,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,2,10,0,2,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,8,3,2,10,8,10,9,8,-1,-1,-1,-1,-1,-1,-1,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,8,11,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,11,2,1,9,11,9,8,11,-1,-1,-1,-1,-1,-1,-1,3,10,1,11,10,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,10,1,0,8,10,8,11,10,-1,-1,-1,-1,-1,-1,-1,3,9,0,3,11,9,11,10,9,-1,-1,-1,-1,-1,-1,-1,9,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,7,3,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,1,9,4,7,1,7,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,8,4,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,4,7,3,0,4,1,2,10,-1,-1,-1,-1,-1,-1,-1,9,2,10,9,0,2,8,4,7,-1,-1,-1,-1,-1,-1,-1,2,10,9,2,9,7,2,7,3,7,9,4,-1,-1,-1,-1,8,4,7,3,11,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,4,7,11,2,4,2,0,4,-1,-1,-1,-1,-1,-1,-1,9,0,1,8,4,7,2,3,11,-1,-1,-1,-1,-1,-1,-1,4,7,11,9,4,11,9,11,2,9,2,1,-1,-1,-1,-1,3,10,1,3,11,10,7,8,4,-1,-1,-1,-1,-1,-1,-1,1,11,10,1,4,11,1,0,4,7,11,4,-1,-1,-1,-1,4,7,8,9,0,11,9,11,10,11,0,3,-1,-1,-1,-1,4,7,11,4,11,9,9,11,10,-1,-1,-1,-1,-1,-1,-1,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,5,4,1,5,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,5,4,8,3,5,3,1,5,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,10,4,9,5,-1,-1,-1,-1,-1,-1,-1,5,2,10,5,4,2,4,0,2,-1,-1,-1,-1,-1,-1,-1,2,10,5,3,2,5,3,5,4,3,4,8,-1,-1,-1,-1,9,5,4,2,3,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,11,2,0,8,11,4,9,5,-1,-1,-1,-1,-1,-1,-1,0,5,4,0,1,5,2,3,11,-1,-1,-1,-1,-1,-1,-1,2,1,5,2,5,8,2,8,11,4,8,5,-1,-1,-1,-1,10,3,11,10,1,3,9,5,4,-1,-1,-1,-1,-1,-1,-1,4,9,5,0,8,1,8,10,1,8,11,10,-1,-1,-1,-1,5,4,0,5,0,11,5,11,10,11,0,3,-1,-1,-1,-1,5,4,8,5,8,10,10,8,11,-1,-1,-1,-1,-1,-1,-1,9,7,8,5,7,9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,3,0,9,5,3,5,7,3,-1,-1,-1,-1,-1,-1,-1,0,7,8,0,1,7,1,5,7,-1,-1,-1,-1,-1,-1,-1,1,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,7,8,9,5,7,10,1,2,-1,-1,-1,-1,-1,-1,-1,10,1,2,9,5,0,5,3,0,5,7,3,-1,-1,-1,-1,8,0,2,8,2,5,8,5,7,10,5,2,-1,-1,-1,-1,2,10,5,2,5,3,3,5,7,-1,-1,-1,-1,-1,-1,-1,7,9,5,7,8,9,3,11,2,-1,-1,-1,-1,-1,-1,-1,9,5,7,9,7,2,9,2,0,2,7,11,-1,-1,-1,-1,2,3,11,0,1,8,1,7,8,1,5,7,-1,-1,-1,-1,11,2,1,11,1,7,7,1,5,-1,-1,-1,-1,-1,-1,-1,9,5,8,8,5,7,10,1,3,10,3,11,-1,-1,-1,-1,5,7,0,5,0,9,7,11,0,1,0,10,11,10,0,-1,11,10,0,11,0,3,10,5,0,8,0,7,5,7,0,-1,11,10,5,7,11,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,0,1,5,10,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,8,3,1,9,8,5,10,6,-1,-1,-1,-1,-1,-1,-1,1,6,5,2,6,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,6,5,1,2,6,3,0,8,-1,-1,-1,-1,-1,-1,-1,9,6,5,9,0,6,0,2,6,-1,-1,-1,-1,-1,-1,-1,5,9,8,5,8,2,5,2,6,3,2,8,-1,-1,-1,-1,2,3,11,10,6,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,0,8,11,2,0,10,6,5,-1,-1,-1,-1,-1,-1,-1,0,1,9,2,3,11,5,10,6,-1,-1,-1,-1,-1,-1,-1,5,10,6,1,9,2,9,11,2,9,8,11,-1,-1,-1,-1,6,3,11,6,5,3,5,1,3,-1,-1,-1,-1,-1,-1,-1,0,8,11,0,11,5,0,5,1,5,11,6,-1,-1,-1,-1,3,11,6,0,3,6,0,6,5,0,5,9,-1,-1,-1,-1,6,5,9,6,9,11,11,9,8,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,3,0,4,7,3,6,5,10,-1,-1,-1,-1,-1,-1,-1,1,9,0,5,10,6,8,4,7,-1,-1,-1,-1,-1,-1,-1,10,6,5,1,9,7,1,7,3,7,9,4,-1,-1,-1,-1,6,1,2,6,5,1,4,7,8,-1,-1,-1,-1,-1,-1,-1,1,2,5,5,2,6,3,0,4,3,4,7,-1,-1,-1,-1,8,4,7,9,0,5,0,6,5,0,2,6,-1,-1,-1,-1,7,3,9,7,9,4,3,2,9,5,9,6,2,6,9,-1,3,11,2,7,8,4,10,6,5,-1,-1,-1,-1,-1,-1,-1,5,10,6,4,7,2,4,2,0,2,7,11,-1,-1,-1,-1,0,1,9,4,7,8,2,3,11,5,10,6,-1,-1,-1,-1,9,2,1,9,11,2,9,4,11,7,11,4,5,10,6,-1,8,4,7,3,11,5,3,5,1,5,11,6,-1,-1,-1,-1,5,1,11,5,11,6,1,0,11,7,11,4,0,4,11,-1,0,5,9,0,6,5,0,3,6,11,6,3,8,4,7,-1,6,5,9,6,9,11,4,7,9,7,11,9,-1,-1,-1,-1,10,4,9,6,4,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,10,6,4,9,10,0,8,3,-1,-1,-1,-1,-1,-1,-1,10,0,1,10,6,0,6,4,0,-1,-1,-1,-1,-1,-1,-1,8,3,1,8,1,6,8,6,4,6,1,10,-1,-1,-1,-1,1,4,9,1,2,4,2,6,4,-1,-1,-1,-1,-1,-1,-1,3,0,8,1,2,9,2,4,9,2,6,4,-1,-1,-1,-1,0,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,3,2,8,2,4,4,2,6,-1,-1,-1,-1,-1,-1,-1,10,4,9,10,6,4,11,2,3,-1,-1,-1,-1,-1,-1,-1,0,8,2,2,8,11,4,9,10,4,10,6,-1,-1,-1,-1,3,11,2,0,1,6,0,6,4,6,1,10,-1,-1,-1,-1,6,4,1,6,1,10,4,8,1,2,1,11,8,11,1,-1,9,6,4,9,3,6,9,1,3,11,6,3,-1,-1,-1,-1,8,11,1,8,1,0,11,6,1,9,1,4,6,4,1,-1,3,11,6,3,6,0,0,6,4,-1,-1,-1,-1,-1,-1,-1,6,4,8,11,6,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,10,6,7,8,10,8,9,10,-1,-1,-1,-1,-1,-1,-1,0,7,3,0,10,7,0,9,10,6,7,10,-1,-1,-1,-1,10,6,7,1,10,7,1,7,8,1,8,0,-1,-1,-1,-1,10,6,7,10,7,1,1,7,3,-1,-1,-1,-1,-1,-1,-1,1,2,6,1,6,8,1,8,9,8,6,7,-1,-1,-1,-1,2,6,9,2,9,1,6,7,9,0,9,3,7,3,9,-1,7,8,0,7,0,6,6,0,2,-1,-1,-1,-1,-1,-1,-1,7,3,2,6,7,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,11,10,6,8,10,8,9,8,6,7,-1,-1,-1,-1,2,0,7,2,7,11,0,9,7,6,7,10,9,10,7,-1,1,8,0,1,7,8,1,10,7,6,7,10,2,3,11,-1,11,2,1,11,1,7,10,6,1,6,7,1,-1,-1,-1,-1,8,9,6,8,6,7,9,1,6,11,6,3,1,3,6,-1,0,9,1,11,6,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,8,0,7,0,6,3,11,0,11,6,0,-1,-1,-1,-1,7,11,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,8,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,1,9,11,7,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,1,9,8,3,1,11,7,6,-1,-1,-1,-1,-1,-1,-1,10,1,2,6,11,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,8,6,11,7,-1,-1,-1,-1,-1,-1,-1,2,9,0,2,10,9,6,11,7,-1,-1,-1,-1,-1,-1,-1,6,11,7,2,10,3,10,8,3,10,9,8,-1,-1,-1,-1,7,2,3,6,2,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,7,0,8,7,6,0,6,2,0,-1,-1,-1,-1,-1,-1,-1,2,7,6,2,3,7,0,1,9,-1,-1,-1,-1,-1,-1,-1,1,6,2,1,8,6,1,9,8,8,7,6,-1,-1,-1,-1,10,7,6,10,1,7,1,3,7,-1,-1,-1,-1,-1,-1,-1,10,7,6,1,7,10,1,8,7,1,0,8,-1,-1,-1,-1,0,3,7,0,7,10,0,10,9,6,10,7,-1,-1,-1,-1,7,6,10,7,10,8,8,10,9,-1,-1,-1,-1,-1,-1,-1,6,8,4,11,8,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,6,11,3,0,6,0,4,6,-1,-1,-1,-1,-1,-1,-1,8,6,11,8,4,6,9,0,1,-1,-1,-1,-1,-1,-1,-1,9,4,6,9,6,3,9,3,1,11,3,6,-1,-1,-1,-1,6,8,4,6,11,8,2,10,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,3,0,11,0,6,11,0,4,6,-1,-1,-1,-1,4,11,8,4,6,11,0,2,9,2,10,9,-1,-1,-1,-1,10,9,3,10,3,2,9,4,3,11,3,6,4,6,3,-1,8,2,3,8,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,0,4,2,4,6,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,9,0,2,3,4,2,4,6,4,3,8,-1,-1,-1,-1,1,9,4,1,4,2,2,4,6,-1,-1,-1,-1,-1,-1,-1,8,1,3,8,6,1,8,4,6,6,10,1,-1,-1,-1,-1,10,1,0,10,0,6,6,0,4,-1,-1,-1,-1,-1,-1,-1,4,6,3,4,3,8,6,10,3,0,3,9,10,9,3,-1,10,9,4,6,10,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,5,7,6,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,5,11,7,6,-1,-1,-1,-1,-1,-1,-1,5,0,1,5,4,0,7,6,11,-1,-1,-1,-1,-1,-1,-1,11,7,6,8,3,4,3,5,4,3,1,5,-1,-1,-1,-1,9,5,4,10,1,2,7,6,11,-1,-1,-1,-1,-1,-1,-1,6,11,7,1,2,10,0,8,3,4,9,5,-1,-1,-1,-1,7,6,11,5,4,10,4,2,10,4,0,2,-1,-1,-1,-1,3,4,8,3,5,4,3,2,5,10,5,2,11,7,6,-1,7,2,3,7,6,2,5,4,9,-1,-1,-1,-1,-1,-1,-1,9,5,4,0,8,6,0,6,2,6,8,7,-1,-1,-1,-1,3,6,2,3,7,6,1,5,0,5,4,0,-1,-1,-1,-1,6,2,8,6,8,7,2,1,8,4,8,5,1,5,8,-1,9,5,4,10,1,6,1,7,6,1,3,7,-1,-1,-1,-1,1,6,10,1,7,6,1,0,7,8,7,0,9,5,4,-1,4,0,10,4,10,5,0,3,10,6,10,7,3,7,10,-1,7,6,10,7,10,8,5,4,10,4,8,10,-1,-1,-1,-1,6,9,5,6,11,9,11,8,9,-1,-1,-1,-1,-1,-1,-1,3,6,11,0,6,3,0,5,6,0,9,5,-1,-1,-1,-1,0,11,8,0,5,11,0,1,5,5,6,11,-1,-1,-1,-1,6,11,3,6,3,5,5,3,1,-1,-1,-1,-1,-1,-1,-1,1,2,10,9,5,11,9,11,8,11,5,6,-1,-1,-1,-1,0,11,3,0,6,11,0,9,6,5,6,9,1,2,10,-1,11,8,5,11,5,6,8,0,5,10,5,2,0,2,5,-1,6,11,3,6,3,5,2,10,3,10,5,3,-1,-1,-1,-1,5,8,9,5,2,8,5,6,2,3,8,2,-1,-1,-1,-1,9,5,6,9,6,0,0,6,2,-1,-1,-1,-1,-1,-1,-1,1,5,8,1,8,0,5,6,8,3,8,2,6,2,8,-1,1,5,6,2,1,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,6,1,6,10,3,8,6,5,6,9,8,9,6,-1,10,1,0,10,0,6,9,5,0,5,6,0,-1,-1,-1,-1,0,3,8,5,6,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,10,5,6,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,7,5,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,11,5,10,11,7,5,8,3,0,-1,-1,-1,-1,-1,-1,-1,5,11,7,5,10,11,1,9,0,-1,-1,-1,-1,-1,-1,-1,10,7,5,10,11,7,9,8,1,8,3,1,-1,-1,-1,-1,11,1,2,11,7,1,7,5,1,-1,-1,-1,-1,-1,-1,-1,0,8,3,1,2,7,1,7,5,7,2,11,-1,-1,-1,-1,9,7,5,9,2,7,9,0,2,2,11,7,-1,-1,-1,-1,7,5,2,7,2,11,5,9,2,3,2,8,9,8,2,-1,2,5,10,2,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,8,2,0,8,5,2,8,7,5,10,2,5,-1,-1,-1,-1,9,0,1,5,10,3,5,3,7,3,10,2,-1,-1,-1,-1,9,8,2,9,2,1,8,7,2,10,2,5,7,5,2,-1,1,3,5,3,7,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,8,7,0,7,1,1,7,5,-1,-1,-1,-1,-1,-1,-1,9,0,3,9,3,5,5,3,7,-1,-1,-1,-1,-1,-1,-1,9,8,7,5,9,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,5,8,4,5,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,5,0,4,5,11,0,5,10,11,11,3,0,-1,-1,-1,-1,0,1,9,8,4,10,8,10,11,10,4,5,-1,-1,-1,-1,10,11,4,10,4,5,11,3,4,9,4,1,3,1,4,-1,2,5,1,2,8,5,2,11,8,4,5,8,-1,-1,-1,-1,0,4,11,0,11,3,4,5,11,2,11,1,5,1,11,-1,0,2,5,0,5,9,2,11,5,4,5,8,11,8,5,-1,9,4,5,2,11,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,5,10,3,5,2,3,4,5,3,8,4,-1,-1,-1,-1,5,10,2,5,2,4,4,2,0,-1,-1,-1,-1,-1,-1,-1,3,10,2,3,5,10,3,8,5,4,5,8,0,1,9,-1,5,10,2,5,2,4,1,9,2,9,4,2,-1,-1,-1,-1,8,4,5,8,5,3,3,5,1,-1,-1,-1,-1,-1,-1,-1,0,4,5,1,0,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,8,4,5,8,5,3,9,0,5,0,3,5,-1,-1,-1,-1,9,4,5,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,11,7,4,9,11,9,10,11,-1,-1,-1,-1,-1,-1,-1,0,8,3,4,9,7,9,11,7,9,10,11,-1,-1,-1,-1,1,10,11,1,11,4,1,4,0,7,4,11,-1,-1,-1,-1,3,1,4,3,4,8,1,10,4,7,4,11,10,11,4,-1,4,11,7,9,11,4,9,2,11,9,1,2,-1,-1,-1,-1,9,7,4,9,11,7,9,1,11,2,11,1,0,8,3,-1,11,7,4,11,4,2,2,4,0,-1,-1,-1,-1,-1,-1,-1,11,7,4,11,4,2,8,3,4,3,2,4,-1,-1,-1,-1,2,9,10,2,7,9,2,3,7,7,4,9,-1,-1,-1,-1,9,10,7,9,7,4,10,2,7,8,7,0,2,0,7,-1,3,7,10,3,10,2,7,4,10,1,10,0,4,0,10,-1,1,10,2,8,7,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,7,1,3,-1,-1,-1,-1,-1,-1,-1,4,9,1,4,1,7,0,8,1,8,7,1,-1,-1,-1,-1,4,0,3,7,4,3,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,8,7,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,9,10,8,10,11,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,11,9,10,-1,-1,-1,-1,-1,-1,-1,0,1,10,0,10,8,8,10,11,-1,-1,-1,-1,-1,-1,-1,3,1,10,11,3,10,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,2,11,1,11,9,9,11,8,-1,-1,-1,-1,-1,-1,-1,3,0,9,3,9,11,1,2,9,2,11,9,-1,-1,-1,-1,0,2,11,8,0,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,2,11,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,10,8,9,-1,-1,-1,-1,-1,-1,-1,9,10,2,0,9,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,3,8,2,8,10,0,1,8,1,10,8,-1,-1,-1,-1,1,10,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,3,8,9,1,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,9,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,3,8,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]),Reflector=function s(e,a){Mesh.call(this,e),this.type="Reflector";var d=this,v=new Color(void 0!==(a=a||{}).color?a.color:8355711),g=a.textureWidth||512,C=a.textureHeight||512,w=a.clipBias||0,_=a.shader||s.ReflectorShader,x=void 0!==a.recursion?a.recursion:0,b=new Plane,A=new Vector3,E=new Vector3,R=new Vector3,O=new Matrix4,D=new Vector3(0,0,-1),F=new Vector4,L=new Vector3,I=new Vector3,V=new Vector4,z=new Matrix4,H=new PerspectiveCamera,re=new WebGLRenderTarget(g,C,{minFilter:LinearFilter,magFilter:LinearFilter,format:RGBFormat,stencilBuffer:!1});(!MathUtils.isPowerOfTwo(g)||!MathUtils.isPowerOfTwo(C))&&(re.texture.generateMipmaps=!1);var j=new ShaderMaterial({uniforms:UniformsUtils.clone(_.uniforms),fragmentShader:_.fragmentShader,vertexShader:_.vertexShader});j.uniforms.tDiffuse.value=re.texture,j.uniforms.color.value=v,j.uniforms.textureMatrix.value=z,this.material=j,this.onBeforeRender=function(te,J,k){if("recursion"in k.userData){if(k.userData.recursion===x)return;k.userData.recursion++}if(E.setFromMatrixPosition(d.matrixWorld),R.setFromMatrixPosition(k.matrixWorld),O.extractRotation(d.matrixWorld),A.set(0,0,1),A.applyMatrix4(O),L.subVectors(E,R),!(L.dot(A)>0)){L.reflect(A).negate(),L.add(E),O.extractRotation(k.matrixWorld),D.set(0,0,-1),D.applyMatrix4(O),D.add(R),I.subVectors(E,D),I.reflect(A).negate(),I.add(E),H.position.copy(L),H.up.set(0,1,0),H.up.applyMatrix4(O),H.up.reflect(A),H.lookAt(I),H.far=k.far,H.updateMatrixWorld(),H.projectionMatrix.copy(k.projectionMatrix),H.userData.recursion=0,z.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),z.multiply(H.projectionMatrix),z.multiply(H.matrixWorldInverse),z.multiply(d.matrixWorld),b.setFromNormalAndCoplanarPoint(A,E),b.applyMatrix4(H.matrixWorldInverse),F.set(b.normal.x,b.normal.y,b.normal.z,b.constant);var U=H.projectionMatrix;V.x=(Math.sign(F.x)+U.elements[8])/U.elements[0],V.y=(Math.sign(F.y)+U.elements[9])/U.elements[5],V.z=-1,V.w=(1+U.elements[10])/U.elements[14],F.multiplyScalar(2/F.dot(V)),U.elements[2]=F.x,U.elements[6]=F.y,U.elements[10]=F.z+1-w,U.elements[14]=F.w,d.visible=!1;var K=te.getRenderTarget(),ee=te.xr.enabled,Q=te.shadowMap.autoUpdate;te.xr.enabled=!1,te.shadowMap.autoUpdate=!1,te.setRenderTarget(re),te.clear(),te.render(J,H),te.xr.enabled=ee,te.shadowMap.autoUpdate=Q,te.setRenderTarget(K);var oe=k.viewport;void 0!==oe&&te.state.viewport(oe),d.visible=!0}},this.getRenderTarget=function(){return re}};Reflector.prototype=Object.create(Mesh.prototype),Reflector.prototype.constructor=Reflector,Reflector.ReflectorShader={uniforms:{color:{value:null},tDiffuse:{value:null},textureMatrix:{value:null}},vertexShader:["uniform mat4 textureMatrix;","varying vec4 vUv;","void main() {","\tvUv = textureMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","\tvec4 base = texture2DProj( tDiffuse, vUv );","\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")};var ReflectorRTT=function(e,a){Reflector.call(this,e,a),this.geometry.setDrawRange(0,0)};ReflectorRTT.prototype=Object.create(Reflector.prototype);var Refractor=function s(e,a){Mesh.call(this,e),this.type="Refractor";var d=this,v=new Color(void 0!==(a=a||{}).color?a.color:8355711),g=a.textureWidth||512,C=a.textureHeight||512,w=a.clipBias||0,_=a.shader||s.RefractorShader,x=new PerspectiveCamera;x.matrixAutoUpdate=!1,x.userData.refractor=!0;var b=new Plane,A=new Matrix4,R=new WebGLRenderTarget(g,C,{minFilter:LinearFilter,magFilter:LinearFilter,format:RGBFormat,stencilBuffer:!1});(!MathUtils.isPowerOfTwo(g)||!MathUtils.isPowerOfTwo(C))&&(R.texture.generateMipmaps=!1),this.material=new ShaderMaterial({uniforms:UniformsUtils.clone(_.uniforms),vertexShader:_.vertexShader,fragmentShader:_.fragmentShader,transparent:!0}),this.material.uniforms.color.value=v,this.material.uniforms.tDiffuse.value=R.texture,this.material.uniforms.textureMatrix.value=A;var V,z,H,X,re,O=(V=new Vector3,z=new Vector3,H=new Matrix4,X=new Vector3,re=new Vector3,function(te){return V.setFromMatrixPosition(d.matrixWorld),z.setFromMatrixPosition(te.matrixWorld),X.subVectors(V,z),H.extractRotation(d.matrixWorld),re.set(0,0,1),re.applyMatrix4(H),X.dot(re)<0}),D=function(){var V=new Vector3,z=new Vector3,H=new Quaternion,X=new Vector3;return function(){d.matrixWorld.decompose(z,H,X),V.set(0,0,1).applyQuaternion(H).normalize(),V.negate(),b.setFromNormalAndCoplanarPoint(V,z)}}(),F=function(){var V=new Plane,z=new Vector4,H=new Vector4;return function(re){x.matrixWorld.copy(re.matrixWorld),x.matrixWorldInverse.getInverse(x.matrixWorld),x.projectionMatrix.copy(re.projectionMatrix),x.far=re.far,V.copy(b),V.applyMatrix4(x.matrixWorldInverse),z.set(V.normal.x,V.normal.y,V.normal.z,V.constant);var j=x.projectionMatrix;H.x=(Math.sign(z.x)+j.elements[8])/j.elements[0],H.y=(Math.sign(z.y)+j.elements[9])/j.elements[5],H.z=-1,H.w=(1+j.elements[10])/j.elements[14],z.multiplyScalar(2/z.dot(H)),j.elements[2]=z.x,j.elements[6]=z.y,j.elements[10]=z.z+1-w,j.elements[14]=z.w}}();this.onBeforeRender=function(V,z,H){!0!==H.userData.refractor&&(!O(H)||(D(),function(V){A.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),A.multiply(V.projectionMatrix),A.multiply(V.matrixWorldInverse),A.multiply(d.matrixWorld)}(H),F(H),function(V,z,H){d.visible=!1;var X=V.getRenderTarget(),re=V.xr.enabled,j=V.shadowMap.autoUpdate;V.xr.enabled=!1,V.shadowMap.autoUpdate=!1,V.setRenderTarget(R),V.clear(),V.render(z,x),V.xr.enabled=re,V.shadowMap.autoUpdate=j,V.setRenderTarget(X);var te=H.viewport;void 0!==te&&V.state.viewport(te),d.visible=!0}(V,z,H)))},this.getRenderTarget=function(){return R}};Refractor.prototype=Object.create(Mesh.prototype),Refractor.prototype.constructor=Refractor,Refractor.RefractorShader={uniforms:{color:{value:null},tDiffuse:{value:null},textureMatrix:{value:null}},vertexShader:["uniform mat4 textureMatrix;","varying vec4 vUv;","void main() {","\tvUv = textureMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec4 vUv;","float blendOverlay( float base, float blend ) {","\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ), blendOverlay( base.b, blend.b ) );","}","void main() {","\tvec4 base = texture2DProj( tDiffuse, vUv );","\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")};var ShadowMesh=function(e){var a=new MeshBasicMaterial({color:0,transparent:!0,opacity:.6,depthWrite:!1});Mesh.call(this,e.geometry,a),this.meshMatrix=e.matrixWorld,this.frustumCulled=!1,this.matrixAutoUpdate=!1};ShadowMesh.prototype=Object.create(Mesh.prototype),ShadowMesh.prototype.constructor=ShadowMesh,ShadowMesh.prototype.update=function(){var s=new Matrix4;return function(e,a){var d=e.normal.x*a.x+e.normal.y*a.y+e.normal.z*a.z+-e.constant*a.w,v=s.elements;v[0]=d-a.x*e.normal.x,v[4]=-a.x*e.normal.y,v[8]=-a.x*e.normal.z,v[12]=-a.x*-e.constant,v[1]=-a.y*e.normal.x,v[5]=d-a.y*e.normal.y,v[9]=-a.y*e.normal.z,v[13]=-a.y*-e.constant,v[2]=-a.z*e.normal.x,v[6]=-a.z*e.normal.y,v[10]=d-a.z*e.normal.z,v[14]=-a.z*-e.constant,v[3]=-a.w*e.normal.x,v[7]=-a.w*e.normal.y,v[11]=-a.w*e.normal.z,v[15]=d-a.w*-e.constant,this.matrix.multiplyMatrices(s,this.meshMatrix)}}();var Sky=function s(){var e=s.SkyShader,a=new ShaderMaterial({fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:UniformsUtils.clone(e.uniforms),side:BackSide});Mesh.call(this,new BoxBufferGeometry(1,1,1),a)};Sky.prototype=Object.create(Mesh.prototype),Sky.SkyShader={uniforms:{luminance:{value:1},turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.005},mieDirectionalG:{value:.8},sunPosition:{value:new Vector3},up:{value:new Vector3(0,1,0)}},vertexShader:["uniform vec3 sunPosition;","uniform float rayleigh;","uniform float turbidity;","uniform float mieCoefficient;","uniform vec3 up;","varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","const float e = 2.71828182845904523536028747135266249775724709369995957;","const float pi = 3.141592653589793238462643383279502884197169;","const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );","const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );","const float v = 4.0;","const vec3 K = vec3( 0.686, 0.678, 0.666 );","const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );","const float cutoffAngle = 1.6110731556870734;","const float steepness = 1.5;","const float EE = 1000.0;","float sunIntensity( float zenithAngleCos ) {","\tzenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );","\treturn EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );","}","vec3 totalMie( float T ) {","\tfloat c = ( 0.2 * T ) * 10E-18;","\treturn 0.434 * c * MieConst;","}","void main() {","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvWorldPosition = worldPosition.xyz;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","\tgl_Position.z = gl_Position.w;","\tvSunDirection = normalize( sunPosition );","\tvSunE = sunIntensity( dot( vSunDirection, up ) );","\tvSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );","\tfloat rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );","\tvBetaR = totalRayleigh * rayleighCoefficient;","\tvBetaM = totalMie( turbidity ) * mieCoefficient;","}"].join("\n"),fragmentShader:["varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","uniform float luminance;","uniform float mieDirectionalG;","uniform vec3 up;","const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );","const float pi = 3.141592653589793238462643383279502884197169;","const float n = 1.0003;","const float N = 2.545E25;","const float rayleighZenithLength = 8.4E3;","const float mieZenithLength = 1.25E3;","const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;","const float THREE_OVER_SIXTEENPI = 0.05968310365946075;","const float ONE_OVER_FOURPI = 0.07957747154594767;","float rayleighPhase( float cosTheta ) {","\treturn THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );","}","float hgPhase( float cosTheta, float g ) {","\tfloat g2 = pow( g, 2.0 );","\tfloat inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );","\treturn ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );","}","const float A = 0.15;","const float B = 0.50;","const float C = 0.10;","const float D = 0.20;","const float E = 0.02;","const float F = 0.30;","const float whiteScale = 1.0748724675633854;","vec3 Uncharted2Tonemap( vec3 x ) {","\treturn ( ( x * ( A * x + C * B ) + D * E ) / ( x * ( A * x + B ) + D * F ) ) - E / F;","}","void main() {","\tfloat zenithAngle = acos( max( 0.0, dot( up, normalize( vWorldPosition - cameraPos ) ) ) );","\tfloat inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );","\tfloat sR = rayleighZenithLength * inverse;","\tfloat sM = mieZenithLength * inverse;","\tvec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );","\tfloat cosTheta = dot( normalize( vWorldPosition - cameraPos ), vSunDirection );","\tfloat rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );","\tvec3 betaRTheta = vBetaR * rPhase;","\tfloat mPhase = hgPhase( cosTheta, mieDirectionalG );","\tvec3 betaMTheta = vBetaM * mPhase;","\tvec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );","\tLin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );","\tvec3 direction = normalize( vWorldPosition - cameraPos );","\tfloat theta = acos( direction.y ); // elevation --\x3e y-axis, [-pi/2, pi/2]","\tfloat phi = atan( direction.z, direction.x ); // azimuth --\x3e x-axis [-pi/2, pi/2]","\tvec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );","\tvec3 L0 = vec3( 0.1 ) * Fex;","\tfloat sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );","\tL0 += ( vSunE * 19000.0 * Fex ) * sundisk;","\tvec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );","\tvec3 curr = Uncharted2Tonemap( ( log2( 2.0 / pow( luminance, 4.0 ) ) ) * texColor );","\tvec3 color = curr * whiteScale;","\tvec3 retColor = pow( color, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );","\tgl_FragColor = vec4( retColor, 1.0 );","}"].join("\n")};var Water=function(e,a){Mesh.call(this,e);var d=this,v=void 0!==(a=a||{}).textureWidth?a.textureWidth:512,g=void 0!==a.textureHeight?a.textureHeight:512,C=void 0!==a.clipBias?a.clipBias:0,w=void 0!==a.alpha?a.alpha:1,_=void 0!==a.time?a.time:0,x=void 0!==a.waterNormals?a.waterNormals:null,b=void 0!==a.sunDirection?a.sunDirection:new Vector3(.70707,.70707,0),A=new Color(void 0!==a.sunColor?a.sunColor:16777215),E=new Color(void 0!==a.waterColor?a.waterColor:8355711),R=void 0!==a.eye?a.eye:new Vector3(0,0,0),O=void 0!==a.distortionScale?a.distortionScale:20,D=void 0!==a.side?a.side:FrontSide,F=void 0!==a.fog&&a.fog,L=new Plane,I=new Vector3,V=new Vector3,z=new Vector3,H=new Matrix4,X=new Vector3(0,0,-1),re=new Vector4,j=new Vector3,te=new Vector3,J=new Vector4,k=new Matrix4,U=new PerspectiveCamera,ee=new WebGLRenderTarget(v,g,{minFilter:LinearFilter,magFilter:LinearFilter,format:RGBFormat,stencilBuffer:!1});(!MathUtils.isPowerOfTwo(v)||!MathUtils.isPowerOfTwo(g))&&(ee.texture.generateMipmaps=!1);var Q={uniforms:UniformsUtils.merge([UniformsLib.fog,UniformsLib.lights,{normalSampler:{value:null},mirrorSampler:{value:null},alpha:{value:1},time:{value:0},size:{value:1},distortionScale:{value:20},textureMatrix:{value:new Matrix4},sunColor:{value:new Color(8355711)},sunDirection:{value:new Vector3(.70707,.70707,0)},eye:{value:new Vector3},waterColor:{value:new Color(5592405)}}]),vertexShader:["uniform mat4 textureMatrix;","uniform float time;","varying vec4 mirrorCoord;","varying vec4 worldPosition;",ShaderChunk.fog_pars_vertex,ShaderChunk.shadowmap_pars_vertex,"void main() {","\tmirrorCoord = modelMatrix * vec4( position, 1.0 );","\tworldPosition = mirrorCoord.xyzw;","\tmirrorCoord = textureMatrix * mirrorCoord;","\tvec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * mvPosition;",ShaderChunk.fog_vertex,ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform sampler2D mirrorSampler;","uniform float alpha;","uniform float time;","uniform float size;","uniform float distortionScale;","uniform sampler2D normalSampler;","uniform vec3 sunColor;","uniform vec3 sunDirection;","uniform vec3 eye;","uniform vec3 waterColor;","varying vec4 mirrorCoord;","varying vec4 worldPosition;","vec4 getNoise( vec2 uv ) {","\tvec2 uv0 = ( uv / 103.0 ) + vec2(time / 17.0, time / 29.0);","\tvec2 uv1 = uv / 107.0-vec2( time / -19.0, time / 31.0 );","\tvec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( time / 101.0, time / 97.0 );","\tvec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( time / 109.0, time / -113.0 );","\tvec4 noise = texture2D( normalSampler, uv0 ) +","\t\ttexture2D( normalSampler, uv1 ) +","\t\ttexture2D( normalSampler, uv2 ) +","\t\ttexture2D( normalSampler, uv3 );","\treturn noise * 0.5 - 1.0;","}","void sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {","\tvec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );","\tfloat direction = max( 0.0, dot( eyeDirection, reflection ) );","\tspecularColor += pow( direction, shiny ) * sunColor * spec;","\tdiffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;","}",ShaderChunk.common,ShaderChunk.packing,ShaderChunk.bsdfs,ShaderChunk.fog_pars_fragment,ShaderChunk.lights_pars_begin,ShaderChunk.shadowmap_pars_fragment,ShaderChunk.shadowmask_pars_fragment,"void main() {","\tvec4 noise = getNoise( worldPosition.xz * size );","\tvec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );","\tvec3 diffuseLight = vec3(0.0);","\tvec3 specularLight = vec3(0.0);","\tvec3 worldToEye = eye-worldPosition.xyz;","\tvec3 eyeDirection = normalize( worldToEye );","\tsunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );","\tfloat distance = length(worldToEye);","\tvec2 distortion = surfaceNormal.xz * ( 0.001 + 1.0 / distance ) * distortionScale;","\tvec3 reflectionSample = vec3( texture2D( mirrorSampler, mirrorCoord.xy / mirrorCoord.w + distortion ) );","\tfloat theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );","\tfloat rf0 = 0.3;","\tfloat reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );","\tvec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;","\tvec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ) * getShadowMask(), ( vec3( 0.1 ) + reflectionSample * 0.9 + reflectionSample * specularLight ), reflectance);","\tvec3 outgoingLight = albedo;","\tgl_FragColor = vec4( outgoingLight, alpha );",ShaderChunk.tonemapping_fragment,ShaderChunk.fog_fragment,"}"].join("\n")},oe=new ShaderMaterial({fragmentShader:Q.fragmentShader,vertexShader:Q.vertexShader,uniforms:UniformsUtils.clone(Q.uniforms),lights:!0,side:D,fog:F});oe.uniforms.mirrorSampler.value=ee.texture,oe.uniforms.textureMatrix.value=k,oe.uniforms.alpha.value=w,oe.uniforms.time.value=_,oe.uniforms.normalSampler.value=x,oe.uniforms.sunColor.value=A,oe.uniforms.waterColor.value=E,oe.uniforms.sunDirection.value=b,oe.uniforms.distortionScale.value=O,oe.uniforms.eye.value=R,d.material=oe,d.onBeforeRender=function(me,fe,ge){if(V.setFromMatrixPosition(d.matrixWorld),z.setFromMatrixPosition(ge.matrixWorld),H.extractRotation(d.matrixWorld),I.set(0,0,1),I.applyMatrix4(H),j.subVectors(V,z),!(j.dot(I)>0)){j.reflect(I).negate(),j.add(V),H.extractRotation(ge.matrixWorld),X.set(0,0,-1),X.applyMatrix4(H),X.add(z),te.subVectors(V,X),te.reflect(I).negate(),te.add(V),U.position.copy(j),U.up.set(0,1,0),U.up.applyMatrix4(H),U.up.reflect(I),U.lookAt(te),U.far=ge.far,U.updateMatrixWorld(),U.projectionMatrix.copy(ge.projectionMatrix),k.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),k.multiply(U.projectionMatrix),k.multiply(U.matrixWorldInverse),L.setFromNormalAndCoplanarPoint(I,V),L.applyMatrix4(U.matrixWorldInverse),re.set(L.normal.x,L.normal.y,L.normal.z,L.constant);var $=U.projectionMatrix;J.x=(Math.sign(re.x)+$.elements[8])/$.elements[0],J.y=(Math.sign(re.y)+$.elements[9])/$.elements[5],J.z=-1,J.w=(1+$.elements[10])/$.elements[14],re.multiplyScalar(2/re.dot(J)),$.elements[2]=re.x,$.elements[6]=re.y,$.elements[10]=re.z+1-C,$.elements[14]=re.w,R.setFromMatrixPosition(ge.matrixWorld);var ue=me.getRenderTarget(),Y=me.xr.enabled,Z=me.shadowMap.autoUpdate;d.visible=!1,me.xr.enabled=!1,me.shadowMap.autoUpdate=!1,me.setRenderTarget(ee),me.clear(),me.render(fe,U),d.visible=!0,me.xr.enabled=Y,me.shadowMap.autoUpdate=Z,me.setRenderTarget(ue);var se=ge.viewport;void 0!==se&&me.state.viewport(se)}}};function Water2(s,e){Mesh.call(this,s),this.type="Water2";var a=this,d=new Color(void 0!==(e=e||{}).color?e.color:16777215),v=e.textureWidth||512,g=e.textureHeight||512,C=e.clipBias||0,w=e.flowDirection||new Vector2(1,0),_=e.flowSpeed||.03,x=e.reflectivity||.02,b=e.scale||1,A=e.shader||Water2.Water2Shader,E=new TextureLoader,R=e.flowMap||void 0,O=e.normalMap0||E.load("textures/water/Water2_1_M_Normal.jpg"),D=e.normalMap1||E.load("textures/water/Water2_2_M_Normal.jpg"),F=.15,L=.075,I=new Matrix4,V=new Clock;if(void 0!==Reflector)if(void 0!==Refractor){var z=new Reflector(s,{textureWidth:v,textureHeight:g,clipBias:C}),H=new Refractor(s,{textureWidth:v,textureHeight:g,clipBias:C});z.matrixAutoUpdate=!1,H.matrixAutoUpdate=!1,this.material=new ShaderMaterial({uniforms:UniformsUtils.merge([UniformsLib.fog,A.uniforms]),vertexShader:A.vertexShader,fragmentShader:A.fragmentShader,transparent:!0,fog:!0}),void 0!==R?(this.material.defines.USE_FLOWMAP="",this.material.uniforms.tFlowMap={type:"t",value:R}):this.material.uniforms.flowDirection={type:"v2",value:w},O.wrapS=O.wrapT=RepeatWrapping,D.wrapS=D.wrapT=RepeatWrapping,this.material.uniforms.tReflectionMap.value=z.getRenderTarget().texture,this.material.uniforms.tRefractionMap.value=H.getRenderTarget().texture,this.material.uniforms.tNormalMap0.value=O,this.material.uniforms.tNormalMap1.value=D,this.material.uniforms.color.value=d,this.material.uniforms.reflectivity.value=x,this.material.uniforms.textureMatrix.value=I,this.material.uniforms.config.value.x=0,this.material.uniforms.config.value.y=L,this.material.uniforms.config.value.z=L,this.material.uniforms.config.value.w=b,this.onBeforeRender=function(j,te,J){(function(j){I.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),I.multiply(j.projectionMatrix),I.multiply(j.matrixWorldInverse),I.multiply(a.matrixWorld)})(J),function(){var j=V.getDelta(),te=a.material.uniforms.config;te.value.x+=_*j,te.value.y=te.value.x+L,te.value.x>=F?(te.value.x=0,te.value.y=L):te.value.y>=F&&(te.value.y=te.value.y-F)}(),a.visible=!1,z.matrixWorld.copy(a.matrixWorld),H.matrixWorld.copy(a.matrixWorld),z.onBeforeRender(j,te,J),H.onBeforeRender(j,te,J),a.visible=!0}}else console.error("Water2: Required component Refractor not found.");else console.error("Water2: Required component Reflector not found.")}Water.prototype=Object.create(Mesh.prototype),Water.prototype.constructor=Water,Water2.prototype=Object.create(Mesh.prototype),Water2.prototype.constructor=Water2,Water2.Water2Shader={uniforms:{color:{type:"c",value:null},reflectivity:{type:"f",value:0},tReflectionMap:{type:"t",value:null},tRefractionMap:{type:"t",value:null},tNormalMap0:{type:"t",value:null},tNormalMap1:{type:"t",value:null},textureMatrix:{type:"m4",value:null},config:{type:"v4",value:new Vector4}},vertexShader:["#include <fog_pars_vertex>","#include <logdepthbuf_pars_vertex>","uniform mat4 textureMatrix;","varying vec4 vCoord;","varying vec2 vUv;","varying vec3 vToEye;","void main() {","\tvUv = uv;","\tvCoord = textureMatrix * vec4( position, 1.0 );","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvToEye = cameraPosition - worldPosition.xyz;","\tvec4 mvPosition =  viewMatrix * worldPosition;","\tgl_Position = projectionMatrix * mvPosition;","\t#include <logdepthbuf_vertex>","\t#include <fog_vertex>","}"].join("\n"),fragmentShader:["#include <common>","#include <fog_pars_fragment>","#include <logdepthbuf_pars_fragment>","uniform sampler2D tReflectionMap;","uniform sampler2D tRefractionMap;","uniform sampler2D tNormalMap0;","uniform sampler2D tNormalMap1;","#ifdef USE_FLOWMAP","\tuniform sampler2D tFlowMap;","#else","\tuniform vec2 flowDirection;","#endif","uniform vec3 color;","uniform float reflectivity;","uniform vec4 config;","varying vec4 vCoord;","varying vec2 vUv;","varying vec3 vToEye;","void main() {","\t#include <logdepthbuf_fragment>","\tfloat flowMapOffset0 = config.x;","\tfloat flowMapOffset1 = config.y;","\tfloat halfCycle = config.z;","\tfloat scale = config.w;","\tvec3 toEye = normalize( vToEye );","\tvec2 flow;","\t#ifdef USE_FLOWMAP","\t\tflow = texture2D( tFlowMap, vUv ).rg * 2.0 - 1.0;","\t#else","\t\tflow = flowDirection;","\t#endif","\tflow.x *= - 1.0;","\tvec4 normalColor0 = texture2D( tNormalMap0, ( vUv * scale ) + flow * flowMapOffset0 );","\tvec4 normalColor1 = texture2D( tNormalMap1, ( vUv * scale ) + flow * flowMapOffset1 );","\tfloat flowLerp = abs( halfCycle - flowMapOffset0 ) / halfCycle;","\tvec4 normalColor = mix( normalColor0, normalColor1, flowLerp );","\tvec3 normal = normalize( vec3( normalColor.r * 2.0 - 1.0, normalColor.b,  normalColor.g * 2.0 - 1.0 ) );","\tfloat theta = max( dot( toEye, normal ), 0.0 );","\tfloat reflectance = reflectivity + ( 1.0 - reflectivity ) * pow( ( 1.0 - theta ), 5.0 );","\tvec3 coord = vCoord.xyz / vCoord.w;","\tvec2 uv = coord.xy + coord.z * normal.xz * 0.05;","\tvec4 reflectColor = texture2D( tReflectionMap, vec2( 1.0 - uv.x, uv.y ) );","\tvec4 refractColor = texture2D( tRefractionMap, uv );","\tgl_FragColor = vec4( color, 1.0 ) * mix( refractColor, reflectColor, reflectance );","\t#include <tonemapping_fragment>","\t#include <encodings_fragment>","\t#include <fog_fragment>","}"].join("\n")};var CopyShader={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tgl_FragColor = opacity * texel;","}"].join("\n")},LuminosityShader={uniforms:{tDiffuse:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tfloat l = linearToRelativeLuminance( texel.rgb );","\tgl_FragColor = vec4( l, l, l, texel.w );","}"].join("\n")},ToneMapShader={uniforms:{tDiffuse:{value:null},averageLuminance:{value:1},luminanceMap:{value:null},maxLuminance:{value:16},minLuminance:{value:.01},middleGrey:{value:.6}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform sampler2D tDiffuse;","varying vec2 vUv;","uniform float middleGrey;","uniform float minLuminance;","uniform float maxLuminance;","#ifdef ADAPTED_LUMINANCE","\tuniform sampler2D luminanceMap;","#else","\tuniform float averageLuminance;","#endif","vec3 ToneMap( vec3 vColor ) {","\t#ifdef ADAPTED_LUMINANCE","\t\tfloat fLumAvg = texture2D(luminanceMap, vec2(0.5, 0.5)).r;","\t#else","\t\tfloat fLumAvg = averageLuminance;","\t#endif","\tfloat fLumPixel = linearToRelativeLuminance( vColor );","\tfloat fLumScaled = (fLumPixel * middleGrey) / max( minLuminance, fLumAvg );","\tfloat fLumCompressed = (fLumScaled * (1.0 + (fLumScaled / (maxLuminance * maxLuminance)))) / (1.0 + fLumScaled);","\treturn fLumCompressed * vColor;","}","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tgl_FragColor = vec4( ToneMap( texel.xyz ), texel.w );","}"].join("\n")},AdaptiveToneMappingPass=function(e,a){Pass.call(this),this.resolution=void 0!==a?a:256,this.needsInit=!0,this.adaptive=void 0===e||!!e,this.luminanceRT=null,this.previousLuminanceRT=null,this.currentLuminanceRT=null,void 0===CopyShader&&console.error("AdaptiveToneMappingPass relies on CopyShader");var d=CopyShader;this.copyUniforms=UniformsUtils.clone(d.uniforms),this.materialCopy=new ShaderMaterial({uniforms:this.copyUniforms,vertexShader:d.vertexShader,fragmentShader:d.fragmentShader,blending:NoBlending,depthTest:!1}),void 0===LuminosityShader&&console.error("AdaptiveToneMappingPass relies on LuminosityShader"),this.materialLuminance=new ShaderMaterial({uniforms:UniformsUtils.clone(LuminosityShader.uniforms),vertexShader:LuminosityShader.vertexShader,fragmentShader:LuminosityShader.fragmentShader,blending:NoBlending}),this.adaptLuminanceShader={defines:{MIP_LEVEL_1X1:(Math.log(this.resolution)/Math.log(2)).toFixed(1)},uniforms:{lastLum:{value:null},currentLum:{value:null},minLuminance:{value:.01},delta:{value:.016},tau:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec2 vUv;","uniform sampler2D lastLum;","uniform sampler2D currentLum;","uniform float minLuminance;","uniform float delta;","uniform float tau;","void main() {","\tvec4 lastLum = texture2D( lastLum, vUv, MIP_LEVEL_1X1 );","\tvec4 currentLum = texture2D( currentLum, vUv, MIP_LEVEL_1X1 );","\tfloat fLastLum = max( minLuminance, lastLum.r );","\tfloat fCurrentLum = max( minLuminance, currentLum.r );","\tfCurrentLum *= fCurrentLum;","\tfloat fAdaptedLum = fLastLum + (fCurrentLum - fLastLum) * (1.0 - exp(-delta * tau));","\tgl_FragColor.r = fAdaptedLum;","}"].join("\n")},this.materialAdaptiveLum=new ShaderMaterial({uniforms:UniformsUtils.clone(this.adaptLuminanceShader.uniforms),vertexShader:this.adaptLuminanceShader.vertexShader,fragmentShader:this.adaptLuminanceShader.fragmentShader,defines:Object.assign({},this.adaptLuminanceShader.defines),blending:NoBlending}),void 0===ToneMapShader&&console.error("AdaptiveToneMappingPass relies on ToneMapShader"),this.materialToneMap=new ShaderMaterial({uniforms:UniformsUtils.clone(ToneMapShader.uniforms),vertexShader:ToneMapShader.vertexShader,fragmentShader:ToneMapShader.fragmentShader,blending:NoBlending}),this.fsQuad=new Pass.FullScreenQuad(null)};AdaptiveToneMappingPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:AdaptiveToneMappingPass,render:function(e,a,d,v){this.needsInit&&(this.reset(e),this.luminanceRT.texture.type=d.texture.type,this.previousLuminanceRT.texture.type=d.texture.type,this.currentLuminanceRT.texture.type=d.texture.type,this.needsInit=!1),this.adaptive&&(this.fsQuad.material=this.materialLuminance,this.materialLuminance.uniforms.tDiffuse.value=d.texture,e.setRenderTarget(this.currentLuminanceRT),this.fsQuad.render(e),this.fsQuad.material=this.materialAdaptiveLum,this.materialAdaptiveLum.uniforms.delta.value=v,this.materialAdaptiveLum.uniforms.lastLum.value=this.previousLuminanceRT.texture,this.materialAdaptiveLum.uniforms.currentLum.value=this.currentLuminanceRT.texture,e.setRenderTarget(this.luminanceRT),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.luminanceRT.texture,e.setRenderTarget(this.previousLuminanceRT),this.fsQuad.render(e)),this.fsQuad.material=this.materialToneMap,this.materialToneMap.uniforms.tDiffuse.value=d.texture,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(a),this.clear&&e.clear(),this.fsQuad.render(e))},reset:function(){this.luminanceRT&&this.luminanceRT.dispose(),this.currentLuminanceRT&&this.currentLuminanceRT.dispose(),this.previousLuminanceRT&&this.previousLuminanceRT.dispose();var e={minFilter:LinearFilter,magFilter:LinearFilter,format:RGBAFormat};this.luminanceRT=new WebGLRenderTarget(this.resolution,this.resolution,e),this.luminanceRT.texture.name="AdaptiveToneMappingPass.l",this.luminanceRT.texture.generateMipmaps=!1,this.previousLuminanceRT=new WebGLRenderTarget(this.resolution,this.resolution,e),this.previousLuminanceRT.texture.name="AdaptiveToneMappingPass.pl",this.previousLuminanceRT.texture.generateMipmaps=!1,e.minFilter=LinearMipmapLinearFilter,e.generateMipmaps=!0,this.currentLuminanceRT=new WebGLRenderTarget(this.resolution,this.resolution,e),this.currentLuminanceRT.texture.name="AdaptiveToneMappingPass.cl",this.adaptive&&(this.materialToneMap.defines.ADAPTED_LUMINANCE="",this.materialToneMap.uniforms.luminanceMap.value=this.luminanceRT.texture),this.fsQuad.material=new MeshBasicMaterial({color:7829367}),this.materialLuminance.needsUpdate=!0,this.materialAdaptiveLum.needsUpdate=!0,this.materialToneMap.needsUpdate=!0},setAdaptive:function(e){e?(this.adaptive=!0,this.materialToneMap.defines.ADAPTED_LUMINANCE="",this.materialToneMap.uniforms.luminanceMap.value=this.luminanceRT.texture):(this.adaptive=!1,delete this.materialToneMap.defines.ADAPTED_LUMINANCE,this.materialToneMap.uniforms.luminanceMap.value=null),this.materialToneMap.needsUpdate=!0},setAdaptionRate:function(e){e&&(this.materialAdaptiveLum.uniforms.tau.value=Math.abs(e))},setMinLuminance:function(e){e&&(this.materialToneMap.uniforms.minLuminance.value=e,this.materialAdaptiveLum.uniforms.minLuminance.value=e)},setMaxLuminance:function(e){e&&(this.materialToneMap.uniforms.maxLuminance.value=e)},setAverageLuminance:function(e){e&&(this.materialToneMap.uniforms.averageLuminance.value=e)},setMiddleGrey:function(e){e&&(this.materialToneMap.uniforms.middleGrey.value=e)},dispose:function(){this.luminanceRT&&this.luminanceRT.dispose(),this.previousLuminanceRT&&this.previousLuminanceRT.dispose(),this.currentLuminanceRT&&this.currentLuminanceRT.dispose(),this.materialLuminance&&this.materialLuminance.dispose(),this.materialAdaptiveLum&&this.materialAdaptiveLum.dispose(),this.materialCopy&&this.materialCopy.dispose(),this.materialToneMap&&this.materialToneMap.dispose()}});var AfterimageShader={uniforms:{damp:{value:.96},tOld:{value:null},tNew:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float damp;","uniform sampler2D tOld;","uniform sampler2D tNew;","varying vec2 vUv;","vec4 when_gt( vec4 x, float y ) {","\treturn max( sign( x - y ), 0.0 );","}","void main() {","\tvec4 texelOld = texture2D( tOld, vUv );","\tvec4 texelNew = texture2D( tNew, vUv );","\ttexelOld *= damp * when_gt( texelOld, 0.1 );","\tgl_FragColor = max(texelNew, texelOld);","}"].join("\n")},AfterimagePass=function(e){Pass.call(this),void 0===AfterimageShader&&console.error("AfterimagePass relies on AfterimageShader"),this.shader=AfterimageShader,this.uniforms=UniformsUtils.clone(this.shader.uniforms),this.uniforms.damp.value=void 0!==e?e:.96,this.textureComp=new WebGLRenderTarget(window.innerWidth,window.innerHeight,{minFilter:LinearFilter,magFilter:NearestFilter,format:RGBAFormat}),this.textureOld=new WebGLRenderTarget(window.innerWidth,window.innerHeight,{minFilter:LinearFilter,magFilter:NearestFilter,format:RGBAFormat}),this.shaderMaterial=new ShaderMaterial({uniforms:this.uniforms,vertexShader:this.shader.vertexShader,fragmentShader:this.shader.fragmentShader}),this.compFsQuad=new Pass.FullScreenQuad(this.shaderMaterial);var a=new MeshBasicMaterial;this.copyFsQuad=new Pass.FullScreenQuad(a)};AfterimagePass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:AfterimagePass,render:function(e,a,d){this.uniforms.tOld.value=this.textureOld.texture,this.uniforms.tNew.value=d.texture,e.setRenderTarget(this.textureComp),this.compFsQuad.render(e),this.copyFsQuad.material.map=this.textureComp.texture,this.renderToScreen?(e.setRenderTarget(null),this.copyFsQuad.render(e)):(e.setRenderTarget(a),this.clear&&e.clear(),this.copyFsQuad.render(e));var v=this.textureOld;this.textureOld=this.textureComp,this.textureComp=v},setSize:function(e,a){this.textureComp.setSize(e,a),this.textureOld.setSize(e,a)}});var ConvolutionShader={defines:{KERNEL_SIZE_FLOAT:"25.0",KERNEL_SIZE_INT:"25"},uniforms:{tDiffuse:{value:null},uImageIncrement:{value:new Vector2(.001953125,0)},cKernel:{value:[]}},vertexShader:["uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","\tvUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float cKernel[ KERNEL_SIZE_INT ];","uniform sampler2D tDiffuse;","uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","\tvec2 imageCoord = vUv;","\tvec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );","\tfor( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {","\t\tsum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];","\t\timageCoord += uImageIncrement;","\t}","\tgl_FragColor = sum;","}"].join("\n"),buildKernel:function(e){var d,v,g,C,x,b,_=2*Math.ceil(3*e)+1;for(_>25&&(_=25),C=.5*(_-1),v=new Array(_),g=0,d=0;d<_;++d)v[d]=(x=d-C,b=e,Math.exp(-x*x/(2*b*b))),g+=v[d];for(d=0;d<_;++d)v[d]/=g;return v}},BloomPass=function s(e,a,d,v){Pass.call(this),e=void 0!==e?e:1,a=void 0!==a?a:25,d=void 0!==d?d:4;var g={minFilter:LinearFilter,magFilter:LinearFilter,format:RGBAFormat};this.renderTargetX=new WebGLRenderTarget(v=void 0!==v?v:256,v,g),this.renderTargetX.texture.name="BloomPass.x",this.renderTargetY=new WebGLRenderTarget(v,v,g),this.renderTargetY.texture.name="BloomPass.y",void 0===CopyShader&&console.error("BloomPass relies on CopyShader");var C=CopyShader;this.copyUniforms=UniformsUtils.clone(C.uniforms),this.copyUniforms.opacity.value=e,this.materialCopy=new ShaderMaterial({uniforms:this.copyUniforms,vertexShader:C.vertexShader,fragmentShader:C.fragmentShader,blending:AdditiveBlending,transparent:!0}),void 0===ConvolutionShader&&console.error("BloomPass relies on ConvolutionShader");var w=ConvolutionShader;this.convolutionUniforms=UniformsUtils.clone(w.uniforms),this.convolutionUniforms.uImageIncrement.value=s.blurX,this.convolutionUniforms.cKernel.value=ConvolutionShader.buildKernel(d),this.materialConvolution=new ShaderMaterial({uniforms:this.convolutionUniforms,vertexShader:w.vertexShader,fragmentShader:w.fragmentShader,defines:{KERNEL_SIZE_FLOAT:a.toFixed(1),KERNEL_SIZE_INT:a.toFixed(0)}}),this.needsSwap=!1,this.fsQuad=new Pass.FullScreenQuad(null)};BloomPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:BloomPass,render:function(e,a,d,v,g){g&&e.state.buffers.stencil.setTest(!1),this.fsQuad.material=this.materialConvolution,this.convolutionUniforms.tDiffuse.value=d.texture,this.convolutionUniforms.uImageIncrement.value=BloomPass.blurX,e.setRenderTarget(this.renderTargetX),e.clear(),this.fsQuad.render(e),this.convolutionUniforms.tDiffuse.value=this.renderTargetX.texture,this.convolutionUniforms.uImageIncrement.value=BloomPass.blurY,e.setRenderTarget(this.renderTargetY),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetY.texture,g&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(d),this.clear&&e.clear(),this.fsQuad.render(e)}}),BloomPass.blurX=new Vector2(.001953125,0),BloomPass.blurY=new Vector2(0,.001953125);var BokehPass=function(e,a,d){Pass.call(this),this.scene=e,this.camera=a;var v=void 0!==d.focus?d.focus:1,g=void 0!==d.aspect?d.aspect:a.aspect,C=void 0!==d.aperture?d.aperture:.025,w=void 0!==d.maxblur?d.maxblur:1,_=d.width||window.innerWidth||1,x=d.height||window.innerHeight||1;this.renderTargetColor=new WebGLRenderTarget(_,x,{minFilter:LinearFilter,magFilter:LinearFilter,format:RGBFormat}),this.renderTargetColor.texture.name="BokehPass.color",this.renderTargetDepth=this.renderTargetColor.clone(),this.renderTargetDepth.texture.name="BokehPass.depth",this.materialDepth=new MeshDepthMaterial,this.materialDepth.depthPacking=RGBADepthPacking,this.materialDepth.blending=NoBlending,void 0===BokehShader&&console.error("BokehPass relies on BokehShader");var b=BokehShader,A=UniformsUtils.clone(b.uniforms);A.tDepth.value=this.renderTargetDepth.texture,A.focus.value=v,A.aspect.value=g,A.aperture.value=C,A.maxblur.value=w,A.nearClip.value=a.near,A.farClip.value=a.far,this.materialBokeh=new ShaderMaterial({defines:Object.assign({},b.defines),uniforms:A,vertexShader:b.vertexShader,fragmentShader:b.fragmentShader}),this.uniforms=A,this.needsSwap=!1,this.fsQuad=new Pass.FullScreenQuad(this.materialBokeh),this.oldClearColor=new Color};BokehPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:BokehPass,render:function(e,a,d){this.scene.overrideMaterial=this.materialDepth,this.oldClearColor.copy(e.getClearColor());var v=e.getClearAlpha(),g=e.autoClear;e.autoClear=!1,e.setClearColor(16777215),e.setClearAlpha(1),e.setRenderTarget(this.renderTargetDepth),e.clear(),e.render(this.scene,this.camera),this.uniforms.tColor.value=d.texture,this.uniforms.nearClip.value=this.camera.near,this.uniforms.farClip.value=this.camera.far,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(a),e.clear(),this.fsQuad.render(e)),this.scene.overrideMaterial=null,e.setClearColor(this.oldClearColor),e.setClearAlpha(v),e.autoClear=g}});var ClearPass=function(e,a){Pass.call(this),this.needsSwap=!1,this.clearColor=void 0!==e?e:0,this.clearAlpha=void 0!==a?a:0};ClearPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:ClearPass,render:function(e,a,d){var v,g;this.clearColor&&(v=e.getClearColor().getHex(),g=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),e.setRenderTarget(this.renderToScreen?null:d),e.clear(),this.clearColor&&e.setClearColor(v,g)}});var CubeTexturePass=function(e,a,d){Pass.call(this),this.camera=e,this.needsSwap=!1,this.cubeShader=ShaderLib.cube,this.cubeMesh=new Mesh(new BoxBufferGeometry(10,10,10),new ShaderMaterial({uniforms:this.cubeShader.uniforms,vertexShader:this.cubeShader.vertexShader,fragmentShader:this.cubeShader.fragmentShader,depthTest:!1,depthWrite:!1,side:BackSide})),Object.defineProperty(this.cubeMesh.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),this.envMap=a,this.opacity=void 0!==d?d:1,this.cubeScene=new Scene,this.cubeCamera=new PerspectiveCamera,this.cubeScene.add(this.cubeMesh)};CubeTexturePass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:CubeTexturePass,render:function(e,a,d){var v=e.autoClear;e.autoClear=!1,this.cubeCamera.projectionMatrix.copy(this.camera.projectionMatrix),this.cubeCamera.quaternion.setFromRotationMatrix(this.camera.matrixWorld),this.cubeMesh.material.uniforms.envMap.value=this.envMap,this.cubeMesh.material.uniforms.opacity.value=this.opacity,this.cubeMesh.material.transparent=this.opacity<1,e.setRenderTarget(this.renderToScreen?null:d),this.clear&&e.clear(),e.render(this.cubeScene,this.cubeCamera),e.autoClear=v}});var DotScreenShader={uniforms:{tDiffuse:{value:null},tSize:{value:new Vector2(256,256)},center:{value:new Vector2(.5,.5)},angle:{value:1.57},scale:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec2 center;","uniform float angle;","uniform float scale;","uniform vec2 tSize;","uniform sampler2D tDiffuse;","varying vec2 vUv;","float pattern() {","\tfloat s = sin( angle ), c = cos( angle );","\tvec2 tex = vUv * tSize - center;","\tvec2 point = vec2( c * tex.x - s * tex.y, s * tex.x + c * tex.y ) * scale;","\treturn ( sin( point.x ) * sin( point.y ) ) * 4.0;","}","void main() {","\tvec4 color = texture2D( tDiffuse, vUv );","\tfloat average = ( color.r + color.g + color.b ) / 3.0;","\tgl_FragColor = vec4( vec3( average * 10.0 - 5.0 + pattern() ), color.a );","}"].join("\n")},DotScreenPass=function(e,a,d){Pass.call(this),void 0===DotScreenShader&&console.error("DotScreenPass relies on DotScreenShader");var v=DotScreenShader;this.uniforms=UniformsUtils.clone(v.uniforms),void 0!==e&&this.uniforms.center.value.copy(e),void 0!==a&&(this.uniforms.angle.value=a),void 0!==d&&(this.uniforms.scale.value=d),this.material=new ShaderMaterial({uniforms:this.uniforms,vertexShader:v.vertexShader,fragmentShader:v.fragmentShader}),this.fsQuad=new Pass.FullScreenQuad(this.material)};DotScreenPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:DotScreenPass,render:function(e,a,d){this.uniforms.tDiffuse.value=d.texture,this.uniforms.tSize.value.set(d.width,d.height),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(a),this.clear&&e.clear(),this.fsQuad.render(e))}});var MaskPass=function(e,a){Pass.call(this),this.scene=e,this.camera=a,this.clear=!0,this.needsSwap=!1,this.inverse=!1};MaskPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:MaskPass,render:function(e,a,d){var C,w,v=e.getContext(),g=e.state;g.buffers.color.setMask(!1),g.buffers.depth.setMask(!1),g.buffers.color.setLocked(!0),g.buffers.depth.setLocked(!0),this.inverse?(C=0,w=1):(C=1,w=0),g.buffers.stencil.setTest(!0),g.buffers.stencil.setOp(v.REPLACE,v.REPLACE,v.REPLACE),g.buffers.stencil.setFunc(v.ALWAYS,C,4294967295),g.buffers.stencil.setClear(w),g.buffers.stencil.setLocked(!0),e.setRenderTarget(d),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(a),this.clear&&e.clear(),e.render(this.scene,this.camera),g.buffers.color.setLocked(!1),g.buffers.depth.setLocked(!1),g.buffers.stencil.setLocked(!1),g.buffers.stencil.setFunc(v.EQUAL,1,4294967295),g.buffers.stencil.setOp(v.KEEP,v.KEEP,v.KEEP),g.buffers.stencil.setLocked(!0)}});var ClearMaskPass=function(){Pass.call(this),this.needsSwap=!1};ClearMaskPass.prototype=Object.create(Pass.prototype),Object.assign(ClearMaskPass.prototype,{render:function(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}});var EffectComposer=function(e,a){if(this.renderer=e,void 0===a){var d={minFilter:LinearFilter,magFilter:LinearFilter,format:RGBAFormat,stencilBuffer:!1},v=e.getSize(new Vector2);this._pixelRatio=e.getPixelRatio(),this._width=v.width,this._height=v.height,(a=new WebGLRenderTarget(this._width*this._pixelRatio,this._height*this._pixelRatio,d)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=a.width,this._height=a.height;this.renderTarget1=a,this.renderTarget2=a.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===CopyShader&&console.error("EffectComposer relies on CopyShader"),void 0===ShaderPass&&console.error("EffectComposer relies on ShaderPass"),this.copyPass=new ShaderPass(CopyShader),this.clock=new Clock};Object.assign(EffectComposer.prototype,{swapBuffers:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e},addPass:function(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)},insertPass:function(e,a){this.passes.splice(a,0,e)},isLastEnabledPass:function(e){for(var a=e+1;a<this.passes.length;a++)if(this.passes[a].enabled)return!1;return!0},render:function(e){void 0===e&&(e=this.clock.getDelta());var v,g,a=this.renderer.getRenderTarget(),d=!1,C=this.passes.length;for(g=0;g<C;g++)if(!1!==(v=this.passes[g]).enabled){if(v.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(g),v.render(this.renderer,this.writeBuffer,this.readBuffer,e,d),v.needsSwap){if(d){var w=this.renderer.getContext(),_=this.renderer.state.buffers.stencil;_.setFunc(w.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),_.setFunc(w.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==MaskPass&&(v instanceof MaskPass?d=!0:v instanceof ClearMaskPass&&(d=!1))}this.renderer.setRenderTarget(a)},reset:function(e){if(void 0===e){var a=this.renderer.getSize(new Vector2);this._pixelRatio=this.renderer.getPixelRatio(),this._width=a.width,this._height=a.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(e,a){this._width=e,this._height=a;var d=this._width*this._pixelRatio,v=this._height*this._pixelRatio;this.renderTarget1.setSize(d,v),this.renderTarget2.setSize(d,v);for(var g=0;g<this.passes.length;g++)this.passes[g].setSize(d,v)},setPixelRatio:function(e){this._pixelRatio=e,this.setSize(this._width,this._height)}});var FilmShader={uniforms:{tDiffuse:{value:null},time:{value:0},nIntensity:{value:.5},sIntensity:{value:.05},sCount:{value:4096},grayscale:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform float time;","uniform bool grayscale;","uniform float nIntensity;","uniform float sIntensity;","uniform float sCount;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 cTextureScreen = texture2D( tDiffuse, vUv );","\tfloat dx = rand( vUv + time );","\tvec3 cResult = cTextureScreen.rgb + cTextureScreen.rgb * clamp( 0.1 + dx, 0.0, 1.0 );","\tvec2 sc = vec2( sin( vUv.y * sCount ), cos( vUv.y * sCount ) );","\tcResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * sIntensity;","\tcResult = cTextureScreen.rgb + clamp( nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );","\tif( grayscale ) {","\t\tcResult = vec3( cResult.r * 0.3 + cResult.g * 0.59 + cResult.b * 0.11 );","\t}","\tgl_FragColor =  vec4( cResult, cTextureScreen.a );","}"].join("\n")},FilmPass=function(e,a,d,v){Pass.call(this),void 0===FilmShader&&console.error("FilmPass relies on FilmShader");var g=FilmShader;this.uniforms=UniformsUtils.clone(g.uniforms),this.material=new ShaderMaterial({uniforms:this.uniforms,vertexShader:g.vertexShader,fragmentShader:g.fragmentShader}),void 0!==v&&(this.uniforms.grayscale.value=v),void 0!==e&&(this.uniforms.nIntensity.value=e),void 0!==a&&(this.uniforms.sIntensity.value=a),void 0!==d&&(this.uniforms.sCount.value=d),this.fsQuad=new Pass.FullScreenQuad(this.material)};FilmPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:FilmPass,render:function(e,a,d,v){this.uniforms.tDiffuse.value=d.texture,this.uniforms.time.value+=v,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(a),this.clear&&e.clear(),this.fsQuad.render(e))}});var DigitalGlitch={uniforms:{tDiffuse:{value:null},tDisp:{value:null},byp:{value:0},amount:{value:.08},angle:{value:.02},seed:{value:.02},seed_x:{value:.02},seed_y:{value:.02},distortion_x:{value:.5},distortion_y:{value:.6},col_s:{value:.05}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform int byp;","uniform sampler2D tDiffuse;","uniform sampler2D tDisp;","uniform float amount;","uniform float angle;","uniform float seed;","uniform float seed_x;","uniform float seed_y;","uniform float distortion_x;","uniform float distortion_y;","uniform float col_s;","varying vec2 vUv;","float rand(vec2 co){","\treturn fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);","}","void main() {","\tif(byp<1) {","\t\tvec2 p = vUv;","\t\tfloat xs = floor(gl_FragCoord.x / 0.5);","\t\tfloat ys = floor(gl_FragCoord.y / 0.5);","\t\tvec4 normal = texture2D (tDisp, p*seed*seed);","\t\tif(p.y<distortion_x+col_s && p.y>distortion_x-col_s*seed) {","\t\t\tif(seed_x>0.){","\t\t\t\tp.y = 1. - (p.y + distortion_y);","\t\t\t}","\t\t\telse {","\t\t\t\tp.y = distortion_y;","\t\t\t}","\t\t}","\t\tif(p.x<distortion_y+col_s && p.x>distortion_y-col_s*seed) {","\t\t\tif(seed_y>0.){","\t\t\t\tp.x=distortion_x;","\t\t\t}","\t\t\telse {","\t\t\t\tp.x = 1. - (p.x + distortion_x);","\t\t\t}","\t\t}","\t\tp.x+=normal.x*seed_x*(seed/5.);","\t\tp.y+=normal.y*seed_y*(seed/5.);","\t\tvec2 offset = amount * vec2( cos(angle), sin(angle));","\t\tvec4 cr = texture2D(tDiffuse, p + offset);","\t\tvec4 cga = texture2D(tDiffuse, p);","\t\tvec4 cb = texture2D(tDiffuse, p - offset);","\t\tgl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);","\t\tvec4 snow = 200.*amount*vec4(rand(vec2(xs * seed,ys * seed*50.))*0.2);","\t\tgl_FragColor = gl_FragColor+ snow;","\t}","\telse {","\t\tgl_FragColor=texture2D (tDiffuse, vUv);","\t}","}"].join("\n")},GlitchPass=function(e){Pass.call(this),void 0===DigitalGlitch&&console.error("GlitchPass relies on DigitalGlitch");var a=DigitalGlitch;this.uniforms=UniformsUtils.clone(a.uniforms),null==e&&(e=64),this.uniforms.tDisp.value=this.generateHeightmap(e),this.material=new ShaderMaterial({uniforms:this.uniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader}),this.fsQuad=new Pass.FullScreenQuad(this.material),this.goWild=!1,this.curF=0,this.generateTrigger()};GlitchPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:GlitchPass,render:function(e,a,d){this.uniforms.tDiffuse.value=d.texture,this.uniforms.seed.value=Math.random(),this.uniforms.byp.value=0,this.curF%this.randX==0||1==this.goWild?(this.uniforms.amount.value=Math.random()/30,this.uniforms.angle.value=MathUtils.randFloat(-Math.PI,Math.PI),this.uniforms.seed_x.value=MathUtils.randFloat(-1,1),this.uniforms.seed_y.value=MathUtils.randFloat(-1,1),this.uniforms.distortion_x.value=MathUtils.randFloat(0,1),this.uniforms.distortion_y.value=MathUtils.randFloat(0,1),this.curF=0,this.generateTrigger()):this.curF%this.randX<this.randX/5?(this.uniforms.amount.value=Math.random()/90,this.uniforms.angle.value=MathUtils.randFloat(-Math.PI,Math.PI),this.uniforms.distortion_x.value=MathUtils.randFloat(0,1),this.uniforms.distortion_y.value=MathUtils.randFloat(0,1),this.uniforms.seed_x.value=MathUtils.randFloat(-.3,.3),this.uniforms.seed_y.value=MathUtils.randFloat(-.3,.3)):0==this.goWild&&(this.uniforms.byp.value=1),this.curF++,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(a),this.clear&&e.clear(),this.fsQuad.render(e))},generateTrigger:function(){this.randX=MathUtils.randInt(120,240)},generateHeightmap:function(e){for(var a=new Float32Array(e*e*3),d=e*e,v=0;v<d;v++){var g=MathUtils.randFloat(0,1);a[3*v+0]=g,a[3*v+1]=g,a[3*v+2]=g}return new DataTexture(a,e,e,RGBFormat,FloatType)}});var HalftoneShader={uniforms:{tDiffuse:{value:null},shape:{value:1},radius:{value:4},rotateR:{value:Math.PI/12*1},rotateG:{value:Math.PI/12*2},rotateB:{value:Math.PI/12*3},scatter:{value:0},width:{value:1},height:{value:1},blending:{value:1},blendingMode:{value:1},greyscale:{value:!1},disable:{value:!1}},vertexShader:["varying vec2 vUV;","void main() {","\tvUV = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join("\n"),fragmentShader:["#define SQRT2_MINUS_ONE 0.41421356","#define SQRT2_HALF_MINUS_ONE 0.20710678","#define PI2 6.28318531","#define SHAPE_DOT 1","#define SHAPE_ELLIPSE 2","#define SHAPE_LINE 3","#define SHAPE_SQUARE 4","#define BLENDING_LINEAR 1","#define BLENDING_MULTIPLY 2","#define BLENDING_ADD 3","#define BLENDING_LIGHTER 4","#define BLENDING_DARKER 5","uniform sampler2D tDiffuse;","uniform float radius;","uniform float rotateR;","uniform float rotateG;","uniform float rotateB;","uniform float scatter;","uniform float width;","uniform float height;","uniform int shape;","uniform bool disable;","uniform float blending;","uniform int blendingMode;","varying vec2 vUV;","uniform bool greyscale;","const int samples = 8;","float blend( float a, float b, float t ) {","\treturn a * ( 1.0 - t ) + b * t;","}","float hypot( float x, float y ) {","\treturn sqrt( x * x + y * y );","}","float rand( vec2 seed ){","return fract( sin( dot( seed.xy, vec2( 12.9898, 78.233 ) ) ) * 43758.5453 );","}","float distanceToDotRadius( float channel, vec2 coord, vec2 normal, vec2 p, float angle, float rad_max ) {","\tfloat dist = hypot( coord.x - p.x, coord.y - p.y );","\tfloat rad = channel;","\tif ( shape == SHAPE_DOT ) {","\t\trad = pow( abs( rad ), 1.125 ) * rad_max;","\t} else if ( shape == SHAPE_ELLIPSE ) {","\t\trad = pow( abs( rad ), 1.125 ) * rad_max;","\t\tif ( dist != 0.0 ) {","\t\t\tfloat dot_p = abs( ( p.x - coord.x ) / dist * normal.x + ( p.y - coord.y ) / dist * normal.y );","\t\t\tdist = ( dist * ( 1.0 - SQRT2_HALF_MINUS_ONE ) ) + dot_p * dist * SQRT2_MINUS_ONE;","\t\t}","\t} else if ( shape == SHAPE_LINE ) {","\t\trad = pow( abs( rad ), 1.5) * rad_max;","\t\tfloat dot_p = ( p.x - coord.x ) * normal.x + ( p.y - coord.y ) * normal.y;","\t\tdist = hypot( normal.x * dot_p, normal.y * dot_p );","\t} else if ( shape == SHAPE_SQUARE ) {","\t\tfloat theta = atan( p.y - coord.y, p.x - coord.x ) - angle;","\t\tfloat sin_t = abs( sin( theta ) );","\t\tfloat cos_t = abs( cos( theta ) );","\t\trad = pow( abs( rad ), 1.4 );","\t\trad = rad_max * ( rad + ( ( sin_t > cos_t ) ? rad - sin_t * rad : rad - cos_t * rad ) );","\t}","\treturn rad - dist;","}","struct Cell {","\tvec2 normal;","\tvec2 p1;","\tvec2 p2;","\tvec2 p3;","\tvec2 p4;","\tfloat samp2;","\tfloat samp1;","\tfloat samp3;","\tfloat samp4;","};","vec4 getSample( vec2 point ) {","\tvec4 tex = texture2D( tDiffuse, vec2( point.x / width, point.y / height ) );","\tfloat base = rand( vec2( floor( point.x ), floor( point.y ) ) ) * PI2;","\tfloat step = PI2 / float( samples );","\tfloat dist = radius * 0.66;","\tfor ( int i = 0; i < samples; ++i ) {","\t\tfloat r = base + step * float( i );","\t\tvec2 coord = point + vec2( cos( r ) * dist, sin( r ) * dist );","\t\ttex += texture2D( tDiffuse, vec2( coord.x / width, coord.y / height ) );","\t}","\ttex /= float( samples ) + 1.0;","\treturn tex;","}","float getDotColour( Cell c, vec2 p, int channel, float angle, float aa ) {","\tfloat dist_c_1, dist_c_2, dist_c_3, dist_c_4, res;","\tif ( channel == 0 ) {","\t\tc.samp1 = getSample( c.p1 ).r;","\t\tc.samp2 = getSample( c.p2 ).r;","\t\tc.samp3 = getSample( c.p3 ).r;","\t\tc.samp4 = getSample( c.p4 ).r;","\t} else if (channel == 1) {","\t\tc.samp1 = getSample( c.p1 ).g;","\t\tc.samp2 = getSample( c.p2 ).g;","\t\tc.samp3 = getSample( c.p3 ).g;","\t\tc.samp4 = getSample( c.p4 ).g;","\t} else {","\t\tc.samp1 = getSample( c.p1 ).b;","\t\tc.samp3 = getSample( c.p3 ).b;","\t\tc.samp2 = getSample( c.p2 ).b;","\t\tc.samp4 = getSample( c.p4 ).b;","\t}","\tdist_c_1 = distanceToDotRadius( c.samp1, c.p1, c.normal, p, angle, radius );","\tdist_c_2 = distanceToDotRadius( c.samp2, c.p2, c.normal, p, angle, radius );","\tdist_c_3 = distanceToDotRadius( c.samp3, c.p3, c.normal, p, angle, radius );","\tdist_c_4 = distanceToDotRadius( c.samp4, c.p4, c.normal, p, angle, radius );","\tres = ( dist_c_1 > 0.0 ) ? clamp( dist_c_1 / aa, 0.0, 1.0 ) : 0.0;","\tres += ( dist_c_2 > 0.0 ) ? clamp( dist_c_2 / aa, 0.0, 1.0 ) : 0.0;","\tres += ( dist_c_3 > 0.0 ) ? clamp( dist_c_3 / aa, 0.0, 1.0 ) : 0.0;","\tres += ( dist_c_4 > 0.0 ) ? clamp( dist_c_4 / aa, 0.0, 1.0 ) : 0.0;","\tres = clamp( res, 0.0, 1.0 );","\treturn res;","}","Cell getReferenceCell( vec2 p, vec2 origin, float grid_angle, float step ) {","\tCell c;","\tvec2 n = vec2( cos( grid_angle ), sin( grid_angle ) );","\tfloat threshold = step * 0.5;","\tfloat dot_normal = n.x * ( p.x - origin.x ) + n.y * ( p.y - origin.y );","\tfloat dot_line = -n.y * ( p.x - origin.x ) + n.x * ( p.y - origin.y );","\tvec2 offset = vec2( n.x * dot_normal, n.y * dot_normal );","\tfloat offset_normal = mod( hypot( offset.x, offset.y ), step );","\tfloat normal_dir = ( dot_normal < 0.0 ) ? 1.0 : -1.0;","\tfloat normal_scale = ( ( offset_normal < threshold ) ? -offset_normal : step - offset_normal ) * normal_dir;","\tfloat offset_line = mod( hypot( ( p.x - offset.x ) - origin.x, ( p.y - offset.y ) - origin.y ), step );","\tfloat line_dir = ( dot_line < 0.0 ) ? 1.0 : -1.0;","\tfloat line_scale = ( ( offset_line < threshold ) ? -offset_line : step - offset_line ) * line_dir;","\tc.normal = n;","\tc.p1.x = p.x - n.x * normal_scale + n.y * line_scale;","\tc.p1.y = p.y - n.y * normal_scale - n.x * line_scale;","\tif ( scatter != 0.0 ) {","\t\tfloat off_mag = scatter * threshold * 0.5;","\t\tfloat off_angle = rand( vec2( floor( c.p1.x ), floor( c.p1.y ) ) ) * PI2;","\t\tc.p1.x += cos( off_angle ) * off_mag;","\t\tc.p1.y += sin( off_angle ) * off_mag;","\t}","\tfloat normal_step = normal_dir * ( ( offset_normal < threshold ) ? step : -step );","\tfloat line_step = line_dir * ( ( offset_line < threshold ) ? step : -step );","\tc.p2.x = c.p1.x - n.x * normal_step;","\tc.p2.y = c.p1.y - n.y * normal_step;","\tc.p3.x = c.p1.x + n.y * line_step;","\tc.p3.y = c.p1.y - n.x * line_step;","\tc.p4.x = c.p1.x - n.x * normal_step + n.y * line_step;","\tc.p4.y = c.p1.y - n.y * normal_step - n.x * line_step;","\treturn c;","}","float blendColour( float a, float b, float t ) {","\tif ( blendingMode == BLENDING_LINEAR ) {","\t\treturn blend( a, b, 1.0 - t );","\t} else if ( blendingMode == BLENDING_ADD ) {","\t\treturn blend( a, min( 1.0, a + b ), t );","\t} else if ( blendingMode == BLENDING_MULTIPLY ) {","\t\treturn blend( a, max( 0.0, a * b ), t );","\t} else if ( blendingMode == BLENDING_LIGHTER ) {","\t\treturn blend( a, max( a, b ), t );","\t} else if ( blendingMode == BLENDING_DARKER ) {","\t\treturn blend( a, min( a, b ), t );","\t} else {","\t\treturn blend( a, b, 1.0 - t );","\t}","}","void main() {","\tif ( ! disable ) {","\t\tvec2 p = vec2( vUV.x * width, vUV.y * height );","\t\tvec2 origin = vec2( 0, 0 );","\t\tfloat aa = ( radius < 2.5 ) ? radius * 0.5 : 1.25;","\t\tCell cell_r = getReferenceCell( p, origin, rotateR, radius );","\t\tCell cell_g = getReferenceCell( p, origin, rotateG, radius );","\t\tCell cell_b = getReferenceCell( p, origin, rotateB, radius );","\t\tfloat r = getDotColour( cell_r, p, 0, rotateR, aa );","\t\tfloat g = getDotColour( cell_g, p, 1, rotateG, aa );","\t\tfloat b = getDotColour( cell_b, p, 2, rotateB, aa );","\t\tvec4 colour = texture2D( tDiffuse, vUV );","\t\tr = blendColour( r, colour.r, blending );","\t\tg = blendColour( g, colour.g, blending );","\t\tb = blendColour( b, colour.b, blending );","\t\tif ( greyscale ) {","\t\t\tr = g = b = (r + b + g) / 3.0;","\t\t}","\t\tgl_FragColor = vec4( r, g, b, 1.0 );","\t} else {","\t\tgl_FragColor = texture2D( tDiffuse, vUV );","\t}","}"].join("\n")},HalftonePass=function(e,a,d){for(var v in Pass.call(this),void 0===HalftoneShader&&console.error("HalftonePass requires HalftoneShader"),this.uniforms=UniformsUtils.clone(HalftoneShader.uniforms),this.material=new ShaderMaterial({uniforms:this.uniforms,fragmentShader:HalftoneShader.fragmentShader,vertexShader:HalftoneShader.vertexShader}),this.uniforms.width.value=e,this.uniforms.height.value=a,d)d.hasOwnProperty(v)&&this.uniforms.hasOwnProperty(v)&&(this.uniforms[v].value=d[v]);this.fsQuad=new Pass.FullScreenQuad(this.material)};HalftonePass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:HalftonePass,render:function(e,a,d){this.material.uniforms.tDiffuse.value=d.texture,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(a),this.clear&&e.clear(),this.fsQuad.render(e))},setSize:function(e,a){this.uniforms.width.value=e,this.uniforms.height.value=a}});var OutlinePass=function(e,a,d,v){this.renderScene=a,this.renderCamera=d,this.selectedObjects=void 0!==v?v:[],this.visibleEdgeColor=new Color(1,1,1),this.hiddenEdgeColor=new Color(.1,.04,.02),this.edgeGlow=0,this.usePatternTexture=!1,this.edgeThickness=1,this.edgeStrength=3,this.downSampleRatio=2,this.pulsePeriod=0,Pass.call(this),this.resolution=void 0!==e?new Vector2(e.x,e.y):new Vector2(256,256);var g={minFilter:LinearFilter,magFilter:LinearFilter,format:RGBAFormat},C=Math.round(this.resolution.x/this.downSampleRatio),w=Math.round(this.resolution.y/this.downSampleRatio);this.maskBufferMaterial=new MeshBasicMaterial({color:16777215}),this.maskBufferMaterial.side=DoubleSide,this.renderTargetMaskBuffer=new WebGLRenderTarget(this.resolution.x,this.resolution.y,g),this.renderTargetMaskBuffer.texture.name="OutlinePass.mask",this.renderTargetMaskBuffer.texture.generateMipmaps=!1,this.depthMaterial=new MeshDepthMaterial,this.depthMaterial.side=DoubleSide,this.depthMaterial.depthPacking=RGBADepthPacking,this.depthMaterial.blending=NoBlending,this.prepareMaskMaterial=this.getPrepareMaskMaterial(),this.prepareMaskMaterial.side=DoubleSide,this.prepareMaskMaterial.fragmentShader=this.prepareMaskMaterial.fragmentShader.replace(/DEPTH_TO_VIEW_Z/g,(this.renderCamera.isPerspectiveCamera?"perspective":"orthographic")+"DepthToViewZ"),this.renderTargetDepthBuffer=new WebGLRenderTarget(this.resolution.x,this.resolution.y,g),this.renderTargetDepthBuffer.texture.name="OutlinePass.depth",this.renderTargetDepthBuffer.texture.generateMipmaps=!1,this.renderTargetMaskDownSampleBuffer=new WebGLRenderTarget(C,w,g),this.renderTargetMaskDownSampleBuffer.texture.name="OutlinePass.depthDownSample",this.renderTargetMaskDownSampleBuffer.texture.generateMipmaps=!1,this.renderTargetBlurBuffer1=new WebGLRenderTarget(C,w,g),this.renderTargetBlurBuffer1.texture.name="OutlinePass.blur1",this.renderTargetBlurBuffer1.texture.generateMipmaps=!1,this.renderTargetBlurBuffer2=new WebGLRenderTarget(Math.round(C/2),Math.round(w/2),g),this.renderTargetBlurBuffer2.texture.name="OutlinePass.blur2",this.renderTargetBlurBuffer2.texture.generateMipmaps=!1,this.edgeDetectionMaterial=this.getEdgeDetectionMaterial(),this.renderTargetEdgeBuffer1=new WebGLRenderTarget(C,w,g),this.renderTargetEdgeBuffer1.texture.name="OutlinePass.edge1",this.renderTargetEdgeBuffer1.texture.generateMipmaps=!1,this.renderTargetEdgeBuffer2=new WebGLRenderTarget(Math.round(C/2),Math.round(w/2),g),this.renderTargetEdgeBuffer2.texture.name="OutlinePass.edge2",this.renderTargetEdgeBuffer2.texture.generateMipmaps=!1,this.separableBlurMaterial1=this.getSeperableBlurMaterial(4),this.separableBlurMaterial1.uniforms.texSize.value.set(C,w),this.separableBlurMaterial1.uniforms.kernelRadius.value=1,this.separableBlurMaterial2=this.getSeperableBlurMaterial(4),this.separableBlurMaterial2.uniforms.texSize.value.set(Math.round(C/2),Math.round(w/2)),this.separableBlurMaterial2.uniforms.kernelRadius.value=4,this.overlayMaterial=this.getOverlayMaterial(),void 0===CopyShader&&console.error("OutlinePass relies on CopyShader");var b=CopyShader;this.copyUniforms=UniformsUtils.clone(b.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new ShaderMaterial({uniforms:this.copyUniforms,vertexShader:b.vertexShader,fragmentShader:b.fragmentShader,blending:NoBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this.oldClearColor=new Color,this.oldClearAlpha=1,this.fsQuad=new Pass.FullScreenQuad(null),this.tempPulseColor1=new Color,this.tempPulseColor2=new Color,this.textureMatrix=new Matrix4};OutlinePass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:OutlinePass,dispose:function(){this.renderTargetMaskBuffer.dispose(),this.renderTargetDepthBuffer.dispose(),this.renderTargetMaskDownSampleBuffer.dispose(),this.renderTargetBlurBuffer1.dispose(),this.renderTargetBlurBuffer2.dispose(),this.renderTargetEdgeBuffer1.dispose(),this.renderTargetEdgeBuffer2.dispose()},setSize:function(e,a){this.renderTargetMaskBuffer.setSize(e,a);var d=Math.round(e/this.downSampleRatio),v=Math.round(a/this.downSampleRatio);this.renderTargetMaskDownSampleBuffer.setSize(d,v),this.renderTargetBlurBuffer1.setSize(d,v),this.renderTargetEdgeBuffer1.setSize(d,v),this.separableBlurMaterial1.uniforms.texSize.value.set(d,v),d=Math.round(d/2),v=Math.round(v/2),this.renderTargetBlurBuffer2.setSize(d,v),this.renderTargetEdgeBuffer2.setSize(d,v),this.separableBlurMaterial2.uniforms.texSize.value.set(d,v)},changeVisibilityOfSelectedObjects:function(e){function a(g){g.isMesh&&(e?(g.visible=g.userData.oldVisible,delete g.userData.oldVisible):(g.userData.oldVisible=g.visible,g.visible=e))}for(var d=0;d<this.selectedObjects.length;d++)this.selectedObjects[d].traverse(a)},changeVisibilityOfNonSelectedObjects:function(e){var a=[];function d(w){w.isMesh&&a.push(w)}for(var v=0;v<this.selectedObjects.length;v++)this.selectedObjects[v].traverse(d);this.renderScene.traverse(function(w){if(w.isMesh||w.isLine||w.isSprite){for(var _=!1,x=0;x<a.length;x++)if(a[x].id===w.id){_=!0;break}if(!_){var A=w.visible;(!e||w.bVisible)&&(w.visible=e),w.bVisible=A}}})},updateTextureMatrix:function(){this.textureMatrix.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),this.textureMatrix.multiply(this.renderCamera.projectionMatrix),this.textureMatrix.multiply(this.renderCamera.matrixWorldInverse)},render:function(e,a,d,v,g){if(this.selectedObjects.length>0){this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha();var C=e.autoClear;e.autoClear=!1,g&&e.state.buffers.stencil.setTest(!1),e.setClearColor(16777215,1),this.changeVisibilityOfSelectedObjects(!1);var w=this.renderScene.background;if(this.renderScene.background=null,this.renderScene.overrideMaterial=this.depthMaterial,e.setRenderTarget(this.renderTargetDepthBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.changeVisibilityOfSelectedObjects(!0),this.updateTextureMatrix(),this.changeVisibilityOfNonSelectedObjects(!1),this.renderScene.overrideMaterial=this.prepareMaskMaterial,this.prepareMaskMaterial.uniforms.cameraNearFar.value.set(this.renderCamera.near,this.renderCamera.far),this.prepareMaskMaterial.uniforms.depthTexture.value=this.renderTargetDepthBuffer.texture,this.prepareMaskMaterial.uniforms.textureMatrix.value=this.textureMatrix,e.setRenderTarget(this.renderTargetMaskBuffer),e.clear(),e.render(this.renderScene,this.renderCamera),this.renderScene.overrideMaterial=null,this.changeVisibilityOfNonSelectedObjects(!0),this.renderScene.background=w,this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetMaskBuffer.texture,e.setRenderTarget(this.renderTargetMaskDownSampleBuffer),e.clear(),this.fsQuad.render(e),this.tempPulseColor1.copy(this.visibleEdgeColor),this.tempPulseColor2.copy(this.hiddenEdgeColor),this.pulsePeriod>0){var _=.625+.75*Math.cos(.01*performance.now()/this.pulsePeriod)/2;this.tempPulseColor1.multiplyScalar(_),this.tempPulseColor2.multiplyScalar(_)}this.fsQuad.material=this.edgeDetectionMaterial,this.edgeDetectionMaterial.uniforms.maskTexture.value=this.renderTargetMaskDownSampleBuffer.texture,this.edgeDetectionMaterial.uniforms.texSize.value.set(this.renderTargetMaskDownSampleBuffer.width,this.renderTargetMaskDownSampleBuffer.height),this.edgeDetectionMaterial.uniforms.visibleEdgeColor.value=this.tempPulseColor1,this.edgeDetectionMaterial.uniforms.hiddenEdgeColor.value=this.tempPulseColor2,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial1,this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=OutlinePass.BlurDirectionX,this.separableBlurMaterial1.uniforms.kernelRadius.value=this.edgeThickness,e.setRenderTarget(this.renderTargetBlurBuffer1),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial1.uniforms.colorTexture.value=this.renderTargetBlurBuffer1.texture,this.separableBlurMaterial1.uniforms.direction.value=OutlinePass.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer1),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.separableBlurMaterial2,this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetEdgeBuffer1.texture,this.separableBlurMaterial2.uniforms.direction.value=OutlinePass.BlurDirectionX,e.setRenderTarget(this.renderTargetBlurBuffer2),e.clear(),this.fsQuad.render(e),this.separableBlurMaterial2.uniforms.colorTexture.value=this.renderTargetBlurBuffer2.texture,this.separableBlurMaterial2.uniforms.direction.value=OutlinePass.BlurDirectionY,e.setRenderTarget(this.renderTargetEdgeBuffer2),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.overlayMaterial,this.overlayMaterial.uniforms.maskTexture.value=this.renderTargetMaskBuffer.texture,this.overlayMaterial.uniforms.edgeTexture1.value=this.renderTargetEdgeBuffer1.texture,this.overlayMaterial.uniforms.edgeTexture2.value=this.renderTargetEdgeBuffer2.texture,this.overlayMaterial.uniforms.patternTexture.value=this.patternTexture,this.overlayMaterial.uniforms.edgeStrength.value=this.edgeStrength,this.overlayMaterial.uniforms.edgeGlow.value=this.edgeGlow,this.overlayMaterial.uniforms.usePatternTexture.value=this.usePatternTexture,g&&e.state.buffers.stencil.setTest(!0),e.setRenderTarget(d),this.fsQuad.render(e),e.setClearColor(this.oldClearColor,this.oldClearAlpha),e.autoClear=C}this.renderToScreen&&(this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=d.texture,e.setRenderTarget(null),this.fsQuad.render(e))},getPrepareMaskMaterial:function(){return new ShaderMaterial({uniforms:{depthTexture:{value:null},cameraNearFar:{value:new Vector2(.5,.5)},textureMatrix:{value:null}},vertexShader:["#include <morphtarget_pars_vertex>","#include <skinning_pars_vertex>","varying vec4 projTexCoord;","varying vec4 vPosition;","uniform mat4 textureMatrix;","void main() {","\t#include <skinbase_vertex>","\t#include <begin_vertex>","\t#include <morphtarget_vertex>","\t#include <skinning_vertex>","\t#include <project_vertex>","\tvPosition = mvPosition;","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tprojTexCoord = textureMatrix * worldPosition;","}"].join("\n"),fragmentShader:["#include <packing>","varying vec4 vPosition;","varying vec4 projTexCoord;","uniform sampler2D depthTexture;","uniform vec2 cameraNearFar;","void main() {","\tfloat depth = unpackRGBAToDepth(texture2DProj( depthTexture, projTexCoord ));","\tfloat viewZ = - DEPTH_TO_VIEW_Z( depth, cameraNearFar.x, cameraNearFar.y );","\tfloat depthTest = (-vPosition.z > viewZ) ? 1.0 : 0.0;","\tgl_FragColor = vec4(0.0, depthTest, 1.0, 1.0);","}"].join("\n")})},getEdgeDetectionMaterial:function(){return new ShaderMaterial({uniforms:{maskTexture:{value:null},texSize:{value:new Vector2(.5,.5)},visibleEdgeColor:{value:new Vector3(1,1,1)},hiddenEdgeColor:{value:new Vector3(1,1,1)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec3 visibleEdgeColor;\t\t\t\tuniform vec3 hiddenEdgeColor;\t\t\t\t\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tvec4 uvOffset = vec4(1.0, 0.0, 0.0, 1.0) * vec4(invSize, invSize);\t\t\t\t\tvec4 c1 = texture2D( maskTexture, vUv + uvOffset.xy);\t\t\t\t\tvec4 c2 = texture2D( maskTexture, vUv - uvOffset.xy);\t\t\t\t\tvec4 c3 = texture2D( maskTexture, vUv + uvOffset.yw);\t\t\t\t\tvec4 c4 = texture2D( maskTexture, vUv - uvOffset.yw);\t\t\t\t\tfloat diff1 = (c1.r - c2.r)*0.5;\t\t\t\t\tfloat diff2 = (c3.r - c4.r)*0.5;\t\t\t\t\tfloat d = length( vec2(diff1, diff2) );\t\t\t\t\tfloat a1 = min(c1.g, c2.g);\t\t\t\t\tfloat a2 = min(c3.g, c4.g);\t\t\t\t\tfloat visibilityFactor = min(a1, a2);\t\t\t\t\tvec3 edgeColor = 1.0 - visibilityFactor > 0.001 ? visibleEdgeColor : hiddenEdgeColor;\t\t\t\t\tgl_FragColor = vec4(edgeColor, 1.0) * vec4(d);\t\t\t\t}"})},getSeperableBlurMaterial:function(e){return new ShaderMaterial({defines:{MAX_RADIUS:e},uniforms:{colorTexture:{value:null},texSize:{value:new Vector2(.5,.5)},direction:{value:new Vector2(.5,.5)},kernelRadius:{value:1}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\tvarying vec2 vUv;\t\t\t\tuniform sampler2D colorTexture;\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\tuniform float kernelRadius;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, kernelRadius);\t\t\t\t\tvec4 diffuseSum = texture2D( colorTexture, vUv) * weightSum;\t\t\t\t\tvec2 delta = direction * invSize * kernelRadius/float(MAX_RADIUS);\t\t\t\t\tvec2 uvOffset = delta;\t\t\t\t\tfor( int i = 1; i <= MAX_RADIUS; i ++ ) {\t\t\t\t\t\tfloat w = gaussianPdf(uvOffset.x, kernelRadius);\t\t\t\t\t\tvec4 sample1 = texture2D( colorTexture, vUv + uvOffset);\t\t\t\t\t\tvec4 sample2 = texture2D( colorTexture, vUv - uvOffset);\t\t\t\t\t\tdiffuseSum += ((sample1 + sample2) * w);\t\t\t\t\t\tweightSum += (2.0 * w);\t\t\t\t\t\tuvOffset += delta;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = diffuseSum/weightSum;\t\t\t\t}"})},getOverlayMaterial:function(){return new ShaderMaterial({uniforms:{maskTexture:{value:null},edgeTexture1:{value:null},edgeTexture2:{value:null},patternTexture:{value:null},edgeStrength:{value:1},edgeGlow:{value:1},usePatternTexture:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D maskTexture;\t\t\t\tuniform sampler2D edgeTexture1;\t\t\t\tuniform sampler2D edgeTexture2;\t\t\t\tuniform sampler2D patternTexture;\t\t\t\tuniform float edgeStrength;\t\t\t\tuniform float edgeGlow;\t\t\t\tuniform bool usePatternTexture;\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tvec4 edgeValue1 = texture2D(edgeTexture1, vUv);\t\t\t\t\tvec4 edgeValue2 = texture2D(edgeTexture2, vUv);\t\t\t\t\tvec4 maskColor = texture2D(maskTexture, vUv);\t\t\t\t\tvec4 patternColor = texture2D(patternTexture, 6.0 * vUv);\t\t\t\t\tfloat visibilityFactor = 1.0 - maskColor.g > 0.0 ? 1.0 : 0.5;\t\t\t\t\tvec4 edgeValue = edgeValue1 + edgeValue2 * edgeGlow;\t\t\t\t\tvec4 finalColor = edgeStrength * maskColor.r * edgeValue;\t\t\t\t\tif(usePatternTexture)\t\t\t\t\t\tfinalColor += + visibilityFactor * (1.0 - maskColor.r) * (1.0 - patternColor.r);\t\t\t\t\tgl_FragColor = finalColor;\t\t\t\t}",blending:AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0})}}),OutlinePass.BlurDirectionX=new Vector2(1,0),OutlinePass.BlurDirectionY=new Vector2(0,1);var RenderPass=function(e,a,d,v,g){Pass.call(this),this.scene=e,this.camera=a,this.overrideMaterial=d,this.clearColor=v,this.clearAlpha=void 0!==g?g:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1};function DepthTexture(s,e,a,d,v,g,C,w,_,x){if((x=void 0!==x?x:DepthFormat)!==DepthFormat&&x!==DepthStencilFormat)throw new Error("DepthTexture format must be either DepthFormat or DepthStencilFormat");void 0===a&&x===DepthFormat&&(a=UnsignedShortType),void 0===a&&x===DepthStencilFormat&&(a=UnsignedInt248Type),Texture.call(this,null,d,v,g,C,w,x,a,_),this.image={width:s,height:e},this.magFilter=void 0!==C?C:NearestFilter,this.minFilter=void 0!==w?w:NearestFilter,this.flipY=!1,this.generateMipmaps=!1}RenderPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:RenderPass,render:function(e,a,d){var g,C,v=e.autoClear;e.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(g=e.getClearColor().getHex(),C=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:d),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(g,C),this.scene.overrideMaterial=null,e.autoClear=v}}),DepthTexture.prototype=Object.create(Texture.prototype),DepthTexture.prototype.constructor=DepthTexture,DepthTexture.prototype.isDepthTexture=!0;var SAOShader={defines:{NUM_SAMPLES:7,NUM_RINGS:4,NORMAL_TEXTURE:0,DIFFUSE_TEXTURE:0,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDepth:{value:null},tDiffuse:{value:null},tNormal:{value:null},size:{value:new Vector2(512,512)},cameraNear:{value:1},cameraFar:{value:100},cameraProjectionMatrix:{value:new Matrix4},cameraInverseProjectionMatrix:{value:new Matrix4},scale:{value:1},intensity:{value:.1},bias:{value:.5},minResolution:{value:0},kernelRadius:{value:100},randomSeed:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","varying vec2 vUv;","#if DIFFUSE_TEXTURE == 1","uniform sampler2D tDiffuse;","#endif","uniform sampler2D tDepth;","#if NORMAL_TEXTURE == 1","uniform sampler2D tNormal;","#endif","uniform float cameraNear;","uniform float cameraFar;","uniform mat4 cameraProjectionMatrix;","uniform mat4 cameraInverseProjectionMatrix;","uniform float scale;","uniform float intensity;","uniform float bias;","uniform float kernelRadius;","uniform float minResolution;","uniform vec2 size;","uniform float randomSeed;","// RGBA depth","#include <packing>","vec4 getDefaultColor( const in vec2 screenPosition ) {","\t#if DIFFUSE_TEXTURE == 1","\treturn texture2D( tDiffuse, vUv );","\t#else","\treturn vec4( 1.0 );","\t#endif","}","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","\t#else","\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );","\t#endif","}","vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {","\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];","\tvec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );","\tclipPosition *= clipW; // unprojection.","\treturn ( cameraInverseProjectionMatrix * clipPosition ).xyz;","}","vec3 getViewNormal( const in vec3 viewPosition, const in vec2 screenPosition ) {","\t#if NORMAL_TEXTURE == 1","\treturn unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );","\t#else","\treturn normalize( cross( dFdx( viewPosition ), dFdy( viewPosition ) ) );","\t#endif","}","float scaleDividedByCameraFar;","float minResolutionMultipliedByCameraFar;","float getOcclusion( const in vec3 centerViewPosition, const in vec3 centerViewNormal, const in vec3 sampleViewPosition ) {","\tvec3 viewDelta = sampleViewPosition - centerViewPosition;","\tfloat viewDistance = length( viewDelta );","\tfloat scaledScreenDistance = scaleDividedByCameraFar * viewDistance;","\treturn max(0.0, (dot(centerViewNormal, viewDelta) - minResolutionMultipliedByCameraFar) / scaledScreenDistance - bias) / (1.0 + pow2( scaledScreenDistance ) );","}","// moving costly divides into consts","const float ANGLE_STEP = PI2 * float( NUM_RINGS ) / float( NUM_SAMPLES );","const float INV_NUM_SAMPLES = 1.0 / float( NUM_SAMPLES );","float getAmbientOcclusion( const in vec3 centerViewPosition ) {","\t// precompute some variables require in getOcclusion.","\tscaleDividedByCameraFar = scale / cameraFar;","\tminResolutionMultipliedByCameraFar = minResolution * cameraFar;","\tvec3 centerViewNormal = getViewNormal( centerViewPosition, vUv );","\t// jsfiddle that shows sample pattern: https://jsfiddle.net/a16ff1p7/","\tfloat angle = rand( vUv + randomSeed ) * PI2;","\tvec2 radius = vec2( kernelRadius * INV_NUM_SAMPLES ) / size;","\tvec2 radiusStep = radius;","\tfloat occlusionSum = 0.0;","\tfloat weightSum = 0.0;","\tfor( int i = 0; i < NUM_SAMPLES; i ++ ) {","\t\tvec2 sampleUv = vUv + vec2( cos( angle ), sin( angle ) ) * radius;","\t\tradius += radiusStep;","\t\tangle += ANGLE_STEP;","\t\tfloat sampleDepth = getDepth( sampleUv );","\t\tif( sampleDepth >= ( 1.0 - EPSILON ) ) {","\t\t\tcontinue;","\t\t}","\t\tfloat sampleViewZ = getViewZ( sampleDepth );","\t\tvec3 sampleViewPosition = getViewPosition( sampleUv, sampleDepth, sampleViewZ );","\t\tocclusionSum += getOcclusion( centerViewPosition, centerViewNormal, sampleViewPosition );","\t\tweightSum += 1.0;","\t}","\tif( weightSum == 0.0 ) discard;","\treturn occlusionSum * ( intensity / weightSum );","}","void main() {","\tfloat centerDepth = getDepth( vUv );","\tif( centerDepth >= ( 1.0 - EPSILON ) ) {","\t\tdiscard;","\t}","\tfloat centerViewZ = getViewZ( centerDepth );","\tvec3 viewPosition = getViewPosition( vUv, centerDepth, centerViewZ );","\tfloat ambientOcclusion = getAmbientOcclusion( viewPosition );","\tgl_FragColor = getDefaultColor( vUv );","\tgl_FragColor.xyz *=  1.0 - ambientOcclusion;","}"].join("\n")},DepthLimitedBlurShader={defines:{KERNEL_RADIUS:4,DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tDiffuse:{value:null},size:{value:new Vector2(512,512)},sampleUvOffsets:{value:[new Vector2(0,0)]},sampleWeights:{value:[1]},tDepth:{value:null},cameraNear:{value:10},cameraFar:{value:1e3},depthCutoff:{value:10}},vertexShader:["#include <common>","uniform vec2 size;","varying vec2 vUv;","varying vec2 vInvSize;","void main() {","\tvUv = uv;","\tvInvSize = 1.0 / size;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","#include <packing>","uniform sampler2D tDiffuse;","uniform sampler2D tDepth;","uniform float cameraNear;","uniform float cameraFar;","uniform float depthCutoff;","uniform vec2 sampleUvOffsets[ KERNEL_RADIUS + 1 ];","uniform float sampleWeights[ KERNEL_RADIUS + 1 ];","varying vec2 vUv;","varying vec2 vInvSize;","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","\t#else","\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );","\t#endif","}","void main() {","\tfloat depth = getDepth( vUv );","\tif( depth >= ( 1.0 - EPSILON ) ) {","\t\tdiscard;","\t}","\tfloat centerViewZ = -getViewZ( depth );","\tbool rBreak = false, lBreak = false;","\tfloat weightSum = sampleWeights[0];","\tvec4 diffuseSum = texture2D( tDiffuse, vUv ) * weightSum;","\tfor( int i = 1; i <= KERNEL_RADIUS; i ++ ) {","\t\tfloat sampleWeight = sampleWeights[i];","\t\tvec2 sampleUvOffset = sampleUvOffsets[i] * vInvSize;","\t\tvec2 sampleUv = vUv + sampleUvOffset;","\t\tfloat viewZ = -getViewZ( getDepth( sampleUv ) );","\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) rBreak = true;","\t\tif( ! rBreak ) {","\t\t\tdiffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;","\t\t\tweightSum += sampleWeight;","\t\t}","\t\tsampleUv = vUv - sampleUvOffset;","\t\tviewZ = -getViewZ( getDepth( sampleUv ) );","\t\tif( abs( viewZ - centerViewZ ) > depthCutoff ) lBreak = true;","\t\tif( ! lBreak ) {","\t\t\tdiffuseSum += texture2D( tDiffuse, sampleUv ) * sampleWeight;","\t\t\tweightSum += sampleWeight;","\t\t}","\t}","\tgl_FragColor = diffuseSum / weightSum;","}"].join("\n")},BlurShaderUtils={createSampleWeights:function(e,a){for(var v=[],g=0;g<=e;g++)v.push((w=g,_=a,Math.exp(-w*w/(_*_*2))/(Math.sqrt(2*Math.PI)*_)));var w,_;return v},createSampleOffsets:function(e,a){for(var d=[],v=0;v<=e;v++)d.push(a.clone().multiplyScalar(v));return d},configure:function(e,a,d,v){e.defines.KERNEL_RADIUS=a,e.uniforms.sampleUvOffsets.value=BlurShaderUtils.createSampleOffsets(a,v),e.uniforms.sampleWeights.value=BlurShaderUtils.createSampleWeights(a,d),e.needsUpdate=!0}},UnpackDepthRGBAShader={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","#include <packing>","void main() {","\tfloat depth = 1.0 - unpackRGBAToDepth( texture2D( tDiffuse, vUv ) );","\tgl_FragColor = vec4( vec3( depth ), opacity );","}"].join("\n")},SAOPass=function(e,a,d,v,g){Pass.call(this),this.scene=e,this.camera=a,this.clear=!0,this.needsSwap=!1,this.supportsDepthTextureExtension=void 0!==d&&d,this.supportsNormalTexture=void 0!==v&&v,this.originalClearColor=new Color,this.oldClearColor=new Color,this.oldClearAlpha=1,this.params={output:0,saoBias:.5,saoIntensity:.18,saoScale:1,saoKernelRadius:100,saoMinResolution:0,saoBlur:!0,saoBlurRadius:8,saoBlurStdDev:4,saoBlurDepthCutoff:.01},this.resolution=void 0!==g?new Vector2(g.x,g.y):new Vector2(256,256),this.saoRenderTarget=new WebGLRenderTarget(this.resolution.x,this.resolution.y,{minFilter:LinearFilter,magFilter:LinearFilter,format:RGBAFormat}),this.blurIntermediateRenderTarget=this.saoRenderTarget.clone(),this.beautyRenderTarget=this.saoRenderTarget.clone(),this.normalRenderTarget=new WebGLRenderTarget(this.resolution.x,this.resolution.y,{minFilter:NearestFilter,magFilter:NearestFilter,format:RGBAFormat}),this.depthRenderTarget=this.normalRenderTarget.clone(),this.supportsDepthTextureExtension&&((d=new DepthTexture).type=UnsignedShortType,d.minFilter=NearestFilter,d.maxFilter=NearestFilter,this.beautyRenderTarget.depthTexture=d,this.beautyRenderTarget.depthBuffer=!0),this.depthMaterial=new MeshDepthMaterial,this.depthMaterial.depthPacking=RGBADepthPacking,this.depthMaterial.blending=NoBlending,this.normalMaterial=new MeshNormalMaterial,this.normalMaterial.blending=NoBlending,void 0===SAOShader&&console.error("SAOPass relies on SAOShader"),this.saoMaterial=new ShaderMaterial({defines:Object.assign({},SAOShader.defines),fragmentShader:SAOShader.fragmentShader,vertexShader:SAOShader.vertexShader,uniforms:UniformsUtils.clone(SAOShader.uniforms)}),this.saoMaterial.extensions.derivatives=!0,this.saoMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.saoMaterial.defines.NORMAL_TEXTURE=this.supportsNormalTexture?1:0,this.saoMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.saoMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?d:this.depthRenderTarget.texture,this.saoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.saoMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.getInverse(this.camera.projectionMatrix),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.blending=NoBlending,void 0===DepthLimitedBlurShader&&console.error("SAOPass relies on DepthLimitedBlurShader"),this.vBlurMaterial=new ShaderMaterial({uniforms:UniformsUtils.clone(DepthLimitedBlurShader.uniforms),defines:Object.assign({},DepthLimitedBlurShader.defines),vertexShader:DepthLimitedBlurShader.vertexShader,fragmentShader:DepthLimitedBlurShader.fragmentShader}),this.vBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.vBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.vBlurMaterial.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.vBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?d:this.depthRenderTarget.texture,this.vBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.vBlurMaterial.blending=NoBlending,this.hBlurMaterial=new ShaderMaterial({uniforms:UniformsUtils.clone(DepthLimitedBlurShader.uniforms),defines:Object.assign({},DepthLimitedBlurShader.defines),vertexShader:DepthLimitedBlurShader.vertexShader,fragmentShader:DepthLimitedBlurShader.fragmentShader}),this.hBlurMaterial.defines.DEPTH_PACKING=this.supportsDepthTextureExtension?0:1,this.hBlurMaterial.defines.PERSPECTIVE_CAMERA=this.camera.isPerspectiveCamera?1:0,this.hBlurMaterial.uniforms.tDiffuse.value=this.blurIntermediateRenderTarget.texture,this.hBlurMaterial.uniforms.tDepth.value=this.supportsDepthTextureExtension?d:this.depthRenderTarget.texture,this.hBlurMaterial.uniforms.size.value.set(this.resolution.x,this.resolution.y),this.hBlurMaterial.blending=NoBlending,void 0===CopyShader&&console.error("SAOPass relies on CopyShader"),this.materialCopy=new ShaderMaterial({uniforms:UniformsUtils.clone(CopyShader.uniforms),vertexShader:CopyShader.vertexShader,fragmentShader:CopyShader.fragmentShader,blending:NoBlending}),this.materialCopy.transparent=!0,this.materialCopy.depthTest=!1,this.materialCopy.depthWrite=!1,this.materialCopy.blending=CustomBlending,this.materialCopy.blendSrc=DstColorFactor,this.materialCopy.blendDst=ZeroFactor,this.materialCopy.blendEquation=AddEquation,this.materialCopy.blendSrcAlpha=DstAlphaFactor,this.materialCopy.blendDstAlpha=ZeroFactor,this.materialCopy.blendEquationAlpha=AddEquation,void 0===UnpackDepthRGBAShader&&console.error("SAOPass relies on UnpackDepthRGBAShader"),this.depthCopy=new ShaderMaterial({uniforms:UniformsUtils.clone(UnpackDepthRGBAShader.uniforms),vertexShader:UnpackDepthRGBAShader.vertexShader,fragmentShader:UnpackDepthRGBAShader.fragmentShader,blending:NoBlending}),this.fsQuad=new Pass.FullScreenQuad(null)};SAOPass.OUTPUT={Beauty:1,Default:0,SAO:2,Depth:3,Normal:4},SAOPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:SAOPass,render:function(e,a,d){if(this.renderToScreen&&(this.materialCopy.blending=NoBlending,this.materialCopy.uniforms.tDiffuse.value=d.texture,this.materialCopy.needsUpdate=!0,this.renderPass(e,this.materialCopy,null)),1!==this.params.output){this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha();var v=e.autoClear;e.autoClear=!1,e.setRenderTarget(this.depthRenderTarget),e.clear(),this.saoMaterial.uniforms.bias.value=this.params.saoBias,this.saoMaterial.uniforms.intensity.value=this.params.saoIntensity,this.saoMaterial.uniforms.scale.value=this.params.saoScale,this.saoMaterial.uniforms.kernelRadius.value=this.params.saoKernelRadius,this.saoMaterial.uniforms.minResolution.value=this.params.saoMinResolution,this.saoMaterial.uniforms.cameraNear.value=this.camera.near,this.saoMaterial.uniforms.cameraFar.value=this.camera.far;var g=this.params.saoBlurDepthCutoff*(this.camera.far-this.camera.near);this.vBlurMaterial.uniforms.depthCutoff.value=g,this.hBlurMaterial.uniforms.depthCutoff.value=g,this.vBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.vBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.hBlurMaterial.uniforms.cameraNear.value=this.camera.near,this.hBlurMaterial.uniforms.cameraFar.value=this.camera.far,this.params.saoBlurRadius=Math.floor(this.params.saoBlurRadius),(this.prevStdDev!==this.params.saoBlurStdDev||this.prevNumSamples!==this.params.saoBlurRadius)&&(BlurShaderUtils.configure(this.vBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new Vector2(0,1)),BlurShaderUtils.configure(this.hBlurMaterial,this.params.saoBlurRadius,this.params.saoBlurStdDev,new Vector2(1,0)),this.prevStdDev=this.params.saoBlurStdDev,this.prevNumSamples=this.params.saoBlurRadius),e.setClearColor(0),e.setRenderTarget(this.beautyRenderTarget),e.clear(),e.render(this.scene,this.camera),this.supportsDepthTextureExtension||this.renderOverride(e,this.depthMaterial,this.depthRenderTarget,0,1),this.supportsNormalTexture&&this.renderOverride(e,this.normalMaterial,this.normalRenderTarget,7829503,1),this.renderPass(e,this.saoMaterial,this.saoRenderTarget,16777215,1),this.params.saoBlur&&(this.renderPass(e,this.vBlurMaterial,this.blurIntermediateRenderTarget,16777215,1),this.renderPass(e,this.hBlurMaterial,this.saoRenderTarget,16777215,1));var C=this.materialCopy;3===this.params.output?this.supportsDepthTextureExtension?(this.materialCopy.uniforms.tDiffuse.value=this.beautyRenderTarget.depthTexture,this.materialCopy.needsUpdate=!0):(this.depthCopy.uniforms.tDiffuse.value=this.depthRenderTarget.texture,this.depthCopy.needsUpdate=!0,C=this.depthCopy):4===this.params.output?(this.materialCopy.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.materialCopy.needsUpdate=!0):(this.materialCopy.uniforms.tDiffuse.value=this.saoRenderTarget.texture,this.materialCopy.needsUpdate=!0),C.blending=0===this.params.output?CustomBlending:NoBlending,this.renderPass(e,C,this.renderToScreen?null:d),e.setClearColor(this.oldClearColor,this.oldClearAlpha),e.autoClear=v}},renderPass:function(e,a,d,v,g){this.originalClearColor.copy(e.getClearColor());var C=e.getClearAlpha(),w=e.autoClear;e.setRenderTarget(d),e.autoClear=!1,null!=v&&(e.setClearColor(v),e.setClearAlpha(g||0),e.clear()),this.fsQuad.material=a,this.fsQuad.render(e),e.autoClear=w,e.setClearColor(this.originalClearColor),e.setClearAlpha(C)},renderOverride:function(e,a,d,v,g){this.originalClearColor.copy(e.getClearColor());var C=e.getClearAlpha(),w=e.autoClear;e.setRenderTarget(d),e.autoClear=!1,g=a.clearAlpha||g,null!=(v=a.clearColor||v)&&(e.setClearColor(v),e.setClearAlpha(g||0),e.clear()),this.scene.overrideMaterial=a,e.render(this.scene,this.camera),this.scene.overrideMaterial=null,e.autoClear=w,e.setClearColor(this.originalClearColor),e.setClearAlpha(C)},setSize:function(e,a){this.beautyRenderTarget.setSize(e,a),this.saoRenderTarget.setSize(e,a),this.blurIntermediateRenderTarget.setSize(e,a),this.normalRenderTarget.setSize(e,a),this.depthRenderTarget.setSize(e,a),this.saoMaterial.uniforms.size.value.set(e,a),this.saoMaterial.uniforms.cameraInverseProjectionMatrix.value.getInverse(this.camera.projectionMatrix),this.saoMaterial.uniforms.cameraProjectionMatrix.value=this.camera.projectionMatrix,this.saoMaterial.needsUpdate=!0,this.vBlurMaterial.uniforms.size.value.set(e,a),this.vBlurMaterial.needsUpdate=!0,this.hBlurMaterial.uniforms.size.value.set(e,a),this.hBlurMaterial.needsUpdate=!0}});var SavePass=function(e){Pass.call(this),void 0===CopyShader&&console.error("SavePass relies on CopyShader");var a=CopyShader;this.textureID="tDiffuse",this.uniforms=UniformsUtils.clone(a.uniforms),this.material=new ShaderMaterial({uniforms:this.uniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader}),this.renderTarget=e,void 0===this.renderTarget&&(this.renderTarget=new WebGLRenderTarget(window.innerWidth,window.innerHeight,{minFilter:LinearFilter,magFilter:LinearFilter,format:RGBFormat,stencilBuffer:!1}),this.renderTarget.texture.name="SavePass.rt"),this.needsSwap=!1,this.fsQuad=new Pass.FullScreenQuad(this.material)};SavePass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:SavePass,render:function(e,a,d){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=d.texture),e.setRenderTarget(this.renderTarget),this.clear&&e.clear(),this.fsQuad.render(e)}});var SMAAEdgesShader={defines:{SMAA_THRESHOLD:"0.1"},uniforms:{tDiffuse:{value:null},resolution:{value:new Vector2(1/1024,1/512)}},vertexShader:["uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[ 3 ];","void SMAAEdgeDetectionVS( vec2 texcoord ) {","\tvOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 );","\tvOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 );","\tvOffset[ 2 ] = texcoord.xyxy + resolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 );","}","void main() {","\tvUv = uv;","\tSMAAEdgeDetectionVS( vUv );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","varying vec4 vOffset[ 3 ];","vec4 SMAAColorEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {","\tvec2 threshold = vec2( SMAA_THRESHOLD, SMAA_THRESHOLD );","\tvec4 delta;","\tvec3 C = texture2D( colorTex, texcoord ).rgb;","\tvec3 Cleft = texture2D( colorTex, offset[0].xy ).rgb;","\tvec3 t = abs( C - Cleft );","\tdelta.x = max( max( t.r, t.g ), t.b );","\tvec3 Ctop = texture2D( colorTex, offset[0].zw ).rgb;","\tt = abs( C - Ctop );","\tdelta.y = max( max( t.r, t.g ), t.b );","\tvec2 edges = step( threshold, delta.xy );","\tif ( dot( edges, vec2( 1.0, 1.0 ) ) == 0.0 )","\t\tdiscard;","\tvec3 Cright = texture2D( colorTex, offset[1].xy ).rgb;","\tt = abs( C - Cright );","\tdelta.z = max( max( t.r, t.g ), t.b );","\tvec3 Cbottom  = texture2D( colorTex, offset[1].zw ).rgb;","\tt = abs( C - Cbottom );","\tdelta.w = max( max( t.r, t.g ), t.b );","\tfloat maxDelta = max( max( max( delta.x, delta.y ), delta.z ), delta.w );","\tvec3 Cleftleft  = texture2D( colorTex, offset[2].xy ).rgb;","\tt = abs( C - Cleftleft );","\tdelta.z = max( max( t.r, t.g ), t.b );","\tvec3 Ctoptop = texture2D( colorTex, offset[2].zw ).rgb;","\tt = abs( C - Ctoptop );","\tdelta.w = max( max( t.r, t.g ), t.b );","\tmaxDelta = max( max( maxDelta, delta.z ), delta.w );","\tedges.xy *= step( 0.5 * maxDelta, delta.xy );","\treturn vec4( edges, 0.0, 0.0 );","}","void main() {","\tgl_FragColor = SMAAColorEdgeDetectionPS( vUv, vOffset, tDiffuse );","}"].join("\n")},SMAAWeightsShader={defines:{SMAA_MAX_SEARCH_STEPS:"8",SMAA_AREATEX_MAX_DISTANCE:"16",SMAA_AREATEX_PIXEL_SIZE:"( 1.0 / vec2( 160.0, 560.0 ) )",SMAA_AREATEX_SUBTEX_SIZE:"( 1.0 / 7.0 )"},uniforms:{tDiffuse:{value:null},tArea:{value:null},tSearch:{value:null},resolution:{value:new Vector2(1/1024,1/512)}},vertexShader:["uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[ 3 ];","varying vec2 vPixcoord;","void SMAABlendingWeightCalculationVS( vec2 texcoord ) {","\tvPixcoord = texcoord / resolution;","\tvOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 );","\tvOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 );","\tvOffset[ 2 ] = vec4( vOffset[ 0 ].xz, vOffset[ 1 ].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * resolution.xxyy * float( SMAA_MAX_SEARCH_STEPS );","}","void main() {","\tvUv = uv;","\tSMAABlendingWeightCalculationVS( vUv );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )","uniform sampler2D tDiffuse;","uniform sampler2D tArea;","uniform sampler2D tSearch;","uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[3];","varying vec2 vPixcoord;","#if __VERSION__ == 100","vec2 round( vec2 x ) {","\treturn sign( x ) * floor( abs( x ) + 0.5 );","}","#endif","float SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {","\te.r = bias + e.r * scale;","\treturn 255.0 * texture2D( searchTex, e, 0.0 ).r;","}","float SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {","\tvec2 e = vec2( 0.0, 1.0 );","\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {","\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;","\t\ttexcoord -= vec2( 2.0, 0.0 ) * resolution;","\t\tif ( ! ( texcoord.x > end && e.g > 0.8281 && e.r == 0.0 ) ) break;","\t}","\ttexcoord.x += 0.25 * resolution.x;","\ttexcoord.x += resolution.x;","\ttexcoord.x += 2.0 * resolution.x;","\ttexcoord.x -= resolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);","\treturn texcoord.x;","}","float SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {","\tvec2 e = vec2( 0.0, 1.0 );","\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {","\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;","\t\ttexcoord += vec2( 2.0, 0.0 ) * resolution;","\t\tif ( ! ( texcoord.x < end && e.g > 0.8281 && e.r == 0.0 ) ) break;","\t}","\ttexcoord.x -= 0.25 * resolution.x;","\ttexcoord.x -= resolution.x;","\ttexcoord.x -= 2.0 * resolution.x;","\ttexcoord.x += resolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );","\treturn texcoord.x;","}","float SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {","\tvec2 e = vec2( 1.0, 0.0 );","\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {","\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;","\t\ttexcoord += vec2( 0.0, 2.0 ) * resolution;","\t\tif ( ! ( texcoord.y > end && e.r > 0.8281 && e.g == 0.0 ) ) break;","\t}","\ttexcoord.y -= 0.25 * resolution.y;","\ttexcoord.y -= resolution.y;","\ttexcoord.y -= 2.0 * resolution.y;","\ttexcoord.y += resolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 );","\treturn texcoord.y;","}","float SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {","\tvec2 e = vec2( 1.0, 0.0 );","\tfor ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {","\t\te = texture2D( edgesTex, texcoord, 0.0 ).rg;","\t\ttexcoord -= vec2( 0.0, 2.0 ) * resolution;","\t\tif ( ! ( texcoord.y < end && e.r > 0.8281 && e.g == 0.0 ) ) break;","\t}","\ttexcoord.y += 0.25 * resolution.y;","\ttexcoord.y += resolution.y;","\ttexcoord.y += 2.0 * resolution.y;","\ttexcoord.y -= resolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 );","\treturn texcoord.y;","}","vec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {","\tvec2 texcoord = float( SMAA_AREATEX_MAX_DISTANCE ) * round( 4.0 * vec2( e1, e2 ) ) + dist;","\ttexcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );","\ttexcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;","\treturn texture2D( areaTex, texcoord, 0.0 ).rg;","}","vec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {","\tvec4 weights = vec4( 0.0, 0.0, 0.0, 0.0 );","\tvec2 e = texture2D( edgesTex, texcoord ).rg;","\tif ( e.g > 0.0 ) {","\t\tvec2 d;","\t\tvec2 coords;","\t\tcoords.x = SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );","\t\tcoords.y = offset[ 1 ].y;","\t\td.x = coords.x;","\t\tfloat e1 = texture2D( edgesTex, coords, 0.0 ).r;","\t\tcoords.x = SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );","\t\td.y = coords.x;","\t\td = d / resolution.x - pixcoord.x;","\t\tvec2 sqrt_d = sqrt( abs( d ) );","\t\tcoords.y -= 1.0 * resolution.y;","\t\tfloat e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 1, 0 ) ).r;","\t\tweights.rg = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );","\t}","\tif ( e.r > 0.0 ) {","\t\tvec2 d;","\t\tvec2 coords;","\t\tcoords.y = SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );","\t\tcoords.x = offset[ 0 ].x;","\t\td.x = coords.y;","\t\tfloat e1 = texture2D( edgesTex, coords, 0.0 ).g;","\t\tcoords.y = SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );","\t\td.y = coords.y;","\t\td = d / resolution.y - pixcoord.y;","\t\tvec2 sqrt_d = sqrt( abs( d ) );","\t\tcoords.y -= 1.0 * resolution.y;","\t\tfloat e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 0, 1 ) ).g;","\t\tweights.ba = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );","\t}","\treturn weights;","}","void main() {","\tgl_FragColor = SMAABlendingWeightCalculationPS( vUv, vPixcoord, vOffset, tDiffuse, tArea, tSearch, ivec4( 0.0 ) );","}"].join("\n")},SMAABlendShader={uniforms:{tDiffuse:{value:null},tColor:{value:null},resolution:{value:new Vector2(1/1024,1/512)}},vertexShader:["uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[ 2 ];","void SMAANeighborhoodBlendingVS( vec2 texcoord ) {","\tvOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 );","\tvOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 );","}","void main() {","\tvUv = uv;","\tSMAANeighborhoodBlendingVS( vUv );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform sampler2D tColor;","uniform vec2 resolution;","varying vec2 vUv;","varying vec4 vOffset[ 2 ];","vec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {","\tvec4 a;","\ta.xz = texture2D( blendTex, texcoord ).xz;","\ta.y = texture2D( blendTex, offset[ 1 ].zw ).g;","\ta.w = texture2D( blendTex, offset[ 1 ].xy ).a;","\tif ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) < 1e-5 ) {","\t\treturn texture2D( colorTex, texcoord, 0.0 );","\t} else {","\t\tvec2 offset;","\t\toffset.x = a.a > a.b ? a.a : -a.b;","\t\toffset.y = a.g > a.r ? -a.g : a.r;","\t\tif ( abs( offset.x ) > abs( offset.y )) {","\t\t\toffset.y = 0.0;","\t\t} else {","\t\t\toffset.x = 0.0;","\t\t}","\t\tvec4 C = texture2D( colorTex, texcoord, 0.0 );","\t\ttexcoord += sign( offset ) * resolution;","\t\tvec4 Cop = texture2D( colorTex, texcoord, 0.0 );","\t\tfloat s = abs( offset.x ) > abs( offset.y ) ? abs( offset.x ) : abs( offset.y );","\t\tC.xyz = pow(C.xyz, vec3(2.2));","\t\tCop.xyz = pow(Cop.xyz, vec3(2.2));","\t\tvec4 mixed = mix(C, Cop, s);","\t\tmixed.xyz = pow(mixed.xyz, vec3(1.0 / 2.2));","\t\treturn mixed;","\t}","}","void main() {","\tgl_FragColor = SMAANeighborhoodBlendingPS( vUv, vOffset, tColor, tDiffuse );","}"].join("\n")},SMAAPass=function(e,a){Pass.call(this),this.edgesRT=new WebGLRenderTarget(e,a,{depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1,minFilter:LinearFilter,format:RGBFormat}),this.edgesRT.texture.name="SMAAPass.edges",this.weightsRT=new WebGLRenderTarget(e,a,{depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1,minFilter:LinearFilter,format:RGBAFormat}),this.weightsRT.texture.name="SMAAPass.weights";var d=this,v=new Image;v.src=this.getAreaTexture(),v.onload=function(){d.areaTexture.needsUpdate=!0},this.areaTexture=new Texture,this.areaTexture.name="SMAAPass.area",this.areaTexture.image=v,this.areaTexture.format=RGBFormat,this.areaTexture.minFilter=LinearFilter,this.areaTexture.generateMipmaps=!1,this.areaTexture.flipY=!1;var g=new Image;g.src=this.getSearchTexture(),g.onload=function(){d.searchTexture.needsUpdate=!0},this.searchTexture=new Texture,this.searchTexture.name="SMAAPass.search",this.searchTexture.image=g,this.searchTexture.magFilter=NearestFilter,this.searchTexture.minFilter=NearestFilter,this.searchTexture.generateMipmaps=!1,this.searchTexture.flipY=!1,void 0===SMAAEdgesShader&&console.error("SMAAPass relies on SMAAShader"),this.uniformsEdges=UniformsUtils.clone(SMAAEdgesShader.uniforms),this.uniformsEdges.resolution.value.set(1/e,1/a),this.materialEdges=new ShaderMaterial({defines:Object.assign({},SMAAEdgesShader.defines),uniforms:this.uniformsEdges,vertexShader:SMAAEdgesShader.vertexShader,fragmentShader:SMAAEdgesShader.fragmentShader}),this.uniformsWeights=UniformsUtils.clone(SMAAWeightsShader.uniforms),this.uniformsWeights.resolution.value.set(1/e,1/a),this.uniformsWeights.tDiffuse.value=this.edgesRT.texture,this.uniformsWeights.tArea.value=this.areaTexture,this.uniformsWeights.tSearch.value=this.searchTexture,this.materialWeights=new ShaderMaterial({defines:Object.assign({},SMAAWeightsShader.defines),uniforms:this.uniformsWeights,vertexShader:SMAAWeightsShader.vertexShader,fragmentShader:SMAAWeightsShader.fragmentShader}),this.uniformsBlend=UniformsUtils.clone(SMAABlendShader.uniforms),this.uniformsBlend.resolution.value.set(1/e,1/a),this.uniformsBlend.tDiffuse.value=this.weightsRT.texture,this.materialBlend=new ShaderMaterial({uniforms:this.uniformsBlend,vertexShader:SMAABlendShader.vertexShader,fragmentShader:SMAABlendShader.fragmentShader}),this.needsSwap=!1,this.fsQuad=new Pass.FullScreenQuad(null)};SMAAPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:SMAAPass,render:function(e,a,d){this.uniformsEdges.tDiffuse.value=d.texture,this.fsQuad.material=this.materialEdges,e.setRenderTarget(this.edgesRT),this.clear&&e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialWeights,e.setRenderTarget(this.weightsRT),this.clear&&e.clear(),this.fsQuad.render(e),this.uniformsBlend.tColor.value=d.texture,this.fsQuad.material=this.materialBlend,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(a),this.clear&&e.clear(),this.fsQuad.render(e))},setSize:function(e,a){this.edgesRT.setSize(e,a),this.weightsRT.setSize(e,a),this.materialEdges.uniforms.resolution.value.set(1/e,1/a),this.materialWeights.uniforms.resolution.value.set(1/e,1/a),this.materialBlend.uniforms.resolution.value.set(1/e,1/a)},getAreaTexture:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAAIwCAIAAACOVPcQAACBeklEQVR42u39W4xlWXrnh/3WWvuciIzMrKxrV8/0rWbY0+SQFKcb4owIkSIFCjY9AC1BT/LYBozRi+EX+cV+8IMsYAaCwRcBwjzMiw2jAWtgwC8WR5Q8mDFHZLNHTarZGrLJJllt1W2qKrsumZWZcTvn7L3W54e1vrXX3vuciLPPORFR1XE2EomorB0nVuz//r71re/y/1eMvb4Cb3N11xV/PP/2v4UBAwJG/7H8urx6/25/Gf8O5hypMQ0EEEQwAqLfoN/Z+97f/SW+/NvcgQk4sGBJK6H7N4PFVL+K+e0N11yNfkKvwUdwdlUAXPHHL38oa15f/i/46Ih6SuMSPmLAYAwyRKn7dfMGH97jaMFBYCJUgotIC2YAdu+LyW9vvubxAP8kAL8H/koAuOKP3+q6+xGnd5kdYCeECnGIJViwGJMAkQKfDvB3WZxjLKGh8VSCCzhwEWBpMc5/kBbjawT4HnwJfhr+pPBIu7uu+OOTo9vsmtQcniMBGkKFd4jDWMSCRUpLjJYNJkM+IRzQ+PQvIeAMTrBS2LEiaiR9b/5PuT6Ap/AcfAFO4Y3dA3DFH7/VS+M8k4baEAQfMI4QfbVDDGIRg7GKaIY52qAjTAgTvGBAPGIIghOCYAUrGFNgzA7Q3QhgCwfwAnwe5vDejgG44o/fbm1C5ZlYQvQDARPAIQGxCWBM+wWl37ZQESb4gImexGMDouhGLx1Cst0Saa4b4AqO4Hk4gxo+3DHAV/nx27p3JziPM2pVgoiia5MdEzCGULprIN7gEEeQ5IQxEBBBQnxhsDb5auGmAAYcHMA9eAAz8PBol8/xij9+C4Djlim4gJjWcwZBhCBgMIIYxGAVIkH3ZtcBuLdtRFMWsPGoY9rN+HoBji9VBYdwD2ZQg4cnO7OSq/z4rU5KKdwVbFAjNojCQzTlCLPFSxtamwh2jMUcEgg2Wm/6XgErIBhBckQtGN3CzbVacERgCnfgLswhnvqf7QyAq/z4rRZm1YglYE3affGITaZsdIe2FmMIpnOCap25I6jt2kCwCW0D1uAD9sZctNGXcQIHCkINDQgc78aCr+zjtw3BU/ijdpw3zhCwcaONwBvdeS2YZKkJNJsMPf2JKEvC28RXxxI0ASJyzQCjCEQrO4Q7sFArEzjZhaFc4cdv+/JFdKULM4px0DfUBI2hIsy06BqLhGTQEVdbfAIZXYMPesq6VoCHICzUyjwInO4Y411//LYLs6TDa9wvg2CC2rElgAnpTBziThxaL22MYhzfkghz6GAs2VHbbdM91VZu1MEEpupMMwKyVTb5ij9+u4VJG/5EgEMMmFF01cFai3isRbKbzb+YaU/MQbAm2XSMoUPAmvZzbuKYRIFApbtlrfFuUGd6vq2hXNnH78ZLh/iFhsQG3T4D1ib7k5CC6vY0DCbtrohgLEIClXiGtl10zc0CnEGIhhatLBva7NP58Tvw0qE8yWhARLQ8h4+AhQSP+I4F5xoU+VilGRJs6wnS7ruti/4KvAY/CfdgqjsMy4pf8fodQO8/gnuX3f/3xi3om1/h7THr+co3x93PP9+FBUfbNUjcjEmhcrkT+8K7ml7V10Jo05mpIEFy1NmCJWx9SIKKt+EjAL4Ez8EBVOB6havuT/rByPvHXK+9zUcfcbb254+9fydJknYnRr1oGfdaiAgpxu1Rx/Rek8KISftx3L+DfsLWAANn8Hvw0/AFeAGO9DFV3c6D+CcWbL8Dj9e7f+T1k8AZv/d7+PXWM/Z+VvdCrIvuAKO09RpEEQJM0Ci6+B4xhTWr4cZNOvhktabw0ta0rSJmqz3Yw5/AKXwenod7cAhTmBSPKf6JBdvH8IP17h95pXqw50/+BFnj88fev4NchyaK47OPhhtI8RFSvAfDSNh0Ck0p2gLxGkib5NJj/JWCr90EWQJvwBzO4AHcgztwAFN1evHPUVGwfXON+0debT1YeGON9Yy9/63X+OguiwmhIhQhD7l4sMqlG3D86Suc3qWZ4rWjI1X7u0Ytw6x3rIMeIOPDprfe2XzNgyj6PahhBjO4C3e6puDgXrdg+/5l948vF3bqwZetZ+z9Rx9zdIY5pInPK4Nk0t+l52xdK2B45Qd87nM8fsD5EfUhIcJcERw4RdqqH7Yde5V7m1vhNmtedkz6EDzUMF/2jJYWbC+4fzzA/Y+/8PPH3j9dcBAPIRP8JLXd5BpAu03aziOL3VVHZzz3CXWDPWd+SH2AnxIqQoTZpo9Ckc6HIrFbAbzNmlcg8Ag8NFDDAhbJvTBZXbC94P7t68EXfv6o+21gUtPETU7bbkLxvNKRFG2+KXzvtObonPP4rBvsgmaKj404DlshFole1Glfh02fE7bYR7dZ82oTewIBGn1Md6CG6YUF26X376oevOLzx95vhUmgblI6LBZwTCDY7vMq0op5WVXgsObOXJ+1x3qaBl9j1FeLxbhU9w1F+Wiba6s1X/TBz1LnUfuYDi4r2C69f1f14BWfP+p+W2GFKuC9phcELMYRRLur9DEZTUdEH+iEqWdaM7X4WOoPGI+ZYD2+wcQ+y+ioHUZ9dTDbArzxmi/bJI9BND0Ynd6lBdve/butBw8+f/T9D3ABa3AG8W3VPX4hBin+bj8dMMmSpp5pg7fJ6xrBFE2WQQEWnV8Qg3FbAWzYfM1rREEnmvkN2o1+acG2d/9u68GDzx91v3mAjb1zkpqT21OipPKO0b9TO5W0nTdOmAQm0TObts3aBKgwARtoPDiCT0gHgwnbArzxmtcLc08HgF1asN0C4Ms/fvD5I+7PhfqyXE/b7RbbrGyRQRT9ARZcwAUmgdoz0ehJ9Fn7QAhUjhDAQSw0bV3T3WbNa59jzmiP6GsWbGXDX2ytjy8+f9T97fiBPq9YeLdBmyuizZHaqXITnXiMUEEVcJ7K4j3BFPurtB4bixW8wTpweL8DC95szWMOqucFYGsWbGU7p3TxxxefP+r+oTVktxY0v5hbq3KiOKYnY8ddJVSBxuMMVffNbxwIOERShst73HZ78DZrHpmJmH3K6sGz0fe3UUj0eyRrSCGTTc+rjVNoGzNSv05srAxUBh8IhqChiQgVNIIBH3AVPnrsnXQZbLTm8ammv8eVXn/vWpaTem5IXRlt+U/LA21zhSb9cye6jcOfCnOwhIAYXAMVTUNV0QhVha9xjgA27ODJbLbmitt3tRN80lqG6N/khgot4ZVlOyO4WNg3OIMzhIZQpUEHieg2im6F91hB3I2tubql6BYNN9Hj5S7G0G2tahslBWKDnOiIvuAEDzakDQKDNFQT6gbn8E2y4BBubM230YIpBnDbMa+y3dx0n1S0BtuG62lCCXwcY0F72T1VRR3t2ONcsmDjbmzNt9RFs2LO2hQNyb022JisaI8rAWuw4HI3FuAIhZdOGIcdjLJvvObqlpqvWTJnnQbyi/1M9O8UxWhBs//H42I0q1Yb/XPGONzcmm+ri172mHKvZBpHkJaNJz6v9jxqiklDj3U4CA2ugpAaYMWqNXsdXbmJNd9egCnJEsphXNM+MnK3m0FCJ5S1kmJpa3DgPVbnQnPGWIDspW9ozbcO4K/9LkfaQO2KHuqlfFXSbdNzcEcwoqNEFE9zcIXu9/6n/ym/BC/C3aJLzEKPuYVlbFnfhZ8kcWxV3dbv4bKl28566wD+8C53aw49lTABp9PWbsB+knfc/Li3eVizf5vv/xmvnPKg5ihwKEwlrcHqucuVcVOxEv8aH37E3ZqpZypUulrHEtIWKUr+txHg+ojZDGlwnqmkGlzcVi1dLiNSJiHjfbRNOPwKpx9TVdTn3K05DBx4psIk4Ei8aCkJahRgffk4YnEXe07T4H2RR1u27E6wfQsBDofUgjFUFnwC2AiVtA+05J2zpiDK2Oa0c5fmAecN1iJzmpqFZxqYBCYhFTCsUNEmUnIcZ6aEA5rQVhEywG6w7HSW02XfOoBlQmjwulOFQAg66SvJblrTEX1YtJ3uG15T/BH1OfOQeuR8g/c0gdpT5fx2SKbs9EfHTKdM8A1GaJRHLVIwhcGyydZsbifAFVKl5EMKNU2Hryo+06BeTgqnxzYjThVySDikbtJPieco75lYfKAJOMEZBTjoITuWHXXZVhcUDIS2hpiXHV9Ku4u44bN5OYLDOkJo8w+xJSMbhBRHEdEs9JZUCkQrPMAvaHyLkxgkEHxiNkx/x2YB0mGsQ8EUWj/stW5YLhtS5SMu+/YBbNPDCkGTUybN8krRLBGPlZkVOA0j+a1+rkyQKWGaPHPLZOkJhioQYnVZ2hS3zVxMtgC46KuRwbJNd9nV2PHgb36F194ecf/Yeu2vAFe5nm/bRBFrnY4BauE8ERmZRFUn0k8hbftiVYSKMEme2dJCJSCGYAlNqh87bXOPdUkGy24P6d1ll21MBqqx48Fvv8ZHH8HZFY7j/uAq1xMJUFqCSUlJPmNbIiNsmwuMs/q9CMtsZsFO6SprzCS1Z7QL8xCQClEelpjTduDMsmWD8S1PT152BtvmIGvUeDA/yRn83u/x0/4qxoPHjx+PXY9pqX9bgMvh/Nz9kpP4pOe1/fYf3axUiMdHLlPpZCNjgtNFAhcHEDxTumNONhHrBduW+vOyY++70WWnPXj98eA4kOt/mj/5E05l9+O4o8ePx67HFqyC+qSSnyselqjZGaVK2TadbFLPWAQ4NBhHqDCCV7OTpo34AlSSylPtIdd2AJZlyzYQrDJ5lcWGNceD80CunPLGGzsfD+7wRb95NevJI5docQ3tgCyr5bGnyaPRlmwNsFELViOOx9loebGNq2moDOKpHLVP5al2cymWHbkfzGXL7kfRl44H9wZy33tvt+PB/Xnf93e+nh5ZlU18wCiRUa9m7kib9LYuOk+hudQNbxwm0AQqbfloimaB2lM5fChex+ylMwuTbfmXQtmWlenZljbdXTLuOxjI/fDDHY4Hjx8/Hrse0zXfPFxbUN1kKqSCCSk50m0Ajtx3ub9XHBKHXESb8iO6E+qGytF4nO0OG3SXzbJlhxBnKtKyl0NwybjvYCD30aMdjgePHz8eu56SVTBbgxJMliQ3Oauwg0QHxXE2Ez/EIReLdQj42Gzb4CLS0YJD9xUx7bsi0vJi5mUbW1QzL0h0PFk17rtiIPfJk52MB48fPx67npJJwyrBa2RCCQRTbGZSPCxTPOiND4G2pYyOQ4h4jINIJh5wFU1NFZt+IsZ59LSnDqBjZ2awbOku+yInunLcd8VA7rNnOxkPHj9+PGY9B0MWJJNozOJmlglvDMXDEozdhQWbgs/U6oBanGzLrdSNNnZFjOkmbi5bNt1lX7JLLhn3vXAg9/h4y/Hg8ePHI9dzQMEkWCgdRfYykYKnkP7D4rIujsujaKPBsB54vE2TS00ccvFY/Tth7JXeq1hz+qgVy04sAJawTsvOknHfCwdyT062HA8eP348Zj0vdoXF4pilKa2BROed+9fyw9rWRXeTFXESMOanvDZfJuJaSXouQdMdDJZtekZcLLvEeK04d8m474UDuaenW44Hjx8/Xns9YYqZpszGWB3AN/4VHw+k7WSFtJ3Qicuqb/NlVmgXWsxh570xg2UwxUw3WfO6B5nOuO8aA7lnZxuPB48fPx6znm1i4bsfcbaptF3zNT78eFPtwi1OaCNOqp1x3zUGcs/PN++AGD1+fMXrSVm2baTtPhPahbPhA71wIHd2bXzRa69nG+3CraTtPivahV/55tXWg8fyRY/9AdsY8VbSdp8V7cKrrgdfM//z6ILQFtJ2nxHtwmuoB4/kf74+gLeRtvvMaBdeSz34+vifx0YG20jbfTa0C6+tHrwe//NmOG0L8EbSdp8R7cLrrQe/996O+ai3ujQOskpTNULa7jOjXXj99eCd8lHvoFiwsbTdZ0a78PrrwTvlo966pLuRtB2fFe3Cm6oHP9kNH/W2FryxtN1nTLvwRurBO+Kj3pWXHidtx2dFu/Bm68Fb81HvykuPlrb7LGkX3mw9eGs+6h1Y8MbSdjegXcguQLjmevDpTQLMxtJ2N6NdyBZu9AbrwVvwUW+LbteULUpCdqm0HTelXbhNPe8G68Gb8lFvVfYfSNuxvrTdTWoXbozAzdaDZzfkorOj1oxVxlIMlpSIlpLrt8D4hrQL17z+c3h6hU/wv4Q/utps4+bm+6P/hIcf0JwQ5oQGPBL0eKPTYEXTW+eL/2DKn73J9BTXYANG57hz1cEMviVf/4tf5b/6C5pTQkMIWoAq7hTpOJjtAM4pxKu5vg5vXeUrtI09/Mo/5H+4z+Mp5xULh7cEm2QbRP2tFIKR7WM3fPf/jZ3SWCqLM2l4NxID5zB72HQXv3jj/8mLR5xXNA5v8EbFQEz7PpRfl1+MB/hlAN65qgDn3wTgH13hK7T59bmP+NIx1SHHU84nLOITt3iVz8mNO+lPrjGAnBFqmioNn1mTyk1ta47R6d4MrX7tjrnjYUpdUbv2rVr6YpVfsGG58AG8Ah9eyUN8CX4WfgV+G8LVWPDGb+Zd4cU584CtqSbMKxauxTg+dyn/LkVgA+IR8KHtejeFKRtTmLLpxN6mYVLjYxwXf5x2VofiZcp/lwKk4wGOpYDnoIZPdg/AAbwMfx0+ge9dgZvYjuqKe4HnGnykYo5TvJbG0Vj12JagRhwKa44H95ShkZa5RyLGGdfYvG7aw1TsF6iapPAS29mNS3NmsTQZCmgTzFwgL3upCTgtBTRwvGMAKrgLn4evwin8+afJRcff+8izUGUM63GOOuAs3tJkw7J4kyoNreqrpO6cYLQeFUd7TTpr5YOTLc9RUUogUOVJQ1GYJaFLAW0oTmKyYS46ZooP4S4EON3xQ5zC8/CX4CnM4c1PE8ApexpoYuzqlP3d4S3OJP8ZDK7cKWNaTlqmgDiiHwl1YsE41w1zT4iRTm3DBqxvOUsbMKKDa/EHxagtnta072ejc3DOIh5ojvh8l3tk1JF/AV6FU6jh3U8HwEazLgdCLYSQ+MYiAI2ltomkzttUb0gGHdSUUgsIYjTzLG3mObX4FBRaYtpDVNZrih9TgTeYOBxsEnN1gOCTM8Bsw/ieMc75w9kuAT6A+/AiHGvN/+Gn4KRkiuzpNNDYhDGFndWRpE6SVfm8U5bxnSgVV2jrg6JCKmneqey8VMFgq2+AM/i4L4RUbfSi27lNXZ7R7W9RTcq/q9fk4Xw3AMQd4I5ifAZz8FcVtm9SAom/dyN4lczJQW/kC42ZrHgcCoIf1oVMKkVItmMBi9cOeNHGLqOZk+QqQmrbc5YmYgxELUUN35z2iohstgfLIFmcMV7s4CFmI74L9+EFmGsi+tGnAOD4Yk9gIpo01Y4cA43BWGygMdr4YZekG3OBIUXXNukvJS8tqa06e+lSDCtnqqMFu6hWHXCF+WaYt64m9QBmNxi7Ioy7D+fa1yHw+FMAcPt7SysFLtoG4PXAk7JOA3aAxBRqUiAdU9Yp5lK3HLSRFtOim0sa8euEt08xvKjYjzeJ2GU7YawexrnKI9tmobInjFXCewpwriY9+RR4aaezFhMhGCppKwom0ChrgFlKzyPKkGlTW1YQrE9HJqu8hKGgMc6hVi5QRq0PZxNfrYNgE64utmRv6KKHRpxf6VDUaOvNP5jCEx5q185My/7RKz69UQu2im5k4/eownpxZxNLwiZ1AZTO2ZjWjkU9uaB2HFn6Q3u0JcsSx/qV9hTEApRzeBLDJQXxYmTnq7bdLa3+uqFrxLJ5w1TehnNHx5ECvCh2g2c3hHH5YsfdaSKddztfjQ6imKFGSyFwlLzxEGPp6r5IevVjk1AMx3wMqi1NxDVjLBiPs9tbsCkIY5we5/ML22zrCScFxnNtzsr9Wcc3CnD+pYO+4VXXiDE0oc/vQQ/fDK3oPESJMYXNmJa/DuloJZkcTpcYE8lIH8Dz8DJMiynNC86Mb2lNaaqP/+L7f2fcE/yP7/Lde8xfgSOdMxvOixZf/9p3+M4hT1+F+zApxg9XfUvYjc8qX2lfOOpK2gNRtB4flpFu9FTKCp2XJRgXnX6olp1zyYjTKJSkGmLE2NjUr1bxFM4AeAAHBUFIeSLqXR+NvH/M9fOnfHzOD2vCSyQJKzfgsCh+yi/Mmc35F2fUrw7miW33W9hBD1vpuUojFphIyvg7aTeoymDkIkeW3XLHmguMzbIAJejN6B5MDrhipE2y6SoFRO/AK/AcHHZHNIfiWrEe/C6cr3f/yOvrQKB+zMM55/GQdLDsR+ifr5Fiuu+/y+M78LzOE5dsNuXC3PYvYWd8NXvphLSkJIasrlD2/HOqQ+RjcRdjKTGWYhhVUm4yxlyiGPuMsZR7sMCHUBeTuNWA7if+ifXgc/hovftHXs/DV+Fvwe+f8shzMiMcweFgBly3//vwJfg5AN4450fn1Hd1Rm1aBLu22Dy3y3H2+OqMemkbGZ4jozcDjJf6596xOLpC0eMTHbKnxLxH27uZ/bMTGs2jOaMOY4m87CfQwF0dw53oa1k80JRuz/XgS+8fX3N9Af4qPIMfzKgCp4H5TDGe9GGeFPzSsZz80SlPTxXjgwJmC45njzgt2vbQ4b4OAdUK4/vWhO8d8v6EE8fMUsfakXbPpFJeLs2ubM/qdm/la3WP91uWhxXHjoWhyRUq2iJ/+5mA73zwIIo+LoZ/SgvIRjAd1IMvvn98PfgOvAJfhhm8scAKVWDuaRaK8aQ9f7vuPDH6Bj47ZXau7rqYJ66mTDwEDU6lLbCjCK0qTXyl5mnDoeNRxanj3FJbaksTk0faXxHxLrssgPkWB9LnA/MFleXcJozzjwsUvUG0X/QCve51qkMDXp9mtcyOy3rwBfdvVJK7D6/ACSzg3RoruIq5UDeESfEmVclDxnniU82vxMLtceD0hGZWzBNPMM/jSPne2OVatiTKUpY5vY7gc0LdUAWeWM5tH+O2I66AOWw9xT2BuyRVLGdoDHUsVRXOo/c+ZdRXvFfnxWyIV4upFLCl9eAL7h8Zv0QH8Ry8pA2cHzQpGesctVA37ZtklBTgHjyvdSeKY/RZw/kJMk0Y25cSNRWSigQtlULPTw+kzuJPeYEkXjQRpoGZobYsLF79pyd1dMRHInbgFTZqNLhDqiIsTNpoex2WLcy0/X6rHcdMMQvFSd5dWA++4P7xv89deACnmr36uGlL69bRCL6BSZsS6c0TU2TKK5gtWCzgAOOwQcurqk9j8whvziZSMLcq5hbuwBEsYjopUBkqw1yYBGpLA97SRElEmx5MCInBY5vgLk94iKqSWmhIGmkJ4Bi9m4L645J68LyY4wsFYBfUg5feP/6gWWm58IEmKQM89hq7KsZNaKtP5TxxrUZZVkNmMJtjbKrGxLNEbHPJxhqy7lAmbC32ZqeF6lTaknRWcYaFpfLUBh/rwaQycCCJmW15Kstv6jRHyJFry2C1ahkkIW0LO75s61+owxK1y3XqweX9m5YLM2DPFeOjn/iiqCKJ+yKXF8t5Yl/kNsqaSCryxPq5xWTFIaP8KSW0RYxqupaUf0RcTNSSdJZGcKYdYA6kdtrtmyBckfKXwqk0pHpUHlwWaffjNRBYFPUDWa8e3Lt/o0R0CdisKDM89cX0pvRHEfM8ca4t0s2Xx4kgo91MPQJ/0c9MQYq0co8MBh7bz1fio0UUHLR4aAIOvOmoYO6kwlEVODSSTliWtOtH6sPkrtctF9ZtJ9GIerBskvhdVS5cFNv9s1BU0AbdUgdK4FG+dRnjFmDTzniRMdZO1QhzMK355vigbdkpz9P6qjUGE5J2qAcXmwJ20cZUiAD0z+pGMx6xkzJkmEf40Hr4qZfVg2XzF9YOyoV5BjzVkUJngKf8lgNYwKECEHrCNDrWZzMlflS3yBhr/InyoUgBc/lKT4pxVrrC6g1YwcceK3BmNxZcAtz3j5EIpqguh9H6wc011YN75cKDLpFDxuwkrPQmUwW4KTbj9mZTwBwLq4aQMUZbHm1rylJ46dzR0dua2n3RYCWZsiHROeywyJGR7mXKlpryyCiouY56sFkBWEnkEB/raeh/Sw4162KeuAxMQpEkzy5alMY5wamMsWKKrtW2WpEWNnReZWONKWjrdsKZarpFjqCslq773PLmEhM448Pc3+FKr1+94vv/rfw4tEcu+lKTBe4kZSdijBrykwv9vbCMPcLQTygBjzVckSLPRVGslqdunwJ4oegtFOYb4SwxNgWLCmD7T9kVjTv5YDgpo0XBmN34Z/rEHp0sgyz7lngsrm4lvMm2Mr1zNOJYJ5cuxuQxwMGJq/TP5emlb8fsQBZviK4t8hFL+zbhtlpwaRSxQRWfeETjuauPsdGxsBVdO7nmP4xvzSoT29pRl7kGqz+k26B3Oy0YNV+SXbbQas1ctC/GarskRdFpKczVAF1ZXnLcpaMuzVe6lZ2g/1ndcvOVgRG3sdUAY1bKD6achijMPdMxV4muKVorSpiDHituH7rSTs7n/4y5DhRXo4FVBN4vO/zbAcxhENzGbHCzU/98Mcx5e7a31kWjw9FCe/zNeYyQjZsWb1uc7U33pN4Mji6hCLhivqfa9Ss6xLg031AgfesA/l99m9fgvnaF9JoE6bYKmkGNK3aPbHB96w3+DnxFm4hs0drLsk7U8kf/N/CvwQNtllna0rjq61sH8L80HAuvwH1tvBy2ChqWSCaYTaGN19sTvlfzFD6n+iKTbvtayfrfe9ueWh6GJFoxLdr7V72a5ZpvHcCPDzma0wTO4EgbLyedxstO81n57LYBOBzyfsOhUKsW1J1BB5vr/tz8RyqOFylQP9Tvst2JALsC5lsH8PyQ40DV4ANzYa4dedNiKNR1s+x2wwbR7q4/4cTxqEk4LWDebfisuo36JXLiWFjOtLrlNWh3K1rRS4xvHcDNlFnNmWBBAl5SWaL3oPOfnvbr5pdjVnEaeBJSYjuLEkyLLsWhKccadmOphZkOPgVdalj2QpSmfOsADhMWE2ZBu4+EEJI4wKTAuCoC4xwQbWXBltpxbjkXJtKxxabo9e7tyhlgb6gNlSbUpMh+l/FaqzVwewGu8BW1Zx7pTpQDJUjb8tsUTW6+GDXbMn3mLbXlXJiGdggxFAoUrtPS3wE4Nk02UZG2OOzlk7fRs7i95QCLo3E0jtrjnM7SR3uS1p4qtS2nJ5OwtQVHgOvArLBFijZUV9QtSl8dAY5d0E0hM0w3HS2DpIeB6m/A1+HfhJcGUq4sOxH+x3f5+VO+Ds9rYNI7zPXOYWPrtf8bYMx6fuOAX5jzNR0PdsuON+X1f7EERxMJJoU6GkTEWBvVolVlb5lh3tKCg6Wx1IbaMDdJ+9sUCc5KC46hKGCk3IVOS4TCqdBNfUs7Kd4iXf2RjnT/LLysJy3XDcHLh/vde3x8DoGvwgsa67vBk91G5Pe/HbOe7xwym0NXbtiuuDkGO2IJDh9oQvJ4cY4vdoqLDuoH9Zl2F/ofsekn8lkuhIlhQcffUtSjytFyp++p6NiE7Rqx/lodgKVoceEp/CP4FfjrquZaTtj2AvH5K/ywpn7M34K/SsoYDAdIN448I1/0/wveW289T1/lX5xBzc8N5IaHr0XMOQdHsIkDuJFifj20pBm5jzwUv9e2FhwRsvhAbalCIuIw3bhJihY3p6nTFFIZgiSYjfTf3aXuOjmeGn4bPoGvwl+CFzTRczBIuHBEeImHc37/lGfwZR0cXzVDOvaKfNHvwe+suZ771K/y/XcBlsoN996JpBhoE2toYxOznNEOS5TJc6Id5GEXLjrWo+LEWGNpPDU4WAwsIRROu+1vM+0oW37z/MBN9kqHnSArwPfgFJ7Cq/Ai3Ie7g7ncmI09v8sjzw9mzOAEXoIHxURueaAce5V80f/DOuuZwHM8vsMb5wBzOFWM7wymTXPAEvm4vcFpZ2ut0VZRjkiP2MlmLd6DIpbGSiHOjdnUHN90hRYmhTnmvhzp1iKDNj+b7t5hi79lWGwQ+HN9RsfFMy0FXbEwhfuczKgCbyxYwBmcFhhvo/7a44v+i3XWcwDP86PzpGQYdWh7csP5dBvZ1jNzdxC8pBGuxqSW5vw40nBpj5JhMwvOzN0RWqERHMr4Lv1kWX84xLR830G3j6yqZ1a8UstTlW+qJPOZ+sZ7xZPKTJLhiNOAFd6tk+jrTH31ncLOxid8+nzRb128HhUcru/y0Wn6iT254YPC6FtVSIMoW2sk727AhvTtrWKZTvgsmckfXYZWeNRXx/3YQ2OUxLDrbHtN11IwrgXT6c8dATDwLniYwxzO4RzuQqTKSC5gAofMZ1QBK3zQ4JWobFbcvJm87FK+6JXrKahLn54m3p+McXzzYtP8VF/QpJuh1OwieElEoI1pRxPS09FBrkq2tWCU59+HdhNtTIqKm8EBrw2RTOEDpG3IKo2Y7mFdLm3ZeVjYwVw11o/oznceMve4CgMfNym/utA/d/ILMR7gpXzRy9eDsgLcgbs8O2Va1L0zzIdwGGemTBuwROHeoMShkUc7P+ISY3KH5ZZeWqO8mFTxQYeXTNuzvvK5FGPdQfuu00DwYFY9dyhctEt+OJDdnucfpmyhzUJzfsJjr29l8S0bXBfwRS9ZT26tmMIdZucch5ZboMz3Nio3nIOsYHCGoDT4kUA9MiXEp9Xsui1S8th/kbWIrMBxDGLodWUQIWcvnXy+9M23xPiSMOiRPqM+YMXkUN3gXFrZJwXGzUaMpJfyRS9ZT0lPe8TpScuRlbMHeUmlaKDoNuy62iWNTWNFYjoxFzuJs8oR+RhRx7O4SVNSXpa0ZJQ0K1LAHDQ+D9IepkMXpcsq5EVCvClBUIzDhDoyKwDw1Lc59GbTeORivugw1IcuaEOaGWdNm+Ps5fQ7/tm0DjMegq3yM3vb5j12qUId5UZD2oxDSEWOZMSqFl/W+5oynWDa/aI04tJRQ2eTXusg86SQVu/nwSYwpW6wLjlqIzwLuxGIvoAvul0PS+ZNz0/akp/pniO/8JDnGyaCkzbhl6YcqmK/69prxPqtpx2+Km9al9sjL+rwMgHw4jE/C8/HQ3m1vBuL1fldbzd8mOueVJ92syqdEY4KJjSCde3mcRw2TA6szxedn+zwhZMps0XrqEsiUjnC1hw0TELC2Ek7uAAdzcheXv1BYLagspxpzSAoZZUsIzIq35MnFQ9DOrlNB30jq3L4pkhccKUAA8/ocvN1Rzx9QyOtERs4CVsJRK/DF71kPYrxYsGsm6RMh4cps5g1DOmM54Ly1ii0Hd3Y/BMk8VWFgBVmhqrkJCPBHAolwZaWzLR9Vb7bcWdX9NyUYE+uB2BKfuaeBUcjDljbYVY4DdtsVWvzRZdWnyUzDpjNl1Du3aloAjVJTNDpcIOVVhrHFF66lLfJL1zJr9PQ2nFJSBaKoDe+sAvLufZVHVzYh7W0h/c6AAZ+7Tvj6q9j68G/cTCS/3n1vLKHZwNi+P+pS0WkZNMBMUl+LDLuiE4omZy71r3UFMwNJV+VJ/GC5ixVUkBStsT4gGKh0Gm4Oy3qvq7Lbmq24nPdDuDR9deR11XzP4vFu3TYzfnIyiSVmgizUYGqkIXNdKTY9pgb9D2Ix5t0+NHkVzCdU03suWkkVZAoCONCn0T35gAeW38de43mf97sMOpSvj4aa1KYUm58USI7Wxxes03bAZdRzk6UtbzMaCQ6IxO0dy7X+XsjoD16hpsBeGz9dfzHj+R/Hp8nCxZRqkEDTaCKCSywjiaoMJ1TITE9eg7Jqnq8HL6gDwiZb0u0V0Rr/rmvqjxKuaLCX7ZWXTvAY+uvm3z8CP7nzVpngqrJpZKwWnCUjIviYVlirlGOzPLI3SMVyp/elvBUjjDkNhrtufFFErQ8pmdSlbK16toBHlt/HV8uHMX/vEGALkV3RJREiSlopxwdMXOZPLZ+ix+kAHpMKIk8UtE1ygtquttwxNhphrIZ1IBzjGF3IIGxGcBj6q8bHJBG8T9vdsoWrTFEuebEZuVxhhClH6P5Zo89OG9fwHNjtNQTpD0TG9PJLEYqvEY6Rlxy+ZZGfL0Aj62/bnQCXp//eeM4KzfQVJbgMQbUjlMFIm6TpcfWlZje7NBSV6IsEVmumWIbjiloUzQX9OzYdo8L1wjw2PrrpimONfmfNyzKklrgnEkSzT5QWYQW40YShyzqsRmMXbvVxKtGuYyMKaU1ugenLDm5Ily4iT14fP11Mx+xJv+zZ3MvnfdFqxU3a1W/FTB4m3Qfsyc1XUcdVhDeUDZXSFHHLQj/Y5jtC7ZqM0CXGwB4bP11i3LhOvzPGygYtiUBiwQV/4wFO0majijGsafHyRLu0yG6q35cL1rOpVxr2s5cM2jJYMCdc10Aj6q/blRpWJ//+dmm5psMl0KA2+AFRx9jMe2WbC4jQxnikd4DU8TwUjRVacgdlhmr3bpddzuJ9zXqr2xnxJfzP29RexdtjDVZqzkqa6PyvcojGrfkXiJ8SEtml/nYskicv0ivlxbqjemwUjMw5evdg8fUX9nOiC/lf94Q2i7MURk9nW1MSj5j8eAyV6y5CN2S6qbnw3vdA1Iwq+XOSCl663udN3IzLnrt+us25cI1+Z83SXQUldqQq0b5XOT17bGpLd6ssN1VMPf8c+jG8L3NeCnMdF+Ra3fRa9dft39/LuZ/3vwHoHrqGmQFafmiQw6eyzMxS05K4bL9uA+SKUQzCnSDkqOGokXyJvbgJ/BHI+qvY69//4rl20NsmK2ou2dTsyIALv/91/8n3P2Aao71WFGi8KKv1fRC5+J67Q/507/E/SOshqN5TsmYIjVt+kcjAx98iz/4SaojbIV1rexE7/C29HcYD/DX4a0rBOF5VTu7omsb11L/AWcVlcVZHSsqGuXLLp9ha8I//w3Mv+T4Ew7nTBsmgapoCrNFObIcN4pf/Ob/mrvHTGqqgAupL8qWjWPS9m/31jAe4DjA+4+uCoQoT/zOzlrNd3qd4SdphFxsUvYwGWbTWtISc3wNOWH+kHBMfc6kpmpwPgHWwqaSUG2ZWWheYOGQGaHB+eQ/kn6b3pOgLV+ODSn94wDvr8Bvb70/LLuiPPEr8OGVWfDmr45PZyccEmsVXZGe1pRNX9SU5+AVQkNTIVPCHF/jGmyDC9j4R9LfWcQvfiETmgMMUCMN1uNCakkweZsowdYobiMSlnKA93u7NzTXlSfe+SVbfnPQXmg9LpYAQxpwEtONyEyaueWM4FPjjyjG3uOaFmBTWDNgBXGEiQpsaWhnAqIijB07Dlsy3fUGeP989xbWkyf+FF2SNEtT1E0f4DYYVlxFlbaSMPIRMk/3iMU5pME2SIWJvjckciebkQuIRRyhUvkHg/iUljG5kzVog5hV7vIlCuBrmlhvgPfNHQM8lCf+FEGsYbMIBC0qC9a0uuy2wLXVbLBaP5kjHokCRxapkQyzI4QEcwgYHRZBp+XEFTqXFuNVzMtjXLJgX4gAid24Hjwc4N3dtVSe+NNiwTrzH4WVUOlDobUqr1FuAgYllc8pmzoVrELRHSIW8ViPxNy4xwjBpyR55I6J220qQTZYR4guvUICJiSpr9gFFle4RcF/OMB7BRiX8sSfhpNSO3lvEZCQfLUVTKT78Ek1LRLhWN+yLyTnp8qWUZ46b6vxdRGXfHVqx3eI75YaLa4iNNiK4NOW7wPW6lhbSOF9/M9qw8e/aoB3d156qTzxp8pXx5BKAsYSTOIIiPkp68GmTq7sZtvyzBQaRLNxIZ+paozHWoLFeExIhRBrWitHCAHrCF7/thhD8JhYz84wg93QRV88wLuLY8zF8sQ36qF1J455bOlgnELfshKVxYOXKVuKx0jaj22sczTQqPqtV/XDgpswmGTWWMSDw3ssyUunLLrVPGjYRsH5ggHeHSWiV8kT33ycFSfMgkoOK8apCye0J6VW6GOYvffgU9RWsukEi2kUV2nl4dOYUzRik9p7bcA4ggdJ53LxKcEe17B1R8eqAd7dOepV8sTXf5lhejoL85hUdhDdknPtKHFhljOT+bdq0hxbm35p2nc8+Ja1Iw+tJykgp0EWuAAZYwMVwac5KzYMslhvgHdHRrxKnvhTYcfKsxTxtTETkjHO7rr3zjoV25lAQHrqpV7bTiy2aXMmUhTBnKS91jhtR3GEoF0oLnWhWNnYgtcc4N0FxlcgT7yz3TgNIKkscx9jtV1ZKpWW+Ub1tc1eOv5ucdgpx+FJy9pgbLE7xDyXb/f+hLHVGeitHOi6A7ybo3sF8sS7w7cgdk0nJaOn3hLj3uyD0Zp5pazFIUXUpuTTU18d1EPkDoX8SkmWTnVIozEdbTcZjoqxhNHf1JrSS/AcvHjZ/SMHhL/7i5z+POsTUh/8BvNfYMTA8n+yU/MlTZxSJDRStqvEuLQKWwDctMTQogUDyQRoTQG5Kc6oQRE1yV1jCA7ri7jdZyK0sYTRjCR0Hnnd+y7nHxNgTULqw+8wj0mQKxpYvhjm9uSUxg+TTy7s2GtLUGcywhXSKZN275GsqlclX90J6bRI1aouxmgL7Q0Nen5ziM80SqMIo8cSOo+8XplT/5DHNWsSUr/6lLN/QQ3rDyzLruEW5enpf7KqZoShEduuSFOV7DLX7Ye+GmXb6/hnNNqKsVXuMDFpb9Y9eH3C6NGEzuOuI3gpMH/I6e+zDiH1fXi15t3vA1czsLws0TGEtmPEJdiiFPwlwKbgLHAFk4P6ZyPdymYYHGE0dutsChQBl2JcBFlrEkY/N5bQeXQ18gjunuMfMfsBlxJSx3niO485fwO4fGD5T/+3fPQqkneWVdwnw/3bMPkW9Wbqg+iC765Zk+xcT98ibKZc2EdgHcLoF8cSOo/Oc8fS+OyEULF4g4sJqXVcmfMfsc7A8v1/yfGXmL9I6Fn5pRwZhsPv0TxFNlAfZCvG+Oohi82UC5f/2IsJo0cTOm9YrDoKhFPEUr/LBYTUNht9zelHXDqwfPCIw4owp3mOcIQcLttWXFe3VZ/j5H3cIc0G6oPbCR+6Y2xF2EC5cGUm6wKC5tGEzhsWqw5hNidUiKX5gFWE1GXh4/Qplw4sVzOmx9QxU78g3EF6wnZlEN4FzJ1QPSLEZz1KfXC7vd8ssGdIbNUYpVx4UapyFUHzJoTOo1McSkeNn1M5MDQfs4qQuhhX5vQZFw8suwWTcyYTgioISk2YdmkhehG4PkE7w51inyAGGaU+uCXADabGzJR1fn3lwkty0asIo8cROm9Vy1g0yDxxtPvHDAmpu+PKnM8Ix1wwsGw91YJqhteaWgjYBmmQiebmSpwKKzE19hx7jkzSWOm66oPbzZ8Yj6kxVSpYjVAuvLzYMCRo3oTQecOOjjgi3NQ4l9K5/hOGhNTdcWVOTrlgYNkEXINbpCkBRyqhp+LdRB3g0OU6rMfW2HPCFFMV9nSp+uB2woepdbLBuJQyaw/ZFysXrlXwHxI0b0LovEkiOpXGA1Ijagf+KUNC6rKNa9bQnLFqYNkEnMc1uJrg2u64ELPBHpkgWbmwKpJoDhMwNbbGzAp7Yg31wS2T5rGtzit59PrKhesWG550CZpHEzpv2NGRaxlNjbMqpmEIzygJqQfjypycs2pg2cS2RY9r8HUqkqdEgKTWtWTKoRvOBPDYBltja2SO0RGjy9UHtxwRjA11ujbKF+ti5cIR9eCnxUg6owidtyoU5tK4NLji5Q3HCtiyF2IqLGYsHViOXTXOYxucDqG0HyttqYAKqYo3KTY1ekyDXRAm2AWh9JmsVh/ccg9WJ2E8YjG201sPq5ULxxX8n3XLXuMInbft2mk80rRGjCGctJ8/GFdmEQ9Ug4FlE1ll1Y7jtiraqm5Fe04VV8lvSVBL8hiPrfFVd8+7QH3Qbu2ipTVi8cvSGivc9cj8yvH11YMHdNSERtuOslM97feYFOPKzGcsI4zW0YGAbTAOaxCnxdfiYUmVWslxiIblCeAYr9VYR1gM7GmoPrilunSxxeT3DN/2eBQ9H11+nk1adn6VK71+5+Jfct4/el10/7KBZfNryUunWSCPxPECk1rdOv1WVSrQmpC+Tl46YD3ikQYcpunSQgzVB2VHFhxHVGKDgMEY5GLlQnP7FMDzw7IacAWnO6sBr12u+XanW2AO0wQ8pknnFhsL7KYIqhkEPmEXFkwaN5KQphbkUmG72wgw7WSm9RiL9QT925hkjiVIIhphFS9HKI6/8QAjlpXqg9W2C0apyaVDwKQwrwLY3j6ADR13ZyUNByQXHQu6RY09Hu6zMqXRaNZGS/KEJs0cJEe9VH1QdvBSJv9h09eiRmy0V2uJcqHcShcdvbSNg5fxkenkVprXM9rDVnX24/y9MVtncvbKY706anNl3ASll9a43UiacVquXGhvq4s2FP62NGKfQLIQYu9q1WmdMfmUrDGt8eDS0cXozH/fjmUH6Jruvm50hBDSaEU/2Ru2LEN/dl006TSc/g7tfJERxGMsgDUEr104pfWH9lQaN+M4KWQjwZbVc2rZVNHsyHal23wZtIs2JJqtIc/WLXXRFCpJkfE9jvWlfFbsNQ9pP5ZBS0zKh4R0aMFj1IjTcTnvi0Zz2rt7NdvQb2mgbju1plsH8MmbnEk7KbK0b+wC2iy3aX3szW8xeZvDwET6hWZYwqTXSSG+wMETKum0Dq/q+x62gt2ua2ppAo309TRk9TPazfV3qL9H8z7uhGqGqxNVg/FKx0HBl9OVUORn8Q8Jx9gFttGQUDr3tzcXX9xGgN0EpzN9mdZ3GATtPhL+CjxFDmkeEU6x56kqZRusLzALXVqkCN7zMEcqwjmywDQ6OhyUe0Xao1Qpyncrg6wKp9XfWDsaZplElvQ/b3sdweeghorwBDlHzgk1JmMc/wiERICVy2VJFdMjFuLQSp3S0W3+sngt2njwNgLssFGVQdJ0tu0KH4ky1LW4yrbkuaA6Iy9oz/qEMMXMMDWyIHhsAyFZc2peV9hc7kiKvfULxCl9iddfRK1f8kk9qvbdOoBtOg7ZkOZ5MsGrSHsokgLXUp9y88smniwWyuFSIRVmjplga3yD8Uij5QS1ZiM4U3Qw5QlSm2bXjFe6jzzBFtpg+/YBbLAWG7OPynNjlCw65fukGNdkJRf7yM1fOxVzbxOJVocFoYIaGwH22mIQkrvu1E2nGuebxIgW9U9TSiukPGU+Lt++c3DJPKhyhEEbXCQLUpae2exiKy6tMPe9mDRBFCEMTWrtwxN8qvuGnt6MoihKWS5NSyBhbH8StXoAz8PLOrRgLtOT/+4vcu+7vDLnqNvztOq7fmd8sMmY9Xzn1zj8Dq8+XVdu2Nv0IIySgEdQo3xVHps3Q5i3fLFsV4aiqzAiBhbgMDEd1uh8qZZ+lwhjkgokkOIv4xNJmyncdfUUzgB4oFMBtiu71Xumpz/P+cfUP+SlwFExwWW62r7b+LSPxqxn/gvMZ5z9C16t15UbNlq+jbGJtco7p8wbYlL4alSyfWdeuu0j7JA3JFNuVAwtst7F7FhWBbPFNKIUORndWtLraFLmMu7KFVDDOzqkeaiN33YAW/r76wR4XDN/yN1z7hejPau06EddkS/6XThfcz1fI/4K736fO48vlxt2PXJYFaeUkFS8U15XE3428xdtn2kc8GQlf1vkIaNRRnOMvLTWrZbElEHeLWi1o0dlKPAh1MVgbbVquPJ5+Cr8LU5/H/+I2QlHIU2ClXM9G8v7Rr7oc/hozfUUgsPnb3D+I+7WF8kNO92GY0SNvuxiE+2Bt8prVJTkzE64sfOstxuwfxUUoyk8VjcTlsqe2qITSFoSj6Epd4KsT6BZOWmtgE3hBfir8IzZDwgV4ZTZvD8VvPHERo8v+vL1DASHTz/i9OlKueHDjK5Rnx/JB1Vb1ioXdBra16dmt7dgik10yA/FwJSVY6XjA3oy4SqM2frqDPPSRMex9qs3XQtoWxMj7/Er8GWYsXgjaVz4OYumP2+9kbxvny/6kvWsEBw+fcb5bInc8APdhpOSs01tEqIkoiZjbAqKMruLbJYddHuHFRIyJcbdEdbl2sVLaySygunutBg96Y2/JjKRCdyHV+AEFtTvIpbKIXOamknYSiB6KV/0JetZITgcjjk5ZdaskBtWO86UF0ap6ozGXJk2WNiRUlCPFir66lzdm/SLSuK7EUdPz8f1z29Skq6F1fXg8+5UVR6bszncP4Tn4KUkkdJ8UFCY1zR1i8RmL/qQL3rlei4THG7OODlnKko4oI01kd3CaM08Ia18kC3GNoVaO9iDh+hWxSyTXFABXoau7Q6q9OxYg/OVEMw6jdbtSrJ9cBcewGmaZmg+bvkUnUUaGr+ZfnMH45Ivevl61hMcXsxYLFTu1hTm2zViCp7u0o5l+2PSUh9bDj6FgYypufBDhqK2+oXkiuHFHR3zfj+9PtA8oR0xnqX8qn+sx3bFODSbbF0X8EUvWQ8jBIcjo5bRmLOljDNtcqNtOe756h3l0VhKa9hDd2l1eqmsnh0MNMT/Cqnx6BInumhLT8luljzQ53RiJeA/0dxe5NK0o2fA1+GLXr6eNQWHNUOJssQaTRlGpLHKL9fD+IrQzTOMZS9fNQD4AnRNVxvTdjC+fJdcDDWQcyB00B0t9BDwTxXgaAfzDZ/DBXzRnfWMFRwuNqocOmX6OKNkY63h5n/fFcB28McVHqnXZVI27K0i4rDLNE9lDKV/rT+udVbD8dFFu2GGZ8mOt0kAXcoX3ZkIWVtw+MNf5NjR2FbivROHmhV1/pj2egv/fMGIOWTIWrV3Av8N9imV9IWml36H6cUjqEWNv9aNc+veb2sH46PRaHSuMBxvtW+twxctq0z+QsHhux8Q7rCY4Ct8lqsx7c6Sy0dl5T89rIeEuZKoVctIk1hNpfavER6yyH1Vvm3MbsUHy4ab4hWr/OZPcsRBphnaV65/ZcdYPNNwsjN/djlf9NqCw9U5ExCPcdhKxUgLSmfROpLp4WSUr8ojdwbncbvCf+a/YzRaEc6QOvXcGO256TXc5Lab9POvB+AWY7PigWYjzhifbovuunzRawsO24ZqQQAqguBtmpmPB7ysXJfyDDaV/aPGillgz1MdQg4u5MYaEtBNNHFjkRlSpd65lp4hd2AVPTfbV7FGpyIOfmNc/XVsPfg7vzaS/3nkvLL593ANLvMuRMGpQIhiF7kUEW9QDpAUbTWYBcbp4WpacHHY1aacqQyjGZS9HI3yCBT9kUZJhVOD+zUDvEH9ddR11fzPcTDQ5TlgB0KwqdXSavk9BC0pKp0WmcuowSw07VXmXC5guzSa4p0UvRw2lbDiYUx0ExJJRzWzi6Gm8cnEkfXXsdcG/M/jAJa0+bmCgdmQ9CYlNlSYZOKixmRsgiFxkrmW4l3KdFKv1DM8tk6WxPYJZhUUzcd8Kdtgrw/gkfXXDT7+avmfVak32qhtkg6NVdUS5wgkru1YzIkSduTW1FDwVWV3JQVJVuieTc0y4iDpFwc7/BvSalvKdQM8sv662cevz/+8sQVnjVAT0W2wLllw1JiMhJRxgDjCjLQsOzSFSgZqx7lAW1JW0e03yAD3asC+GD3NbQhbe+mN5GXH1F83KDOM4n/e5JIuH4NpdQARrFPBVptUNcjj4cVMcFSRTE2NpR1LEYbYMmfWpXgP9KejaPsLUhuvLCsVXznAG9dfx9SR1ud/3hZdCLHb1GMdPqRJgqDmm76mHbvOXDtiO2QPUcKo/TWkQ0i2JFXpBoo7vij1i1Lp3ADAo+qvG3V0rM//vFnnTE4hxd5Ka/Cor5YEdsLVJyKtDgVoHgtW11pWSjolPNMnrlrVj9Fv2Qn60twMwKPqr+N/wvr8z5tZcDsDrv06tkqyzESM85Ycv6XBWA2birlNCXrI6VbD2lx2L0vQO0QVTVVLH4SE67fgsfVXv8n7sz7/85Z7cMtbE6f088wSaR4kCkCm10s6pKbJhfqiUNGLq+0gLWC6eUAZFPnLjwqtKd8EwGvWX59t7iPW4X/eAN1svgRVSY990YZg06BD1ohLMtyFTI4pKTJsS9xREq9EOaPWiO2gpms7397x6nQJkbh+Fz2q/rqRROX6/M8bJrqlVW4l6JEptKeUFuMYUbtCQ7CIttpGc6MY93x1r1vgAnRXvY5cvwWPqb9uWQm+lP95QxdNMeWhOq1x0Db55C7GcUv2ZUuN6n8iKzsvOxibC//Yfs9Na8r2Rlz02vXXDT57FP/zJi66/EJSmsJKa8QxnoqW3VLQ+jZVUtJwJ8PNX1NQCwfNgdhhHD9on7PdRdrdGPF28rJr1F+3LBdeyv+8yYfLoMYet1vX4upNAjVvwOUWnlNXJXlkzk5Il6kqeoiL0C07qno+/CYBXq/+utlnsz7/Mzvy0tmI4zm4ag23PRN3t/CWryoUVJGm+5+K8RJ0V8Hc88/XHUX/HfiAq7t+BH+x6v8t438enWmdJwFA6ZINriLGKv/95f8lT9/FnyA1NMVEvQyaXuu+gz36f/DD73E4pwqpLcvm/o0Vle78n//+L/NPvoefp1pTJye6e4A/D082FERa5/opeH9zpvh13cNm19/4v/LDe5xMWTi8I0Ta0qKlK27AS/v3/r+/x/2GO9K2c7kVMonDpq7//jc5PKCxeNPpFVzaRr01wF8C4Pu76hXuX18H4LduTr79guuFD3n5BHfI+ZRFhY8w29TYhbbLi/bvBdqKE4fUgg1pBKnV3FEaCWOWyA+m3WpORZr/j+9TKJtW8yBTF2/ZEODI9/QavHkVdGFp/Pjn4Q+u5hXapsP5sOH+OXXA1LiKuqJxiMNbhTkbdJTCy4llEt6NnqRT4dhg1V3nbdrm6dYMecA1yTOL4PWTE9L5VzPFlLBCvlG58AhehnN4uHsAYinyJ+AZ/NkVvELbfOBUuOO5syBIEtiqHU1k9XeISX5bsimrkUUhnGDxourN8SgUsCZVtKyGbyGzHXdjOhsAvOAswSRyIBddRdEZWP6GZhNK/yjwew9ehBo+3jEADu7Ay2n8mDc+TS7awUHg0OMzR0LABhqLD4hJEh/BEGyBdGlSJoXYXtr+3HS4ijzVpgi0paWXtdruGTknXBz+11qT1Q2inxaTzQCO46P3lfLpyS4fou2PH/PupwZgCxNhGlj4IvUuWEsTkqMWm6i4xCSMc9N1RDQoCVcuGItJ/MRWefais+3synowi/dESgJjkilnWnBTGvRWmaw8oR15257t7CHmCf8HOn7cwI8+NQBXMBEmAa8PMRemrNCEhLGEhDQKcGZWS319BX9PFBEwGTbRBhLbDcaV3drFcDqk5kCTd2JF1Wp0HraqBx8U0wwBTnbpCadwBA/gTH/CDrcCs93LV8E0YlmmcyQRQnjBa8JESmGUfIjK/7fkaDJpmD2QptFNVJU1bbtIAjjWQizepOKptRjbzR9Kag6xZmMLLjHOtcLT3Tx9o/0EcTT1XN3E45u24AiwEypDJXihKjQxjLprEwcmRKclaDNZCVqr/V8mYWyFADbusiY5hvgFoU2vio49RgJLn5OsReRFN6tabeetiiy0V7KFHT3HyZLx491u95sn4K1QQSPKM9hNT0wMVvAWbzDSVdrKw4zRjZMyJIHkfq1VAVCDl/bUhNKlGq0zGr05+YAceXVPCttVk0oqjVwMPt+BBefx4yPtGVkUsqY3CHDPiCM5ngupUwCdbkpd8kbPrCWHhkmtIKLEetF2499eS1jZlIPGYnlcPXeM2KD9vLS0bW3ktYNqUllpKLn5ZrsxlIzxvDu5eHxzGLctkZLEY4PgSOg2IUVVcUONzUDBEpRaMoXNmUc0tFZrTZquiLyKxrSm3DvIW9Fil+AkhXu5PhEPx9mUNwqypDvZWdKlhIJQY7vn2OsnmBeOWnYZ0m1iwbbw1U60by5om47iHRV6fOgzjMf/DAZrlP40Z7syxpLK0lJ0gqaAK1c2KQKu7tabTXkLFz0sCftuwX++MyNeNn68k5Buq23YQhUh0SNTJa1ioQ0p4nUG2y0XilF1JqODqdImloPS4Bp111DEWT0jJjVv95uX9BBV7eB3bUWcu0acSVM23YZdd8R8UbQUxJ9wdu3oMuhdt929ME+mh6JXJ8di2RxbTi6TbrDquqV4aUKR2iwT6aZbyOwEXN3DUsWr8Hn4EhwNyHuXHh7/pdaUjtR7vnDh/d8c9xD/s5f501eQ1+CuDiCvGhk1AN/4Tf74RfxPwD3toLarR0zNtsnPzmS64KIRk861dMWCU8ArasG9T9H0ZBpsDGnjtAOM2+/LuIb2iIUGXNgl5ZmKD/Tw8TlaAuihaFP5yrw18v4x1898zIdP+DDAX1bM3GAMvPgRP/cJn3zCW013nrhHkrITyvYuwOUkcHuKlRSW5C6rzIdY4ppnF7J8aAJbQepgbJYBjCY9usGXDKQxq7RZfh9eg5d1UHMVATRaD/4BHK93/1iAgYZ/+jqPn8Dn4UExmWrpa3+ZOK6MvM3bjwfzxNWA2dhs8+51XHSPJiaAhGSpWevEs5xHLXcEGFXYiCONySH3fPWq93JIsBiSWvWyc3CAN+EcXoT7rCSANloPPoa31rt/5PUA/gp8Q/jDD3hyrjzlR8VkanfOvB1XPubt17vzxAfdSVbD1pzAnfgyF3ycadOTOTXhpEUoLC1HZyNGW3dtmjeXgr2r56JNmRwdNNWaQVBddd6rh4MhviEB9EFRD/7RGvePvCbwAL4Mx/D6M541hHO4D3e7g6PafdcZVw689z7NGTwo5om7A8sPhccT6qKcl9NJl9aM/9kX+e59Hh1yPqGuCCZxuITcsmNaJ5F7d0q6J3H48TO1/+M57085q2icdu2U+W36Ldllz9Agiv4YGljoEN908EzvDOrBF98/vtJwCC/BF2AG75xxEmjmMIcjxbjoaxqOK3/4hPOZzhMPBpYPG44CM0dTVm1LjLtUWWVz1Bcf8tEx0zs8O2A2YVHRxKYOiy/aOVoAaMu0i7ubu43njjmd4ibMHU1sIDHaQNKrZND/FZYdk54oCXetjq7E7IVl9eAL7t+oHnwXXtLx44czzoRFHBztYVwtH1d+NOMkupZ5MTM+gUmq90X+Bh9zjRlmaQ+m7YMqUL/veemcecAtOJ0yq1JnVlN27di2E0+Klp1tAJ4KRw1eMI7aJjsO3R8kPSI3fUFXnIOfdQe86sIIVtWDL7h//Ok6vj8vwDk08NEcI8zz7OhBy+WwalzZeZ4+0XniRfst9pAJqQHDGLzVQ2pheZnnv1OWhwO43/AgcvAEXEVVpa4db9sGvNK8wjaENHkfFQ4Ci5i7dqnQlPoLQrHXZDvO3BIXZbJOBrOaEbML6sFL798I4FhKihjHMsPjBUZYCMFr6nvaArxqXPn4lCa+cHfSa2cP27g3Z3ziYTRrcbQNGLQmGF3F3cBdzzzX7AILx0IB9rbwn9kx2G1FW3Inic+ZLIsVvKR8Zwfj0l1fkqo8LWY1M3IX14OX3r9RKTIO+d9XzAI8qRPGPn/4NC2n6o4rN8XJ82TOIvuVA8zLKUHRFgBCetlDZlqR1gLKjS39xoE7Bt8UvA6BxuEDjU3tFsEijgA+615tmZkXKqiEENrh41iLDDZNq4pKTWR3LZfnos81LOuNa15cD956vLMsJd1rqYp51gDUQqMYm2XsxnUhD2jg1DM7SeuJxxgrmpfISSXVIJIS5qJJSvJPEQ49DQTVIbYWJ9QWa/E2+c/oPK1drmC7WSfJRNKBO5Yjvcp7Gc3dmmI/Xh1kDTEuiSnWqQf37h+fTMhGnDf6dsS8SQfQWlqqwXXGlc/PEZ/SC5mtzIV0nAshlQdM/LvUtYutrEZ/Y+EAFtq1k28zQhOwLr1AIeANzhF8t9qzTdZf2qRKO6MWE9ohBYwibbOmrFtNmg3mcS+tB28xv2uKd/agYCvOP+GkSc+0lr7RXzyufL7QbkUpjLjEWFLqOIkAGu2B0tNlO9Eau2W1qcOUvVRgKzypKIQZ5KI3q0MLzqTNRYqiZOqmtqloIRlmkBHVpHmRYV6/HixbO6UC47KOFJnoMrVyr7wYz+SlW6GUaghYbY1I6kkxA2W1fSJokUdSh2LQ1GAimRGm0MT+uu57H5l7QgOWxERpO9moLRPgTtquWCfFlGlIjQaRly9odmzMOWY+IBO5tB4sW/0+VWGUh32qYk79EidWKrjWuiLpiVNGFWFRJVktyeXWmbgBBzVl8anPuXyNJlBJOlKLTgAbi/EYHVHxWiDaVR06GnHQNpJcWcK2jJtiCfG2sEHLzuI66sGrMK47nPIInPnu799935aOK2cvmvubrE38ZzZjrELCmXM2hM7UcpXD2oC3+ECVp7xtIuxptJ0jUr3sBmBS47TVxlvJ1Sqb/E0uLdvLj0lLr29ypdd/eMX3f6lrxGlKwKQxEGvw0qHbkbwrF3uHKwVENbIV2wZ13kNEF6zD+x24aLNMfDTCbDPnEikZFyTNttxWBXDaBuM8KtI2rmaMdUY7cXcUPstqTGvBGSrFWIpNMfbdea990bvAOC1YX0qbc6smDS1mPxSJoW4fwEXvjMmhlijDRq6qale6aJEuFGoppYDoBELQzLBuh/mZNx7jkinv0EtnUp50lO9hbNK57lZaMAWuWR5Yo9/kYwcYI0t4gWM47Umnl3YmpeBPqSyNp3K7s2DSAS/39KRuEN2bS4xvowV3dFRMx/VFcp2Yp8w2nTO9hCXtHG1kF1L4KlrJr2wKfyq77R7MKpFKzWlY9UkhYxyHWW6nBWPaudvEAl3CGcNpSXPZ6R9BbBtIl6cHL3gIBi+42CYXqCx1gfGWe7Ap0h3luyXdt1MKy4YUT9xSF01G16YEdWsouW9mgDHd3veyA97H+Ya47ZmEbqMY72oPztCGvK0onL44AvgC49saZKkWRz4veWljE1FHjbRJaWv6ZKKtl875h4CziFCZhG5rx7tefsl0aRT1bMHZjm8dwL/6u7wCRysaQblQoG5yAQN5zpatMNY/+yf8z+GLcH/Qn0iX2W2oEfXP4GvwQHuIL9AYGnaO3zqAX6946nkgqZNnUhx43DIdQtMFeOPrgy/y3Yd85HlJWwjLFkU3kFwq28xPnuPhMWeS+tDLV9Otllq7pQCf3uXJDN9wFDiUTgefHaiYbdfi3b3u8+iY6TnzhgehI1LTe8lcd7s1wJSzKbahCRxKKztTLXstGAiu3a6rPuQs5pk9TWAan5f0BZmGf7Ylxzzk/A7PAs4QPPPAHeFQ2hbFHszlgZuKZsJcUmbDC40sEU403cEjczstOEypa+YxevL4QBC8oRYqWdK6b7sK25tfE+oDZgtOQ2Jg8T41HGcBE6fTWHn4JtHcu9S7uYgU5KSCkl/mcnq+5/YBXOEr6lCUCwOTOM1taOI8mSxx1NsCXBEmLKbMAg5MkwbLmpBaFOPrNSlO2HnLiEqW3tHEwd8AeiQLmn+2gxjC3k6AxREqvKcJbTEzlpLiw4rNZK6oJdidbMMGX9FULKr0AkW+2qDEPBNNm5QAt2Ik2nftNWHetubosHLo2nG4vQA7GkcVCgVCgaDixHqo9UUn1A6OshapaNR/LPRYFV8siT1cCtJE0k/3WtaNSuUZYKPnsVIW0xXWnMUxq5+En4Kvw/MqQmVXnAXj9Z+9zM98zM/Agy7F/qqj2Nh67b8HjFnPP3iBn/tkpdzwEJX/whIcQUXOaikeliCRGUk7tiwF0rItwMEhjkZ309hikFoRAmLTpEXWuHS6y+am/KB/fM50aLEhGnSMwkpxzOov4H0AvgovwJ1iGzDLtJn/9BU+fAINfwUe6FHSLhu83viV/+/HrOePX+STT2B9uWGbrMHHLldRBlhS/CJQmcRxJFqZica01XixAZsYiH1uolZxLrR/SgxVIJjkpQP4PE9sE59LKLr7kltSBogS5tyszzH8Fvw8/AS8rNOg0xUS9fIaHwb+6et8Q/gyvKRjf5OusOzGx8evA/BP4IP11uN/grca5O0lcsPLJ5YjwI4QkJBOHa0WdMZYGxPbh2W2nR9v3WxEWqgp/G3+6VZbRLSAAZ3BhdhAaUL33VUSw9yjEsvbaQ9u4A/gGXwZXoEHOuU1GSj2chf+Mo+f8IcfcAxfIKVmyunRbYQVnoevwgfw3TXXcw++xNuP4fhyueEUNttEduRVaDttddoP0eSxLe2LENk6itYxlrxBNBYrNNKSQmeaLcm9c8UsaB5WyO6675yyQIAWSDpBVoA/gxmcwEvwoDv0m58UE7gHn+fJOa8/Ywan8EKRfjsopF83eCglX/Sfr7OeaRoQfvt1CGvIDccH5BCvw1sWIzRGC/66t0VTcLZQZtm6PlAasbOJ9iwWtUo7biktTSIPxnR24jxP1ZKaqq+2RcXM9OrBAm/AAs7hDJ5bNmGb+KIfwCs8a3jnjBrOFeMjHSCdbKr+2uOLfnOd9eiA8Hvvwwq54VbP2OqwkB48Ytc4YEOiH2vTXqodabfWEOzso4qxdbqD5L6tbtNPECqbhnA708DZH4QOJUXqScmUlks7Ot6FBuZw3n2mEbaUX7kDzxHOOQk8nKWMzAzu6ZZ8sOFw4RK+6PcuXo9tB4SbMz58ApfKDXf3szjNIIbGpD5TKTRxGkEMLjLl+K3wlWXBsCUxIDU+jbOiysESqAy1MGUJpXgwbTWzNOVEziIXZrJ+VIztl1PUBxTSo0dwn2bOmfDRPD3TRTGlfbCJvO9KvuhL1hMHhB9wPuPRLGHcdOWG2xc0U+5bQtAJT0nRTewXL1pgk2+rZAdeWmz3jxAqfNQQdzTlbF8uJ5ecEIWvTkevAHpwz7w78QujlD/Lr491bD8/1vhM2yrUQRrWXNQY4fGilfctMWYjL72UL/qS9eiA8EmN88nbNdour+PBbbAjOjIa4iBhfFg6rxeKdEGcL6p3EWR1Qq2Qkhs2DrnkRnmN9tG2EAqmgPw6hoL7Oza7B+3SCrR9tRftko+Lsf2F/mkTndN2LmzuMcKTuj/mX2+4Va3ki16+nnJY+S7MefpkidxwnV+4wkXH8TKnX0tsYzYp29DOOoSW1nf7nTh2akYiWmcJOuTidSaqESrTYpwjJJNVGQr+rLI7WsqerHW6Kp/oM2pKuV7T1QY9gjqlZp41/WfKpl56FV/0kvXQFRyeQ83xaTu5E8p5dNP3dUF34ihyI3GSpeCsywSh22ZJdWto9winhqifb7VRvgktxp13vyjrS0EjvrRfZ62uyqddSWaWYlwTPAtJZ2oZ3j/Sgi/mi+6vpzesfAcWNA0n8xVyw90GVFGuZjTXEQy+6GfLGLMLL523f5E0OmxVjDoOuRiH91RKU+vtoCtH7TgmvBLvtFXWLW15H9GTdVw8ow4IlRLeHECN9ym1e9K0I+Cbnhgv4Yu+aD2HaQJ80XDqOzSGAV4+4yCqBxrsJAX6ZTIoX36QnvzhhzzMfFW2dZVLOJfo0zbce5OvwXMFaZ81mOnlTVXpDZsQNuoYWveketKb5+6JOOsgX+NTm7H49fUTlx+WLuWL7qxnOFh4BxpmJx0p2gDzA/BUARuS6phR+pUsY7MMboAHx5xNsSVfVZcYSwqCKrqon7zM+8ecCkeS4nm3rINuaWvVNnMRI1IRpxTqx8PZUZ0Br/UEduo3B3hNvmgZfs9gQPj8vIOxd2kndir3awvJ6BLvoUuOfFWNYB0LR1OQJoUySKb9IlOBx74q1+ADC2G6rOdmFdJcD8BkfualA+BdjOOzP9uUhGUEX/TwhZsUduwRr8wNuXKurCixLBgpQI0mDbJr9dIqUuV+92ngkJZ7xduCk2yZKbfWrH1VBiTg9VdzsgRjW3CVXCvAwDd+c1z9dWw9+B+8MJL/eY15ZQ/HqvTwVdsZn5WQsgRRnMaWaecu3jFvMBEmgg+FJFZsnSl0zjB9OqPYaBD7qmoVyImFvzi41usesV0julaAR9dfR15Xzv9sEruRDyk1nb+QaLU67T885GTls6YgcY+UiMa25M/pwGrbCfzkvR3e0jjtuaFtnwuagHTSb5y7boBH119HXhvwP487jJLsLJ4XnUkHX5sLbS61dpiAXRoZSCrFJ+EjpeU3puVfitngYNo6PJrAigKktmwjyQdZpfq30mmtulaAx9Zfx15Xzv+cyeuiBFUs9zq8Kq+XB9a4PVvph3GV4E3y8HENJrN55H1X2p8VyqSKwVusJDKzXOZzplWdzBUFK9e+B4+uv468xvI/b5xtSAkBHQaPvtqWzllVvEOxPbuiE6+j2pvjcKsbvI7txnRErgfH7LdXqjq0IokKzga14GzQ23SSbCQvO6r+Or7SMIr/efOkkqSdMnj9mBx2DRsiY29Uj6+qK9ZrssCKaptR6HKURdwUYeUWA2kPzVKQO8ku2nU3Anhs/XWkBx3F/7wJtCTTTIKftthue1ty9xvNYLY/zo5KSbIuKbXpbEdSyeRyYdAIwKY2neyoc3+k1XUaufYga3T9daMUx/r8z1s10ITknIO0kuoMt+TB8jK0lpayqqjsJ2qtXAYwBU932zinimgmd6mTRDnQfr88q36NAI+tv24E8Pr8zxtasBqx0+xHH9HhlrwsxxNUfKOHQaZBITNf0uccj8GXiVmXAuPEAKSdN/4GLHhs/XWj92dN/uetNuBMnVR+XWDc25JLjo5Mg5IZIq226tmCsip2zZliL213YrTlL2hcFjpCduyim3M7/eB16q/blQsv5X/esDRbtJeabLIosWy3ycavwLhtxdWzbMmHiBTiVjJo6lCLjXZsi7p9PEPnsq6X6wd4bP11i0rD5fzPm/0A6brrIsllenZs0lCJlU4abakR59enZKrKe3BZihbTxlyZ2zl1+g0wvgmA166/bhwDrcn/7Ddz0eWZuJvfSESug6NzZsox3Z04FIxz0mUjMwVOOVTq1CQ0AhdbBGVdjG/CgsfUX7esJl3K/7ytWHRv683praW/8iDOCqWLLhpljDY1ZpzK75QiaZoOTpLKl60auHS/97oBXrv+umU9+FL+5+NtLFgjqVLCdbmj7pY5zPCPLOHNCwXGOcLquOhi8CmCWvbcuO73XmMUPab+ug3A6/A/78Bwe0bcS2+tgHn4J5pyS2WbOck0F51Vq3LcjhLvZ67p1ABbaL2H67bg78BfjKi/jr3+T/ABV3ilLmNXTI2SpvxWBtt6/Z//D0z/FXaGbSBgylzlsEGp+5//xrd4/ae4d8DUUjlslfIYS3t06HZpvfQtvv0N7AHWqtjP2pW08QD/FLy//da38vo8PNlKHf5y37Dxdfe/oj4kVIgFq3koLReSR76W/bx//n9k8jonZxzWTANVwEniDsg87sOSd/z7//PvMp3jQiptGVWFX2caezzAXwfgtzYUvbr0iozs32c3Uge7varH+CNE6cvEYmzbPZ9hMaYDdjK4V2iecf6EcEbdUDVUARda2KzO/JtCuDbNQB/iTeL0EG1JSO1jbXS+nLxtPMDPw1fh5+EPrgSEKE/8Gry5A73ui87AmxwdatyMEBCPNOCSKUeRZ2P6Myb5MRvgCHmA9ywsMifU+AYXcB6Xa5GibUC5TSyerxyh0j6QgLVpdyhfArRTTLqQjwe4HOD9s92D4Ap54odXAPBWLAwB02igG5Kkc+piN4lvODIFGAZgT+EO4Si1s7fjSR7vcQETUkRm9O+MXyo9OYhfe4xt9STQ2pcZRLayCV90b4D3jR0DYAfyxJ+eywg2IL7NTMXna7S/RpQ63JhWEM8U41ZyQGjwsVS0QBrEKLu8xwZsbi4wLcCT+OGidPIOCe1PiSc9Qt+go+vYqB7cG+B9d8cAD+WJPz0Am2gxXgU9IneOqDpAAXOsOltVuMzpdakJXrdPCzXiNVUpCeOos5cxnpQT39G+XVLhs1osQVvJKPZyNq8HDwd4d7pNDuWJPxVX7MSzqUDU6gfadKiNlUFTzLeFHHDlzO4kpa7aiKhBPGKwOqxsBAmYkOIpipyXcQSPlRTf+Tii0U3EJGaZsDER2qoB3h2hu0qe+NNwUooYU8y5mILbJe6OuX+2FTKy7bieTDAemaQyQ0CPthljSWO+xmFDIYiESjM5xKd6Ik5lvLq5GrQ3aCMLvmCA9wowLuWJb9xF59hVVP6O0CrBi3ZjZSNOvRy+I6klNVRJYRBaEzdN+imiUXQ8iVF8fsp+W4JXw7WISW7fDh7lptWkCwZ4d7QTXyBPfJMYK7SijjFppGnlIVJBJBYj7eUwtiP1IBXGI1XCsjNpbjENVpSAJ2hq2LTywEly3hUYazt31J8w2+aiLx3g3fohXixPfOMYm6zCGs9LVo9MoW3MCJE7R5u/WsOIjrqBoHUO0bJE9vxBpbhsd3+Nb4/vtPCZ4oZYCitNeYuC/8UDvDvy0qvkiW/cgqNqRyzqSZa/s0mqNGjtKOoTm14zZpUauiQgVfqtQiZjq7Q27JNaSK5ExRcrGCXO1FJYh6jR6CFqK7bZdQZ4t8g0rSlPfP1RdBtqaa9diqtzJkQ9duSryi2brQXbxDwbRUpFMBHjRj8+Nt7GDKgvph9okW7LX47gu0SpGnnFQ1S1lYldOsC7hYteR574ZuKs7Ei1lBsfdz7IZoxzzCVmmVqaSySzQbBVAWDek+N4jh9E/4VqZrJjPwiv9BC1XcvOWgO8275CVyBPvAtTVlDJfZkaZGU7NpqBogAj/xEHkeAuJihWYCxGN6e8+9JtSegFXF1TrhhLGP1fak3pebgPz192/8gB4d/6WT7+GdYnpH7hH/DJzzFiYPn/vjW0SgNpTNuPIZoAEZv8tlGw4+RLxy+ZjnKa5NdFoC7UaW0aduoYse6+bXg1DLg6UfRYwmhGEjqPvF75U558SANrElK/+MdpXvmqBpaXOa/MTZaa1DOcSiLaw9j0NNNst3c+63c7EKTpkvKHzu6bPbP0RkuHAVcbRY8ijP46MIbQeeT1mhA+5PV/inyDdQipf8LTvMXbwvoDy7IruDNVZKTfV4CTSRUYdybUCnGU7KUTDxLgCknqUm5aAW6/1p6eMsOYsphLzsHrE0Y/P5bQedx1F/4yPHnMB3/IOoTU9+BL8PhtjuFKBpZXnYNJxTuv+2XqolKR2UQgHhS5novuxVySJhBNRF3SoKK1XZbbXjVwWNyOjlqWJjrWJIy+P5bQedyldNScP+HZ61xKSK3jyrz+NiHG1hcOLL/+P+PDF2gOkekKGiNWKgJ+8Z/x8Iv4DdQHzcpZyF4v19I27w9/yPGDFQvmEpKtqv/TLiWMfn4sofMm9eAH8Ao0zzh7h4sJqYtxZd5/D7hkYPneDzl5idlzNHcIB0jVlQ+8ULzw/nc5/ojzl2juE0apD7LRnJxe04dMz2iOCFNtGFpTuXA5AhcTRo8mdN4kz30nVjEC4YTZQy4gpC7GlTlrePKhGsKKgeXpCYeO0MAd/GH7yKQUlXPLOasOH3FnSphjHuDvEu4gB8g66oNbtr6eMbFIA4fIBJkgayoXriw2XEDQPJrQeROAlY6aeYOcMf+IVYTU3XFlZufMHinGywaW3YLpObVBAsbjF4QJMsVUSayjk4voPsHJOQfPWDhCgDnmDl6XIRerD24HsGtw86RMHOLvVSHrKBdeVE26gKB5NKHzaIwLOmrqBWJYZDLhASG16c0Tn+CdRhWDgWXnqRZUTnPIHuMJTfLVpkoYy5CzylHVTGZMTwkGAo2HBlkQplrJX6U+uF1wZz2uwS1SQ12IqWaPuO4baZaEFBdukksJmkcTOm+YJSvoqPFzxFA/YUhIvWxcmSdPWTWwbAKVp6rxTtPFUZfKIwpzm4IoMfaYQLWgmlG5FME2gdBgm+J7J+rtS/XBbaVLsR7bpPQnpMFlo2doWaVceHk9+MkyguZNCJ1He+kuHTWyQAzNM5YSUg/GlTk9ZunAsg1qELVOhUSAK0LABIJHLKbqaEbHZLL1VA3VgqoiOKXYiS+HRyaEKgsfIqX64HYWbLRXy/qWoylIV9gudL1OWBNgBgTNmxA6b4txDT4gi3Ri7xFSLxtXpmmYnzAcWDZgY8d503LFogz5sbonDgkKcxGsWsE1OI+rcQtlgBBCSOKD1mtqYpIU8cTvBmAT0yZe+zUzeY92fYjTtGipXLhuR0ePoHk0ofNWBX+lo8Z7pAZDk8mEw5L7dVyZZoE/pTewbI6SNbiAL5xeygW4xPRuLCGbhcO4RIeTMFYHEJkYyEO9HmJfXMDEj/LaH781wHHZEtqSQ/69UnGpzH7LKIAZEDSPJnTesJTUa+rwTepI9dLJEawYV+ZkRn9g+QirD8vF8Mq0jFQ29js6kCS3E1+jZIhgPNanHdHFqFvPJLHqFwQqbIA4jhDxcNsOCCQLDomaL/dr5lyJaJU6FxPFjO3JOh3kVMcROo8u+C+jo05GjMF3P3/FuDLn5x2M04xXULPwaS6hBYki+MrMdZJSgPHlcB7nCR5bJ9Kr5ACUn9jk5kivdd8tk95SOGrtqu9lr2IhK65ZtEl7ZKrp7DrqwZfRUSN1el7+7NJxZbywOC8neNKTch5vsTEMNsoCCqHBCqIPRjIPkm0BjvFODGtto99rCl+d3wmHkW0FPdpZtC7MMcVtGFQjJLX5bdQ2+x9ypdc313uj8xlsrfuLgWXz1cRhZvJYX0iNVBRcVcmCXZs6aEf3RQF2WI/TcCbKmGU3IOoDJGDdDub0+hYckt6PlGu2BcxmhbTdj/klhccLGJMcqRjMJP1jW2ETqLSWJ/29MAoORluJ+6LPffBZbi5gqi5h6catQpmOT7/OFf5UorRpLzCqcMltBLhwd1are3kztrSzXO0LUbXRQcdLh/RdSZ+swRm819REDrtqzC4es6Gw4JCKlSnjYVpo0xeq33PrADbFLL3RuCmObVmPN+24kfa+AojDuM4umKe2QwCf6EN906HwjujaitDs5o0s1y+k3lgbT2W2i7FJdnwbLXhJUBq/9liTctSmFC/0OqUinb0QddTWamtjbHRFuWJJ6NpqZ8vO3fZJ37Db+2GkaPYLGHs7XTTdiFQJ68SkVJFVmY6McR5UycflNCsccHFaV9FNbR4NttLxw4pQ7wJd066Z0ohVbzihaxHVExd/ay04oxUKWt+AsdiQ9OUyZ2krzN19IZIwafSTFgIBnMV73ADj7V/K8u1MaY2sJp2HWm0f41tqwajEvdHWOJs510MaAqN4aoSiPCXtN2KSi46dUxHdaMquar82O1x5jqhDGvqmoE9LfxcY3zqA7/x3HA67r9ZG4O6Cuxu12/+TP+eLP+I+HErqDDCDVmBDO4larujNe7x8om2rMug0MX0rL1+IWwdwfR+p1TNTyNmVJ85ljWzbWuGv8/C7HD/izjkHNZNYlhZcUOKVzKFUxsxxN/kax+8zPWPSFKw80rJr9Tizyj3o1gEsdwgWGoxPezDdZ1TSENE1dLdNvuKL+I84nxKesZgxXVA1VA1OcL49dFlpFV5yJMhzyCmNQ+a4BqusPJ2bB+xo8V9u3x48VVIEPS/mc3DvAbXyoYr6VgDfh5do5hhHOCXMqBZUPhWYbWZECwVJljLgMUWOCB4MUuMaxGNUQDVI50TQ+S3kFgIcu2qKkNSHVoM0SHsgoZxP2d5HH8B9woOk4x5bPkKtAHucZsdykjxuIpbUrSILgrT8G7G5oCW+K0990o7E3T6AdW4TilH5kDjds+H64kS0mz24grtwlzDHBJqI8YJQExotPvoC4JBq0lEjjQkyBZ8oH2LnRsQ4Hu1QsgDTJbO8fQDnllitkxuVskoiKbRF9VwzMDvxHAdwB7mD9yCplhHFEyUWHx3WtwCbSMMTCUCcEmSGlg4gTXkHpZXWQ7kpznK3EmCHiXInqndkQjunG5kxTKEeGye7jWz9cyMR2mGiFQ15ENRBTbCp+Gh86vAyASdgmJq2MC6hoADQ3GosP0QHbnMHjyBQvQqfhy/BUbeHd5WY/G/9LK/8Ka8Jd7UFeNWEZvzPb458Dn8DGLOe3/wGL/4xP+HXlRt+M1PE2iLhR8t+lfgxsuh7AfO2AOf+owWhSZRYQbd622hbpKWKuU+XuvNzP0OseRDa+mObgDHJUSc/pKx31QdKffQ5OIJpt8GWjlgTwMc/w5MPCR/yl1XC2a2Yut54SvOtMev55Of45BOat9aWG27p2ZVORRvnEk1hqWMVUmqa7S2YtvlIpspuF1pt0syuZS2NV14mUidCSfzQzg+KqvIYCMljIx2YK2AO34fX4GWdu5xcIAb8MzTw+j/lyWM+Dw/gjs4GD6ehNgA48kX/AI7XXM/XAN4WHr+9ntywqoCakCqmKP0rmQrJJEErG2Upg1JObr01lKQy4jskWalKYfJ/EDLMpjNSHFEUAde2fltaDgmrNaWQ9+AAb8I5vKjz3L1n1LriB/BXkG/wwR9y/oRX4LlioHA4LzP2inzRx/DWmutRweFjeP3tNeSGlaE1Fde0OS11yOpmbIp2u/jF1n2RRZviJM0yBT3IZl2HWImKjQOxIyeU325b/qWyU9Moj1o07tS0G7qJDoGHg5m8yeCxMoEH8GU45tnrNM84D2l297DQ9t1YP7jki/7RmutRweEA77/HWXOh3HCxkRgldDQkAjNTMl2Iloc1qN5JfJeeTlyTRzxURTdn1Ixv2uKjs12AbdEWlBtmVdk2k7FFwj07PCZ9XAwW3dG+8xKzNFr4EnwBZpy9Qzhh3jDXebBpYcpuo4fQ44u+fD1dweEnHzI7v0xuuOALRUV8rXpFyfSTQYkhd7IHm07jpyhlkCmI0ALYqPTpUxXS+z4jgDj1Pflvmz5ecuItpIBxyTHpSTGWd9g1ApfD/bvwUhL4nT1EzqgX7cxfCcNmb3mPL/qi9SwTHJ49oj5ZLjccbTG3pRmlYi6JCG0mQrAt1+i2UXTZ2dv9IlQpN5naMYtviaXlTrFpoMsl3bOAFEa8sqPj2WCMrx3Yjx99qFwO59Aw/wgx+HlqNz8oZvA3exRDvuhL1jMQHPaOJ0+XyA3fp1OfM3qObEVdhxjvynxNMXQV4+GJyvOEFqeQBaIbbO7i63rpxCltdZShPFxkjM2FPVkn3TG+Rp9pO3l2RzFegGfxGDHIAh8SteR0C4HopXzRF61nheDw6TFN05Ebvq8M3VKKpGjjO6r7nhudTEGMtYM92HTDaR1FDMXJ1eThsbKfywyoWwrzRSXkc51flG3vIid62h29bIcFbTGhfV+faaB+ohj7dPN0C2e2lC96+XouFByen9AsunLDJZ9z7NExiUc0OuoYW6UZkIyx2YUR2z6/TiRjyKMx5GbbjLHvHuf7YmtKghf34LJfx63Yg8vrvN2zC7lY0x0tvKezo4HmGYDU+Gab6dFL+KI761lDcNifcjLrrr9LWZJctG1FfU1uwhoQE22ObjdfkSzY63CbU5hzs21WeTddH2BaL11Gi7lVdlxP1nkxqhnKhVY6knS3EPgVGg1JpN5cP/hivujOelhXcPj8HC/LyI6MkteVjlolBdMmF3a3DbsuAYhL44dxzthWSN065xxUd55Lmf0wRbOYOqH09/o9WbO2VtFdaMb4qBgtFJoT1SqoN8wPXMoXLb3p1PUEhxfnnLzGzBI0Ku7FxrKsNJj/8bn/H8fPIVOd3rfrklUB/DOeO+nkghgSPzrlPxluCMtOnDL4Yml6dK1r3vsgMxgtPOrMFUZbEUbTdIzii5beq72G4PD0DKnwjmBULUVFmy8t+k7fZ3pKc0Q4UC6jpVRqS9Umv8bxw35flZVOU1X7qkjnhZlsMbk24qQ6Hz7QcuL6sDC0iHHki96Uh2UdvmgZnjIvExy2TeJdMDZNSbdZyAHe/Yd1xsQhHiKzjh7GxQ4yqMPaywPkjMamvqrYpmO7Knad+ZQC5msCuAPWUoxrxVhrGv7a+KLXFhyONdTMrZ7ke23qiO40ZJUyzgYyX5XyL0mV7NiUzEs9mjtbMN0dERqwyAJpigad0B3/zRV7s4PIfXSu6YV/MK7+OrYe/JvfGMn/PHJe2fyUdtnFrKRNpXV0Y2559aWPt/G4BlvjTMtXlVIWCnNyA3YQBDmYIodFz41PvXPSa6rq9lWZawZ4dP115HXV/M/tnFkkrBOdzg6aP4pID+MZnTJ1SuuB6iZlyiox4HT2y3YBtkUKWooacBQUDTpjwaDt5poBHl1/HXltwP887lKKXxNUEyPqpGTyA699UqY/lt9yGdlUKra0fFWS+36iylVWrAyd7Uw0CZM0z7xKTOduznLIjG2Hx8cDPLb+OvK6Bv7n1DYci4CxUuRxrjBc0bb4vD3rN5Zz36ntLb83eVJIB8LiIzCmn6SMPjlX+yNlTjvIGjs+QzHPf60Aj62/jrzG8j9vYMFtm1VoRWCJdmw7z9N0t+c8cxZpPeK4aTRicS25QhrVtUp7U578chk4q04Wx4YoQSjFryUlpcQ1AbxZ/XVMknIU//OGl7Q6z9Zpxi0+3yFhSkjUDpnCIUhLWVX23KQ+L9vKvFKI0ZWFQgkDLvBoylrHNVmaw10zwCPrr5tlodfnf94EWnQ0lFRWy8pW9LbkLsyUVDc2NSTHGDtnD1uMtchjbCeb1mpxFP0YbcClhzdLu6lfO8Bj6q+bdT2sz/+8SZCV7VIxtt0DUn9L7r4cLYWDSXnseEpOGFuty0qbOVlS7NNzs5FOGJUqQpl2Q64/yBpZf90sxbE+//PGdZ02HSipCbmD6NItmQ4Lk5XUrGpDMkhbMm2ZVheNYV+VbUWTcv99+2NyX1VoafSuC+AN6q9bFIMv5X/eagNWXZxEa9JjlMwNWb00akGUkSoepp1/yRuuqHGbUn3UdBSTxBU6SEVklzWRUkPndVvw2PrrpjvxOvzPmwHc0hpmq82npi7GRro8dXp0KXnUQmhZbRL7NEVp1uuZmO45vuzKsHrktS3GLWXODVjw+vXXLYx4Hf7njRPd0i3aoAGX6W29GnaV5YdyDj9TFkakje7GHYzDoObfddHtOSpoi2SmzJHrB3hM/XUDDEbxP2/oosszcRlehWXUvzHv4TpBVktHqwenFo8uLVmy4DKLa5d3RtLrmrM3aMFr1183E4sewf+85VWeg1c5ag276NZrM9IJVNcmLEvDNaV62aq+14IAOGFsBt973Ra8Xv11YzXwNfmft7Jg2oS+XOyoC8/cwzi66Dhmgk38kUmP1CUiYWOX1bpD2zWXt2FCp7uq8703APAa9dfNdscR/M/bZLIyouVxqJfeWvG9Je+JVckHQ9+CI9NWxz+blX/KYYvO5n2tAP/vrlZ7+8/h9y+9qeB/Hnt967e5mevX10rALDWK//FaAT5MXdBXdP0C/BAes792c40H+AiAp1e1oH8HgH94g/Lttx1gp63op1eyoM/Bvw5/G/7xFbqJPcCXnmBiwDPb/YKO4FX4OjyCb289db2/Noqicw4i7N6TVtoz8tNwDH+8x/i6Ae7lmaQVENzJFb3Di/BFeAwz+Is9SjeQySpPqbLFlNmyz47z5a/AF+AYFvDmHqibSXTEzoT4Gc3OALaqAP4KPFUJ6n+1x+rGAM6Zd78bgJ0a8QN4GU614vxwD9e1Amy6CcskNrczLx1JIp6HE5UZD/DBHrFr2oNlgG4Odv226BodoryjGJ9q2T/AR3vQrsOCS0ctXZi3ruLlhpFDJYl4HmYtjQCP9rhdn4suySLKDt6wLcC52h8xPlcjju1fn+yhuw4LZsAGUuo2b4Fx2UwQu77uqRHXGtg92aN3tQCbFexc0uk93vhTXbct6y7MulLycoUljx8ngDMBg1tvJjAazpEmOtxlzclvj1vQf1Tx7QlPDpGpqgtdSKz/d9/hdy1vTfFHSmC9dGDZbLiezz7Ac801HirGZsWjydfZyPvHXL/Y8Mjzg8BxTZiuwKz4Eb8sBE9zznszmjvFwHKPIWUnwhqfVRcd4Ck0K6ate48m1oOfrX3/yOtvAsJ8zsPAM89sjnddmuLuDPjX9Bu/L7x7xpMzFk6nWtyQfPg278Gn4Aekz2ZgOmU9eJ37R14vwE/BL8G3aibCiWMWWDQ0ZtkPMnlcGeAu/Ag+8ZyecU5BPuy2ILD+sQqyZhAKmn7XZd+jIMTN9eBL7x95xVLSX4On8EcNlXDqmBlqS13jG4LpmGbkF/0CnOi3H8ETOIXzmnmtb0a16Tzxj1sUvQCBiXZGDtmB3KAefPH94xcUa/6vwRn80GOFyjEXFpba4A1e8KQfFF+259tx5XS4egYn8fQsLGrqGrHbztr+uByTahWuL1NUGbDpsnrwBfePPwHHIf9X4RnM4Z2ABWdxUBlqQ2PwhuDxoS0vvqB1JzS0P4h2nA/QgTrsJFn+Y3AOjs9JFC07CGWX1oNX3T/yHOzgDjwPn1PM3g9Jk9lZrMEpxnlPmBbjyo2+KFXRU52TJM/2ALcY57RUzjObbjqxVw++4P6RAOf58pcVsw9Daje3htriYrpDOonre3CudSe6bfkTEgHBHuDiyu5MCsc7BHhYDx7ePxLjqigXZsw+ijMHFhuwBmtoTPtOxOrTvYJDnC75dnUbhfwu/ZW9AgYd+peL68HD+0emKquiXHhWjJg/UrkJYzuiaL3E9aI/ytrCvAd4GcYZMCkSQxfUg3v3j8c4e90j5ZTPdvmJJGHnOCI2nHS8081X013pHuBlV1gB2MX1YNmWLHqqGN/TWmG0y6clJWthxNUl48q38Bi8vtMKyzzpFdSDhxZ5WBA5ZLt8Jv3895DduBlgbPYAj8C4B8hO68FDkoh5lydC4FiWvBOVqjYdqjiLv92t8yPDjrDaiHdUD15qkSURSGmXJwOMSxWAXYwr3zaAufJ66l+94vv3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/wHuD9tQd4f+0B3l97gPfXHuD9tQd4f+0B3l97gG8LwP8G/AL8O/A5OCq0Ys2KIdv/qOIXG/4mvFAMF16gZD+2Xvu/B8as5+8bfllWyg0zaNO5bfXj6vfhhwD86/Aq3NfRS9t9WPnhfnvCIw/CT8GLcFTMnpntdF/z9V+PWc/vWoIH+FL3Znv57PitcdGP4R/C34avw5fgRVUInCwbsn1yyA8C8zm/BH8NXoXnVE6wVPjdeCI38kX/3+Ct9dbz1pTmHFRu+Hm4O9Ch3clr99negxfwj+ER/DR8EV6B5+DuQOnTgUw5rnkY+FbNU3gNXh0o/JYTuWOvyBf9FvzX663HH/HejO8LwAl8Hl5YLTd8q7sqA3wbjuExfAFegQdwfyDoSkWY8swzEf6o4Qyewefg+cHNbqMQruSL/u/WWc+E5g7vnnEXgDmcDeSGb/F4cBcCgT+GGRzDU3hZYburAt9TEtHgbM6JoxJ+6NMzzTcf6c2bycv2+KK/f+l6LBzw5IwfqZJhA3M472pWT/ajKxnjv4AFnMEpnBTPND6s2J7qHbPAqcMK74T2mZ4VGB9uJA465It+/eL1WKhYOD7xHOkr1ajK7d0C4+ke4Hy9qXZwpgLr+Znm/uNFw8xQOSy8H9IzjUrd9+BIfenYaylf9FsXr8fBAadnPIEDna8IBcwlxnuA0/Wv6GAWPd7dDIKjMdSWueAsBj4M7TOd06qBbwDwKr7oleuxMOEcTuEZTHWvDYUO7aHqAe0Bbq+HEFRzOz7WVoTDQkVds7A4sIIxfCQdCefFRoIOF/NFL1mPab/nvOakSL/Q1aFtNpUb/nFOVX6gzyg/1nISyDfUhsokIzaBR9Kxm80s5mK+6P56il1jXic7nhQxsxSm3OwBHl4fFdLqi64nDQZvqE2at7cWAp/IVvrN6/BFL1mPhYrGMBfOi4PyjuSGf6wBBh7p/FZTghCNWGgMzlBbrNJoPJX2mW5mwZfyRffXo7OFi5pZcS4qZUrlViptrXtw+GQoyhDPS+ANjcGBNRiLCQDPZPMHuiZfdFpPSTcQwwKYdRNqpkjm7AFeeT0pJzALgo7g8YYGrMHS0iocy+YTm2vyRUvvpXCIpQ5pe666TJrcygnScUf/p0NDs/iAI/nqDHC8TmQT8x3NF91l76oDdQGwu61Z6E0ABv7uO1dbf/37Zlv+Zw/Pbh8f1s4Avur6657/+YYBvur6657/+YYBvur6657/+YYBvur6657/+aYBvuL6657/+VMA8FXWX/f8zzcN8BXXX/f8zzcNMFdbf93zP38KLPiK6697/uebtuArrr/u+Z9vGmCusP6653/+1FjwVdZf9/zPN7oHX339dc//fNMu+irrr3v+50+Bi+Zq6697/uebA/jz8Pudf9ht/fWv517J/XUzAP8C/BAeX9WCDrUpZ3/dEMBxgPcfbtTVvsYV5Yn32u03B3Ac4P3b8I+vxNBKeeL9dRMAlwO83959qGO78sT769oB7g3w/vGVYFzKE++v6wV4OMD7F7tckFkmT7y/rhHgpQO8b+4Y46XyxPvrugBeNcB7BRiX8sT767oAvmCA9woAHsoT76+rBJjLBnh3txOvkifeX1dswZcO8G6N7sXyxPvr6i340gHe3TnqVfLE++uKAb50gHcXLnrX8sR7gNdPRqwzwLu7Y/FO5Yn3AK9jXCMGeHdgxDuVJ75VAI8ljP7PAb3/RfjcZfePHBB+79dpfpH1CanN30d+mT1h9GqAxxJGM5LQeeQ1+Tb+EQJrElLb38VHQ94TRq900aMIo8cSOo+8Dp8QfsB8zpqE1NO3OI9Zrj1h9EV78PqE0WMJnUdeU6E+Jjyk/hbrEFIfeWbvId8H9oTRFwdZaxJGvziW0Hn0gqYB/wyZ0PwRlxJST+BOw9m77Amj14ii1yGM/txYQudN0qDzGe4EqfA/5GJCagsHcPaEPWH0esekSwmjRxM6b5JEcZ4ww50ilvAOFxBSx4yLW+A/YU8YvfY5+ALC6NGEzhtmyZoFZoarwBLeZxUhtY4rc3bKnjB6TKJjFUHzJoTOozF2YBpsjcyxDgzhQ1YRUse8+J4wenwmaylB82hC5w0zoRXUNXaRBmSMQUqiWSWkLsaVqc/ZE0aPTFUuJWgeTei8SfLZQeMxNaZSIzbII4aE1Nmr13P2hNHjc9E9guYNCZ032YlNwESMLcZiLQHkE4aE1BFg0yAR4z1h9AiAGRA0jyZ03tyIxWMajMPWBIsxYJCnlITU5ShiHYdZ94TR4wCmSxg9jtB5KyPGYzymAYexWEMwAPIsAdYdV6aObmNPGD0aYLoEzaMJnTc0Ygs+YDw0GAtqxBjkuP38bMRWCHn73xNGjz75P73WenCEJnhwyVe3AEe8TtKdJcYhBl97wuhNAObK66lvD/9J9NS75v17wuitAN5fe4D31x7g/bUHeH/tAd5fe4D3AO+vPcD7aw/w/toDvL/2AO+vPcD7aw/w/toDvAd4f/24ABzZ8o+KLsSLS+Pv/TqTb3P4hKlQrTGh+fbIBT0Axqznnb+L/V2mb3HkN5Mb/nEHeK7d4IcDld6lmDW/iH9E+AH1MdOw/Jlu2T1xNmY98sv4wHnD7D3uNHu54WUuOsBTbQuvBsPT/UfzNxGYzwkP8c+Yz3C+r/i6DcyRL/rZ+utRwWH5PmfvcvYEt9jLDS/bg0/B64DWKrQM8AL8FPwS9beQCe6EMKNZYJol37jBMy35otdaz0Bw2H/C2Smc7+WGB0HWDELBmOByA3r5QONo4V+DpzR/hFS4U8wMW1PXNB4TOqYz9urxRV++ntWCw/U59Ty9ebdWbrgfRS9AYKKN63ZokZVygr8GZ/gfIhZXIXPsAlNjPOLBby5c1eOLvmQ9lwkOy5x6QV1j5TYqpS05JtUgUHUp5toHGsVfn4NX4RnMCe+AxTpwmApTYxqMxwfCeJGjpXzRF61nbcHhUBPqWze9svwcHJ+S6NPscKrEjug78Dx8Lj3T8D4YxGIdxmJcwhi34fzZUr7olevZCw5vkOhoClq5zBPZAnygD/Tl9EzDh6kl3VhsHYcDEb+hCtJSvuiV69kLDm+WycrOTArHmB5/VYyP6jOVjwgGawk2zQOaTcc1L+aLXrKeveDwZqlKrw8U9Y1p66uK8dEzdYwBeUQAY7DbyYNezBfdWQ97weEtAKYQg2xJIkuveAT3dYeLGH+ShrWNwZgN0b2YL7qznr3g8JYAo5bQBziPjx7BPZ0d9RCQp4UZbnFdzBddor4XHN4KYMrB2qHFRIzzcLAHQZ5the5ovui94PCWAPefaYnxIdzRwdHCbuR4B+tbiy96Lzi8E4D7z7S0mEPd+eqO3cT53Z0Y8SV80XvB4Z0ADJi/f7X113f+7p7/+UYBvur6657/+YYBvur6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+aYBvuL6657/+VMA8FXWX/f8z58OgK+y/rrnf75RgLna+uue//lTA/CV1V/3/M837aKvvv6653++UQvmauuve/7nTwfAV1N/3fM/fzr24Cuuv+75nz8FFnxl9dc9//MOr/8/glixwRuUfM4AAAAASUVORK5CYII="},getSearchTexture:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAAAAABIXyLAAAAAOElEQVRIx2NgGAWjYBSMglEwEICREYRgFBZBqDCSLA2MGPUIVQETE9iNUAqLR5gIeoQKRgwXjwAAGn4AtaFeYLEAAAAASUVORK5CYII="}});var SSAARenderPass=function(e,a,d,v){Pass.call(this),this.scene=e,this.camera=a,this.sampleLevel=4,this.unbiased=!0,this.clearColor=void 0!==d?d:0,this.clearAlpha=void 0!==v?v:0,void 0===CopyShader&&console.error("SSAARenderPass relies on CopyShader");var g=CopyShader;this.copyUniforms=UniformsUtils.clone(g.uniforms),this.copyMaterial=new ShaderMaterial({uniforms:this.copyUniforms,vertexShader:g.vertexShader,fragmentShader:g.fragmentShader,premultipliedAlpha:!0,transparent:!0,blending:AdditiveBlending,depthTest:!1,depthWrite:!1}),this.fsQuad=new Pass.FullScreenQuad(this.copyMaterial)};SSAARenderPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:SSAARenderPass,dispose:function(){this.sampleRenderTarget&&(this.sampleRenderTarget.dispose(),this.sampleRenderTarget=null)},setSize:function(e,a){this.sampleRenderTarget&&this.sampleRenderTarget.setSize(e,a)},render:function(e,a,d){this.sampleRenderTarget||(this.sampleRenderTarget=new WebGLRenderTarget(d.width,d.height,{minFilter:LinearFilter,magFilter:LinearFilter,format:RGBAFormat}),this.sampleRenderTarget.texture.name="SSAARenderPass.sample");var v=SSAARenderPass.JitterVectors[Math.max(0,Math.min(this.sampleLevel,5))],g=e.autoClear;e.autoClear=!1;var C=e.getClearColor().getHex(),w=e.getClearAlpha(),_=1/v.length;this.copyUniforms.tDiffuse.value=this.sampleRenderTarget.texture;for(var b=d.width,A=d.height,E=0;E<v.length;E++){var R=v[E];this.camera.setViewOffset&&this.camera.setViewOffset(b,A,.0625*R[0],.0625*R[1],b,A);var O=_;this.unbiased&&(O+=.03125*((E+.5)/v.length-.5)),this.copyUniforms.opacity.value=O,e.setClearColor(this.clearColor,this.clearAlpha),e.setRenderTarget(this.sampleRenderTarget),e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(this.renderToScreen?null:a),0===E&&(e.setClearColor(0,0),e.clear()),this.fsQuad.render(e)}this.camera.clearViewOffset&&this.camera.clearViewOffset(),e.autoClear=g,e.setClearColor(C,w)}}),SSAARenderPass.JitterVectors=[[[0,0]],[[4,4],[-4,-4]],[[-2,-6],[6,-2],[-6,2],[2,6]],[[1,-3],[-1,3],[5,1],[-3,-5],[-5,5],[-7,-1],[3,7],[7,-7]],[[1,1],[-1,-3],[-3,2],[4,-1],[-5,-2],[2,5],[5,3],[3,-5],[-2,6],[0,-7],[-4,-6],[-6,4],[-8,0],[7,-4],[6,7],[-7,-8]],[[-4,-7],[-7,-5],[-3,-5],[-5,-4],[-1,-4],[-2,-2],[-6,-1],[-4,0],[-7,1],[-1,2],[-6,3],[-3,3],[-7,6],[-3,6],[-5,7],[-1,7],[5,-7],[1,-6],[6,-5],[4,-4],[2,-3],[7,-2],[1,-1],[4,-1],[2,1],[6,2],[0,4],[4,4],[2,5],[7,5],[5,6],[3,7]]];var SSAOShader={defines:{PERSPECTIVE_CAMERA:1,KERNEL_SIZE:32},uniforms:{tDiffuse:{value:null},tNormal:{value:null},tDepth:{value:null},tNoise:{value:null},kernel:{value:null},cameraNear:{value:null},cameraFar:{value:null},resolution:{value:new Vector2},cameraProjectionMatrix:{value:new Matrix4},cameraInverseProjectionMatrix:{value:new Matrix4},kernelRadius:{value:8},minDistance:{value:.005},maxDistance:{value:.05}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform sampler2D tNormal;","uniform sampler2D tDepth;","uniform sampler2D tNoise;","uniform vec3 kernel[ KERNEL_SIZE ];","uniform vec2 resolution;","uniform float cameraNear;","uniform float cameraFar;","uniform mat4 cameraProjectionMatrix;","uniform mat4 cameraInverseProjectionMatrix;","uniform float kernelRadius;","uniform float minDistance;","uniform float maxDistance;","varying vec2 vUv;","#include <packing>","float getDepth( const in vec2 screenPosition ) {","\treturn texture2D( tDepth, screenPosition ).x;","}","float getLinearDepth( const in vec2 screenPosition ) {","\t#if PERSPECTIVE_CAMERA == 1","\t\tfloat fragCoordZ = texture2D( tDepth, screenPosition ).x;","\t\tfloat viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );","\t\treturn viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );","\t#else","\t\treturn texture2D( depthSampler, coord ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\t\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","\t#else","\t\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );","\t#endif","}","vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {","\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];","\tvec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );","\tclipPosition *= clipW; // unprojection.","\treturn ( cameraInverseProjectionMatrix * clipPosition ).xyz;","}","vec3 getViewNormal( const in vec2 screenPosition ) {","\treturn unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );","}","void main() {","\tfloat depth = getDepth( vUv );","\tfloat viewZ = getViewZ( depth );","\tvec3 viewPosition = getViewPosition( vUv, depth, viewZ );","\tvec3 viewNormal = getViewNormal( vUv );"," vec2 noiseScale = vec2( resolution.x / 4.0, resolution.y / 4.0 );","\tvec3 random = texture2D( tNoise, vUv * noiseScale ).xyz;","\tvec3 tangent = normalize( random - viewNormal * dot( random, viewNormal ) );","\tvec3 bitangent = cross( viewNormal, tangent );","\tmat3 kernelMatrix = mat3( tangent, bitangent, viewNormal );"," float occlusion = 0.0;"," for ( int i = 0; i < KERNEL_SIZE; i ++ ) {","\t\tvec3 sampleVector = kernelMatrix * kernel[ i ];","\t\tvec3 samplePoint = viewPosition + ( sampleVector * kernelRadius );","\t\tvec4 samplePointNDC = cameraProjectionMatrix * vec4( samplePoint, 1.0 );","\t\tsamplePointNDC /= samplePointNDC.w;","\t\tvec2 samplePointUv = samplePointNDC.xy * 0.5 + 0.5;","\t\tfloat realDepth = getLinearDepth( samplePointUv );","\t\tfloat sampleDepth = viewZToOrthographicDepth( samplePoint.z, cameraNear, cameraFar );","\t\tfloat delta = sampleDepth - realDepth;","\t\tif ( delta > minDistance && delta < maxDistance ) {","\t\t\tocclusion += 1.0;","\t\t}","\t}","\tocclusion = clamp( occlusion / float( KERNEL_SIZE ), 0.0, 1.0 );","\tgl_FragColor = vec4( vec3( 1.0 - occlusion ), 1.0 );","}"].join("\n")},SSAODepthShader={defines:{PERSPECTIVE_CAMERA:1},uniforms:{tDepth:{value:null},cameraNear:{value:null},cameraFar:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDepth;","uniform float cameraNear;","uniform float cameraFar;","varying vec2 vUv;","#include <packing>","float getLinearDepth( const in vec2 screenPosition ) {","\t#if PERSPECTIVE_CAMERA == 1","\t\tfloat fragCoordZ = texture2D( tDepth, screenPosition ).x;","\t\tfloat viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );","\t\treturn viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );","\t#else","\t\treturn texture2D( depthSampler, coord ).x;","\t#endif","}","void main() {","\tfloat depth = getLinearDepth( vUv );","\tgl_FragColor = vec4( vec3( 1.0 - depth ), 1.0 );","}"].join("\n")},SSAOBlurShader={uniforms:{tDiffuse:{value:null},resolution:{value:new Vector2}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec2 resolution;","varying vec2 vUv;","void main() {","\tvec2 texelSize = ( 1.0 / resolution );","\tfloat result = 0.0;","\tfor ( int i = - 2; i <= 2; i ++ ) {","\t\tfor ( int j = - 2; j <= 2; j ++ ) {","\t\t\tvec2 offset = ( vec2( float( i ), float( j ) ) ) * texelSize;","\t\t\tresult += texture2D( tDiffuse, vUv + offset ).r;","\t\t}","\t}","\tgl_FragColor = vec4( vec3( result / ( 5.0 * 5.0 ) ), 1.0 );","}"].join("\n")},SSAOPass=function(e,a,d,v){Pass.call(this),this.width=void 0!==d?d:512,this.height=void 0!==v?v:512,this.clear=!0,this.camera=a,this.scene=e,this.kernelRadius=8,this.kernelSize=32,this.kernel=[],this.noiseTexture=null,this.output=0,this.minDistance=.005,this.maxDistance=.1,this.generateSampleKernel(),this.generateRandomKernelRotations();var g=new DepthTexture;g.type=UnsignedShortType,g.minFilter=NearestFilter,g.maxFilter=NearestFilter,this.beautyRenderTarget=new WebGLRenderTarget(this.width,this.height,{minFilter:LinearFilter,magFilter:LinearFilter,format:RGBAFormat,depthTexture:g,depthBuffer:!0}),this.normalRenderTarget=new WebGLRenderTarget(this.width,this.height,{minFilter:NearestFilter,magFilter:NearestFilter,format:RGBAFormat}),this.ssaoRenderTarget=new WebGLRenderTarget(this.width,this.height,{minFilter:LinearFilter,magFilter:LinearFilter,format:RGBAFormat}),this.blurRenderTarget=this.ssaoRenderTarget.clone(),void 0===SSAOShader&&console.error("SSAOPass: The pass relies on SSAOShader."),this.ssaoMaterial=new ShaderMaterial({defines:Object.assign({},SSAOShader.defines),uniforms:UniformsUtils.clone(SSAOShader.uniforms),vertexShader:SSAOShader.vertexShader,fragmentShader:SSAOShader.fragmentShader,blending:NoBlending}),this.ssaoMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.ssaoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.ssaoMaterial.uniforms.tDepth.value=this.beautyRenderTarget.depthTexture,this.ssaoMaterial.uniforms.tNoise.value=this.noiseTexture,this.ssaoMaterial.uniforms.kernel.value=this.kernel,this.ssaoMaterial.uniforms.cameraNear.value=this.camera.near,this.ssaoMaterial.uniforms.cameraFar.value=this.camera.far,this.ssaoMaterial.uniforms.resolution.value.set(this.width,this.height),this.ssaoMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssaoMaterial.uniforms.cameraInverseProjectionMatrix.value.getInverse(this.camera.projectionMatrix),this.normalMaterial=new MeshNormalMaterial,this.normalMaterial.blending=NoBlending,this.blurMaterial=new ShaderMaterial({defines:Object.assign({},SSAOBlurShader.defines),uniforms:UniformsUtils.clone(SSAOBlurShader.uniforms),vertexShader:SSAOBlurShader.vertexShader,fragmentShader:SSAOBlurShader.fragmentShader}),this.blurMaterial.uniforms.tDiffuse.value=this.ssaoRenderTarget.texture,this.blurMaterial.uniforms.resolution.value.set(this.width,this.height),this.depthRenderMaterial=new ShaderMaterial({defines:Object.assign({},SSAODepthShader.defines),uniforms:UniformsUtils.clone(SSAODepthShader.uniforms),vertexShader:SSAODepthShader.vertexShader,fragmentShader:SSAODepthShader.fragmentShader,blending:NoBlending}),this.depthRenderMaterial.uniforms.tDepth.value=this.beautyRenderTarget.depthTexture,this.depthRenderMaterial.uniforms.cameraNear.value=this.camera.near,this.depthRenderMaterial.uniforms.cameraFar.value=this.camera.far,this.copyMaterial=new ShaderMaterial({uniforms:UniformsUtils.clone(CopyShader.uniforms),vertexShader:CopyShader.vertexShader,fragmentShader:CopyShader.fragmentShader,transparent:!0,depthTest:!1,depthWrite:!1,blendSrc:DstColorFactor,blendDst:ZeroFactor,blendEquation:AddEquation,blendSrcAlpha:DstAlphaFactor,blendDstAlpha:ZeroFactor,blendEquationAlpha:AddEquation}),this.fsQuad=new Pass.FullScreenQuad(null),this.originalClearColor=new Color};SSAOPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:SSAOPass,dispose:function(){this.beautyRenderTarget.dispose(),this.normalRenderTarget.dispose(),this.ssaoRenderTarget.dispose(),this.blurRenderTarget.dispose(),this.normalMaterial.dispose(),this.blurMaterial.dispose(),this.copyMaterial.dispose(),this.depthRenderMaterial.dispose(),this.fsQuad.dispose()},render:function(e,a){switch(e.setRenderTarget(this.beautyRenderTarget),e.clear(),e.render(this.scene,this.camera),this.renderOverride(e,this.normalMaterial,this.normalRenderTarget,7829503,1),this.ssaoMaterial.uniforms.kernelRadius.value=this.kernelRadius,this.ssaoMaterial.uniforms.minDistance.value=this.minDistance,this.ssaoMaterial.uniforms.maxDistance.value=this.maxDistance,this.renderPass(e,this.ssaoMaterial,this.ssaoRenderTarget),this.renderPass(e,this.blurMaterial,this.blurRenderTarget),this.output){case SSAOPass.OUTPUT.SSAO:this.copyMaterial.uniforms.tDiffuse.value=this.ssaoRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(e,this.copyMaterial,this.renderToScreen?null:a);break;case SSAOPass.OUTPUT.Blur:this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(e,this.copyMaterial,this.renderToScreen?null:a);break;case SSAOPass.OUTPUT.Beauty:this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(e,this.copyMaterial,this.renderToScreen?null:a);break;case SSAOPass.OUTPUT.Depth:this.renderPass(e,this.depthRenderMaterial,this.renderToScreen?null:a);break;case SSAOPass.OUTPUT.Normal:this.copyMaterial.uniforms.tDiffuse.value=this.normalRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(e,this.copyMaterial,this.renderToScreen?null:a);break;case SSAOPass.OUTPUT.Default:this.copyMaterial.uniforms.tDiffuse.value=this.beautyRenderTarget.texture,this.copyMaterial.blending=NoBlending,this.renderPass(e,this.copyMaterial,this.renderToScreen?null:a),this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.copyMaterial.blending=CustomBlending,this.renderPass(e,this.copyMaterial,this.renderToScreen?null:a);break;default:console.warn("SSAOPass: Unknown output type.")}},renderPass:function(e,a,d,v,g){this.originalClearColor.copy(e.getClearColor());var C=e.getClearAlpha(),w=e.autoClear;e.setRenderTarget(d),e.autoClear=!1,null!=v&&(e.setClearColor(v),e.setClearAlpha(g||0),e.clear()),this.fsQuad.material=a,this.fsQuad.render(e),e.autoClear=w,e.setClearColor(this.originalClearColor),e.setClearAlpha(C)},renderOverride:function(e,a,d,v,g){this.originalClearColor.copy(e.getClearColor());var C=e.getClearAlpha(),w=e.autoClear;e.setRenderTarget(d),e.autoClear=!1,g=a.clearAlpha||g,null!=(v=a.clearColor||v)&&(e.setClearColor(v),e.setClearAlpha(g||0),e.clear()),this.scene.overrideMaterial=a,e.render(this.scene,this.camera),this.scene.overrideMaterial=null,e.autoClear=w,e.setClearColor(this.originalClearColor),e.setClearAlpha(C)},setSize:function(e,a){this.width=e,this.height=a,this.beautyRenderTarget.setSize(e,a),this.ssaoRenderTarget.setSize(e,a),this.normalRenderTarget.setSize(e,a),this.blurRenderTarget.setSize(e,a),this.ssaoMaterial.uniforms.resolution.value.set(e,a),this.ssaoMaterial.uniforms.cameraProjectionMatrix.value.copy(this.camera.projectionMatrix),this.ssaoMaterial.uniforms.cameraInverseProjectionMatrix.value.getInverse(this.camera.projectionMatrix),this.blurMaterial.uniforms.resolution.value.set(e,a)},generateSampleKernel:function(){for(var e=this.kernelSize,a=this.kernel,d=0;d<e;d++){var v=new Vector3;v.x=2*Math.random()-1,v.y=2*Math.random()-1,v.z=Math.random(),v.normalize();var g=d/e;g=MathUtils.lerp(.1,1,g*g),v.multiplyScalar(g),a.push(v)}},generateRandomKernelRotations:function(){void 0===SimplexNoise&&console.error("SSAOPass: The pass relies on SimplexNoise.");for(var d=new SimplexNoise,g=new Float32Array(64),C=0;C<16;C++){var w=4*C,_=2*Math.random()-1,x=2*Math.random()-1,A=d.noise3d(_,x,0);g[w]=A,g[w+1]=A,g[w+2]=A,g[w+3]=1}this.noiseTexture=new DataTexture(g,4,4,RGBAFormat,FloatType),this.noiseTexture.wrapS=RepeatWrapping,this.noiseTexture.wrapT=RepeatWrapping}}),SSAOPass.OUTPUT={Default:0,SSAO:1,Blur:2,Beauty:3,Depth:4,Normal:5};var TAARenderPass=function(e,a,d,v){void 0===SSAARenderPass&&console.error("TAARenderPass relies on SSAARenderPass"),SSAARenderPass.call(this,e,a,d,v),this.sampleLevel=0,this.accumulate=!1};TAARenderPass.JitterVectors=SSAARenderPass.JitterVectors,TAARenderPass.prototype=Object.assign(Object.create(SSAARenderPass.prototype),{constructor:TAARenderPass,render:function(e,a,d,v){if(!this.accumulate)return SSAARenderPass.prototype.render.call(this,e,a,d,v),void(this.accumulateIndex=-1);var g=TAARenderPass.JitterVectors[5];this.sampleRenderTarget||(this.sampleRenderTarget=new WebGLRenderTarget(d.width,d.height,this.params),this.sampleRenderTarget.texture.name="TAARenderPass.sample"),this.holdRenderTarget||(this.holdRenderTarget=new WebGLRenderTarget(d.width,d.height,this.params),this.holdRenderTarget.texture.name="TAARenderPass.hold"),this.accumulate&&-1===this.accumulateIndex&&(SSAARenderPass.prototype.render.call(this,e,this.holdRenderTarget,d,v),this.accumulateIndex=0);var C=e.autoClear;e.autoClear=!1;var w=1/g.length;if(this.accumulateIndex>=0&&this.accumulateIndex<g.length){this.copyUniforms.opacity.value=w,this.copyUniforms.tDiffuse.value=a.texture;for(var _=Math.pow(2,this.sampleLevel),x=0;x<_;x++){var A=g[this.accumulateIndex];if(this.camera.setViewOffset&&this.camera.setViewOffset(d.width,d.height,.0625*A[0],.0625*A[1],d.width,d.height),e.setRenderTarget(a),e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(this.sampleRenderTarget),0===this.accumulateIndex&&e.clear(),this.fsQuad.render(e),this.accumulateIndex++,this.accumulateIndex>=g.length)break}this.camera.clearViewOffset&&this.camera.clearViewOffset()}var E=this.accumulateIndex*w;E>0&&(this.copyUniforms.opacity.value=1,this.copyUniforms.tDiffuse.value=this.sampleRenderTarget.texture,e.setRenderTarget(a),e.clear(),this.fsQuad.render(e)),E<1&&(this.copyUniforms.opacity.value=1-E,this.copyUniforms.tDiffuse.value=this.holdRenderTarget.texture,e.setRenderTarget(a),0===E&&e.clear(),this.fsQuad.render(e)),e.autoClear=C}});var TexturePass=function(e,a){Pass.call(this),void 0===CopyShader&&console.error("TexturePass relies on CopyShader");var d=CopyShader;this.map=e,this.opacity=void 0!==a?a:1,this.uniforms=UniformsUtils.clone(d.uniforms),this.material=new ShaderMaterial({uniforms:this.uniforms,vertexShader:d.vertexShader,fragmentShader:d.fragmentShader,depthTest:!1,depthWrite:!1}),this.needsSwap=!1,this.fsQuad=new Pass.FullScreenQuad(null)};TexturePass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:TexturePass,render:function(e,a,d){var v=e.autoClear;e.autoClear=!1,this.fsQuad.material=this.material,this.uniforms.opacity.value=this.opacity,this.uniforms.tDiffuse.value=this.map,this.material.transparent=this.opacity<1,e.setRenderTarget(this.renderToScreen?null:d),this.clear&&e.clear(),this.fsQuad.render(e),e.autoClear=v}});var LuminosityHighPassShader={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new Color(0)},defaultOpacity:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec3 defaultColor;","uniform float defaultOpacity;","uniform float luminosityThreshold;","uniform float smoothWidth;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tvec3 luma = vec3( 0.299, 0.587, 0.114 );","\tfloat v = dot( texel.xyz, luma );","\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );","\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );","\tgl_FragColor = mix( outputColor, texel, alpha );","}"].join("\n")},UnrealBloomPass=function(e,a,d,v){Pass.call(this),this.strength=void 0!==a?a:1,this.radius=d,this.threshold=v,this.resolution=void 0!==e?new Vector2(e.x,e.y):new Vector2(256,256),this.clearColor=new Color(0,0,0);var g={minFilter:LinearFilter,magFilter:LinearFilter,format:RGBAFormat};this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;var C=Math.round(this.resolution.x/2),w=Math.round(this.resolution.y/2);this.renderTargetBright=new WebGLRenderTarget(C,w,g),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(var _=0;_<this.nMips;_++){var x=new WebGLRenderTarget(C,w,g);x.texture.name="UnrealBloomPass.h"+_,x.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(x);var b=new WebGLRenderTarget(C,w,g);b.texture.name="UnrealBloomPass.v"+_,b.texture.generateMipmaps=!1,this.renderTargetsVertical.push(b),C=Math.round(C/2),w=Math.round(w/2)}void 0===LuminosityHighPassShader&&console.error("UnrealBloomPass relies on LuminosityHighPassShader");var A=LuminosityHighPassShader;this.highPassUniforms=UniformsUtils.clone(A.uniforms),this.highPassUniforms.luminosityThreshold.value=v,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new ShaderMaterial({uniforms:this.highPassUniforms,vertexShader:A.vertexShader,fragmentShader:A.fragmentShader,defines:{}}),this.separableBlurMaterials=[];var E=[3,5,7,9,11];for(C=Math.round(this.resolution.x/2),w=Math.round(this.resolution.y/2),_=0;_<this.nMips;_++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(E[_])),this.separableBlurMaterials[_].uniforms.texSize.value=new Vector2(C,w),C=Math.round(C/2),w=Math.round(w/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=a,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0,this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new Vector3(1,1,1),new Vector3(1,1,1),new Vector3(1,1,1),new Vector3(1,1,1),new Vector3(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,void 0===CopyShader&&console.error("UnrealBloomPass relies on CopyShader");var O=CopyShader;this.copyUniforms=UniformsUtils.clone(O.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new ShaderMaterial({uniforms:this.copyUniforms,vertexShader:O.vertexShader,fragmentShader:O.fragmentShader,blending:AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this.oldClearColor=new Color,this.oldClearAlpha=1,this.basic=new MeshBasicMaterial,this.fsQuad=new Pass.FullScreenQuad(null)};UnrealBloomPass.prototype=Object.assign(Object.create(Pass.prototype),{constructor:UnrealBloomPass,dispose:function(){for(var e=0;e<this.renderTargetsHorizontal.length;e++)this.renderTargetsHorizontal[e].dispose();for(e=0;e<this.renderTargetsVertical.length;e++)this.renderTargetsVertical[e].dispose();this.renderTargetBright.dispose()},setSize:function(e,a){var d=Math.round(e/2),v=Math.round(a/2);this.renderTargetBright.setSize(d,v);for(var g=0;g<this.nMips;g++)this.renderTargetsHorizontal[g].setSize(d,v),this.renderTargetsVertical[g].setSize(d,v),this.separableBlurMaterials[g].uniforms.texSize.value=new Vector2(d,v),d=Math.round(d/2),v=Math.round(v/2)},render:function(e,a,d,v,g){this.oldClearColor.copy(e.getClearColor()),this.oldClearAlpha=e.getClearAlpha();var C=e.autoClear;e.autoClear=!1,e.setClearColor(this.clearColor,0),g&&e.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=d.texture,e.setRenderTarget(null),e.clear(),this.fsQuad.render(e)),this.highPassUniforms.tDiffuse.value=d.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,e.setRenderTarget(this.renderTargetBright),e.clear(),this.fsQuad.render(e);for(var w=this.renderTargetBright,_=0;_<this.nMips;_++)this.fsQuad.material=this.separableBlurMaterials[_],this.separableBlurMaterials[_].uniforms.colorTexture.value=w.texture,this.separableBlurMaterials[_].uniforms.direction.value=UnrealBloomPass.BlurDirectionX,e.setRenderTarget(this.renderTargetsHorizontal[_]),e.clear(),this.fsQuad.render(e),this.separableBlurMaterials[_].uniforms.colorTexture.value=this.renderTargetsHorizontal[_].texture,this.separableBlurMaterials[_].uniforms.direction.value=UnrealBloomPass.BlurDirectionY,e.setRenderTarget(this.renderTargetsVertical[_]),e.clear(),this.fsQuad.render(e),w=this.renderTargetsVertical[_];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,e.setRenderTarget(this.renderTargetsHorizontal[0]),e.clear(),this.fsQuad.render(e),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,g&&e.state.buffers.stencil.setTest(!0),this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(d),this.fsQuad.render(e)),e.setClearColor(this.oldClearColor,this.oldClearAlpha),e.autoClear=C},getSeperableBlurMaterial:function(e){return new ShaderMaterial({defines:{KERNEL_RADIUS:e,SIGMA:e},uniforms:{colorTexture:{value:null},texSize:{value:new Vector2(.5,.5)},direction:{value:new Vector2(.5,.5)}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform sampler2D colorTexture;\n\t\t\t\tuniform vec2 texSize;\t\t\t\tuniform vec2 direction;\t\t\t\t\t\t\t\tfloat gaussianPdf(in float x, in float sigma) {\t\t\t\t\treturn 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;\t\t\t\t}\t\t\t\tvoid main() {\n\t\t\t\t\tvec2 invSize = 1.0 / texSize;\t\t\t\t\tfloat fSigma = float(SIGMA);\t\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\t\t\t\t\tvec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;\t\t\t\t\tfor( int i = 1; i < KERNEL_RADIUS; i ++ ) {\t\t\t\t\t\tfloat x = float(i);\t\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\t\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\t\t\t\t\t\tvec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;\t\t\t\t\t\tvec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;\t\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\t\t\t\t\t\tweightSum += 2.0 * w;\t\t\t\t\t}\t\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t\t}"})},getCompositeMaterial:function(e){return new ShaderMaterial({defines:{NUM_MIPS:e},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"varying vec2 vUv;\t\t\t\tuniform sampler2D blurTexture1;\t\t\t\tuniform sampler2D blurTexture2;\t\t\t\tuniform sampler2D blurTexture3;\t\t\t\tuniform sampler2D blurTexture4;\t\t\t\tuniform sampler2D blurTexture5;\t\t\t\tuniform sampler2D dirtTexture;\t\t\t\tuniform float bloomStrength;\t\t\t\tuniform float bloomRadius;\t\t\t\tuniform float bloomFactors[NUM_MIPS];\t\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\t\t\t\t\t\t\t\tfloat lerpBloomFactor(const in float factor) { \t\t\t\t\tfloat mirrorFactor = 1.2 - factor;\t\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\t\t\t\t}\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\tgl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) + \t\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );\t\t\t\t}"})}}),UnrealBloomPass.BlurDirectionX=new Vector2(1,0),UnrealBloomPass.BlurDirectionY=new Vector2(0,1);var CSS2DObject=function(e){Object3D.call(this),this.element=e,this.element.style.position="absolute",this.addEventListener("removed",function(){this.traverse(function(a){a.element instanceof Element&&null!==a.element.parentNode&&a.element.parentNode.removeChild(a.element)})})};CSS2DObject.prototype=Object.create(Object3D.prototype),CSS2DObject.prototype.constructor=CSS2DObject;var CSS2DRenderer=function(){var a,d,v,g,e=this,C=new Vector3,w=new Matrix4,_=new Matrix4,x={objects:new WeakMap},b=document.createElement("div");b.style.overflow="hidden",this.domElement=b,this.getSize=function(){return{width:a,height:d}},this.setSize=function(D,F){v=(a=D)/2,g=(d=F)/2,b.style.width=D+"px",b.style.height=F+"px"};var D,F,A=function D(F,L,I){if(F instanceof CSS2DObject){F.onBeforeRender(e,L,I),C.setFromMatrixPosition(F.matrixWorld),C.applyMatrix4(_);var V=F.element,z="translate(-50%,-50%) translate("+(C.x*v+v)+"px,"+(-C.y*g+g)+"px)";V.style.WebkitTransform=z,V.style.MozTransform=z,V.style.oTransform=z,V.style.transform=z,V.style.display=F.visible&&C.z>=-1&&C.z<=1?"":"none";var H={distanceToCameraSquared:E(I,F)};x.objects.set(F,H),V.parentNode!==b&&b.appendChild(V),F.onAfterRender(e,L,I)}for(var X=0,re=F.children.length;X<re;X++)D(F.children[X],L,I)},E=(D=new Vector3,F=new Vector3,function(L,I){return D.setFromMatrixPosition(L.matrixWorld),F.setFromMatrixPosition(I.matrixWorld),D.distanceToSquared(F)});this.render=function(D,F){!0===D.autoUpdate&&D.updateMatrixWorld(),null===F.parent&&F.updateMatrixWorld(),w.copy(F.matrixWorldInverse),_.multiplyMatrices(F.projectionMatrix,w),A(D,D,F),function(F){for(var L=function(F){var L=[];return F.traverse(function(I){I instanceof CSS2DObject&&L.push(I)}),L}(F).sort(function(H,X){return x.objects.get(H).distanceToCameraSquared-x.objects.get(X).distanceToCameraSquared}),I=L.length,V=0,z=L.length;V<z;V++)L[V].element.style.zIndex=I-V}(D)}},CSS3DObject=function(e){Object3D.call(this),this.element=e,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.addEventListener("removed",function(){this.traverse(function(a){a.element instanceof Element&&null!==a.element.parentNode&&a.element.parentNode.removeChild(a.element)})})};CSS3DObject.prototype=Object.create(Object3D.prototype),CSS3DObject.prototype.constructor=CSS3DObject;var CSS3DSprite=function(e){CSS3DObject.call(this,e)};CSS3DSprite.prototype=Object.create(CSS3DObject.prototype),CSS3DSprite.prototype.constructor=CSS3DSprite;var CSS3DRenderer=function(){var a,d,v,g,e=this,C=new Matrix4,w={camera:{fov:0,style:""},objects:new WeakMap},_=document.createElement("div");_.style.overflow="hidden",this.domElement=_;var x=document.createElement("div");x.style.WebkitTransformStyle="preserve-3d",x.style.transformStyle="preserve-3d",x.style.pointerEvents="none",_.appendChild(x);var b=/Trident/i.test(navigator.userAgent);function A(I){return Math.abs(I)<1e-10?0:I}function E(I){var V=I.elements;return"matrix3d("+A(V[0])+","+A(-V[1])+","+A(V[2])+","+A(V[3])+","+A(V[4])+","+A(-V[5])+","+A(V[6])+","+A(V[7])+","+A(V[8])+","+A(-V[9])+","+A(V[10])+","+A(V[11])+","+A(V[12])+","+A(-V[13])+","+A(V[14])+","+A(V[15])+")"}function R(I,V){var z=I.elements,H="matrix3d("+A(z[0])+","+A(z[1])+","+A(z[2])+","+A(z[3])+","+A(-z[4])+","+A(-z[5])+","+A(-z[6])+","+A(-z[7])+","+A(z[8])+","+A(z[9])+","+A(z[10])+","+A(z[11])+","+A(z[12])+","+A(z[13])+","+A(z[14])+","+A(z[15])+")";return b?"translate(-50%,-50%)translate("+v+"px,"+g+"px)"+V+H:"translate(-50%,-50%)"+H}function O(I,V,z,H){if(I instanceof CSS3DObject){var X;I.onBeforeRender(e,V,z),I instanceof CSS3DSprite?(C.copy(z.matrixWorldInverse),C.transpose(),C.copyPosition(I.matrixWorld),C.scale(I.scale),C.elements[3]=0,C.elements[7]=0,C.elements[11]=0,C.elements[15]=1,X=R(C,H)):X=R(I.matrixWorld,H);var re=I.element,j=w.objects.get(I);if(void 0===j||j.style!==X){re.style.WebkitTransform=X,re.style.transform=X;var te={style:X};b&&(te.distanceToCameraSquared=D(z,I)),w.objects.set(I,te)}re.parentNode!==x&&x.appendChild(re),I.onAfterRender(e,V,z)}for(var J=0,k=I.children.length;J<k;J++)O(I.children[J],V,z,H)}this.getSize=function(){return{width:a,height:d}},this.setSize=function(I,V){v=(a=I)/2,g=(d=V)/2,_.style.width=I+"px",_.style.height=V+"px",x.style.width=I+"px",x.style.height=V+"px"};var I,V,D=(I=new Vector3,V=new Vector3,function(z,H){return I.setFromMatrixPosition(z.matrixWorld),V.setFromMatrixPosition(H.matrixWorld),I.distanceToSquared(V)});this.render=function(I,V){var z=V.projectionMatrix.elements[5]*g;if(w.camera.fov!==z&&(V.isPerspectiveCamera?(_.style.WebkitPerspective=z+"px",_.style.perspective=z+"px"):(_.style.WebkitPerspective="",_.style.perspective=""),w.camera.fov=z),!0===I.autoUpdate&&I.updateMatrixWorld(),null===V.parent&&V.updateMatrixWorld(),V.isOrthographicCamera)var H=-(V.right+V.left)/2,X=(V.top+V.bottom)/2;var re=V.isOrthographicCamera?"scale("+z+")translate("+A(H)+"px,"+A(X)+"px)"+E(V.matrixWorldInverse):"translateZ("+z+"px)"+E(V.matrixWorldInverse),j=re+"translate("+v+"px,"+g+"px)";w.camera.style!==j&&!b&&(x.style.WebkitTransform=j,x.style.transform=j,w.camera.style=j),O(I,I,V,re),b&&function(I){for(var V=function(I){var V=[];return I.traverse(function(z){z instanceof CSS3DObject&&V.push(z)}),V}(I).sort(function(re,j){return w.objects.get(re).distanceToCameraSquared-w.objects.get(j).distanceToCameraSquared}),z=V.length,H=0,X=V.length;H<X;H++)V[H].element.style.zIndex=z-H}(I)}},_geometry,_intersectPoint=new Vector3,_worldScale=new Vector3,_mvPosition=new Vector3,_alignedPosition=new Vector2,_rotatedPosition=new Vector2,_viewWorldMatrix=new Matrix4,_vA$1=new Vector3,_vB$1=new Vector3,_vC$1=new Vector3,_uvA$1=new Vector2,_uvB$1=new Vector2,_uvC$1=new Vector2;function Sprite(s){if(Object3D.call(this),this.type="Sprite",void 0===_geometry){_geometry=new BufferGeometry;var a=new InterleavedBuffer(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);_geometry.setIndex([0,1,2,0,2,3]),_geometry.setAttribute("position",new InterleavedBufferAttribute(a,3,0,!1)),_geometry.setAttribute("uv",new InterleavedBufferAttribute(a,2,3,!1))}this.geometry=_geometry,this.material=void 0!==s?s:new SpriteMaterial,this.center=new Vector2(.5,.5)}function transformVertex(s,e,a,d,v,g){_alignedPosition.subVectors(s,a).addScalar(.5).multiply(d),void 0!==v?(_rotatedPosition.x=g*_alignedPosition.x-v*_alignedPosition.y,_rotatedPosition.y=v*_alignedPosition.x+g*_alignedPosition.y):_rotatedPosition.copy(_alignedPosition),s.copy(e),s.x+=_rotatedPosition.x,s.y+=_rotatedPosition.y,s.applyMatrix4(_viewWorldMatrix)}Sprite.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Sprite,isSprite:!0,raycast:function(e,a){null===e.camera&&console.error('Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),_worldScale.setFromMatrixScale(this.matrixWorld),_viewWorldMatrix.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),_mvPosition.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&_worldScale.multiplyScalar(-_mvPosition.z);var v,g,d=this.material.rotation;0!==d&&(g=Math.cos(d),v=Math.sin(d));var C=this.center;transformVertex(_vA$1.set(-.5,-.5,0),_mvPosition,C,_worldScale,v,g),transformVertex(_vB$1.set(.5,-.5,0),_mvPosition,C,_worldScale,v,g),transformVertex(_vC$1.set(.5,.5,0),_mvPosition,C,_worldScale,v,g),_uvA$1.set(0,0),_uvB$1.set(1,0),_uvC$1.set(1,1);var w=e.ray.intersectTriangle(_vA$1,_vB$1,_vC$1,!1,_intersectPoint);if(null!==w||(transformVertex(_vB$1.set(-.5,.5,0),_mvPosition,C,_worldScale,v,g),_uvB$1.set(0,1),null!==(w=e.ray.intersectTriangle(_vA$1,_vC$1,_vB$1,!1,_intersectPoint)))){var _=e.ray.origin.distanceTo(_intersectPoint);_<e.near||_>e.far||a.push({distance:_,point:_intersectPoint.clone(),uv:Triangle.getUV(_intersectPoint,_vA$1,_vB$1,_vC$1,_uvA$1,_uvB$1,_uvC$1,new Vector2),face:null,object:this})}},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return Object3D.prototype.copy.call(this,e),void 0!==e.center&&this.center.copy(e.center),this}});var RenderableObject=function(){this.id=0,this.object=null,this.z=0,this.renderOrder=0},RenderableFace=function(){this.id=0,this.v1=new RenderableVertex,this.v2=new RenderableVertex,this.v3=new RenderableVertex,this.normalModel=new Vector3,this.vertexNormalsModel=[new Vector3,new Vector3,new Vector3],this.vertexNormalsLength=0,this.color=new Color,this.material=null,this.uvs=[new Vector2,new Vector2,new Vector2],this.z=0,this.renderOrder=0},RenderableVertex=function(){this.position=new Vector3,this.positionWorld=new Vector3,this.positionScreen=new Vector4,this.visible=!0};RenderableVertex.prototype.copy=function(s){this.positionWorld.copy(s.positionWorld),this.positionScreen.copy(s.positionScreen)};var RenderableLine=function(){this.id=0,this.v1=new RenderableVertex,this.v2=new RenderableVertex,this.vertexColors=[new Color,new Color],this.material=null,this.z=0,this.renderOrder=0},RenderableSprite=function(){this.id=0,this.object=null,this.x=0,this.y=0,this.z=0,this.rotation=0,this.scale=new Vector2,this.material=null,this.renderOrder=0},Projector=function(){var e,a,g,C,x,b,R,O,L,I,K,d=[],v=0,w=[],_=0,A=[],E=0,D=[],F=0,V=[],z=0,H={objects:[],lights:[],elements:[]},X=new Vector3,re=new Vector4,j=new Box3(new Vector3(-1,-1,-1),new Vector3(1,1,1)),te=new Box3,J=new Array(3),k=new Matrix4,U=new Matrix4,ee=new Matrix4,Q=new Matrix3,oe=new Frustum,me=new Vector4,fe=new Vector4;this.projectVector=function(ce,Te){console.warn("Projector: .projectVector() is now vector.project()."),ce.project(Te)},this.unprojectVector=function(ce,Te){console.warn("Projector: .unprojectVector() is now vector.unproject()."),ce.unproject(Te)},this.pickingRay=function(){console.error("Projector: .pickingRay() is now raycaster.setFromCamera().")};var $=new function(){var Te=[],be=[],xe=[],we=null,Ne=new Matrix3;function De(ot){var ft=ot.positionWorld,He=ot.positionScreen;ft.copy(ot.position).applyMatrix4(K),He.copy(ft).applyMatrix4(U);var gt=1/He.w;He.x*=gt,He.y*=gt,He.z*=gt,ot.visible=He.x>=-1&&He.x<=1&&He.y>=-1&&He.y<=1&&He.z>=-1&&He.z<=1}function at(ot,St,ft){return!0===ot.visible||!0===St.visible||!0===ft.visible||(J[0]=ot.positionScreen,J[1]=St.positionScreen,J[2]=ft.positionScreen,j.intersectsBox(te.setFromPoints(J)))}function Xe(ot,St,ft){return(ft.positionScreen.x-ot.positionScreen.x)*(St.positionScreen.y-ot.positionScreen.y)-(ft.positionScreen.y-ot.positionScreen.y)*(St.positionScreen.x-ot.positionScreen.x)<0}return{setObject:function(ot){Ne.getNormalMatrix((we=ot).matrixWorld),Te.length=0,be.length=0,xe.length=0},projectVertex:De,checkTriangleVisibility:at,checkBackfaceCulling:Xe,pushVertex:function(ot,St,ft){(g=ve()).position.set(ot,St,ft),De(g)},pushNormal:function(ot,St,ft){Te.push(ot,St,ft)},pushColor:function(ot,St,ft){be.push(ot,St,ft)},pushUv:function(ot,St){xe.push(ot,St)},pushLine:function(ot,St){var ft=w[ot],He=w[St];ft.positionScreen.copy(ft.position).applyMatrix4(ee),He.positionScreen.copy(He.position).applyMatrix4(ee),!0===he(ft.positionScreen,He.positionScreen)&&(ft.positionScreen.multiplyScalar(1/ft.positionScreen.w),He.positionScreen.multiplyScalar(1/He.positionScreen.w),(R=_e()).id=we.id,R.v1.copy(ft),R.v2.copy(He),R.z=Math.max(ft.positionScreen.z,He.positionScreen.z),R.renderOrder=we.renderOrder,R.material=we.material,we.material.vertexColors===VertexColors&&(R.vertexColors[0].fromArray(be,3*ot),R.vertexColors[1].fromArray(be,3*St)),H.elements.push(R))},pushTriangle:function(ot,St,ft,He){var gt=arguments,vt=w[ot],Gt=w[St],Lt=w[ft];if(!1!==at(vt,Gt,Lt)&&(He.side===DoubleSide||!0===Xe(vt,Gt,Lt))){(x=le()).id=we.id,x.v1.copy(vt),x.v2.copy(Gt),x.v3.copy(Lt),x.z=(vt.positionScreen.z+Gt.positionScreen.z+Lt.positionScreen.z)/3,x.renderOrder=we.renderOrder,X.subVectors(Lt.position,Gt.position),re.subVectors(vt.position,Gt.position),X.cross(re),x.normalModel.copy(X),x.normalModel.applyMatrix3(Ne).normalize();for(var yt=0;yt<3;yt++){var xr=x.vertexNormalsModel[yt];xr.fromArray(Te,3*gt[yt]),xr.applyMatrix3(Ne).normalize();var Dr=x.uvs[yt];Dr.fromArray(xe,2*gt[yt])}x.vertexNormalsLength=3,x.material=He,(He.vertexColors===FaceColors||He.vertexColors===VertexColors)&&x.color.fromArray(be,3*ot),H.elements.push(x)}}}};function ue(ce){if(!1!==ce.visible){if(ce instanceof Light)H.lights.push(ce);else if(ce instanceof Mesh||ce instanceof Line||ce instanceof Points){if(!1===ce.material.visible||!0===ce.frustumCulled&&!1===oe.intersectsObject(ce))return;Y(ce)}else if(ce instanceof Sprite){if(!1===ce.material.visible||!0===ce.frustumCulled&&!1===oe.intersectsSprite(ce))return;Y(ce)}for(var Te=ce.children,be=0,xe=Te.length;be<xe;be++)ue(Te[be])}}function Y(ce){e=function(){if(a===v){var ce=new RenderableObject;return d.push(ce),v++,a++,ce}return d[a++]}(),e.id=ce.id,e.object=ce,X.setFromMatrixPosition(ce.matrixWorld),X.applyMatrix4(U),e.z=X.z,e.renderOrder=ce.renderOrder,H.objects.push(e)}function Z(ce,Te,be){var xe=1/ce.w;ce.z*=xe,ce.z>=-1&&ce.z<=1&&(L=function(){if(I===z){var ce=new RenderableSprite;return V.push(ce),z++,I++,ce}return V[I++]}(),L.id=Te.id,L.x=ce.x*xe,L.y=ce.y*xe,L.z=ce.z,L.renderOrder=Te.renderOrder,L.object=Te,L.rotation=Te.rotation,L.scale.x=Te.scale.x*Math.abs(L.x-(ce.x+be.projectionMatrix.elements[0])/(ce.w+be.projectionMatrix.elements[12])),L.scale.y=Te.scale.y*Math.abs(L.y-(ce.y+be.projectionMatrix.elements[5])/(ce.w+be.projectionMatrix.elements[13])),L.material=Te.material,H.elements.push(L))}function ve(){if(C===_){var ce=new RenderableVertex;return w.push(ce),_++,C++,ce}return w[C++]}function le(){if(b===E){var ce=new RenderableFace;return A.push(ce),E++,b++,ce}return A[b++]}function _e(){if(O===F){var ce=new RenderableLine;return D.push(ce),F++,O++,ce}return D[O++]}function pe(ce,Te){return ce.renderOrder!==Te.renderOrder?ce.renderOrder-Te.renderOrder:ce.z!==Te.z?Te.z-ce.z:ce.id!==Te.id?ce.id-Te.id:0}function he(ce,Te){var be=0,xe=1,we=ce.z+ce.w,Ne=Te.z+Te.w,Re=-ce.z+ce.w,De=-Te.z+Te.w;return we>=0&&Ne>=0&&Re>=0&&De>=0||!(we<0&&Ne<0||Re<0&&De<0)&&(we<0?be=Math.max(be,we/(we-Ne)):Ne<0&&(xe=Math.min(xe,we/(we-Ne))),Re<0?be=Math.max(be,Re/(Re-De)):De<0&&(xe=Math.min(xe,Re/(Re-De))),!(xe<be||(ce.lerp(Te,be),Te.lerp(ce,1-xe),0)))}this.projectScene=function(ce,Te,be,xe){b=0,O=0,I=0,H.elements.length=0,!0===ce.autoUpdate&&ce.updateMatrixWorld(),null===Te.parent&&Te.updateMatrixWorld(),k.copy(Te.matrixWorldInverse),U.multiplyMatrices(Te.projectionMatrix,k),oe.setFromProjectionMatrix(U),a=0,H.objects.length=0,H.lights.length=0,ue(ce),!0===be&&H.objects.sort(pe);for(var we=H.objects,Ne=0,Re=we.length;Ne<Re;Ne++){var De=we[Ne].object,Je=De.geometry;if($.setObject(De),K=De.matrixWorld,C=0,De instanceof Mesh){if(Je instanceof BufferGeometry){var $e=De.material,pt=Array.isArray($e),at=Je.groups;if(void 0===(ut=Je.attributes).position)continue;for(var Ke=0,lt=(Xe=ut.position.array).length;Ke<lt;Ke+=3){var ot=Xe[Ke],St=Xe[Ke+1],ft=Xe[Ke+2];if(!0===$e.morphTargets)for(var gt=Je.morphTargetsRelative,vt=De.morphTargetInfluences,Gt=0,Lt=(He=Je.morphAttributes.position).length;Gt<Lt;Gt++)if(0!==(yt=vt[Gt])){var xr=He[Gt];gt?(ot+=xr.getX(Ke/3)*yt,St+=xr.getY(Ke/3)*yt,ft+=xr.getZ(Ke/3)*yt):(ot+=(xr.getX(Ke/3)-Xe[Ke])*yt,St+=(xr.getY(Ke/3)-Xe[Ke+1])*yt,ft+=(xr.getZ(Ke/3)-Xe[Ke+2])*yt)}$.pushVertex(ot,St,ft)}if(void 0!==ut.normal){var Dr=ut.normal.array;for(Ke=0,lt=Dr.length;Ke<lt;Ke+=3)$.pushNormal(Dr[Ke],Dr[Ke+1],Dr[Ke+2])}if(void 0!==ut.color)for(Ke=0,lt=(Ur=ut.color.array).length;Ke<lt;Ke+=3)$.pushColor(Ur[Ke],Ur[Ke+1],Ur[Ke+2]);if(void 0!==ut.uv){var qr=ut.uv.array;for(Ke=0,lt=qr.length;Ke<lt;Ke+=2)$.pushUv(qr[Ke],qr[Ke+1])}if(null!==Je.index){var Ar=Je.index.array;if(at.length>0)for(var hn=0;hn<at.length;hn++){var Sn=at[hn];if(void 0!==($e=!0===pt?De.material[Sn.materialIndex]:De.material))for(Ke=Sn.start,lt=Sn.start+Sn.count;Ke<lt;Ke+=3)$.pushTriangle(Ar[Ke],Ar[Ke+1],Ar[Ke+2],$e)}else for(Ke=0,lt=Ar.length;Ke<lt;Ke+=3)$.pushTriangle(Ar[Ke],Ar[Ke+1],Ar[Ke+2],$e)}else if(at.length>0){for(hn=0;hn<at.length;hn++)if(Sn=at[hn],void 0!==($e=!0===pt?De.material[Sn.materialIndex]:De.material))for(Ke=Sn.start,lt=Sn.start+Sn.count;Ke<lt;Ke+=3)$.pushTriangle(Ke,Ke+1,Ke+2,$e)}else for(Ke=0,lt=Xe.length/3;Ke<lt;Ke+=3)$.pushTriangle(Ke,Ke+1,Ke+2,$e)}else if(Je instanceof Geometry){var Sr=Je.vertices,An=Je.faces,jr=Je.faceVertexUvs[0];Q.getNormalMatrix(K),$e=De.material,pt=Array.isArray($e);for(var cn=0,Fn=Sr.length;cn<Fn;cn++){var He;if(X.copy(yi=Sr[cn]),!0===$e.morphTargets)for(vt=De.morphTargetInfluences,Gt=0,Lt=(He=Je.morphTargets).length;Gt<Lt;Gt++){var yt;if(0!==(yt=vt[Gt])){var wo=(xr=He[Gt]).vertices[cn];X.x+=(wo.x-yi.x)*yt,X.y+=(wo.y-yi.y)*yt,X.z+=(wo.z-yi.z)*yt}}$.pushVertex(X.x,X.y,X.z)}for(var ro=0,zt=An.length;ro<zt;ro++){var Ln=An[ro];if(void 0!==($e=!0===pt?De.material[Ln.materialIndex]:De.material)){var Kt=$e.side,Ee=w[Ln.a],Nr=w[Ln.b],Kn=w[Ln.c];if(!1!==$.checkTriangleVisibility(Ee,Nr,Kn)){var Dn=$.checkBackfaceCulling(Ee,Nr,Kn);if(Kt===DoubleSide||!(Kt===FrontSide&&!1===Dn||Kt===BackSide&&!0===Dn)){(x=le()).id=De.id,x.v1.copy(Ee),x.v2.copy(Nr),x.v3.copy(Kn),x.normalModel.copy(Ln.normal),!1===Dn&&(Kt===BackSide||Kt===DoubleSide)&&x.normalModel.negate(),x.normalModel.applyMatrix3(Q).normalize();for(var Ni=Ln.vertexNormals,Wn=0,Ci=Math.min(Ni.length,3);Wn<Ci;Wn++){var Zn=x.vertexNormalsModel[Wn];Zn.copy(Ni[Wn]),!1===Dn&&(Kt===BackSide||Kt===DoubleSide)&&Zn.negate(),Zn.applyMatrix3(Q).normalize()}x.vertexNormalsLength=Ni.length;var W=jr[ro];if(void 0!==W)for(var ne=0;ne<3;ne++)x.uvs[ne].copy(W[ne]);x.color=Ln.color,x.material=$e,x.z=(Ee.positionScreen.z+Nr.positionScreen.z+Kn.positionScreen.z)/3,x.renderOrder=De.renderOrder,H.elements.push(x)}}}}}}else if(De instanceof Line){if(ee.multiplyMatrices(U,K),Je instanceof BufferGeometry){if(void 0!==(ut=Je.attributes).position){for(Ke=0,lt=(Xe=ut.position.array).length;Ke<lt;Ke+=3)$.pushVertex(Xe[Ke],Xe[Ke+1],Xe[Ke+2]);var Ur;if(void 0!==ut.color)for(Ke=0,lt=(Ur=ut.color.array).length;Ke<lt;Ke+=3)$.pushColor(Ur[Ke],Ur[Ke+1],Ur[Ke+2]);if(null!==Je.index)for(Ke=0,lt=(Ar=Je.index.array).length;Ke<lt;Ke+=2)$.pushLine(Ar[Ke],Ar[Ke+1]);else{var Ie=De instanceof LineSegments?2:1;for(Ke=0,lt=Xe.length/3-1;Ke<lt;Ke+=Ie)$.pushLine(Ke,Ke+1)}}}else if(Je instanceof Geometry){if(0===(Sr=De.geometry.vertices).length)continue;for((Ee=ve()).positionScreen.copy(Sr[0]).applyMatrix4(ee),Ie=De instanceof LineSegments?2:1,cn=1,Fn=Sr.length;cn<Fn;cn++)(Ee=ve()).positionScreen.copy(Sr[cn]).applyMatrix4(ee),!((cn+1)%Ie>0)&&(Nr=w[C-2],me.copy(Ee.positionScreen),fe.copy(Nr.positionScreen),!0===he(me,fe)&&(me.multiplyScalar(1/me.w),fe.multiplyScalar(1/fe.w),(R=_e()).id=De.id,R.v1.positionScreen.copy(me),R.v2.positionScreen.copy(fe),R.z=Math.max(me.z,fe.z),R.renderOrder=De.renderOrder,R.material=De.material,De.material.vertexColors===VertexColors&&(R.vertexColors[0].copy(De.geometry.colors[cn]),R.vertexColors[1].copy(De.geometry.colors[cn-1])),H.elements.push(R)))}}else if(De instanceof Points){if(ee.multiplyMatrices(U,K),Je instanceof Geometry)for(cn=0,Fn=(Sr=De.geometry.vertices).length;cn<Fn;cn++){var yi;re.set((yi=Sr[cn]).x,yi.y,yi.z,1),re.applyMatrix4(ee),Z(re,De,Te)}else if(Je instanceof BufferGeometry){var ut,Xe;if(void 0!==(ut=Je.attributes).position)for(Ke=0,lt=(Xe=ut.position.array).length;Ke<lt;Ke+=3)re.set(Xe[Ke],Xe[Ke+1],Xe[Ke+2],1),re.applyMatrix4(ee),Z(re,De,Te)}}else De instanceof Sprite&&(De.modelViewMatrix.multiplyMatrices(Te.matrixWorldInverse,De.matrixWorld),re.set(K.elements[12],K.elements[13],K.elements[14],1),re.applyMatrix4(U),Z(re,De,Te))}return!0===xe&&H.elements.sort(pe),H}},SVGObject=function(e){Object3D.call(this),this.node=e};SVGObject.prototype=Object.create(Object3D.prototype),SVGObject.prototype.constructor=SVGObject;var SVGRenderer=function(){var a,d,v,w,_,x,b,A,E,R,K,Q,oe,e=this,g=new Projector,C=document.createElementNS("http://www.w3.org/2000/svg","svg"),O=new Box2,D=new Box2,F=new Color,L=new Color,I=new Color,V=new Color,z=new Color,H=new Color,X=new Vector3,re=new Vector3,j=new Vector3,te=new Matrix3,J=new Matrix4,k=new Matrix4,U=[],ee=0,me=1,fe=null;function ge(){for(ee=0;C.childNodes.length>0;)C.removeChild(C.childNodes[0])}function $(he){return null!==fe?he.toFixed(fe):he}function Z(he,ce,Te){var be=ce.scale.x*x,xe=ce.scale.y*b;Te.isPointsMaterial&&(be*=Te.size,xe*=Te.size);var we="M"+$(he.x-.5*be)+","+$(he.y-.5*xe)+"h"+$(be)+"v"+$(xe)+"h"+$(-be)+"z",Ne="";(Te.isSpriteMaterial||Te.isPointsMaterial)&&(Ne="fill:"+Te.color.getStyle()+";fill-opacity:"+Te.opacity),_e(Ne,we)}function se(he,ce,Te,be){var xe="M"+$(he.positionScreen.x)+","+$(he.positionScreen.y)+"L"+$(ce.positionScreen.x)+","+$(ce.positionScreen.y);if(be.isLineBasicMaterial){var we="fill:none;stroke:"+be.color.getStyle()+";stroke-opacity:"+be.opacity+";stroke-width:"+be.linewidth+";stroke-linecap:"+be.linecap;be.isLineDashedMaterial&&(we=we+";stroke-dasharray:"+be.dashSize+","+be.gapSize),_e(we,xe)}}function ve(he,ce,Te,be,xe){e.info.render.vertices+=3,e.info.render.faces++;var we="M"+$(he.positionScreen.x)+","+$(he.positionScreen.y)+"L"+$(ce.positionScreen.x)+","+$(ce.positionScreen.y)+"L"+$(Te.positionScreen.x)+","+$(Te.positionScreen.y)+"z";xe.isMeshBasicMaterial?(F.copy(xe.color),(xe.vertexColors===FaceColors||xe.vertexColors===VertexColors)&&F.multiply(be.color)):xe.isMeshLambertMaterial||xe.isMeshPhongMaterial||xe.isMeshStandardMaterial?(L.copy(xe.color),(xe.vertexColors===FaceColors||xe.vertexColors===VertexColors)&&L.multiply(be.color),F.copy(I),re.copy(he.positionWorld).add(ce.positionWorld).add(Te.positionWorld).divideScalar(3),function(he,ce,Te,be){for(var xe=0,we=he.length;xe<we;xe++){var Ne=he[xe],Re=Ne.color;if(Ne.isDirectionalLight){var De=X.setFromMatrixPosition(Ne.matrixWorld).normalize();if((Je=Te.dot(De))<=0)continue;be.r+=Re.r*(Je*=Ne.intensity),be.g+=Re.g*Je,be.b+=Re.b*Je}else if(Ne.isPointLight){var Je;if(De=X.setFromMatrixPosition(Ne.matrixWorld),(Je=Te.dot(X.subVectors(De,ce).normalize()))<=0||0==(Je*=0==Ne.distance?1:1-Math.min(ce.distanceTo(De)/Ne.distance,1)))continue;be.r+=Re.r*(Je*=Ne.intensity),be.g+=Re.g*Je,be.b+=Re.b*Je}}}(v,re,be.normalModel,F),F.multiply(L).add(xe.emissive)):xe.isMeshNormalMaterial&&(j.copy(be.normalModel).applyMatrix3(te).normalize(),F.setRGB(j.x,j.y,j.z).multiplyScalar(.5).addScalar(.5)),_e(xe.wireframe?"fill:none;stroke:"+F.getStyle()+";stroke-opacity:"+xe.opacity+";stroke-width:"+xe.wireframeLinewidth+";stroke-linecap:"+xe.wireframeLinecap+";stroke-linejoin:"+xe.wireframeLinejoin:"fill:"+F.getStyle()+";fill-opacity:"+xe.opacity,we)}function le(he,ce,Te){var Ne,be=ce.x-he.x,xe=ce.y-he.y,we=be*be+xe*xe;0!==we&&(xe*=Ne=Te/Math.sqrt(we),ce.x+=be*=Ne,ce.y+=xe,he.x-=be,he.y-=xe)}function _e(he,ce){oe===he?Q+=ce:(ae(),oe=he,Q=ce)}function ae(){var he;Q&&(he=ee++,null==U[he]&&(U[he]=document.createElementNS("http://www.w3.org/2000/svg","path"),0==me&&U[he].setAttribute("shape-rendering","crispEdges")),(K=U[he]).setAttribute("d",Q),K.setAttribute("style",oe),C.appendChild(K)),Q="",oe=""}this.domElement=C,this.autoClear=!0,this.sortObjects=!0,this.sortElements=!0,this.overdraw=.5,this.info={render:{vertices:0,faces:0}},this.setQuality=function(he){switch(he){case"high":me=1;break;case"low":me=0}},this.setClearColor=function(he){H.set(he)},this.setPixelRatio=function(){},this.setSize=function(he,ce){C.setAttribute("viewBox",-(x=(w=he)/2)+" "+-(b=(_=ce)/2)+" "+w+" "+_),C.setAttribute("width",w),C.setAttribute("height",_),O.min.set(-x,-b),O.max.set(x,b)},this.setPrecision=function(he){fe=he},this.clear=function(){ge(),C.style.backgroundColor=H.getStyle()},this.render=function(he,ce){if(ce instanceof Camera){var Te=he.background;Te&&Te.isColor?(ge(),C.style.backgroundColor=Te.getStyle()):!0===this.autoClear&&this.clear(),e.info.render.vertices=0,e.info.render.faces=0,J.copy(ce.matrixWorldInverse),k.multiplyMatrices(ce.projectionMatrix,J),a=g.projectScene(he,ce,this.sortObjects,this.sortElements),d=a.elements,v=a.lights,te.getNormalMatrix(ce.matrixWorldInverse),function(he){I.setRGB(0,0,0),V.setRGB(0,0,0),z.setRGB(0,0,0);for(var ce=0,Te=he.length;ce<Te;ce++){var be=he[ce],xe=be.color;be.isAmbientLight?(I.r+=xe.r,I.g+=xe.g,I.b+=xe.b):be.isDirectionalLight?(V.r+=xe.r,V.g+=xe.g,V.b+=xe.b):be.isPointLight&&(z.r+=xe.r,z.g+=xe.g,z.b+=xe.b)}}(v),Q="",oe="";for(var be=0,xe=d.length;be<xe;be++){var we=d[be],Ne=we.material;if(void 0!==Ne&&0!==Ne.opacity)if(D.makeEmpty(),we instanceof RenderableSprite)(A=we).x*=x,A.y*=-b,Z(A,we,Ne);else if(we instanceof RenderableLine)E=we.v2,(A=we.v1).positionScreen.x*=x,A.positionScreen.y*=-b,E.positionScreen.x*=x,E.positionScreen.y*=-b,D.setFromPoints([A.positionScreen,E.positionScreen]),!0===O.intersectsBox(D)&&se(A,E,0,Ne);else if(we instanceof RenderableFace){if(E=we.v2,R=we.v3,(A=we.v1).positionScreen.z<-1||A.positionScreen.z>1||E.positionScreen.z<-1||E.positionScreen.z>1||R.positionScreen.z<-1||R.positionScreen.z>1)continue;A.positionScreen.x*=x,A.positionScreen.y*=-b,E.positionScreen.x*=x,E.positionScreen.y*=-b,R.positionScreen.x*=x,R.positionScreen.y*=-b,this.overdraw>0&&(le(A.positionScreen,E.positionScreen,this.overdraw),le(E.positionScreen,R.positionScreen,this.overdraw),le(R.positionScreen,A.positionScreen,this.overdraw)),D.setFromPoints([A.positionScreen,E.positionScreen,R.positionScreen]),!0===O.intersectsBox(D)&&ve(A,E,R,we,Ne)}}ae(),he.traverseVisible(function(Re){if(Re instanceof SVGObject){if(X.setFromMatrixPosition(Re.matrixWorld),X.applyMatrix4(k),X.z<-1||X.z>1)return;var $e=Re.node;$e.setAttribute("transform","translate("+X.x*x+","+-X.y*b+")"),C.appendChild($e)}})}else console.error("SVGRenderer.render: camera is not an instance of Camera.")}},BasicShader={uniforms:{},vertexShader:["void main() {","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["void main() {","\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 0.5 );","}"].join("\n")},BleachBypassShader={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 base = texture2D( tDiffuse, vUv );","\tvec3 lumCoeff = vec3( 0.25, 0.65, 0.1 );","\tfloat lum = dot( lumCoeff, base.rgb );","\tvec3 blend = vec3( lum );","\tfloat L = min( 1.0, max( 0.0, 10.0 * ( lum - 0.45 ) ) );","\tvec3 result1 = 2.0 * base.rgb * blend;","\tvec3 result2 = 1.0 - 2.0 * ( 1.0 - blend ) * ( 1.0 - base.rgb );","\tvec3 newColor = mix( result1, result2, L );","\tfloat A2 = opacity * base.a;","\tvec3 mixRGB = A2 * newColor.rgb;","\tmixRGB += ( ( 1.0 - A2 ) * base.rgb );","\tgl_FragColor = vec4( mixRGB, base.a );","}"].join("\n")},BlendShader={uniforms:{tDiffuse1:{value:null},tDiffuse2:{value:null},mixRatio:{value:.5},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform float mixRatio;","uniform sampler2D tDiffuse1;","uniform sampler2D tDiffuse2;","varying vec2 vUv;","void main() {","\tvec4 texel1 = texture2D( tDiffuse1, vUv );","\tvec4 texel2 = texture2D( tDiffuse2, vUv );","\tgl_FragColor = opacity * mix( texel1, texel2, mixRatio );","}"].join("\n")},BrightnessContrastShader={uniforms:{tDiffuse:{value:null},brightness:{value:0},contrast:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float brightness;","uniform float contrast;","varying vec2 vUv;","void main() {","\tgl_FragColor = texture2D( tDiffuse, vUv );","\tgl_FragColor.rgb += brightness;","\tif (contrast > 0.0) {","\t\tgl_FragColor.rgb = (gl_FragColor.rgb - 0.5) / (1.0 - contrast) + 0.5;","\t} else {","\t\tgl_FragColor.rgb = (gl_FragColor.rgb - 0.5) * (1.0 + contrast) + 0.5;","\t}","}"].join("\n")},ColorCorrectionShader={uniforms:{tDiffuse:{value:null},powRGB:{value:new Vector3(2,2,2)},mulRGB:{value:new Vector3(1,1,1)},addRGB:{value:new Vector3(0,0,0)}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec3 powRGB;","uniform vec3 mulRGB;","uniform vec3 addRGB;","varying vec2 vUv;","void main() {","\tgl_FragColor = texture2D( tDiffuse, vUv );","\tgl_FragColor.rgb = mulRGB * pow( ( gl_FragColor.rgb + addRGB ), powRGB );","}"].join("\n")},ColorifyShader={uniforms:{tDiffuse:{value:null},color:{value:new Color(16777215)}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tvec3 luma = vec3( 0.299, 0.587, 0.114 );","\tfloat v = dot( texel.xyz, luma );","\tgl_FragColor = vec4( v * color, texel.w );","}"].join("\n")},DOFMipMapShader={uniforms:{tColor:{value:null},tDepth:{value:null},focus:{value:1},maxblur:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float focus;","uniform float maxblur;","uniform sampler2D tColor;","uniform sampler2D tDepth;","varying vec2 vUv;","void main() {","\tvec4 depth = texture2D( tDepth, vUv );","\tfloat factor = depth.x - focus;","\tvec4 col = texture2D( tColor, vUv, 2.0 * maxblur * abs( focus - depth.x ) );","\tgl_FragColor = col;","\tgl_FragColor.a = 1.0;","}"].join("\n")},FocusShader={uniforms:{tDiffuse:{value:null},screenWidth:{value:1024},screenHeight:{value:1024},sampleDistance:{value:.94},waveFactor:{value:.00125}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float screenWidth;","uniform float screenHeight;","uniform float sampleDistance;","uniform float waveFactor;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 color, org, tmp, add;","\tfloat sample_dist, f;","\tvec2 vin;","\tvec2 uv = vUv;","\tadd = color = org = texture2D( tDiffuse, uv );","\tvin = ( uv - vec2( 0.5 ) ) * vec2( 1.4 );","\tsample_dist = dot( vin, vin ) * 2.0;","\tf = ( waveFactor * 100.0 + sample_dist ) * sampleDistance * 4.0;","\tvec2 sampleSize = vec2(  1.0 / screenWidth, 1.0 / screenHeight ) * vec2( f );","\tadd += tmp = texture2D( tDiffuse, uv + vec2( 0.111964, 0.993712 ) * sampleSize );","\tif( tmp.b < color.b ) color = tmp;","\tadd += tmp = texture2D( tDiffuse, uv + vec2( 0.846724, 0.532032 ) * sampleSize );","\tif( tmp.b < color.b ) color = tmp;","\tadd += tmp = texture2D( tDiffuse, uv + vec2( 0.943883, -0.330279 ) * sampleSize );","\tif( tmp.b < color.b ) color = tmp;","\tadd += tmp = texture2D( tDiffuse, uv + vec2( 0.330279, -0.943883 ) * sampleSize );","\tif( tmp.b < color.b ) color = tmp;","\tadd += tmp = texture2D( tDiffuse, uv + vec2( -0.532032, -0.846724 ) * sampleSize );","\tif( tmp.b < color.b ) color = tmp;","\tadd += tmp = texture2D( tDiffuse, uv + vec2( -0.993712, -0.111964 ) * sampleSize );","\tif( tmp.b < color.b ) color = tmp;","\tadd += tmp = texture2D( tDiffuse, uv + vec2( -0.707107, 0.707107 ) * sampleSize );","\tif( tmp.b < color.b ) color = tmp;","\tcolor = color * vec4( 2.0 ) - ( add / vec4( 8.0 ) );","\tcolor = color + ( add / vec4( 8.0 ) - color ) * ( vec4( 1.0 ) - vec4( sample_dist * 0.5 ) );","\tgl_FragColor = vec4( color.rgb * color.rgb * vec3( 0.95 ) + color.rgb, 1.0 );","}"].join("\n")},FreiChenShader={uniforms:{tDiffuse:{value:null},aspect:{value:new Vector2(512,512)}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","uniform vec2 aspect;","vec2 texel = vec2(1.0 / aspect.x, 1.0 / aspect.y);","mat3 G[9];","const mat3 g0 = mat3( 0.3535533845424652, 0, -0.3535533845424652, 0.5, 0, -0.5, 0.3535533845424652, 0, -0.3535533845424652 );","const mat3 g1 = mat3( 0.3535533845424652, 0.5, 0.3535533845424652, 0, 0, 0, -0.3535533845424652, -0.5, -0.3535533845424652 );","const mat3 g2 = mat3( 0, 0.3535533845424652, -0.5, -0.3535533845424652, 0, 0.3535533845424652, 0.5, -0.3535533845424652, 0 );","const mat3 g3 = mat3( 0.5, -0.3535533845424652, 0, -0.3535533845424652, 0, 0.3535533845424652, 0, 0.3535533845424652, -0.5 );","const mat3 g4 = mat3( 0, -0.5, 0, 0.5, 0, 0.5, 0, -0.5, 0 );","const mat3 g5 = mat3( -0.5, 0, 0.5, 0, 0, 0, 0.5, 0, -0.5 );","const mat3 g6 = mat3( 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.6666666865348816, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204 );","const mat3 g7 = mat3( -0.3333333432674408, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, 0.6666666865348816, 0.1666666716337204, -0.3333333432674408, 0.1666666716337204, -0.3333333432674408 );","const mat3 g8 = mat3( 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408, 0.3333333432674408 );","void main(void)","{","\tG[0] = g0,","\tG[1] = g1,","\tG[2] = g2,","\tG[3] = g3,","\tG[4] = g4,","\tG[5] = g5,","\tG[6] = g6,","\tG[7] = g7,","\tG[8] = g8;","\tmat3 I;","\tfloat cnv[9];","\tvec3 sample;","\tfor (float i=0.0; i<3.0; i++) {","\t\tfor (float j=0.0; j<3.0; j++) {","\t\t\tsample = texture2D(tDiffuse, vUv + texel * vec2(i-1.0,j-1.0) ).rgb;","\t\t\tI[int(i)][int(j)] = length(sample);","\t\t}","\t}","\tfor (int i=0; i<9; i++) {","\t\tfloat dp3 = dot(G[i][0], I[0]) + dot(G[i][1], I[1]) + dot(G[i][2], I[2]);","\t\tcnv[i] = dp3 * dp3;","\t}","\tfloat M = (cnv[0] + cnv[1]) + (cnv[2] + cnv[3]);","\tfloat S = (cnv[4] + cnv[5]) + (cnv[6] + cnv[7]) + (cnv[8] + M);","\tgl_FragColor = vec4(vec3(sqrt(M/S)), 1.0);","}"].join("\n")},FresnelShader={uniforms:{mRefractionRatio:{value:1.02},mFresnelBias:{value:.1},mFresnelPower:{value:2},mFresnelScale:{value:1},tCube:{value:null}},vertexShader:["uniform float mRefractionRatio;","uniform float mFresnelBias;","uniform float mFresnelScale;","uniform float mFresnelPower;","varying vec3 vReflect;","varying vec3 vRefract[3];","varying float vReflectionFactor;","void main() {","\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvec3 worldNormal = normalize( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal );","\tvec3 I = worldPosition.xyz - cameraPosition;","\tvReflect = reflect( I, worldNormal );","\tvRefract[0] = refract( normalize( I ), worldNormal, mRefractionRatio );","\tvRefract[1] = refract( normalize( I ), worldNormal, mRefractionRatio * 0.99 );","\tvRefract[2] = refract( normalize( I ), worldNormal, mRefractionRatio * 0.98 );","\tvReflectionFactor = mFresnelBias + mFresnelScale * pow( 1.0 + dot( normalize( I ), worldNormal ), mFresnelPower );","\tgl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform samplerCube tCube;","varying vec3 vReflect;","varying vec3 vRefract[3];","varying float vReflectionFactor;","void main() {","\tvec4 reflectedColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );","\tvec4 refractedColor = vec4( 1.0 );","\trefractedColor.r = textureCube( tCube, vec3( -vRefract[0].x, vRefract[0].yz ) ).r;","\trefractedColor.g = textureCube( tCube, vec3( -vRefract[1].x, vRefract[1].yz ) ).g;","\trefractedColor.b = textureCube( tCube, vec3( -vRefract[2].x, vRefract[2].yz ) ).b;","\tgl_FragColor = mix( refractedColor, reflectedColor, clamp( vReflectionFactor, 0.0, 1.0 ) );","}"].join("\n")},FXAAShader={uniforms:{tDiffuse:{value:null},resolution:{value:new Vector2(1/1024,1/512)}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","","uniform sampler2D tDiffuse;","","uniform vec2 resolution;","","varying vec2 vUv;","","// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)","","//----------------------------------------------------------------------------------","// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag","// SDK Version: v3.00","// Email:       gameworks@nvidia.com","// Site:        http://developer.nvidia.com/","//","// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.","//","// Redistribution and use in source and binary forms, with or without","// modification, are permitted provided that the following conditions","// are met:","//  * Redistributions of source code must retain the above copyright","//    notice, this list of conditions and the following disclaimer.","//  * Redistributions in binary form must reproduce the above copyright","//    notice, this list of conditions and the following disclaimer in the","//    documentation and/or other materials provided with the distribution.","//  * Neither the name of NVIDIA CORPORATION nor the names of its","//    contributors may be used to endorse or promote products derived","//    from this software without specific prior written permission.","//","// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY","// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE","// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR","// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR","// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,","// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,","// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR","// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY","// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT","// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE","// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.","//","//----------------------------------------------------------------------------------","","#define FXAA_PC 1","#define FXAA_GLSL_100 1","#define FXAA_QUALITY_PRESET 12","","#define FXAA_GREEN_AS_LUMA 1","","/*--------------------------------------------------------------------------*/","#ifndef FXAA_PC_CONSOLE","    //","    // The console algorithm for PC is included","    // for developers targeting really low spec machines.","    // Likely better to just run FXAA_PC, and use a really low preset.","    //","    #define FXAA_PC_CONSOLE 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_120","    #define FXAA_GLSL_120 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_130","    #define FXAA_GLSL_130 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_3","    #define FXAA_HLSL_3 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_4","    #define FXAA_HLSL_4 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_5","    #define FXAA_HLSL_5 0","#endif","/*==========================================================================*/","#ifndef FXAA_GREEN_AS_LUMA","    //","    // For those using non-linear color,","    // and either not able to get luma in alpha, or not wanting to,","    // this enables FXAA to run using green as a proxy for luma.","    // So with this enabled, no need to pack luma in alpha.","    //","    // This will turn off AA on anything which lacks some amount of green.","    // Pure red and blue or combination of only R and B, will get no AA.","    //","    // Might want to lower the settings for both,","    //    fxaaConsoleEdgeThresholdMin","    //    fxaaQualityEdgeThresholdMin","    // In order to insure AA does not get turned off on colors","    // which contain a minor amount of green.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_GREEN_AS_LUMA 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_EARLY_EXIT","    //","    // Controls algorithm's early exit path.","    // On PS3 turning this ON adds 2 cycles to the shader.","    // On 360 turning this OFF adds 10ths of a millisecond to the shader.","    // Turning this off on console will result in a more blurry image.","    // So this defaults to on.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_EARLY_EXIT 1","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_DISCARD","    //","    // Only valid for PC OpenGL currently.","    // Probably will not work when FXAA_GREEN_AS_LUMA = 1.","    //","    // 1 = Use discard on pixels which don't need AA.","    //     For APIs which enable concurrent TEX+ROP from same surface.","    // 0 = Return unchanged color on pixels which don't need AA.","    //","    #define FXAA_DISCARD 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_FAST_PIXEL_OFFSET","    //","    // Used for GLSL 120 only.","    //","    // 1 = GL API supports fast pixel offsets","    // 0 = do not use fast pixel offsets","    //","    #ifdef GL_EXT_gpu_shader4","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifndef FXAA_FAST_PIXEL_OFFSET","        #define FXAA_FAST_PIXEL_OFFSET 0","    #endif","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GATHER4_ALPHA","    //","    // 1 = API supports gather4 on alpha channel.","    // 0 = API does not support gather4 on alpha channel.","    //","    #if (FXAA_HLSL_5 == 1)","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifndef FXAA_GATHER4_ALPHA","        #define FXAA_GATHER4_ALPHA 0","    #endif","#endif","","","/*============================================================================","                        FXAA QUALITY - TUNING KNOBS","------------------------------------------------------------------------------","NOTE the other tuning knobs are now in the shader function inputs!","============================================================================*/","#ifndef FXAA_QUALITY_PRESET","    //","    // Choose the quality preset.","    // This needs to be compiled into the shader as it effects code.","    // Best option to include multiple presets is to","    // in each shader define the preset, then include this file.","    //","    // OPTIONS","    // -----------------------------------------------------------------------","    // 10 to 15 - default medium dither (10=fastest, 15=highest quality)","    // 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)","    // 39       - no dither, very expensive","    //","    // NOTES","    // -----------------------------------------------------------------------","    // 12 = slightly faster then FXAA 3.9 and higher edge quality (default)","    // 13 = about same speed as FXAA 3.9 and better than 12","    // 23 = closest to FXAA 3.9 visually and performance wise","    //  _ = the lowest digit is directly related to performance","    // _  = the highest digit is directly related to style","    //","    #define FXAA_QUALITY_PRESET 12","#endif","","","/*============================================================================","","                           FXAA QUALITY - PRESETS","","============================================================================*/","","/*============================================================================","                     FXAA QUALITY - MEDIUM DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 10)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 3.0","    #define FXAA_QUALITY_P2 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 11)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 3.0","    #define FXAA_QUALITY_P3 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 12)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 4.0","    #define FXAA_QUALITY_P4 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 13)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 4.0","    #define FXAA_QUALITY_P5 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 14)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 4.0","    #define FXAA_QUALITY_P6 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 15)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 12.0","#endif","","/*============================================================================","                     FXAA QUALITY - LOW DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 20)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 2.0","    #define FXAA_QUALITY_P2 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 21)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 22)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 23)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 24)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 3.0","    #define FXAA_QUALITY_P6 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 25)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 26)","    #define FXAA_QUALITY_PS 9","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 4.0","    #define FXAA_QUALITY_P8 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 27)","    #define FXAA_QUALITY_PS 10","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 4.0","    #define FXAA_QUALITY_P9 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 28)","    #define FXAA_QUALITY_PS 11","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 4.0","    #define FXAA_QUALITY_P10 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 29)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","/*============================================================================","                     FXAA QUALITY - EXTREME QUALITY","============================================================================*/","#if (FXAA_QUALITY_PRESET == 39)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.0","    #define FXAA_QUALITY_P2 1.0","    #define FXAA_QUALITY_P3 1.0","    #define FXAA_QUALITY_P4 1.0","    #define FXAA_QUALITY_P5 1.5","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","","","/*============================================================================","","                                API PORTING","","============================================================================*/","#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)","    #define FxaaBool bool","    #define FxaaDiscard discard","    #define FxaaFloat float","    #define FxaaFloat2 vec2","    #define FxaaFloat3 vec3","    #define FxaaFloat4 vec4","    #define FxaaHalf float","    #define FxaaHalf2 vec2","    #define FxaaHalf3 vec3","    #define FxaaHalf4 vec4","    #define FxaaInt2 ivec2","    #define FxaaSat(x) clamp(x, 0.0, 1.0)","    #define FxaaTex sampler2D","#else","    #define FxaaBool bool","    #define FxaaDiscard clip(-1)","    #define FxaaFloat float","    #define FxaaFloat2 float2","    #define FxaaFloat3 float3","    #define FxaaFloat4 float4","    #define FxaaHalf half","    #define FxaaHalf2 half2","    #define FxaaHalf3 half3","    #define FxaaHalf4 half4","    #define FxaaSat(x) saturate(x)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_100 == 1)","  #define FxaaTexTop(t, p) texture2D(t, p, 0.0)","  #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_120 == 1)","    // Requires,","    //  #version 120","    // And at least,","    //  #extension GL_EXT_gpu_shader4 : enable","    //  (or set FXAA_FAST_PIXEL_OFFSET 1 to work like DX9)","    #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)","    #if (FXAA_FAST_PIXEL_OFFSET == 1)","        #define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)","    #else","        #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)","    #endif","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_130 == 1)",'    // Requires "#version 130" or better',"    #define FxaaTexTop(t, p) textureLod(t, p, 0.0)","    #define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_3 == 1)","    #define FxaaInt2 float2","    #define FxaaTex sampler2D","    #define FxaaTexTop(t, p) tex2Dlod(t, float4(p, 0.0, 0.0))","    #define FxaaTexOff(t, p, o, r) tex2Dlod(t, float4(p + (o * r), 0, 0))","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_4 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_5 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","    #define FxaaTexAlpha4(t, p) t.tex.GatherAlpha(t.smpl, p)","    #define FxaaTexOffAlpha4(t, p, o) t.tex.GatherAlpha(t.smpl, p, o)","    #define FxaaTexGreen4(t, p) t.tex.GatherGreen(t.smpl, p)","    #define FxaaTexOffGreen4(t, p, o) t.tex.GatherGreen(t.smpl, p, o)","#endif","","","/*============================================================================","                   GREEN AS LUMA OPTION SUPPORT FUNCTION","============================================================================*/","#if (FXAA_GREEN_AS_LUMA == 0)","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }","#else","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }","#endif","","","","","/*============================================================================","","                             FXAA3 QUALITY - PC","","============================================================================*/","#if (FXAA_PC == 1)","/*--------------------------------------------------------------------------*/","FxaaFloat4 FxaaPixelShader(","    //","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy} = center of pixel","    FxaaFloat2 pos,","    //","    // Used only for FXAA Console, and not used on the 360 version.","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy_} = upper left of pixel","    // {_zw} = lower right of pixel","    FxaaFloat4 fxaaConsolePosPos,","    //","    // Input color texture.","    // {rgb_} = color in linear or perceptual color space","    // if (FXAA_GREEN_AS_LUMA == 0)","    //     {__a} = luma in perceptual color space (not linear)","    FxaaTex tex,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 2nd sampler.","    // This sampler needs to have an exponent bias of -1.","    FxaaTex fxaaConsole360TexExpBiasNegOne,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 3nd sampler.","    // This sampler needs to have an exponent bias of -2.","    FxaaTex fxaaConsole360TexExpBiasNegTwo,","    //","    // Only used on FXAA Quality.","    // This must be from a constant/uniform.","    // {x_} = 1.0/screenWidthInPixels","    // {_y} = 1.0/screenHeightInPixels","    FxaaFloat2 fxaaQualityRcpFrame,","    //","    // Only used on FXAA Console.","    // This must be from a constant/uniform.","    // This effects sub-pixel AA quality and inversely sharpness.","    //   Where N ranges between,","    //     N = 0.50 (default)","    //     N = 0.33 (sharper)","    // {x__} = -N/screenWidthInPixels","    // {_y_} = -N/screenHeightInPixels","    // {_z_} =  N/screenWidthInPixels","    // {__w} =  N/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt,","    //","    // Only used on FXAA Console.","    // Not used on 360, but used on PS3 and PC.","    // This must be from a constant/uniform.","    // {x__} = -2.0/screenWidthInPixels","    // {_y_} = -2.0/screenHeightInPixels","    // {_z_} =  2.0/screenWidthInPixels","    // {__w} =  2.0/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt2,","    //","    // Only used on FXAA Console.","    // Only used on 360 in place of fxaaConsoleRcpFrameOpt2.","    // This must be from a constant/uniform.","    // {x__} =  8.0/screenWidthInPixels","    // {_y_} =  8.0/screenHeightInPixels","    // {_z_} = -4.0/screenWidthInPixels","    // {__w} = -4.0/screenHeightInPixels","    FxaaFloat4 fxaaConsole360RcpFrameOpt2,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_SUBPIX define.","    // It is here now to allow easier tuning.","    // Choose the amount of sub-pixel aliasing removal.","    // This can effect sharpness.","    //   1.00 - upper limit (softer)","    //   0.75 - default amount of filtering","    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)","    //   0.25 - almost off","    //   0.00 - completely off","    FxaaFloat fxaaQualitySubpix,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // The minimum amount of local contrast required to apply algorithm.","    //   0.333 - too little (faster)","    //   0.250 - low quality","    //   0.166 - default","    //   0.125 - high quality","    //   0.063 - overkill (slower)","    FxaaFloat fxaaQualityEdgeThreshold,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    //   0.0833 - upper limit (default, the start of visible unfiltered edges)","    //   0.0625 - high quality (faster)","    //   0.0312 - visible limit (slower)","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaQualityEdgeThresholdMin,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_SHARPNESS define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_SHARPNESS for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only three safe values here: 2 and 4 and 8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // For all other platforms can be a non-power of two.","    //   8.0 is sharper (default!!!)","    //   4.0 is softer","    //   2.0 is really soft (good only for vector graphics inputs)","    FxaaFloat fxaaConsoleEdgeSharpness,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_THRESHOLD for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only two safe values here: 1/4 and 1/8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // The console setting has a different mapping than the quality setting.","    // Other platforms can use other values.","    //   0.125 leaves less aliasing, but is softer (default!!!)","    //   0.25 leaves more aliasing, and is sharper","    FxaaFloat fxaaConsoleEdgeThreshold,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    // The console setting has a different mapping than the quality setting.","    // This only applies when FXAA_EARLY_EXIT is 1.","    // This does not apply to PS3,","    // PS3 was simplified to avoid more shader instructions.","    //   0.06 - faster but more aliasing in darks","    //   0.05 - default","    //   0.04 - slower and less aliasing in darks","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaConsoleEdgeThresholdMin,","    //","    // Extra constants for 360 FXAA Console only.","    // Use zeros or anything else for other platforms.","    // These must be in physical constant registers and NOT immediates.","    // Immediates will result in compiler un-optimizing.","    // {xyzw} = float4(1.0, -1.0, 0.25, -0.25)","    FxaaFloat4 fxaaConsole360ConstDir",") {","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posM;","    posM.x = pos.x;","    posM.y = pos.y;","    #if (FXAA_GATHER4_ALPHA == 1)","        #if (FXAA_DISCARD == 0)","            FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","            #if (FXAA_GREEN_AS_LUMA == 0)","                #define lumaM rgbyM.w","            #else","                #define lumaM rgbyM.y","            #endif","        #endif","        #if (FXAA_GREEN_AS_LUMA == 0)","            FxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));","        #else","            FxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));","        #endif","        #if (FXAA_DISCARD == 1)","            #define lumaM luma4A.w","        #endif","        #define lumaE luma4A.z","        #define lumaS luma4A.x","        #define lumaSE luma4A.y","        #define lumaNW luma4B.w","        #define lumaN luma4B.z","        #define lumaW luma4B.x","    #else","        FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","        #if (FXAA_GREEN_AS_LUMA == 0)","            #define lumaM rgbyM.w","        #else","            #define lumaM rgbyM.y","        #endif","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 0.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));","        #endif","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat maxSM = max(lumaS, lumaM);","    FxaaFloat minSM = min(lumaS, lumaM);","    FxaaFloat maxESM = max(lumaE, maxSM);","    FxaaFloat minESM = min(lumaE, minSM);","    FxaaFloat maxWN = max(lumaN, lumaW);","    FxaaFloat minWN = min(lumaN, lumaW);","    FxaaFloat rangeMax = max(maxWN, maxESM);","    FxaaFloat rangeMin = min(minWN, minESM);","    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;","    FxaaFloat range = rangeMax - rangeMin;","    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);","    FxaaBool earlyExit = range < rangeMaxClamped;","/*--------------------------------------------------------------------------*/","    if(earlyExit)","        #if (FXAA_DISCARD == 1)","            FxaaDiscard;","        #else","            return rgbyM;","        #endif","/*--------------------------------------------------------------------------*/","    #if (FXAA_GATHER4_ALPHA == 0)","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","        #endif","    #else","        FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));","        FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNS = lumaN + lumaS;","    FxaaFloat lumaWE = lumaW + lumaE;","    FxaaFloat subpixRcpRange = 1.0/range;","    FxaaFloat subpixNSWE = lumaNS + lumaWE;","    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;","    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNESE = lumaNE + lumaSE;","    FxaaFloat lumaNWNE = lumaNW + lumaNE;","    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;","    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNWSW = lumaNW + lumaSW;","    FxaaFloat lumaSWSE = lumaSW + lumaSE;","    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);","    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);","    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;","    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;","    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;","    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;","/*--------------------------------------------------------------------------*/","    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;","    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;","    FxaaBool horzSpan = edgeHorz >= edgeVert;","    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;","/*--------------------------------------------------------------------------*/","    if(!horzSpan) lumaN = lumaW;","    if(!horzSpan) lumaS = lumaE;","    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;","    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;","/*--------------------------------------------------------------------------*/","    FxaaFloat gradientN = lumaN - lumaM;","    FxaaFloat gradientS = lumaS - lumaM;","    FxaaFloat lumaNN = lumaN + lumaM;","    FxaaFloat lumaSS = lumaS + lumaM;","    FxaaBool pairN = abs(gradientN) >= abs(gradientS);","    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));","    if(pairN) lengthSign = -lengthSign;","    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posB;","    posB.x = posM.x;","    posB.y = posM.y;","    FxaaFloat2 offNP;","    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;","    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;","    if(!horzSpan) posB.x += lengthSign * 0.5;","    if( horzSpan) posB.y += lengthSign * 0.5;","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posN;","    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;","    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;","    FxaaFloat2 posP;","    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;","    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;","    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;","    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));","    FxaaFloat subpixE = subpixC * subpixC;","    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));","/*--------------------------------------------------------------------------*/","    if(!pairN) lumaNN = lumaSS;","    FxaaFloat gradientScaled = gradient * 1.0/4.0;","    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;","    FxaaFloat subpixF = subpixD * subpixE;","    FxaaBool lumaMLTZero = lumaMM < 0.0;","/*--------------------------------------------------------------------------*/","    lumaEndN -= lumaNN * 0.5;","    lumaEndP -= lumaNN * 0.5;","    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;","    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;","    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;","    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;","    FxaaBool doneNP = (!doneN) || (!doneP);","    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;","    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;","/*--------------------------------------------------------------------------*/","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 3)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 4)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 5)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 6)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;","/*--------------------------------------------------------------------------*/","                        #if (FXAA_QUALITY_PS > 7)","                        if(doneNP) {","                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                            doneN = abs(lumaEndN) >= gradientScaled;","                            doneP = abs(lumaEndP) >= gradientScaled;","                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;","                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;","                            doneNP = (!doneN) || (!doneP);","                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;","                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;","/*--------------------------------------------------------------------------*/","    #if (FXAA_QUALITY_PS > 8)","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 9)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 10)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 11)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 12)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","    #endif","/*--------------------------------------------------------------------------*/","                        }","                        #endif","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","/*--------------------------------------------------------------------------*/","    FxaaFloat dstN = posM.x - posN.x;","    FxaaFloat dstP = posP.x - posM.x;","    if(!horzSpan) dstN = posM.y - posN.y;","    if(!horzSpan) dstP = posP.y - posM.y;","/*--------------------------------------------------------------------------*/","    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;","    FxaaFloat spanLength = (dstP + dstN);","    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;","    FxaaFloat spanLengthRcp = 1.0/spanLength;","/*--------------------------------------------------------------------------*/","    FxaaBool directionN = dstN < dstP;","    FxaaFloat dst = min(dstN, dstP);","    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;","    FxaaFloat subpixG = subpixF * subpixF;","    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;","    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;","/*--------------------------------------------------------------------------*/","    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;","    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);","    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;","    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;","    #if (FXAA_DISCARD == 1)","        return FxaaTexTop(tex, posM);","    #else","        return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);","    #endif","}","/*==========================================================================*/","#endif","","void main() {","  gl_FragColor = FxaaPixelShader(","    vUv,","    vec4(0.0),","    tDiffuse,","    tDiffuse,","    tDiffuse,","    resolution,","    vec4(0.0),","    vec4(0.0),","    vec4(0.0),","    0.75,","    0.166,","    0.0833,","    0.0,","    0.0,","    0.0,","    vec4(0.0)","  );","","  // TODO avoid querying texture twice for same texel","  gl_FragColor.a = texture2D(tDiffuse, vUv).a;","}"].join("\n")},GammaCorrectionShader={uniforms:{tDiffuse:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 tex = texture2D( tDiffuse, vec2( vUv.x, vUv.y ) );","\tgl_FragColor = LinearTosRGB( tex );","}"].join("\n")},GodRaysDepthMaskShader={uniforms:{tInput:{value:null}},vertexShader:["varying vec2 vUv;","void main() {"," vUv = uv;"," gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec2 vUv;","uniform sampler2D tInput;","void main() {","\tgl_FragColor = vec4( 1.0 ) - texture2D( tInput, vUv );","}"].join("\n")},GodRaysGenerateShader={uniforms:{tInput:{value:null},fStepSize:{value:1},vSunPositionScreenSpace:{value:new Vector2(.5,.5)}},vertexShader:["varying vec2 vUv;","void main() {"," vUv = uv;"," gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#define TAPS_PER_PASS 6.0","varying vec2 vUv;","uniform sampler2D tInput;","uniform vec2 vSunPositionScreenSpace;","uniform float fStepSize;","void main() {","\tvec2 delta = vSunPositionScreenSpace - vUv;","\tfloat dist = length( delta );","\tvec2 stepv = fStepSize * delta / dist;","\tfloat iters = dist/fStepSize;","\tvec2 uv = vUv.xy;","\tfloat col = 0.0;","\tif ( 0.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;","\tuv += stepv;","\tif ( 1.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;","\tuv += stepv;","\tif ( 2.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;","\tuv += stepv;","\tif ( 3.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;","\tuv += stepv;","\tif ( 4.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;","\tuv += stepv;","\tif ( 5.0 <= iters && uv.y < 1.0 ) col += texture2D( tInput, uv ).r;","\tuv += stepv;","\tgl_FragColor = vec4( col/TAPS_PER_PASS );","\tgl_FragColor.a = 1.0;","}"].join("\n")},GodRaysCombineShader={uniforms:{tColors:{value:null},tGodRays:{value:null},fGodRayIntensity:{value:.69},vSunPositionScreenSpace:{value:new Vector2(.5,.5)}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec2 vUv;","uniform sampler2D tColors;","uniform sampler2D tGodRays;","uniform vec2 vSunPositionScreenSpace;","uniform float fGodRayIntensity;","void main() {","\tgl_FragColor = texture2D( tColors, vUv ) + fGodRayIntensity * vec4( 1.0 - texture2D( tGodRays, vUv ).r );","\tgl_FragColor.a = 1.0;","}"].join("\n")},GodRaysFakeSunShader={uniforms:{vSunPositionScreenSpace:{value:new Vector2(.5,.5)},fAspect:{value:1},sunColor:{value:new Color(16772608)},bgColor:{value:new Color(0)}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["varying vec2 vUv;","uniform vec2 vSunPositionScreenSpace;","uniform float fAspect;","uniform vec3 sunColor;","uniform vec3 bgColor;","void main() {","\tvec2 diff = vUv - vSunPositionScreenSpace;","\tdiff.x *= fAspect;","\tfloat prop = clamp( length( diff ) / 0.5, 0.0, 1.0 );","\tprop = 0.35 * pow( 1.0 - prop, 3.0 );","\tgl_FragColor.xyz = mix( sunColor, bgColor, 1.0 - prop );","\tgl_FragColor.w = 1.0;","}"].join("\n")},HorizontalBlurShader={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float h;","varying vec2 vUv;","void main() {","\tvec4 sum = vec4( 0.0 );","\tsum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;","\tsum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;","\tsum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;","\tsum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","\tsum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;","\tsum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;","\tsum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;","\tsum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;","\tgl_FragColor = sum;","}"].join("\n")},HorizontalTiltShiftShader={uniforms:{tDiffuse:{value:null},h:{value:1/512},r:{value:.35}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float h;","uniform float r;","varying vec2 vUv;","void main() {","\tvec4 sum = vec4( 0.0 );","\tfloat hh = h * abs( r - vUv.y );","\tsum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * hh, vUv.y ) ) * 0.051;","\tsum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * hh, vUv.y ) ) * 0.0918;","\tsum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * hh, vUv.y ) ) * 0.12245;","\tsum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * hh, vUv.y ) ) * 0.1531;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","\tsum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * hh, vUv.y ) ) * 0.1531;","\tsum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * hh, vUv.y ) ) * 0.12245;","\tsum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * hh, vUv.y ) ) * 0.0918;","\tsum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * hh, vUv.y ) ) * 0.051;","\tgl_FragColor = sum;","}"].join("\n")},HueSaturationShader={uniforms:{tDiffuse:{value:null},hue:{value:0},saturation:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float hue;","uniform float saturation;","varying vec2 vUv;","void main() {","\tgl_FragColor = texture2D( tDiffuse, vUv );","\tfloat angle = hue * 3.14159265;","\tfloat s = sin(angle), c = cos(angle);","\tvec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;","\tfloat len = length(gl_FragColor.rgb);","\tgl_FragColor.rgb = vec3(","\t\tdot(gl_FragColor.rgb, weights.xyz),","\t\tdot(gl_FragColor.rgb, weights.zxy),","\t\tdot(gl_FragColor.rgb, weights.yzx)","\t);","\tfloat average = (gl_FragColor.r + gl_FragColor.g + gl_FragColor.b) / 3.0;","\tif (saturation > 0.0) {","\t\tgl_FragColor.rgb += (average - gl_FragColor.rgb) * (1.0 - 1.0 / (1.001 - saturation));","\t} else {","\t\tgl_FragColor.rgb += (average - gl_FragColor.rgb) * (-saturation);","\t}","}"].join("\n")},KaleidoShader={uniforms:{tDiffuse:{value:null},sides:{value:6},angle:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float sides;","uniform float angle;","varying vec2 vUv;","void main() {","\tvec2 p = vUv - 0.5;","\tfloat r = length(p);","\tfloat a = atan(p.y, p.x) + angle;","\tfloat tau = 2. * 3.1416 ;","\ta = mod(a, tau/sides);","\ta = abs(a - tau/sides/2.) ;","\tp = r * vec2(cos(a), sin(a));","\tvec4 color = texture2D(tDiffuse, p + 0.5);","\tgl_FragColor = color;","}"].join("\n")},MirrorShader={uniforms:{tDiffuse:{value:null},side:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform int side;","varying vec2 vUv;","void main() {","\tvec2 p = vUv;","\tif (side == 0){","\t\tif (p.x > 0.5) p.x = 1.0 - p.x;","\t}else if (side == 1){","\t\tif (p.x < 0.5) p.x = 1.0 - p.x;","\t}else if (side == 2){","\t\tif (p.y < 0.5) p.y = 1.0 - p.y;","\t}else if (side == 3){","\t\tif (p.y > 0.5) p.y = 1.0 - p.y;","\t} ","\tvec4 color = texture2D(tDiffuse, p);","\tgl_FragColor = color;","}"].join("\n")},NormalMapShader={uniforms:{heightMap:{value:null},resolution:{value:new Vector2(512,512)},scale:{value:new Vector2(1,1)},height:{value:.05}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float height;","uniform vec2 resolution;","uniform sampler2D heightMap;","varying vec2 vUv;","void main() {","\tfloat val = texture2D( heightMap, vUv ).x;","\tfloat valU = texture2D( heightMap, vUv + vec2( 1.0 / resolution.x, 0.0 ) ).x;","\tfloat valV = texture2D( heightMap, vUv + vec2( 0.0, 1.0 / resolution.y ) ).x;","\tgl_FragColor = vec4( ( 0.5 * normalize( vec3( val - valU, val - valV, height  ) ) + 0.5 ), 1.0 );","}"].join("\n")},ParallaxShader={modes:{none:"NO_PARALLAX",basic:"USE_BASIC_PARALLAX",steep:"USE_STEEP_PARALLAX",occlusion:"USE_OCLUSION_PARALLAX",relief:"USE_RELIEF_PARALLAX"},uniforms:{bumpMap:{value:null},map:{value:null},parallaxScale:{value:null},parallaxMinLayers:{value:null},parallaxMaxLayers:{value:null}},vertexShader:["varying vec2 vUv;","varying vec3 vViewPosition;","varying vec3 vNormal;","void main() {","\tvUv = uv;","\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","\tvViewPosition = -mvPosition.xyz;","\tvNormal = normalize( normalMatrix * normal );","\tgl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform sampler2D bumpMap;","uniform sampler2D map;","uniform float parallaxScale;","uniform float parallaxMinLayers;","uniform float parallaxMaxLayers;","varying vec2 vUv;","varying vec3 vViewPosition;","varying vec3 vNormal;","#ifdef USE_BASIC_PARALLAX","\tvec2 parallaxMap( in vec3 V ) {","\t\tfloat initialHeight = texture2D( bumpMap, vUv ).r;","\t\tvec2 texCoordOffset = parallaxScale * V.xy * initialHeight;","\t\treturn vUv - texCoordOffset;","\t}","#else","\tvec2 parallaxMap( in vec3 V ) {","\t\tfloat numLayers = mix( parallaxMaxLayers, parallaxMinLayers, abs( dot( vec3( 0.0, 0.0, 1.0 ), V ) ) );","\t\tfloat layerHeight = 1.0 / numLayers;","\t\tfloat currentLayerHeight = 0.0;","\t\tvec2 dtex = parallaxScale * V.xy / V.z / numLayers;","\t\tvec2 currentTextureCoords = vUv;","\t\tfloat heightFromTexture = texture2D( bumpMap, currentTextureCoords ).r;","\t\tfor ( int i = 0; i < 30; i += 1 ) {","\t\t\tif ( heightFromTexture <= currentLayerHeight ) {","\t\t\t\tbreak;","\t\t\t}","\t\t\tcurrentLayerHeight += layerHeight;","\t\t\tcurrentTextureCoords -= dtex;","\t\t\theightFromTexture = texture2D( bumpMap, currentTextureCoords ).r;","\t\t}","\t\t#ifdef USE_STEEP_PARALLAX","\t\t\treturn currentTextureCoords;","\t\t#elif defined( USE_RELIEF_PARALLAX )","\t\t\tvec2 deltaTexCoord = dtex / 2.0;","\t\t\tfloat deltaHeight = layerHeight / 2.0;","\t\t\tcurrentTextureCoords += deltaTexCoord;","\t\t\tcurrentLayerHeight -= deltaHeight;","\t\t\tconst int numSearches = 5;","\t\t\tfor ( int i = 0; i < numSearches; i += 1 ) {","\t\t\t\tdeltaTexCoord /= 2.0;","\t\t\t\tdeltaHeight /= 2.0;","\t\t\t\theightFromTexture = texture2D( bumpMap, currentTextureCoords ).r;","\t\t\t\tif( heightFromTexture > currentLayerHeight ) {","\t\t\t\t\tcurrentTextureCoords -= deltaTexCoord;","\t\t\t\t\tcurrentLayerHeight += deltaHeight;","\t\t\t\t} else {","\t\t\t\t\tcurrentTextureCoords += deltaTexCoord;","\t\t\t\t\tcurrentLayerHeight -= deltaHeight;","\t\t\t\t}","\t\t\t}","\t\t\treturn currentTextureCoords;","\t\t#elif defined( USE_OCLUSION_PARALLAX )","\t\t\tvec2 prevTCoords = currentTextureCoords + dtex;","\t\t\tfloat nextH = heightFromTexture - currentLayerHeight;","\t\t\tfloat prevH = texture2D( bumpMap, prevTCoords ).r - currentLayerHeight + layerHeight;","\t\t\tfloat weight = nextH / ( nextH - prevH );","\t\t\treturn prevTCoords * weight + currentTextureCoords * ( 1.0 - weight );","\t\t#else","\t\t\treturn vUv;","\t\t#endif","\t}","#endif","vec2 perturbUv( vec3 surfPosition, vec3 surfNormal, vec3 viewPosition ) {","\tvec2 texDx = dFdx( vUv );","\tvec2 texDy = dFdy( vUv );","\tvec3 vSigmaX = dFdx( surfPosition );","\tvec3 vSigmaY = dFdy( surfPosition );","\tvec3 vR1 = cross( vSigmaY, surfNormal );","\tvec3 vR2 = cross( surfNormal, vSigmaX );","\tfloat fDet = dot( vSigmaX, vR1 );","\tvec2 vProjVscr = ( 1.0 / fDet ) * vec2( dot( vR1, viewPosition ), dot( vR2, viewPosition ) );","\tvec3 vProjVtex;","\tvProjVtex.xy = texDx * vProjVscr.x + texDy * vProjVscr.y;","\tvProjVtex.z = dot( surfNormal, viewPosition );","\treturn parallaxMap( vProjVtex );","}","void main() {","\tvec2 mapUv = perturbUv( -vViewPosition, normalize( vNormal ), normalize( vViewPosition ) );","\tgl_FragColor = texture2D( map, mapUv );","}"].join("\n")},PixelShader={uniforms:{tDiffuse:{value:null},resolution:{value:null},pixelSize:{value:1}},vertexShader:["varying highp vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float pixelSize;","uniform vec2 resolution;","varying highp vec2 vUv;","void main(){","vec2 dxy = pixelSize / resolution;","vec2 coord = dxy * floor( vUv / dxy );","gl_FragColor = texture2D(tDiffuse, coord);","}"].join("\n")},RGBShiftShader={uniforms:{tDiffuse:{value:null},amount:{value:.005},angle:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float amount;","uniform float angle;","varying vec2 vUv;","void main() {","\tvec2 offset = amount * vec2( cos(angle), sin(angle));","\tvec4 cr = texture2D(tDiffuse, vUv + offset);","\tvec4 cga = texture2D(tDiffuse, vUv);","\tvec4 cb = texture2D(tDiffuse, vUv - offset);","\tgl_FragColor = vec4(cr.r, cga.g, cb.b, cga.a);","}"].join("\n")},SepiaShader={uniforms:{tDiffuse:{value:null},amount:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float amount;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 color = texture2D( tDiffuse, vUv );","\tvec3 c = color.rgb;","\tcolor.r = dot( c, vec3( 1.0 - 0.607 * amount, 0.769 * amount, 0.189 * amount ) );","\tcolor.g = dot( c, vec3( 0.349 * amount, 1.0 - 0.314 * amount, 0.168 * amount ) );","\tcolor.b = dot( c, vec3( 0.272 * amount, 0.534 * amount, 1.0 - 0.869 * amount ) );","\tgl_FragColor = vec4( min( vec3( 1.0 ), color.rgb ), color.a );","}"].join("\n")},SobelOperatorShader={uniforms:{tDiffuse:{value:null},resolution:{value:new Vector2}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec2 resolution;","varying vec2 vUv;","void main() {","\tvec2 texel = vec2( 1.0 / resolution.x, 1.0 / resolution.y );","\tconst mat3 Gx = mat3( -1, -2, -1, 0, 0, 0, 1, 2, 1 );","\tconst mat3 Gy = mat3( -1, 0, 1, -2, 0, 2, -1, 0, 1 );","\tfloat tx0y0 = texture2D( tDiffuse, vUv + texel * vec2( -1, -1 ) ).r;","\tfloat tx0y1 = texture2D( tDiffuse, vUv + texel * vec2( -1,  0 ) ).r;","\tfloat tx0y2 = texture2D( tDiffuse, vUv + texel * vec2( -1,  1 ) ).r;","\tfloat tx1y0 = texture2D( tDiffuse, vUv + texel * vec2(  0, -1 ) ).r;","\tfloat tx1y1 = texture2D( tDiffuse, vUv + texel * vec2(  0,  0 ) ).r;","\tfloat tx1y2 = texture2D( tDiffuse, vUv + texel * vec2(  0,  1 ) ).r;","\tfloat tx2y0 = texture2D( tDiffuse, vUv + texel * vec2(  1, -1 ) ).r;","\tfloat tx2y1 = texture2D( tDiffuse, vUv + texel * vec2(  1,  0 ) ).r;","\tfloat tx2y2 = texture2D( tDiffuse, vUv + texel * vec2(  1,  1 ) ).r;","\tfloat valueGx = Gx[0][0] * tx0y0 + Gx[1][0] * tx1y0 + Gx[2][0] * tx2y0 + ","\t\tGx[0][1] * tx0y1 + Gx[1][1] * tx1y1 + Gx[2][1] * tx2y1 + ","\t\tGx[0][2] * tx0y2 + Gx[1][2] * tx1y2 + Gx[2][2] * tx2y2; ","\tfloat valueGy = Gy[0][0] * tx0y0 + Gy[1][0] * tx1y0 + Gy[2][0] * tx2y0 + ","\t\tGy[0][1] * tx0y1 + Gy[1][1] * tx1y1 + Gy[2][1] * tx2y1 + ","\t\tGy[0][2] * tx0y2 + Gy[1][2] * tx1y2 + Gy[2][2] * tx2y2; ","\tfloat G = sqrt( ( valueGx * valueGx ) + ( valueGy * valueGy ) );","\tgl_FragColor = vec4( vec3( G ), 1 );","}"].join("\n")},TechnicolorShader={uniforms:{tDiffuse:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 tex = texture2D( tDiffuse, vec2( vUv.x, vUv.y ) );","\tvec4 newTex = vec4(tex.r, (tex.g + tex.b) * .5, (tex.g + tex.b) * .5, 1.0);","\tgl_FragColor = newTex;","}"].join("\n")},ToonShader1={uniforms:{uDirLightPos:{value:new Vector3},uDirLightColor:{value:new Color(15658734)},uAmbientLightColor:{value:new Color(328965)},uBaseColor:{value:new Color(16777215)}},vertexShader:["varying vec3 vNormal;","varying vec3 vRefract;","void main() {","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","\tvec3 worldNormal = normalize ( mat3( modelMatrix[0].xyz, modelMatrix[1].xyz, modelMatrix[2].xyz ) * normal );","\tvNormal = normalize( normalMatrix * normal );","\tvec3 I = worldPosition.xyz - cameraPosition;","\tvRefract = refract( normalize( I ), worldNormal, 1.02 );","\tgl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform vec3 uBaseColor;","uniform vec3 uDirLightPos;","uniform vec3 uDirLightColor;","uniform vec3 uAmbientLightColor;","varying vec3 vNormal;","varying vec3 vRefract;","void main() {","\tfloat directionalLightWeighting = max( dot( normalize( vNormal ), uDirLightPos ), 0.0);","\tvec3 lightWeighting = uAmbientLightColor + uDirLightColor * directionalLightWeighting;","\tfloat intensity = smoothstep( - 0.5, 1.0, pow( length(lightWeighting), 20.0 ) );","\tintensity += length(lightWeighting) * 0.2;","\tfloat cameraWeighting = dot( normalize( vNormal ), vRefract );","\tintensity += pow( 1.0 - length( cameraWeighting ), 6.0 );","\tintensity = intensity * 0.2 + 0.3;","\tif ( intensity < 0.50 ) {","\t\tgl_FragColor = vec4( 2.0 * intensity * uBaseColor, 1.0 );","\t} else {","\t\tgl_FragColor = vec4( 1.0 - 2.0 * ( 1.0 - intensity ) * ( 1.0 - uBaseColor ), 1.0 );","}","}"].join("\n")},ToonShader2={uniforms:{uDirLightPos:{value:new Vector3},uDirLightColor:{value:new Color(15658734)},uAmbientLightColor:{value:new Color(328965)},uBaseColor:{value:new Color(15658734)},uLineColor1:{value:new Color(8421504)},uLineColor2:{value:new Color(0)},uLineColor3:{value:new Color(0)},uLineColor4:{value:new Color(0)}},vertexShader:["varying vec3 vNormal;","void main() {","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","\tvNormal = normalize( normalMatrix * normal );","}"].join("\n"),fragmentShader:["uniform vec3 uBaseColor;","uniform vec3 uLineColor1;","uniform vec3 uLineColor2;","uniform vec3 uLineColor3;","uniform vec3 uLineColor4;","uniform vec3 uDirLightPos;","uniform vec3 uDirLightColor;","uniform vec3 uAmbientLightColor;","varying vec3 vNormal;","void main() {","\tfloat camera = max( dot( normalize( vNormal ), vec3( 0.0, 0.0, 1.0 ) ), 0.4);","\tfloat light = max( dot( normalize( vNormal ), uDirLightPos ), 0.0);","\tgl_FragColor = vec4( uBaseColor, 1.0 );","\tif ( length(uAmbientLightColor + uDirLightColor * light) < 1.00 ) {","\t\tgl_FragColor *= vec4( uLineColor1, 1.0 );","\t}","\tif ( length(uAmbientLightColor + uDirLightColor * camera) < 0.50 ) {","\t\tgl_FragColor *= vec4( uLineColor2, 1.0 );","\t}","}"].join("\n")},ToonShaderHatching={uniforms:{uDirLightPos:{value:new Vector3},uDirLightColor:{value:new Color(15658734)},uAmbientLightColor:{value:new Color(328965)},uBaseColor:{value:new Color(16777215)},uLineColor1:{value:new Color(0)},uLineColor2:{value:new Color(0)},uLineColor3:{value:new Color(0)},uLineColor4:{value:new Color(0)}},vertexShader:["varying vec3 vNormal;","void main() {","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","\tvNormal = normalize( normalMatrix * normal );","}"].join("\n"),fragmentShader:["uniform vec3 uBaseColor;","uniform vec3 uLineColor1;","uniform vec3 uLineColor2;","uniform vec3 uLineColor3;","uniform vec3 uLineColor4;","uniform vec3 uDirLightPos;","uniform vec3 uDirLightColor;","uniform vec3 uAmbientLightColor;","varying vec3 vNormal;","void main() {","\tfloat directionalLightWeighting = max( dot( normalize(vNormal), uDirLightPos ), 0.0);","\tvec3 lightWeighting = uAmbientLightColor + uDirLightColor * directionalLightWeighting;","\tgl_FragColor = vec4( uBaseColor, 1.0 );","\tif ( length(lightWeighting) < 1.00 ) {","\t\tif ( mod(gl_FragCoord.x + gl_FragCoord.y, 10.0) == 0.0) {","\t\t\tgl_FragColor = vec4( uLineColor1, 1.0 );","\t\t}","\t}","\tif ( length(lightWeighting) < 0.75 ) {","\t\tif (mod(gl_FragCoord.x - gl_FragCoord.y, 10.0) == 0.0) {","\t\t\tgl_FragColor = vec4( uLineColor2, 1.0 );","\t\t}","\t}","\tif ( length(lightWeighting) < 0.50 ) {","\t\tif (mod(gl_FragCoord.x + gl_FragCoord.y - 5.0, 10.0) == 0.0) {","\t\t\tgl_FragColor = vec4( uLineColor3, 1.0 );","\t\t}","\t}","\tif ( length(lightWeighting) < 0.3465 ) {","\t\tif (mod(gl_FragCoord.x - gl_FragCoord.y - 5.0, 10.0) == 0.0) {","\t\t\tgl_FragColor = vec4( uLineColor4, 1.0 );","\t}","\t}","}"].join("\n")},ToonShaderDotted={uniforms:{uDirLightPos:{value:new Vector3},uDirLightColor:{value:new Color(15658734)},uAmbientLightColor:{value:new Color(328965)},uBaseColor:{value:new Color(16777215)},uLineColor1:{value:new Color(0)}},vertexShader:["varying vec3 vNormal;","void main() {","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","\tvNormal = normalize( normalMatrix * normal );","}"].join("\n"),fragmentShader:["uniform vec3 uBaseColor;","uniform vec3 uLineColor1;","uniform vec3 uLineColor2;","uniform vec3 uLineColor3;","uniform vec3 uLineColor4;","uniform vec3 uDirLightPos;","uniform vec3 uDirLightColor;","uniform vec3 uAmbientLightColor;","varying vec3 vNormal;","void main() {","float directionalLightWeighting = max( dot( normalize(vNormal), uDirLightPos ), 0.0);","vec3 lightWeighting = uAmbientLightColor + uDirLightColor * directionalLightWeighting;","gl_FragColor = vec4( uBaseColor, 1.0 );","if ( length(lightWeighting) < 1.00 ) {","\t\tif ( ( mod(gl_FragCoord.x, 4.001) + mod(gl_FragCoord.y, 4.0) ) > 6.00 ) {","\t\t\tgl_FragColor = vec4( uLineColor1, 1.0 );","\t\t}","\t}","\tif ( length(lightWeighting) < 0.50 ) {","\t\tif ( ( mod(gl_FragCoord.x + 2.0, 4.001) + mod(gl_FragCoord.y + 2.0, 4.0) ) > 6.00 ) {","\t\t\tgl_FragColor = vec4( uLineColor1, 1.0 );","\t\t}","\t}","}"].join("\n")},TranslucentShader={uniforms:UniformsUtils.merge([UniformsLib.common,UniformsLib.lights,{color:{value:new Color(16777215)},diffuse:{value:new Color(16777215)},specular:{value:new Color(16777215)},emissive:{value:new Color(0)},opacity:{value:1},shininess:{value:1},thicknessMap:{value:null},thicknessColor:{value:new Color(16777215)},thicknessDistortion:{value:.1},thicknessAmbient:{value:0},thicknessAttenuation:{value:.1},thicknessPower:{value:2},thicknessScale:{value:10}}]),vertexShader:["varying vec3 vNormal;","varying vec2 vUv;","varying vec3 vViewPosition;",ShaderChunk.common,"void main() {","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","\tvViewPosition = -mvPosition.xyz;","\tvNormal = normalize( normalMatrix * normal );","\tvUv = uv;","\tgl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["#define USE_UV","#define USE_MAP","#define PHONG","#define TRANSLUCENT","#include <common>","#include <bsdfs>","#include <uv_pars_fragment>","#include <map_pars_fragment>","#include <lights_phong_pars_fragment>","varying vec3 vColor;","uniform vec3 diffuse;","uniform vec3 specular;","uniform vec3 emissive;","uniform float opacity;","uniform float shininess;","uniform sampler2D thicknessMap;","uniform float thicknessPower;","uniform float thicknessScale;","uniform float thicknessDistortion;","uniform float thicknessAmbient;","uniform float thicknessAttenuation;","uniform vec3 thicknessColor;",ShaderChunk.lights_pars_begin,"void RE_Direct_Scattering(const in IncidentLight directLight, const in vec2 uv, const in GeometricContext geometry, inout ReflectedLight reflectedLight) {","\tvec3 thickness = thicknessColor * texture2D(thicknessMap, uv).r;","\tvec3 scatteringHalf = normalize(directLight.direction + (geometry.normal * thicknessDistortion));","\tfloat scatteringDot = pow(saturate(dot(geometry.viewDir, -scatteringHalf)), thicknessPower) * thicknessScale;","\tvec3 scatteringIllu = (scatteringDot + thicknessAmbient) * thickness;","\treflectedLight.directDiffuse += scatteringIllu * thicknessAttenuation * directLight.color;","}","void main() {","\tvec3 normal = normalize( vNormal );","\tvec3 viewerDirection = normalize( vViewPosition );","\tvec4 diffuseColor = vec4( diffuse, opacity );","\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );",ShaderChunk.map_fragment,ShaderChunk.color_fragment,ShaderChunk.specularmap_fragment,"\tvec3 totalEmissiveRadiance = emissive;",ShaderChunk.lights_phong_fragment,"\tGeometricContext geometry;","\tgeometry.position = - vViewPosition;","\tgeometry.normal = normal;","\tgeometry.viewDir = normalize( vViewPosition );","\tIncidentLight directLight;","\t#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )","\t\tPointLight pointLight;","\t\t#pragma unroll_loop","\t\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {","\t\t \tpointLight = pointLights[ i ];","\t\t \tgetPointDirectLightIrradiance( pointLight, geometry, directLight );","\t\t\t#ifdef USE_SHADOWMAP","\t\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;","\t\t\t#endif","\t\t\tRE_Direct( directLight, geometry, material, reflectedLight );","\t\t\t#if defined( TRANSLUCENT ) && defined( USE_UV )","\t\t\tRE_Direct_Scattering(directLight, vUv, geometry, reflectedLight);","\t\t\t#endif","\t\t}","\t\t#endif","\t#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )","\t\tDirectionalLight directionalLight;","\t\t#pragma unroll_loop","\t\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {","\t\t\tdirectionalLight = directionalLights[ i ];","\t\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );","\t\t\t#ifdef USE_SHADOWMAP","\t\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;","\t\t\t#endif","\t\t\tRE_Direct( directLight, geometry, material, reflectedLight );","\t\t\t#if defined( TRANSLUCENT ) && defined( USE_UV )","\t\t\tRE_Direct_Scattering(directLight, vUv, geometry, reflectedLight);","\t\t\t#endif","\t\t}","\t#endif","\t#if defined( RE_IndirectDiffuse )","\t\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );","\t\t#if ( NUM_HEMI_LIGHTS > 0 )","\t\t\t#pragma unroll_loop","\t\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {","\t\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );","\t\t\t}","\t\t#endif","\t#endif","\t#if defined( RE_IndirectSpecular )","\t\tvec3 radiance = vec3( 0.0 );","\t\tvec3 clearcoatRadiance = vec3( 0.0 );","\t#endif",ShaderChunk.lights_fragment_end,"\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;","\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );",ShaderChunk.encodings_fragment,"}"].join("\n")},TriangleBlurShader={uniforms:{texture:{value:null},delta:{value:new Vector2(1,1)}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","#define ITERATIONS 10.0","uniform sampler2D texture;","uniform vec2 delta;","varying vec2 vUv;","void main() {","\tvec4 color = vec4( 0.0 );","\tfloat total = 0.0;","\tfloat offset = rand( vUv );","\tfor ( float t = -ITERATIONS; t <= ITERATIONS; t ++ ) {","\t\tfloat percent = ( t + offset - 0.5 ) / ITERATIONS;","\t\tfloat weight = 1.0 - abs( percent );","\t\tcolor += texture2D( texture, vUv + delta * percent ) * weight;","\t\ttotal += weight;","\t}","\tgl_FragColor = color / total;","}"].join("\n")},VerticalBlurShader={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float v;","varying vec2 vUv;","void main() {","\tvec4 sum = vec4( 0.0 );","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;","\tgl_FragColor = sum;","}"].join("\n")},VerticalTiltShiftShader={uniforms:{tDiffuse:{value:null},v:{value:1/512},r:{value:.35}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float v;","uniform float r;","varying vec2 vUv;","void main() {","\tvec4 sum = vec4( 0.0 );","\tfloat vv = v * abs( r - vUv.y );","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * vv ) ) * 0.051;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * vv ) ) * 0.0918;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * vv ) ) * 0.12245;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * vv ) ) * 0.1531;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * vv ) ) * 0.1531;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * vv ) ) * 0.12245;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * vv ) ) * 0.0918;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * vv ) ) * 0.051;","\tgl_FragColor = sum;","}"].join("\n")},VignetteShader={uniforms:{tDiffuse:{value:null},offset:{value:1},darkness:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float offset;","uniform float darkness;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tvec2 uv = ( vUv - vec2( 0.5 ) ) * vec2( offset );","\tgl_FragColor = vec4( mix( texel.rgb, vec3( 1.0 - darkness ), dot( uv, uv ) ), texel.a );","}"].join("\n")},VolumeRenderShader1={uniforms:{u_size:{value:new Vector3(1,1,1)},u_renderstyle:{value:0},u_renderthreshold:{value:.5},u_clim:{value:new Vector2(1,1)},u_data:{value:null},u_cmdata:{value:null}},vertexShader:["\t\tvarying vec4 v_nearpos;","\t\tvarying vec4 v_farpos;","\t\tvarying vec3 v_position;","\t\tmat4 inversemat(mat4 m) {","\t\t\t\tfloat","\t\t\t\ta00 = m[0][0], a01 = m[0][1], a02 = m[0][2], a03 = m[0][3],","\t\t\t\ta10 = m[1][0], a11 = m[1][1], a12 = m[1][2], a13 = m[1][3],","\t\t\t\ta20 = m[2][0], a21 = m[2][1], a22 = m[2][2], a23 = m[2][3],","\t\t\t\ta30 = m[3][0], a31 = m[3][1], a32 = m[3][2], a33 = m[3][3],","\t\t\t\tb00 = a00 * a11 - a01 * a10,","\t\t\t\tb01 = a00 * a12 - a02 * a10,","\t\t\t\tb02 = a00 * a13 - a03 * a10,","\t\t\t\tb03 = a01 * a12 - a02 * a11,","\t\t\t\tb04 = a01 * a13 - a03 * a11,","\t\t\t\tb05 = a02 * a13 - a03 * a12,","\t\t\t\tb06 = a20 * a31 - a21 * a30,","\t\t\t\tb07 = a20 * a32 - a22 * a30,","\t\t\t\tb08 = a20 * a33 - a23 * a30,","\t\t\t\tb09 = a21 * a32 - a22 * a31,","\t\t\t\tb10 = a21 * a33 - a23 * a31,","\t\t\t\tb11 = a22 * a33 - a23 * a32,","\t\t\t\tdet = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;","\t\treturn mat4(","\t\t\t\ta11 * b11 - a12 * b10 + a13 * b09,","\t\t\t\ta02 * b10 - a01 * b11 - a03 * b09,","\t\t\t\ta31 * b05 - a32 * b04 + a33 * b03,","\t\t\t\ta22 * b04 - a21 * b05 - a23 * b03,","\t\t\t\ta12 * b08 - a10 * b11 - a13 * b07,","\t\t\t\ta00 * b11 - a02 * b08 + a03 * b07,","\t\t\t\ta32 * b02 - a30 * b05 - a33 * b01,","\t\t\t\ta20 * b05 - a22 * b02 + a23 * b01,","\t\t\t\ta10 * b10 - a11 * b08 + a13 * b06,","\t\t\t\ta01 * b08 - a00 * b10 - a03 * b06,","\t\t\t\ta30 * b04 - a31 * b02 + a33 * b00,","\t\t\t\ta21 * b02 - a20 * b04 - a23 * b00,","\t\t\t\ta11 * b07 - a10 * b09 - a12 * b06,","\t\t\t\ta00 * b09 - a01 * b07 + a02 * b06,","\t\t\t\ta31 * b01 - a30 * b03 - a32 * b00,","\t\t\t\ta20 * b03 - a21 * b01 + a22 * b00) / det;","\t\t}","\t\tvoid main() {","\t\t\t\tmat4 viewtransformf = modelViewMatrix;","\t\t\t\tmat4 viewtransformi = inversemat(modelViewMatrix);","\t\t\t\tvec4 position4 = vec4(position, 1.0);","\t\t\t\tvec4 pos_in_cam = viewtransformf * position4;","\t\t\t\tpos_in_cam.z = -pos_in_cam.w;","\t\t\t\tv_nearpos = viewtransformi * pos_in_cam;","\t\t\t\tpos_in_cam.z = pos_in_cam.w;","\t\t\t\tv_farpos = viewtransformi * pos_in_cam;","\t\t\t\tv_position = position;","\t\t\t\tgl_Position = projectionMatrix * viewMatrix * modelMatrix * position4;","\t\t}"].join("\n"),fragmentShader:["\t\tprecision highp float;","\t\tprecision mediump sampler3D;","\t\tuniform vec3 u_size;","\t\tuniform int u_renderstyle;","\t\tuniform float u_renderthreshold;","\t\tuniform vec2 u_clim;","\t\tuniform sampler3D u_data;","\t\tuniform sampler2D u_cmdata;","\t\tvarying vec3 v_position;","\t\tvarying vec4 v_nearpos;","\t\tvarying vec4 v_farpos;","\t\tconst int MAX_STEPS = 887;\t// 887 for 512^3, 1774 for 1024^3","\t\tconst int REFINEMENT_STEPS = 4;","\t\tconst float relative_step_size = 1.0;","\t\tconst vec4 ambient_color = vec4(0.2, 0.4, 0.2, 1.0);","\t\tconst vec4 diffuse_color = vec4(0.8, 0.2, 0.2, 1.0);","\t\tconst vec4 specular_color = vec4(1.0, 1.0, 1.0, 1.0);","\t\tconst float shininess = 40.0;","\t\tvoid cast_mip(vec3 start_loc, vec3 step, int nsteps, vec3 view_ray);","\t\tvoid cast_iso(vec3 start_loc, vec3 step, int nsteps, vec3 view_ray);","\t\tfloat sample1(vec3 texcoords);","\t\tvec4 apply_colormap(float val);","\t\tvec4 add_lighting(float val, vec3 loc, vec3 step, vec3 view_ray);","\t\tvoid main() {","\t\t\t\tvec3 farpos = v_farpos.xyz / v_farpos.w;","\t\t\t\tvec3 nearpos = v_nearpos.xyz / v_nearpos.w;","\t\t\t\tvec3 view_ray = normalize(nearpos.xyz - farpos.xyz);","\t\t\t\tfloat distance = dot(nearpos - v_position, view_ray);","\t\t\t\tdistance = max(distance, min((-0.5 - v_position.x) / view_ray.x,","\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(u_size.x - 0.5 - v_position.x) / view_ray.x));","\t\t\t\tdistance = max(distance, min((-0.5 - v_position.y) / view_ray.y,","\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(u_size.y - 0.5 - v_position.y) / view_ray.y));","\t\t\t\tdistance = max(distance, min((-0.5 - v_position.z) / view_ray.z,","\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(u_size.z - 0.5 - v_position.z) / view_ray.z));","\t\t\t\tvec3 front = v_position + view_ray * distance;","\t\t\t\tint nsteps = int(-distance / relative_step_size + 0.5);","\t\t\t\tif ( nsteps < 1 )","\t\t\t\t\t\tdiscard;","\t\t\t\tvec3 step = ((v_position - front) / u_size) / float(nsteps);","\t\t\t\tvec3 start_loc = front / u_size;","\t\t\t\tif (u_renderstyle == 0)","\t\t\t\t\t\tcast_mip(start_loc, step, nsteps, view_ray);","\t\t\t\telse if (u_renderstyle == 1)","\t\t\t\t\t\tcast_iso(start_loc, step, nsteps, view_ray);","\t\t\t\tif (gl_FragColor.a < 0.05)","\t\t\t\t\t\tdiscard;","\t\t}","\t\tfloat sample1(vec3 texcoords) {","\t\t\t\t/* Sample float value from a 3D texture. Assumes intensity data. */","\t\t\t\treturn texture(u_data, texcoords.xyz).r;","\t\t}","\t\tvec4 apply_colormap(float val) {","\t\t\t\tval = (val - u_clim[0]) / (u_clim[1] - u_clim[0]);","\t\t\t\treturn texture2D(u_cmdata, vec2(val, 0.5));","\t\t}","\t\tvoid cast_mip(vec3 start_loc, vec3 step, int nsteps, vec3 view_ray) {","\t\t\t\tfloat max_val = -1e6;","\t\t\t\tint max_i = 100;","\t\t\t\tvec3 loc = start_loc;","\t\t\t\tfor (int iter=0; iter<MAX_STEPS; iter++) {","\t\t\t\t\t\tif (iter >= nsteps)","\t\t\t\t\t\t\t\tbreak;","\t\t\t\t\t\tfloat val = sample1(loc);","\t\t\t\t\t\tif (val > max_val) {","\t\t\t\t\t\t\t\tmax_val = val;","\t\t\t\t\t\t\t\tmax_i = iter;","\t\t\t\t\t\t}","\t\t\t\t\t\tloc += step;","\t\t\t\t}","\t\t\t\tvec3 iloc = start_loc + step * (float(max_i) - 0.5);","\t\t\t\tvec3 istep = step / float(REFINEMENT_STEPS);","\t\t\t\tfor (int i=0; i<REFINEMENT_STEPS; i++) {","\t\t\t\t\t\tmax_val = max(max_val, sample1(iloc));","\t\t\t\t\t\tiloc += istep;","\t\t\t\t}","\t\t\t\tgl_FragColor = apply_colormap(max_val);","\t\t}","\t\tvoid cast_iso(vec3 start_loc, vec3 step, int nsteps, vec3 view_ray) {","\t\t\t\tgl_FragColor = vec4(0.0);\t// init transparent","\t\t\t\tvec4 color3 = vec4(0.0);\t// final color","\t\t\t\tvec3 dstep = 1.5 / u_size;\t// step to sample derivative","\t\t\t\tvec3 loc = start_loc;","\t\t\t\tfloat low_threshold = u_renderthreshold - 0.02 * (u_clim[1] - u_clim[0]);","\t\t\t\tfor (int iter=0; iter<MAX_STEPS; iter++) {","\t\t\t\t\t\tif (iter >= nsteps)","\t\t\t\t\t\t\t\tbreak;","\t\t\t\t\t\tfloat val = sample1(loc);","\t\t\t\t\t\tif (val > low_threshold) {","\t\t\t\t\t\t\t\tvec3 iloc = loc - 0.5 * step;","\t\t\t\t\t\t\t\tvec3 istep = step / float(REFINEMENT_STEPS);","\t\t\t\t\t\t\t\tfor (int i=0; i<REFINEMENT_STEPS; i++) {","\t\t\t\t\t\t\t\t\t\tval = sample1(iloc);","\t\t\t\t\t\t\t\t\t\tif (val > u_renderthreshold) {","\t\t\t\t\t\t\t\t\t\t\t\tgl_FragColor = add_lighting(val, iloc, dstep, view_ray);","\t\t\t\t\t\t\t\t\t\t\t\treturn;","\t\t\t\t\t\t\t\t\t\t}","\t\t\t\t\t\t\t\t\t\tiloc += istep;","\t\t\t\t\t\t\t\t}","\t\t\t\t\t\t}","\t\t\t\t\t\tloc += step;","\t\t\t\t}","\t\t}","\t\tvec4 add_lighting(float val, vec3 loc, vec3 step, vec3 view_ray)","\t\t{","\t\t\t\tvec3 V = normalize(view_ray);","\t\t\t\tvec3 N;","\t\t\t\tfloat val1, val2;","\t\t\t\tval1 = sample1(loc + vec3(-step[0], 0.0, 0.0));","\t\t\t\tval2 = sample1(loc + vec3(+step[0], 0.0, 0.0));","\t\t\t\tN[0] = val1 - val2;","\t\t\t\tval = max(max(val1, val2), val);","\t\t\t\tval1 = sample1(loc + vec3(0.0, -step[1], 0.0));","\t\t\t\tval2 = sample1(loc + vec3(0.0, +step[1], 0.0));","\t\t\t\tN[1] = val1 - val2;","\t\t\t\tval = max(max(val1, val2), val);","\t\t\t\tval1 = sample1(loc + vec3(0.0, 0.0, -step[2]));","\t\t\t\tval2 = sample1(loc + vec3(0.0, 0.0, +step[2]));","\t\t\t\tN[2] = val1 - val2;","\t\t\t\tval = max(max(val1, val2), val);","\t\t\t\tfloat gm = length(N); // gradient magnitude","\t\t\t\tN = normalize(N);","\t\t\t\tfloat Nselect = float(dot(N, V) > 0.0);","\t\t\t\tN = (2.0 * Nselect - 1.0) * N;\t// ==\tNselect * N - (1.0-Nselect)*N;","\t\t\t\tvec4 ambient_color = vec4(0.0, 0.0, 0.0, 0.0);","\t\t\t\tvec4 diffuse_color = vec4(0.0, 0.0, 0.0, 0.0);","\t\t\t\tvec4 specular_color = vec4(0.0, 0.0, 0.0, 0.0);","\t\t\t\tfor (int i=0; i<1; i++)","\t\t\t\t{","\t\t\t\t\t\tvec3 L = normalize(view_ray);\t//lightDirs[i];","\t\t\t\t\t\tfloat lightEnabled = float( length(L) > 0.0 );","\t\t\t\t\t\tL = normalize(L + (1.0 - lightEnabled));","\t\t\t\t\t\tfloat lambertTerm = clamp(dot(N, L), 0.0, 1.0);","\t\t\t\t\t\tvec3 H = normalize(L+V); // Halfway vector","\t\t\t\t\t\tfloat specularTerm = pow(max(dot(H, N), 0.0), shininess);","\t\t\t\t\t\tfloat mask1 = lightEnabled;","\t\t\t\t\t\tambient_color +=\tmask1 * ambient_color;\t// * gl_LightSource[i].ambient;","\t\t\t\t\t\tdiffuse_color +=\tmask1 * lambertTerm;","\t\t\t\t\t\tspecular_color += mask1 * specularTerm * specular_color;","\t\t\t\t}","\t\t\t\tvec4 final_color;","\t\t\t\tvec4 color = apply_colormap(val);","\t\t\t\tfinal_color = color * (ambient_color + diffuse_color) + specular_color;","\t\t\t\tfinal_color.a = color.a;","\t\t\t\treturn final_color;","\t\t}"].join("\n")},WaterRefractionShader={uniforms:{color:{value:null},time:{value:0},tDiffuse:{value:null},tDudv:{value:null},textureMatrix:{value:null}},vertexShader:["uniform mat4 textureMatrix;","varying vec2 vUv;","varying vec4 vUvRefraction;","void main() {","\tvUv = uv;","\tvUvRefraction = textureMatrix * vec4( position, 1.0 );","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform float time;","uniform sampler2D tDiffuse;","uniform sampler2D tDudv;","varying vec2 vUv;","varying vec4 vUvRefraction;","float blendOverlay( float base, float blend ) {","\treturn( base < 0.5 ? ( 2.0 * base * blend ) : ( 1.0 - 2.0 * ( 1.0 - base ) * ( 1.0 - blend ) ) );","}","vec3 blendOverlay( vec3 base, vec3 blend ) {","\treturn vec3( blendOverlay( base.r, blend.r ), blendOverlay( base.g, blend.g ),blendOverlay( base.b, blend.b ) );","}","void main() {"," float waveStrength = 0.1;"," float waveSpeed = 0.03;","\tvec2 distortedUv = texture2D( tDudv, vec2( vUv.x + time * waveSpeed, vUv.y ) ).rg * waveStrength;","\tdistortedUv = vUv.xy + vec2( distortedUv.x, distortedUv.y + time * waveSpeed );","\tvec2 distortion = ( texture2D( tDudv, distortedUv ).rg * 2.0 - 1.0 ) * waveStrength;"," vec4 uv = vec4( vUvRefraction );"," uv.xy += distortion;","\tvec4 base = texture2DProj( tDiffuse, uv );","\tgl_FragColor = vec4( blendOverlay( base.rgb, color ), 1.0 );","}"].join("\n")},BufferGeometryUtils={computeTangents:function(e){var a=e.index,d=e.attributes;if(null!==a&&void 0!==d.position&&void 0!==d.normal&&void 0!==d.uv){var v=a.array,g=d.position.array,C=d.normal.array,w=d.uv.array,_=g.length/3;void 0===d.tangent&&e.setAttribute("tangent",new BufferAttribute(new Float32Array(4*_),4));for(var x=d.tangent.array,b=[],A=[],E=0;E<_;E++)b[E]=new Vector3,A[E]=new Vector3;var R=new Vector3,O=new Vector3,D=new Vector3,F=new Vector2,L=new Vector2,I=new Vector2,V=new Vector3,z=new Vector3,X=e.groups;0===X.length&&(X=[{start:0,count:v.length}]),E=0;for(var re=X.length;E<re;++E)for(var k=te=(j=X[E]).start,U=te+j.count;k<U;k+=3)H(v[k+0],v[k+1],v[k+2]);var me,fe,ge,K=new Vector3,ee=new Vector3,Q=new Vector3,oe=new Vector3;for(E=0,re=X.length;E<re;++E){var j,te;for(k=te=(j=X[E]).start,U=te+j.count;k<U;k+=3)$(v[k+0]),$(v[k+1]),$(v[k+2])}}else console.warn("BufferGeometry: Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");function H(ue,Y,Z){R.fromArray(g,3*ue),O.fromArray(g,3*Y),D.fromArray(g,3*Z),F.fromArray(w,2*ue),L.fromArray(w,2*Y),I.fromArray(w,2*Z),O.sub(R),D.sub(R),L.sub(F),I.sub(F);var se=1/(L.x*I.y-I.x*L.y);!isFinite(se)||(V.copy(O).multiplyScalar(I.y).addScaledVector(D,-L.y).multiplyScalar(se),z.copy(D).multiplyScalar(L.x).addScaledVector(O,-I.x).multiplyScalar(se),b[ue].add(V),b[Y].add(V),b[Z].add(V),A[ue].add(z),A[Y].add(z),A[Z].add(z))}function $(ue){Q.fromArray(C,3*ue),oe.copy(Q),K.copy(fe=b[ue]),K.sub(Q.multiplyScalar(Q.dot(fe))).normalize(),ee.crossVectors(oe,fe),ge=ee.dot(A[ue]),me=ge<0?-1:1,x[4*ue]=K.x,x[4*ue+1]=K.y,x[4*ue+2]=K.z,x[4*ue+3]=me}},mergeBufferGeometries:function(e,a){for(var d=null!==e[0].index,v=new Set(Object.keys(e[0].attributes)),g=new Set(Object.keys(e[0].morphAttributes)),C={},w={},_=e[0].morphTargetsRelative,x=new BufferGeometry,b=0,A=0;A<e.length;++A){var E=e[A];if(d!==(null!==E.index))return null;for(var R in E.attributes){if(!v.has(R))return null;void 0===C[R]&&(C[R]=[]),C[R].push(E.attributes[R])}if(_!==E.morphTargetsRelative)return null;for(var R in E.morphAttributes){if(!g.has(R))return null;void 0===w[R]&&(w[R]=[]),w[R].push(E.morphAttributes[R])}if(x.userData.mergedUserData=x.userData.mergedUserData||[],x.userData.mergedUserData.push(E.userData),a){var O;if(d)O=E.index.count;else{if(void 0===E.attributes.position)return null;O=E.attributes.position.count}x.addGroup(b,O,A),b+=O}}if(d){var D=0,F=[];for(A=0;A<e.length;++A){for(var L=e[A].index,I=0;I<L.count;++I)F.push(L.getX(I)+D);D+=e[A].attributes.position.count}x.setIndex(F)}for(var R in C){var V=this.mergeBufferAttributes(C[R]);if(!V)return null;x.setAttribute(R,V)}for(var R in w){var z=w[R][0].length;if(0===z)break;for(x.morphAttributes=x.morphAttributes||{},x.morphAttributes[R]=[],A=0;A<z;++A){var H=[];for(I=0;I<w[R].length;++I)H.push(w[R][I][A]);var X=this.mergeBufferAttributes(H);if(!X)return null;x.morphAttributes[R].push(X)}}return x},mergeBufferAttributes:function(e){for(var a,d,v,g=0,C=0;C<e.length;++C){var w=e[C];if(w.isInterleavedBufferAttribute||(void 0===a&&(a=w.array.constructor),a!==w.array.constructor)||(void 0===d&&(d=w.itemSize),d!==w.itemSize)||(void 0===v&&(v=w.normalized),v!==w.normalized))return null;g+=w.array.length}var _=new a(g),x=0;for(C=0;C<e.length;++C)_.set(e[C].array,x),x+=e[C].array.length;return new BufferAttribute(_,d,v)},interleaveAttributes:function(e){for(var a,d=0,v=0,g=0,C=e.length;g<C;++g){var w=e[g];if(void 0===a&&(a=w.array.constructor),a!==w.array.constructor)return console.warn("AttributeBuffers of different types cannot be interleaved"),null;d+=w.array.length,v+=w.itemSize}var _=new InterleavedBuffer(new a(d),v),x=0,b=[],A=["getX","getY","getZ","getW"],E=["setX","setY","setZ","setW"],R=0;for(C=e.length;R<C;R++){var O=(w=e[R]).itemSize,D=w.count,F=new InterleavedBufferAttribute(_,O,x,w.normalized);b.push(F),x+=O;for(var L=0;L<D;L++)for(var I=0;I<O;I++)F[E[I]](L,w[A[I]](L))}return b},estimateBytesUsed:function(e){var a=0;for(var d in e.attributes){var v=e.getAttribute(d);a+=v.count*v.itemSize*v.array.BYTES_PER_ELEMENT}var g=e.getIndex();return a+(g?g.count*g.itemSize*g.array.BYTES_PER_ELEMENT:0)},mergeVertices:function(e,a){void 0===a&&(a=1e-4),a=Math.max(a,Number.EPSILON);for(var d={},v=e.getIndex(),g=e.getAttribute("position"),C=v?v.count:g.count,w=0,_=Object.keys(e.attributes),x={},b={},A=[],E=["getX","getY","getZ","getW"],R=0,O=_.length;R<O;R++)x[D=_[R]]=[],(F=e.morphAttributes[D])&&(b[D]=new Array(F.length).fill().map(function(){return[]}));var L=Math.log10(1/a),I=Math.pow(10,L);for(R=0;R<C;R++){var V=v?v.getX(R):R,z="",H=0;for(O=_.length;H<O;H++)for(var re=(X=e.getAttribute(D=_[H])).itemSize,j=0;j<re;j++)z+=~~(X[E[j]](V)*I)+",";if(z in d)A.push(d[z]);else{for(H=0,O=_.length;H<O;H++){var X=e.getAttribute(D=_[H]),F=e.morphAttributes[D],te=(re=X.itemSize,x[D]),J=b[D];for(j=0;j<re;j++){var k=E[j];if(te.push(X[k](V)),F)for(var U=0,K=F.length;U<K;U++)J[U].push(F[U][k](V))}}d[z]=w,A.push(w),w++}}var ee=e.clone();for(R=0,O=_.length;R<O;R++){var D,Q=e.getAttribute(D=_[R]);if(X=new BufferAttribute(new Q.array.constructor(x[D]),Q.itemSize,Q.normalized),ee.setAttribute(D,X),D in b)for(H=0;H<b[D].length;H++){var me=e.morphAttributes[D][H],fe=new BufferAttribute(new me.array.constructor(b[D][H]),me.itemSize,me.normalized);ee.morphAttributes[D][H]=fe}}return ee.setIndex(A),ee},toTrianglesDrawMode:function(e,a){if(a===TrianglesDrawMode)return console.warn("BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(a===TriangleFanDrawMode||a===TriangleStripDrawMode){var d=e.getIndex();if(null===d){var v=[],g=e.getAttribute("position");if(void 0===g)return console.error("BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var C=0;C<g.count;C++)v.push(C);e.setIndex(v),d=e.getIndex()}var w=d.count-2,_=[];if(a===TriangleFanDrawMode)for(C=1;C<=w;C++)_.push(d.getX(0)),_.push(d.getX(C)),_.push(d.getX(C+1));else for(C=0;C<w;C++)C%2==0?(_.push(d.getX(C)),_.push(d.getX(C+1)),_.push(d.getX(C+2))):(_.push(d.getX(C+2)),_.push(d.getX(C+1)),_.push(d.getX(C)));_.length/3!==w&&console.error("BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var x=e.clone();return x.setIndex(_),x.clearGroups(),x}return console.error("BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",a),e}},GeometryCompressionUtils={compressNormals:function(e,a){e.geometry||console.error("Mesh must contain geometry. ");var d=e.geometry.attributes.normal;if(d||console.error("Geometry must contain normal attribute. "),!d.isPacked){3!=d.itemSize&&console.error("normal.itemSize is not 3, which cannot be encoded. ");var C,v=d.array,g=d.count;if("DEFAULT"==a){C=new Uint8Array(3*g);for(var w=0;w<v.length;w+=3){var _;_=this.EncodingFuncs.defaultEncode(v[w],v[w+1],v[w+2],1),C[w+0]=_[0],C[w+1]=_[1],C[w+2]=_[2]}e.geometry.setAttribute("normal",new BufferAttribute(C,3,!0)),e.geometry.attributes.normal.bytes=1*C.length}else if("OCT1Byte"==a){C=new Int8Array(2*g);for(var x=0;x<v.length;x+=3){var b;b=this.EncodingFuncs.octEncodeBest(v[x],v[x+1],v[x+2],1),C[x/3*2+0]=b[0],C[x/3*2+1]=b[1]}e.geometry.setAttribute("normal",new BufferAttribute(C,2,!0)),e.geometry.attributes.normal.bytes=1*C.length}else if("OCT2Byte"==a){C=new Int16Array(2*g);for(var A=0;A<v.length;A+=3){var E;E=this.EncodingFuncs.octEncodeBest(v[A],v[A+1],v[A+2],2),C[A/3*2+0]=E[0],C[A/3*2+1]=E[1]}e.geometry.setAttribute("normal",new BufferAttribute(C,2,!0)),e.geometry.attributes.normal.bytes=2*C.length}else if("ANGLES"==a){C=new Uint16Array(2*g);for(var R=0;R<v.length;R+=3){var O;O=this.EncodingFuncs.anglesEncode(v[R],v[R+1],v[R+2]),C[R/3*2+0]=O[0],C[R/3*2+1]=O[1]}e.geometry.setAttribute("normal",new BufferAttribute(C,2,!0)),e.geometry.attributes.normal.bytes=2*C.length}else console.error("Unrecognized encoding method, should be `DEFAULT` or `ANGLES` or `OCT`. ");e.geometry.attributes.normal.needsUpdate=!0,e.geometry.attributes.normal.isPacked=!0,e.geometry.attributes.normal.packingMethod=a,e.material instanceof PackedPhongMaterial||(e.material=(new PackedPhongMaterial).copy(e.material)),"ANGLES"==a&&(e.material.defines.USE_PACKED_NORMAL=0),"OCT1Byte"==a&&(e.material.defines.USE_PACKED_NORMAL=1),"OCT2Byte"==a&&(e.material.defines.USE_PACKED_NORMAL=1),"DEFAULT"==a&&(e.material.defines.USE_PACKED_NORMAL=2)}},compressPositions:function(e){e.geometry||console.error("Mesh must contain geometry. ");var a=e.geometry.attributes.position;if(a||console.error("Geometry must contain position attribute. "),!a.isPacked){3!=a.itemSize&&console.error("position.itemSize is not 3, which cannot be packed. ");var C=this.EncodingFuncs.quantizedEncode(a.array,2),w=C.quantized,_=C.decodeMat;null==e.geometry.boundingBox&&e.geometry.computeBoundingBox(),null==e.geometry.boundingSphere&&e.geometry.computeBoundingSphere(),e.geometry.setAttribute("position",new BufferAttribute(w,3)),e.geometry.attributes.position.isPacked=!0,e.geometry.attributes.position.needsUpdate=!0,e.geometry.attributes.position.bytes=2*w.length,e.material instanceof PackedPhongMaterial||(e.material=(new PackedPhongMaterial).copy(e.material)),e.material.defines.USE_PACKED_POSITION=0,e.material.uniforms.quantizeMatPos.value=_,e.material.uniforms.quantizeMatPos.needsUpdate=!0}},compressUvs:function(e){e.geometry||console.error("Mesh must contain geometry property. ");var a=e.geometry.attributes.uv;if(a||console.error("Geometry must contain uv attribute. "),!a.isPacked){for(var d={min:1/0,max:-1/0},v=a.array,C=0;C<v.length;C++)d.min=Math.min(d.min,v[C]),d.max=Math.max(d.max,v[C]);var w;if(d.min>=-1&&d.max<=1){w=new Uint16Array(v.length);for(var _=0;_<v.length;_+=2){var x=this.EncodingFuncs.defaultEncode(v[_],v[_+1],0,2);w[_]=x[0],w[_+1]=x[1]}e.geometry.setAttribute("uv",new BufferAttribute(w,2,!0)),e.geometry.attributes.uv.isPacked=!0,e.geometry.attributes.uv.needsUpdate=!0,e.geometry.attributes.uv.bytes=2*w.length,e.material instanceof PackedPhongMaterial||(e.material=(new PackedPhongMaterial).copy(e.material)),e.material.defines.USE_PACKED_UV=0}else w=this.EncodingFuncs.quantizedEncodeUV(v,2),e.geometry.setAttribute("uv",new BufferAttribute(w.quantized,2)),e.geometry.attributes.uv.isPacked=!0,e.geometry.attributes.uv.needsUpdate=!0,e.geometry.attributes.uv.bytes=2*w.quantized.length,e.material instanceof PackedPhongMaterial||(e.material=(new PackedPhongMaterial).copy(e.material)),e.material.defines.USE_PACKED_UV=1,e.material.uniforms.quantizeMatUV.value=w.decodeMat,e.material.uniforms.quantizeMatUV.needsUpdate=!0}},EncodingFuncs:{defaultEncode:function(e,a,d,v){if(1==v){var g=Math.round(.5*(e+1)*255),C=Math.round(.5*(a+1)*255),w=Math.round(.5*(d+1)*255);return new Uint8Array([g,C,w])}if(2==v){var _=Math.round(.5*(e+1)*65535),x=Math.round(.5*(a+1)*65535),b=Math.round(.5*(d+1)*65535);return new Uint16Array([_,x,b])}console.error("number of bytes must be 1 or 2")},defaultDecode:function(e,a){return 1==a?[e[0]/255*2-1,e[1]/255*2-1,e[2]/255*2-1]:2==a?[e[0]/65535*2-1,e[1]/65535*2-1,e[2]/65535*2-1]:void console.error("number of bytes must be 1 or 2")},anglesEncode:function(e,a,d){var v=parseInt(.5*(1+Math.atan2(a,e)/Math.PI)*65535),g=parseInt(.5*(1+d)*65535);return new Uint16Array([v,g])},octEncodeBest:function(e,a,d,v){var g,C,w,_,x;return w=g=b(e,a,d,"floor","floor"),C=A(g),_=x=E(e,a,d,C),C=A(g=b(e,a,d,"ceil","floor")),(_=E(e,a,d,C))>x&&(w=g,x=_),C=A(g=b(e,a,d,"floor","ceil")),(_=E(e,a,d,C))>x&&(w=g,x=_),C=A(g=b(e,a,d,"ceil","ceil")),(_=E(e,a,d,C))>x&&(w=g,x=_),w;function b(R,O,D,F,L){var I=R/(Math.abs(R)+Math.abs(O)+Math.abs(D)),V=O/(Math.abs(R)+Math.abs(O)+Math.abs(D));if(d<0){var z,H;z=(1-Math.abs(V))*(I>=0?1:-1),H=(1-Math.abs(I))*(V>=0?1:-1),I=z,V=H;var X=1-Math.abs(I)-Math.abs(V);X>0&&(X+=.001,I+=I>0?X/2:-X/2,V+=V>0?X/2:-X/2)}return 1==v?new Int8Array([Math[F](127.5*I+(I<0?1:0)),Math[L](127.5*V+(V<0?1:0))]):2==v?new Int16Array([Math[F](32767.5*I+(I<0?1:0)),Math[L](32767.5*V+(V<0?1:0))]):void 0}function A(R){var O=R[0],D=R[1];1==v?(O/=O<0?127:128,D/=D<0?127:128):2==v&&(O/=O<0?32767:32768,D/=D<0?32767:32768);var F=1-Math.abs(O)-Math.abs(D);if(F<0){var L=O;O=(1-Math.abs(D))*(O>=0?1:-1),D=(1-Math.abs(L))*(D>=0?1:-1)}var I=Math.sqrt(O*O+D*D+F*F);return[O/I,D/I,F/I]}function E(R,O,D,F){return R*F[0]+O*F[1]+D*F[2]}},quantizedEncode:function(e,a){var d,v;1==a?(d=new Uint8Array(e.length),v=255):2==a?(d=new Uint16Array(e.length),v=65535):console.error("number of bytes error! ");var g=new Matrix4,C=new Float32Array(3),w=new Float32Array(3);C[0]=C[1]=C[2]=Number.MAX_VALUE,w[0]=w[1]=w[2]=-Number.MAX_VALUE;for(var _=0;_<e.length;_+=3)C[0]=Math.min(C[0],e[_+0]),C[1]=Math.min(C[1],e[_+1]),C[2]=Math.min(C[2],e[_+2]),w[0]=Math.max(w[0],e[_+0]),w[1]=Math.max(w[1],e[_+1]),w[2]=Math.max(w[2],e[_+2]);g.scale(new Vector3((w[0]-C[0])/v,(w[1]-C[1])/v,(w[2]-C[2])/v)),g.elements[12]=C[0],g.elements[13]=C[1],g.elements[14]=C[2],g.transpose();for(var x=new Float32Array([w[0]!==C[0]?v/(w[0]-C[0]):0,w[1]!==C[1]?v/(w[1]-C[1]):0,w[2]!==C[2]?v/(w[2]-C[2]):0]),b=0;b<e.length;b+=3)d[b+0]=Math.floor((e[b+0]-C[0])*x[0]),d[b+1]=Math.floor((e[b+1]-C[1])*x[1]),d[b+2]=Math.floor((e[b+2]-C[2])*x[2]);return{quantized:d,decodeMat:g}},quantizedEncodeUV:function(e,a){var d,v;1==a?(d=new Uint8Array(e.length),v=255):2==a?(d=new Uint16Array(e.length),v=65535):console.error("number of bytes error! ");var g=new Matrix3,C=new Float32Array(2),w=new Float32Array(2);C[0]=C[1]=Number.MAX_VALUE,w[0]=w[1]=-Number.MAX_VALUE;for(var _=0;_<e.length;_+=2)C[0]=Math.min(C[0],e[_+0]),C[1]=Math.min(C[1],e[_+1]),w[0]=Math.max(w[0],e[_+0]),w[1]=Math.max(w[1],e[_+1]);g.scale((w[0]-C[0])/v,(w[1]-C[1])/v),g.elements[6]=C[0],g.elements[7]=C[1],g.transpose();for(var x=new Float32Array([w[0]!==C[0]?v/(w[0]-C[0]):0,w[1]!==C[1]?v/(w[1]-C[1]):0]),b=0;b<e.length;b+=2)d[b+0]=Math.floor((e[b+0]-C[0])*x[0]),d[b+1]=Math.floor((e[b+1]-C[1])*x[1]);return{quantized:d,decodeMat:g}}}};function PackedPhongMaterial(s){MeshPhongMaterial.call(this),this.defines={},this.type="PackedPhongMaterial",this.uniforms=UniformsUtils.merge([ShaderLib.phong.uniforms,{quantizeMatPos:{value:null},quantizeMatUV:{value:null}}]),this.vertexShader=["#define PHONG","varying vec3 vViewPosition;","#ifndef FLAT_SHADED","varying vec3 vNormal;","#endif",ShaderChunk.common,ShaderChunk.uv_pars_vertex,ShaderChunk.uv2_pars_vertex,ShaderChunk.displacementmap_pars_vertex,ShaderChunk.envmap_pars_vertex,ShaderChunk.color_pars_vertex,ShaderChunk.fog_pars_vertex,ShaderChunk.morphtarget_pars_vertex,ShaderChunk.skinning_pars_vertex,ShaderChunk.shadowmap_pars_vertex,ShaderChunk.logdepthbuf_pars_vertex,ShaderChunk.clipping_planes_pars_vertex,"#ifdef USE_PACKED_NORMAL\n            #if USE_PACKED_NORMAL == 0\n                vec3 decodeNormal(vec3 packedNormal)\n                { \n                    float x = packedNormal.x * 2.0 - 1.0;\n                    float y = packedNormal.y * 2.0 - 1.0;\n                    vec2 scth = vec2(sin(x * PI), cos(x * PI));\n                    vec2 scphi = vec2(sqrt(1.0 - y * y), y); \n                    return normalize( vec3(scth.y * scphi.x, scth.x * scphi.x, scphi.y) );\n                } \n            #endif\n\n            #if USE_PACKED_NORMAL == 1\n                vec3 decodeNormal(vec3 packedNormal)\n                { \n                    vec3 v = vec3(packedNormal.xy, 1.0 - abs(packedNormal.x) - abs(packedNormal.y));\n                    if (v.z < 0.0) \n                    {\n                        v.xy = (1.0 - abs(v.yx)) * vec2((v.x >= 0.0) ? +1.0 : -1.0, (v.y >= 0.0) ? +1.0 : -1.0);\n                    }\n                    return normalize(v);\n                }\n            #endif\n\n            #if USE_PACKED_NORMAL == 2\n                vec3 decodeNormal(vec3 packedNormal)\n                {\n                    vec3 v = (packedNormal * 2.0) - 1.0;\n                    return normalize(v);\n                }\n            #endif\n        #endif","#ifdef USE_PACKED_POSITION\n            #if USE_PACKED_POSITION == 0\n                uniform mat4 quantizeMatPos;\n            #endif\n        #endif","#ifdef USE_PACKED_UV\n            #if USE_PACKED_UV == 1\n                uniform mat3 quantizeMatUV;\n            #endif\n        #endif","#ifdef USE_PACKED_UV\n            #if USE_PACKED_UV == 0\n                vec2 decodeUV(vec2 packedUV)\n                {\n                    vec2 uv = (packedUV * 2.0) - 1.0;\n                    return uv;\n                }\n            #endif\n\n            #if USE_PACKED_UV == 1\n                vec2 decodeUV(vec2 packedUV)\n                {\n                    vec2 uv = ( vec3(packedUV, 1.0) * quantizeMatUV ).xy;\n                    return uv;\n                }\n            #endif\n        #endif","void main() {",ShaderChunk.uv_vertex,"\n        #ifdef USE_UV\n            #ifdef USE_PACKED_UV\n                vUv = decodeUV(vUv);\n            #endif\n        #endif\n        ",ShaderChunk.uv2_vertex,ShaderChunk.color_vertex,ShaderChunk.beginnormal_vertex,"#ifdef USE_PACKED_NORMAL\n            objectNormal = decodeNormal(objectNormal);\n        #endif\n\n        #ifdef USE_TANGENT\n            vec3 objectTangent = vec3( tangent.xyz );\n        #endif\n        ",ShaderChunk.morphnormal_vertex,ShaderChunk.skinbase_vertex,ShaderChunk.skinnormal_vertex,ShaderChunk.defaultnormal_vertex,"#ifndef FLAT_SHADED","vNormal = normalize( transformedNormal );","#endif",ShaderChunk.begin_vertex,"#ifdef USE_PACKED_POSITION\n            #if USE_PACKED_POSITION == 0\n                transformed = ( vec4(transformed, 1.0) * quantizeMatPos ).xyz;\n            #endif\n        #endif",ShaderChunk.morphtarget_vertex,ShaderChunk.skinning_vertex,ShaderChunk.displacementmap_vertex,ShaderChunk.project_vertex,ShaderChunk.logdepthbuf_vertex,ShaderChunk.clipping_planes_vertex,"vViewPosition = - mvPosition.xyz;",ShaderChunk.worldpos_vertex,ShaderChunk.envmap_vertex,ShaderChunk.shadowmap_vertex,ShaderChunk.fog_vertex,"}"].join("\n"),this.fragmentShader=["#define PHONG","uniform vec3 diffuse;","uniform vec3 emissive;","uniform vec3 specular;","uniform float shininess;","uniform float opacity;",ShaderChunk.common,ShaderChunk.packing,ShaderChunk.dithering_pars_fragment,ShaderChunk.color_pars_fragment,ShaderChunk.uv_pars_fragment,ShaderChunk.uv2_pars_fragment,ShaderChunk.map_pars_fragment,ShaderChunk.alphamap_pars_fragment,ShaderChunk.aomap_pars_fragment,ShaderChunk.lightmap_pars_fragment,ShaderChunk.emissivemap_pars_fragment,ShaderChunk.envmap_common_pars_fragment,ShaderChunk.envmap_pars_fragment,ShaderChunk.cube_uv_reflection_fragment,ShaderChunk.fog_pars_fragment,ShaderChunk.bsdfs,ShaderChunk.lights_pars_begin,ShaderChunk.lights_phong_pars_fragment,ShaderChunk.shadowmap_pars_fragment,ShaderChunk.bumpmap_pars_fragment,ShaderChunk.normalmap_pars_fragment,ShaderChunk.specularmap_pars_fragment,ShaderChunk.logdepthbuf_pars_fragment,ShaderChunk.clipping_planes_pars_fragment,"void main() {",ShaderChunk.clipping_planes_fragment,"vec4 diffuseColor = vec4( diffuse, opacity );","ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );","vec3 totalEmissiveRadiance = emissive;",ShaderChunk.logdepthbuf_fragment,ShaderChunk.map_fragment,ShaderChunk.color_fragment,ShaderChunk.alphamap_fragment,ShaderChunk.alphatest_fragment,ShaderChunk.specularmap_fragment,ShaderChunk.normal_fragment_begin,ShaderChunk.normal_fragment_maps,ShaderChunk.emissivemap_fragment,ShaderChunk.lights_phong_fragment,ShaderChunk.lights_fragment_begin,ShaderChunk.lights_fragment_maps,ShaderChunk.lights_fragment_end,ShaderChunk.aomap_fragment,"vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;",ShaderChunk.envmap_fragment,"gl_FragColor = vec4( outgoingLight, diffuseColor.a );",ShaderChunk.tonemapping_fragment,ShaderChunk.encodings_fragment,ShaderChunk.fog_fragment,ShaderChunk.premultiplied_alpha_fragment,ShaderChunk.dithering_fragment,"}"].join("\n"),this.setValues(s)}PackedPhongMaterial.prototype=Object.create(MeshPhongMaterial.prototype);var GeometryUtils={hilbert2D:function(e,a,d,v,g,C,w){e=void 0!==e?e:new Vector3(0,0,0);var _=(a=void 0!==a?a:10)/2,x=(d=void 0!==d?d:1,v=void 0!==v?v:0,g=void 0!==g?g:1,C=void 0!==C?C:2,w=void 0!==w?w:3,[new Vector3(e.x-_,e.y,e.z-_),new Vector3(e.x-_,e.y,e.z+_),new Vector3(e.x+_,e.y,e.z+_),new Vector3(e.x+_,e.y,e.z-_)]),b=[x[v],x[g],x[C],x[w]];if(0<=--d){var A=[];return Array.prototype.push.apply(A,GeometryUtils.hilbert2D(b[0],_,d,v,w,C,g)),Array.prototype.push.apply(A,GeometryUtils.hilbert2D(b[1],_,d,v,g,C,w)),Array.prototype.push.apply(A,GeometryUtils.hilbert2D(b[2],_,d,v,g,C,w)),Array.prototype.push.apply(A,GeometryUtils.hilbert2D(b[3],_,d,C,g,v,w)),A}return b},hilbert3D:function(e,a,d,v,g,C,w,_,x,b,A){e=void 0!==e?e:new Vector3(0,0,0);var E=(a=void 0!==a?a:10)/2,R=(d=void 0!==d?d:1,v=void 0!==v?v:0,g=void 0!==g?g:1,C=void 0!==C?C:2,w=void 0!==w?w:3,_=void 0!==_?_:4,x=void 0!==x?x:5,b=void 0!==b?b:6,A=void 0!==A?A:7,[new Vector3(e.x-E,e.y+E,e.z-E),new Vector3(e.x-E,e.y+E,e.z+E),new Vector3(e.x-E,e.y-E,e.z+E),new Vector3(e.x-E,e.y-E,e.z-E),new Vector3(e.x+E,e.y-E,e.z-E),new Vector3(e.x+E,e.y-E,e.z+E),new Vector3(e.x+E,e.y+E,e.z+E),new Vector3(e.x+E,e.y+E,e.z-E)]),O=[R[v],R[g],R[C],R[w],R[_],R[x],R[b],R[A]];if(--d>=0){var D=[];return Array.prototype.push.apply(D,GeometryUtils.hilbert3D(O[0],E,d,v,w,_,A,b,x,C,g)),Array.prototype.push.apply(D,GeometryUtils.hilbert3D(O[1],E,d,v,A,b,g,C,x,_,w)),Array.prototype.push.apply(D,GeometryUtils.hilbert3D(O[2],E,d,v,A,b,g,C,x,_,w)),Array.prototype.push.apply(D,GeometryUtils.hilbert3D(O[3],E,d,C,w,v,g,b,A,_,x)),Array.prototype.push.apply(D,GeometryUtils.hilbert3D(O[4],E,d,C,w,v,g,b,A,_,x)),Array.prototype.push.apply(D,GeometryUtils.hilbert3D(O[5],E,d,_,w,C,x,b,g,v,A)),Array.prototype.push.apply(D,GeometryUtils.hilbert3D(O[6],E,d,_,w,C,x,b,g,v,A)),Array.prototype.push.apply(D,GeometryUtils.hilbert3D(O[7],E,d,b,x,C,g,v,w,_,A)),D}return O}},RoughnessMipmapper=function(){var w,s=((w=new RawShaderMaterial({uniforms:{roughnessMap:{value:null},normalMap:{value:null},texelSize:{value:new Vector2(1,1)}},vertexShader:"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nvarying vec2 vUv;\nvoid main() {\n    vUv = uv;\n    gl_Position = vec4( position, 1.0 );\n}\n              ",fragmentShader:"\nprecision mediump float;\nprecision mediump int;\nvarying vec2 vUv;\nuniform sampler2D roughnessMap;\nuniform sampler2D normalMap;\nuniform vec2 texelSize;\n\n#define ENVMAP_TYPE_CUBE_UV\nvec4 envMapTexelToLinear(vec4 a){return a;}\n#include <cube_uv_reflection_fragment>\n\nfloat roughnessToVariance(float roughness) {\n  float variance = 0.0;\n  if (roughness >= r1) {\n    variance = (r0 - roughness) * (v1 - v0) / (r0 - r1) + v0;\n  } else if (roughness >= r4) {\n    variance = (r1 - roughness) * (v4 - v1) / (r1 - r4) + v1;\n  } else if (roughness >= r5) {\n    variance = (r4 - roughness) * (v5 - v4) / (r4 - r5) + v4;\n  } else {\n    float roughness2 = roughness * roughness;\n    variance = 1.79 * roughness2 * roughness2;\n  }\n  return variance;\n}\nfloat varianceToRoughness(float variance) {\n  float roughness = 0.0;\n  if (variance >= v1) {\n    roughness = (v0 - variance) * (r1 - r0) / (v0 - v1) + r0;\n  } else if (variance >= v4) {\n    roughness = (v1 - variance) * (r4 - r1) / (v1 - v4) + r1;\n  } else if (variance >= v5) {\n    roughness = (v4 - variance) * (r5 - r4) / (v4 - v5) + r4;\n  } else {\n    roughness = pow(0.559 * variance, 0.25);// 0.559 = 1.0 / 1.79\n  }\n  return roughness;\n}\n\nvoid main() {\n    gl_FragColor = texture2D(roughnessMap, vUv, -1.0);\n    if (texelSize.x == 0.0) return;\n    float roughness = gl_FragColor.g;\n    float variance = roughnessToVariance(roughness);\n    vec3 avgNormal;\n    for (float x = -1.0; x < 2.0; x += 2.0) {\n    for (float y = -1.0; y < 2.0; y += 2.0) {\n        vec2 uv = vUv + vec2(x, y) * 0.25 * texelSize;\n        avgNormal += normalize(texture2D(normalMap, uv, -1.0).xyz - 0.5);\n    }\n    }\n    variance += 1.0 - 0.25 * length(avgNormal);\n    gl_FragColor.g = varianceToRoughness(variance);\n}\n              ",blending:NoBlending,depthTest:!1,depthWrite:!1})).type="RoughnessMipmapper",w),e=new Scene;e.add(new Mesh(new PlaneBufferGeometry(2,2),s));var a=new OrthographicCamera(0,1,0,1,0,1),d=null,v=null,g=function(_){(v=_).compile(e,a)};return g.prototype={constructor:g,generateMipmaps:function(_){var x=_.roughnessMap,b=_.normalMap;if(null!=x&&null!=b&&x.generateMipmaps&&!_.userData.roughnessUpdated){_.userData.roughnessUpdated=!0;var A=Math.max(x.image.width,b.image.width),E=Math.max(x.image.height,b.image.height);if(MathUtils.isPowerOfTwo(A)&&MathUtils.isPowerOfTwo(E)){var R=v.getRenderTarget(),O=v.autoClear;if(v.autoClear=!1,(null==d||d.width!==A||d.height!==E)&&(null!=d&&d.dispose(),(d=new WebGLRenderTarget(A,E,{depthBuffer:!1,stencilBuffer:!1})).scissorTest=!0),A!==x.image.width||E!==x.image.height){var D=new WebGLRenderTarget(A,E,{minFilter:LinearMipMapLinearFilter,depthBuffer:!1,stencilBuffer:!1});D.texture.generateMipmaps=!0,v.setRenderTarget(D),_.roughnessMap=D.texture,_.metalnessMap==x&&(_.metalnessMap=_.roughnessMap),_.aoMap==x&&(_.aoMap=_.roughnessMap)}s.uniforms.roughnessMap.value=x,s.uniforms.normalMap.value=b;for(var F=new Vector2(0,0),L=s.uniforms.texelSize.value,I=0;A>=1&&E>=1;++I,A/=2,E/=2)L.set(1/A,1/E),0==I&&L.set(0,0),d.viewport.set(F.x,F.y,A,E),d.scissor.set(F.x,F.y,A,E),v.setRenderTarget(d),v.render(e,a),v.copyFramebufferToTexture(F,_.roughnessMap,I),s.uniforms.roughnessMap.value=_.roughnessMap;x!==_.roughnessMap&&x.dispose(),v.setRenderTarget(R),v.autoClear=O}}},dispose:function(){s.dispose(),e.children[0].geometry.dispose(),null!=d&&d.dispose()}},g}(),SceneUtils={createMultiMaterialObject:function(e,a){for(var d=new Group,v=0,g=a.length;v<g;v++)d.add(new Mesh(e,a[v]));return d},detach:function(e,a,d){console.warn("SceneUtils: detach() has been deprecated. Use scene.attach( child ) instead."),d.attach(e)},attach:function(e,a,d){console.warn("SceneUtils: attach() has been deprecated. Use parent.attach( child ) instead."),d.attach(e)}},ShadowMapViewer=function(e){var v,a=this,d=void 0!==e.name&&""!==e.name,C=new OrthographicCamera(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,1,10);C.position.set(0,0,2);var R,O,w=new Scene,_=UnpackDepthRGBAShader,x=UniformsUtils.clone(_.uniforms),b=new ShaderMaterial({uniforms:x,vertexShader:_.vertexShader,fragmentShader:_.fragmentShader}),E=new Mesh(new PlaneBufferGeometry(256,256),b);if(w.add(E),d){var D=(R=document.createElement("canvas")).getContext("2d");D.font="Bold 20px Arial";var F=D.measureText(e.name).width;R.width=F,R.height=25,D.font="Bold 20px Arial",D.fillStyle="rgba( 255, 0, 0, 1 )",D.fillText(e.name,0,20);var L=new Texture(R);L.magFilter=LinearFilter,L.minFilter=LinearFilter,L.needsUpdate=!0;var I=new MeshBasicMaterial({map:L,side:DoubleSide});I.transparent=!0;var V=new PlaneBufferGeometry(R.width,R.height);O=new Mesh(V,I),w.add(O)}this.enabled=!0,this.size={width:256,height:256,set:function(X,re){this.width=X,this.height=re,E.scale.set(this.width/256,this.height/256,1),a.position.set(a.position.x,a.position.y)}},this.position={x:10,y:10,set:function(X,re){this.x=X,this.y=re,E.position.set(-window.innerWidth/2+a.size.width/2+this.x,window.innerHeight/2-a.size.height/2-this.y,0),d&&O.position.set(E.position.x,E.position.y-a.size.height/2+R.height/2,0)}},this.render=function(H){this.enabled&&(x.tDiffuse.value=e.shadow.map.texture,v=H.autoClear,H.autoClear=!1,H.clearDepth(),H.render(w,C),H.autoClear=v)},this.updateForWindowResize=function(){this.enabled&&(C.left=window.innerWidth/-2,C.right=window.innerWidth/2,C.top=window.innerHeight/2,C.bottom=window.innerHeight/-2,C.updateProjectionMatrix(),this.update())},this.update=function(){this.position.set(this.position.x,this.position.y),this.size.set(this.size.width,this.size.height)},this.update()};ShadowMapViewer.prototype.constructor=ShadowMapViewer;var _vector$8=new Vector3,_boneMatrix=new Matrix4,_matrixWorldInv=new Matrix4;function getBoneList(s){var e=[];s&&s.isBone&&e.push(s);for(var a=0;a<s.children.length;a++)e.push.apply(e,getBoneList(s.children[a]));return e}function SkeletonHelper(s){for(var e=getBoneList(s),a=new BufferGeometry,d=[],v=[],g=new Color(0,0,1),C=new Color(0,1,0),w=0;w<e.length;w++){var _=e[w];_.parent&&_.parent.isBone&&(d.push(0,0,0),d.push(0,0,0),v.push(g.r,g.g,g.b),v.push(C.r,C.g,C.b))}a.setAttribute("position",new Float32BufferAttribute(d,3)),a.setAttribute("color",new Float32BufferAttribute(v,3));var x=new LineBasicMaterial({vertexColors:VertexColors,depthTest:!1,depthWrite:!1,transparent:!0});LineSegments.call(this,a,x),this.root=s,this.bones=e,this.matrix=s.matrixWorld,this.matrixAutoUpdate=!1}SkeletonHelper.prototype=Object.create(LineSegments.prototype),SkeletonHelper.prototype.constructor=SkeletonHelper,SkeletonHelper.prototype.updateMatrixWorld=function(s){var e=this.bones,a=this.geometry,d=a.getAttribute("position");_matrixWorldInv.getInverse(this.root.matrixWorld);for(var v=0,g=0;v<e.length;v++){var C=e[v];C.parent&&C.parent.isBone&&(_boneMatrix.multiplyMatrices(_matrixWorldInv,C.matrixWorld),_vector$8.setFromMatrixPosition(_boneMatrix),d.setXYZ(g,_vector$8.x,_vector$8.y,_vector$8.z),_boneMatrix.multiplyMatrices(_matrixWorldInv,C.parent.matrixWorld),_vector$8.setFromMatrixPosition(_boneMatrix),d.setXYZ(g+1,_vector$8.x,_vector$8.y,_vector$8.z),g+=2)}a.getAttribute("position").needsUpdate=!0,Object3D.prototype.updateMatrixWorld.call(this,s)};var SkeletonUtils={retarget:function(){var s=new Vector3,e=new Quaternion,a=new Vector3,d=new Matrix4,v=new Matrix4,g=new Matrix4;return function(C,w,_){(_=_||{}).preserveMatrix=void 0===_.preserveMatrix||_.preserveMatrix,_.preservePosition=void 0===_.preservePosition||_.preservePosition,_.preserveHipPosition=void 0!==_.preserveHipPosition&&_.preserveHipPosition,_.useTargetMatrix=void 0!==_.useTargetMatrix&&_.useTargetMatrix,_.hip=void 0!==_.hip?_.hip:"hip",_.names=_.names||{};var A,E,R,O,D,F,x=w.isObject3D?w.skeleton.bones:this.getBones(w),b=C.isObject3D?C.skeleton.bones:this.getBones(C);if(C.isObject3D?C.skeleton.pose():(_.useTargetMatrix=!0,_.preserveMatrix=!1),_.preservePosition)for(D=[],F=0;F<b.length;F++)D.push(b[F].position.clone());if(_.preserveMatrix)for(C.updateMatrixWorld(),C.matrixWorld.identity(),F=0;F<C.children.length;++F)C.children[F].updateMatrixWorld(!0);if(_.offsets)for(A=[],F=0;F<b.length;++F)R=_.names[(E=b[F]).name]||E.name,_.offsets&&_.offsets[R]&&(E.matrix.multiply(_.offsets[R]),E.matrix.decompose(E.position,E.quaternion,E.scale),E.updateMatrixWorld()),A.push(E.matrixWorld.clone());for(F=0;F<b.length;++F){if(O=this.getBoneByName(R=_.names[(E=b[F]).name]||E.name,x),g.copy(E.matrixWorld),O){if(O.updateMatrixWorld(),_.useTargetMatrix?v.copy(O.matrixWorld):(v.getInverse(C.matrixWorld),v.multiply(O.matrixWorld)),a.setFromMatrixScale(v),v.scale(a.set(1/a.x,1/a.y,1/a.z)),g.makeRotationFromQuaternion(e.setFromRotationMatrix(v)),C.isObject3D){var L=b.indexOf(E),I=A?A[L]:d.getInverse(C.skeleton.boneInverses[L]);g.multiply(I)}g.copyPosition(v)}E.parent&&E.parent.isBone?(E.matrix.getInverse(E.parent.matrixWorld),E.matrix.multiply(g)):E.matrix.copy(g),_.preserveHipPosition&&R===_.hip&&E.matrix.setPosition(s.set(0,E.position.y,0)),E.matrix.decompose(E.position,E.quaternion,E.scale),E.updateMatrixWorld()}if(_.preservePosition)for(F=0;F<b.length;++F)(R=_.names[(E=b[F]).name]||E.name)!==_.hip&&E.position.copy(D[F]);_.preserveMatrix&&C.updateMatrixWorld(!0)}}(),retargetClip:function(e,a,d,v){(v=v||{}).useFirstFramePosition=void 0!==v.useFirstFramePosition&&v.useFirstFramePosition,v.fps=void 0!==v.fps?v.fps:30,v.names=v.names||[],a.isObject3D||(a=this.getHelperFromSkeleton(a));var A,E,O,D,F,L,g=Math.round(d.duration*(v.fps/1e3)*1e3),C=1/v.fps,w=[],_=new AnimationMixer(a),x=this.getBones(e.skeleton),b=[];for(_.clipAction(d).play(),_.update(0),a.updateMatrixWorld(),F=0;F<g;++F){var I=F*C;for(this.retarget(e,a,v),L=0;L<x.length;++L)this.getBoneByName(D=v.names[x[L].name]||x[L].name,a.skeleton)&&(E=x[L],O=b[L]=b[L]||{bone:E},v.hip===D&&(O.pos||(O.pos={times:new Float32Array(g),values:new Float32Array(3*g)}),v.useFirstFramePosition&&(0===F&&(A=E.position.clone()),E.position.sub(A)),O.pos.times[F]=I,E.position.toArray(O.pos.values,3*F)),O.quat||(O.quat={times:new Float32Array(g),values:new Float32Array(4*g)}),O.quat.times[F]=I,E.quaternion.toArray(O.quat.values,4*F));_.update(C),a.updateMatrixWorld()}for(F=0;F<b.length;++F)(O=b[F])&&(O.pos&&w.push(new VectorKeyframeTrack(".bones["+O.bone.name+"].position",O.pos.times,O.pos.values)),w.push(new QuaternionKeyframeTrack(".bones["+O.bone.name+"].quaternion",O.quat.times,O.quat.values)));return _.uncacheAction(d),new AnimationClip(d.name,-1,w)},getHelperFromSkeleton:function(e){var a=new SkeletonHelper(e.bones[0]);return a.skeleton=e,a},getSkeletonOffsets:function(){var s=new Vector3,e=new Vector3,a=new Vector3,d=new Vector3,v=new Vector2,g=new Vector2;return function(C,w,_){(_=_||{}).hip=void 0!==_.hip?_.hip:"hip",_.names=_.names||{},w.isObject3D||(w=this.getHelperFromSkeleton(w));var O,D,F,L,x=Object.keys(_.names),b=Object.values(_.names),A=w.isObject3D?w.skeleton.bones:this.getBones(w),E=C.isObject3D?C.skeleton.bones:this.getBones(C),R=[];for(C.skeleton.pose(),L=0;L<E.length;++L)if((D=this.getBoneByName(F=_.names[(O=E[L]).name]||O.name,A))&&F!==_.hip){var I=this.getNearestBone(O.parent,x),V=this.getNearestBone(D.parent,b);I.updateMatrixWorld(),V.updateMatrixWorld(),s.setFromMatrixPosition(I.matrixWorld),e.setFromMatrixPosition(O.matrixWorld),a.setFromMatrixPosition(V.matrixWorld),d.setFromMatrixPosition(D.matrixWorld),v.subVectors(new Vector2(e.x,e.y),new Vector2(s.x,s.y)).normalize(),g.subVectors(new Vector2(d.x,d.y),new Vector2(a.x,a.y)).normalize();var z=v.angle()-g.angle(),H=(new Matrix4).makeRotationFromEuler(new Euler(0,0,z));O.matrix.multiply(H),O.matrix.decompose(O.position,O.quaternion,O.scale),O.updateMatrixWorld(),R[F]=H}return R}}(),renameBones:function(e,a){for(var d=this.getBones(e),v=0;v<d.length;++v){var g=d[v];a[g.name]&&(g.name=a[g.name])}return this},getBones:function(e){return Array.isArray(e)?e:e.bones},getBoneByName:function(e,a){for(var d=0,v=this.getBones(a);d<v.length;d++)if(e===v[d].name)return v[d]},getNearestBone:function(e,a){for(;e.isBone;){if(-1!==a.indexOf(e.name))return e;e=e.parent}},findBoneTrackData:function(e,a){for(var d=/\[(.*)\]\.(.*)/,v={name:e},g=0;g<a.length;++g){var C=d.exec(a[g].name);C&&e===C[1]&&(v[C[2]]=g)}return v},getEqualsBonesNames:function(e,a){var d=this.getBones(e),v=this.getBones(a),g=[];e:for(var C=0;C<d.length;C++)for(var w=d[C].name,_=0;_<v.length;_++)if(w===v[_].name){g.push(w);continue e}return g},clone:function(e){var a=new Map,d=new Map,v=e.clone();return parallelTraverse(e,v,function(g,C){a.set(C,g),d.set(g,C)}),v.traverse(function(g){if(g.isSkinnedMesh){var C=g,w=a.get(g),_=w.skeleton.bones;C.skeleton=w.skeleton.clone(),C.bindMatrix.copy(w.bindMatrix),C.skeleton.bones=_.map(function(x){return d.get(x)}),C.bind(C.skeleton,C.bindMatrix)}}),v}};function parallelTraverse(s,e,a){a(s,e);for(var d=0;d<s.children.length;d++)parallelTraverse(s.children[d],e.children[d],a)}var TypedArrayUtils={quicksortIP:function(s,e,a){for(var A,E,d=[],v=-1,g=0,C=s.length/e-1,w=0,_=0,x=0,b=function(L,I){for(L*=e,I*=e,x=0;x<e;x++)w=s[L+x],s[L+x]=s[I+x],s[I+x]=w},R=new Float32Array(e),O=new Float32Array(e);;)if(C-g<=25){for(E=g+1;E<=C;E++){for(_=0;_<e;_++)R[_]=s[E*e+_];for(A=E-1;A>=g&&s[A*e+a]>R[a];){for(_=0;_<e;_++)s[(A+1)*e+_]=s[A*e+_];A--}for(_=0;_<e;_++)s[(A+1)*e+_]=R[_]}if(-1==v)break;C=d[v--],g=d[v--]}else{for(E=C,b(g+C>>1,A=g+1),s[g*e+a]>s[C*e+a]&&b(g,C),s[A*e+a]>s[C*e+a]&&b(A,C),s[g*e+a]>s[A*e+a]&&b(g,A),_=0;_<e;_++)O[_]=s[A*e+_];for(;;){do{A++}while(s[A*e+a]<O[a]);do{E--}while(s[E*e+a]>O[a]);if(E<A)break;b(A,E)}for(_=0;_<e;_++)s[(g+1)*e+_]=s[E*e+_],s[E*e+_]=O[_];C-A+1>=E-g?(d[++v]=A,d[++v]=C,C=E-1):(d[++v]=g,d[++v]=E-1,g=A)}return s},Kdtree:function(s,e,a){var d=this,v=0,g=function(_,x){return _.subarray(x*a,x*a+a)};this.root=function C(w,_,x,b){var E,R,A=_%a,O=w.length/a;return _>v&&(v=_),0===O?null:1===O?new d.Node(g(w,0),_,x,b):(TypedArrayUtils.quicksortIP(w,a,A),E=Math.floor(O/2),(R=new d.Node(g(w,E),_,x,E+b)).left=C(w.subarray(0,E*a),_+1,R,b),R.right=C(w.subarray((E+1)*a,w.length),_+1,R,b+E+1),R)}(s,0,null,0),this.getMaxDepth=function(){return v},this.nearest=function(w,_,x){var b,A,E;if(E=new TypedArrayUtils.Kdtree.BinaryHeap(function(O){return-O[1]}),x)for(b=0;b<_;b+=1)E.push([null,x]);for(function R(O){var D,I,V,z,F=O.depth%a,L=e(w,O.obj),H=[];function X(re,j){E.push([re,j]),E.size()>_&&E.pop()}for(z=0;z<a;z+=1)H[z]=z===O.depth%a?w[z]:O.obj[z];I=e(H,O.obj),null!==O.right||null!==O.left?(R(D=null===O.right?O.left:null===O.left?O.right:w[F]<O.obj[F]?O.left:O.right),(E.size()<_||L<E.peek()[1])&&X(O,L),(E.size()<_||Math.abs(I)<E.peek()[1])&&null!==(V=D===O.left?O.right:O.left)&&R(V)):(E.size()<_||L<E.peek()[1])&&X(O,L)}(d.root),A=[],b=0;b<_;b+=1)E.content[b][0]&&A.push([E.content[b][0],E.content[b][1]]);return A}}};TypedArrayUtils.Kdtree.prototype.Node=function(s,e,a,d){this.obj=s,this.left=null,this.right=null,this.parent=a,this.depth=e,this.pos=d},TypedArrayUtils.Kdtree.BinaryHeap=function(s){this.content=[],this.scoreFunction=s},TypedArrayUtils.Kdtree.BinaryHeap.prototype={push:function(e){this.content.push(e),this.bubbleUp(this.content.length-1)},pop:function(){var e=this.content[0],a=this.content.pop();return this.content.length>0&&(this.content[0]=a,this.sinkDown(0)),e},peek:function(){return this.content[0]},remove:function(e){for(var a=this.content.length,d=0;d<a;d++)if(this.content[d]==e){var v=this.content.pop();return void(d!=a-1&&(this.content[d]=v,this.scoreFunction(v)<this.scoreFunction(e)?this.bubbleUp(d):this.sinkDown(d)))}throw new Error("Node not found.")},size:function(){return this.content.length},bubbleUp:function(e){for(var a=this.content[e];e>0;){var d=Math.floor((e+1)/2)-1,v=this.content[d];if(!(this.scoreFunction(a)<this.scoreFunction(v)))break;this.content[d]=a,this.content[e]=v,e=d}},sinkDown:function(e){for(var a=this.content.length,d=this.content[e],v=this.scoreFunction(d);;){var g=2*(e+1),C=g-1,w=null;if(C<a){var x=this.scoreFunction(this.content[C]);x<v&&(w=C)}if(g<a&&this.scoreFunction(this.content[g])<(null===w?v:x)&&(w=g),null===w)break;this.content[e]=this.content[w],this.content[w]=d,e=w}}};var UVsDebug=function(e,a){var v=new Vector2,g=new Vector2,C=[new Vector2,new Vector2,new Vector2],w=[],_=document.createElement("canvas"),x=a||1024,b=a||1024;_.width=x,_.height=b;var A=_.getContext("2d");if(A.lineWidth=2,A.strokeStyle="rgba( 0, 0, 0, 1.0 )",A.textAlign="center",A.fillStyle="rgba( 255, 255, 255, 1.0 )",A.fillRect(0,0,x,b),e.isGeometry)for(var E=e.faces,R=e.faceVertexUvs[0],O=0,D=R.length;O<D;O++){var F=R[O];(w=E[O])[0]=w.a,w[1]=w.b,w[2]=w.c,C[0].copy(F[0]),C[1].copy(F[1]),C[2].copy(F[2]),V(w,C,O)}else{var L=e.index,I=e.attributes.uv;if(L)for(O=0,D=L.count;O<D;O+=3)w[0]=L.getX(O),w[1]=L.getX(O+1),w[2]=L.getX(O+2),C[0].fromBufferAttribute(I,w[0]),C[1].fromBufferAttribute(I,w[1]),C[2].fromBufferAttribute(I,w[2]),V(w,C,O/3);else for(O=0,D=I.count;O<D;O+=3)w[0]=O,w[1]=O+1,w[2]=O+2,C[0].fromBufferAttribute(I,w[0]),C[1].fromBufferAttribute(I,w[1]),C[2].fromBufferAttribute(I,w[2]),V(w,C,O/3)}return _;function V(z,H,X){A.beginPath(),v.set(0,0);for(var re=0,j=H.length;re<j;re++)v.x+=(te=H[re]).x,v.y+=te.y,0===re?A.moveTo(te.x*x,(1-te.y)*b):A.lineTo(te.x*x,(1-te.y)*b);for(A.closePath(),A.stroke(),v.divideScalar(H.length),A.font="12pt Arial bold",A.fillStyle="rgba( 0, 0, 0, 1.0 )",A.fillText(X,v.x*x,(1-v.y)*b),v.x>.95&&A.fillText(X,v.x%1*x,(1-v.y)*b),A.font="8pt Arial bold",A.fillStyle="rgba( 0, 0, 0, 1.0 )",re=0,j=H.length;re<j;re++){var te;g.addVectors(v,te=H[re]).divideScalar(2);var J=z[re];A.fillText("abc"[re]+J,g.x*x,(1-g.y)*b),g.x>.95&&A.fillText("abc"[re]+J,g.x%1*x,(1-g.y)*b)}}},WebGL={isWebGLAvailable:function(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(a){return!1}},isWebGL2Available:function(){try{var e=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!e.getContext("webgl2"))}catch(a){return!1}},getWebGLErrorMessage:function(){return this.getErrorMessage(1)},getWebGL2ErrorMessage:function(){return this.getErrorMessage(2)},getErrorMessage:function(e){var d={1:window.WebGLRenderingContext,2:window.WebGL2RenderingContext},v='Your $0 does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">$1</a>',g=document.createElement("div");return g.id="webglmessage",g.style.fontFamily="monospace",g.style.fontSize="13px",g.style.fontWeight="normal",g.style.textAlign="center",g.style.background="#fff",g.style.color="#000",g.style.padding="1.5em",g.style.width="400px",g.style.margin="5em auto 0",v=(v=v.replace("$0",d[e]?"graphics card":"browser")).replace("$1",{1:"WebGL",2:"WebGL 2"}[e]),g.innerHTML=v,g}},ARButton={createButton:function(e){function v(){C.style.display="",C.style.cursor="auto",C.style.left="calc(50% - 75px)",C.style.width="150px",C.onmouseenter=null,C.onmouseleave=null,C.onclick=null,C.textContent="AR NOT SUPPORTED"}function g(_){_.style.position="absolute",_.style.bottom="20px",_.style.padding="12px 6px",_.style.border="1px solid #fff",_.style.borderRadius="4px",_.style.background="rgba(0,0,0,0.1)",_.style.color="#fff",_.style.font="normal 13px sans-serif",_.style.textAlign="center",_.style.opacity="0.5",_.style.outline="none",_.style.zIndex="999"}if("xr"in navigator){var C=document.createElement("button");return C.style.display="none",g(C),navigator.xr.isSessionSupported("immersive-ar").then(function(_){_?function(){var _=null;function x(A){A.addEventListener("end",b),e.xr.setReferenceSpaceType("local"),e.xr.setSession(A),C.textContent="STOP AR",_=A}function b(){_.removeEventListener("end",b),C.textContent="START AR",_=null}C.style.display="",C.style.cursor="pointer",C.style.left="calc(50% - 50px)",C.style.width="100px",C.textContent="START AR",C.onmouseenter=function(){C.style.opacity="1.0"},C.onmouseleave=function(){C.style.opacity="0.5"},C.onclick=function(){null===_?navigator.xr.requestSession("immersive-ar").then(x):_.end()}}():v()}).catch(v),C}var w=document.createElement("a");return w.href="https://immersiveweb.dev/",w.innerHTML=!1===window.isSecureContext?"WEBXR NEEDS HTTPS":"WEBXR NOT AVAILABLE",w.style.left="calc(50% - 90px)",w.style.width="180px",w.style.textDecoration="none",g(w),w}},VRButton={createButton:function(e,a){function C(x){x.style.position="absolute",x.style.bottom="20px",x.style.padding="12px 6px",x.style.border="1px solid #fff",x.style.borderRadius="4px",x.style.background="rgba(0,0,0,0.1)",x.style.color="#fff",x.style.font="normal 13px sans-serif",x.style.textAlign="center",x.style.opacity="0.5",x.style.outline="none",x.style.zIndex="999"}if(a&&a.referenceSpaceType&&e.xr.setReferenceSpaceType(a.referenceSpaceType),"xr"in navigator){var w=document.createElement("button");return w.style.display="none",C(w),navigator.xr.isSessionSupported("immersive-vr").then(function(x){x?function(){var x=null;function b(E){E.addEventListener("end",A),e.xr.setSession(E),w.textContent="EXIT VR",x=E}function A(){x.removeEventListener("end",A),w.textContent="ENTER VR",x=null}w.style.display="",w.style.cursor="pointer",w.style.left="calc(50% - 50px)",w.style.width="100px",w.textContent="ENTER VR",w.onmouseenter=function(){w.style.opacity="1.0"},w.onmouseleave=function(){w.style.opacity="0.5"},w.onclick=function(){null===x?navigator.xr.requestSession("immersive-vr",{optionalFeatures:["local-floor","bounded-floor"]}).then(b):x.end()}}():(w.style.display="",w.style.cursor="auto",w.style.left="calc(50% - 75px)",w.style.width="150px",w.onmouseenter=null,w.onmouseleave=null,w.onclick=null,w.textContent="VR NOT SUPPORTED")}),w}var _=document.createElement("a");return _.href="https://immersiveweb.dev/",_.innerHTML=!1===window.isSecureContext?"WEBXR NEEDS HTTPS":"WEBXR NOT AVAILABLE",_.style.left="calc(50% - 90px)",_.style.width="180px",_.style.textDecoration="none",C(_),_}};function AnimationObjectGroup(){var s=arguments;this.uuid=MathUtils.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var a=0,d=arguments.length;a!==d;++a)e[s[a].uuid]=a;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var v=this;this.stats={objects:{get total(){return v._objects.length},get inUse(){return this.total-v.nCachedObjects_}},get bindingsPerObject(){return v._bindings.length}}}function Audio(s){Object3D.call(this),this.type="Audio",this.listener=s,this.context=s.context,this.gain=this.context.createGain(),this.gain.connect(s.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._startedAt=0,this._pausedAt=0,this.filters=[]}function AudioAnalyser(s,e){this.analyser=s.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),s.getOutput().connect(this.analyser)}Object.assign(AnimationObjectGroup.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=arguments,a=this._objects,d=a.length,v=this.nCachedObjects_,g=this._indicesByUUID,C=this._paths,w=this._parsedPaths,_=this._bindings,x=_.length,b=void 0,A=0,E=arguments.length;A!==E;++A){var R=e[A],O=R.uuid,D=g[O];if(void 0===D){D=d++,g[O]=D,a.push(R);for(var F=0,L=x;F!==L;++F)_[F].push(new PropertyBinding(R,C[F],w[F]))}else if(D<v){b=a[D];var I=--v,V=a[I];for(g[V.uuid]=D,a[D]=V,g[O]=I,a[I]=R,F=0,L=x;F!==L;++F){var z=_[F],H=z[I],X=z[D];z[D]=H,void 0===X&&(X=new PropertyBinding(R,C[F],w[F])),z[I]=X}}else a[D]!==b&&console.error("AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=v},remove:function(){for(var e=arguments,a=this._objects,d=this.nCachedObjects_,v=this._indicesByUUID,g=this._bindings,C=g.length,w=0,_=arguments.length;w!==_;++w){var x=e[w],b=x.uuid,A=v[b];if(void 0!==A&&A>=d){var E=d++,R=a[E];v[R.uuid]=A,a[A]=R,v[b]=E,a[E]=x;for(var O=0,D=C;O!==D;++O){var F=g[O],L=F[E],I=F[A];F[A]=L,F[E]=I}}}this.nCachedObjects_=d},uncache:function(){for(var e=arguments,a=this._objects,d=a.length,v=this.nCachedObjects_,g=this._indicesByUUID,C=this._bindings,w=C.length,_=0,x=arguments.length;_!==x;++_){var b=e[_],A=b.uuid,E=g[A];if(void 0!==E)if(delete g[A],E<v){var R=--v,O=a[R],F=a[D=--d];g[O.uuid]=E,a[E]=O,g[F.uuid]=R,a[R]=F,a.pop();for(var L=0,I=w;L!==I;++L){var z=(V=C[L])[R],H=V[D];V[E]=z,V[R]=H,V.pop()}}else{var D;for(g[(F=a[D=--d]).uuid]=E,a[E]=F,a.pop(),L=0,I=w;L!==I;++L){var V;(V=C[L])[E]=V[D],V.pop()}}}this.nCachedObjects_=v},subscribe_:function(e,a){var d=this._bindingsIndicesByPath,v=d[e],g=this._bindings;if(void 0!==v)return g[v];var C=this._paths,w=this._parsedPaths,_=this._objects,b=this.nCachedObjects_,A=new Array(_.length);d[e]=v=g.length,C.push(e),w.push(a),g.push(A);for(var E=b,R=_.length;E!==R;++E)A[E]=new PropertyBinding(_[E],e,a);return A},unsubscribe_:function(e){var a=this._bindingsIndicesByPath,d=a[e];if(void 0!==d){var v=this._paths,g=this._parsedPaths,C=this._bindings,w=C.length-1,_=C[w];a[e[w]]=d,C[d]=_,C.pop(),g[d]=g[w],g.pop(),v[d]=v[w],v.pop()}}}),Audio.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:Audio,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setMediaStreamSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(e){if(void 0===e&&(e=0),!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){this._startedAt=this.context.currentTime+e;var a=this.context.createBufferSource();return a.buffer=this.buffer,a.loop=this.loop,a.loopStart=this.loopStart,a.loopEnd=this.loopEnd,a.onended=this.onEnded.bind(this),a.start(this._startedAt,this._pausedAt+this.offset,this.duration),this.isPlaying=!0,this.source=a,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("Audio: this Audio has no playback control.")}else console.warn("Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._pausedAt=(this.context.currentTime-this._startedAt)*this.playbackRate,this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this._pausedAt=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,a=this.filters.length;e<a;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,a=this.filters.length;e<a;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),!0===this.isPlaying?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},setDetune:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("Audio: this Audio has no playback control.")},setLoopStart:function(e){return this.loopStart=e,this},setLoopEnd:function(e){return this.loopEnd=e,this},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}),Object.assign(AudioAnalyser.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,a=this.getFrequencyData(),d=0;d<a.length;d++)e+=a[d];return e/a.length}});var _context,AudioContext={getContext:function(){return void 0===_context&&(_context=new(window.AudioContext||window.webkitAudioContext)),_context},setContext:function(e){_context=e}},_position$2=new Vector3,_quaternion$3=new Quaternion,_scale$1=new Vector3,_orientation=new Vector3;function AudioListener(){Object3D.call(this),this.type="AudioListener",this.context=AudioContext.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Clock}AudioListener.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:AudioListener,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(e){Object3D.prototype.updateMatrixWorld.call(this,e);var a=this.context.listener,d=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(_position$2,_quaternion$3,_scale$1),_orientation.set(0,0,-1).applyQuaternion(_quaternion$3),a.positionX){var v=this.context.currentTime+this.timeDelta;a.positionX.linearRampToValueAtTime(_position$2.x,v),a.positionY.linearRampToValueAtTime(_position$2.y,v),a.positionZ.linearRampToValueAtTime(_position$2.z,v),a.forwardX.linearRampToValueAtTime(_orientation.x,v),a.forwardY.linearRampToValueAtTime(_orientation.y,v),a.forwardZ.linearRampToValueAtTime(_orientation.z,v),a.upX.linearRampToValueAtTime(d.x,v),a.upY.linearRampToValueAtTime(d.y,v),a.upZ.linearRampToValueAtTime(d.z,v)}else a.setPosition(_position$2.x,_position$2.y,_position$2.z),a.setOrientation(_orientation.x,_orientation.y,_orientation.z,d.x,d.y,d.z)}});var _position$3=new Vector3,_quaternion$4=new Quaternion,_scale$2=new Vector3,_orientation$1=new Vector3;function PositionalAudio(s){Audio.call(this,s),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function ArrayCamera(s){PerspectiveCamera.call(this),this.cameras=s||[]}function WebGLCubeRenderTarget(s,e,a){Number.isInteger(e)&&(console.warn("WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),e=a),WebGLRenderTarget.call(this,s,s,e)}PositionalAudio.prototype=Object.assign(Object.create(Audio.prototype),{constructor:PositionalAudio,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,a,d){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=a,this.panner.coneOuterGain=d,this},updateMatrixWorld:function(e){if(Object3D.prototype.updateMatrixWorld.call(this,e),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(_position$3,_quaternion$4,_scale$2),_orientation$1.set(0,0,1).applyQuaternion(_quaternion$4);var a=this.panner;if(a.positionX){var d=this.context.currentTime+this.listener.timeDelta;a.positionX.linearRampToValueAtTime(_position$3.x,d),a.positionY.linearRampToValueAtTime(_position$3.y,d),a.positionZ.linearRampToValueAtTime(_position$3.z,d),a.orientationX.linearRampToValueAtTime(_orientation$1.x,d),a.orientationY.linearRampToValueAtTime(_orientation$1.y,d),a.orientationZ.linearRampToValueAtTime(_orientation$1.z,d)}else a.setPosition(_position$3.x,_position$3.y,_position$3.z),a.setOrientation(_orientation$1.x,_orientation$1.y,_orientation$1.z)}}}),ArrayCamera.prototype=Object.assign(Object.create(PerspectiveCamera.prototype),{constructor:ArrayCamera,isArrayCamera:!0}),WebGLCubeRenderTarget.prototype=Object.create(WebGLRenderTarget.prototype),WebGLCubeRenderTarget.prototype.constructor=WebGLCubeRenderTarget,WebGLCubeRenderTarget.prototype.isWebGLCubeRenderTarget=!0,WebGLCubeRenderTarget.prototype.fromEquirectangularTexture=function(s,e){this.texture.type=e.type,this.texture.format=e.format,this.texture.encoding=e.encoding;var a=new Scene,d={uniforms:{tEquirect:{value:null}},vertexShader:["varying vec3 vWorldDirection;","vec3 transformDirection( in vec3 dir, in mat4 matrix ) {","\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );","}","void main() {","\tvWorldDirection = transformDirection( position, modelMatrix );","\t#include <begin_vertex>","\t#include <project_vertex>","}"].join("\n"),fragmentShader:["uniform sampler2D tEquirect;","varying vec3 vWorldDirection;","#define RECIPROCAL_PI 0.31830988618","#define RECIPROCAL_PI2 0.15915494","void main() {","\tvec3 direction = normalize( vWorldDirection );","\tvec2 sampleUV;","\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;","\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;","\tgl_FragColor = texture2D( tEquirect, sampleUV );","}"].join("\n")},v=new ShaderMaterial({type:"CubemapFromEquirect",uniforms:cloneUniforms(d.uniforms),vertexShader:d.vertexShader,fragmentShader:d.fragmentShader,side:BackSide,blending:NoBlending});v.uniforms.tEquirect.value=e;var g=new Mesh(new BoxBufferGeometry(5,5,5),v);a.add(g);var C=new CubeCamera(1,10,1);return C.renderTarget=this,C.renderTarget.texture.name="CubeCameraTexture",C.update(s,a),g.geometry.dispose(),g.material.dispose(),this};var fov=90,aspect=1;function CubeCamera(s,e,a,d){Object3D.call(this),this.type="CubeCamera";var v=new PerspectiveCamera(fov,aspect,s,e);v.up.set(0,-1,0),v.lookAt(new Vector3(1,0,0)),this.add(v);var g=new PerspectiveCamera(fov,aspect,s,e);g.up.set(0,-1,0),g.lookAt(new Vector3(-1,0,0)),this.add(g);var C=new PerspectiveCamera(fov,aspect,s,e);C.up.set(0,0,1),C.lookAt(new Vector3(0,1,0)),this.add(C);var w=new PerspectiveCamera(fov,aspect,s,e);w.up.set(0,0,-1),w.lookAt(new Vector3(0,-1,0)),this.add(w);var _=new PerspectiveCamera(fov,aspect,s,e);_.up.set(0,-1,0),_.lookAt(new Vector3(0,0,1)),this.add(_);var x=new PerspectiveCamera(fov,aspect,s,e);x.up.set(0,-1,0),x.lookAt(new Vector3(0,0,-1)),this.add(x),this.renderTarget=new WebGLCubeRenderTarget(a,d=d||{format:RGBFormat,magFilter:LinearFilter,minFilter:LinearFilter}),this.renderTarget.texture.name="CubeCamera",this.update=function(b,A){null===this.parent&&this.updateMatrixWorld();var E=b.getRenderTarget(),R=this.renderTarget,O=R.texture.generateMipmaps;R.texture.generateMipmaps=!1,b.setRenderTarget(R,0),b.render(A,v),b.setRenderTarget(R,1),b.render(A,g),b.setRenderTarget(R,2),b.render(A,C),b.setRenderTarget(R,3),b.render(A,w),b.setRenderTarget(R,4),b.render(A,_),R.texture.generateMipmaps=O,b.setRenderTarget(R,5),b.render(A,x),b.setRenderTarget(E)},this.clear=function(b,A,E,R){for(var O=b.getRenderTarget(),D=this.renderTarget,F=0;F<6;F++)b.setRenderTarget(D,F),b.clear(A,E,R);b.setRenderTarget(O)}}function InstancedBufferAttribute(s,e,a,d){"number"==typeof a&&(d=a,a=!1,console.error("InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),BufferAttribute.call(this,s,e,a),this.meshPerAttribute=d||1}function Uniform(s){"string"==typeof s&&(console.warn("Uniform: Type parameter is no longer needed."),s=arguments[1]),this.value=s}function Font(s){this.type="Font",this.data=s}function createPaths(s,e,a){for(var d=Array.from?Array.from(s):String(s).split(""),v=e/a.resolution,g=(a.boundingBox.yMax-a.boundingBox.yMin+a.underlineThickness)*v,C=[],w=0,_=0,x=0;x<d.length;x++){var b=d[x];if("\n"===b)w=0,_-=g;else{var A=createPath(b,v,w,_,a);w+=A.offsetX,C.push(A.path)}}return C}function createPath(s,e,a,d,v){var g=v.glyphs[s]||v.glyphs["?"];if(g){var w,_,x,b,A,E,R,O,C=new ShapePath;if(g.o)for(var D=g._cachedOutline||(g._cachedOutline=g.o.split(" ")),F=0,L=D.length;F<L;)switch(D[F++]){case"m":w=D[F++]*e+a,_=D[F++]*e+d,C.moveTo(w,_);break;case"l":w=D[F++]*e+a,_=D[F++]*e+d,C.lineTo(w,_);break;case"q":x=D[F++]*e+a,b=D[F++]*e+d,A=D[F++]*e+a,E=D[F++]*e+d,C.quadraticCurveTo(A,E,x,b);break;case"b":x=D[F++]*e+a,b=D[F++]*e+d,A=D[F++]*e+a,E=D[F++]*e+d,R=D[F++]*e+a,O=D[F++]*e+d,C.bezierCurveTo(A,E,R,O,x,b)}return{offsetX:g.ha*e,path:C}}console.error('Font: character "'+s+'" does not exists in font family '+v.familyName+".")}CubeCamera.prototype=Object.create(Object3D.prototype),CubeCamera.prototype.constructor=CubeCamera,InstancedBufferAttribute.prototype=Object.assign(Object.create(BufferAttribute.prototype),{constructor:InstancedBufferAttribute,isInstancedBufferAttribute:!0,copy:function(e){return BufferAttribute.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){var e=BufferAttribute.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}),Uniform.prototype.clone=function(){return new Uniform(void 0===this.value.clone?this.value:this.value.clone())},Object.assign(Font.prototype,{isFont:!0,generateShapes:function(e,a){void 0===a&&(a=100);for(var d=[],v=createPaths(e,a,this.data),g=0,C=v.length;g<C;g++)Array.prototype.push.apply(d,v[g].toShapes());return d}});var LOD_MIN=4,LOD_MAX=8,SIZE_MAX=Math.pow(2,LOD_MAX),EXTRA_LOD_SIGMA=[.125,.215,.35,.446,.526,.582],TOTAL_LODS=LOD_MAX-LOD_MIN+1+EXTRA_LOD_SIGMA.length,MAX_SAMPLES=20,ENCODINGS={};ENCODINGS[LinearEncoding]=0,ENCODINGS[sRGBEncoding]=1,ENCODINGS[RGBEEncoding]=2,ENCODINGS[RGBM7Encoding]=3,ENCODINGS[RGBM16Encoding]=4,ENCODINGS[RGBDEncoding]=5,ENCODINGS[GammaEncoding]=6;var _flatCamera=new OrthographicCamera,_blurMaterial=_getBlurShader(MAX_SAMPLES),_equirectShader=null,_cubemapShader=null,ref=_createPlanes(),_lodPlanes=ref._lodPlanes,_sizeLods=ref._sizeLods,_sigmas=ref._sigmas,_pingPongRenderTarget=null,_renderer=null,_oldTarget=null,PHI=(1+Math.sqrt(5))/2,INV_PHI=1/PHI,_axisDirections=[new Vector3(1,1,1),new Vector3(-1,1,1),new Vector3(1,1,-1),new Vector3(-1,1,-1),new Vector3(0,PHI,INV_PHI),new Vector3(0,PHI,-INV_PHI),new Vector3(INV_PHI,0,PHI),new Vector3(-INV_PHI,0,PHI),new Vector3(PHI,INV_PHI,0),new Vector3(-PHI,INV_PHI,0)];function PMREMGenerator(s){_renderer=s,_compileMaterial(_blurMaterial)}function _createPlanes(){for(var s=[],e=[],a=[],d=LOD_MAX,v=0;v<TOTAL_LODS;v++){var g=Math.pow(2,d);e.push(g);var C=1/g;v>LOD_MAX-LOD_MIN?C=EXTRA_LOD_SIGMA[v-LOD_MAX+LOD_MIN-1]:0==v&&(C=0),a.push(C);for(var w=1/(g-1),_=-w/2,x=1+w/2,b=[_,_,x,_,x,x,_,_,x,x,_,x],F=new Float32Array(108),L=new Float32Array(72),I=new Float32Array(36),V=0;V<6;V++){var z=V%3*2/3-1,H=V>2?0:-1;F.set([z,H,0,z+2/3,H,0,z+2/3,H+1,0,z,H,0,z+2/3,H+1,0,z,H+1,0],18*V),L.set(b,12*V),I.set([V,V,V,V,V,V],6*V)}var j=new BufferGeometry;j.setAttribute("position",new BufferAttribute(F,3)),j.setAttribute("uv",new BufferAttribute(L,2)),j.setAttribute("faceIndex",new BufferAttribute(I,1)),s.push(j),d>LOD_MIN&&d--}return{_lodPlanes:s,_sizeLods:e,_sigmas:a}}function _allocateTargets(s){var e={magFilter:NearestFilter,minFilter:NearestFilter,generateMipmaps:!1,type:s?s.type:UnsignedByteType,format:s?s.format:RGBEFormat,encoding:s?s.encoding:RGBEEncoding,depthBuffer:!1,stencilBuffer:!1},a=_createRenderTarget(e);return a.depthBuffer=!s,_pingPongRenderTarget=_createRenderTarget(e),a}function _cleanup(s){_pingPongRenderTarget.dispose(),_renderer.setRenderTarget(_oldTarget),s.scissorTest=!1,s.setSize(s.width,s.height)}function _sceneToCubeUV(s,e,a,d){var C=new PerspectiveCamera(90,1,e,a),w=[1,1,1,1,-1,1],_=[1,1,-1,-1,-1,1],x=_renderer.outputEncoding,b=_renderer.toneMapping,A=_renderer.toneMappingExposure,E=_renderer.getClearColor(),R=_renderer.getClearAlpha();_renderer.toneMapping=LinearToneMapping,_renderer.toneMappingExposure=1,_renderer.outputEncoding=LinearEncoding,s.scale.z*=-1;var O=s.background;if(O&&O.isColor){O.convertSRGBToLinear();var D=Math.max(O.r,O.g,O.b),F=Math.min(Math.max(Math.ceil(Math.log2(D)),-128),127);O=O.multiplyScalar(Math.pow(2,-F)),_renderer.setClearColor(O,(F+128)/255),s.background=null}for(var I=0;I<6;I++){var V=I%3;0==V?(C.up.set(0,w[I],0),C.lookAt(_[I],0,0)):1==V?(C.up.set(0,0,w[I]),C.lookAt(0,_[I],0)):(C.up.set(0,w[I],0),C.lookAt(0,0,_[I])),_setViewport(d,V*SIZE_MAX,I>2?SIZE_MAX:0,SIZE_MAX,SIZE_MAX),_renderer.setRenderTarget(d),_renderer.render(s,C)}_renderer.toneMapping=b,_renderer.toneMappingExposure=A,_renderer.outputEncoding=x,_renderer.setClearColor(E,R),s.scale.z*=-1}function _textureToCubeUV(s,e){var a=new Scene;s.isCubeTexture?null==_cubemapShader&&(_cubemapShader=_getCubemapShader()):null==_equirectShader&&(_equirectShader=_getEquirectShader());var d=s.isCubeTexture?_cubemapShader:_equirectShader;a.add(new Mesh(_lodPlanes[0],d));var v=d.uniforms;v.envMap.value=s,s.isCubeTexture||v.texelSize.value.set(1/s.image.width,1/s.image.height),v.inputEncoding.value=ENCODINGS[s.encoding],v.outputEncoding.value=ENCODINGS[s.encoding],_setViewport(e,0,0,3*SIZE_MAX,2*SIZE_MAX),_renderer.setRenderTarget(e),_renderer.render(a,_flatCamera)}function _compileMaterial(s){var e=new Scene;e.add(new Mesh(_lodPlanes[0],s)),_renderer.compile(e,_flatCamera)}function _createRenderTarget(s){var e=new WebGLRenderTarget(3*SIZE_MAX,3*SIZE_MAX,s);return e.texture.mapping=CubeUVReflectionMapping,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function _setViewport(s,e,a,d,v){s.viewport.set(e,a,d,v),s.scissor.set(e,a,d,v)}function _applyPMREM(s){var e=_renderer.autoClear;_renderer.autoClear=!1;for(var a=1;a<TOTAL_LODS;a++)_blur(s,a-1,a,Math.sqrt(_sigmas[a]*_sigmas[a]-_sigmas[a-1]*_sigmas[a-1]),_axisDirections[(a-1)%_axisDirections.length]);_renderer.autoClear=e}function _blur(s,e,a,d,v){_halfBlur(s,_pingPongRenderTarget,e,a,d,"latitudinal",v),_halfBlur(_pingPongRenderTarget,s,a,a,d,"longitudinal",v)}function _halfBlur(s,e,a,d,v,g,C){"latitudinal"!==g&&"longitudinal"!==g&&console.error("blur direction must be either latitudinal or longitudinal!");var _=new Scene;_.add(new Mesh(_lodPlanes[d],_blurMaterial));var x=_blurMaterial.uniforms,b=_sizeLods[a]-1,A=isFinite(v)?Math.PI/(2*b):2*Math.PI/(2*MAX_SAMPLES-1),E=v/A,R=isFinite(v)?1+Math.floor(3*E):MAX_SAMPLES;R>MAX_SAMPLES&&console.warn("sigmaRadians, "+v+", is too large and will clip, as it requested "+R+" samples when the maximum is set to "+MAX_SAMPLES);for(var O=[],D=0,F=0;F<MAX_SAMPLES;++F){var V=F/E,L=Math.exp(-V*V/2);O.push(L),0==F?D+=L:F<R&&(D+=2*L)}for(F=0;F<O.length;F++)O[F]=O[F]/D;x.envMap.value=s.texture,x.samples.value=R,x.weights.value=O,x.latitudinal.value="latitudinal"===g,C&&(x.poleAxis.value=C),x.dTheta.value=A,x.mipInt.value=LOD_MAX-a,x.inputEncoding.value=ENCODINGS[s.texture.encoding],x.outputEncoding.value=ENCODINGS[s.texture.encoding];var I=_sizeLods[d];_setViewport(e,V=3*Math.max(0,SIZE_MAX-2*I),(0===d?0:2*SIZE_MAX)+2*I*(d>LOD_MAX-LOD_MIN?d-LOD_MAX+LOD_MIN:0),3*I,2*I),_renderer.setRenderTarget(e),_renderer.render(_,_flatCamera)}function _getBlurShader(s){var d=new RawShaderMaterial({defines:{n:s},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:new Float32Array(s)},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:new Vector3(0,1,0)},inputEncoding:{value:ENCODINGS[LinearEncoding]},outputEncoding:{value:ENCODINGS[LinearEncoding]}},vertexShader:_getCommonVertexShader(),fragmentShader:"\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform int samples;\nuniform float weights[n];\nuniform bool latitudinal;\nuniform float dTheta;\nuniform float mipInt;\nuniform vec3 poleAxis;\n\n"+_getEncodings()+"\n\n#define ENVMAP_TYPE_CUBE_UV\n#include <cube_uv_reflection_fragment>\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tfor (int i = 0; i < n; i++) {\n\t\tif (i >= samples)\n\t\t\tbreak;\n\t\tfor (int dir = -1; dir < 2; dir += 2) {\n\t\t\tif (i == 0 && dir == 1)\n\t\t\t\tcontinue;\n\t\t\tvec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);\n\t\t\tif (all(equal(axis, vec3(0.0))))\n\t\t\t\taxis = cross(vec3(0.0, 1.0, 0.0), vOutputDirection);\n\t\t\taxis = normalize(axis);\n\t\t\tfloat theta = dTheta * float(dir * i);\n\t\t\tfloat cosTheta = cos(theta);\n\t\t\t// Rodrigues' axis-angle rotation\n\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross(axis, vOutputDirection) * sin(theta)\n\t\t\t\t\t+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);\n\t\t\tgl_FragColor.rgb +=\n\t\t\t\t\tweights[i] * bilinearCubeUV(envMap, sampleDirection, mipInt);\n\t\t}\n\t}\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t",blending:NoBlending,depthTest:!1,depthWrite:!1});return d.type="SphericalGaussianBlur",d}function _getEquirectShader(){var e=new RawShaderMaterial({uniforms:{envMap:{value:null},texelSize:{value:new Vector2(1,1)},inputEncoding:{value:ENCODINGS[LinearEncoding]},outputEncoding:{value:ENCODINGS[LinearEncoding]}},vertexShader:_getCommonVertexShader(),fragmentShader:"\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform sampler2D envMap;\nuniform vec2 texelSize;\n\n"+_getEncodings()+"\n\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tvec3 outputDirection = normalize(vOutputDirection);\n\tvec2 uv;\n\tuv.y = asin(clamp(outputDirection.y, -1.0, 1.0)) * RECIPROCAL_PI + 0.5;\n\tuv.x = atan(outputDirection.z, outputDirection.x) * RECIPROCAL_PI2 + 0.5;\n\tvec2 f = fract(uv / texelSize - 0.5);\n\tuv -= f * texelSize;\n\tvec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x += texelSize.x;\n\tvec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.y += texelSize.y;\n\tvec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tuv.x -= texelSize.x;\n\tvec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n\tvec3 tm = mix(tl, tr, f.x);\n\tvec3 bm = mix(bl, br, f.x);\n\tgl_FragColor.rgb = mix(tm, bm, f.y);\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t",blending:NoBlending,depthTest:!1,depthWrite:!1});return e.type="EquirectangularToCubeUV",e}function _getCubemapShader(){var s=new RawShaderMaterial({uniforms:{envMap:{value:null},inputEncoding:{value:ENCODINGS[LinearEncoding]},outputEncoding:{value:ENCODINGS[LinearEncoding]}},vertexShader:_getCommonVertexShader(),fragmentShader:"\nprecision mediump float;\nprecision mediump int;\nvarying vec3 vOutputDirection;\nuniform samplerCube envMap;\n\n"+_getEncodings()+"\n\nvoid main() {\n\tgl_FragColor = vec4(0.0);\n\tgl_FragColor.rgb = envMapTexelToLinear(textureCube(envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ))).rgb;\n\tgl_FragColor = linearToOutputTexel(gl_FragColor);\n}\n\t\t",blending:NoBlending,depthTest:!1,depthWrite:!1});return s.type="CubemapToCubeUV",s}function _getCommonVertexShader(){return"\nprecision mediump float;\nprecision mediump int;\nattribute vec3 position;\nattribute vec2 uv;\nattribute float faceIndex;\nvarying vec3 vOutputDirection;\nvec3 getDirection(vec2 uv, float face) {\n\tuv = 2.0 * uv - 1.0;\n\tvec3 direction = vec3(uv, 1.0);\n\tif (face == 0.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 1.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.z *= -1.0;\n\t} else if (face == 3.0) {\n\t\tdirection = direction.zyx;\n\t\tdirection.x *= -1.0;\n\t} else if (face == 4.0) {\n\t\tdirection = direction.xzy;\n\t\tdirection.y *= -1.0;\n\t} else if (face == 5.0) {\n\t\tdirection.xz *= -1.0;\n\t}\n\treturn direction;\n}\nvoid main() {\n\tvOutputDirection = getDirection(uv, faceIndex);\n\tgl_Position = vec4( position, 1.0 );\n}\n\t"}function _getEncodings(){return"\nuniform int inputEncoding;\nuniform int outputEncoding;\n\n#include <encodings_pars_fragment>\n\nvec4 inputTexelToLinear(vec4 value){\n\tif(inputEncoding == 0){\n\t\treturn value;\n\t}else if(inputEncoding == 1){\n\t\treturn sRGBToLinear(value);\n\t}else if(inputEncoding == 2){\n\t\treturn RGBEToLinear(value);\n\t}else if(inputEncoding == 3){\n\t\treturn RGBMToLinear(value, 7.0);\n\t}else if(inputEncoding == 4){\n\t\treturn RGBMToLinear(value, 16.0);\n\t}else if(inputEncoding == 5){\n\t\treturn RGBDToLinear(value, 256.0);\n\t}else{\n\t\treturn GammaToLinear(value, 2.2);\n\t}\n}\n\nvec4 linearToOutputTexel(vec4 value){\n\tif(outputEncoding == 0){\n\t\treturn value;\n\t}else if(outputEncoding == 1){\n\t\treturn LinearTosRGB(value);\n\t}else if(outputEncoding == 2){\n\t\treturn LinearToRGBE(value);\n\t}else if(outputEncoding == 3){\n\t\treturn LinearToRGBM(value, 7.0);\n\t}else if(outputEncoding == 4){\n\t\treturn LinearToRGBM(value, 16.0);\n\t}else if(outputEncoding == 5){\n\t\treturn LinearToRGBD(value, 256.0);\n\t}else{\n\t\treturn LinearToGamma(value, 2.2);\n\t}\n}\n\nvec4 envMapTexelToLinear(vec4 color) {\n\treturn inputTexelToLinear(color);\n}\n\t"}function CircleGeometry(s,e,a,d){Geometry.call(this),this.type="CircleGeometry",this.parameters={radius:s,segments:e,thetaStart:a,thetaLength:d},this.fromBufferGeometry(new CircleBufferGeometry(s,e,a,d)),this.mergeVertices()}function CircleBufferGeometry(s,e,a,d){BufferGeometry.call(this),this.type="CircleBufferGeometry",this.parameters={radius:s,segments:e,thetaStart:a,thetaLength:d},s=s||1,e=void 0!==e?Math.max(3,e):8,a=void 0!==a?a:0,d=void 0!==d?d:2*Math.PI;var _,x,v=[],g=[],C=[],w=[],b=new Vector3,A=new Vector2;for(g.push(0,0,0),C.push(0,0,1),w.push(.5,.5),x=0,_=3;x<=e;x++,_+=3){var E=a+x/e*d;b.x=s*Math.cos(E),b.y=s*Math.sin(E),g.push(b.x,b.y,b.z),C.push(0,0,1),A.x=(g[_]/s+1)/2,A.y=(g[_+1]/s+1)/2,w.push(A.x,A.y)}for(_=1;_<=e;_++)v.push(_,_+1,0);this.setIndex(v),this.setAttribute("position",new Float32BufferAttribute(g,3)),this.setAttribute("normal",new Float32BufferAttribute(C,3)),this.setAttribute("uv",new Float32BufferAttribute(w,2))}function ConeGeometry(s,e,a,d,v,g,C){CylinderGeometry.call(this,0,s,e,a,d,v,g,C),this.type="ConeGeometry",this.parameters={radius:s,height:e,radialSegments:a,heightSegments:d,openEnded:v,thetaStart:g,thetaLength:C}}function ConeBufferGeometry(s,e,a,d,v,g,C){CylinderBufferGeometry.call(this,0,s,e,a,d,v,g,C),this.type="ConeBufferGeometry",this.parameters={radius:s,height:e,radialSegments:a,heightSegments:d,openEnded:v,thetaStart:g,thetaLength:C}}function DodecahedronGeometry(s,e){Geometry.call(this),this.type="DodecahedronGeometry",this.parameters={radius:s,detail:e},this.fromBufferGeometry(new DodecahedronBufferGeometry(s,e)),this.mergeVertices()}function DodecahedronBufferGeometry(s,e){var a=(1+Math.sqrt(5))/2,d=1/a;PolyhedronBufferGeometry.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-d,-a,0,-d,a,0,d,-a,0,d,a,-d,-a,0,-d,a,0,d,-a,0,d,a,0,-a,0,-d,a,0,-d,-a,0,d,a,0,d],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],s,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:s,detail:e}}function EdgesGeometry(s,e){BufferGeometry.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e},e=void 0!==e?e:1;var C,w,_,b,a=[],d=Math.cos(MathUtils.DEG2RAD*e),v=[0,0],g={},x=["a","b","c"];s.isBufferGeometry?(b=new Geometry).fromBufferGeometry(s):b=s.clone(),b.mergeVertices(),b.computeFaceNormals();for(var A=b.vertices,E=b.faces,R=0,O=E.length;R<O;R++)for(var D=E[R],F=0;F<3;F++)C=D[x[F]],w=D[x[(F+1)%3]],v[0]=Math.min(C,w),v[1]=Math.max(C,w),void 0===g[_=v[0]+","+v[1]]?g[_]={index1:v[0],index2:v[1],face1:R,face2:void 0}:g[_].face2=R;for(_ in g){var L=g[_];if(void 0===L.face2||E[L.face1].normal.dot(E[L.face2].normal)<=d){var I=A[L.index1];a.push(I.x,I.y,I.z),a.push((I=A[L.index2]).x,I.y,I.z)}}this.setAttribute("position",new Float32BufferAttribute(a,3))}function ExtrudeGeometry(s,e){Geometry.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:s,options:e},this.fromBufferGeometry(new ExtrudeBufferGeometry(s,e)),this.mergeVertices()}function ExtrudeBufferGeometry(s,e){BufferGeometry.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:s,options:e},s=Array.isArray(s)?s:[s];for(var a=this,d=[],v=[],g=0,C=s.length;g<C;g++)_(s[g]);function _(x){var b=[],A=void 0!==e.curveSegments?e.curveSegments:12,E=void 0!==e.steps?e.steps:1,R=void 0!==e.depth?e.depth:100,O=void 0===e.bevelEnabled||e.bevelEnabled,D=void 0!==e.bevelThickness?e.bevelThickness:6,F=void 0!==e.bevelSize?e.bevelSize:D-2,L=void 0!==e.bevelOffset?e.bevelOffset:0,I=void 0!==e.bevelSegments?e.bevelSegments:3,V=e.extrudePath,z=void 0!==e.UVGenerator?e.UVGenerator:WorldUVGenerator;void 0!==e.amount&&(console.warn("ExtrudeBufferGeometry: amount has been renamed to depth."),R=e.amount);var H,re,j,te,J,X=!1;V&&(H=V.getSpacedPoints(E),X=!0,O=!1,re=V.computeFrenetFrames(E,!1),j=new Vector3,te=new Vector3,J=new Vector3),O||(I=0,D=0,F=0,L=0);var k,U,K,ee=x.extractPoints(A),Q=ee.shape,oe=ee.holes;if(!ShapeUtils.isClockWise(Q))for(Q=Q.reverse(),U=0,K=oe.length;U<K;U++)ShapeUtils.isClockWise(k=oe[U])&&(oe[U]=k.reverse());var fe=ShapeUtils.triangulateShape(Q,oe),ge=Q;for(U=0,K=oe.length;U<K;U++)Q=Q.concat(k=oe[U]);function $(ot,St,ft){return St||console.error("ExtrudeGeometry: vec does not exist"),St.clone().multiplyScalar(ft).add(ot)}var ue,Y,Z,se,ve,_e,le=Q.length,ae=fe.length;function pe(ot,St,ft){var He,gt,vt,Gt=ot.x-St.x,Lt=ot.y-St.y,yt=ft.x-ot.x,xr=ft.y-ot.y,Dr=Gt*Gt+Lt*Lt;if(Math.abs(Gt*xr-Lt*yt)>Number.EPSILON){var qr=Math.sqrt(Dr),Ar=Math.sqrt(yt*yt+xr*xr),hn=St.x-Lt/qr,Sn=St.y+Gt/qr,jr=((ft.x-xr/Ar-hn)*xr-(ft.y+yt/Ar-Sn)*yt)/(Gt*xr-Lt*yt),cn=(He=hn+Gt*jr-ot.x)*He+(gt=Sn+Lt*jr-ot.y)*gt;if(cn<=2)return new Vector2(He,gt);vt=Math.sqrt(cn/2)}else{var Fn=!1;Gt>Number.EPSILON?yt>Number.EPSILON&&(Fn=!0):Gt<-Number.EPSILON?yt<-Number.EPSILON&&(Fn=!0):Math.sign(Lt)===Math.sign(xr)&&(Fn=!0),Fn?(He=-Lt,gt=Gt,vt=Math.sqrt(Dr)):(He=Gt,gt=Lt,vt=Math.sqrt(Dr/2))}return new Vector2(He/vt,gt/vt)}for(var he=[],ce=0,Te=ge.length,be=Te-1,xe=ce+1;ce<Te;ce++,be++,xe++)be===Te&&(be=0),xe===Te&&(xe=0),he[ce]=pe(ge[ce],ge[be],ge[xe]);var Ne,De,we=[],Re=he.concat();for(U=0,K=oe.length;U<K;U++){for(Ne=[],be=(Te=(k=oe[U]).length)-1,xe=1+(ce=0);ce<Te;ce++,be++,xe++)be===Te&&(be=0),xe===Te&&(xe=0),Ne[ce]=pe(k[ce],k[be],k[xe]);we.push(Ne),Re=Re.concat(Ne)}for(ue=0;ue<I;ue++){for(Z=ue/I,se=D*Math.cos(Z*Math.PI/2),Y=F*Math.sin(Z*Math.PI/2)+L,ce=0,Te=ge.length;ce<Te;ce++)ut((ve=$(ge[ce],he[ce],Y)).x,ve.y,-se);for(U=0,K=oe.length;U<K;U++)for(Ne=we[U],ce=0,Te=(k=oe[U]).length;ce<Te;ce++)ut((ve=$(k[ce],Ne[ce],Y)).x,ve.y,-se)}for(Y=F+L,ce=0;ce<le;ce++)ve=O?$(Q[ce],Re[ce],Y):Q[ce],X?(te.copy(re.normals[0]).multiplyScalar(ve.x),j.copy(re.binormals[0]).multiplyScalar(ve.y),J.copy(H[0]).add(te).add(j),ut(J.x,J.y,J.z)):ut(ve.x,ve.y,0);for(De=1;De<=E;De++)for(ce=0;ce<le;ce++)ve=O?$(Q[ce],Re[ce],Y):Q[ce],X?(te.copy(re.normals[De]).multiplyScalar(ve.x),j.copy(re.binormals[De]).multiplyScalar(ve.y),J.copy(H[De]).add(te).add(j),ut(J.x,J.y,J.z)):ut(ve.x,ve.y,R/E*De);for(ue=I-1;ue>=0;ue--){for(Z=ue/I,se=D*Math.cos(Z*Math.PI/2),Y=F*Math.sin(Z*Math.PI/2)+L,ce=0,Te=ge.length;ce<Te;ce++)ut((ve=$(ge[ce],he[ce],Y)).x,ve.y,R+se);for(U=0,K=oe.length;U<K;U++)for(Ne=we[U],ce=0,Te=(k=oe[U]).length;ce<Te;ce++)ve=$(k[ce],Ne[ce],Y),X?ut(ve.x,ve.y+H[E-1].y,H[E-1].x+se):ut(ve.x,ve.y,R+se)}function pt(ot,St){var ft,He;for(ce=ot.length;--ce>=0;){ft=ce,(He=ce-1)<0&&(He=ot.length-1);var gt=0,vt=E+2*I;for(gt=0;gt<vt;gt++){var Gt=le*gt,Lt=le*(gt+1);Xe(St+ft+Gt,St+He+Gt,St+He+Lt,St+ft+Lt)}}}function ut(ot,St,ft){b.push(ot),b.push(St),b.push(ft)}function at(ot,St,ft){Ke(ot),Ke(St),Ke(ft);var He=d.length/3,gt=z.generateTopUV(a,d,He-3,He-2,He-1);lt(gt[0]),lt(gt[1]),lt(gt[2])}function Xe(ot,St,ft,He){Ke(ot),Ke(St),Ke(He),Ke(St),Ke(ft),Ke(He);var gt=d.length/3,vt=z.generateSideWallUV(a,d,gt-6,gt-3,gt-2,gt-1);lt(vt[0]),lt(vt[1]),lt(vt[3]),lt(vt[1]),lt(vt[2]),lt(vt[3])}function Ke(ot){d.push(b[3*ot+0]),d.push(b[3*ot+1]),d.push(b[3*ot+2])}function lt(ot){v.push(ot.x),v.push(ot.y)}(function(){var ot=d.length/3;if(O){var St=0,ft=le*St;for(ce=0;ce<ae;ce++)at((_e=fe[ce])[2]+ft,_e[1]+ft,_e[0]+ft);for(ft=le*(St=E+2*I),ce=0;ce<ae;ce++)at((_e=fe[ce])[0]+ft,_e[1]+ft,_e[2]+ft)}else{for(ce=0;ce<ae;ce++)at((_e=fe[ce])[2],_e[1],_e[0]);for(ce=0;ce<ae;ce++)at((_e=fe[ce])[0]+le*E,_e[1]+le*E,_e[2]+le*E)}a.addGroup(ot,d.length/3-ot,0)})(),function(){var ot=d.length/3,St=0;for(pt(ge,St),St+=ge.length,U=0,K=oe.length;U<K;U++)pt(k=oe[U],St),St+=k.length;a.addGroup(ot,d.length/3-ot,1)}()}this.setAttribute("position",new Float32BufferAttribute(d,3)),this.setAttribute("uv",new Float32BufferAttribute(v,2)),this.computeVertexNormals()}PMREMGenerator.prototype={constructor:PMREMGenerator,fromScene:function(e,a,d,v){void 0===a&&(a=0),void 0===d&&(d=.1),void 0===v&&(v=100),_oldTarget=_renderer.getRenderTarget();var g=_allocateTargets();return _sceneToCubeUV(e,d,v,g),a>0&&_blur(g,0,0,a),_applyPMREM(g),_cleanup(g),g},fromEquirectangular:function(e){return e.magFilter=NearestFilter,e.minFilter=NearestFilter,e.generateMipmaps=!1,this.fromCubemap(e)},fromCubemap:function(e){_oldTarget=_renderer.getRenderTarget();var a=_allocateTargets(e);return _textureToCubeUV(e,a),_applyPMREM(a),_cleanup(a),a},compileCubemapShader:function(){null==_cubemapShader&&_compileMaterial(_cubemapShader=_getCubemapShader())},compileEquirectangularShader:function(){null==_equirectShader&&_compileMaterial(_equirectShader=_getEquirectShader())},dispose:function(){_blurMaterial.dispose(),null!=_cubemapShader&&_cubemapShader.dispose(),null!=_equirectShader&&_equirectShader.dispose();for(var e=0;e<_lodPlanes.length;e++)_lodPlanes[e].dispose()}},CircleGeometry.prototype=Object.create(Geometry.prototype),CircleGeometry.prototype.constructor=CircleGeometry,CircleBufferGeometry.prototype=Object.create(BufferGeometry.prototype),CircleBufferGeometry.prototype.constructor=CircleBufferGeometry,ConeGeometry.prototype=Object.create(CylinderGeometry.prototype),ConeGeometry.prototype.constructor=ConeGeometry,ConeBufferGeometry.prototype=Object.create(CylinderBufferGeometry.prototype),ConeBufferGeometry.prototype.constructor=ConeBufferGeometry,DodecahedronGeometry.prototype=Object.create(Geometry.prototype),DodecahedronGeometry.prototype.constructor=DodecahedronGeometry,DodecahedronBufferGeometry.prototype=Object.create(PolyhedronBufferGeometry.prototype),DodecahedronBufferGeometry.prototype.constructor=DodecahedronBufferGeometry,EdgesGeometry.prototype=Object.create(BufferGeometry.prototype),EdgesGeometry.prototype.constructor=EdgesGeometry,ExtrudeGeometry.prototype=Object.create(Geometry.prototype),ExtrudeGeometry.prototype.constructor=ExtrudeGeometry,ExtrudeGeometry.prototype.toJSON=function(){var s=Geometry.prototype.toJSON.call(this);return toJSON(this.parameters.shapes,this.parameters.options,s)},ExtrudeBufferGeometry.prototype=Object.create(BufferGeometry.prototype),ExtrudeBufferGeometry.prototype.constructor=ExtrudeBufferGeometry,ExtrudeBufferGeometry.prototype.toJSON=function(){var s=BufferGeometry.prototype.toJSON.call(this);return toJSON(this.parameters.shapes,this.parameters.options,s)};var WorldUVGenerator={generateTopUV:function(e,a,d,v,g){var _=a[3*v],x=a[3*v+1],b=a[3*g],A=a[3*g+1];return[new Vector2(a[3*d],a[3*d+1]),new Vector2(_,x),new Vector2(b,A)]},generateSideWallUV:function(e,a,d,v,g,C){var w=a[3*d],_=a[3*d+1],x=a[3*d+2],b=a[3*v],A=a[3*v+1],E=a[3*v+2],R=a[3*g],O=a[3*g+1],D=a[3*g+2],F=a[3*C],L=a[3*C+1],I=a[3*C+2];return Math.abs(_-A)<.01?[new Vector2(w,1-x),new Vector2(b,1-E),new Vector2(R,1-D),new Vector2(F,1-I)]:[new Vector2(_,1-x),new Vector2(A,1-E),new Vector2(O,1-D),new Vector2(L,1-I)]}};function toJSON(s,e,a){if(a.shapes=[],Array.isArray(s))for(var d=0,v=s.length;d<v;d++)a.shapes.push(s[d].uuid);else a.shapes.push(s.uuid);return void 0!==e.extrudePath&&(a.options.extrudePath=e.extrudePath.toJSON()),a}function IcosahedronGeometry(s,e){Geometry.call(this),this.type="IcosahedronGeometry",this.parameters={radius:s,detail:e},this.fromBufferGeometry(new IcosahedronBufferGeometry(s,e)),this.mergeVertices()}function IcosahedronBufferGeometry(s,e){var a=(1+Math.sqrt(5))/2;PolyhedronBufferGeometry.call(this,[-1,a,0,1,a,0,-1,-a,0,1,-a,0,0,-1,a,0,1,a,0,-1,-a,0,1,-a,a,0,-1,a,0,1,-a,0,-1,-a,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],s,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:s,detail:e}}function LatheGeometry(s,e,a,d){Geometry.call(this),this.type="LatheGeometry",this.parameters={points:s,segments:e,phiStart:a,phiLength:d},this.fromBufferGeometry(new LatheBufferGeometry(s,e,a,d)),this.mergeVertices()}function LatheBufferGeometry(s,e,a,d){BufferGeometry.call(this),this.type="LatheBufferGeometry",this.parameters={points:s,segments:e,phiStart:a,phiLength:d},e=Math.floor(e)||12,a=a||0,d=d||2*Math.PI,d=MathUtils.clamp(d,0,2*Math.PI);var w,A,E,v=[],g=[],C=[],_=1/e,x=new Vector3,b=new Vector2;for(A=0;A<=e;A++){var R=a+A*_*d,O=Math.sin(R),D=Math.cos(R);for(E=0;E<=s.length-1;E++)x.x=s[E].x*O,x.y=s[E].y,x.z=s[E].x*D,g.push(x.x,x.y,x.z),b.x=A/e,b.y=E/(s.length-1),C.push(b.x,b.y)}for(A=0;A<e;A++)for(E=0;E<s.length-1;E++){var L=(w=E+A*s.length)+s.length,I=w+s.length+1,V=w+1;v.push(w,L,V),v.push(L,I,V)}if(this.setIndex(v),this.setAttribute("position",new Float32BufferAttribute(g,3)),this.setAttribute("uv",new Float32BufferAttribute(C,2)),this.computeVertexNormals(),d===2*Math.PI){var z=this.attributes.normal.array,H=new Vector3,X=new Vector3,re=new Vector3;for(w=e*s.length*3,A=0,E=0;A<s.length;A++,E+=3)H.x=z[E+0],H.y=z[E+1],H.z=z[E+2],X.x=z[w+E+0],X.y=z[w+E+1],X.z=z[w+E+2],re.addVectors(H,X).normalize(),z[E+0]=z[w+E+0]=re.x,z[E+1]=z[w+E+1]=re.y,z[E+2]=z[w+E+2]=re.z}}function RingGeometry(s,e,a,d,v,g){Geometry.call(this),this.type="RingGeometry",this.parameters={innerRadius:s,outerRadius:e,thetaSegments:a,phiSegments:d,thetaStart:v,thetaLength:g},this.fromBufferGeometry(new RingBufferGeometry(s,e,a,d,v,g)),this.mergeVertices()}function RingBufferGeometry(s,e,a,d,v,g){BufferGeometry.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:s,outerRadius:e,thetaSegments:a,phiSegments:d,thetaStart:v,thetaLength:g},s=s||.5,e=e||1,v=void 0!==v?v:0,g=void 0!==g?g:2*Math.PI,a=void 0!==a?Math.max(3,a):8;var b,D,F,C=[],w=[],_=[],x=[],A=s,E=(e-s)/(d=void 0!==d?Math.max(1,d):1),R=new Vector3,O=new Vector2;for(D=0;D<=d;D++){for(F=0;F<=a;F++)b=v+F/a*g,R.x=A*Math.cos(b),R.y=A*Math.sin(b),w.push(R.x,R.y,R.z),_.push(0,0,1),O.x=(R.x/e+1)/2,O.y=(R.y/e+1)/2,x.push(O.x,O.y);A+=E}for(D=0;D<d;D++){var L=D*(a+1);for(F=0;F<a;F++){var V=(b=F+L)+a+1,z=b+a+2,H=b+1;C.push(b,V,H),C.push(V,z,H)}}this.setIndex(C),this.setAttribute("position",new Float32BufferAttribute(w,3)),this.setAttribute("normal",new Float32BufferAttribute(_,3)),this.setAttribute("uv",new Float32BufferAttribute(x,2))}function ShapeGeometry(s,e){Geometry.call(this),this.type="ShapeGeometry","object"==typeof e&&(console.warn("ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:s,curveSegments:e},this.fromBufferGeometry(new ShapeBufferGeometry(s,e)),this.mergeVertices()}function ShapeBufferGeometry(s,e){BufferGeometry.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:s,curveSegments:e},e=e||12;var a=[],d=[],v=[],g=[],C=0,w=0;if(!1===Array.isArray(s))x(s);else for(var _=0;_<s.length;_++)x(s[_]),this.addGroup(C,w,_),C+=w,w=0;function x(b){var A,E,R,O=d.length/3,D=b.extractPoints(e),F=D.shape,L=D.holes;for(!1===ShapeUtils.isClockWise(F)&&(F=F.reverse()),A=0,E=L.length;A<E;A++)!0===ShapeUtils.isClockWise(R=L[A])&&(L[A]=R.reverse());var I=ShapeUtils.triangulateShape(F,L);for(A=0,E=L.length;A<E;A++)F=F.concat(R=L[A]);for(A=0,E=F.length;A<E;A++){var V=F[A];d.push(V.x,V.y,0),v.push(0,0,1),g.push(V.x,V.y)}for(A=0,E=I.length;A<E;A++){var z=I[A];a.push(z[0]+O,z[1]+O,z[2]+O),w+=3}}this.setIndex(a),this.setAttribute("position",new Float32BufferAttribute(d,3)),this.setAttribute("normal",new Float32BufferAttribute(v,3)),this.setAttribute("uv",new Float32BufferAttribute(g,2))}function toJSON$1(s,e){if(e.shapes=[],Array.isArray(s))for(var a=0,d=s.length;a<d;a++)e.shapes.push(s[a].uuid);else e.shapes.push(s.uuid);return e}function TetrahedronGeometry(s,e){Geometry.call(this),this.type="TetrahedronGeometry",this.parameters={radius:s,detail:e},this.fromBufferGeometry(new TetrahedronBufferGeometry(s,e)),this.mergeVertices()}function TetrahedronBufferGeometry(s,e){PolyhedronBufferGeometry.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],s,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:s,detail:e}}function TextGeometry(s,e){Geometry.call(this),this.type="TextGeometry",this.parameters={text:s,parameters:e},this.fromBufferGeometry(new TextBufferGeometry(s,e)),this.mergeVertices()}function TextBufferGeometry(s,e){var a=(e=e||{}).font;if(!a||!a.isFont)return console.error("TextGeometry: font parameter is not an instance of Font."),new Geometry;var d=a.generateShapes(s,e.size);e.depth=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),ExtrudeBufferGeometry.call(this,d,e),this.type="TextBufferGeometry"}function TorusKnotGeometry(s,e,a,d,v,g,C){Geometry.call(this),this.type="TorusKnotGeometry",this.parameters={radius:s,tube:e,tubularSegments:a,radialSegments:d,p:v,q:g},void 0!==C&&console.warn("TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new TorusKnotBufferGeometry(s,e,a,d,v,g)),this.mergeVertices()}function TorusKnotBufferGeometry(s,e,a,d,v,g){BufferGeometry.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:s,tube:e,tubularSegments:a,radialSegments:d,p:v,q:g},s=s||1,e=e||.4,a=Math.floor(a)||64,d=Math.floor(d)||8,v=v||2,g=g||3;var b,A,C=[],w=[],_=[],x=[],E=new Vector3,R=new Vector3,O=new Vector3,D=new Vector3,F=new Vector3,L=new Vector3,I=new Vector3;for(b=0;b<=a;++b){var V=b/a*v*Math.PI*2;for(k(V,v,g,s,O),k(V+.01,v,g,s,D),L.subVectors(D,O),I.addVectors(D,O),F.crossVectors(L,I),I.crossVectors(F,L),F.normalize(),I.normalize(),A=0;A<=d;++A){var z=A/d*Math.PI*2,H=-e*Math.cos(z),X=e*Math.sin(z);E.x=O.x+(H*I.x+X*F.x),E.y=O.y+(H*I.y+X*F.y),E.z=O.z+(H*I.z+X*F.z),w.push(E.x,E.y,E.z),R.subVectors(E,O).normalize(),_.push(R.x,R.y,R.z),x.push(b/a),x.push(A/d)}}for(A=1;A<=a;A++)for(b=1;b<=d;b++){var j=(d+1)*A+(b-1),te=(d+1)*A+b,J=(d+1)*(A-1)+b;C.push((d+1)*(A-1)+(b-1),j,J),C.push(j,te,J)}function k(U,K,ee,Q,oe){var me=Math.cos(U),fe=Math.sin(U),ge=ee/K*U,$=Math.cos(ge);oe.x=Q*(2+$)*.5*me,oe.y=Q*(2+$)*fe*.5,oe.z=Q*Math.sin(ge)*.5}this.setIndex(C),this.setAttribute("position",new Float32BufferAttribute(w,3)),this.setAttribute("normal",new Float32BufferAttribute(_,3)),this.setAttribute("uv",new Float32BufferAttribute(x,2))}function TubeGeometry(s,e,a,d,v,g){Geometry.call(this),this.type="TubeGeometry",this.parameters={path:s,tubularSegments:e,radius:a,radialSegments:d,closed:v},void 0!==g&&console.warn("TubeGeometry: taper has been removed.");var C=new TubeBufferGeometry(s,e,a,d,v);this.tangents=C.tangents,this.normals=C.normals,this.binormals=C.binormals,this.fromBufferGeometry(C),this.mergeVertices()}function TubeBufferGeometry(s,e,a,d,v){BufferGeometry.call(this),this.type="TubeBufferGeometry",this.parameters={path:s,tubularSegments:e,radius:a,radialSegments:d,closed:v},a=a||1,d=d||8;var g=s.computeFrenetFrames(e=e||64,v=v||!1);this.tangents=g.tangents,this.normals=g.normals,this.binormals=g.binormals;var b,A,C=new Vector3,w=new Vector3,_=new Vector2,x=new Vector3,E=[],R=[],O=[],D=[];function L(z){x=s.getPointAt(z/e,x);var H=g.normals[z],X=g.binormals[z];for(A=0;A<=d;A++){var re=A/d*Math.PI*2,j=Math.sin(re),te=-Math.cos(re);w.x=te*H.x+j*X.x,w.y=te*H.y+j*X.y,w.z=te*H.z+j*X.z,w.normalize(),R.push(w.x,w.y,w.z),C.x=x.x+a*w.x,C.y=x.y+a*w.y,C.z=x.z+a*w.z,E.push(C.x,C.y,C.z)}}(function(){for(b=0;b<e;b++)L(b);L(!1===v?e:0),function(){for(b=0;b<=e;b++)for(A=0;A<=d;A++)_.x=b/e,_.y=A/d,O.push(_.x,_.y)}(),function(){for(A=1;A<=e;A++)for(b=1;b<=d;b++){var H=(d+1)*A+(b-1),X=(d+1)*A+b,re=(d+1)*(A-1)+b;D.push((d+1)*(A-1)+(b-1),H,re),D.push(H,X,re)}}()})(),this.setIndex(D),this.setAttribute("position",new Float32BufferAttribute(E,3)),this.setAttribute("normal",new Float32BufferAttribute(R,3)),this.setAttribute("uv",new Float32BufferAttribute(O,2))}function AxesHelper(s){var e=[0,0,0,s=s||1,0,0,0,0,0,0,s,0,0,0,0,0,0,s],d=new BufferGeometry;d.setAttribute("position",new Float32BufferAttribute(e,3)),d.setAttribute("color",new Float32BufferAttribute([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var v=new LineBasicMaterial({vertexColors:VertexColors});LineSegments.call(this,d,v)}function Box3Helper(s,e){this.type="Box3Helper",this.box=s,e=e||16776960;var a=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),v=new BufferGeometry;v.setIndex(new BufferAttribute(a,1)),v.setAttribute("position",new Float32BufferAttribute([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),LineSegments.call(this,v,new LineBasicMaterial({color:e})),this.geometry.computeBoundingSphere()}IcosahedronGeometry.prototype=Object.create(Geometry.prototype),IcosahedronGeometry.prototype.constructor=IcosahedronGeometry,IcosahedronBufferGeometry.prototype=Object.create(PolyhedronBufferGeometry.prototype),IcosahedronBufferGeometry.prototype.constructor=IcosahedronBufferGeometry,LatheGeometry.prototype=Object.create(Geometry.prototype),LatheGeometry.prototype.constructor=LatheGeometry,LatheBufferGeometry.prototype=Object.create(BufferGeometry.prototype),LatheBufferGeometry.prototype.constructor=LatheBufferGeometry,RingGeometry.prototype=Object.create(Geometry.prototype),RingGeometry.prototype.constructor=RingGeometry,RingBufferGeometry.prototype=Object.create(BufferGeometry.prototype),RingBufferGeometry.prototype.constructor=RingBufferGeometry,ShapeGeometry.prototype=Object.create(Geometry.prototype),ShapeGeometry.prototype.constructor=ShapeGeometry,ShapeGeometry.prototype.toJSON=function(){var s=Geometry.prototype.toJSON.call(this);return toJSON$1(this.parameters.shapes,s)},ShapeBufferGeometry.prototype=Object.create(BufferGeometry.prototype),ShapeBufferGeometry.prototype.constructor=ShapeBufferGeometry,ShapeBufferGeometry.prototype.toJSON=function(){var s=BufferGeometry.prototype.toJSON.call(this);return toJSON$1(this.parameters.shapes,s)},TetrahedronGeometry.prototype=Object.create(Geometry.prototype),TetrahedronGeometry.prototype.constructor=TetrahedronGeometry,TetrahedronBufferGeometry.prototype=Object.create(PolyhedronBufferGeometry.prototype),TetrahedronBufferGeometry.prototype.constructor=TetrahedronBufferGeometry,TextGeometry.prototype=Object.create(Geometry.prototype),TextGeometry.prototype.constructor=TextGeometry,TextBufferGeometry.prototype=Object.create(ExtrudeBufferGeometry.prototype),TextBufferGeometry.prototype.constructor=TextBufferGeometry,TorusKnotGeometry.prototype=Object.create(Geometry.prototype),TorusKnotGeometry.prototype.constructor=TorusKnotGeometry,TorusKnotBufferGeometry.prototype=Object.create(BufferGeometry.prototype),TorusKnotBufferGeometry.prototype.constructor=TorusKnotBufferGeometry,TubeGeometry.prototype=Object.create(Geometry.prototype),TubeGeometry.prototype.constructor=TubeGeometry,TubeBufferGeometry.prototype=Object.create(BufferGeometry.prototype),TubeBufferGeometry.prototype.constructor=TubeBufferGeometry,TubeBufferGeometry.prototype.toJSON=function(){var s=BufferGeometry.prototype.toJSON.call(this);return s.path=this.parameters.path.toJSON(),s},AxesHelper.prototype=Object.create(LineSegments.prototype),AxesHelper.prototype.constructor=AxesHelper,Box3Helper.prototype=Object.create(LineSegments.prototype),Box3Helper.prototype.constructor=Box3Helper,Box3Helper.prototype.updateMatrixWorld=function(s){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),Object3D.prototype.updateMatrixWorld.call(this,s))};var _box$3=new Box3;function BoxHelper(s,e){this.object=s,void 0===e&&(e=16776960);var a=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),d=new Float32Array(24),v=new BufferGeometry;v.setIndex(new BufferAttribute(a,1)),v.setAttribute("position",new BufferAttribute(d,3)),LineSegments.call(this,v,new LineBasicMaterial({color:e})),this.matrixAutoUpdate=!1,this.update()}BoxHelper.prototype=Object.create(LineSegments.prototype),BoxHelper.prototype.constructor=BoxHelper,BoxHelper.prototype.update=function(s){if(void 0!==s&&console.warn("BoxHelper: .update() has no longer arguments."),void 0!==this.object&&_box$3.setFromObject(this.object),!_box$3.isEmpty()){var e=_box$3.min,a=_box$3.max,d=this.geometry.attributes.position,v=d.array;v[0]=a.x,v[1]=a.y,v[2]=a.z,v[3]=e.x,v[4]=a.y,v[5]=a.z,v[6]=e.x,v[7]=e.y,v[8]=a.z,v[9]=a.x,v[10]=e.y,v[11]=a.z,v[12]=a.x,v[13]=a.y,v[14]=e.z,v[15]=e.x,v[16]=a.y,v[17]=e.z,v[18]=e.x,v[19]=e.y,v[20]=e.z,v[21]=a.x,v[22]=e.y,v[23]=e.z,d.needsUpdate=!0,this.geometry.computeBoundingSphere()}},BoxHelper.prototype.setFromObject=function(s){return this.object=s,this.update(),this},BoxHelper.prototype.copy=function(s){return LineSegments.prototype.copy.call(this,s),this.object=s.object,this},BoxHelper.prototype.clone=function(){return(new this.constructor).copy(this)};var _vector$9=new Vector3,_camera=new Camera;function CameraHelper(s){var e=new BufferGeometry,a=new LineBasicMaterial({color:16777215,vertexColors:FaceColors}),d=[],v=[],g={},C=new Color(16755200),w=new Color(16711680),_=new Color(43775),x=new Color(16777215),b=new Color(3355443);function A(R,O,D){E(R,D),E(O,D)}function E(R,O){d.push(0,0,0),v.push(O.r,O.g,O.b),void 0===g[R]&&(g[R]=[]),g[R].push(d.length/3-1)}A("n1","n2",C),A("n2","n4",C),A("n4","n3",C),A("n3","n1",C),A("f1","f2",C),A("f2","f4",C),A("f4","f3",C),A("f3","f1",C),A("n1","f1",C),A("n2","f2",C),A("n3","f3",C),A("n4","f4",C),A("p","n1",w),A("p","n2",w),A("p","n3",w),A("p","n4",w),A("u1","u2",_),A("u2","u3",_),A("u3","u1",_),A("c","t",x),A("p","c",b),A("cn1","cn2",b),A("cn3","cn4",b),A("cf1","cf2",b),A("cf3","cf4",b),e.setAttribute("position",new Float32BufferAttribute(d,3)),e.setAttribute("color",new Float32BufferAttribute(v,3)),LineSegments.call(this,e,a),this.camera=s,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=s.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=g,this.update()}function setPoint(s,e,a,d,v,g,C){_vector$9.set(v,g,C).unproject(d);var w=e[s];if(void 0!==w)for(var _=a.getAttribute("position"),x=0,b=w.length;x<b;x++)_.setXYZ(w[x],_vector$9.x,_vector$9.y,_vector$9.z)}CameraHelper.prototype=Object.create(LineSegments.prototype),CameraHelper.prototype.constructor=CameraHelper,CameraHelper.prototype.update=function(){var s=this.geometry,e=this.pointMap;_camera.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),setPoint("c",e,s,_camera,0,0,-1),setPoint("t",e,s,_camera,0,0,1),setPoint("n1",e,s,_camera,-1,-1,-1),setPoint("n2",e,s,_camera,1,-1,-1),setPoint("n3",e,s,_camera,-1,1,-1),setPoint("n4",e,s,_camera,1,1,-1),setPoint("f1",e,s,_camera,-1,-1,1),setPoint("f2",e,s,_camera,1,-1,1),setPoint("f3",e,s,_camera,-1,1,1),setPoint("f4",e,s,_camera,1,1,1),setPoint("u1",e,s,_camera,.7,1.1,-1),setPoint("u2",e,s,_camera,-.7,1.1,-1),setPoint("u3",e,s,_camera,0,2,-1),setPoint("cf1",e,s,_camera,-1,0,1),setPoint("cf2",e,s,_camera,1,0,1),setPoint("cf3",e,s,_camera,0,-1,1),setPoint("cf4",e,s,_camera,0,1,1),setPoint("cn1",e,s,_camera,-1,0,-1),setPoint("cn2",e,s,_camera,1,0,-1),setPoint("cn3",e,s,_camera,0,-1,-1),setPoint("cn4",e,s,_camera,0,1,-1),s.getAttribute("position").needsUpdate=!0};var _v1$7=new Vector3,_v2$5=new Vector3,_v3$1=new Vector3;function DirectionalLightHelper(s,e,a){Object3D.call(this),this.light=s,this.light.updateMatrixWorld(),this.matrix=s.matrixWorld,this.matrixAutoUpdate=!1,this.color=a,void 0===e&&(e=1);var d=new BufferGeometry;d.setAttribute("position",new Float32BufferAttribute([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var v=new LineBasicMaterial({fog:!1});this.lightPlane=new Line(d,v),this.add(this.lightPlane),(d=new BufferGeometry).setAttribute("position",new Float32BufferAttribute([0,0,0,0,0,1],3)),this.targetLine=new Line(d,v),this.add(this.targetLine),this.update()}function GridHelper(s,e,a,d){s=s||10,e=e||10,a=new Color(void 0!==a?a:4473924),d=new Color(void 0!==d?d:8947848);for(var v=e/2,g=s/e,C=s/2,w=[],_=[],x=0,b=0,A=-C;x<=e;x++,A+=g){w.push(-C,0,A,C,0,A),w.push(A,0,-C,A,0,C);var E=x===v?a:d;E.toArray(_,b),E.toArray(_,b+=3),E.toArray(_,b+=3),E.toArray(_,b+=3),b+=3}var R=new BufferGeometry;R.setAttribute("position",new Float32BufferAttribute(w,3)),R.setAttribute("color",new Float32BufferAttribute(_,3));var O=new LineBasicMaterial({vertexColors:VertexColors});LineSegments.call(this,R,O)}DirectionalLightHelper.prototype=Object.create(Object3D.prototype),DirectionalLightHelper.prototype.constructor=DirectionalLightHelper,DirectionalLightHelper.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},DirectionalLightHelper.prototype.update=function(){_v1$7.setFromMatrixPosition(this.light.matrixWorld),_v2$5.setFromMatrixPosition(this.light.target.matrixWorld),_v3$1.subVectors(_v2$5,_v1$7),this.lightPlane.lookAt(_v2$5),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(_v2$5),this.targetLine.scale.z=_v3$1.length()},GridHelper.prototype=Object.assign(Object.create(LineSegments.prototype),{constructor:GridHelper,copy:function(e){return LineSegments.prototype.copy.call(this,e),this.geometry.copy(e.geometry),this.material.copy(e.material),this},clone:function(){return(new this.constructor).copy(this)}});var _vector$a=new Vector3,_color1=new Color,_color2=new Color;function HemisphereLightHelper(s,e,a){Object3D.call(this),this.light=s,this.light.updateMatrixWorld(),this.matrix=s.matrixWorld,this.matrixAutoUpdate=!1,this.color=a;var d=new OctahedronBufferGeometry(e);d.rotateY(.5*Math.PI),this.material=new MeshBasicMaterial({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=VertexColors);var v=d.getAttribute("position"),g=new Float32Array(3*v.count);d.setAttribute("color",new BufferAttribute(g,3)),this.add(new Mesh(d,this.material)),this.update()}function PlaneHelper(s,e,a){this.type="PlaneHelper",this.plane=s,this.size=void 0===e?1:e;var d=void 0!==a?a:16776960,g=new BufferGeometry;g.setAttribute("position",new Float32BufferAttribute([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),g.computeBoundingSphere(),Line.call(this,g,new LineBasicMaterial({color:d}));var w=new BufferGeometry;w.setAttribute("position",new Float32BufferAttribute([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),w.computeBoundingSphere(),this.add(new Mesh(w,new MeshBasicMaterial({color:d,opacity:.2,transparent:!0,depthWrite:!1})))}function PointLightHelper(s,e,a){this.light=s,this.light.updateMatrixWorld(),this.color=a;var d=new SphereBufferGeometry(e,4,2),v=new MeshBasicMaterial({wireframe:!0,fog:!1});Mesh.call(this,d,v),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function PolarGridHelper(s,e,a,d,v,g){s=s||10,e=e||16,a=a||8,d=d||64,v=new Color(void 0!==v?v:4473924),g=new Color(void 0!==g?g:8947848);var _,x,b,A,E,R,O,C=[],w=[];for(A=0;A<=e;A++)b=A/e*(2*Math.PI),_=Math.sin(b)*s,x=Math.cos(b)*s,C.push(0,0,0),C.push(_,0,x),w.push((O=1&A?v:g).r,O.g,O.b),w.push(O.r,O.g,O.b);for(A=0;A<=a;A++)for(O=1&A?v:g,R=s-s/a*A,E=0;E<d;E++)b=E/d*(2*Math.PI),_=Math.sin(b)*R,x=Math.cos(b)*R,C.push(_,0,x),w.push(O.r,O.g,O.b),b=(E+1)/d*(2*Math.PI),_=Math.sin(b)*R,x=Math.cos(b)*R,C.push(_,0,x),w.push(O.r,O.g,O.b);var D=new BufferGeometry;D.setAttribute("position",new Float32BufferAttribute(C,3)),D.setAttribute("color",new Float32BufferAttribute(w,3));var F=new LineBasicMaterial({vertexColors:VertexColors});LineSegments.call(this,D,F)}HemisphereLightHelper.prototype=Object.create(Object3D.prototype),HemisphereLightHelper.prototype.constructor=HemisphereLightHelper,HemisphereLightHelper.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},HemisphereLightHelper.prototype.update=function(){var s=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var e=s.geometry.getAttribute("color");_color1.copy(this.light.color),_color2.copy(this.light.groundColor);for(var a=0,d=e.count;a<d;a++){var v=a<d/2?_color1:_color2;e.setXYZ(a,v.r,v.g,v.b)}e.needsUpdate=!0}s.lookAt(_vector$a.setFromMatrixPosition(this.light.matrixWorld).negate())},PlaneHelper.prototype=Object.create(Line.prototype),PlaneHelper.prototype.constructor=PlaneHelper,PlaneHelper.prototype.updateMatrixWorld=function(s){var e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.children[0].material.side=e<0?BackSide:FrontSide,this.lookAt(this.plane.normal),Object3D.prototype.updateMatrixWorld.call(this,s)},PointLightHelper.prototype=Object.create(Mesh.prototype),PointLightHelper.prototype.constructor=PointLightHelper,PointLightHelper.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},PointLightHelper.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},PolarGridHelper.prototype=Object.create(LineSegments.prototype),PolarGridHelper.prototype.constructor=PolarGridHelper;var _vector$b=new Vector3;function SpotLightHelper(s,e){Object3D.call(this),this.light=s,this.light.updateMatrixWorld(),this.matrix=s.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;for(var a=new BufferGeometry,d=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],v=0,g=1;v<32;v++,g++){var w=v/32*Math.PI*2,_=g/32*Math.PI*2;d.push(Math.cos(w),Math.sin(w),1,Math.cos(_),Math.sin(_),1)}a.setAttribute("position",new Float32BufferAttribute(d,3));var x=new LineBasicMaterial({fog:!1});this.cone=new LineSegments(a,x),this.add(this.cone),this.update()}function AmbientLightProbe(s,e){LightProbe.call(this,void 0,e);var a=(new Color).set(s);this.sh.coefficients[0].set(a.r,a.g,a.b).multiplyScalar(2*Math.sqrt(Math.PI))}function HemisphereLight(s,e,a){Light.call(this,s,a),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Object3D.DefaultUp),this.updateMatrix(),this.groundColor=new Color(e)}function HemisphereLightProbe(s,e,a){LightProbe.call(this,void 0,a);var d=(new Color).set(s),v=(new Color).set(e),g=new Vector3(d.r,d.g,d.b),C=new Vector3(v.r,v.g,v.b),w=Math.sqrt(Math.PI),_=w*Math.sqrt(.75);this.sh.coefficients[0].copy(g).add(C).multiplyScalar(w),this.sh.coefficients[1].copy(g).sub(C).multiplyScalar(_)}function RectAreaLight(s,e,a,d){Light.call(this,s,e),this.type="RectAreaLight",this.width=void 0!==a?a:10,this.height=void 0!==d?d:10}function AnimationLoader(s){Loader.call(this,s)}function AudioLoader(s){Loader.call(this,s)}function BufferGeometryLoader(s){Loader.call(this,s)}SpotLightHelper.prototype=Object.create(Object3D.prototype),SpotLightHelper.prototype.constructor=SpotLightHelper,SpotLightHelper.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},SpotLightHelper.prototype.update=function(){this.light.updateMatrixWorld();var s=this.light.distance?this.light.distance:1e3,e=s*Math.tan(this.light.angle);this.cone.scale.set(e,e,s),_vector$b.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(_vector$b),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)},AmbientLightProbe.prototype=Object.assign(Object.create(LightProbe.prototype),{constructor:AmbientLightProbe,isAmbientLightProbe:!0,copy:function(e){return LightProbe.prototype.copy.call(this,e),this},toJSON:function(e){return LightProbe.prototype.toJSON.call(this,e)}}),HemisphereLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:HemisphereLight,isHemisphereLight:!0,copy:function(e){return Light.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),HemisphereLightProbe.prototype=Object.assign(Object.create(LightProbe.prototype),{constructor:HemisphereLightProbe,isHemisphereLightProbe:!0,copy:function(e){return LightProbe.prototype.copy.call(this,e),this},toJSON:function(e){return LightProbe.prototype.toJSON.call(this,e)}}),RectAreaLight.prototype=Object.assign(Object.create(Light.prototype),{constructor:RectAreaLight,isRectAreaLight:!0,copy:function(e){return Light.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){var a=Light.prototype.toJSON.call(this,e);return a.object.width=this.width,a.object.height=this.height,a}}),AnimationLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:AnimationLoader,load:function(e,a,d,v){var g=this,C=new FileLoader(g.manager);C.setPath(g.path),C.load(e,function(w){a(g.parse(JSON.parse(w)))},d,v)},parse:function(e){for(var a=[],d=0;d<e.length;d++){var v=AnimationClip.parse(e[d]);a.push(v)}return a}}),AudioLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:AudioLoader,load:function(e,a,d,v){var g=new FileLoader(this.manager);g.setResponseType("arraybuffer"),g.setPath(this.path),g.load(e,function(C){var w=C.slice(0);AudioContext.getContext().decodeAudioData(w,function(x){a(x)})},d,v)}}),BufferGeometryLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:BufferGeometryLoader,load:function(e,a,d,v){var g=this,C=new FileLoader(g.manager);C.setPath(g.path),C.load(e,function(w){a(g.parse(JSON.parse(w)))},d,v)},parse:function(e){var a=e.isInstancedBufferGeometry?new InstancedBufferGeometry:new BufferGeometry,d=e.data.index;if(void 0!==d){var v=new TYPED_ARRAYS[d.type](d.array);a.setIndex(new BufferAttribute(v,1))}var g=e.data.attributes;for(var C in g){v=new TYPED_ARRAYS[(w=g[C]).type](w.array);var x=new(w.isInstancedBufferAttribute?InstancedBufferAttribute:BufferAttribute)(v,w.itemSize,w.normalized);void 0!==w.name&&(x.name=w.name),a.setAttribute(C,x)}var b=e.data.morphAttributes;if(b)for(var C in b){for(var A=b[C],E=[],R=0,O=A.length;R<O;R++){var w;x=new BufferAttribute(v=new TYPED_ARRAYS[(w=A[R]).type](w.array),w.itemSize,w.normalized),void 0!==w.name&&(x.name=w.name),E.push(x)}a.morphAttributes[C]=E}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);var F=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==F){R=0;for(var L=F.length;R!==L;++R){var I=F[R];a.addGroup(I.start,I.count,I.materialIndex)}}var V=e.data.boundingSphere;if(void 0!==V){var z=new Vector3;void 0!==V.center&&z.fromArray(V.center),a.boundingSphere=new Sphere(z,V.radius)}return e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}});var TYPED_ARRAYS={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function CubeTextureLoader(s){Loader.call(this,s)}function FontLoader(s){Loader.call(this,s)}function ImageBitmapLoader(s){"undefined"==typeof createImageBitmap&&console.warn("ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("ImageBitmapLoader: fetch() not supported."),Loader.call(this,s),this.options=void 0}CubeTextureLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:CubeTextureLoader,load:function(e,a,d,v){var g=new CubeTexture,C=new ImageLoader(this.manager);C.setCrossOrigin(this.crossOrigin),C.setPath(this.path);var w=0;function _(b){C.load(e[b],function(A){g.images[b]=A,6==++w&&(g.needsUpdate=!0,a&&a(g))},void 0,v)}for(var x=0;x<e.length;++x)_(x);return g}}),FontLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:FontLoader,load:function(e,a,d,v){var g=this,C=new FileLoader(this.manager);C.setPath(this.path),C.load(e,function(w){var _;try{_=JSON.parse(w)}catch(b){console.warn("FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),_=JSON.parse(w.substring(65,w.length-2))}var x=g.parse(_);a&&a(x)},d,v)},parse:function(e){return new Font(e)}}),ImageBitmapLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:ImageBitmapLoader,setOptions:function(e){return this.options=e,this},load:function(e,a,d,v){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var g=this,C=Cache.get(e);if(void 0!==C)return g.manager.itemStart(e),setTimeout(function(){a&&a(C),g.manager.itemEnd(e)},0),C;fetch(e).then(function(w){return w.blob()}).then(function(w){return void 0===g.options?createImageBitmap(w):createImageBitmap(w,g.options)}).then(function(w){Cache.add(e,w),a&&a(w),g.manager.itemEnd(e)}).catch(function(w){v&&v(w),g.manager.itemError(e),g.manager.itemEnd(e)}),g.manager.itemStart(e)}});var _instanceLocalMatrix=new Matrix4,_instanceWorldMatrix=new Matrix4,_instanceIntersects=[],_mesh=new Mesh;function InstancedMesh(s,e,a){Mesh.call(this,s,e),this.instanceMatrix=new BufferAttribute(new Float32Array(16*a),16),this.count=a,this.frustumCulled=!1}InstancedMesh.prototype=Object.assign(Object.create(Mesh.prototype),{constructor:InstancedMesh,isInstancedMesh:!0,getMatrixAt:function(e,a){a.fromArray(this.instanceMatrix.array,16*e)},raycast:function(e,a){var d=this.matrixWorld,v=this.count;if(_mesh.geometry=this.geometry,_mesh.material=this.material,void 0!==_mesh.material)for(var g=0;g<v;g++)this.getMatrixAt(g,_instanceLocalMatrix),_instanceWorldMatrix.multiplyMatrices(d,_instanceLocalMatrix),_mesh.matrixWorld=_instanceWorldMatrix,_mesh.raycast(e,_instanceIntersects),_instanceIntersects.length>0&&(_instanceIntersects[0].instanceId=g,_instanceIntersects[0].object=this,a.push(_instanceIntersects[0]),_instanceIntersects.length=0)},setMatrixAt:function(e,a){a.toArray(this.instanceMatrix.array,16*e)},updateMorphTargets:function(){}});var _v1$8=new Vector3,_v2$6=new Vector3;function LOD(){Object3D.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function Fog(s,e,a){this.name="",this.color=new Color(s),this.near=void 0!==e?e:1,this.far=void 0!==a?a:1e3}function FogExp2(s,e){this.name="",this.color=new Color(s),this.density=void 0!==e?e:25e-5}LOD.prototype=Object.assign(Object.create(Object3D.prototype),{constructor:LOD,isLOD:!0,copy:function(e){Object3D.prototype.copy.call(this,e,!1);for(var a=e.levels,d=0,v=a.length;d<v;d++){var g=a[d];this.addLevel(g.object.clone(),g.distance)}return this.autoUpdate=e.autoUpdate,this},addLevel:function(e,a){void 0===a&&(a=0),a=Math.abs(a);for(var d=this.levels,v=0;v<d.length&&!(a<d[v].distance);v++);return d.splice(v,0,{distance:a,object:e}),this.add(e),this},getObjectForDistance:function(e){var a=this.levels;if(a.length>0){for(var d=1,v=a.length;d<v&&!(e<a[d].distance);d++);return a[d-1].object}return null},raycast:function(e,a){if(this.levels.length>0){_v1$8.setFromMatrixPosition(this.matrixWorld);var v=e.ray.origin.distanceTo(_v1$8);this.getObjectForDistance(v).raycast(e,a)}},update:function(e){var a=this.levels;if(a.length>1){_v1$8.setFromMatrixPosition(e.matrixWorld),_v2$6.setFromMatrixPosition(this.matrixWorld);var d=_v1$8.distanceTo(_v2$6);a[0].object.visible=!0;for(var v=1,g=a.length;v<g&&d>=a[v].distance;v++)a[v-1].object.visible=!1,a[v].object.visible=!0;for(;v<g;v++)a[v].object.visible=!1}},toJSON:function(e){var a=Object3D.prototype.toJSON.call(this,e);!1===this.autoUpdate&&(a.object.autoUpdate=!1),a.object.levels=[];for(var d=this.levels,v=0,g=d.length;v<g;v++){var C=d[v];a.object.levels.push({object:C.object.uuid,distance:C.distance})}return a}}),Object.assign(Fog.prototype,{isFog:!0,clone:function(){return new Fog(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.assign(FogExp2.prototype,{isFogExp2:!0,clone:function(){return new FogExp2(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}});var Geometries={WireframeGeometry:WireframeGeometry,TetrahedronGeometry:TetrahedronGeometry,TetrahedronBufferGeometry:TetrahedronBufferGeometry,OctahedronGeometry:OctahedronGeometry,OctahedronBufferGeometry:OctahedronBufferGeometry,IcosahedronGeometry:IcosahedronGeometry,IcosahedronBufferGeometry:IcosahedronBufferGeometry,DodecahedronGeometry:DodecahedronGeometry,DodecahedronBufferGeometry:DodecahedronBufferGeometry,PolyhedronGeometry:PolyhedronGeometry,PolyhedronBufferGeometry:PolyhedronBufferGeometry,TubeGeometry:TubeGeometry,TubeBufferGeometry:TubeBufferGeometry,TorusKnotGeometry:TorusKnotGeometry,TorusGeometry:TorusGeometry,TorusBufferGeometry:TorusBufferGeometry,TextGeometry:TextGeometry,TextBufferGeometry:TextBufferGeometry,SphereGeometry:SphereGeometry,SphereBufferGeometry:SphereBufferGeometry,RingGeometry:RingGeometry,RingBufferGeometry:RingBufferGeometry,PlaneGeometry:PlaneGeometry,PlaneBufferGeometry:PlaneBufferGeometry,LatheGeometry:LatheGeometry,LatheBufferGeometry:LatheBufferGeometry,ShapeGeometry:ShapeGeometry,ShapeBufferGeometry:ShapeBufferGeometry,ExtrudeGeometry:ExtrudeGeometry,ExtrudeBufferGeometry:ExtrudeBufferGeometry,EdgesGeometry:EdgesGeometry,ConeGeometry:ConeGeometry,ConeBufferGeometry:ConeBufferGeometry,CylinderGeometry:CylinderGeometry,CylinderBufferGeometry:CylinderBufferGeometry,CircleGeometry:CircleGeometry,CircleBufferGeometry:CircleBufferGeometry,BoxGeometry:BoxGeometry,BoxBufferGeometry:BoxBufferGeometry},Curves$1={ArcCurve:ArcCurve,CatmullRomCurve3:CatmullRomCurve3,CubicBezierCurve:CubicBezierCurve,CubicBezierCurve3:CubicBezierCurve3,EllipseCurve:EllipseCurve,LineCurve:LineCurve,LineCurve3:LineCurve3,QuadraticBezierCurve:QuadraticBezierCurve,QuadraticBezierCurve3:QuadraticBezierCurve3,SplineCurve:SplineCurve,GrannyKnot:GrannyKnot,HeartCurve:HeartCurve,VivianiCurve:VivianiCurve,KnotCurve:KnotCurve,HelixCurve:HelixCurve,TrefoilKnot:TrefoilKnot,TorusKnot:TorusKnot,CinquefoilKnot:CinquefoilKnot,TrefoilPolynomialKnot:TrefoilPolynomialKnot,FigureEightPolynomialKnot:FigureEightPolynomialKnot,DecoratedTorusKnot4a:DecoratedTorusKnot4a,DecoratedTorusKnot4b:DecoratedTorusKnot4b,DecoratedTorusKnot5a:DecoratedTorusKnot5a,DecoratedTorusKnot5c:DecoratedTorusKnot5c};function ObjectLoader(s){Loader.call(this,s)}ObjectLoader.prototype=Object.assign(Object.create(Loader.prototype),{constructor:ObjectLoader,load:function(e,a,d,v){var g=this,C=""===this.path?LoaderUtils.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||C;var w=new FileLoader(g.manager);w.setPath(this.path),w.load(e,function(_){var x=null;try{x=JSON.parse(_)}catch(A){return void 0!==v&&v(A),void console.error("THREE:ObjectLoader: Can't parse "+e+".",A.message)}var b=x.metadata;void 0!==b&&void 0!==b.type&&"geometry"!==b.type.toLowerCase()?g.parse(x,a):console.error("ObjectLoader: Can't load "+e)},d,v)},parse:function(e,a){var d=this.parseShape(e.shapes),v=this.parseGeometries(e.geometries,d),g=this.parseImages(e.images,function(){void 0!==a&&a(_)}),C=this.parseTextures(e.textures,g),w=this.parseMaterials(e.materials,C),_=this.parseObject(e.object,v,w);return e.animations&&(_.animations=this.parseAnimations(e.animations)),(void 0===e.images||0===e.images.length)&&void 0!==a&&a(_),_},parseShape:function(e){var a={};if(void 0!==e)for(var d=0,v=e.length;d<v;d++){var g=(new Shape).fromJSON(e[d]);a[g.uuid]=g}return a},parseGeometries:function(e,a){var d={};if(void 0!==e)for(var v=new BufferGeometryLoader,g=0,C=e.length;g<C;g++){var w,_=e[g];switch(_.type){case"PlaneGeometry":case"PlaneBufferGeometry":w=new Geometries[_.type](_.width,_.height,_.widthSegments,_.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":w=new Geometries[_.type](_.width,_.height,_.depth,_.widthSegments,_.heightSegments,_.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":w=new Geometries[_.type](_.radius,_.segments,_.thetaStart,_.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":w=new Geometries[_.type](_.radiusTop,_.radiusBottom,_.height,_.radialSegments,_.heightSegments,_.openEnded,_.thetaStart,_.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":w=new Geometries[_.type](_.radius,_.height,_.radialSegments,_.heightSegments,_.openEnded,_.thetaStart,_.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":w=new Geometries[_.type](_.radius,_.widthSegments,_.heightSegments,_.phiStart,_.phiLength,_.thetaStart,_.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":w=new Geometries[_.type](_.radius,_.detail);break;case"RingGeometry":case"RingBufferGeometry":w=new Geometries[_.type](_.innerRadius,_.outerRadius,_.thetaSegments,_.phiSegments,_.thetaStart,_.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":w=new Geometries[_.type](_.radius,_.tube,_.radialSegments,_.tubularSegments,_.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":w=new Geometries[_.type](_.radius,_.tube,_.tubularSegments,_.radialSegments,_.p,_.q);break;case"TubeGeometry":case"TubeBufferGeometry":w=new Geometries[_.type]((new Curves$1[_.path.type]).fromJSON(_.path),_.tubularSegments,_.radius,_.radialSegments,_.closed);break;case"LatheGeometry":case"LatheBufferGeometry":w=new Geometries[_.type](_.points,_.segments,_.phiStart,_.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":w=new Geometries[_.type](_.vertices,_.indices,_.radius,_.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var x=[],b=0,A=_.shapes.length;b<A;b++)x.push(a[_.shapes[b]]);w=new Geometries[_.type](x,_.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(x=[],b=0,A=_.shapes.length;b<A;b++)x.push(a[_.shapes[b]]);var R=_.options.extrudePath;void 0!==R&&(_.options.extrudePath=(new Curves$1[R.type]).fromJSON(R)),w=new Geometries[_.type](x,_.options);break;case"BufferGeometry":case"InstancedBufferGeometry":w=v.parse(_);break;case"Geometry":"THREE"in window&&"LegacyJSONLoader"in THREE?w=(new LegacyJSONLoader).parse(_,this.resourcePath).geometry:console.error('ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:console.warn('ObjectLoader: Unsupported geometry type "'+_.type+'"');continue}w.uuid=_.uuid,void 0!==_.name&&(w.name=_.name),!0===w.isBufferGeometry&&void 0!==_.userData&&(w.userData=_.userData),d[_.uuid]=w}return d},parseMaterials:function(e,a){var d={},v={};if(void 0!==e){var g=new MaterialLoader;g.setTextures(a);for(var C=0,w=e.length;C<w;C++){var _=e[C];if("MultiMaterial"===_.type){for(var x=[],b=0;b<_.materials.length;b++){var A=_.materials[b];void 0===d[A.uuid]&&(d[A.uuid]=g.parse(A)),x.push(d[A.uuid])}v[_.uuid]=x}else void 0===d[_.uuid]&&(d[_.uuid]=g.parse(_)),v[_.uuid]=d[_.uuid]}}return v},parseAnimations:function(e){for(var a=[],d=0;d<e.length;d++){var v=e[d],g=AnimationClip.parse(v);void 0!==v.uuid&&(g.uuid=v.uuid),a.push(g)}return a},parseImages:function(e,a){var d=this,v={};function g(F){return d.manager.itemStart(F),w.load(F,function(){d.manager.itemEnd(F)},void 0,function(){d.manager.itemError(F),d.manager.itemEnd(F)})}if(void 0!==e&&e.length>0){var w=new ImageLoader(new LoadingManager(a));w.setCrossOrigin(this.crossOrigin);for(var _=0,x=e.length;_<x;_++){var b=e[_],A=b.url;if(Array.isArray(A)){v[b.uuid]=[];for(var E=0,R=A.length;E<R;E++){var O=A[E],D=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(O)?O:d.resourcePath+O;v[b.uuid].push(g(D))}}else D=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(b.url)?b.url:d.resourcePath+b.url,v[b.uuid]=g(D)}}return v},parseTextures:function(e,a){function d(x,b){return"number"==typeof x?x:(console.warn("ObjectLoader.parseTexture: Constant should be in numeric form.",x),b[x])}var v={};if(void 0!==e)for(var g=0,C=e.length;g<C;g++){var _,w=e[g];void 0===w.image&&console.warn('ObjectLoader: No "image" specified for',w.uuid),void 0===a[w.image]&&console.warn("ObjectLoader: Undefined image",w.image),(_=Array.isArray(a[w.image])?new CubeTexture(a[w.image]):new Texture(a[w.image])).needsUpdate=!0,_.uuid=w.uuid,void 0!==w.name&&(_.name=w.name),void 0!==w.mapping&&(_.mapping=d(w.mapping,TEXTURE_MAPPING)),void 0!==w.offset&&_.offset.fromArray(w.offset),void 0!==w.repeat&&_.repeat.fromArray(w.repeat),void 0!==w.center&&_.center.fromArray(w.center),void 0!==w.rotation&&(_.rotation=w.rotation),void 0!==w.wrap&&(_.wrapS=d(w.wrap[0],TEXTURE_WRAPPING),_.wrapT=d(w.wrap[1],TEXTURE_WRAPPING)),void 0!==w.format&&(_.format=w.format),void 0!==w.type&&(_.type=w.type),void 0!==w.encoding&&(_.encoding=w.encoding),void 0!==w.minFilter&&(_.minFilter=d(w.minFilter,TEXTURE_FILTER)),void 0!==w.magFilter&&(_.magFilter=d(w.magFilter,TEXTURE_FILTER)),void 0!==w.anisotropy&&(_.anisotropy=w.anisotropy),void 0!==w.flipY&&(_.flipY=w.flipY),void 0!==w.premultiplyAlpha&&(_.premultiplyAlpha=w.premultiplyAlpha),void 0!==w.unpackAlignment&&(_.unpackAlignment=w.unpackAlignment),v[w.uuid]=_}return v},parseObject:function(e,a,d){var v;function g(L){return void 0===a[L]&&console.warn("ObjectLoader: Undefined geometry",L),a[L]}function C(L){if(void 0!==L){if(Array.isArray(L)){for(var I=[],V=0,z=L.length;V<z;V++){var H=L[V];void 0===d[H]&&console.warn("ObjectLoader: Undefined material",H),I.push(d[H])}return I}return void 0===d[L]&&console.warn("ObjectLoader: Undefined material",L),d[L]}}switch(e.type){case"Scene":v=new Scene,void 0!==e.background&&Number.isInteger(e.background)&&(v.background=new Color(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?v.fog=new Fog(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(v.fog=new FogExp2(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":v=new PerspectiveCamera(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(v.focus=e.focus),void 0!==e.zoom&&(v.zoom=e.zoom),void 0!==e.filmGauge&&(v.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(v.filmOffset=e.filmOffset),void 0!==e.view&&(v.view=Object.assign({},e.view));break;case"OrthographicCamera":v=new OrthographicCamera(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(v.zoom=e.zoom),void 0!==e.view&&(v.view=Object.assign({},e.view));break;case"AmbientLight":v=new AmbientLight(e.color,e.intensity);break;case"DirectionalLight":v=new DirectionalLight(e.color,e.intensity);break;case"PointLight":v=new PointLight(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":v=new RectAreaLight(e.color,e.intensity,e.width,e.height);break;case"SpotLight":v=new SpotLight(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":v=new HemisphereLight(e.color,e.groundColor,e.intensity);break;case"SkinnedMesh":console.warn("ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var w=g(e.geometry),_=C(e.material);v=w.bones&&w.bones.length>0?new SkinnedMesh(w,_):new Mesh(w,_);break;case"InstancedMesh":w=g(e.geometry),_=C(e.material);var b=e.instanceMatrix;(v=new InstancedMesh(w,_,e.count)).instanceMatrix=new BufferAttribute(new Float32Array(b.array),16);break;case"LOD":v=new LOD;break;case"Line":v=new Line(g(e.geometry),C(e.material),e.mode);break;case"LineLoop":v=new LineLoop(g(e.geometry),C(e.material));break;case"LineSegments":v=new LineSegments(g(e.geometry),C(e.material));break;case"PointCloud":case"Points":v=new Points(g(e.geometry),C(e.material));break;case"Sprite":v=new Sprite(C(e.material));break;case"Group":v=new Group;break;default:v=new Object3D}if(v.uuid=e.uuid,void 0!==e.name&&(v.name=e.name),void 0!==e.matrix?(v.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(v.matrixAutoUpdate=e.matrixAutoUpdate),v.matrixAutoUpdate&&v.matrix.decompose(v.position,v.quaternion,v.scale)):(void 0!==e.position&&v.position.fromArray(e.position),void 0!==e.rotation&&v.rotation.fromArray(e.rotation),void 0!==e.quaternion&&v.quaternion.fromArray(e.quaternion),void 0!==e.scale&&v.scale.fromArray(e.scale)),void 0!==e.castShadow&&(v.castShadow=e.castShadow),void 0!==e.receiveShadow&&(v.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(v.shadow.bias=e.shadow.bias),void 0!==e.shadow.radius&&(v.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&v.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(v.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(v.visible=e.visible),void 0!==e.frustumCulled&&(v.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(v.renderOrder=e.renderOrder),void 0!==e.userData&&(v.userData=e.userData),void 0!==e.layers&&(v.layers.mask=e.layers),void 0!==e.children)for(var A=e.children,E=0;E<A.length;E++)v.add(this.parseObject(A[E],a,d));if("LOD"===e.type){void 0!==e.autoUpdate&&(v.autoUpdate=e.autoUpdate);for(var R=e.levels,O=0;O<R.length;O++){var D=R[O],F=v.getObjectByProperty("uuid",D.object);void 0!==F&&v.addLevel(F,D.distance)}}return v}});var TEXTURE_MAPPING={UVMapping:UVMapping,CubeReflectionMapping:CubeReflectionMapping,CubeRefractionMapping:CubeRefractionMapping,EquirectangularReflectionMapping:EquirectangularReflectionMapping,EquirectangularRefractionMapping:EquirectangularRefractionMapping,SphericalReflectionMapping:SphericalReflectionMapping,CubeUVReflectionMapping:CubeUVReflectionMapping,CubeUVRefractionMapping:CubeUVRefractionMapping},TEXTURE_WRAPPING={RepeatWrapping:RepeatWrapping,ClampToEdgeWrapping:ClampToEdgeWrapping,MirroredRepeatWrapping:MirroredRepeatWrapping},TEXTURE_FILTER={NearestFilter:NearestFilter,NearestMipmapNearestFilter:NearestMipmapNearestFilter,NearestMipmapLinearFilter:NearestMipmapLinearFilter,LinearFilter:LinearFilter,LinearMipmapNearestFilter:LinearMipmapNearestFilter,LinearMipmapLinearFilter:LinearMipmapLinearFilter};function MeshMatcapMaterial(s){Material.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Color(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=TangentSpaceNormalMap,this.normalScale=new Vector2(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(s)}function Cylindrical(s,e,a){return this.radius=void 0!==s?s:1,this.theta=void 0!==e?e:0,this.y=void 0!==a?a:0,this}function WebGLAnimation(){var s=null,e=!1,a=null;function d(v,g){!1!==e&&(a(v,g),s.requestAnimationFrame(d))}return{start:function(){!0!==e&&null!==a&&(s.requestAnimationFrame(d),e=!0)},stop:function(){e=!1},setAnimationLoop:function(g){a=g},setContext:function(g){s=g}}}function WebGLAttributes(s,e){var a=e.isWebGL2,d=new WeakMap;return{get:function(x){return x.isInterleavedBufferAttribute&&(x=x.data),d.get(x)},remove:function(x){x.isInterleavedBufferAttribute&&(x=x.data);var b=d.get(x);b&&(s.deleteBuffer(b.buffer),d.delete(x))},update:function(x,b){x.isInterleavedBufferAttribute&&(x=x.data);var A=d.get(x);void 0===A?d.set(x,function(x,b){var A=x.array,E=x.usage,R=s.createBuffer();s.bindBuffer(b,R),s.bufferData(b,A,E),x.onUploadCallback();var O=s.FLOAT;return A instanceof Float32Array?O=s.FLOAT:A instanceof Float64Array?console.warn("WebGLAttributes: Unsupported data buffer format: Float64Array."):A instanceof Uint16Array?O=s.UNSIGNED_SHORT:A instanceof Int16Array?O=s.SHORT:A instanceof Uint32Array?O=s.UNSIGNED_INT:A instanceof Int32Array?O=s.INT:A instanceof Int8Array?O=s.BYTE:A instanceof Uint8Array&&(O=s.UNSIGNED_BYTE),{buffer:R,type:O,bytesPerElement:A.BYTES_PER_ELEMENT,version:x.version}}(x,b)):A.version<x.version&&(function(x,b,A){var E=b.array,R=b.updateRange;s.bindBuffer(A,x),-1===R.count?s.bufferSubData(A,0,E):(a?s.bufferSubData(A,R.offset*E.BYTES_PER_ELEMENT,E,R.offset,R.count):s.bufferSubData(A,R.offset*E.BYTES_PER_ELEMENT,E.subarray(R.offset,R.offset+R.count)),R.count=-1)}(A.buffer,x,b),A.version=x.version)}}}function WebGLBackground(s,e,a,d){var C,w,v=new Color(0),g=0,_=null,x=0,b=null;function E(R,O){e.buffers.color.setClear(R.r,R.g,R.b,O,d)}return{getClearColor:function(){return v},setClearColor:function(O,D){v.set(O),E(v,g=void 0!==D?D:1)},getClearAlpha:function(){return g},setClearAlpha:function(O){E(v,g=O)},render:function(R,O,D,F){var L=O.background,I=s.xr,V=I.getSession&&I.getSession();if(V&&"additive"===V.environmentBlendMode&&(L=null),null===L?E(v,g):L&&L.isColor&&(E(L,1),F=!0),(s.autoClear||F)&&s.clear(s.autoClearColor,s.autoClearDepth,s.autoClearStencil),L&&(L.isCubeTexture||L.isWebGLCubeRenderTarget||L.mapping===CubeUVReflectionMapping)){void 0===w&&((w=new Mesh(new BoxBufferGeometry(1,1,1),new ShaderMaterial({type:"BackgroundCubeMaterial",uniforms:cloneUniforms(ShaderLib.cube.uniforms),vertexShader:ShaderLib.cube.vertexShader,fragmentShader:ShaderLib.cube.fragmentShader,side:BackSide,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),w.geometry.deleteAttribute("uv"),w.onBeforeRender=function(H,X,re){this.matrixWorld.copyPosition(re.matrixWorld)},Object.defineProperty(w.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),a.update(w));var z=L.isWebGLCubeRenderTarget?L.texture:L;w.material.uniforms.envMap.value=z,w.material.uniforms.flipEnvMap.value=z.isCubeTexture?-1:1,(_!==L||x!==z.version||b!==s.toneMapping)&&(w.material.needsUpdate=!0,_=L,x=z.version,b=s.toneMapping),R.unshift(w,w.geometry,w.material,0,0,null)}else L&&L.isTexture&&(void 0===C&&((C=new Mesh(new PlaneBufferGeometry(2,2),new ShaderMaterial({type:"BackgroundMaterial",uniforms:cloneUniforms(ShaderLib.background.uniforms),vertexShader:ShaderLib.background.vertexShader,fragmentShader:ShaderLib.background.fragmentShader,side:FrontSide,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(C.material,"map",{get:function(){return this.uniforms.t2D.value}}),a.update(C)),C.material.uniforms.t2D.value=L,!0===L.matrixAutoUpdate&&L.updateMatrix(),C.material.uniforms.uvTransform.value.copy(L.matrix),(_!==L||x!==L.version||b!==s.toneMapping)&&(C.material.needsUpdate=!0,_=L,x=L.version,b=s.toneMapping),R.unshift(C,C.geometry,C.material,0,0,null))}}}function WebGLBufferRenderer(s,e,a,d){var g,v=d.isWebGL2;this.setMode=function(x){g=x},this.render=function(x,b){s.drawArrays(g,x,b),a.update(b,g)},this.renderInstances=function(x,b,A,E){if(0!==E){var R,O;if(v)R=s,O="drawArraysInstanced";else if(O="drawArraysInstancedANGLE",null===(R=e.get("ANGLE_instanced_arrays")))return void console.error("WebGLBufferRenderer: using InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");R[O](g,b,A,E),a.update(A,g,E)}}}function WebGLCapabilities(s,e,a){var d;function g(X){if("highp"===X){if(s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.HIGH_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.HIGH_FLOAT).precision>0)return"highp";X="mediump"}return"mediump"===X&&s.getShaderPrecisionFormat(s.VERTEX_SHADER,s.MEDIUM_FLOAT).precision>0&&s.getShaderPrecisionFormat(s.FRAGMENT_SHADER,s.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var C="undefined"!=typeof WebGL2RenderingContext&&s instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&s instanceof WebGL2ComputeRenderingContext,w=void 0!==a.precision?a.precision:"highp",_=g(w);_!==w&&(console.warn("WebGLRenderer:",w,"not supported, using",_,"instead."),w=_);var x=!0===a.logarithmicDepthBuffer,b=s.getParameter(s.MAX_TEXTURE_IMAGE_UNITS),A=s.getParameter(s.MAX_VERTEX_TEXTURE_IMAGE_UNITS),E=s.getParameter(s.MAX_TEXTURE_SIZE),R=s.getParameter(s.MAX_CUBE_MAP_TEXTURE_SIZE),O=s.getParameter(s.MAX_VERTEX_ATTRIBS),D=s.getParameter(s.MAX_VERTEX_UNIFORM_VECTORS),F=s.getParameter(s.MAX_VARYING_VECTORS),L=s.getParameter(s.MAX_FRAGMENT_UNIFORM_VECTORS),I=A>0,V=C||!!e.get("OES_texture_float");return{isWebGL2:C,getMaxAnisotropy:function(){if(void 0!==d)return d;var X=e.get("EXT_texture_filter_anisotropic");return d=null!==X?s.getParameter(X.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:g,precision:w,logarithmicDepthBuffer:x,maxTextures:b,maxVertexTextures:A,maxTextureSize:E,maxCubemapSize:R,maxAttributes:O,maxVertexUniforms:D,maxVaryings:F,maxFragmentUniforms:L,vertexTextures:I,floatFragmentTextures:V,floatVertexTextures:I&&V,maxSamples:C?s.getParameter(s.MAX_SAMPLES):0}}function WebGLClipping(){var s=this,e=null,a=0,d=!1,v=!1,g=new Plane,C=new Matrix3,w={value:null,needsUpdate:!1};function _(){w.value!==e&&(w.value=e,w.needsUpdate=a>0),s.numPlanes=a,s.numIntersection=0}function x(b,A,E,R){var O=null!==b?b.length:0,D=null;if(0!==O){if(D=w.value,!0!==R||null===D){var F=E+4*O,L=A.matrixWorldInverse;C.getNormalMatrix(L),(null===D||D.length<F)&&(D=new Float32Array(F));for(var I=0,V=E;I!==O;++I,V+=4)g.copy(b[I]).applyMatrix4(L,C),g.normal.toArray(D,V),D[V+3]=g.constant}w.value=D,w.needsUpdate=!0}return s.numPlanes=O,D}this.uniform=w,this.numPlanes=0,this.numIntersection=0,this.init=function(b,A,E){var R=0!==b.length||A||0!==a||d;return d=A,e=x(b,E,0),a=b.length,R},this.beginShadows=function(){v=!0,x(null)},this.endShadows=function(){v=!1,_()},this.setState=function(b,A,E,R,O,D){if(!d||null===b||0===b.length||v&&!E)v?x(null):_();else{var F=v?0:a,L=4*F,I=O.clippingState||null;w.value=I,I=x(b,R,L,D);for(var V=0;V!==L;++V)I[V]=e[V];O.clippingState=I,this.numIntersection=A?this.numPlanes:0,this.numPlanes+=F}}}function WebGLExtensions(s){var e={};return{get:function(d){if(void 0!==e[d])return e[d];var v;switch(d){case"WEBGL_depth_texture":v=s.getExtension("WEBGL_depth_texture")||s.getExtension("MOZ_WEBGL_depth_texture")||s.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":v=s.getExtension("EXT_texture_filter_anisotropic")||s.getExtension("MOZ_EXT_texture_filter_anisotropic")||s.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":v=s.getExtension("WEBGL_compressed_texture_s3tc")||s.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":v=s.getExtension("WEBGL_compressed_texture_pvrtc")||s.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:v=s.getExtension(d)}return null===v&&console.warn("WebGLRenderer: "+d+" extension not supported."),e[d]=v,v}}}function WebGLGeometries(s,e,a){var d=new WeakMap,v=new WeakMap;function g(b){var A=b.target,E=d.get(A);for(var R in null!==E.index&&e.remove(E.index),E.attributes)e.remove(E.attributes[R]);A.removeEventListener("dispose",g),d.delete(A);var O=v.get(E);O&&(e.remove(O),v.delete(E)),a.memory.geometries--}function _(b){var A=[],E=b.index,R=b.attributes.position,O=0;if(null!==E){O=E.version;for(var F=0,L=(D=E.array).length;F<L;F+=3)A.push(I=D[F+0],V=D[F+1],V,z=D[F+2],z,I)}else{var D;for(O=R.version,F=0,L=(D=R.array).length/3-1;F<L;F+=3){var I,V,z;A.push(I=F+0,V=F+1,V,z=F+2,z,I)}}var H=new(arrayMax(A)>65535?Uint32BufferAttribute:Uint16BufferAttribute)(A,1);H.version=O,e.update(H,s.ELEMENT_ARRAY_BUFFER);var X=v.get(b);X&&e.remove(X),v.set(b,H)}return{get:function(b,A){var E=d.get(A);return E||(A.addEventListener("dispose",g),A.isBufferGeometry?E=A:A.isGeometry&&(void 0===A._bufferGeometry&&(A._bufferGeometry=(new BufferGeometry).setFromObject(b)),E=A._bufferGeometry),d.set(A,E),a.memory.geometries++,E)},update:function(b){var A=b.index,E=b.attributes;for(var R in null!==A&&e.update(A,s.ELEMENT_ARRAY_BUFFER),E)e.update(E[R],s.ARRAY_BUFFER);var O=b.morphAttributes;for(var R in O)for(var D=O[R],F=0,L=D.length;F<L;F++)e.update(D[F],s.ARRAY_BUFFER)},getWireframeAttribute:function(b){var A=v.get(b);if(A){var E=b.index;null!==E&&A.version<E.version&&_(b)}else _(b);return v.get(b)}}}function WebGLIndexedBufferRenderer(s,e,a,d){var g,w,_,v=d.isWebGL2;this.setMode=function(E){g=E},this.setIndex=function(E){w=E.type,_=E.bytesPerElement},this.render=function(E,R){s.drawElements(g,R,w,E*_),a.update(R,g)},this.renderInstances=function(E,R,O,D){if(0!==D){var F,L;if(v)F=s,L="drawElementsInstanced";else if(L="drawElementsInstancedANGLE",null===(F=e.get("ANGLE_instanced_arrays")))return void console.error("WebGLIndexedBufferRenderer: using InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");F[L](g,O,w,R*_,D),a.update(O,g,D)}}}function WebGLInfo(s){var a={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:a,programs:null,autoReset:!0,reset:function(){a.frame++,a.calls=0,a.triangles=0,a.points=0,a.lines=0},update:function(g,C,w){switch(w=w||1,a.calls++,C){case s.TRIANGLES:a.triangles+=w*(g/3);break;case s.LINES:a.lines+=w*(g/2);break;case s.LINE_STRIP:a.lines+=w*(g-1);break;case s.LINE_LOOP:a.lines+=w*g;break;case s.POINTS:a.points+=w*g;break;default:console.error("WebGLInfo: Unknown draw mode:",C)}}}}function UniformsCache(){var s={};return{get:function(a){if(void 0!==s[a.id])return s[a.id];var d;switch(a.type){case"DirectionalLight":d={direction:new Vector3,color:new Color,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"SpotLight":d={position:new Vector3,direction:new Vector3,color:new Color,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Vector2};break;case"PointLight":d={position:new Vector3,color:new Color,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Vector2,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":d={direction:new Vector3,skyColor:new Color,groundColor:new Color};break;case"RectAreaLight":d={color:new Color,position:new Vector3,halfWidth:new Vector3,halfHeight:new Vector3}}return s[a.id]=d,d}}}MeshMatcapMaterial.prototype=Object.create(Material.prototype),MeshMatcapMaterial.prototype.constructor=MeshMatcapMaterial,MeshMatcapMaterial.prototype.isMeshMatcapMaterial=!0,MeshMatcapMaterial.prototype.copy=function(s){return Material.prototype.copy.call(this,s),this.defines={MATCAP:""},this.color.copy(s.color),this.matcap=s.matcap,this.map=s.map,this.bumpMap=s.bumpMap,this.bumpScale=s.bumpScale,this.normalMap=s.normalMap,this.normalMapType=s.normalMapType,this.normalScale.copy(s.normalScale),this.displacementMap=s.displacementMap,this.displacementScale=s.displacementScale,this.displacementBias=s.displacementBias,this.alphaMap=s.alphaMap,this.skinning=s.skinning,this.morphTargets=s.morphTargets,this.morphNormals=s.morphNormals,this},Object.assign(Cylindrical.prototype,{set:function(e,a,d){return this.radius=e,this.theta=a,this.y=d,this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,a,d){return this.radius=Math.sqrt(e*e+d*d),this.theta=Math.atan2(e,d),this.y=a,this}});var nextVersion=0;function shadowCastingLightsFirst(s,e){return(e.castShadow?1:0)-(s.castShadow?1:0)}function WebGLLights(){for(var s=new UniformsCache,e={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},a=0;a<9;a++)e.probe.push(new Vector3);var d=new Vector3,v=new Matrix4,g=new Matrix4;return{setup:function(w,_,x){for(var b=0,A=0,E=0,R=0;R<9;R++)e.probe[R].set(0,0,0);var O=0,D=0,F=0,L=0,I=0,V=0,z=0,H=0,X=x.matrixWorldInverse;w.sort(shadowCastingLightsFirst),R=0;for(var re=w.length;R<re;R++){var j=w[R],te=j.color,J=j.intensity,k=j.distance,U=j.shadow&&j.shadow.map?j.shadow.map.texture:null;if(j.isAmbientLight)b+=te.r*J,A+=te.g*J,E+=te.b*J;else if(j.isLightProbe)for(var K=0;K<9;K++)e.probe[K].addScaledVector(j.sh.coefficients[K],J);else if(j.isDirectionalLight)(ee=s.get(j)).color.copy(j.color).multiplyScalar(j.intensity),ee.direction.setFromMatrixPosition(j.matrixWorld),d.setFromMatrixPosition(j.target.matrixWorld),ee.direction.sub(d),ee.direction.transformDirection(X),ee.shadow=j.castShadow,j.castShadow&&(ee.shadowBias=(Q=j.shadow).bias,ee.shadowRadius=Q.radius,ee.shadowMapSize=Q.mapSize,e.directionalShadowMap[O]=U,e.directionalShadowMatrix[O]=j.shadow.matrix,V++),e.directional[O]=ee,O++;else if(j.isSpotLight)(ee=s.get(j)).position.setFromMatrixPosition(j.matrixWorld),ee.position.applyMatrix4(X),ee.color.copy(te).multiplyScalar(J),ee.distance=k,ee.direction.setFromMatrixPosition(j.matrixWorld),d.setFromMatrixPosition(j.target.matrixWorld),ee.direction.sub(d),ee.direction.transformDirection(X),ee.coneCos=Math.cos(j.angle),ee.penumbraCos=Math.cos(j.angle*(1-j.penumbra)),ee.decay=j.decay,ee.shadow=j.castShadow,j.castShadow&&(ee.shadowBias=(Q=j.shadow).bias,ee.shadowRadius=Q.radius,ee.shadowMapSize=Q.mapSize,e.spotShadowMap[F]=U,e.spotShadowMatrix[F]=j.shadow.matrix,H++),e.spot[F]=ee,F++;else if(j.isRectAreaLight)(ee=s.get(j)).color.copy(te).multiplyScalar(J),ee.position.setFromMatrixPosition(j.matrixWorld),ee.position.applyMatrix4(X),g.identity(),v.copy(j.matrixWorld),v.premultiply(X),g.extractRotation(v),ee.halfWidth.set(.5*j.width,0,0),ee.halfHeight.set(0,.5*j.height,0),ee.halfWidth.applyMatrix4(g),ee.halfHeight.applyMatrix4(g),e.rectArea[L]=ee,L++;else if(j.isPointLight){var Q;(ee=s.get(j)).position.setFromMatrixPosition(j.matrixWorld),ee.position.applyMatrix4(X),ee.color.copy(j.color).multiplyScalar(j.intensity),ee.distance=j.distance,ee.decay=j.decay,ee.shadow=j.castShadow,j.castShadow&&(ee.shadowBias=(Q=j.shadow).bias,ee.shadowRadius=Q.radius,ee.shadowMapSize=Q.mapSize,ee.shadowCameraNear=Q.camera.near,ee.shadowCameraFar=Q.camera.far,e.pointShadowMap[D]=U,e.pointShadowMatrix[D]=j.shadow.matrix,z++),e.point[D]=ee,D++}else if(j.isHemisphereLight){var ee;(ee=s.get(j)).direction.setFromMatrixPosition(j.matrixWorld),ee.direction.transformDirection(X),ee.direction.normalize(),ee.skyColor.copy(j.color).multiplyScalar(J),ee.groundColor.copy(j.groundColor).multiplyScalar(J),e.hemi[I]=ee,I++}}e.ambient[0]=b,e.ambient[1]=A,e.ambient[2]=E;var oe=e.hash;(oe.directionalLength!==O||oe.pointLength!==D||oe.spotLength!==F||oe.rectAreaLength!==L||oe.hemiLength!==I||oe.numDirectionalShadows!==V||oe.numPointShadows!==z||oe.numSpotShadows!==H)&&(e.directional.length=O,e.spot.length=F,e.rectArea.length=L,e.point.length=D,e.hemi.length=I,e.directionalShadowMap.length=V,e.pointShadowMap.length=z,e.spotShadowMap.length=H,e.directionalShadowMatrix.length=V,e.pointShadowMatrix.length=z,e.spotShadowMatrix.length=H,oe.directionalLength=O,oe.pointLength=D,oe.spotLength=F,oe.rectAreaLength=L,oe.hemiLength=I,oe.numDirectionalShadows=V,oe.numPointShadows=z,oe.numSpotShadows=H,e.version=nextVersion++)},state:e}}function absNumericalSort(s,e){return Math.abs(e[1])-Math.abs(s[1])}function WebGLMorphtargets(s){var e={},a=new Float32Array(8);return{update:function(v,g,C,w){var _=v.morphTargetInfluences,x=void 0===_?0:_.length,b=e[g.id];if(void 0===b){b=[];for(var A=0;A<x;A++)b[A]=[A,0];e[g.id]=b}var E=C.morphTargets&&g.morphAttributes.position,R=C.morphNormals&&g.morphAttributes.normal;for(A=0;A<x;A++)0!==(O=b[A])[1]&&(E&&g.deleteAttribute("morphTarget"+A),R&&g.deleteAttribute("morphNormal"+A));for(A=0;A<x;A++)(O=b[A])[0]=A,O[1]=_[A];b.sort(absNumericalSort);var D=0;for(A=0;A<8;A++){var O;if(O=b[A]){var F=O[0],L=O[1];if(L){E&&g.setAttribute("morphTarget"+A,E[F]),R&&g.setAttribute("morphNormal"+A,R[F]),a[A]=L,D+=L;continue}}a[A]=0}var I=g.morphTargetsRelative?1:1-D;w.getUniforms().setValue(s,"morphTargetBaseInfluence",I),w.getUniforms().setValue(s,"morphTargetInfluences",a)}}}function WebGLMultiviewRenderTarget(s,e,a,d){WebGLRenderTarget.call(this,s,e,d),this.depthBuffer=!1,this.stencilBuffer=!1,this.numViews=a}function WebGLMultiview(s,e){var g,C,w,_,x,b,A,d=s.extensions,v=s.properties,E=0;function O(re){return re.isArrayCamera?re.cameras:(x[0]=re,x)}this.isAvailable=function(){if(void 0===A){var re=d.get("OVR_multiview2");if(A=null!==re&&!1===e.getContextAttributes().antialias){E=e.getParameter(re.MAX_VIEWS_OVR),g=new WebGLMultiviewRenderTarget(0,0,2),b=new Vector2,_=[],w=[],x=[];for(var j=0;j<E;j++)_[j]=new Matrix4,w[j]=new Matrix3}}return A},this.attachCamera=function(re){!1!==function(re){if(void 0===re.isArrayCamera)return!0;var j=re.cameras;if(j.length>E)return!1;for(var te=1,J=j.length;te<J;te++)if(j[0].viewport.z!==j[te].viewport.z||j[0].viewport.w!==j[te].viewport.w)return!1;return!0}(re)&&(C=s.getRenderTarget(),function(re){if(C?b.set(C.width,C.height):s.getDrawingBufferSize(b),re.isArrayCamera){var j=re.cameras[0].viewport;g.setSize(j.z,j.w),g.setNumViews(re.cameras.length)}else g.setSize(b.x,b.y),g.setNumViews(2)}(re),s.setRenderTarget(g))},this.detachCamera=function(re){g===s.getRenderTarget()&&(s.setRenderTarget(C),function(re){var j=g,te=j.numViews,J=v.get(j).__webglViewFramebuffers,k=j.width,U=j.height;if(re.isArrayCamera)for(var K=0;K<te;K++){var ee=re.cameras[K].viewport,Q=ee.x,oe=ee.y,me=Q+ee.z,fe=oe+ee.w;e.bindFramebuffer(e.READ_FRAMEBUFFER,J[K]),e.blitFramebuffer(0,0,k,U,Q,oe,me,fe,e.COLOR_BUFFER_BIT,e.NEAREST)}else e.bindFramebuffer(e.READ_FRAMEBUFFER,J[0]),e.blitFramebuffer(0,0,k,U,0,0,b.x,b.y,e.COLOR_BUFFER_BIT,e.NEAREST)}(re))},this.updateCameraProjectionMatricesUniform=function(re,j){for(var te=O(re),J=0;J<te.length;J++)_[J].copy(te[J].projectionMatrix);j.setValue(e,"projectionMatrices",_)},this.updateCameraViewMatricesUniform=function(re,j){for(var te=O(re),J=0;J<te.length;J++)_[J].copy(te[J].matrixWorldInverse);j.setValue(e,"viewMatrices",_)},this.updateObjectMatricesUniforms=function(re,j,te){for(var J=O(j),k=0;k<J.length;k++)_[k].multiplyMatrices(J[k].matrixWorldInverse,re.matrixWorld),w[k].getNormalMatrix(_[k]);te.setValue(e,"modelViewMatrices",_),te.setValue(e,"normalMatrices",w)}}function WebGLObjects(s,e,a,d){var v={};return{update:function(w){var _=d.render.frame,x=w.geometry,b=e.get(w,x);return v[b.id]!==_&&(x.isGeometry&&b.updateFromObject(w),e.update(b),v[b.id]=_),w.isInstancedMesh&&a.update(w.instanceMatrix,s.ARRAY_BUFFER),b},dispose:function(){v={}}}}function DataTexture2DArray(s,e,a,d){Texture.call(this,null),this.image={data:s||null,width:e||1,height:a||1,depth:d||1},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function DataTexture3D(s,e,a,d){Texture.call(this,null),this.image={data:s||null,width:e||1,height:a||1,depth:d||1},this.magFilter=NearestFilter,this.minFilter=NearestFilter,this.wrapR=ClampToEdgeWrapping,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}WebGLMultiviewRenderTarget.prototype=Object.assign(Object.create(WebGLRenderTarget.prototype),{constructor:WebGLMultiviewRenderTarget,isWebGLMultiviewRenderTarget:!0,copy:function(e){return WebGLRenderTarget.prototype.copy.call(this,e),this.numViews=e.numViews,this},setNumViews:function(e){return this.numViews!==e&&(this.numViews=e,this.dispose()),this}}),DataTexture2DArray.prototype=Object.create(Texture.prototype),DataTexture2DArray.prototype.constructor=DataTexture2DArray,DataTexture2DArray.prototype.isDataTexture2DArray=!0,DataTexture3D.prototype=Object.create(Texture.prototype),DataTexture3D.prototype.constructor=DataTexture3D,DataTexture3D.prototype.isDataTexture3D=!0;var emptyTexture=new Texture,emptyTexture2dArray=new DataTexture2DArray,emptyTexture3d=new DataTexture3D,emptyCubeTexture=new CubeTexture,arrayCacheF32=[],arrayCacheI32=[],mat4array=new Float32Array(16),mat3array=new Float32Array(9),mat2array=new Float32Array(4);function flatten(s,e,a){var d=s[0];if(d<=0||d>0)return s;var v=e*a,g=arrayCacheF32[v];if(void 0===g&&(g=new Float32Array(v),arrayCacheF32[v]=g),0!==e){d.toArray(g,0);for(var C=1,w=0;C!==e;++C)s[C].toArray(g,w+=a)}return g}function arraysEqual(s,e){if(s.length!==e.length)return!1;for(var a=0,d=s.length;a<d;a++)if(s[a]!==e[a])return!1;return!0}function copyArray(s,e){for(var a=0,d=e.length;a<d;a++)s[a]=e[a]}function allocTexUnits(s,e){var a=arrayCacheI32[e];void 0===a&&(a=new Int32Array(e),arrayCacheI32[e]=a);for(var d=0;d!==e;++d)a[d]=s.allocateTextureUnit();return a}function setValueV1f(s,e){var a=this.cache;a[0]!==e&&(s.uniform1f(this.addr,e),a[0]=e)}function setValueV2f(s,e){var a=this.cache;if(void 0!==e.x)(a[0]!==e.x||a[1]!==e.y)&&(s.uniform2f(this.addr,e.x,e.y),a[0]=e.x,a[1]=e.y);else{if(arraysEqual(a,e))return;s.uniform2fv(this.addr,e),copyArray(a,e)}}function setValueV3f(s,e){var a=this.cache;if(void 0!==e.x)(a[0]!==e.x||a[1]!==e.y||a[2]!==e.z)&&(s.uniform3f(this.addr,e.x,e.y,e.z),a[0]=e.x,a[1]=e.y,a[2]=e.z);else if(void 0!==e.r)(a[0]!==e.r||a[1]!==e.g||a[2]!==e.b)&&(s.uniform3f(this.addr,e.r,e.g,e.b),a[0]=e.r,a[1]=e.g,a[2]=e.b);else{if(arraysEqual(a,e))return;s.uniform3fv(this.addr,e),copyArray(a,e)}}function setValueV4f(s,e){var a=this.cache;if(void 0!==e.x)(a[0]!==e.x||a[1]!==e.y||a[2]!==e.z||a[3]!==e.w)&&(s.uniform4f(this.addr,e.x,e.y,e.z,e.w),a[0]=e.x,a[1]=e.y,a[2]=e.z,a[3]=e.w);else{if(arraysEqual(a,e))return;s.uniform4fv(this.addr,e),copyArray(a,e)}}function setValueM2(s,e){var a=this.cache,d=e.elements;if(void 0===d){if(arraysEqual(a,e))return;s.uniformMatrix2fv(this.addr,!1,e),copyArray(a,e)}else{if(arraysEqual(a,d))return;mat2array.set(d),s.uniformMatrix2fv(this.addr,!1,mat2array),copyArray(a,d)}}function setValueM3(s,e){var a=this.cache,d=e.elements;if(void 0===d){if(arraysEqual(a,e))return;s.uniformMatrix3fv(this.addr,!1,e),copyArray(a,e)}else{if(arraysEqual(a,d))return;mat3array.set(d),s.uniformMatrix3fv(this.addr,!1,mat3array),copyArray(a,d)}}function setValueM4(s,e){var a=this.cache,d=e.elements;if(void 0===d){if(arraysEqual(a,e))return;s.uniformMatrix4fv(this.addr,!1,e),copyArray(a,e)}else{if(arraysEqual(a,d))return;mat4array.set(d),s.uniformMatrix4fv(this.addr,!1,mat4array),copyArray(a,d)}}function setValueT1(s,e,a){var d=this.cache,v=a.allocateTextureUnit();d[0]!==v&&(s.uniform1i(this.addr,v),d[0]=v),a.safeSetTexture2D(e||emptyTexture,v)}function setValueT2DArray1(s,e,a){var d=this.cache,v=a.allocateTextureUnit();d[0]!==v&&(s.uniform1i(this.addr,v),d[0]=v),a.setTexture2DArray(e||emptyTexture2dArray,v)}function setValueT3D1(s,e,a){var d=this.cache,v=a.allocateTextureUnit();d[0]!==v&&(s.uniform1i(this.addr,v),d[0]=v),a.setTexture3D(e||emptyTexture3d,v)}function setValueT6(s,e,a){var d=this.cache,v=a.allocateTextureUnit();d[0]!==v&&(s.uniform1i(this.addr,v),d[0]=v),a.safeSetTextureCube(e||emptyCubeTexture,v)}function setValueV1i(s,e){var a=this.cache;a[0]!==e&&(s.uniform1i(this.addr,e),a[0]=e)}function setValueV2i(s,e){var a=this.cache;arraysEqual(a,e)||(s.uniform2iv(this.addr,e),copyArray(a,e))}function setValueV3i(s,e){var a=this.cache;arraysEqual(a,e)||(s.uniform3iv(this.addr,e),copyArray(a,e))}function setValueV4i(s,e){var a=this.cache;arraysEqual(a,e)||(s.uniform4iv(this.addr,e),copyArray(a,e))}function setValueV1ui(s,e){var a=this.cache;a[0]!==e&&(s.uniform1ui(this.addr,e),a[0]=e)}function getSingularSetter(s){switch(s){case 5126:return setValueV1f;case 35664:return setValueV2f;case 35665:return setValueV3f;case 35666:return setValueV4f;case 35674:return setValueM2;case 35675:return setValueM3;case 35676:return setValueM4;case 5124:case 35670:return setValueV1i;case 35667:case 35671:return setValueV2i;case 35668:case 35672:return setValueV3i;case 35669:case 35673:return setValueV4i;case 5125:return setValueV1ui;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1;case 35679:case 36299:case 36307:return setValueT3D1;case 35680:case 36300:case 36308:case 36293:return setValueT6;case 36289:case 36303:case 36311:case 36292:return setValueT2DArray1}}function setValueV1fArray(s,e){s.uniform1fv(this.addr,e)}function setValueV1iArray(s,e){s.uniform1iv(this.addr,e)}function setValueV2iArray(s,e){s.uniform2iv(this.addr,e)}function setValueV3iArray(s,e){s.uniform3iv(this.addr,e)}function setValueV4iArray(s,e){s.uniform4iv(this.addr,e)}function setValueV2fArray(s,e){var a=flatten(e,this.size,2);s.uniform2fv(this.addr,a)}function setValueV3fArray(s,e){var a=flatten(e,this.size,3);s.uniform3fv(this.addr,a)}function setValueV4fArray(s,e){var a=flatten(e,this.size,4);s.uniform4fv(this.addr,a)}function setValueM2Array(s,e){var a=flatten(e,this.size,4);s.uniformMatrix2fv(this.addr,!1,a)}function setValueM3Array(s,e){var a=flatten(e,this.size,9);s.uniformMatrix3fv(this.addr,!1,a)}function setValueM4Array(s,e){var a=flatten(e,this.size,16);s.uniformMatrix4fv(this.addr,!1,a)}function setValueT1Array(s,e,a){var d=e.length,v=allocTexUnits(a,d);s.uniform1iv(this.addr,v);for(var g=0;g!==d;++g)a.safeSetTexture2D(e[g]||emptyTexture,v[g])}function setValueT6Array(s,e,a){var d=e.length,v=allocTexUnits(a,d);s.uniform1iv(this.addr,v);for(var g=0;g!==d;++g)a.safeSetTextureCube(e[g]||emptyCubeTexture,v[g])}function getPureArraySetter(s){switch(s){case 5126:return setValueV1fArray;case 35664:return setValueV2fArray;case 35665:return setValueV3fArray;case 35666:return setValueV4fArray;case 35674:return setValueM2Array;case 35675:return setValueM3Array;case 35676:return setValueM4Array;case 5124:case 35670:return setValueV1iArray;case 35667:case 35671:return setValueV2iArray;case 35668:case 35672:return setValueV3iArray;case 35669:case 35673:return setValueV4iArray;case 35678:case 36198:case 36298:case 36306:case 35682:return setValueT1Array;case 35680:case 36300:case 36308:case 36293:return setValueT6Array}}function SingleUniform(s,e,a){this.id=s,this.addr=a,this.cache=[],this.setValue=getSingularSetter(e.type)}function PureArrayUniform(s,e,a){this.id=s,this.addr=a,this.cache=[],this.size=e.size,this.setValue=getPureArraySetter(e.type)}function StructuredUniform(s){this.id=s,this.seq=[],this.map={}}PureArrayUniform.prototype.updateCache=function(s){var e=this.cache;s instanceof Float32Array&&e.length!==s.length&&(this.cache=new Float32Array(s.length)),copyArray(e,s)},StructuredUniform.prototype.setValue=function(s,e,a){for(var d=this.seq,v=0,g=d.length;v!==g;++v){var C=d[v];C.setValue(s,e[C.id],a)}};var RePathPart=/([\w\d_]+)(\])?(\[|\.)?/g;function addUniform(s,e){s.seq.push(e),s.map[e.id]=e}function parseUniform(s,e,a){var d=s.name,v=d.length;for(RePathPart.lastIndex=0;;){var g=RePathPart.exec(d),w=g[1],x=g[3];if("]"===g[2]&&(w|=0),void 0===x||"["===x&&RePathPart.lastIndex+2===v){addUniform(a,void 0===x?new SingleUniform(w,s,e):new PureArrayUniform(w,s,e));break}var A=a.map[w];void 0===A&&addUniform(a,A=new StructuredUniform(w)),a=A}}function WebGLUniforms(s,e){this.seq=[],this.map={};for(var a=s.getProgramParameter(e,s.ACTIVE_UNIFORMS),d=0;d<a;++d){var v=s.getActiveUniform(e,d);parseUniform(v,s.getUniformLocation(e,v.name),this)}}function WebGLShader(s,e,a){var d=s.createShader(e);return s.shaderSource(d,a),s.compileShader(d),d}WebGLUniforms.prototype.setValue=function(s,e,a,d){var v=this.map[e];void 0!==v&&v.setValue(s,a,d)},WebGLUniforms.prototype.setOptional=function(s,e,a){var d=e[a];void 0!==d&&this.setValue(s,a,d)},WebGLUniforms.upload=function(s,e,a,d){for(var v=0,g=e.length;v!==g;++v){var C=e[v],w=a[C.id];!1!==w.needsUpdate&&C.setValue(s,w.value,d)}},WebGLUniforms.seqWithValue=function(s,e){for(var a=[],d=0,v=s.length;d!==v;++d){var g=s[d];g.id in e&&a.push(g)}return a};var programIdCount=0;function addLineNumbers(s){for(var e=s.split("\n"),a=0;a<e.length;a++)e[a]=a+1+": "+e[a];return e.join("\n")}function getEncodingComponents(s){switch(s){case LinearEncoding:return["Linear","( value )"];case sRGBEncoding:return["sRGB","( value )"];case RGBEEncoding:return["RGBE","( value )"];case RGBM7Encoding:return["RGBM","( value, 7.0 )"];case RGBM16Encoding:return["RGBM","( value, 16.0 )"];case RGBDEncoding:return["RGBD","( value, 256.0 )"];case GammaEncoding:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case LogLuvEncoding:return["LogLuv","( value )"];default:throw new Error("unsupported encoding: "+s)}}function getShaderErrors(s,e,a){var d=s.getShaderParameter(e,s.COMPILE_STATUS),v=s.getShaderInfoLog(e).trim();return d&&""===v?"":"WebGLShader: gl.getShaderInfoLog() "+a+"\n"+v+addLineNumbers(s.getShaderSource(e))}function getTexelDecodingFunction(s,e){var a=getEncodingComponents(e);return"vec4 "+s+"( vec4 value ) { return "+a[0]+"ToLinear"+a[1]+"; }"}function getTexelEncodingFunction(s,e){var a=getEncodingComponents(e);return"vec4 "+s+"( vec4 value ) { return LinearTo"+a[0]+a[1]+"; }"}function getToneMappingFunction(s,e){var a;switch(e){case LinearToneMapping:a="Linear";break;case ReinhardToneMapping:a="Reinhard";break;case Uncharted2ToneMapping:a="Uncharted2";break;case CineonToneMapping:a="OptimizedCineon";break;case ACESFilmicToneMapping:a="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 "+s+"( vec3 color ) { return "+a+"ToneMapping( color ); }"}function generateExtensions(s){return[s.extensionDerivatives||s.envMapCubeUV||s.bumpMap||s.tangentSpaceNormalMap||s.clearcoatNormalMap||s.flatShading||"physical"===s.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(s.extensionFragDepth||s.logarithmicDepthBuffer)&&s.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",s.extensionDrawBuffers&&s.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(s.extensionShaderTextureLOD||s.envMap)&&s.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(filterEmptyLine).join("\n")}function generateDefines(s){var e=[];for(var a in s){var d=s[a];!1!==d&&e.push("#define "+a+" "+d)}return e.join("\n")}function fetchAttributeLocations(s,e){for(var a={},d=s.getProgramParameter(e,s.ACTIVE_ATTRIBUTES),v=0;v<d;v++){var C=s.getActiveAttrib(e,v).name;a[C]=s.getAttribLocation(e,C)}return a}function filterEmptyLine(s){return""!==s}function replaceLightNums(s,e){return s.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function replaceClippingPlaneNums(s,e){return s.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}var includePattern=/^[ \t]*#include +<([\w\d./]+)>/gm;function resolveIncludes(s){return s.replace(includePattern,includeReplacer)}function includeReplacer(s,e){var a=ShaderChunk[e];if(void 0===a)throw new Error("Can not resolve #include <"+e+">");return resolveIncludes(a)}var loopPattern=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;function unrollLoops(s){return s.replace(loopPattern,loopReplacer)}function loopReplacer(s,e,a,d){for(var v="",g=parseInt(e);g<parseInt(a);g++)v+=d.replace(/\[ i \]/g,"[ "+g+" ]").replace(/UNROLLED_LOOP_INDEX/g,g);return v}function generatePrecision(s){var e="precision "+s.precision+" float;\nprecision "+s.precision+" int;";return"highp"===s.precision?e+="\n#define HIGH_PRECISION":"mediump"===s.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===s.precision&&(e+="\n#define LOW_PRECISION"),e}function generateShadowMapTypeDefine(s){var e="SHADOWMAP_TYPE_BASIC";return s.shadowMapType===PCFShadowMap?e="SHADOWMAP_TYPE_PCF":s.shadowMapType===PCFSoftShadowMap?e="SHADOWMAP_TYPE_PCF_SOFT":s.shadowMapType===VSMShadowMap&&(e="SHADOWMAP_TYPE_VSM"),e}function generateEnvMapTypeDefine(s){var e="ENVMAP_TYPE_CUBE";if(s.envMap)switch(s.envMapMode){case CubeReflectionMapping:case CubeRefractionMapping:e="ENVMAP_TYPE_CUBE";break;case CubeUVReflectionMapping:case CubeUVRefractionMapping:e="ENVMAP_TYPE_CUBE_UV";break;case EquirectangularReflectionMapping:case EquirectangularRefractionMapping:e="ENVMAP_TYPE_EQUIREC";break;case SphericalReflectionMapping:e="ENVMAP_TYPE_SPHERE"}return e}function generateEnvMapModeDefine(s){var e="ENVMAP_MODE_REFLECTION";if(s.envMap)switch(s.envMapMode){case CubeRefractionMapping:case EquirectangularRefractionMapping:e="ENVMAP_MODE_REFRACTION"}return e}function generateEnvMapBlendingDefine(s){var e="ENVMAP_BLENDING_NONE";if(s.envMap)switch(s.combine){case MultiplyOperation:e="ENVMAP_BLENDING_MULTIPLY";break;case MixOperation:e="ENVMAP_BLENDING_MIX";break;case AddOperation:e="ENVMAP_BLENDING_ADD"}return e}function WebGLProgram(s,e,a){var D,F,d=s.getContext(),v=a.defines,g=a.vertexShader,C=a.fragmentShader,w=generateShadowMapTypeDefine(a),_=generateEnvMapTypeDefine(a),x=generateEnvMapModeDefine(a),b=generateEnvMapBlendingDefine(a),A=s.gammaFactor>0?s.gammaFactor:1,E=a.isWebGL2?"":generateExtensions(a),R=generateDefines(v),O=d.createProgram(),L=a.numMultiviewViews;if(a.isRawShaderMaterial?((D=[R].filter(filterEmptyLine).join("\n")).length>0&&(D+="\n"),(F=[E,R].filter(filterEmptyLine).join("\n")).length>0&&(F+="\n")):(D=[generatePrecision(a),"#define SHADER_NAME "+a.shaderName,R,a.instancing?"#define USE_INSTANCING":"",a.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+A,"#define MAX_BONES "+a.maxBones,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp2?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+x:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMap&&a.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",a.normalMap&&a.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",a.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",a.displacementMap&&a.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.vertexTangents?"#define USE_TANGENT":"",a.vertexColors?"#define USE_COLOR":"",a.vertexUvs?"#define USE_UV":"",a.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",a.flatShading?"#define FLAT_SHADED":"",a.skinning?"#define USE_SKINNING":"",a.useVertexTexture?"#define BONE_TEXTURE":"",a.morphTargets?"#define USE_MORPHTARGETS":"",a.morphNormals&&!1===a.flatShading?"#define USE_MORPHNORMALS":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+w:"",a.sizeAttenuation?"#define USE_SIZEATTENUATION":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&a.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(filterEmptyLine).join("\n"),F=[E,generatePrecision(a),"#define SHADER_NAME "+a.shaderName,R,a.alphaTest?"#define ALPHATEST "+a.alphaTest+(a.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+A,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp2?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.matcap?"#define USE_MATCAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+_:"",a.envMap?"#define "+x:"",a.envMap?"#define "+b:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.normalMap&&a.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",a.normalMap&&a.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",a.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.sheen?"#define USE_SHEEN":"",a.vertexTangents?"#define USE_TANGENT":"",a.vertexColors?"#define USE_COLOR":"",a.vertexUvs?"#define USE_UV":"",a.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",a.gradientMap?"#define USE_GRADIENTMAP":"",a.flatShading?"#define FLAT_SHADED":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+w:"",a.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",a.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&a.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(a.extensionShaderTextureLOD||a.envMap)&&a.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",a.toneMapping!==NoToneMapping?"#define TONE_MAPPING":"",a.toneMapping!==NoToneMapping?ShaderChunk.tonemapping_pars_fragment:"",a.toneMapping!==NoToneMapping?getToneMappingFunction("toneMapping",a.toneMapping):"",a.dithering?"#define DITHERING":"",a.outputEncoding||a.mapEncoding||a.matcapEncoding||a.envMapEncoding||a.emissiveMapEncoding||a.lightMapEncoding?ShaderChunk.encodings_pars_fragment:"",a.mapEncoding?getTexelDecodingFunction("mapTexelToLinear",a.mapEncoding):"",a.matcapEncoding?getTexelDecodingFunction("matcapTexelToLinear",a.matcapEncoding):"",a.envMapEncoding?getTexelDecodingFunction("envMapTexelToLinear",a.envMapEncoding):"",a.emissiveMapEncoding?getTexelDecodingFunction("emissiveMapTexelToLinear",a.emissiveMapEncoding):"",a.lightMapEncoding?getTexelDecodingFunction("lightMapTexelToLinear",a.lightMapEncoding):"",a.outputEncoding?getTexelEncodingFunction("linearToOutputTexel",a.outputEncoding):"",a.depthPacking?"#define DEPTH_PACKING "+a.depthPacking:"","\n"].filter(filterEmptyLine).join("\n")),g=replaceClippingPlaneNums(g=replaceLightNums(g=resolveIncludes(g),a),a),C=replaceClippingPlaneNums(C=replaceLightNums(C=resolveIncludes(C),a),a),g=unrollLoops(g),C=unrollLoops(C),a.isWebGL2&&!a.isRawShaderMaterial){var I=!1,V=/^\s*#version\s+300\s+es\s*\n/;a.isShaderMaterial&&null!==g.match(V)&&null!==C.match(V)&&(I=!0,g=g.replace(V,""),C=C.replace(V,"")),D=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+D,F=["#version 300 es\n","#define varying in",I?"":"out highp vec4 pc_fragColor;",I?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+F,L>0&&(D=(D=D.replace("#version 300 es\n",["#version 300 es\n","#extension GL_OVR_multiview2 : require","layout(num_views = "+L+") in;","#define VIEW_ID gl_ViewID_OVR"].join("\n"))).replace(["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;"].join("\n"),["uniform mat4 modelViewMatrices["+L+"];","uniform mat4 projectionMatrices["+L+"];","uniform mat4 viewMatrices["+L+"];","uniform mat3 normalMatrices["+L+"];","#define modelViewMatrix modelViewMatrices[VIEW_ID]","#define projectionMatrix projectionMatrices[VIEW_ID]","#define viewMatrix viewMatrices[VIEW_ID]","#define normalMatrix normalMatrices[VIEW_ID]"].join("\n")),F=(F=F.replace("#version 300 es\n",["#version 300 es\n","#extension GL_OVR_multiview2 : require","#define VIEW_ID gl_ViewID_OVR"].join("\n"))).replace("uniform mat4 viewMatrix;",["uniform mat4 viewMatrices["+L+"];","#define viewMatrix viewMatrices[VIEW_ID]"].join("\n")))}var Q,oe,H=F+C,X=WebGLShader(d,d.VERTEX_SHADER,D+g),re=WebGLShader(d,d.FRAGMENT_SHADER,H);if(d.attachShader(O,X),d.attachShader(O,re),void 0!==a.index0AttributeName?d.bindAttribLocation(O,0,a.index0AttributeName):!0===a.morphTargets&&d.bindAttribLocation(O,0,"position"),d.linkProgram(O),s.debug.checkShaderErrors){var j=d.getProgramInfoLog(O).trim(),te=d.getShaderInfoLog(X).trim(),J=d.getShaderInfoLog(re).trim(),k=!0,U=!0;if(!1===d.getProgramParameter(O,d.LINK_STATUS)){k=!1;var K=getShaderErrors(d,X,"vertex"),ee=getShaderErrors(d,re,"fragment");console.error("WebGLProgram: shader error: ",d.getError(),"gl.VALIDATE_STATUS",d.getProgramParameter(O,d.VALIDATE_STATUS),"gl.getProgramInfoLog",j,K,ee)}else""!==j?console.warn("WebGLProgram: gl.getProgramInfoLog()",j):(""===te||""===J)&&(U=!1);U&&(this.diagnostics={runnable:k,programLog:j,vertexShader:{log:te,prefix:D},fragmentShader:{log:J,prefix:F}})}return d.deleteShader(X),d.deleteShader(re),this.getUniforms=function(){return void 0===Q&&(Q=new WebGLUniforms(d,O)),Q},this.getAttributes=function(){return void 0===oe&&(oe=fetchAttributeLocations(d,O)),oe},this.destroy=function(){d.deleteProgram(O),this.program=void 0},this.name=a.shaderName,this.id=programIdCount++,this.cacheKey=e,this.usedTimes=1,this.program=O,this.vertexShader=X,this.fragmentShader=re,this.numMultiviewViews=L,this}function WebGLPrograms(s,e,a){var d=[],v=a.isWebGL2,g=a.logarithmicDepthBuffer,C=a.floatVertexTextures,w=a.precision,_=a.maxVertexUniforms,x=a.vertexTextures,b={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},A=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","numMultiviewViews","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen"];function O(D){var F;return D?D.isTexture?F=D.encoding:D.isWebGLRenderTarget&&(console.warn("WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),F=D.texture.encoding):F=LinearEncoding,F}this.getParameters=function(D,F,L,I,V,z,H){var X=I.fog,j=D.envMap||(D.isMeshStandardMaterial?I.environment:null),te=b[D.type],J=H.isSkinnedMesh?function(D){var L=D.skeleton.bones;if(C)return 1024;var V=Math.floor((_-20)/4),z=Math.min(V,L.length);return z<L.length?(console.warn("WebGLRenderer: Skeleton has "+L.length+" bones. This GPU supports "+z+"."),0):z}(H):0;null!==D.precision&&(w=a.getMaxPrecision(D.precision))!==D.precision&&console.warn("WebGLProgram.getParameters:",D.precision,"not supported, using",w,"instead.");var k=function(D,F){var L;if(F){var I=ShaderLib[F];L={name:D.type,uniforms:UniformsUtils.clone(I.uniforms),vertexShader:I.vertexShader,fragmentShader:I.fragmentShader}}else L={name:D.type,uniforms:D.uniforms,vertexShader:D.vertexShader,fragmentShader:D.fragmentShader};return L}(D,te);D.onBeforeCompile(k,s);var U=s.getRenderTarget();return{isWebGL2:v,shaderID:te,shaderName:k.name,uniforms:k.uniforms,vertexShader:k.vertexShader,fragmentShader:k.fragmentShader,defines:D.defines,isRawShaderMaterial:D.isRawShaderMaterial,isShaderMaterial:D.isShaderMaterial,precision:w,instancing:!0===H.isInstancedMesh,supportsVertexTextures:x,numMultiviewViews:U&&U.isWebGLMultiviewRenderTarget?U.numViews:0,outputEncoding:null!==U?O(U.texture):s.outputEncoding,map:!!D.map,mapEncoding:O(D.map),matcap:!!D.matcap,matcapEncoding:O(D.matcap),envMap:!!j,envMapMode:j&&j.mapping,envMapEncoding:O(j),envMapCubeUV:!!j&&(j.mapping===CubeUVReflectionMapping||j.mapping===CubeUVRefractionMapping),lightMap:!!D.lightMap,lightMapEncoding:O(D.lightMap),aoMap:!!D.aoMap,emissiveMap:!!D.emissiveMap,emissiveMapEncoding:O(D.emissiveMap),bumpMap:!!D.bumpMap,normalMap:!!D.normalMap,objectSpaceNormalMap:D.normalMapType===ObjectSpaceNormalMap,tangentSpaceNormalMap:D.normalMapType===TangentSpaceNormalMap,clearcoatNormalMap:!!D.clearcoatNormalMap,displacementMap:!!D.displacementMap,roughnessMap:!!D.roughnessMap,metalnessMap:!!D.metalnessMap,specularMap:!!D.specularMap,alphaMap:!!D.alphaMap,gradientMap:!!D.gradientMap,sheen:!!D.sheen,combine:D.combine,vertexTangents:D.normalMap&&D.vertexTangents,vertexColors:D.vertexColors,vertexUvs:!!(D.map||D.bumpMap||D.normalMap||D.specularMap||D.alphaMap||D.emissiveMap||D.roughnessMap||D.metalnessMap||D.clearcoatNormalMap||D.displacementMap),uvsVertexOnly:!(D.map||D.bumpMap||D.normalMap||D.specularMap||D.alphaMap||D.emissiveMap||D.roughnessMap||D.metalnessMap||D.clearcoatNormalMap||!D.displacementMap),fog:!!X,useFog:D.fog,fogExp2:X&&X.isFogExp2,flatShading:D.flatShading,sizeAttenuation:D.sizeAttenuation,logarithmicDepthBuffer:g,skinning:D.skinning&&J>0,maxBones:J,useVertexTexture:C,morphTargets:D.morphTargets,morphNormals:D.morphNormals,maxMorphTargets:s.maxMorphTargets,maxMorphNormals:s.maxMorphNormals,numDirLights:F.directional.length,numPointLights:F.point.length,numSpotLights:F.spot.length,numRectAreaLights:F.rectArea.length,numHemiLights:F.hemi.length,numDirLightShadows:F.directionalShadowMap.length,numPointLightShadows:F.pointShadowMap.length,numSpotLightShadows:F.spotShadowMap.length,numClippingPlanes:V,numClipIntersection:z,dithering:D.dithering,shadowMapEnabled:s.shadowMap.enabled&&L.length>0,shadowMapType:s.shadowMap.type,toneMapping:D.toneMapped?s.toneMapping:NoToneMapping,physicallyCorrectLights:s.physicallyCorrectLights,premultipliedAlpha:D.premultipliedAlpha,alphaTest:D.alphaTest,doubleSided:D.side===DoubleSide,flipSided:D.side===BackSide,depthPacking:void 0!==D.depthPacking&&D.depthPacking,index0AttributeName:D.index0AttributeName,extensionDerivatives:D.extensions&&D.extensions.derivatives,extensionFragDepth:D.extensions&&D.extensions.frawbuffers,extensionDrawbuffers:D.extensions&&D.extensions.drawbuffers,extensionShaderTextureLOD:D.extensions&&D.extensions.shaderTextureLOD,rendererExtensionFragDepth:v||null!==e.get("EXT_frag_depth"),rendererExtensionDrawBuffers:v||null!==e.get("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:v||null!==e.get("EXT_shader_texture_lod"),onBeforeCompile:D.onBeforeCompile}},this.getProgramCacheKey=function(D){var F=[];if(D.shaderID?F.push(D.shaderID):(F.push(D.fragmentShader),F.push(D.vertexShader)),void 0!==D.defines)for(var L in D.defines)F.push(L),F.push(D.defines[L]);if(void 0===D.isRawShaderMaterial){for(var I=0;I<A.length;I++)F.push(D[A[I]]);F.push(s.outputEncoding),F.push(s.gammaFactor)}return F.push(D.onBeforeCompile.toString()),F.join()},this.acquireProgram=function(D,F){for(var L,I=0,V=d.length;I<V;I++){var z=d[I];if(z.cacheKey===F){++(L=z).usedTimes;break}}return void 0===L&&(L=new WebGLProgram(s,F,D),d.push(L)),L},this.releaseProgram=function(D){if(0==--D.usedTimes){var F=d.indexOf(D);d[F]=d[d.length-1],d.pop(),D.destroy()}},this.programs=d}function WebGLProperties(){var s=new WeakMap;return{get:function(g){var C=s.get(g);return void 0===C&&s.set(g,C={}),C},remove:function(g){s.delete(g)},update:function(g,C,w){s.get(g)[C]=w},dispose:function(){s=new WeakMap}}}function painterSortStable(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.program!==e.program?s.program.id-e.program.id:s.material.id!==e.material.id?s.material.id-e.material.id:s.z!==e.z?s.z-e.z:s.id-e.id}function reversePainterSortStable(s,e){return s.groupOrder!==e.groupOrder?s.groupOrder-e.groupOrder:s.renderOrder!==e.renderOrder?s.renderOrder-e.renderOrder:s.z!==e.z?e.z-s.z:s.id-e.id}function WebGLRenderList(){var s=[],e=0,a=[],d=[],v={id:-1};function C(b,A,E,R,O,D){var F=s[e];return void 0===F?s[e]=F={id:b.id,object:b,geometry:A,material:E,program:E.program||v,groupOrder:R,renderOrder:b.renderOrder,z:O,group:D}:(F.id=b.id,F.object=b,F.geometry=A,F.material=E,F.program=E.program||v,F.groupOrder=R,F.renderOrder=b.renderOrder,F.z=O,F.group=D),e++,F}return{opaque:a,transparent:d,init:function(){e=0,a.length=0,d.length=0},push:function(b,A,E,R,O,D){var F=C(b,A,E,R,O,D);(!0===E.transparent?d:a).push(F)},unshift:function(b,A,E,R,O,D){var F=C(b,A,E,R,O,D);(!0===E.transparent?d:a).unshift(F)},sort:function(b,A){a.length>1&&a.sort(b||painterSortStable),d.length>1&&d.sort(A||reversePainterSortStable)}}}function WebGLRenderLists(){var s=new WeakMap;function e(v){var g=v.target;g.removeEventListener("dispose",e),s.delete(g)}return{get:function(v,g){var w,C=s.get(v);return void 0===C?(w=new WebGLRenderList,s.set(v,new WeakMap),s.get(v).set(g,w),v.addEventListener("dispose",e)):void 0===(w=C.get(g))&&(w=new WebGLRenderList,C.set(g,w)),w},dispose:function(){s=new WeakMap}}}function WebGLRenderState(){var s=new WebGLLights,e=[],a=[];return{init:function(){e.length=0,a.length=0},state:{lightsArray:e,shadowsArray:a,lights:s},setupLights:function(_){s.setup(e,a,_)},pushLight:function(_){e.push(_)},pushShadow:function(_){a.push(_)}}}function WebGLRenderStates(){var s=new WeakMap;function e(v){var g=v.target;g.removeEventListener("dispose",e),s.delete(g)}return{get:function(v,g){var C;return!1===s.has(v)?(C=new WebGLRenderState,s.set(v,new WeakMap),s.get(v).set(g,C),v.addEventListener("dispose",e)):!1===s.get(v).has(g)?(C=new WebGLRenderState,s.get(v).set(g,C)):C=s.get(v).get(g),C},dispose:function(){s=new WeakMap}}}var vsm_frag="\nuniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n\n#include <packing>\n\nvoid main() {\n\n  float mean = 0.0;\n  float squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n\n    #ifdef HORIZONAL_PASS\n\n      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\n    #else\n\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n\n    #endif\n\n  }\n\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n\n  float std_dev = sqrt( squared_mean - mean * mean );\n\n  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n\n}\n",vsm_vert="\n\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}\n\n";function WebGLShadowMap(s,e,a){var d=new Frustum,v=new Vector2,g=new Vector2,C=new Vector4,w=[],_=[],x={},b={0:BackSide,1:FrontSide,2:DoubleSide},A=new ShaderMaterial({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new Vector2},radius:{value:4}},vertexShader:vsm_vert,fragmentShader:vsm_frag}),E=A.clone();E.defines.HORIZONAL_PASS=1;var R=new BufferGeometry;R.setAttribute("position",new BufferAttribute(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var O=new Mesh(R,A),D=this;function F(H,X){var re=e.update(O);A.uniforms.shadow_pass.value=H.map.texture,A.uniforms.resolution.value=H.mapSize,A.uniforms.radius.value=H.radius,s.setRenderTarget(H.mapPass),s.clear(),s.renderBufferDirect(X,null,re,A,O,null),E.uniforms.shadow_pass.value=H.mapPass.texture,E.uniforms.resolution.value=H.mapSize,E.uniforms.radius.value=H.radius,s.setRenderTarget(H.map),s.clear(),s.renderBufferDirect(X,null,re,E,O,null)}function L(H,X,re){var j=H<<0|X<<1|re<<2,te=w[j];return void 0===te&&(te=new MeshDepthMaterial({depthPacking:RGBADepthPacking,morphTargets:H,skinning:X}),w[j]=te),te}function I(H,X,re){var j=H<<0|X<<1|re<<2,te=_[j];return void 0===te&&(te=new MeshDistanceMaterial({morphTargets:H,skinning:X}),_[j]=te),te}function V(H,X,re,j,te,J){var k=H.geometry,U=null,K=L,ee=H.customDepthMaterial;if(!0===re.isPointLight&&(K=I,ee=H.customDistanceMaterial),void 0===ee){var Q=!1;!0===X.morphTargets&&(!0===k.isBufferGeometry?Q=k.morphAttributes&&k.morphAttributes.position&&k.morphAttributes.position.length>0:!0===k.isGeometry&&(Q=k.morphTargets&&k.morphTargets.length>0));var oe=!1;!0===H.isSkinnedMesh&&(!0===X.skinning?oe=!0:console.warn("WebGLShadowMap: SkinnedMesh with material.skinning set to false:",H)),U=K(Q,oe,!0===H.isInstancedMesh)}else U=ee;if(s.localClippingEnabled&&!0===X.clipShadows&&0!==X.clippingPlanes.length){var fe=U.uuid,ge=X.uuid,$=x[fe];void 0===$&&(x[fe]=$={});var ue=$[ge];void 0===ue&&(ue=U.clone(),$[ge]=ue),U=ue}return U.visible=X.visible,U.wireframe=X.wireframe,U.side=J===VSMShadowMap?null!==X.shadowSide?X.shadowSide:X.side:null!==X.shadowSide?X.shadowSide:b[X.side],U.clipShadows=X.clipShadows,U.clippingPlanes=X.clippingPlanes,U.clipIntersection=X.clipIntersection,U.wireframeLinewidth=X.wireframeLinewidth,U.linewidth=X.linewidth,!0===re.isPointLight&&!0===U.isMeshDistanceMaterial&&(U.referencePosition.setFromMatrixPosition(re.matrixWorld),U.nearDistance=j,U.farDistance=te),U}function z(H,X,re,j,te){if(!1!==H.visible){if(H.layers.test(X.layers)&&(H.isMesh||H.isLine||H.isPoints)&&(H.castShadow||H.receiveShadow&&te===VSMShadowMap)&&(!H.frustumCulled||d.intersectsObject(H))){H.modelViewMatrix.multiplyMatrices(re.matrixWorldInverse,H.matrixWorld);var k=e.update(H),U=H.material;if(Array.isArray(U))for(var K=k.groups,ee=0,Q=K.length;ee<Q;ee++){var oe=K[ee],me=U[oe.materialIndex];if(me&&me.visible){var fe=V(H,me,j,re.near,re.far,te);s.renderBufferDirect(re,null,k,fe,H,oe)}}else U.visible&&(fe=V(H,U,j,re.near,re.far,te),s.renderBufferDirect(re,null,k,fe,H,null))}for(var ge=H.children,$=0,ue=ge.length;$<ue;$++)z(ge[$],X,re,j,te)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=PCFShadowMap,this.render=function(H,X,re){if(!1!==D.enabled&&(!1!==D.autoUpdate||!1!==D.needsUpdate)&&0!==H.length){var j=s.getRenderTarget(),te=s.getActiveCubeFace(),J=s.getActiveMipmapLevel(),k=s.state;k.setBlending(NoBlending),k.buffers.color.setClear(1,1,1,1),k.buffers.depth.setTest(!0),k.setScissorTest(!1);for(var U=0,K=H.length;U<K;U++){var ee=H[U],Q=ee.shadow;if(void 0!==Q){v.copy(Q.mapSize);var me,oe=Q.getFrameExtents();v.multiply(oe),g.copy(Q.mapSize),(v.x>a||v.y>a)&&(console.warn("WebGLShadowMap:",ee,"has shadow exceeding max texture size, reducing"),v.x>a&&(g.x=Math.floor(a/oe.x),v.x=g.x*oe.x,Q.mapSize.x=g.x),v.y>a&&(g.y=Math.floor(a/oe.y),v.y=g.y*oe.y,Q.mapSize.y=g.y)),null!==Q.map||Q.isPointLightShadow||this.type!==VSMShadowMap||(Q.map=new WebGLRenderTarget(v.x,v.y,me={minFilter:LinearFilter,magFilter:LinearFilter,format:RGBAFormat}),Q.map.texture.name=ee.name+".shadowMap",Q.mapPass=new WebGLRenderTarget(v.x,v.y,me),Q.camera.updateProjectionMatrix()),null===Q.map&&(Q.map=new WebGLRenderTarget(v.x,v.y,me={minFilter:NearestFilter,magFilter:NearestFilter,format:RGBAFormat}),Q.map.texture.name=ee.name+".shadowMap",Q.camera.updateProjectionMatrix()),s.setRenderTarget(Q.map),s.clear();for(var fe=Q.getViewportCount(),ge=0;ge<fe;ge++){var $=Q.getViewport(ge);C.set(g.x*$.x,g.y*$.y,g.x*$.z,g.y*$.w),k.viewport(C),Q.updateMatrices(ee,ge),d=Q.getFrustum(),z(X,re,Q.camera,ee,this.type)}!Q.isPointLightShadow&&this.type===VSMShadowMap&&F(Q,re)}else console.warn("WebGLShadowMap:",ee,"has no shadow.")}D.needsUpdate=!1,s.setRenderTarget(j,te,J)}}}function WebGLState(s,e,a){var d=a.isWebGL2,w=new function(){var He=!1,gt=new Vector4,vt=null,Gt=new Vector4(0,0,0,0);return{setMask:function(yt){vt!==yt&&!He&&(s.colorMask(yt,yt,yt,yt),vt=yt)},setLocked:function(yt){He=yt},setClear:function(yt,xr,Dr,Ur,qr){!0===qr&&(yt*=Ur,xr*=Ur,Dr*=Ur),gt.set(yt,xr,Dr,Ur),!1===Gt.equals(gt)&&(s.clearColor(yt,xr,Dr,Ur),Gt.copy(gt))},reset:function(){He=!1,vt=null,Gt.set(-1,0,0,0)}}},_=new function(){var He=!1,gt=null,vt=null,Gt=null;return{setTest:function(yt){yt?ae(s.DEPTH_TEST):pe(s.DEPTH_TEST)},setMask:function(yt){gt!==yt&&!He&&(s.depthMask(yt),gt=yt)},setFunc:function(yt){if(vt!==yt){if(yt)switch(yt){case NeverDepth:s.depthFunc(s.NEVER);break;case AlwaysDepth:s.depthFunc(s.ALWAYS);break;case LessDepth:s.depthFunc(s.LESS);break;case LessEqualDepth:s.depthFunc(s.LEQUAL);break;case EqualDepth:s.depthFunc(s.EQUAL);break;case GreaterEqualDepth:s.depthFunc(s.GEQUAL);break;case GreaterDepth:s.depthFunc(s.GREATER);break;case NotEqualDepth:s.depthFunc(s.NOTEQUAL);break;default:s.depthFunc(s.LEQUAL)}else s.depthFunc(s.LEQUAL);vt=yt}},setLocked:function(yt){He=yt},setClear:function(yt){Gt!==yt&&(s.clearDepth(yt),Gt=yt)},reset:function(){He=!1,gt=null,vt=null,Gt=null}}},x=new function(){var He=!1,gt=null,vt=null,Gt=null,Lt=null,yt=null,xr=null,Dr=null,Ur=null;return{setTest:function(Ar){He||(Ar?ae(s.STENCIL_TEST):pe(s.STENCIL_TEST))},setMask:function(Ar){gt!==Ar&&!He&&(s.stencilMask(Ar),gt=Ar)},setFunc:function(Ar,hn,Sn){(vt!==Ar||Gt!==hn||Lt!==Sn)&&(s.stencilFunc(Ar,hn,Sn),vt=Ar,Gt=hn,Lt=Sn)},setOp:function(Ar,hn,Sn){(yt!==Ar||xr!==hn||Dr!==Sn)&&(s.stencilOp(Ar,hn,Sn),yt=Ar,xr=hn,Dr=Sn)},setLocked:function(Ar){He=Ar},setClear:function(Ar){Ur!==Ar&&(s.clearStencil(Ar),Ur=Ar)},reset:function(){He=!1,gt=null,vt=null,Gt=null,Lt=null,yt=null,xr=null,Dr=null,Ur=null}}},b=s.getParameter(s.MAX_VERTEX_ATTRIBS),A=new Uint8Array(b),E=new Uint8Array(b),R=new Uint8Array(b),O={},D=null,F=null,L=null,I=null,V=null,z=null,H=null,X=null,re=null,j=!1,te=null,J=null,k=null,U=null,K=null,ee=s.getParameter(s.MAX_COMBINED_TEXTURE_IMAGE_UNITS),Q=!1,oe=0,me=s.getParameter(s.VERSION);-1!==me.indexOf("WebGL")?(oe=parseFloat(/^WebGL\ ([0-9])/.exec(me)[1]),Q=oe>=1):-1!==me.indexOf("OpenGL ES")&&(oe=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(me)[1]),Q=oe>=2);var fe=null,ge={},$=new Vector4,ue=new Vector4;function Y(He,gt,vt){var Gt=new Uint8Array(4),Lt=s.createTexture();s.bindTexture(He,Lt),s.texParameteri(He,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texParameteri(He,s.TEXTURE_MAG_FILTER,s.NEAREST);for(var yt=0;yt<vt;yt++)s.texImage2D(gt+yt,0,s.RGBA,1,1,0,s.RGBA,s.UNSIGNED_BYTE,Gt);return Lt}var Z={};function le(He,gt){A[He]=1,0===E[He]&&(s.enableVertexAttribArray(He),E[He]=1),R[He]!==gt&&((d?s:e.get("ANGLE_instanced_arrays"))[d?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](He,gt),R[He]=gt)}function ae(He){!0!==O[He]&&(s.enable(He),O[He]=!0)}function pe(He){!1!==O[He]&&(s.disable(He),O[He]=!1)}Z[s.TEXTURE_2D]=Y(s.TEXTURE_2D,s.TEXTURE_2D,1),Z[s.TEXTURE_CUBE_MAP]=Y(s.TEXTURE_CUBE_MAP,s.TEXTURE_CUBE_MAP_POSITIVE_X,6),w.setClear(0,0,0,1),_.setClear(1),x.setClear(0),ae(s.DEPTH_TEST),_.setFunc(LessEqualDepth),Ne(!1),Re(CullFaceBack),ae(s.CULL_FACE),xe(NoBlending);var ce={};if(ce[AddEquation]=s.FUNC_ADD,ce[SubtractEquation]=s.FUNC_SUBTRACT,ce[ReverseSubtractEquation]=s.FUNC_REVERSE_SUBTRACT,d)ce[MinEquation]=s.MIN,ce[MaxEquation]=s.MAX;else{var Te=e.get("EXT_blend_minmax");null!==Te&&(ce[MinEquation]=Te.MIN_EXT,ce[MaxEquation]=Te.MAX_EXT)}var be={};function xe(He,gt,vt,Gt,Lt,yt,xr,Dr){if(He!==NoBlending){if(F||(ae(s.BLEND),F=!0),He===CustomBlending)Lt=Lt||gt,yt=yt||vt,xr=xr||Gt,(gt!==I||Lt!==H)&&(s.blendEquationSeparate(ce[gt],ce[Lt]),I=gt,H=Lt),(vt!==V||Gt!==z||yt!==X||xr!==re)&&(s.blendFuncSeparate(be[vt],be[Gt],be[yt],be[xr]),V=vt,z=Gt,X=yt,re=xr),L=He,j=null;else if(He!==L||Dr!==j){if((I!==AddEquation||H!==AddEquation)&&(s.blendEquation(s.FUNC_ADD),I=AddEquation,H=AddEquation),Dr)switch(He){case NormalBlending:s.blendFuncSeparate(s.ONE,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:s.blendFunc(s.ONE,s.ONE);break;case SubtractiveBlending:s.blendFuncSeparate(s.ZERO,s.ZERO,s.ONE_MINUS_SRC_COLOR,s.ONE_MINUS_SRC_ALPHA);break;case MultiplyBlending:s.blendFuncSeparate(s.ZERO,s.SRC_COLOR,s.ZERO,s.SRC_ALPHA);break;default:console.error("WebGLState: Invalid blending: ",He)}else switch(He){case NormalBlending:s.blendFuncSeparate(s.SRC_ALPHA,s.ONE_MINUS_SRC_ALPHA,s.ONE,s.ONE_MINUS_SRC_ALPHA);break;case AdditiveBlending:s.blendFunc(s.SRC_ALPHA,s.ONE);break;case SubtractiveBlending:s.blendFunc(s.ZERO,s.ONE_MINUS_SRC_COLOR);break;case MultiplyBlending:s.blendFunc(s.ZERO,s.SRC_COLOR);break;default:console.error("WebGLState: Invalid blending: ",He)}V=null,z=null,X=null,re=null,L=He,j=Dr}}else F&&(pe(s.BLEND),F=!1)}function Ne(He){te!==He&&(s.frontFace(He?s.CW:s.CCW),te=He)}function Re(He){He!==CullFaceNone?(ae(s.CULL_FACE),He!==J&&s.cullFace(He===CullFaceBack?s.BACK:He===CullFaceFront?s.FRONT:s.FRONT_AND_BACK)):pe(s.CULL_FACE),J=He}function Je(He,gt,vt){He?(ae(s.POLYGON_OFFSET_FILL),(U!==gt||K!==vt)&&(s.polygonOffset(gt,vt),U=gt,K=vt)):pe(s.POLYGON_OFFSET_FILL)}function pt(He){void 0===He&&(He=s.TEXTURE0+ee-1),fe!==He&&(s.activeTexture(He),fe=He)}return be[ZeroFactor]=s.ZERO,be[OneFactor]=s.ONE,be[SrcColorFactor]=s.SRC_COLOR,be[SrcAlphaFactor]=s.SRC_ALPHA,be[SrcAlphaSaturateFactor]=s.SRC_ALPHA_SATURATE,be[DstColorFactor]=s.DST_COLOR,be[DstAlphaFactor]=s.DST_ALPHA,be[OneMinusSrcColorFactor]=s.ONE_MINUS_SRC_COLOR,be[OneMinusSrcAlphaFactor]=s.ONE_MINUS_SRC_ALPHA,be[OneMinusDstColorFactor]=s.ONE_MINUS_DST_COLOR,be[OneMinusDstAlphaFactor]=s.ONE_MINUS_DST_ALPHA,{buffers:{color:w,depth:_,stencil:x},initAttributes:function(){for(var He=0,gt=A.length;He<gt;He++)A[He]=0},enableAttribute:function(He){le(He,0)},enableAttributeAndDivisor:le,disableUnusedAttributes:function(){for(var He=0,gt=E.length;He!==gt;++He)E[He]!==A[He]&&(s.disableVertexAttribArray(He),E[He]=0)},enable:ae,disable:pe,useProgram:function(He){return D!==He&&(s.useProgram(He),D=He,!0)},setBlending:xe,setMaterial:function(He,gt){He.side===DoubleSide?pe(s.CULL_FACE):ae(s.CULL_FACE);var vt=He.side===BackSide;gt&&(vt=!vt),Ne(vt),He.blending===NormalBlending&&!1===He.transparent?xe(NoBlending):xe(He.blending,He.blendEquation,He.blendSrc,He.blendDst,He.blendEquationAlpha,He.blendSrcAlpha,He.blendDstAlpha,He.premultipliedAlpha),_.setFunc(He.depthFunc),_.setTest(He.depthTest),_.setMask(He.depthWrite),w.setMask(He.colorWrite);var Gt=He.stencilWrite;x.setTest(Gt),Gt&&(x.setMask(He.stencilWriteMask),x.setFunc(He.stencilFunc,He.stencilRef,He.stencilFuncMask),x.setOp(He.stencilFail,He.stencilZFail,He.stencilZPass)),Je(He.polygonOffset,He.polygonOffsetFactor,He.polygonOffsetUnits)},setFlipSided:Ne,setCullFace:Re,setLineWidth:function(He){He!==k&&(Q&&s.lineWidth(He),k=He)},setPolygonOffset:Je,setScissorTest:function(He){He?ae(s.SCISSOR_TEST):pe(s.SCISSOR_TEST)},activeTexture:pt,bindTexture:function(He,gt){null===fe&&pt();var vt=ge[fe];void 0===vt&&(ge[fe]=vt={type:void 0,texture:void 0}),(vt.type!==He||vt.texture!==gt)&&(s.bindTexture(He,gt||Z[He]),vt.type=He,vt.texture=gt)},unbindTexture:function(){var He=ge[fe];void 0!==He&&void 0!==He.type&&(s.bindTexture(He.type,null),He.type=void 0,He.texture=void 0)},compressedTexImage2D:function(){try{s.compressedTexImage2D.apply(s,arguments)}catch(He){console.error("WebGLState:",He)}},texImage2D:function(){try{s.texImage2D.apply(s,arguments)}catch(He){console.error("WebGLState:",He)}},texImage3D:function(){try{s.texImage3D.apply(s,arguments)}catch(He){console.error("WebGLState:",He)}},scissor:function(He){!1===$.equals(He)&&(s.scissor(He.x,He.y,He.z,He.w),$.copy(He))},viewport:function(He){!1===ue.equals(He)&&(s.viewport(He.x,He.y,He.z,He.w),ue.copy(He))},reset:function(){for(var He=0;He<E.length;He++)1===E[He]&&(s.disableVertexAttribArray(He),E[He]=0);O={},fe=null,ge={},D=null,L=null,te=null,J=null,w.reset(),_.reset(),x.reset()}}}function WebGLTextures(s,e,a,d,v,g,C){var R,w=v.isWebGL2,_=v.maxTextures,x=v.maxCubemapSize,b=v.maxTextureSize,A=v.maxSamples,E=new WeakMap,O=!1;try{O="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(Re){}function D(Re,De){return O?new OffscreenCanvas(Re,De):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function F(Re,De,Je,$e){var pt=1;if((Re.width>$e||Re.height>$e)&&(pt=$e/Math.max(Re.width,Re.height)),pt<1||!0===De){if("undefined"!=typeof HTMLImageElement&&Re instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&Re instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&Re instanceof ImageBitmap){var ut=De?MathUtils.floorPowerOfTwo:Math.floor,at=ut(pt*Re.width),Xe=ut(pt*Re.height);void 0===R&&(R=D(at,Xe));var Ke=Je?D(at,Xe):R;return Ke.width=at,Ke.height=Xe,Ke.getContext("2d").drawImage(Re,0,0,at,Xe),console.warn("WebGLRenderer: Texture has been resized from ("+Re.width+"x"+Re.height+") to ("+at+"x"+Xe+")."),Ke}return"data"in Re&&console.warn("WebGLRenderer: Image in DataTexture is too big ("+Re.width+"x"+Re.height+")."),Re}return Re}function L(Re){return MathUtils.isPowerOfTwo(Re.width)&&MathUtils.isPowerOfTwo(Re.height)}function V(Re,De){return Re.generateMipmaps&&De&&Re.minFilter!==NearestFilter&&Re.minFilter!==LinearFilter}function z(Re,De,Je,$e){s.generateMipmap(Re),d.get(De).__maxMipLevel=Math.log(Math.max(Je,$e))*Math.LOG2E}function H(Re,De,Je){if(!1===w)return De;if(null!==Re){if(void 0!==s[Re])return s[Re];console.warn("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Re+"'")}var $e=De;return De===s.RED&&(Je===s.FLOAT&&($e=s.R32F),Je===s.HALF_FLOAT&&($e=s.R16F),Je===s.UNSIGNED_BYTE&&($e=s.R8)),De===s.RGB&&(Je===s.FLOAT&&($e=s.RGB32F),Je===s.HALF_FLOAT&&($e=s.RGB16F),Je===s.UNSIGNED_BYTE&&($e=s.RGB8)),De===s.RGBA&&(Je===s.FLOAT&&($e=s.RGBA32F),Je===s.HALF_FLOAT&&($e=s.RGBA16F),Je===s.UNSIGNED_BYTE&&($e=s.RGBA8)),$e===s.R16F||$e===s.R32F||$e===s.RGBA16F||$e===s.RGBA32F?e.get("EXT_color_buffer_float"):($e===s.RGB16F||$e===s.RGB32F)&&console.warn("WebGLRenderer: Floating point textures with RGB format not supported. Please use RGBA instead."),$e}function X(Re){return Re===NearestFilter||Re===NearestMipmapNearestFilter||Re===NearestMipmapLinearFilter?s.NEAREST:s.LINEAR}function re(Re){var De=Re.target;De.removeEventListener("dispose",re),function(Re){var De=d.get(Re);void 0!==De.__webglInit&&(s.deleteTexture(De.__webglTexture),d.remove(Re))}(De),De.isVideoTexture&&E.delete(De),C.memory.textures--}function j(Re){var De=Re.target;De.removeEventListener("dispose",j),function(Re){var De=d.get(Re),Je=d.get(Re.texture);if(Re){if(void 0!==Je.__webglTexture&&s.deleteTexture(Je.__webglTexture),Re.depthTexture&&Re.depthTexture.dispose(),Re.isWebGLCubeRenderTarget)for(var $e=0;$e<6;$e++)s.deleteFramebuffer(De.__webglFramebuffer[$e]),De.__webglDepthbuffer&&s.deleteRenderbuffer(De.__webglDepthbuffer[$e]);else s.deleteFramebuffer(De.__webglFramebuffer),De.__webglDepthbuffer&&s.deleteRenderbuffer(De.__webglDepthbuffer);if(Re.isWebGLMultiviewRenderTarget){s.deleteTexture(De.__webglColorTexture),s.deleteTexture(De.__webglDepthStencilTexture),C.memory.textures-=2,$e=0;for(var pt=De.__webglViewFramebuffers.length;$e<pt;$e++)s.deleteFramebuffer(De.__webglViewFramebuffers[$e])}d.remove(Re.texture),d.remove(Re)}}(De),C.memory.textures--}var k=0;function ee(Re,De){var Je=d.get(Re);if(Re.isVideoTexture&&function(Re){var De=C.render.frame;E.get(Re)!==De&&(E.set(Re,De),Re.update())}(Re),Re.version>0&&Je.__version!==Re.version){var $e=Re.image;if(void 0===$e)console.warn("WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==$e.complete)return void Z(Je,Re,De);console.warn("WebGLRenderer: Texture marked for update but image is incomplete")}}a.activeTexture(s.TEXTURE0+De),a.bindTexture(s.TEXTURE_2D,Je.__webglTexture)}function me(Re,De){if(6===Re.image.length){var Je=d.get(Re);if(Re.version>0&&Je.__version!==Re.version){Y(Je,Re),a.activeTexture(s.TEXTURE0+De),a.bindTexture(s.TEXTURE_CUBE_MAP,Je.__webglTexture),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,Re.flipY);for(var $e=Re&&(Re.isCompressedTexture||Re.image[0].isCompressedTexture),pt=Re.image[0]&&Re.image[0].isDataTexture,ut=[],at=0;at<6;at++)ut[at]=$e||pt?pt?Re.image[at].image:Re.image[at]:F(Re.image[at],!1,!0,x);var ft,Xe=ut[0],Ke=L(Xe)||w,lt=g.convert(Re.format),ot=g.convert(Re.type),St=H(Re.internalFormat,lt,ot);if(ue(s.TEXTURE_CUBE_MAP,Re,Ke),$e){for(at=0;at<6;at++){ft=ut[at].mipmaps;for(var He=0;He<ft.length;He++){var gt=ft[He];Re.format!==RGBAFormat&&Re.format!==RGBFormat?null!==lt?a.compressedTexImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+at,He,St,gt.width,gt.height,0,gt.data):console.warn("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):a.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+at,He,St,gt.width,gt.height,0,lt,ot,gt.data)}}Je.__maxMipLevel=ft.length-1}else{for(ft=Re.mipmaps,at=0;at<6;at++)if(pt)for(a.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+at,0,St,ut[at].width,ut[at].height,0,lt,ot,ut[at].data),He=0;He<ft.length;He++){var vt=(gt=ft[He]).image[at].image;a.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+at,He+1,St,vt.width,vt.height,0,lt,ot,vt.data)}else for(a.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+at,0,St,lt,ot,ut[at]),He=0;He<ft.length;He++)a.texImage2D(s.TEXTURE_CUBE_MAP_POSITIVE_X+at,He+1,St,lt,ot,(gt=ft[He]).image[at]);Je.__maxMipLevel=ft.length}V(Re,Ke)&&z(s.TEXTURE_CUBE_MAP,Re,Xe.width,Xe.height),Je.__version=Re.version,Re.onUpdate&&Re.onUpdate(Re)}else a.activeTexture(s.TEXTURE0+De),a.bindTexture(s.TEXTURE_CUBE_MAP,Je.__webglTexture)}}function fe(Re,De){a.activeTexture(s.TEXTURE0+De),a.bindTexture(s.TEXTURE_CUBE_MAP,d.get(Re).__webglTexture)}var ge={};ge[RepeatWrapping]=s.REPEAT,ge[ClampToEdgeWrapping]=s.CLAMP_TO_EDGE,ge[MirroredRepeatWrapping]=s.MIRRORED_REPEAT;var $={};function ue(Re,De,Je){Je?(s.texParameteri(Re,s.TEXTURE_WRAP_S,ge[De.wrapS]),s.texParameteri(Re,s.TEXTURE_WRAP_T,ge[De.wrapT]),(Re===s.TEXTURE_3D||Re===s.TEXTURE_2D_ARRAY)&&s.texParameteri(Re,s.TEXTURE_WRAP_R,ge[De.wrapR]),s.texParameteri(Re,s.TEXTURE_MAG_FILTER,$[De.magFilter]),s.texParameteri(Re,s.TEXTURE_MIN_FILTER,$[De.minFilter])):(s.texParameteri(Re,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(Re,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),(Re===s.TEXTURE_3D||Re===s.TEXTURE_2D_ARRAY)&&s.texParameteri(Re,s.TEXTURE_WRAP_R,s.CLAMP_TO_EDGE),(De.wrapS!==ClampToEdgeWrapping||De.wrapT!==ClampToEdgeWrapping)&&console.warn("WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to ClampToEdgeWrapping."),s.texParameteri(Re,s.TEXTURE_MAG_FILTER,X(De.magFilter)),s.texParameteri(Re,s.TEXTURE_MIN_FILTER,X(De.minFilter)),De.minFilter!==NearestFilter&&De.minFilter!==LinearFilter&&console.warn("WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to NearestFilter or LinearFilter."));var $e=e.get("EXT_texture_filter_anisotropic");if($e){if(De.type===FloatType&&null===e.get("OES_texture_float_linear")||De.type===HalfFloatType&&null===(w||e.get("OES_texture_half_float_linear")))return;(De.anisotropy>1||d.get(De).__currentAnisotropy)&&(s.texParameterf(Re,$e.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(De.anisotropy,v.getMaxAnisotropy())),d.get(De).__currentAnisotropy=De.anisotropy)}}function Y(Re,De){void 0===Re.__webglInit&&(Re.__webglInit=!0,De.addEventListener("dispose",re),Re.__webglTexture=s.createTexture(),C.memory.textures++)}function Z(Re,De,Je){var $e=s.TEXTURE_2D;De.isDataTexture2DArray&&($e=s.TEXTURE_2D_ARRAY),De.isDataTexture3D&&($e=s.TEXTURE_3D),Y(Re,De),a.activeTexture(s.TEXTURE0+Je),a.bindTexture($e,Re.__webglTexture),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,De.flipY),s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,De.premultiplyAlpha),s.pixelStorei(s.UNPACK_ALIGNMENT,De.unpackAlignment);var pt=function(Re){return!w&&(Re.wrapS!==ClampToEdgeWrapping||Re.wrapT!==ClampToEdgeWrapping||Re.minFilter!==NearestFilter&&Re.minFilter!==LinearFilter)}(De)&&!1===L(De.image),ut=F(De.image,pt,!1,b),at=L(ut)||w,Xe=g.convert(De.format),Ke=g.convert(De.type),lt=H(De.internalFormat,Xe,Ke);ue($e,De,at);var ot,St=De.mipmaps;if(De.isDepthTexture){if(lt=s.DEPTH_COMPONENT,De.type===FloatType){if(!1===w)throw new Error("Float Depth Texture only supported in WebGL2.0");lt=s.DEPTH_COMPONENT32F}else w&&(lt=s.DEPTH_COMPONENT16);De.format===DepthFormat&&lt===s.DEPTH_COMPONENT&&De.type!==UnsignedShortType&&De.type!==UnsignedIntType&&(console.warn("WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),De.type=UnsignedShortType,Ke=g.convert(De.type)),De.format===DepthStencilFormat&&(lt=s.DEPTH_STENCIL,De.type!==UnsignedInt248Type&&(console.warn("WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),De.type=UnsignedInt248Type,Ke=g.convert(De.type))),a.texImage2D(s.TEXTURE_2D,0,lt,ut.width,ut.height,0,Xe,Ke,null)}else if(De.isDataTexture)if(St.length>0&&at){for(var ft=0,He=St.length;ft<He;ft++)a.texImage2D(s.TEXTURE_2D,ft,lt,(ot=St[ft]).width,ot.height,0,Xe,Ke,ot.data);De.generateMipmaps=!1,Re.__maxMipLevel=St.length-1}else a.texImage2D(s.TEXTURE_2D,0,lt,ut.width,ut.height,0,Xe,Ke,ut.data),Re.__maxMipLevel=0;else if(De.isCompressedTexture){for(ft=0,He=St.length;ft<He;ft++)ot=St[ft],De.format!==RGBAFormat&&De.format!==RGBFormat?null!==Xe?a.compressedTexImage2D(s.TEXTURE_2D,ft,lt,ot.width,ot.height,0,ot.data):console.warn("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):a.texImage2D(s.TEXTURE_2D,ft,lt,ot.width,ot.height,0,Xe,Ke,ot.data);Re.__maxMipLevel=St.length-1}else if(De.isDataTexture2DArray)a.texImage3D(s.TEXTURE_2D_ARRAY,0,lt,ut.width,ut.height,ut.depth,0,Xe,Ke,ut.data),Re.__maxMipLevel=0;else if(De.isDataTexture3D)a.texImage3D(s.TEXTURE_3D,0,lt,ut.width,ut.height,ut.depth,0,Xe,Ke,ut.data),Re.__maxMipLevel=0;else if(St.length>0&&at){for(ft=0,He=St.length;ft<He;ft++)a.texImage2D(s.TEXTURE_2D,ft,lt,Xe,Ke,ot=St[ft]);De.generateMipmaps=!1,Re.__maxMipLevel=St.length-1}else a.texImage2D(s.TEXTURE_2D,0,lt,Xe,Ke,ut),Re.__maxMipLevel=0;V(De,at)&&z($e,De,ut.width,ut.height),Re.__version=De.version,De.onUpdate&&De.onUpdate(De)}function se(Re,De,Je,$e){var pt=g.convert(De.texture.format),ut=g.convert(De.texture.type),at=H(De.texture.internalFormat,pt,ut);a.texImage2D($e,0,at,De.width,De.height,0,pt,ut,null),s.bindFramebuffer(s.FRAMEBUFFER,Re),s.framebufferTexture2D(s.FRAMEBUFFER,Je,$e,d.get(De.texture).__webglTexture,0),s.bindFramebuffer(s.FRAMEBUFFER,null)}function ve(Re,De,Je){if(s.bindRenderbuffer(s.RENDERBUFFER,Re),De.depthBuffer&&!De.stencilBuffer){if(Je){var $e=ce(De);s.renderbufferStorageMultisample(s.RENDERBUFFER,$e,s.DEPTH_COMPONENT16,De.width,De.height)}else s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_COMPONENT16,De.width,De.height);s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,Re)}else if(De.depthBuffer&&De.stencilBuffer)Je?($e=ce(De),s.renderbufferStorageMultisample(s.RENDERBUFFER,$e,s.DEPTH24_STENCIL8,De.width,De.height)):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,De.width,De.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,Re);else{var pt=g.convert(De.texture.format),ut=g.convert(De.texture.type),at=H(De.texture.internalFormat,pt,ut);Je?($e=ce(De),s.renderbufferStorageMultisample(s.RENDERBUFFER,$e,at,De.width,De.height)):s.renderbufferStorage(s.RENDERBUFFER,at,De.width,De.height)}s.bindRenderbuffer(s.RENDERBUFFER,null)}function ce(Re){return w&&Re.isWebGLMultisampleRenderTarget?Math.min(A,Re.samples):0}$[NearestFilter]=s.NEAREST,$[NearestMipmapNearestFilter]=s.NEAREST_MIPMAP_NEAREST,$[NearestMipmapLinearFilter]=s.NEAREST_MIPMAP_LINEAR,$[LinearFilter]=s.LINEAR,$[LinearMipmapNearestFilter]=s.LINEAR_MIPMAP_NEAREST,$[LinearMipmapLinearFilter]=s.LINEAR_MIPMAP_LINEAR;var be=!1,xe=!1;this.allocateTextureUnit=function(){var Re=k;return Re>=_&&console.warn("WebGLTextures: Trying to use "+Re+" texture units while this GPU supports only "+_),k+=1,Re},this.resetTextureUnits=function(){k=0},this.setTexture2D=ee,this.setTexture2DArray=function(Re,De){var Je=d.get(Re);Re.version>0&&Je.__version!==Re.version?Z(Je,Re,De):(a.activeTexture(s.TEXTURE0+De),a.bindTexture(s.TEXTURE_2D_ARRAY,Je.__webglTexture))},this.setTexture3D=function(Re,De){var Je=d.get(Re);Re.version>0&&Je.__version!==Re.version?Z(Je,Re,De):(a.activeTexture(s.TEXTURE0+De),a.bindTexture(s.TEXTURE_3D,Je.__webglTexture))},this.setTextureCube=me,this.setTextureCubeDynamic=fe,this.setupRenderTarget=function(Re){var De=d.get(Re),Je=d.get(Re.texture);Re.addEventListener("dispose",j),Je.__webglTexture=s.createTexture(),C.memory.textures++;var $e=!0===Re.isWebGLCubeRenderTarget,pt=!0===Re.isWebGLMultisampleRenderTarget,ut=!0===Re.isWebGLMultiviewRenderTarget,at=L(Re)||w;if($e){De.__webglFramebuffer=[];for(var Xe=0;Xe<6;Xe++)De.__webglFramebuffer[Xe]=s.createFramebuffer()}else if(De.__webglFramebuffer=s.createFramebuffer(),pt)if(w){De.__webglMultisampledFramebuffer=s.createFramebuffer(),De.__webglColorRenderbuffer=s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,De.__webglColorRenderbuffer);var Ke=g.convert(Re.texture.format),lt=g.convert(Re.texture.type),ot=H(Re.texture.internalFormat,Ke,lt),St=ce(Re);s.renderbufferStorageMultisample(s.RENDERBUFFER,St,ot,Re.width,Re.height),s.bindFramebuffer(s.FRAMEBUFFER,De.__webglMultisampledFramebuffer),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.RENDERBUFFER,De.__webglColorRenderbuffer),s.bindRenderbuffer(s.RENDERBUFFER,null),Re.depthBuffer&&(De.__webglDepthRenderbuffer=s.createRenderbuffer(),ve(De.__webglDepthRenderbuffer,Re,!0)),s.bindFramebuffer(s.FRAMEBUFFER,null)}else console.warn("WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");else if(ut){var ft=Re.width,He=Re.height,gt=Re.numViews;s.bindFramebuffer(s.FRAMEBUFFER,De.__webglFramebuffer);var vt=e.get("OVR_multiview2");C.memory.textures+=2;var Gt=s.createTexture();s.bindTexture(s.TEXTURE_2D_ARRAY,Gt),s.texParameteri(s.TEXTURE_2D_ARRAY,s.TEXTURE_MAG_FILTER,s.NEAREST),s.texParameteri(s.TEXTURE_2D_ARRAY,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texImage3D(s.TEXTURE_2D_ARRAY,0,s.RGBA8,ft,He,gt,0,s.RGBA,s.UNSIGNED_BYTE,null),vt.framebufferTextureMultiviewOVR(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,Gt,0,0,gt);var Lt=s.createTexture();s.bindTexture(s.TEXTURE_2D_ARRAY,Lt),s.texParameteri(s.TEXTURE_2D_ARRAY,s.TEXTURE_MAG_FILTER,s.NEAREST),s.texParameteri(s.TEXTURE_2D_ARRAY,s.TEXTURE_MIN_FILTER,s.NEAREST),s.texImage3D(s.TEXTURE_2D_ARRAY,0,s.DEPTH24_STENCIL8,ft,He,gt,0,s.DEPTH_STENCIL,s.UNSIGNED_INT_24_8,null),vt.framebufferTextureMultiviewOVR(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,Lt,0,0,gt);var yt=new Array(gt);for(Xe=0;Xe<gt;++Xe)yt[Xe]=s.createFramebuffer(),s.bindFramebuffer(s.FRAMEBUFFER,yt[Xe]),s.framebufferTextureLayer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,Gt,0,Xe);De.__webglColorTexture=Gt,De.__webglDepthStencilTexture=Lt,De.__webglViewFramebuffers=yt,s.bindFramebuffer(s.FRAMEBUFFER,null),s.bindTexture(s.TEXTURE_2D_ARRAY,null)}if($e){for(a.bindTexture(s.TEXTURE_CUBE_MAP,Je.__webglTexture),ue(s.TEXTURE_CUBE_MAP,Re.texture,at),Xe=0;Xe<6;Xe++)se(De.__webglFramebuffer[Xe],Re,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+Xe);V(Re.texture,at)&&z(s.TEXTURE_CUBE_MAP,Re.texture,Re.width,Re.height),a.bindTexture(s.TEXTURE_CUBE_MAP,null)}else ut||(a.bindTexture(s.TEXTURE_2D,Je.__webglTexture),ue(s.TEXTURE_2D,Re.texture,at),se(De.__webglFramebuffer,Re,s.COLOR_ATTACHMENT0,s.TEXTURE_2D),V(Re.texture,at)&&z(s.TEXTURE_2D,Re.texture,Re.width,Re.height),a.bindTexture(s.TEXTURE_2D,null));Re.depthBuffer&&function(Re){var De=d.get(Re),Je=!0===Re.isWebGLCubeRenderTarget;if(Re.depthTexture){if(Je)throw new Error("target.depthTexture not supported in Cube render targets");!function(Re,De){if(De&&De.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(s.bindFramebuffer(s.FRAMEBUFFER,Re),!De.depthTexture||!De.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of DepthTexture");(!d.get(De.depthTexture).__webglTexture||De.depthTexture.image.width!==De.width||De.depthTexture.image.height!==De.height)&&(De.depthTexture.image.width=De.width,De.depthTexture.image.height=De.height,De.depthTexture.needsUpdate=!0),ee(De.depthTexture,0);var $e=d.get(De.depthTexture).__webglTexture;if(De.depthTexture.format===DepthFormat)s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,$e,0);else{if(De.depthTexture.format!==DepthStencilFormat)throw new Error("Unknown depthTexture format");s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.TEXTURE_2D,$e,0)}}(De.__webglFramebuffer,Re)}else if(Je){De.__webglDepthbuffer=[];for(var $e=0;$e<6;$e++)s.bindFramebuffer(s.FRAMEBUFFER,De.__webglFramebuffer[$e]),De.__webglDepthbuffer[$e]=s.createRenderbuffer(),ve(De.__webglDepthbuffer[$e],Re)}else s.bindFramebuffer(s.FRAMEBUFFER,De.__webglFramebuffer),De.__webglDepthbuffer=s.createRenderbuffer(),ve(De.__webglDepthbuffer,Re);s.bindFramebuffer(s.FRAMEBUFFER,null)}(Re)},this.updateRenderTargetMipmap=function(Re){var De=Re.texture;if(V(De,L(Re)||w)){var $e=Re.isWebGLCubeRenderTarget?s.TEXTURE_CUBE_MAP:s.TEXTURE_2D,pt=d.get(De).__webglTexture;a.bindTexture($e,pt),z($e,De,Re.width,Re.height),a.bindTexture($e,null)}},this.updateMultisampleRenderTarget=function(Re){if(Re.isWebGLMultisampleRenderTarget)if(w){var De=d.get(Re);s.bindFramebuffer(s.READ_FRAMEBUFFER,De.__webglMultisampledFramebuffer),s.bindFramebuffer(s.DRAW_FRAMEBUFFER,De.__webglFramebuffer);var Je=Re.width,$e=Re.height,pt=s.COLOR_BUFFER_BIT;Re.depthBuffer&&(pt|=s.DEPTH_BUFFER_BIT),Re.stencilBuffer&&(pt|=s.STENCIL_BUFFER_BIT),s.blitFramebuffer(0,0,Je,$e,0,0,Je,$e,pt,s.NEAREST)}else console.warn("WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(Re,De){Re&&Re.isWebGLRenderTarget&&(!1===be&&(console.warn("WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),be=!0),Re=Re.texture),ee(Re,De)},this.safeSetTextureCube=function(Re,De){Re&&Re.isWebGLCubeRenderTarget&&(!1===xe&&(console.warn("WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),xe=!0),Re=Re.texture),Re&&Re.isCubeTexture||Array.isArray(Re.image)&&6===Re.image.length?me(Re,De):fe(Re,De)}}function WebGLUtils(s,e,a){var d=a.isWebGL2;return{convert:function(g){var C;if(g===UnsignedByteType)return s.UNSIGNED_BYTE;if(g===UnsignedShort4444Type)return s.UNSIGNED_SHORT_4_4_4_4;if(g===UnsignedShort5551Type)return s.UNSIGNED_SHORT_5_5_5_1;if(g===UnsignedShort565Type)return s.UNSIGNED_SHORT_5_6_5;if(g===ByteType)return s.BYTE;if(g===ShortType)return s.SHORT;if(g===UnsignedShortType)return s.UNSIGNED_SHORT;if(g===IntType)return s.INT;if(g===UnsignedIntType)return s.UNSIGNED_INT;if(g===FloatType)return s.FLOAT;if(g===HalfFloatType)return d?s.HALF_FLOAT:null!==(C=e.get("OES_texture_half_float"))?C.HALF_FLOAT_OES:null;if(g===AlphaFormat)return s.ALPHA;if(g===RGBFormat)return s.RGB;if(g===RGBAFormat)return s.RGBA;if(g===LuminanceFormat)return s.LUMINANCE;if(g===LuminanceAlphaFormat)return s.LUMINANCE_ALPHA;if(g===DepthFormat)return s.DEPTH_COMPONENT;if(g===DepthStencilFormat)return s.DEPTH_STENCIL;if(g===RedFormat)return s.RED;if(g===RedIntegerFormat)return s.RED_INTEGER;if(g===RGFormat)return s.RG;if(g===RGIntegerFormat)return s.RG_INTEGER;if(g===RGBIntegerFormat)return s.RGB_INTEGER;if(g===RGBAIntegerFormat)return s.RGBA_INTEGER;if(g===RGB_S3TC_DXT1_Format||g===RGBA_S3TC_DXT1_Format||g===RGBA_S3TC_DXT3_Format||g===RGBA_S3TC_DXT5_Format){if(null===(C=e.get("WEBGL_compressed_texture_s3tc")))return null;if(g===RGB_S3TC_DXT1_Format)return C.COMPRESSED_RGB_S3TC_DXT1_EXT;if(g===RGBA_S3TC_DXT1_Format)return C.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(g===RGBA_S3TC_DXT3_Format)return C.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(g===RGBA_S3TC_DXT5_Format)return C.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(g===RGB_PVRTC_4BPPV1_Format||g===RGB_PVRTC_2BPPV1_Format||g===RGBA_PVRTC_4BPPV1_Format||g===RGBA_PVRTC_2BPPV1_Format){if(null===(C=e.get("WEBGL_compressed_texture_pvrtc")))return null;if(g===RGB_PVRTC_4BPPV1_Format)return C.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(g===RGB_PVRTC_2BPPV1_Format)return C.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(g===RGBA_PVRTC_4BPPV1_Format)return C.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(g===RGBA_PVRTC_2BPPV1_Format)return C.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}return g===RGB_ETC1_Format?null!==(C=e.get("WEBGL_compressed_texture_etc1"))?C.COMPRESSED_RGB_ETC1_WEBGL:null:g===RGBA_ASTC_4x4_Format||g===RGBA_ASTC_5x4_Format||g===RGBA_ASTC_5x5_Format||g===RGBA_ASTC_6x5_Format||g===RGBA_ASTC_6x6_Format||g===RGBA_ASTC_8x5_Format||g===RGBA_ASTC_8x6_Format||g===RGBA_ASTC_8x8_Format||g===RGBA_ASTC_10x5_Format||g===RGBA_ASTC_10x6_Format||g===RGBA_ASTC_10x8_Format||g===RGBA_ASTC_10x10_Format||g===RGBA_ASTC_12x10_Format||g===RGBA_ASTC_12x12_Format?null!==(C=e.get("WEBGL_compressed_texture_astc"))?g:null:g===UnsignedInt248Type?d?s.UNSIGNED_INT_24_8:null!==(C=e.get("WEBGL_depth_texture"))?C.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}function WebGLMultisampleRenderTarget(s,e,a){WebGLRenderTarget.call(this,s,e,a),this.samples=4}function WebXRManager(s,e){var a=this,d=null,v=null,g="local-floor",C=null,w=[],_=new Map,x=new PerspectiveCamera;x.layers.enable(1),x.viewport=new Vector4;var b=new PerspectiveCamera;b.layers.enable(2),b.viewport=new Vector4;var A=new ArrayCamera([x,b]);A.layers.enable(1),A.layers.enable(2);var E=null,R=null;function O(te){var J=_.get(te.inputSource);J&&(J.targetRay&&J.targetRay.dispatchEvent({type:te.type}),J.grip&&J.grip.dispatchEvent({type:te.type}))}function D(){_.forEach(function(te,J){te.targetRay&&(te.targetRay.dispatchEvent({type:"disconnected",data:J}),te.targetRay.visible=!1),te.grip&&(te.grip.dispatchEvent({type:"disconnected",data:J}),te.grip.visible=!1)}),_.clear(),s.setFramebuffer(null),s.setRenderTarget(s.getRenderTarget()),j.stop(),a.isPresenting=!1,a.dispatchEvent({type:"sessionend"})}function F(te){v=te,j.setContext(d),j.start(),a.isPresenting=!0,a.dispatchEvent({type:"sessionstart"})}function L(te){for(var J=d.inputSources,k=0;k<w.length;k++)_.set(J[k],w[k]);for(k=0;k<te.removed.length;k++)(K=_.get(U=te.removed[k]))&&(K.targetRay&&K.targetRay.dispatchEvent({type:"disconnected",data:U}),K.grip&&K.grip.dispatchEvent({type:"disconnected",data:U}),_.delete(U));for(k=0;k<te.added.length;k++){var U,K;(K=_.get(U=te.added[k]))&&(K.targetRay&&K.targetRay.dispatchEvent({type:"connected",data:U}),K.grip&&K.grip.dispatchEvent({type:"connected",data:U}))}}this.enabled=!1,this.isPresenting=!1,this.getController=function(te){var J=w[te];return void 0===J&&(w[te]=J={}),void 0===J.targetRay&&(J.targetRay=new Group,J.targetRay.matrixAutoUpdate=!1,J.targetRay.visible=!1),J.targetRay},this.getControllerGrip=function(te){var J=w[te];return void 0===J&&(w[te]=J={}),void 0===J.grip&&(J.grip=new Group,J.grip.matrixAutoUpdate=!1,J.grip.visible=!1),J.grip},this.setFramebufferScaleFactor=function(){},this.setReferenceSpaceType=function(te){g=te},this.getReferenceSpace=function(){return v},this.getSession=function(){return d},this.setSession=function(te){if(null!==(d=te)){d.addEventListener("select",O),d.addEventListener("selectstart",O),d.addEventListener("selectend",O),d.addEventListener("squeeze",O),d.addEventListener("squeezestart",O),d.addEventListener("squeezeend",O),d.addEventListener("end",D);var J=e.getContextAttributes(),U=new XRWebGLLayer(d,e,{antialias:J.antialias,alpha:J.alpha,depth:J.depth,stencil:J.stencil});d.updateRenderState({baseLayer:U}),d.requestReferenceSpace(g).then(F),d.addEventListener("inputsourceschange",L)}};var I=new Vector3,V=new Vector3;function H(te,J){null===J?te.matrixWorld.copy(te.matrix):te.matrixWorld.multiplyMatrices(J.matrixWorld,te.matrix),te.matrixWorldInverse.getInverse(te.matrixWorld)}this.getCamera=function(te){A.near=b.near=x.near=te.near,A.far=b.far=x.far=te.far,(E!==A.near||R!==A.far)&&(d.updateRenderState({depthNear:A.near,depthFar:A.far}),E=A.near,R=A.far);var J=te.parent,k=A.cameras;H(A,J);for(var U=0;U<k.length;U++)H(k[U],J);te.matrixWorld.copy(A.matrixWorld);for(var K=te.children,ee=(U=0,K.length);U<ee;U++)K[U].updateMatrixWorld(!0);return function(te,J,k){I.setFromMatrixPosition(J.matrixWorld),V.setFromMatrixPosition(k.matrixWorld);var U=I.distanceTo(V),K=J.projectionMatrix.elements,ee=k.projectionMatrix.elements,Q=K[14]/(K[10]-1),oe=K[14]/(K[10]+1),me=(K[9]+1)/K[5],fe=(K[9]-1)/K[5],ge=(K[8]-1)/K[0],$=(ee[8]+1)/ee[0],ue=Q*ge,Y=Q*$,Z=U/(-ge+$),se=Z*-ge;J.matrixWorld.decompose(te.position,te.quaternion,te.scale),te.translateX(se),te.translateZ(Z),te.matrixWorld.compose(te.position,te.quaternion,te.scale),te.matrixWorldInverse.getInverse(te.matrixWorld);var ve=Q+Z,le=oe+Z;te.projectionMatrix.makePerspective(ue-se,Y+(U-se),me*oe/le*ve,fe*oe/le*ve,ve,le)}(A,x,b),A};var X=null,j=new WebGLAnimation;j.setAnimationLoop(function(te,J){if(null!==(C=J.getViewerPose(v))){var k=C.views,U=d.renderState.baseLayer;s.setFramebuffer(U.framebuffer);for(var K=0;K<k.length;K++){var ee=k[K],Q=U.getViewport(ee),oe=A.cameras[K];oe.matrix.fromArray(ee.transform.matrix),oe.projectionMatrix.fromArray(ee.projectionMatrix),oe.viewport.set(Q.x,Q.y,Q.width,Q.height),0===K&&A.matrix.copy(oe.matrix)}}var me=d.inputSources;for(K=0;K<w.length;K++){var fe=w[K],ge=me[K],$=null,ue=null;ge&&(fe.targetRay&&null!==($=J.getPose(ge.targetRaySpace,v))&&(fe.targetRay.matrix.fromArray($.transform.matrix),fe.targetRay.matrix.decompose(fe.targetRay.position,fe.targetRay.rotation,fe.targetRay.scale)),fe.grip&&ge.gripSpace&&null!==(ue=J.getPose(ge.gripSpace,v))&&(fe.grip.matrix.fromArray(ue.transform.matrix),fe.grip.matrix.decompose(fe.grip.position,fe.grip.rotation,fe.grip.scale))),fe.targetRay&&(fe.targetRay.visible=null!==$),fe.grip&&(fe.grip.visible=null!==ue)}X&&X(te,J)}),this.setAnimationLoop=function(te){X=te},this.dispose=function(){}}function WebGLRenderer(s){var e=void 0!==(s=s||{}).canvas?s.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),a=void 0!==s.context?s.context:null,d=void 0!==s.alpha&&s.alpha,v=void 0===s.depth||s.depth,g=void 0===s.stencil||s.stencil,C=void 0!==s.antialias&&s.antialias,w=void 0===s.premultipliedAlpha||s.premultipliedAlpha,_=void 0!==s.preserveDrawingBuffer&&s.preserveDrawingBuffer,x=void 0!==s.powerPreference?s.powerPreference:"default",b=void 0!==s.failIfMajorPerformanceCaveat&&s.failIfMajorPerformanceCaveat,A=null,E=null;this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=LinearEncoding,this.physicallyCorrectLights=!1,this.toneMapping=LinearToneMapping,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var le,ae,pe,he,ce,Te,be,xe,we,Ne,Re,De,Je,$e,pt,ut,at,Xe,R=this,O=!1,D=null,F=0,L=0,I=null,V=null,z=-1,H={geometry:null,program:null,wireframe:!1},X=null,re=null,j=new Vector4,te=new Vector4,J=null,k=e.width,U=e.height,K=1,ee=null,Q=null,oe=new Vector4(0,0,k,U),me=new Vector4(0,0,k,U),fe=!1,ge=new Frustum,$=new WebGLClipping,ue=!1,Y=!1,Z=new Matrix4,se=new Vector3;function ve(){return null===I?K:1}try{var _e={alpha:d,depth:v,stencil:g,antialias:C,premultipliedAlpha:w,preserveDrawingBuffer:_,powerPreference:x,failIfMajorPerformanceCaveat:b,xrCompatible:!0};if(e.addEventListener("webglcontextlost",ft,!1),e.addEventListener("webglcontextrestored",He,!1),null===(le=a||e.getContext("webgl",_e)||e.getContext("experimental-webgl",_e)))throw null!==e.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===le.getShaderPrecisionFormat&&(le.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(W){throw console.error("WebGLRenderer: "+W.message),W}function Ke(){ae=new WebGLExtensions(le),!1===(pe=new WebGLCapabilities(le,ae,s)).isWebGL2&&(ae.get("WEBGL_depth_texture"),ae.get("OES_texture_float"),ae.get("OES_texture_half_float"),ae.get("OES_texture_half_float_linear"),ae.get("OES_standard_derivatives"),ae.get("OES_element_index_uint"),ae.get("ANGLE_instanced_arrays")),ae.get("OES_texture_float_linear"),Xe=new WebGLUtils(le,ae,pe),(he=new WebGLState(le,ae,pe)).scissor(te.copy(me).multiplyScalar(K).floor()),he.viewport(j.copy(oe).multiplyScalar(K).floor()),ce=new WebGLInfo(le),Te=new WebGLProperties,be=new WebGLTextures(le,ae,he,Te,pe,Xe,ce),xe=new WebGLAttributes(le,pe),we=new WebGLGeometries(le,xe,ce),Ne=new WebGLObjects(le,we,xe,ce),pt=new WebGLMorphtargets(le),Re=new WebGLPrograms(R,ae,pe),De=new WebGLRenderLists,Je=new WebGLRenderStates,$e=new WebGLBackground(R,he,Ne,w),ut=new WebGLBufferRenderer(le,ae,ce,pe),at=new WebGLIndexedBufferRenderer(le,ae,ce,pe),ce.programs=Re.programs,R.capabilities=pe,R.extensions=ae,R.properties=Te,R.renderLists=De,R.state=he,R.info=ce}Ke();var lt=new WebXRManager(R,le);this.xr=lt;var ot=new WebGLMultiview(R,le),St=new WebGLShadowMap(R,Ne,pe.maxTextureSize);function ft(W){W.preventDefault(),console.log("WebGLRenderer: Context Lost."),O=!0}function He(){console.log("WebGLRenderer: Context Restored."),O=!1,Ke()}function gt(W){var ne=W.target;ne.removeEventListener("dispose",gt),function(W){Gt(W),Te.remove(W)}(ne)}function Gt(W){var ne=Te.get(W).program;W.program=void 0,void 0!==ne&&Re.releaseProgram(ne)}this.shadowMap=St,this.getContext=function(){return le},this.getContextAttributes=function(){return le.getContextAttributes()},this.forceContextLoss=function(){var W=ae.get("WEBGL_lose_context");W&&W.loseContext()},this.forceContextRestore=function(){var W=ae.get("WEBGL_lose_context");W&&W.restoreContext()},this.getPixelRatio=function(){return K},this.setPixelRatio=function(W){void 0!==W&&(K=W,this.setSize(k,U,!1))},this.getSize=function(W){return void 0===W&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),W=new Vector2),W.set(k,U)},this.setSize=function(W,ne,Ie){lt.isPresenting?console.warn("WebGLRenderer: Can't change size while VR device is presenting."):(k=W,U=ne,e.width=Math.floor(W*K),e.height=Math.floor(ne*K),!1!==Ie&&(e.style.width=W+"px",e.style.height=ne+"px"),this.setViewport(0,0,W,ne))},this.getDrawingBufferSize=function(W){return void 0===W&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),W=new Vector2),W.set(k*K,U*K).floor()},this.setDrawingBufferSize=function(W,ne,Ie){k=W,U=ne,K=Ie,e.width=Math.floor(W*Ie),e.height=Math.floor(ne*Ie),this.setViewport(0,0,W,ne)},this.getCurrentViewport=function(W){return void 0===W&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),W=new Vector4),W.copy(j)},this.getViewport=function(W){return W.copy(oe)},this.setViewport=function(W,ne,Ie,ze){W.isVector4?oe.set(W.x,W.y,W.z,W.w):oe.set(W,ne,Ie,ze),he.viewport(j.copy(oe).multiplyScalar(K).floor())},this.getScissor=function(W){return W.copy(me)},this.setScissor=function(W,ne,Ie,ze){W.isVector4?me.set(W.x,W.y,W.z,W.w):me.set(W,ne,Ie,ze),he.scissor(te.copy(me).multiplyScalar(K).floor())},this.getScissorTest=function(){return fe},this.setScissorTest=function(W){he.setScissorTest(fe=W)},this.setOpaqueSort=function(W){ee=W},this.setTransparentSort=function(W){Q=W},this.getClearColor=function(){return $e.getClearColor()},this.setClearColor=function(){$e.setClearColor.apply($e,arguments)},this.getClearAlpha=function(){return $e.getClearAlpha()},this.setClearAlpha=function(){$e.setClearAlpha.apply($e,arguments)},this.clear=function(W,ne,Ie){var ze=0;(void 0===W||W)&&(ze|=le.COLOR_BUFFER_BIT),(void 0===ne||ne)&&(ze|=le.DEPTH_BUFFER_BIT),(void 0===Ie||Ie)&&(ze|=le.STENCIL_BUFFER_BIT),le.clear(ze)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",ft,!1),e.removeEventListener("webglcontextrestored",He,!1),De.dispose(),Je.dispose(),Te.dispose(),Ne.dispose(),lt.dispose(),qr.stop()},this.renderBufferImmediate=function(W,ne){he.initAttributes();var Ie=Te.get(W);W.hasPositions&&!Ie.position&&(Ie.position=le.createBuffer()),W.hasNormals&&!Ie.normal&&(Ie.normal=le.createBuffer()),W.hasUvs&&!Ie.uv&&(Ie.uv=le.createBuffer()),W.hasColors&&!Ie.color&&(Ie.color=le.createBuffer());var ze=ne.getAttributes();W.hasPositions&&(le.bindBuffer(le.ARRAY_BUFFER,Ie.position),le.bufferData(le.ARRAY_BUFFER,W.positionArray,le.DYNAMIC_DRAW),he.enableAttribute(ze.position),le.vertexAttribPointer(ze.position,3,le.FLOAT,!1,0,0)),W.hasNormals&&(le.bindBuffer(le.ARRAY_BUFFER,Ie.normal),le.bufferData(le.ARRAY_BUFFER,W.normalArray,le.DYNAMIC_DRAW),he.enableAttribute(ze.normal),le.vertexAttribPointer(ze.normal,3,le.FLOAT,!1,0,0)),W.hasUvs&&(le.bindBuffer(le.ARRAY_BUFFER,Ie.uv),le.bufferData(le.ARRAY_BUFFER,W.uvArray,le.DYNAMIC_DRAW),he.enableAttribute(ze.uv),le.vertexAttribPointer(ze.uv,2,le.FLOAT,!1,0,0)),W.hasColors&&(le.bindBuffer(le.ARRAY_BUFFER,Ie.color),le.bufferData(le.ARRAY_BUFFER,W.colorArray,le.DYNAMIC_DRAW),he.enableAttribute(ze.color),le.vertexAttribPointer(ze.color,3,le.FLOAT,!1,0,0)),he.disableUnusedAttributes(),le.drawArrays(le.TRIANGLES,0,W.count),W.count=0};var yt=new Scene;this.renderBufferDirect=function(W,ne,Ie,ze,it,Dt){null===ne&&(ne=yt);var xt=it.isMesh&&it.matrixWorld.determinant()<0,kt=An(W,ne,ze,it);he.setMaterial(ze,xt);var ir=!1;(H.geometry!==Ie.id||H.program!==kt.id||H.wireframe!==(!0===ze.wireframe))&&(H.geometry=Ie.id,H.program=kt.id,H.wireframe=!0===ze.wireframe,ir=!0),(ze.morphTargets||ze.morphNormals)&&(pt.update(it,Ie,ze,kt),ir=!0);var Cr=Ie.index,Hr=Ie.attributes.position;if(null===Cr){if(void 0===Hr||0===Hr.count)return}else if(0===Cr.count)return;var Xr=1;!0===ze.wireframe&&(Cr=we.getWireframeAttribute(Ie),Xr=2);var kr,fr=ut;null!==Cr&&(kr=xe.get(Cr),(fr=at).setIndex(kr)),ir&&(function(W,ne,Ie,ze){if(!1!==pe.isWebGL2||!W.isInstancedMesh&&!ne.isInstancedBufferGeometry||null!==ae.get("ANGLE_instanced_arrays")){he.initAttributes();var it=ne.attributes,Dt=ze.getAttributes(),xt=Ie.defaultAttributeValues;for(var kt in Dt){var ir=Dt[kt];if(ir>=0){var Cr=it[kt];if(void 0!==Cr){var Hr=Cr.normalized,Xr=Cr.itemSize;if(void 0===(kr=xe.get(Cr)))continue;var fr=kr.buffer,Pr=kr.type,wi=kr.bytesPerElement;if(Cr.isInterleavedBufferAttribute){var Be=Cr.data,Ye=Be.stride,st=Cr.offset;Be&&Be.isInstancedInterleavedBuffer?(he.enableAttributeAndDivisor(ir,Be.meshPerAttribute),void 0===ne.maxInstancedCount&&(ne.maxInstancedCount=Be.meshPerAttribute*Be.count)):he.enableAttribute(ir),le.bindBuffer(le.ARRAY_BUFFER,fr),le.vertexAttribPointer(ir,Xr,Pr,Hr,Ye*wi,st*wi)}else Cr.isInstancedBufferAttribute?(he.enableAttributeAndDivisor(ir,Cr.meshPerAttribute),void 0===ne.maxInstancedCount&&(ne.maxInstancedCount=Cr.meshPerAttribute*Cr.count)):he.enableAttribute(ir),le.bindBuffer(le.ARRAY_BUFFER,fr),le.vertexAttribPointer(ir,Xr,Pr,Hr,0,0)}else if("instanceMatrix"===kt){var kr;if(void 0===(kr=xe.get(W.instanceMatrix)))continue;fr=kr.buffer,Pr=kr.type,he.enableAttributeAndDivisor(ir+0,1),he.enableAttributeAndDivisor(ir+1,1),he.enableAttributeAndDivisor(ir+2,1),he.enableAttributeAndDivisor(ir+3,1),le.bindBuffer(le.ARRAY_BUFFER,fr),le.vertexAttribPointer(ir+0,4,Pr,!1,64,0),le.vertexAttribPointer(ir+1,4,Pr,!1,64,16),le.vertexAttribPointer(ir+2,4,Pr,!1,64,32),le.vertexAttribPointer(ir+3,4,Pr,!1,64,48)}else if(void 0!==xt){var bt=xt[kt];if(void 0!==bt)switch(bt.length){case 2:le.vertexAttrib2fv(ir,bt);break;case 3:le.vertexAttrib3fv(ir,bt);break;case 4:le.vertexAttrib4fv(ir,bt);break;default:le.vertexAttrib1fv(ir,bt)}}}}he.disableUnusedAttributes()}}(it,Ie,ze,kt),null!==Cr&&le.bindBuffer(le.ELEMENT_ARRAY_BUFFER,kr.buffer));var Pr=null!==Cr?Cr.count:Hr.count,wi=Ie.drawRange.start*Xr,Be=Ie.drawRange.count*Xr,Ye=null!==Dt?Dt.start*Xr:0,st=null!==Dt?Dt.count*Xr:1/0,bt=Math.max(wi,Ye),Et=Math.min(Pr,wi+Be,Ye+st)-1,ar=Math.max(0,Et-bt+1);if(0!==ar){if(it.isMesh)!0===ze.wireframe?(he.setLineWidth(ze.wireframeLinewidth*ve()),fr.setMode(le.LINES)):fr.setMode(le.TRIANGLES);else if(it.isLine){var Xt=ze.linewidth;void 0===Xt&&(Xt=1),he.setLineWidth(Xt*ve()),fr.setMode(it.isLineSegments?le.LINES:it.isLineLoop?le.LINE_LOOP:le.LINE_STRIP)}else it.isPoints?fr.setMode(le.POINTS):it.isSprite&&fr.setMode(le.TRIANGLES);it.isInstancedMesh?fr.renderInstances(Ie,bt,ar,it.count):Ie.isInstancedBufferGeometry?fr.renderInstances(Ie,bt,ar,Ie.maxInstancedCount):fr.render(bt,ar)}},this.compile=function(W,ne){(E=Je.get(W,ne)).init(),W.traverse(function(ze){ze.isLight&&(E.pushLight(ze),ze.castShadow&&E.pushShadow(ze))}),E.setupLights(ne);var Ie={};W.traverse(function(ze){if(ze.material)if(Array.isArray(ze.material))for(var it=0;it<ze.material.length;it++)ze.material[it].uuid in Ie||(Sr(ze.material[it],W,ze),Ie[ze.material[it].uuid]=!0);else ze.material.uuid in Ie||(Sr(ze.material,W,ze),Ie[ze.material.uuid]=!0)})};var Dr=null,qr=new WebGLAnimation;function Ar(W,ne,Ie,ze){if(!1!==W.visible){if(W.layers.test(ne.layers))if(W.isGroup)Ie=W.renderOrder;else if(W.isLOD)!0===W.autoUpdate&&W.update(ne);else if(W.isLight)E.pushLight(W),W.castShadow&&E.pushShadow(W);else if(W.isSprite){if(!W.frustumCulled||ge.intersectsSprite(W)){ze&&se.setFromMatrixPosition(W.matrixWorld).applyMatrix4(Z);var Dt=Ne.update(W);(xt=W.material).visible&&A.push(W,Dt,xt,Ie,se.z,null)}}else if(W.isImmediateRenderObject)ze&&se.setFromMatrixPosition(W.matrixWorld).applyMatrix4(Z),A.push(W,null,W.material,Ie,se.z,null);else if((W.isMesh||W.isLine||W.isPoints)&&(W.isSkinnedMesh&&W.skeleton.frame!==ce.render.frame&&(W.skeleton.update(),W.skeleton.frame=ce.render.frame),!W.frustumCulled||ge.intersectsObject(W))){ze&&se.setFromMatrixPosition(W.matrixWorld).applyMatrix4(Z),Dt=Ne.update(W);var xt=W.material;if(Array.isArray(xt))for(var kt=Dt.groups,ir=0,Cr=kt.length;ir<Cr;ir++){var Hr=kt[ir],Xr=xt[Hr.materialIndex];Xr&&Xr.visible&&A.push(W,Dt,Xr,Ie,se.z,Hr)}else xt.visible&&A.push(W,Dt,xt,Ie,se.z,null)}var kr=W.children;for(ir=0,Cr=kr.length;ir<Cr;ir++)Ar(kr[ir],ne,Ie,ze)}}function hn(W,ne,Ie,ze){for(var it=0,Dt=W.length;it<Dt;it++){var xt=W[it],kt=xt.object,ir=xt.geometry,Cr=void 0===ze?xt.material:ze,Hr=xt.group;if(Ie.isArrayCamera)if(re=Ie,lt.enabled&&ot.isAvailable())Sn(kt,ne,Ie,ir,Cr,Hr);else for(var Xr=Ie.cameras,kr=0,fr=Xr.length;kr<fr;kr++){var Pr=Xr[kr];kt.layers.test(Pr.layers)&&(he.viewport(j.copy(Pr.viewport)),E.setupLights(Pr),Sn(kt,ne,Pr,ir,Cr,Hr))}else re=null,Sn(kt,ne,Ie,ir,Cr,Hr)}}function Sn(W,ne,Ie,ze,it,Dt){if(W.onBeforeRender(R,ne,Ie,ze,it,Dt),E=Je.get(ne,re||Ie),W.modelViewMatrix.multiplyMatrices(Ie.matrixWorldInverse,W.matrixWorld),W.normalMatrix.getNormalMatrix(W.modelViewMatrix),W.isImmediateRenderObject){var xt=An(Ie,ne,it,W);he.setMaterial(it),H.geometry=null,H.program=null,H.wireframe=!1,function(W,ne){W.render(function(Ie){R.renderBufferImmediate(Ie,ne)})}(W,xt)}else R.renderBufferDirect(Ie,ne,ze,it,W,Dt);W.onAfterRender(R,ne,Ie,ze,it,Dt),E=Je.get(ne,re||Ie)}function Sr(W,ne,Ie){var ze=Te.get(W),it=E.state.lights,xt=it.state.version,kt=Re.getParameters(W,it.state,E.state.shadowsArray,ne,$.numPlanes,$.numIntersection,Ie),ir=Re.getProgramCacheKey(kt),Cr=ze.program,Hr=!0;if(void 0===Cr)W.addEventListener("dispose",gt);else if(Cr.cacheKey!==ir)Gt(W);else if(ze.lightsStateVersion!==xt)ze.lightsStateVersion=xt,Hr=!1;else{if(void 0!==kt.shaderID)return;Hr=!1}Hr&&(Cr=Re.acquireProgram(kt,ir),ze.program=Cr,ze.uniforms=kt.uniforms,ze.environment=W.isMeshStandardMaterial?ne.environment:null,ze.outputEncoding=R.outputEncoding,W.program=Cr);var Xr=Cr.getAttributes();if(W.morphTargets){W.numSupportedMorphTargets=0;for(var kr=0;kr<R.maxMorphTargets;kr++)Xr["morphTarget"+kr]>=0&&W.numSupportedMorphTargets++}if(W.morphNormals)for(W.numSupportedMorphNormals=0,kr=0;kr<R.maxMorphNormals;kr++)Xr["morphNormal"+kr]>=0&&W.numSupportedMorphNormals++;var fr=ze.uniforms;(!W.isShaderMaterial&&!W.isRawShaderMaterial||!0===W.clipping)&&(ze.numClippingPlanes=$.numPlanes,ze.numIntersection=$.numIntersection,fr.clippingPlanes=$.uniform),ze.fog=ne.fog,ze.needsLights=function(W){return W.isMeshLambertMaterial||W.isMeshToonMaterial||W.isMeshPhongMaterial||W.isMeshStandardMaterial||W.isShadowMaterial||W.isShaderMaterial&&!0===W.lights}(W),ze.lightsStateVersion=xt,ze.needsLights&&(fr.ambientLightColor.value=it.state.ambient,fr.lightProbe.value=it.state.probe,fr.directionalLights.value=it.state.directional,fr.spotLights.value=it.state.spot,fr.rectAreaLights.value=it.state.rectArea,fr.pointLights.value=it.state.point,fr.hemisphereLights.value=it.state.hemi,fr.directionalShadowMap.value=it.state.directionalShadowMap,fr.directionalShadowMatrix.value=it.state.directionalShadowMatrix,fr.spotShadowMap.value=it.state.spotShadowMap,fr.spotShadowMatrix.value=it.state.spotShadowMatrix,fr.pointShadowMap.value=it.state.pointShadowMap,fr.pointShadowMatrix.value=it.state.pointShadowMatrix);var Pr=ze.program.getUniforms(),wi=WebGLUniforms.seqWithValue(Pr.seq,fr);ze.uniformsList=wi}function An(W,ne,Ie,ze){be.resetTextureUnits();var it=ne.fog,Dt=Ie.isMeshStandardMaterial?ne.environment:null,xt=Te.get(Ie),kt=E.state.lights;ue&&(Y||W!==X)&&$.setState(Ie.clippingPlanes,Ie.clipIntersection,Ie.clipShadows,W,xt,W===X&&Ie.id===z),Ie.version===xt.__version?(void 0===xt.program||Ie.fog&&xt.fog!==it||xt.environment!==Dt||xt.needsLights&&xt.lightsStateVersion!==kt.state.version||void 0!==xt.numClippingPlanes&&(xt.numClippingPlanes!==$.numPlanes||xt.numIntersection!==$.numIntersection)||xt.outputEncoding!==R.outputEncoding)&&Sr(Ie,ne,ze):(Sr(Ie,ne,ze),xt.__version=Ie.version);var Cr=!1,Hr=!1,Xr=!1,kr=xt.program,fr=kr.getUniforms(),Pr=xt.uniforms;if(he.useProgram(kr.program)&&(Cr=!0,Hr=!0,Xr=!0),Ie.id!==z&&(z=Ie.id,Hr=!0),Cr||X!==W){if(kr.numMultiviewViews>0?ot.updateCameraProjectionMatricesUniform(W,fr):fr.setValue(le,"projectionMatrix",W.projectionMatrix),pe.logarithmicDepthBuffer&&fr.setValue(le,"logDepthBufFC",2/(Math.log(W.far+1)/Math.LN2)),X!==W&&(X=W,Hr=!0,Xr=!0),Ie.isShaderMaterial||Ie.isMeshPhongMaterial||Ie.isMeshToonMaterial||Ie.isMeshStandardMaterial||Ie.envMap){var wi=fr.map.cameraPosition;void 0!==wi&&wi.setValue(le,se.setFromMatrixPosition(W.matrixWorld))}(Ie.isMeshPhongMaterial||Ie.isMeshToonMaterial||Ie.isMeshLambertMaterial||Ie.isMeshBasicMaterial||Ie.isMeshStandardMaterial||Ie.isShaderMaterial)&&fr.setValue(le,"isOrthographic",!0===W.isOrthographicCamera),(Ie.isMeshPhongMaterial||Ie.isMeshToonMaterial||Ie.isMeshLambertMaterial||Ie.isMeshBasicMaterial||Ie.isMeshStandardMaterial||Ie.isShaderMaterial||Ie.skinning)&&(kr.numMultiviewViews>0?ot.updateCameraViewMatricesUniform(W,fr):fr.setValue(le,"viewMatrix",W.matrixWorldInverse))}if(Ie.skinning){fr.setOptional(le,ze,"bindMatrix"),fr.setOptional(le,ze,"bindMatrixInverse");var Be=ze.skeleton;if(Be)if(pe.floatVertexTextures){if(void 0===Be.boneTexture){var st=Math.sqrt(4*Be.bones.length);st=MathUtils.ceilPowerOfTwo(st),st=Math.max(st,4);var bt=new Float32Array(st*st*4);bt.set(Be.boneMatrices);var Et=new DataTexture(bt,st,st,RGBAFormat,FloatType);Be.boneMatrices=bt,Be.boneTexture=Et,Be.boneTextureSize=st}fr.setValue(le,"boneTexture",Be.boneTexture,be),fr.setValue(le,"boneTextureSize",Be.boneTextureSize)}else fr.setOptional(le,Be,"boneMatrices")}return(Hr||xt.receiveShadow!==ze.receiveShadow)&&(xt.receiveShadow=ze.receiveShadow,fr.setValue(le,"receiveShadow",ze.receiveShadow)),Hr&&(fr.setValue(le,"toneMappingExposure",R.toneMappingExposure),fr.setValue(le,"toneMappingWhitePoint",R.toneMappingWhitePoint),xt.needsLights&&function(W,ne){W.ambientLightColor.needsUpdate=ne,W.lightProbe.needsUpdate=ne,W.directionalLights.needsUpdate=ne,W.pointLights.needsUpdate=ne,W.spotLights.needsUpdate=ne,W.rectAreaLights.needsUpdate=ne,W.hemisphereLights.needsUpdate=ne}(Pr,Xr),it&&Ie.fog&&function(W,ne){W.fogColor.value.copy(ne.color),ne.isFog?(W.fogNear.value=ne.near,W.fogFar.value=ne.far):ne.isFogExp2&&(W.fogDensity.value=ne.density)}(Pr,it),Ie.isMeshBasicMaterial?jr(Pr,Ie):Ie.isMeshLambertMaterial?(jr(Pr,Ie),function(W,ne){ne.emissiveMap&&(W.emissiveMap.value=ne.emissiveMap)}(Pr,Ie)):Ie.isMeshToonMaterial?(jr(Pr,Ie),function(W,ne){W.specular.value.copy(ne.specular),W.shininess.value=Math.max(ne.shininess,1e-4),ne.gradientMap&&(W.gradientMap.value=ne.gradientMap),ne.emissiveMap&&(W.emissiveMap.value=ne.emissiveMap),ne.bumpMap&&(W.bumpMap.value=ne.bumpMap,W.bumpScale.value=ne.bumpScale,ne.side===BackSide&&(W.bumpScale.value*=-1)),ne.normalMap&&(W.normalMap.value=ne.normalMap,W.normalScale.value.copy(ne.normalScale),ne.side===BackSide&&W.normalScale.value.negate()),ne.displacementMap&&(W.displacementMap.value=ne.displacementMap,W.displacementScale.value=ne.displacementScale,W.displacementBias.value=ne.displacementBias)}(Pr,Ie)):Ie.isMeshPhongMaterial?(jr(Pr,Ie),function(W,ne){W.specular.value.copy(ne.specular),W.shininess.value=Math.max(ne.shininess,1e-4),ne.emissiveMap&&(W.emissiveMap.value=ne.emissiveMap),ne.bumpMap&&(W.bumpMap.value=ne.bumpMap,W.bumpScale.value=ne.bumpScale,ne.side===BackSide&&(W.bumpScale.value*=-1)),ne.normalMap&&(W.normalMap.value=ne.normalMap,W.normalScale.value.copy(ne.normalScale),ne.side===BackSide&&W.normalScale.value.negate()),ne.displacementMap&&(W.displacementMap.value=ne.displacementMap,W.displacementScale.value=ne.displacementScale,W.displacementBias.value=ne.displacementBias)}(Pr,Ie)):Ie.isMeshStandardMaterial?(jr(Pr,Ie,Dt),Ie.isMeshPhysicalMaterial?function(W,ne,Ie){Ee(W,ne,Ie),W.reflectivity.value=ne.reflectivity,W.clearcoat.value=ne.clearcoat,W.clearcoatRoughness.value=ne.clearcoatRoughness,ne.sheen&&W.sheen.value.copy(ne.sheen),ne.clearcoatNormalMap&&(W.clearcoatNormalScale.value.copy(ne.clearcoatNormalScale),W.clearcoatNormalMap.value=ne.clearcoatNormalMap,ne.side===BackSide&&W.clearcoatNormalScale.value.negate()),W.transparency.value=ne.transparency}(Pr,Ie,Dt):Ee(Pr,Ie,Dt)):Ie.isMeshMatcapMaterial?(jr(Pr,Ie),function(W,ne){ne.matcap&&(W.matcap.value=ne.matcap),ne.bumpMap&&(W.bumpMap.value=ne.bumpMap,W.bumpScale.value=ne.bumpScale,ne.side===BackSide&&(W.bumpScale.value*=-1)),ne.normalMap&&(W.normalMap.value=ne.normalMap,W.normalScale.value.copy(ne.normalScale),ne.side===BackSide&&W.normalScale.value.negate()),ne.displacementMap&&(W.displacementMap.value=ne.displacementMap,W.displacementScale.value=ne.displacementScale,W.displacementBias.value=ne.displacementBias)}(Pr,Ie)):Ie.isMeshDepthMaterial?(jr(Pr,Ie),function(W,ne){ne.displacementMap&&(W.displacementMap.value=ne.displacementMap,W.displacementScale.value=ne.displacementScale,W.displacementBias.value=ne.displacementBias)}(Pr,Ie)):Ie.isMeshDistanceMaterial?(jr(Pr,Ie),function(W,ne){ne.displacementMap&&(W.displacementMap.value=ne.displacementMap,W.displacementScale.value=ne.displacementScale,W.displacementBias.value=ne.displacementBias),W.referencePosition.value.copy(ne.referencePosition),W.nearDistance.value=ne.nearDistance,W.farDistance.value=ne.farDistance}(Pr,Ie)):Ie.isMeshNormalMaterial?(jr(Pr,Ie),function(W,ne){ne.bumpMap&&(W.bumpMap.value=ne.bumpMap,W.bumpScale.value=ne.bumpScale,ne.side===BackSide&&(W.bumpScale.value*=-1)),ne.normalMap&&(W.normalMap.value=ne.normalMap,W.normalScale.value.copy(ne.normalScale),ne.side===BackSide&&W.normalScale.value.negate()),ne.displacementMap&&(W.displacementMap.value=ne.displacementMap,W.displacementScale.value=ne.displacementScale,W.displacementBias.value=ne.displacementBias)}(Pr,Ie)):Ie.isLineBasicMaterial?(function(W,ne){W.diffuse.value.copy(ne.color),W.opacity.value=ne.opacity}(Pr,Ie),Ie.isLineDashedMaterial&&function(W,ne){W.dashSize.value=ne.dashSize,W.totalSize.value=ne.dashSize+ne.gapSize,W.scale.value=ne.scale}(Pr,Ie)):Ie.isPointsMaterial?function(W,ne){var Ie;W.diffuse.value.copy(ne.color),W.opacity.value=ne.opacity,W.size.value=ne.size*K,W.scale.value=.5*U,ne.map&&(W.map.value=ne.map),ne.alphaMap&&(W.alphaMap.value=ne.alphaMap),ne.map?Ie=ne.map:ne.alphaMap&&(Ie=ne.alphaMap),void 0!==Ie&&(!0===Ie.matrixAutoUpdate&&Ie.updateMatrix(),W.uvTransform.value.copy(Ie.matrix))}(Pr,Ie):Ie.isSpriteMaterial?function(W,ne){var Ie;W.diffuse.value.copy(ne.color),W.opacity.value=ne.opacity,W.rotation.value=ne.rotation,ne.map&&(W.map.value=ne.map),ne.alphaMap&&(W.alphaMap.value=ne.alphaMap),ne.map?Ie=ne.map:ne.alphaMap&&(Ie=ne.alphaMap),void 0!==Ie&&(!0===Ie.matrixAutoUpdate&&Ie.updateMatrix(),W.uvTransform.value.copy(Ie.matrix))}(Pr,Ie):Ie.isShadowMaterial&&(Pr.color.value.copy(Ie.color),Pr.opacity.value=Ie.opacity),void 0!==Pr.ltc_1&&(Pr.ltc_1.value=UniformsLib.LTC_1),void 0!==Pr.ltc_2&&(Pr.ltc_2.value=UniformsLib.LTC_2),WebGLUniforms.upload(le,xt.uniformsList,Pr,be),Ie.isShaderMaterial&&(Ie.uniformsNeedUpdate=!1)),Ie.isShaderMaterial&&!0===Ie.uniformsNeedUpdate&&(WebGLUniforms.upload(le,xt.uniformsList,Pr,be),Ie.uniformsNeedUpdate=!1),Ie.isSpriteMaterial&&fr.setValue(le,"center",ze.center),kr.numMultiviewViews>0?ot.updateObjectMatricesUniforms(ze,W,fr):(fr.setValue(le,"modelViewMatrix",ze.modelViewMatrix),fr.setValue(le,"normalMatrix",ze.normalMatrix)),fr.setValue(le,"modelMatrix",ze.matrixWorld),kr}function jr(W,ne,Ie){W.opacity.value=ne.opacity,ne.color&&W.diffuse.value.copy(ne.color),ne.emissive&&W.emissive.value.copy(ne.emissive).multiplyScalar(ne.emissiveIntensity),ne.map&&(W.map.value=ne.map),ne.alphaMap&&(W.alphaMap.value=ne.alphaMap),ne.specularMap&&(W.specularMap.value=ne.specularMap);var it,Dt,ze=ne.envMap||Ie;ze&&(W.envMap.value=ze,W.flipEnvMap.value=ze.isCubeTexture?-1:1,W.reflectivity.value=ne.reflectivity,W.refractionRatio.value=ne.refractionRatio,W.maxMipLevel.value=Te.get(ze).__maxMipLevel),ne.lightMap&&(W.lightMap.value=ne.lightMap,W.lightMapIntensity.value=ne.lightMapIntensity),ne.aoMap&&(W.aoMap.value=ne.aoMap,W.aoMapIntensity.value=ne.aoMapIntensity),ne.map?it=ne.map:ne.specularMap?it=ne.specularMap:ne.displacementMap?it=ne.displacementMap:ne.normalMap?it=ne.normalMap:ne.bumpMap?it=ne.bumpMap:ne.roughnessMap?it=ne.roughnessMap:ne.metalnessMap?it=ne.metalnessMap:ne.alphaMap?it=ne.alphaMap:ne.emissiveMap&&(it=ne.emissiveMap),void 0!==it&&(it.isWebGLRenderTarget&&(it=it.texture),!0===it.matrixAutoUpdate&&it.updateMatrix(),W.uvTransform.value.copy(it.matrix)),ne.aoMap?Dt=ne.aoMap:ne.lightMap&&(Dt=ne.lightMap),void 0!==Dt&&(Dt.isWebGLRenderTarget&&(Dt=Dt.texture),!0===Dt.matrixAutoUpdate&&Dt.updateMatrix(),W.uv2Transform.value.copy(Dt.matrix))}function Ee(W,ne,Ie){W.roughness.value=ne.roughness,W.metalness.value=ne.metalness,ne.roughnessMap&&(W.roughnessMap.value=ne.roughnessMap),ne.metalnessMap&&(W.metalnessMap.value=ne.metalnessMap),ne.emissiveMap&&(W.emissiveMap.value=ne.emissiveMap),ne.bumpMap&&(W.bumpMap.value=ne.bumpMap,W.bumpScale.value=ne.bumpScale,ne.side===BackSide&&(W.bumpScale.value*=-1)),ne.normalMap&&(W.normalMap.value=ne.normalMap,W.normalScale.value.copy(ne.normalScale),ne.side===BackSide&&W.normalScale.value.negate()),ne.displacementMap&&(W.displacementMap.value=ne.displacementMap,W.displacementScale.value=ne.displacementScale,W.displacementBias.value=ne.displacementBias),(ne.envMap||Ie)&&(W.envMapIntensity.value=ne.envMapIntensity)}qr.setAnimationLoop(function(W){lt.isPresenting||Dr&&Dr(W)}),"undefined"!=typeof window&&qr.setContext(window),this.setAnimationLoop=function(W){Dr=W,lt.setAnimationLoop(W),qr.start()},this.render=function(W,ne){var Ie,ze;if(void 0!==arguments[2]&&(console.warn("WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),Ie=arguments[2]),void 0!==arguments[3]&&(console.warn("WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),ze=arguments[3]),ne&&ne.isCamera){if(!O){H.geometry=null,H.program=null,H.wireframe=!1,z=-1,X=null,!0===W.autoUpdate&&W.updateMatrixWorld(),null===ne.parent&&ne.updateMatrixWorld(),lt.enabled&&lt.isPresenting&&(ne=lt.getCamera(ne)),(E=Je.get(W,ne)).init(),W.onBeforeRender(R,W,ne,Ie||I),Z.multiplyMatrices(ne.projectionMatrix,ne.matrixWorldInverse),ge.setFromProjectionMatrix(Z),ue=$.init(this.clippingPlanes,Y=this.localClippingEnabled,ne),(A=De.get(W,ne)).init(),Ar(W,ne,0,R.sortObjects),!0===R.sortObjects&&A.sort(ee,Q),ue&&$.beginShadows();var it=E.state.shadowsArray;St.render(it,W,ne),E.setupLights(ne),ue&&$.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==Ie&&this.setRenderTarget(Ie),lt.enabled&&ot.isAvailable()&&ot.attachCamera(ne),$e.render(A,W,ne,ze);var Dt=A.opaque,xt=A.transparent;if(W.overrideMaterial){var kt=W.overrideMaterial;Dt.length&&hn(Dt,W,ne,kt),xt.length&&hn(xt,W,ne,kt)}else Dt.length&&hn(Dt,W,ne),xt.length&&hn(xt,W,ne);W.onAfterRender(R,W,ne),null!==I&&(be.updateRenderTargetMipmap(I),be.updateMultisampleRenderTarget(I)),he.buffers.depth.setTest(!0),he.buffers.depth.setMask(!0),he.buffers.color.setMask(!0),he.setPolygonOffset(!1),lt.enabled&&ot.isAvailable()&&ot.detachCamera(ne),A=null,E=null}}else console.error("WebGLRenderer.render: camera is not an instance of Camera.")},this.setFramebuffer=function(W){D!==W&&null===I&&le.bindFramebuffer(le.FRAMEBUFFER,W),D=W},this.getActiveCubeFace=function(){return F},this.getActiveMipmapLevel=function(){return L},this.getRenderTarget=function(){return I},this.setRenderTarget=function(W,ne,Ie){I=W,F=ne,L=Ie,W&&void 0===Te.get(W).__webglFramebuffer&&be.setupRenderTarget(W);var ze=D,it=!1;if(W){var Dt=Te.get(W).__webglFramebuffer;W.isWebGLCubeRenderTarget?(ze=Dt[ne||0],it=!0):ze=W.isWebGLMultisampleRenderTarget?Te.get(W).__webglMultisampledFramebuffer:Dt,j.copy(W.viewport),te.copy(W.scissor),J=W.scissorTest}else j.copy(oe).multiplyScalar(K).floor(),te.copy(me).multiplyScalar(K).floor(),J=fe;if(V!==ze&&(le.bindFramebuffer(le.FRAMEBUFFER,ze),V=ze),he.viewport(j),he.scissor(te),he.setScissorTest(J),it){var xt=Te.get(W.texture);le.framebufferTexture2D(le.FRAMEBUFFER,le.COLOR_ATTACHMENT0,le.TEXTURE_CUBE_MAP_POSITIVE_X+(ne||0),xt.__webglTexture,Ie||0)}},this.readRenderTargetPixels=function(W,ne,Ie,ze,it,Dt,xt){if(W&&W.isWebGLRenderTarget){var kt=Te.get(W).__webglFramebuffer;if(W.isWebGLCubeRenderTarget&&void 0!==xt&&(kt=kt[xt]),kt){var ir=!1;kt!==V&&(le.bindFramebuffer(le.FRAMEBUFFER,kt),ir=!0);try{var Cr=W.texture,Hr=Cr.format,Xr=Cr.type;if(Hr!==RGBAFormat&&Xe.convert(Hr)!==le.getParameter(le.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(Xr===UnsignedByteType||Xe.convert(Xr)===le.getParameter(le.IMPLEMENTATION_COLOR_READ_TYPE)||Xr===FloatType&&(pe.isWebGL2||ae.get("OES_texture_float")||ae.get("WEBGL_color_buffer_float"))||Xr===HalfFloatType&&ae.get(pe.isWebGL2?"EXT_color_buffer_float":"EXT_color_buffer_half_float")))return void console.error("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");le.checkFramebufferStatus(le.FRAMEBUFFER)===le.FRAMEBUFFER_COMPLETE?ne>=0&&ne<=W.width-ze&&Ie>=0&&Ie<=W.height-it&&le.readPixels(ne,Ie,ze,it,Xe.convert(Hr),Xe.convert(Xr),Dt):console.error("WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{ir&&le.bindFramebuffer(le.FRAMEBUFFER,V)}}}else console.error("WebGLRenderer.readRenderTargetPixels: renderTarget is not WebGLRenderTarget.")},this.copyFramebufferToTexture=function(W,ne,Ie){void 0===Ie&&(Ie=0);var ze=Math.pow(2,-Ie),it=Math.floor(ne.image.width*ze),Dt=Math.floor(ne.image.height*ze),xt=Xe.convert(ne.format);be.setTexture2D(ne,0),le.copyTexImage2D(le.TEXTURE_2D,Ie,xt,W.x,W.y,it,Dt,0),he.unbindTexture()},this.copyTextureToTexture=function(W,ne,Ie,ze){var it=ne.image.width,Dt=ne.image.height,xt=Xe.convert(Ie.format),kt=Xe.convert(Ie.type);be.setTexture2D(Ie,0),ne.isDataTexture?le.texSubImage2D(le.TEXTURE_2D,ze||0,W.x,W.y,it,Dt,xt,kt,ne.image.data):le.texSubImage2D(le.TEXTURE_2D,ze||0,W.x,W.y,xt,kt,ne.image),he.unbindTexture()},this.initTexture=function(W){be.setTexture2D(W,0),he.unbindTexture()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function CanvasTexture(s,e,a,d,v,g,C,w,_){Texture.call(this,s,e,a,d,v,g,C,w,_),this.needsUpdate=!0}function VideoTexture(s,e,a,d,v,g,C,w,_){Texture.call(this,s,e,a,d,v,g,C,w,_),this.format=void 0!==C?C:RGBFormat,this.minFilter=void 0!==g?g:LinearFilter,this.magFilter=void 0!==v?v:LinearFilter,this.generateMipmaps=!1}WebGLMultisampleRenderTarget.prototype=Object.assign(Object.create(WebGLRenderTarget.prototype),{constructor:WebGLMultisampleRenderTarget,isWebGLMultisampleRenderTarget:!0,copy:function(e){return WebGLRenderTarget.prototype.copy.call(this,e),this.samples=e.samples,this}}),Object.assign(WebXRManager.prototype,EventDispatcher.prototype),CanvasTexture.prototype=Object.create(Texture.prototype),CanvasTexture.prototype.constructor=CanvasTexture,CanvasTexture.prototype.isCanvasTexture=!0,VideoTexture.prototype=Object.assign(Object.create(Texture.prototype),{constructor:VideoTexture,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}})},757:function(s,e,a){s.exports=a(854)}},function(s){s(s.s=370)}]);